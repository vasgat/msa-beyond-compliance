var Ytt=Object.defineProperty,Ktt=Object.defineProperties,Jtt=Object.getOwnPropertyDescriptors,Que=Object.getOwnPropertySymbols,Xtt=Object.prototype.hasOwnProperty,Qtt=Object.prototype.propertyIsEnumerable,Zue=(Ln,Dn,ue)=>Dn in Ln?Ytt(Ln,Dn,{enumerable:!0,configurable:!0,writable:!0,value:ue}):Ln[Dn]=ue,ece=(Ln,Dn)=>{for(var ue in Dn||(Dn={}))Xtt.call(Dn,ue)&&Zue(Ln,ue,Dn[ue]);if(Que)for(var ue of Que(Dn))Qtt.call(Dn,ue)&&Zue(Ln,ue,Dn[ue]);return Ln},tce=(Ln,Dn)=>Ktt(Ln,Jtt(Dn));(self.webpackChunkmsa_dashboard=self.webpackChunkmsa_dashboard||[]).push([[179],{798:(Ln,Dn,ue)=>{"use strict";var Pt={};ue.r(Pt),ue.d(Pt,{JsonPatchError:()=>Hn,_areEquals:()=>M_,applyOperation:()=>Md,applyPatch:()=>jw,applyReducer:()=>HDe,deepClone:()=>$De,getValueByPointer:()=>Lw,validate:()=>lz,validator:()=>Bw});var Yt={};ue.r(Yt),ue.d(Yt,{compare:()=>JDe,generate:()=>GN,observe:()=>KDe,unobserve:()=>YDe});var Kt={};ue.r(Kt),ue.d(Kt,{aggregate:()=>qc,bin:()=>Tk,collect:()=>Ok,compare:()=>WW,countpattern:()=>Mk,cross:()=>Nk,density:()=>kk,dotbin:()=>Rk,expression:()=>ZW,extent:()=>Fk,facet:()=>bD,field:()=>eq,filter:()=>Lk,flatten:()=>jk,fold:()=>Bk,formula:()=>$k,generate:()=>tq,impute:()=>Vk,joinaggregate:()=>Hk,kde:()=>Uk,key:()=>nq,load:()=>iq,lookup:()=>Gk,multiextent:()=>rq,multivalues:()=>sq,params:()=>oq,pivot:()=>Wk,prefacet:()=>aq,project:()=>qk,proxy:()=>lq,quantile:()=>Yk,relay:()=>uq,sample:()=>Kk,sequence:()=>Jk,sieve:()=>cq,subflow:()=>Pk,timeunit:()=>Xk,tupleindex:()=>dq,values:()=>hq,window:()=>Qk});var nn={};ue.r(nn),ue.d(nn,{interpolate:()=>Zc,interpolateArray:()=>dTe,interpolateBasis:()=>Qq,interpolateBasisClosed:()=>Zq,interpolateCubehelix:()=>eOe,interpolateCubehelixLong:()=>tOe,interpolateDate:()=>rY,interpolateDiscrete:()=>LTe,interpolateHcl:()=>XTe,interpolateHclLong:()=>QTe,interpolateHsl:()=>qTe,interpolateHslLong:()=>YTe,interpolateHue:()=>jTe,interpolateLab:()=>JTe,interpolateNumber:()=>da,interpolateNumberArray:()=>pI,interpolateObject:()=>sY,interpolateRgb:()=>hI,interpolateRgbBasis:()=>cTe,interpolateRgbBasisClosed:()=>fTe,interpolateRound:()=>ly,interpolateString:()=>oY,interpolateTransformCss:()=>VTe,interpolateTransformSvg:()=>HTe,interpolateZoom:()=>WTe,piecewise:()=>xI,quantize:()=>nOe});var ot={};ue.r(ot),ue.d(ot,{bound:()=>QJ,identifier:()=>eF,mark:()=>eX,overlap:()=>tX,render:()=>aX,viewlayout:()=>hX});var Wn={};ue.r(Wn),ue.d(Wn,{axisticks:()=>gX,datajoin:()=>mX,encode:()=>_X,legendentries:()=>yX,linkpath:()=>tF,pie:()=>nF,scale:()=>EX,sortitems:()=>AX,stack:()=>rF});var At={};ue.r(At),ue.d(At,{contour:()=>PF,geojson:()=>BF,geopath:()=>$F,geopoint:()=>VF,geoshape:()=>HF,graticule:()=>UF,heatmap:()=>zF,isocontour:()=>IF,kde2d:()=>FF,projection:()=>UQ});var xs={};ue.r(xs),ue.d(xs,{force:()=>JF});var As={};ue.r(As),ue.d(As,{nest:()=>sP,pack:()=>aP,partition:()=>uP,stratify:()=>cP,tree:()=>dP,treelinks:()=>hP,treemap:()=>gP});var St={};ue.r(St),ue.d(St,{label:()=>SP});var pt={};ue.r(pt),ue.d(pt,{loess:()=>xP,regression:()=>TP});var Vi={};ue.r(Vi),ue.d(Vi,{voronoi:()=>iL});var lo={};ue.r(lo),ue.d(lo,{wordcloud:()=>sL});var Go={};ue.r(Go),ue.d(Go,{crossfilter:()=>oL,resolvefilter:()=>aL});var Ya={};ue.r(Ya),ue.d(Ya,{Bounds:()=>ui,CanvasHandler:()=>Oy,CanvasRenderer:()=>DC,DATE:()=>as,DAY:()=>fr,DAYOFYEAR:()=>fl,Dataflow:()=>Mg,Debug:()=>dz,Error:()=>YN,EventStream:()=>fD,Gradient:()=>SK,GroupItem:()=>tC,HOURS:()=>Bs,Handler:()=>ff,Info:()=>fz,Item:()=>eC,MILLISECONDS:()=>ca,MINUTES:()=>$s,MONTH:()=>cr,Marks:()=>Hs,MultiPulse:()=>ik,None:()=>cz,Operator:()=>un,Parameters:()=>cD,Pulse:()=>Wc,QUARTER:()=>os,RenderType:()=>hf,Renderer:()=>bl,ResourceLoader:()=>sR,SECONDS:()=>So,SVGHandler:()=>RR,SVGRenderer:()=>VR,SVGStringRenderer:()=>UR,Scenegraph:()=>OR,TIME_UNITS:()=>A2,Transform:()=>K,View:()=>Cte,WEEK:()=>yi,Warn:()=>KN,YEAR:()=>zi,accessor:()=>is,accessorFields:()=>or,accessorName:()=>Un,array:()=>ve,ascending:()=>zw,bandwidthNRD:()=>fk,bin:()=>AW,bootstrapCI:()=>TW,boundClip:()=>UJ,boundContext:()=>by,boundItem:()=>TR,boundMark:()=>rJ,boundStroke:()=>Ru,changeset:()=>Ld,clampRange:()=>Ez,codegenExpression:()=>vee,compare:()=>e2,constant:()=>ur,cumulativeLogNormal:()=>_k,cumulativeNormal:()=>mD,cumulativeUniform:()=>wk,dayofyear:()=>lG,debounce:()=>t2,defaultLocale:()=>U2,definition:()=>vW,densityLogNormal:()=>mk,densityNormal:()=>dk,densityUniform:()=>bk,domChild:()=>cs,domClear:()=>_a,domCreate:()=>cf,domFind:()=>MR,dotbin:()=>OW,error:()=>Q,expressionFunction:()=>ci,extend:()=>Ze,extent:()=>cl,extentIndex:()=>Sz,falsy:()=>Rc,fastmap:()=>yg,field:()=>rs,flush:()=>xz,font:()=>hC,fontFamily:()=>Sy,fontSize:()=>vl,format:()=>iD,formatLocale:()=>tD,formats:()=>X2,hasOwnProperty:()=>Oe,id:()=>N_,identity:()=>ar,inferType:()=>tW,inferTypes:()=>nW,ingest:()=>jt,inherits:()=>ce,inrange:()=>vg,interpolate:()=>qI,interpolateColors:()=>KD,interpolateRange:()=>lK,intersect:()=>BJ,intersectBoxLine:()=>Gg,intersectPath:()=>dR,intersectPoint:()=>hR,intersectRule:()=>UK,isArray:()=>Z,isBoolean:()=>Fc,isDate:()=>Pc,isFunction:()=>Qe,isIterable:()=>Az,isNumber:()=>Xt,isObject:()=>Ce,isRegExp:()=>Tz,isString:()=>_e,isTuple:()=>aD,key:()=>n2,lerp:()=>Oz,lineHeight:()=>lf,loader:()=>rD,locale:()=>QG,logger:()=>JN,lruCache:()=>Mz,markup:()=>$R,merge:()=>Nz,mergeConfig:()=>mg,multiLineOffset:()=>SR,one:()=>gg,pad:()=>kz,panLinear:()=>yz,panLog:()=>vz,panPow:()=>bz,panSymlog:()=>wz,parse:()=>a4e,parseExpression:()=>mL,parseSelector:()=>Of,path:()=>$d,pathCurves:()=>ZI,pathEqual:()=>zJ,pathParse:()=>Hg,pathRectangle:()=>kK,pathRender:()=>gy,pathSymbols:()=>NK,pathTrail:()=>IK,peek:()=>yt,point:()=>gC,projection:()=>kF,quantileLogNormal:()=>yk,quantileNormal:()=>_D,quantileUniform:()=>Dk,quantiles:()=>uk,quantizeInterpolator:()=>uK,quarter:()=>Dz,quartiles:()=>ck,random:()=>xo,randomInteger:()=>oxe,randomKDE:()=>pk,randomLCG:()=>sxe,randomLogNormal:()=>NW,randomMixture:()=>kW,randomNormal:()=>hk,randomUniform:()=>IW,read:()=>oW,regressionExp:()=>FW,regressionLinear:()=>Ck,regressionLoess:()=>$W,regressionLog:()=>RW,regressionPoly:()=>LW,regressionPow:()=>PW,regressionQuad:()=>Ek,renderModule:()=>xC,repeat:()=>k_,resetDefaultLocale:()=>ZEe,resetSVGClipId:()=>FK,resetSVGDefIds:()=>s2e,responseType:()=>sW,runtimeContext:()=>ite,sampleCurve:()=>vD,sampleLogNormal:()=>gk,sampleNormal:()=>gD,sampleUniform:()=>vk,scale:()=>kt,sceneEqual:()=>GR,sceneFromJSON:()=>oJ,scenePickVisit:()=>lC,sceneToJSON:()=>sJ,sceneVisit:()=>ga,sceneZOrder:()=>pR,scheme:()=>YI,serializeXML:()=>TJ,setRandom:()=>ixe,span:()=>I_,splitAccessPath:()=>ul,stringValue:()=>fe,textMetrics:()=>ma,timeBin:()=>AG,timeFloor:()=>gG,timeFormatLocale:()=>q_,timeInterval:()=>xg,timeOffset:()=>yG,timeSequence:()=>wG,timeUnitSpecifier:()=>aG,timeUnits:()=>O2,toBoolean:()=>r2,toDate:()=>s2,toNumber:()=>lr,toSet:()=>ua,toString:()=>o2,transform:()=>bW,transforms:()=>Ng,truncate:()=>Iz,truthy:()=>Co,tupleid:()=>Ie,typeParsers:()=>Y2,utcFloor:()=>mG,utcInterval:()=>Ag,utcOffset:()=>vG,utcSequence:()=>DG,utcdayofyear:()=>fG,utcquarter:()=>Cz,utcweek:()=>dG,version:()=>l4e,visitArray:()=>Lc,week:()=>uG,writeConfig:()=>_g,zero:()=>Ic,zoomLinear:()=>XN,zoomLog:()=>QN,zoomPow:()=>Uw,zoomSymlog:()=>ZN});var Qi={};ue.r(Qi),ue.d(Qi,{accessPathDepth:()=>Tm,accessPathWithDatum:()=>N3,compile:()=>QGe,contains:()=>bt,deepEqual:()=>kl,deleteNestedProperty:()=>bS,duplicate:()=>Je,entries:()=>Nf,every:()=>A3,fieldIntersection:()=>M3,flatAccessWithDatum:()=>Mne,getFirstDefined:()=>fi,hasIntersection:()=>T3,hash:()=>vt,internalField:()=>Ine,isBoolean:()=>Iv,isEmpty:()=>Zt,isEqual:()=>x4e,isInternalField:()=>Rne,isNullOrFalse:()=>x3,isNumeric:()=>wS,keys:()=>ie,logicalExpr:()=>Rv,mergeDeep:()=>Tne,never:()=>Ane,normalize:()=>lse,normalizeAngle:()=>Pv,omit:()=>Zs,pick:()=>Am,prefixGenerator:()=>O3,removePathFromField:()=>k3,replaceAll:()=>xh,replacePathInField:()=>Po,resetIdCounter:()=>T4e,setEqual:()=>One,some:()=>Sh,stringify:()=>gn,titleCase:()=>Fv,unique:()=>Il,uniqueId:()=>kne,vals:()=>yr,varName:()=>An,version:()=>tWe});var Ka={};function qe(e){return"function"==typeof e}function Ue(e){const n=e(i=>{Error.call(i),i.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}ue.r(Ka),ue.d(Ka,{dark:()=>wWe,excel:()=>DWe,fivethirtyeight:()=>SWe,ggplot2:()=>xWe,googlecharts:()=>jWe,latimes:()=>MWe,quartz:()=>NWe,urbaninstitute:()=>LWe,version:()=>BWe,vox:()=>kWe});const qn=Ue(e=>function(n){e(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function Tt(e,t){if(e){const n=e.indexOf(t);0<=n&&e.splice(n,1)}}class Yn{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const s of n)s.remove(this);else n.remove(this);const{initialTeardown:i}=this;if(qe(i))try{i()}catch(s){t=s instanceof qn?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{fp(s)}catch(o){t=null!=t?t:[],o instanceof qn?t=[...t,...o.errors]:t.push(o)}}if(t)throw new qn(t)}}add(t){var n;if(t&&t!==this)if(this.closed)fp(t);else{if(t instanceof Yn){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}}_hasParent(t){const{_parentage:n}=this;return n===t||Array.isArray(n)&&n.includes(t)}_addParent(t){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t}_removeParent(t){const{_parentage:n}=this;n===t?this._parentage=null:Array.isArray(n)&&Tt(n,t)}remove(t){const{_finalizers:n}=this;n&&Tt(n,t),t instanceof Yn&&t._removeParent(this)}}Yn.EMPTY=(()=>{const e=new Yn;return e.closed=!0,e})();const sd=Yn.EMPTY;function Zr(e){return e instanceof Yn||e&&"closed"in e&&qe(e.remove)&&qe(e.add)&&qe(e.unsubscribe)}function fp(e){qe(e)?e():e.unsubscribe()}const Ja={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},iu={setTimeout(e,t,...n){const{delegate:i}=iu;return(null==i?void 0:i.setTimeout)?i.setTimeout(e,t,...n):setTimeout(e,t,...n)},clearTimeout(e){const{delegate:t}=iu;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function ru(e){iu.setTimeout(()=>{const{onUnhandledError:t}=Ja;if(!t)throw e;t(e)})}function su(){}const dp=ou("C",void 0,void 0);function ou(e,t,n){return{kind:e,value:t,error:n}}let au=null;function P1(e){if(Ja.useDeprecatedSynchronousErrorHandling){const t=!au;if(t&&(au={errorThrown:!1,error:null}),e(),t){const{errorThrown:n,error:i}=au;if(au=null,n)throw i}}else e()}class kA extends Yn{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,Zr(t)&&t.add(this)):this.destination=oce}static create(t,n,i){return new L1(t,n,i)}next(t){this.isStopped?RA(function ad(e){return ou("N",e,void 0)}(t),this):this._next(t)}error(t){this.isStopped?RA(function od(e){return ou("E",void 0,e)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?RA(dp,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const ice=Function.prototype.bind;function IA(e,t){return ice.call(e,t)}class rce{constructor(t){this.partialObserver=t}next(t){const{partialObserver:n}=this;if(n.next)try{n.next(t)}catch(i){j1(i)}}error(t){const{partialObserver:n}=this;if(n.error)try{n.error(t)}catch(i){j1(i)}else j1(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(n){j1(n)}}}class L1 extends kA{constructor(t,n,i){let r;if(super(),qe(t)||!t)r={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=i?i:void 0};else{let s;this&&Ja.useDeprecatedNextContext?(s=Object.create(t),s.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&IA(t.next,s),error:t.error&&IA(t.error,s),complete:t.complete&&IA(t.complete,s)}):r=t}this.destination=new rce(r)}}function j1(e){Ja.useDeprecatedSynchronousErrorHandling?function nce(e){Ja.useDeprecatedSynchronousErrorHandling&&au&&(au.errorThrown=!0,au.error=e)}(e):ru(e)}function RA(e,t){const{onStoppedNotification:n}=Ja;n&&iu.setTimeout(()=>n(e,t))}const oce={closed:!0,next:su,error:function sce(e){throw e},complete:su},FA="function"==typeof Symbol&&Symbol.observable||"@@observable";function lu(e){return e}let rn=(()=>{class e{constructor(n){n&&(this._subscribe=n)}lift(n){const i=new e;return i.source=this,i.operator=n,i}subscribe(n,i,r){const s=function lce(e){return e&&e instanceof kA||function ace(e){return e&&qe(e.next)&&qe(e.error)&&qe(e.complete)}(e)&&Zr(e)}(n)?n:new L1(n,i,r);return P1(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(i){n.error(i)}}forEach(n,i){return new(i=e$(i))((r,s)=>{const o=new L1({next:a=>{try{n(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(n){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(n)}[FA](){return this}pipe(...n){return function Z5(e){return 0===e.length?lu:1===e.length?e[0]:function(n){return e.reduce((i,r)=>r(i),n)}}(n)(this)}toPromise(n){return new(n=e$(n))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return e.create=t=>new e(t),e})();function e$(e){var t;return null!==(t=null!=e?e:Ja.Promise)&&void 0!==t?t:Promise}const uce=Ue(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let On=(()=>{class e extends rn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const i=new t$(this,this);return i.operator=n,i}_throwIfClosed(){if(this.closed)throw new uce}next(n){P1(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(n)}})}error(n){P1(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:i}=this;for(;i.length;)i.shift().error(n)}})}complete(){P1(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:i,isStopped:r,observers:s}=this;return i||r?sd:(this.currentObservers=null,s.push(n),new Yn(()=>{this.currentObservers=null,Tt(s,n)}))}_checkFinalizedStatuses(n){const{hasError:i,thrownError:r,isStopped:s}=this;i?n.error(r):s&&n.complete()}asObservable(){const n=new rn;return n.source=this,n}}return e.create=(t,n)=>new t$(t,n),e})();class t$ extends On{constructor(t,n){super(),this.destination=t,this.source=n}next(t){var n,i;null===(i=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===i||i.call(n,t)}error(t){var n,i;null===(i=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===i||i.call(n,t)}complete(){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===n||n.call(t)}_subscribe(t){var n,i;return null!==(i=null===(n=this.source)||void 0===n?void 0:n.subscribe(t))&&void 0!==i?i:sd}}function n$(e){return qe(null==e?void 0:e.lift)}function Kn(e){return t=>{if(n$(t))return t.lift(function(n){try{return e(n,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function _n(e,t,n,i,r){return new cce(e,t,n,i,r)}class cce extends kA{constructor(t,n,i,r,s,o){super(t),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(l){t.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){t.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function lt(e,t){return Kn((n,i)=>{let r=0;n.subscribe(_n(i,s=>{i.next(e.call(t,s,r++))}))})}function ld(e){return this instanceof ld?(this.v=e,this):new ld(e)}function hce(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(d){i[d]&&(r[d]=function(h){return new Promise(function(p,g){s.push([d,h,p,g])>1||a(d,h)})})}function a(d,h){try{!function l(d){d.value instanceof ld?Promise.resolve(d.value.v).then(u,c):f(s[0][2],d)}(i[d](h))}catch(p){f(s[0][3],p)}}function u(d){a("next",d)}function c(d){a("throw",d)}function f(d,h){d(h),s.shift(),s.length&&a(s[0][0],s[0][1])}}function pce(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,t=e[Symbol.asyncIterator];return t?t.call(e):(e=function s$(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(s){n[s]=e[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}(a,l,(o=e[s](o)).done,o.value)})}}}const LA=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function o$(e){return qe(null==e?void 0:e.then)}function a$(e){return qe(e[FA])}function l$(e){return Symbol.asyncIterator&&qe(null==e?void 0:e[Symbol.asyncIterator])}function u$(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const c$=function mce(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function f$(e){return qe(null==e?void 0:e[c$])}function d$(e){return hce(this,arguments,function*(){const n=e.getReader();try{for(;;){const{value:i,done:r}=yield ld(n.read());if(r)return yield ld(void 0);yield yield ld(i)}}finally{n.releaseLock()}})}function h$(e){return qe(null==e?void 0:e.getReader)}function Zi(e){if(e instanceof rn)return e;if(null!=e){if(a$(e))return function _ce(e){return new rn(t=>{const n=e[FA]();if(qe(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(LA(e))return function yce(e){return new rn(t=>{for(let n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(o$(e))return function vce(e){return new rn(t=>{e.then(n=>{t.closed||(t.next(n),t.complete())},n=>t.error(n)).then(null,ru)})}(e);if(l$(e))return p$(e);if(f$(e))return function bce(e){return new rn(t=>{for(const n of e)if(t.next(n),t.closed)return;t.complete()})}(e);if(h$(e))return function wce(e){return p$(d$(e))}(e)}throw u$(e)}function p$(e){return new rn(t=>{(function Dce(e,t){var n,i,r,s;return function fce(e,t,n,i){return new(n||(n=Promise))(function(s,o){function a(c){try{u(i.next(c))}catch(f){o(f)}}function l(c){try{u(i.throw(c))}catch(f){o(f)}}function u(c){c.done?s(c.value):function r(s){return s instanceof n?s:new n(function(o){o(s)})}(c.value).then(a,l)}u((i=i.apply(e,t||[])).next())})}(this,void 0,void 0,function*(){try{for(n=pce(e);!(i=yield n.next()).done;)if(t.next(i.value),t.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=n.return)&&(yield s.call(n))}finally{if(r)throw r.error}}t.complete()})})(e,t).catch(n=>t.error(n))})}function uu(e,t,n,i=0,r=!1){const s=t.schedule(function(){n(),r?e.add(this.schedule(null,i)):this.unsubscribe()},i);if(e.add(s),!r)return s}function ti(e,t,n=1/0){return qe(t)?ti((i,r)=>lt((s,o)=>t(i,s,r,o))(Zi(e(i,r))),n):("number"==typeof t&&(n=t),Kn((i,r)=>function Cce(e,t,n,i,r,s,o,a){const l=[];let u=0,c=0,f=!1;const d=()=>{f&&!l.length&&!u&&t.complete()},h=g=>u<i?p(g):l.push(g),p=g=>{s&&t.next(g),u++;let m=!1;Zi(n(g,c++)).subscribe(_n(t,_=>{null==r||r(_),s?h(_):t.next(_)},()=>{m=!0},void 0,()=>{if(m)try{for(u--;l.length&&u<i;){const _=l.shift();o?uu(t,o,()=>p(_)):p(_)}d()}catch(_){t.error(_)}}))};return e.subscribe(_n(t,h,()=>{f=!0,d()})),()=>{null==a||a()}}(i,r,e,n)))}function m0(e=1/0){return ti(lu,e)}const Wo=new rn(e=>e.complete());function g$(e){return e&&qe(e.schedule)}function jA(e){return e[e.length-1]}function B1(e){return qe(jA(e))?e.pop():void 0}function _0(e){return g$(jA(e))?e.pop():void 0}function m$(e,t=0){return Kn((n,i)=>{n.subscribe(_n(i,r=>uu(i,e,()=>i.next(r),t),()=>uu(i,e,()=>i.complete(),t),r=>uu(i,e,()=>i.error(r),t)))})}function _$(e,t=0){return Kn((n,i)=>{i.add(e.schedule(()=>n.subscribe(i),t))})}function y$(e,t){if(!e)throw new Error("Iterable cannot be null");return new rn(n=>{uu(n,t,()=>{const i=e[Symbol.asyncIterator]();uu(n,t,()=>{i.next().then(r=>{r.done?n.complete():n.next(r.value)})},0,!0)})})}function Ai(e,t){return t?function Nce(e,t){if(null!=e){if(a$(e))return function xce(e,t){return Zi(e).pipe(_$(t),m$(t))}(e,t);if(LA(e))return function Tce(e,t){return new rn(n=>{let i=0;return t.schedule(function(){i===e.length?n.complete():(n.next(e[i++]),n.closed||this.schedule())})})}(e,t);if(o$(e))return function Ace(e,t){return Zi(e).pipe(_$(t),m$(t))}(e,t);if(l$(e))return y$(e,t);if(f$(e))return function Oce(e,t){return new rn(n=>{let i;return uu(n,t,()=>{i=e[c$](),uu(n,t,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void n.error(o)}s?n.complete():n.next(r)},0,!0)}),()=>qe(null==i?void 0:i.return)&&i.return()})}(e,t);if(h$(e))return function Mce(e,t){return y$(d$(e),t)}(e,t)}throw u$(e)}(e,t):Zi(e)}function Hi(e){return e<=0?()=>Wo:Kn((t,n)=>{let i=0;t.subscribe(_n(n,r=>{++i<=e&&(n.next(r),e<=i&&n.complete())}))})}function BA(e,t,...n){return!0===t?(e(),null):!1===t?null:t(...n).pipe(Hi(1)).subscribe(()=>e())}function sn(e){for(let t in e)if(e[t]===sn)return t;throw Error("Could not find renamed property on target object.")}function $A(e,t){for(const n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function Wt(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(Wt).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function VA(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const Rce=sn({__forward_ref__:sn});function xt(e){return e.__forward_ref__=xt,e.toString=function(){return Wt(this())},e}function tt(e){return v$(e)?e():e}function v$(e){return"function"==typeof e&&e.hasOwnProperty(Rce)&&e.__forward_ref__===xt}class Ee extends Error{constructor(t,n){super(function HA(e,t){return`NG0${Math.abs(e)}${t?": "+t:""}`}(t,n)),this.code=t}}function Ye(e){return"string"==typeof e?e:null==e?"":String(e)}function Cr(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Ye(e)}function $1(e,t){const n=t?` in ${t}`:"";throw new Ee(-201,`No provider for ${Cr(e)} found${n}`)}function Os(e,t){null==e&&function yn(e,t,n,i){throw new Error(`ASSERTION ERROR: ${e}`+(null==i?"":` [Expected=> ${n} ${i} ${t} <=Actual]`))}(t,e,null,"!=")}function Te(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Ot(e){return{providers:e.providers||[],imports:e.imports||[]}}function UA(e){return b$(e,V1)||b$(e,D$)}function b$(e,t){return e.hasOwnProperty(t)?e[t]:null}function w$(e){return e&&(e.hasOwnProperty(zA)||e.hasOwnProperty(Vce))?e[zA]:null}const V1=sn({\u0275prov:sn}),zA=sn({\u0275inj:sn}),D$=sn({ngInjectableDef:sn}),Vce=sn({ngInjectorDef:sn});var ze=(()=>((ze=ze||{})[ze.Default=0]="Default",ze[ze.Host=1]="Host",ze[ze.Self=2]="Self",ze[ze.SkipSelf=4]="SkipSelf",ze[ze.Optional=8]="Optional",ze))();let GA;function fc(e){const t=GA;return GA=e,t}function C$(e,t,n){const i=UA(e);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:n&ze.Optional?null:void 0!==t?t:void $1(Wt(e),"Injector")}function dc(e){return{toString:e}.toString()}var qo=(()=>((qo=qo||{})[qo.OnPush=0]="OnPush",qo[qo.Default=1]="Default",qo))(),Yo=(()=>{return(e=Yo||(Yo={}))[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",Yo;var e})();const Uce="undefined"!=typeof globalThis&&globalThis,zce="undefined"!=typeof window&&window,Gce="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Jt=Uce||"undefined"!=typeof global&&global||zce||Gce,hp={},on=[],H1=sn({\u0275cmp:sn}),WA=sn({\u0275dir:sn}),qA=sn({\u0275pipe:sn}),E$=sn({\u0275mod:sn}),fu=sn({\u0275fac:sn}),y0=sn({__NG_ELEMENT_ID__:sn});let Wce=0;function Mn(e){return dc(()=>{const n={},i={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===qo.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||on,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||Yo.Emulated,id:"c",styles:e.styles||on,_:null,setInput:null,schemas:e.schemas||null,tView:null},r=e.directives,s=e.features,o=e.pipes;return i.id+=Wce++,i.inputs=T$(e.inputs,n),i.outputs=T$(e.outputs),s&&s.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(S$):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(x$):null,i})}function S$(e){return er(e)||function hc(e){return e[WA]||null}(e)}function x$(e){return function ud(e){return e[qA]||null}(e)}const A$={};function Lt(e){return dc(()=>{const t={type:e.type,bootstrap:e.bootstrap||on,declarations:e.declarations||on,imports:e.imports||on,exports:e.exports||on,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(A$[e.id]=e.type),t})}function T$(e,t){if(null==e)return hp;const n={};for(const i in e)if(e.hasOwnProperty(i)){let r=e[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),n[r]=i,t&&(t[r]=s)}return n}const me=Mn;function Er(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function er(e){return e[H1]||null}function uo(e,t){const n=e[E$]||null;if(!n&&!0===t)throw new Error(`Type ${Wt(e)} does not have '\u0275mod' property.`);return n}function Xa(e){return Array.isArray(e)&&"object"==typeof e[1]}function Jo(e){return Array.isArray(e)&&!0===e[1]}function JA(e){return 0!=(8&e.flags)}function W1(e){return 2==(2&e.flags)}function q1(e){return 1==(1&e.flags)}function Xo(e){return null!==e.template}function Qce(e){return 0!=(512&e[2])}function hd(e,t){return e.hasOwnProperty(fu)?e[fu]:null}class tfe{constructor(t,n,i){this.previousValue=t,this.currentValue=n,this.firstChange=i}isFirstChange(){return this.firstChange}}function ni(){return M$}function M$(e){return e.type.prototype.ngOnChanges&&(e.setInput=ife),nfe}function nfe(){const e=k$(this),t=null==e?void 0:e.current;if(t){const n=e.previous;if(n===hp)e.previous=t;else for(let i in t)n[i]=t[i];e.current=null,this.ngOnChanges(t)}}function ife(e,t,n,i){const r=k$(e)||function rfe(e,t){return e[N$]=t}(e,{previous:hp,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[n],l=o[a];s[a]=new tfe(l&&l.currentValue,t,o===hp),e[i]=t}ni.ngInherit=!0;const N$="__ngSimpleChanges__";function k$(e){return e[N$]||null}let tT;function jn(e){return!!e.listen}const I$={createRenderer:(e,t)=>function nT(){return void 0!==tT?tT:"undefined"!=typeof document?document:void 0}()};function ii(e){for(;Array.isArray(e);)e=e[0];return e}function Y1(e,t){return ii(t[e])}function ho(e,t){return ii(t[e.index])}function iT(e,t){return e.data[t]}function Ns(e,t){const n=t[e];return Xa(n)?n:n[0]}function R$(e){return 4==(4&e[2])}function rT(e){return 128==(128&e[2])}function pc(e,t){return null==t?null:e[t]}function F$(e){e[18]=0}function sT(e,t){e[5]+=t;let n=e,i=e[3];for(;null!==i&&(1===t&&1===n[5]||-1===t&&0===n[5]);)i[5]+=t,n=i,i=i[3]}const Ve={lFrame:U$(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function P$(){return Ve.bindingsEnabled}function re(){return Ve.lFrame.lView}function wt(){return Ve.lFrame.tView}function ks(e){return Ve.lFrame.contextLView=e,e[8]}function hi(){let e=L$();for(;null!==e&&64===e.type;)e=e.parent;return e}function L$(){return Ve.lFrame.currentTNode}function Qa(e,t){const n=Ve.lFrame;n.currentTNode=e,n.isParent=t}function oT(){return Ve.lFrame.isParent}function aT(){Ve.lFrame.isParent=!1}function K1(){return Ve.isInCheckNoChangesMode}function J1(e){Ve.isInCheckNoChangesMode=e}function Sr(){const e=Ve.lFrame;let t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function vp(){return Ve.lFrame.bindingIndex++}function hu(e){const t=Ve.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function wfe(e,t){const n=Ve.lFrame;n.bindingIndex=n.bindingRootIndex=e,lT(t)}function lT(e){Ve.lFrame.currentDirectiveIndex=e}function $$(){return Ve.lFrame.currentQueryIndex}function cT(e){Ve.lFrame.currentQueryIndex=e}function Cfe(e){const t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function V$(e,t,n){if(n&ze.SkipSelf){let r=t,s=e;for(;!(r=r.parent,null!==r||n&ze.Host||(r=Cfe(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;t=r,e=s}const i=Ve.lFrame=H$();return i.currentTNode=t,i.lView=e,!0}function X1(e){const t=H$(),n=e[1];Ve.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function H$(){const e=Ve.lFrame,t=null===e?null:e.child;return null===t?U$(e):t}function U$(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function z$(){const e=Ve.lFrame;return Ve.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const G$=z$;function Q1(){const e=z$();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function xr(){return Ve.lFrame.selectedIndex}function gc(e){Ve.lFrame.selectedIndex=e}function Bn(){const e=Ve.lFrame;return iT(e.tView,e.selectedIndex)}function Z1(e,t){for(let n=t.directiveStart,i=t.directiveEnd;n<i;n++){const s=e.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:u,ngOnDestroy:c}=s;o&&(e.contentHooks||(e.contentHooks=[])).push(-n,o),a&&((e.contentHooks||(e.contentHooks=[])).push(n,a),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,a)),l&&(e.viewHooks||(e.viewHooks=[])).push(-n,l),u&&((e.viewHooks||(e.viewHooks=[])).push(n,u),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,u)),null!=c&&(e.destroyHooks||(e.destroyHooks=[])).push(n,c)}}function eb(e,t,n){W$(e,t,3,n)}function tb(e,t,n,i){(3&e[2])===n&&W$(e,t,n,i)}function fT(e,t){let n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function W$(e,t,n,i){const s=null!=i?i:-1,o=t.length-1;let a=0;for(let l=void 0!==i?65535&e[18]:0;l<o;l++)if("number"==typeof t[l+1]){if(a=t[l],null!=i&&a>=i)break}else t[l]<0&&(e[18]+=65536),(a<s||-1==s)&&(kfe(e,n,t,l),e[18]=(4294901760&e[18])+l+2),l++}function kfe(e,t,n,i){const r=n[i]<0,s=n[i+1],a=e[r?-n[i]:n[i]];if(r){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class C0{constructor(t,n,i){this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=i}}function nb(e,t,n){const i=jn(e);let r=0;for(;r<n.length;){const s=n[r];if("number"==typeof s){if(0!==s)break;r++;const o=n[r++],a=n[r++],l=n[r++];i?e.setAttribute(t,a,l,o):t.setAttributeNS(o,a,l)}else{const o=s,a=n[++r];hT(o)?i&&e.setProperty(t,o,a):i?e.setAttribute(t,o,a):t.setAttribute(o,a),r++}}return r}function q$(e){return 3===e||4===e||6===e}function hT(e){return 64===e.charCodeAt(0)}function ib(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else{let n=-1;for(let i=0;i<t.length;i++){const r=t[i];"number"==typeof r?n=r:0===n||Y$(e,n,r,null,-1===n||2===n?t[++i]:null)}}return e}function Y$(e,t,n,i,r){let s=0,o=e.length;if(-1===t)o=-1;else for(;s<e.length;){const a=e[s++];if("number"==typeof a){if(a===t){o=-1;break}if(a>t){o=s-1;break}}}for(;s<e.length;){const a=e[s];if("number"==typeof a)break;if(a===n){if(null===i)return void(null!==r&&(e[s+1]=r));if(i===e[s+1])return void(e[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(e.splice(o,0,t),s=o+1),e.splice(s++,0,n),null!==i&&e.splice(s++,0,i),null!==r&&e.splice(s++,0,r)}function K$(e){return-1!==e}function bp(e){return 32767&e}function wp(e,t){let n=function Lfe(e){return e>>16}(e),i=t;for(;n>0;)i=i[15],n--;return i}let pT=!0;function rb(e){const t=pT;return pT=e,t}let jfe=0;function S0(e,t){const n=mT(e,t);if(-1!==n)return n;const i=t[1];i.firstCreatePass&&(e.injectorIndex=t.length,gT(i.data,e),gT(t,null),gT(i.blueprint,null));const r=sb(e,t),s=e.injectorIndex;if(K$(r)){const o=bp(r),a=wp(r,t),l=a[1].data;for(let u=0;u<8;u++)t[s+u]=a[o+u]|l[o+u]}return t[s+8]=r,s}function gT(e,t){e.push(0,0,0,0,0,0,0,0,t)}function mT(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function sb(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,i=null,r=t;for(;null!==r;){const s=r[1],o=s.type;if(i=2===o?s.declTNode:1===o?r[6]:null,null===i)return-1;if(n++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|n<<16}return-1}function ob(e,t,n){!function Bfe(e,t,n){let i;"string"==typeof n?i=n.charCodeAt(0)||0:n.hasOwnProperty(y0)&&(i=n[y0]),null==i&&(i=n[y0]=jfe++);const r=255&i;t.data[e+(r>>5)]|=1<<r}(e,t,n)}function Q$(e,t,n){if(n&ze.Optional)return e;$1(t,"NodeInjector")}function Z$(e,t,n,i){if(n&ze.Optional&&void 0===i&&(i=null),0==(n&(ze.Self|ze.Host))){const r=e[9],s=fc(void 0);try{return r?r.get(t,i,n&ze.Optional):C$(t,i,n&ze.Optional)}finally{fc(s)}}return Q$(i,t,n)}function e8(e,t,n,i=ze.Default,r){if(null!==e){const s=function Ufe(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(y0)?e[y0]:void 0;return"number"==typeof t?t>=0?255&t:Vfe:t}(n);if("function"==typeof s){if(!V$(t,e,i))return i&ze.Host?Q$(r,n,i):Z$(t,n,i,r);try{const o=s(i);if(null!=o||i&ze.Optional)return o;$1(n)}finally{G$()}}else if("number"==typeof s){let o=null,a=mT(e,t),l=-1,u=i&ze.Host?t[16][6]:null;for((-1===a||i&ze.SkipSelf)&&(l=-1===a?sb(e,t):t[a+8],-1!==l&&i8(i,!1)?(o=t[1],a=bp(l),t=wp(l,t)):a=-1);-1!==a;){const c=t[1];if(n8(s,a,c.data)){const f=Hfe(a,t,n,o,i,u);if(f!==t8)return f}l=t[a+8],-1!==l&&i8(i,t[1].data[a+8]===u)&&n8(s,a,t)?(o=c,a=bp(l),t=wp(l,t)):a=-1}}}return Z$(t,n,i,r)}const t8={};function Vfe(){return new Dp(hi(),re())}function Hfe(e,t,n,i,r,s){const o=t[1],a=o.data[e+8],c=ab(a,o,n,null==i?W1(a)&&pT:i!=o&&0!=(3&a.type),r&ze.Host&&s===a);return null!==c?x0(t,o,c,a):t8}function ab(e,t,n,i,r){const s=e.providerIndexes,o=t.data,a=1048575&s,l=e.directiveStart,c=s>>20,d=r?a+c:e.directiveEnd;for(let h=i?a:a+c;h<d;h++){const p=o[h];if(h<l&&n===p||h>=l&&p.type===n)return h}if(r){const h=o[l];if(h&&Xo(h)&&h.type===n)return l}return null}function x0(e,t,n,i){let r=e[n];const s=t.data;if(function Ife(e){return e instanceof C0}(r)){const o=r;o.resolving&&function Fce(e,t){const n=t?`. Dependency path: ${t.join(" > ")} > ${e}`:"";throw new Ee(-200,`Circular dependency in DI detected for ${e}${n}`)}(Cr(s[n]));const a=rb(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?fc(o.injectImpl):null;V$(e,i,ze.Default);try{r=e[n]=o.factory(void 0,s,e,i),t.firstCreatePass&&n>=i.directiveStart&&function Nfe(e,t,n){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=t.type.prototype;if(i){const o=M$(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,o)}r&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,r),s&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s))}(n,s[n],t)}finally{null!==l&&fc(l),rb(a),o.resolving=!1,G$()}}return r}function n8(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function i8(e,t){return!(e&ze.Self||e&ze.Host&&t)}class Dp{constructor(t,n){this._tNode=t,this._lView=n}get(t,n,i){return e8(this._tNode,this._lView,t,i,n)}}function nr(e){return dc(()=>{const t=e.prototype.constructor,n=t[fu]||_T(t),i=Object.prototype;let r=Object.getPrototypeOf(e.prototype).constructor;for(;r&&r!==i;){const s=r[fu]||_T(r);if(s&&s!==n)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function _T(e){return v$(e)?()=>{const t=_T(tt(e));return t&&t()}:hd(e)}const Ep="__parameters__";function xp(e,t,n){return dc(()=>{const i=function yT(e){return function(...n){if(e){const i=e(...n);for(const r in i)this[r]=i[r]}}}(t);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,u,c){const f=l.hasOwnProperty(Ep)?l[Ep]:Object.defineProperty(l,Ep,{value:[]})[Ep];for(;f.length<=c;)f.push(null);return(f[c]=f[c]||[]).push(o),l}}return n&&(r.prototype=Object.create(n.prototype)),r.prototype.ngMetadataName=e,r.annotationCls=r,r})}class Xe{constructor(t,n){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Te({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Gfe=new Xe("AnalyzeForEntryComponents");function po(e,t){void 0===t&&(t=e);for(let n=0;n<e.length;n++){let i=e[n];Array.isArray(i)?(t===e&&(t=e.slice(0,n)),po(i,t)):t!==e&&t.push(i)}return t}function Za(e,t){e.forEach(n=>Array.isArray(n)?Za(n,t):t(n))}function s8(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function lb(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function O0(e,t){const n=[];for(let i=0;i<e;i++)n.push(t);return n}function Is(e,t,n){let i=Ap(e,t);return i>=0?e[1|i]=n:(i=~i,function Yfe(e,t,n,i){let r=e.length;if(r==t)e.push(n,i);else if(1===r)e.push(i,e[0]),e[0]=n;else{for(r--,e.push(e[r-1],e[r]);r>t;)e[r]=e[r-2],r--;e[t]=n,e[t+1]=i}}(e,i,t,n)),i}function bT(e,t){const n=Ap(e,t);if(n>=0)return e[1|n]}function Ap(e,t){return function l8(e,t,n){let i=0,r=e.length>>n;for(;r!==i;){const s=i+(r-i>>1),o=e[s<<n];if(t===o)return s<<n;o>t?r=s:i=s+1}return~(r<<n)}(e,t,1)}const M0={},DT="__NG_DI_FLAG__",cb="ngTempTokenPath",tde=/\n/gm,c8="__source",ide=sn({provide:String,useValue:sn});let N0;function f8(e){const t=N0;return N0=e,t}function rde(e,t=ze.Default){if(void 0===N0)throw new Ee(203,"");return null===N0?C$(e,void 0,t):N0.get(e,t&ze.Optional?null:void 0,t)}function ge(e,t=ze.Default){return(function Hce(){return GA}()||rde)(tt(e),t)}const sde=ge;function CT(e){const t=[];for(let n=0;n<e.length;n++){const i=tt(e[n]);if(Array.isArray(i)){if(0===i.length)throw new Ee(900,"");let r,s=ze.Default;for(let o=0;o<i.length;o++){const a=i[o],l=ode(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}t.push(ge(r,s))}else t.push(ge(i))}return t}function k0(e,t){return e[DT]=t,e.prototype[DT]=t,e}function ode(e){return e[DT]}const fb=k0(xp("Inject",e=>({token:e})),-1),_c=k0(xp("Optional"),8),I0=k0(xp("SkipSelf"),4);class b8{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function yc(e){return e instanceof b8?e.changingThisBreaksApplicationSecurity:e}const Tde=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Ode=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var ri=(()=>((ri=ri||{})[ri.NONE=0]="NONE",ri[ri.HTML=1]="HTML",ri[ri.STYLE=2]="STYLE",ri[ri.SCRIPT=3]="SCRIPT",ri[ri.URL=4]="URL",ri[ri.RESOURCE_URL=5]="RESOURCE_URL",ri))();function _b(e){const t=function L0(){const e=re();return e&&e[12]}();return t?t.sanitize(ri.URL,e)||"":function F0(e,t){const n=function Ede(e){return e instanceof b8&&e.getTypeName()||null}(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===t}(e,"URL")?yc(e):function gb(e){return(e=String(e)).match(Tde)||e.match(Ode)?e:"unsafe:"+e}(Ye(e))}const M8="__ngContext__";function ir(e,t){e[M8]=t}function kT(e){const t=function j0(e){return e[M8]||null}(e);return t?Array.isArray(t)?t:t.lView:null}function RT(e){return e.ngOriginalError}function Qde(e,...t){e.error(...t)}class B0{constructor(){this._console=console}handleError(t){const n=this._findOriginalError(t),i=function Xde(e){return e&&e.ngErrorLogger||Qde}(t);i(this._console,"ERROR",t),n&&i(this._console,"ORIGINAL ERROR",n)}_findOriginalError(t){let n=t&&RT(t);for(;n&&RT(n);)n=RT(n);return n||null}}const lhe=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Jt))();function tl(e){return e instanceof Function?e():e}var Rs=(()=>((Rs=Rs||{})[Rs.Important=1]="Important",Rs[Rs.DashCase=2]="DashCase",Rs))();function PT(e,t){return undefined(e,t)}function $0(e){const t=e[3];return Jo(t)?t[3]:t}function LT(e){return B8(e[13])}function jT(e){return B8(e[4])}function B8(e){for(;null!==e&&!Jo(e);)e=e[4];return e}function Np(e,t,n,i,r){if(null!=i){let s,o=!1;Jo(i)?s=i:Xa(i)&&(o=!0,i=i[0]);const a=ii(i);0===e&&null!==n?null==r?G8(t,n,a):gd(t,n,a,r||null,!0):1===e&&null!==n?gd(t,n,a,r||null,!0):2===e?function Q8(e,t,n){const i=yb(e,t);i&&function Dhe(e,t,n,i){jn(e)?e.removeChild(t,n,i):t.removeChild(n)}(e,i,t,n)}(t,a,o):3===e&&t.destroyNode(a),null!=s&&function She(e,t,n,i,r){const s=n[7];s!==ii(n)&&Np(t,e,i,s,r);for(let a=10;a<n.length;a++){const l=n[a];V0(l[1],l,e,t,i,s)}}(t,e,s,n,r)}}function $T(e,t,n){if(jn(e))return e.createElement(t,n);{const i=null!==n?function lfe(e){const t=e.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(n):null;return null===i?e.createElement(t):e.createElementNS(i,t)}}function V8(e,t){const n=e[9],i=n.indexOf(t),r=t[3];1024&t[2]&&(t[2]&=-1025,sT(r,-1)),n.splice(i,1)}function VT(e,t){if(e.length<=10)return;const n=10+t,i=e[n];if(i){const r=i[17];null!==r&&r!==e&&V8(r,i),t>0&&(e[n-1][4]=i[4]);const s=lb(e,10+t);!function phe(e,t){V0(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function H8(e,t){if(!(256&t[2])){const n=t[11];jn(n)&&n.destroyNode&&V0(e,t,n,3,null,null),function _he(e){let t=e[13];if(!t)return HT(e[1],e);for(;t;){let n=null;if(Xa(t))n=t[13];else{const i=t[10];i&&(n=i)}if(!n){for(;t&&!t[4]&&t!==e;)Xa(t)&&HT(t[1],t),t=t[3];null===t&&(t=e),Xa(t)&&HT(t[1],t),n=t&&t[4]}t=n}}(t)}}function HT(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function whe(e,t){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let i=0;i<n.length;i+=2){const r=t[n[i]];if(!(r instanceof C0)){const s=n[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(e,t),function bhe(e,t){const n=e.cleanup,i=t[7];let r=-1;if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const o=n[s+1],a="function"==typeof o?o(t):ii(t[o]),l=i[r=n[s+2]],u=n[s+3];"boolean"==typeof u?a.removeEventListener(n[s],l,u):u>=0?i[r=u]():i[r=-u].unsubscribe(),s+=2}else{const o=i[r=n[s+1]];n[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();t[7]=null}}(e,t),1===t[1].type&&jn(t[11])&&t[11].destroy();const n=t[17];if(null!==n&&Jo(t[3])){n!==t[3]&&V8(n,t);const i=t[19];null!==i&&i.detachView(e)}}}function U8(e,t,n){return function z8(e,t,n){let i=t;for(;null!==i&&40&i.type;)i=(t=i).parent;if(null===i)return n[0];if(2&i.flags){const r=e.data[i.directiveStart].encapsulation;if(r===Yo.None||r===Yo.Emulated)return null}return ho(i,n)}(e,t.parent,n)}function gd(e,t,n,i,r){jn(e)?e.insertBefore(t,n,i,r):t.insertBefore(n,i,r)}function G8(e,t,n){jn(e)?e.appendChild(t,n):t.appendChild(n)}function W8(e,t,n,i,r){null!==i?gd(e,t,n,i,r):G8(e,t,n)}function yb(e,t){return jn(e)?e.parentNode(t):t.parentNode}function q8(e,t,n){return K8(e,t,n)}let K8=function Y8(e,t,n){return 40&e.type?ho(e,n):null};function vb(e,t,n,i){const r=U8(e,i,t),s=t[11],a=q8(i.parent||t[6],i,t);if(null!=r)if(Array.isArray(n))for(let l=0;l<n.length;l++)W8(s,r,n[l],a,!1);else W8(s,r,n,a,!1)}function bb(e,t){if(null!==t){const n=t.type;if(3&n)return ho(t,e);if(4&n)return zT(-1,e[t.index]);if(8&n){const i=t.child;if(null!==i)return bb(e,i);{const r=e[t.index];return Jo(r)?zT(-1,r):ii(r)}}if(32&n)return PT(t,e)()||ii(e[t.index]);{const i=X8(e,t);return null!==i?Array.isArray(i)?i[0]:bb($0(e[16]),i):bb(e,t.next)}}return null}function X8(e,t){return null!==t?e[16][6].projection[t.projection]:null}function zT(e,t){const n=10+e+1;if(n<t.length){const i=t[n],r=i[1].firstChild;if(null!==r)return bb(i,r)}return t[7]}function GT(e,t,n,i,r,s,o){for(;null!=n;){const a=i[n.index],l=n.type;if(o&&0===t&&(a&&ir(ii(a),i),n.flags|=4),64!=(64&n.flags))if(8&l)GT(e,t,n.child,i,r,s,!1),Np(t,e,r,a,s);else if(32&l){const u=PT(n,i);let c;for(;c=u();)Np(t,e,r,c,s);Np(t,e,r,a,s)}else 16&l?Z8(e,t,i,n,r,s):Np(t,e,r,a,s);n=o?n.projectionNext:n.next}}function V0(e,t,n,i,r,s){GT(n,i,e.firstChild,t,r,s,!1)}function Z8(e,t,n,i,r,s){const o=n[16],l=o[6].projection[i.projection];if(Array.isArray(l))for(let u=0;u<l.length;u++)Np(t,e,r,l[u],s);else GT(e,t,l,o[3],r,s,!0)}function e4(e,t,n){jn(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function WT(e,t,n){jn(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function t4(e,t,n){let i=e.length;for(;;){const r=e.indexOf(t,n);if(-1===r)return r;if(0===r||e.charCodeAt(r-1)<=32){const s=t.length;if(r+s===i||e.charCodeAt(r+s)<=32)return r}n=r+1}}const n4="ng-template";function Ahe(e,t,n){let i=0;for(;i<e.length;){let r=e[i++];if(n&&"class"===r){if(r=e[i],-1!==t4(r.toLowerCase(),t,0))return!0}else if(1===r){for(;i<e.length&&"string"==typeof(r=e[i++]);)if(r.toLowerCase()===t)return!0;return!1}}return!1}function i4(e){return 4===e.type&&e.value!==n4}function The(e,t,n){return t===(4!==e.type||n?e.value:n4)}function Ohe(e,t,n){let i=4;const r=e.attrs||[],s=function khe(e){for(let t=0;t<e.length;t++)if(q$(e[t]))return t;return e.length}(r);let o=!1;for(let a=0;a<t.length;a++){const l=t[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!The(e,l,n)||""===l&&1===t.length){if(Qo(i))return!1;o=!0}}else{const u=8&i?l:t[++a];if(8&i&&null!==e.attrs){if(!Ahe(e.attrs,u,n)){if(Qo(i))return!1;o=!0}continue}const f=Mhe(8&i?"class":l,r,i4(e),n);if(-1===f){if(Qo(i))return!1;o=!0;continue}if(""!==u){let d;d=f>s?"":r[f+1].toLowerCase();const h=8&i?d:null;if(h&&-1!==t4(h,u,0)||2&i&&u!==d){if(Qo(i))return!1;o=!0}}}}else{if(!o&&!Qo(i)&&!Qo(l))return!1;if(o&&Qo(l))continue;o=!1,i=l|1&i}}return Qo(i)||o}function Qo(e){return 0==(1&e)}function Mhe(e,t,n,i){if(null===t)return-1;let r=0;if(i||!n){let s=!1;for(;r<t.length;){const o=t[r];if(o===e)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=t[++r];for(;"string"==typeof a;)a=t[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function Ihe(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const i=e[n];if("number"==typeof i)return-1;if(i===t)return n;n++}return-1}(t,e)}function r4(e,t,n=!1){for(let i=0;i<t.length;i++)if(Ohe(e,t[i],n))return!0;return!1}function Rhe(e,t){e:for(let n=0;n<t.length;n++){const i=t[n];if(e.length===i.length){for(let r=0;r<e.length;r++)if(e[r]!==i[r])continue e;return!0}}return!1}function s4(e,t){return e?":not("+t.trim()+")":t}function Fhe(e){let t=e[0],n=1,i=2,r="",s=!1;for(;n<e.length;){let o=e[n];if("string"==typeof o)if(2&i){const a=e[++n];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Qo(o)&&(t+=s4(s,r),r=""),i=o,s=s||!Qo(i);n++}return""!==r&&(t+=s4(s,r)),t}const Ke={};function ne(e){o4(wt(),re(),xr()+e,K1())}function o4(e,t,n,i){if(!i)if(3==(3&t[2])){const s=e.preOrderCheckHooks;null!==s&&eb(t,s,n)}else{const s=e.preOrderHooks;null!==s&&tb(t,s,0,n)}gc(n)}function wb(e,t){return e<<17|t<<2}function Zo(e){return e>>17&32767}function qT(e){return 2|e}function pu(e){return(131068&e)>>2}function YT(e,t){return-131069&e|t<<2}function KT(e){return 1|e}function _4(e,t){const n=e.contentQueries;if(null!==n)for(let i=0;i<n.length;i+=2){const r=n[i],s=n[i+1];if(-1!==s){const o=e.data[s];cT(r),o.contentQueries(2,t[s],s)}}}function H0(e,t,n,i,r,s,o,a,l,u){const c=t.blueprint.slice();return c[0]=r,c[2]=140|i,F$(c),c[3]=c[15]=e,c[8]=n,c[10]=o||e&&e[10],c[11]=a||e&&e[11],c[12]=l||e&&e[12]||null,c[9]=u||e&&e[9]||null,c[6]=s,c[16]=2==t.type?e[16]:c,c}function kp(e,t,n,i,r){let s=e.data[t];if(null===s)s=function rO(e,t,n,i,r){const s=L$(),o=oT(),l=e.data[t]=function Zhe(e,t,n,i,r,s){return{type:n,index:i,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,t,i,r);return null===e.firstChild&&(e.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(e,t,n,i,r),function bfe(){return Ve.lFrame.inI18n}()&&(s.flags|=64);else if(64&s.type){s.type=n,s.value=i,s.attrs=r;const o=function D0(){const e=Ve.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Qa(s,!0),s}function Ip(e,t,n,i){if(0===n)return-1;const r=t.length;for(let s=0;s<n;s++)t.push(i),e.blueprint.push(i),e.data.push(null);return r}function U0(e,t,n){X1(t);try{const i=e.viewQuery;null!==i&&hO(1,i,n);const r=e.template;null!==r&&y4(e,t,r,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&_4(e,t),e.staticViewQueries&&hO(2,e.viewQuery,n);const s=e.components;null!==s&&function Jhe(e,t){for(let n=0;n<t.length;n++)_pe(e,t[n])}(t,s)}catch(i){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),i}finally{t[2]&=-5,Q1()}}function Rp(e,t,n,i){const r=t[2];if(256==(256&r))return;X1(t);const s=K1();try{F$(t),function j$(e){return Ve.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&y4(e,t,n,2,i);const o=3==(3&r);if(!s)if(o){const u=e.preOrderCheckHooks;null!==u&&eb(t,u,null)}else{const u=e.preOrderHooks;null!==u&&tb(t,u,0,null),fT(t,0)}if(function gpe(e){for(let t=LT(e);null!==t;t=jT(t)){if(!t[2])continue;const n=t[9];for(let i=0;i<n.length;i++){const r=n[i],s=r[3];0==(1024&r[2])&&sT(s,1),r[2]|=1024}}}(t),function ppe(e){for(let t=LT(e);null!==t;t=jT(t))for(let n=10;n<t.length;n++){const i=t[n],r=i[1];rT(i)&&Rp(r,i,r.template,i[8])}}(t),null!==e.contentQueries&&_4(e,t),!s)if(o){const u=e.contentCheckHooks;null!==u&&eb(t,u)}else{const u=e.contentHooks;null!==u&&tb(t,u,1),fT(t,1)}!function Yhe(e,t){const n=e.hostBindingOpCodes;if(null!==n)try{for(let i=0;i<n.length;i++){const r=n[i];if(r<0)gc(~r);else{const s=r,o=n[++i],a=n[++i];wfe(o,s),a(2,t[s])}}}finally{gc(-1)}}(e,t);const a=e.components;null!==a&&function Khe(e,t){for(let n=0;n<t.length;n++)mpe(e,t[n])}(t,a);const l=e.viewQuery;if(null!==l&&hO(2,l,i),!s)if(o){const u=e.viewCheckHooks;null!==u&&eb(t,u)}else{const u=e.viewHooks;null!==u&&tb(t,u,2),fT(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),s||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,sT(t[3],-1))}finally{Q1()}}function Xhe(e,t,n,i){const r=t[10],s=!K1(),o=R$(t);try{s&&!o&&r.begin&&r.begin(),o&&U0(e,t,i),Rp(e,t,n,i)}finally{s&&!o&&r.end&&r.end()}}function y4(e,t,n,i,r){const s=xr(),o=2&i;try{gc(-1),o&&t.length>20&&o4(e,t,20,K1()),n(i,r)}finally{gc(s)}}function sO(e,t,n){!P$()||(function ope(e,t,n,i){const r=n.directiveStart,s=n.directiveEnd;e.firstCreatePass||S0(n,t),ir(i,t);const o=n.initialInputs;for(let a=r;a<s;a++){const l=e.data[a],u=Xo(l);u&&fpe(t,n,l);const c=x0(t,e,a,n);ir(c,t),null!==o&&dpe(0,a-r,c,l,0,o),u&&(Ns(n.index,t)[8]=c)}}(e,t,n,ho(n,t)),128==(128&n.flags)&&function ape(e,t,n){const i=n.directiveStart,r=n.directiveEnd,o=n.index,a=function Dfe(){return Ve.lFrame.currentDirectiveIndex}();try{gc(o);for(let l=i;l<r;l++){const u=e.data[l],c=t[l];lT(l),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&A4(u,c)}}finally{gc(-1),lT(a)}}(e,t,n))}function oO(e,t,n=ho){const i=t.localNames;if(null!==i){let r=t.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?n(t,e):e[o];e[r++]=a}}}function b4(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Eb(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function Eb(e,t,n,i,r,s,o,a,l,u){const c=20+i,f=c+r,d=function Qhe(e,t){const n=[];for(let i=0;i<t;i++)n.push(i<e?null:Ke);return n}(c,f),h="function"==typeof u?u():u;return d[1]={type:e,blueprint:d,template:n,queries:null,viewQuery:a,declTNode:t,data:d.slice().fill(null,c),bindingStartIndex:c,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:h,incompleteFirstPass:!1}}function C4(e,t,n,i){const r=I4(t);null===n?r.push(i):(r.push(n),e.firstCreatePass&&R4(e).push(i,r.length-1))}function E4(e,t,n){for(let i in e)if(e.hasOwnProperty(i)){const r=e[i];(n=null===n?{}:n).hasOwnProperty(i)?n[i].push(t,r):n[i]=[t,r]}return n}function Fs(e,t,n,i,r,s,o,a){const l=ho(t,n);let c,u=t.inputs;!a&&null!=u&&(c=u[i])?(L4(e,n,c,i,r),W1(t)&&function npe(e,t){const n=Ns(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(i=function tpe(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(i),r=null!=o?o(r,t.value||"",i):r,jn(s)?s.setProperty(l,i,r):hT(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function aO(e,t,n,i){let r=!1;if(P$()){const s=function lpe(e,t,n){const i=e.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];r4(n,o.selectors,!1)&&(r||(r=[]),ob(S0(n,t),e,o.type),Xo(o)?(T4(e,n),r.unshift(o)):r.push(o))}return r}(e,t,n),o=null===i?null:{"":-1};if(null!==s){r=!0,O4(n,e.data.length,s.length);for(let c=0;c<s.length;c++){const f=s[c];f.providersResolver&&f.providersResolver(f)}let a=!1,l=!1,u=Ip(e,t,s.length,null);for(let c=0;c<s.length;c++){const f=s[c];n.mergedAttrs=ib(n.mergedAttrs,f.hostAttrs),M4(e,n,t,u,f),cpe(u,f,o),null!==f.contentQueries&&(n.flags|=8),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(n.flags|=128);const d=f.type.prototype;!a&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),a=!0),!l&&(d.ngOnChanges||d.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),l=!0),u++}!function epe(e,t){const i=t.directiveEnd,r=e.data,s=t.attrs,o=[];let a=null,l=null;for(let u=t.directiveStart;u<i;u++){const c=r[u],f=c.inputs,d=null===s||i4(t)?null:hpe(f,s);o.push(d),a=E4(f,u,a),l=E4(c.outputs,u,l)}null!==a&&(a.hasOwnProperty("class")&&(t.flags|=16),a.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=o,t.inputs=a,t.outputs=l}(e,n)}o&&function upe(e,t,n){if(t){const i=e.localNames=[];for(let r=0;r<t.length;r+=2){const s=n[t[r+1]];if(null==s)throw new Ee(-301,!1);i.push(t[r],s)}}}(n,i,o)}return n.mergedAttrs=ib(n.mergedAttrs,n.attrs),r}function x4(e,t,n,i,r,s){const o=s.hostBindings;if(o){let a=e.hostBindingOpCodes;null===a&&(a=e.hostBindingOpCodes=[]);const l=~t.index;(function spe(e){let t=e.length;for(;t>0;){const n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(a)!=l&&a.push(l),a.push(i,r,o)}}function A4(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function T4(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function cpe(e,t,n){if(n){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)n[t.exportAs[i]]=e;Xo(t)&&(n[""]=e)}}function O4(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function M4(e,t,n,i,r){e.data[i]=r;const s=r.factory||(r.factory=hd(r.type)),o=new C0(s,Xo(r),null);e.blueprint[i]=o,n[i]=o,x4(e,t,0,i,Ip(e,n,r.hostVars,Ke),r)}function fpe(e,t,n){const i=ho(t,e),r=b4(n),s=e[10],o=Sb(e,H0(e,r,null,n.onPush?64:16,i,t,s,s.createRenderer(i,n),null,null));e[t.index]=o}function nl(e,t,n,i,r,s){const o=ho(e,t);!function lO(e,t,n,i,r,s,o){if(null==s)jn(e)?e.removeAttribute(t,r,n):t.removeAttribute(r);else{const a=null==o?Ye(s):o(s,i||"",r);jn(e)?e.setAttribute(t,r,a,n):n?t.setAttributeNS(n,r,a):t.setAttribute(r,a)}}(t[11],o,s,e.value,n,i,r)}function dpe(e,t,n,i,r,s){const o=s[t];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const u=o[l++],c=o[l++],f=o[l++];null!==a?i.setInput(n,f,u,c):n[c]=f}}}function hpe(e,t){let n=null,i=0;for(;i<t.length;){const r=t[i];if(0!==r)if(5!==r){if("number"==typeof r)break;e.hasOwnProperty(r)&&(null===n&&(n=[]),n.push(r,e[r],t[i+1])),i+=2}else i+=2;else i+=4}return n}function N4(e,t,n,i){return new Array(e,!0,!1,t,null,0,i,n,null,null)}function mpe(e,t){const n=Ns(t,e);if(rT(n)){const i=n[1];80&n[2]?Rp(i,n,i.template,n[8]):n[5]>0&&uO(n)}}function uO(e){for(let i=LT(e);null!==i;i=jT(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const o=s[1];Rp(o,s,o.template,s[8])}else s[5]>0&&uO(s)}const n=e[1].components;if(null!==n)for(let i=0;i<n.length;i++){const r=Ns(n[i],e);rT(r)&&r[5]>0&&uO(r)}}function _pe(e,t){const n=Ns(t,e),i=n[1];(function ype(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])})(i,n),U0(i,n,n[8])}function Sb(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function cO(e){for(;e;){e[2]|=64;const t=$0(e);if(Qce(e)&&!t)return e;e=t}return null}function dO(e,t,n){const i=t[10];i.begin&&i.begin();try{Rp(e,t,e.template,n)}catch(r){throw P4(t,r),r}finally{i.end&&i.end()}}function k4(e){!function fO(e){for(let t=0;t<e.components.length;t++){const n=e.components[t],i=kT(n),r=i[1];Xhe(r,i,r.template,n)}}(e[8])}function hO(e,t,n){cT(0),t(e,n)}const Dpe=(()=>Promise.resolve(null))();function I4(e){return e[7]||(e[7]=[])}function R4(e){return e.cleanup||(e.cleanup=[])}function P4(e,t){const n=e[9],i=n?n.get(B0,null):null;i&&i.handleError(t)}function L4(e,t,n,i,r){for(let s=0;s<n.length;){const o=n[s++],a=n[s++],l=t[o],u=e.data[o];null!==u.setInput?u.setInput(l,r,i,a):l[a]=r}}function gu(e,t,n){const i=Y1(t,e);!function $8(e,t,n){jn(e)?e.setValue(t,n):t.textContent=n}(e[11],i,n)}function xb(e,t,n){let i=n?e.styles:null,r=n?e.classes:null,s=0;if(null!==t)for(let o=0;o<t.length;o++){const a=t[o];"number"==typeof a?s=a:1==s?r=VA(r,a):2==s&&(i=VA(i,a+": "+t[++o]+";"))}n?e.styles=i:e.stylesWithoutHost=i,n?e.classes=r:e.classesWithoutHost=r}const pO=new Xe("INJECTOR",-1);class j4{get(t,n=M0){if(n===M0){const i=new Error(`NullInjectorError: No provider for ${Wt(t)}!`);throw i.name="NullInjectorError",i}return n}}const gO=new Xe("Set Injector scope."),z0={},Spe={};let mO;function B4(){return void 0===mO&&(mO=new j4),mO}function $4(e,t=null,n=null,i){const r=V4(e,t,n,i);return r._resolveInjectorDefTypes(),r}function V4(e,t=null,n=null,i){return new xpe(e,n,t||B4(),i)}class xpe{constructor(t,n,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];n&&Za(n,a=>this.processProvider(a,t,n)),Za([t],a=>this.processInjectorType(a,[],s)),this.records.set(pO,Fp(void 0,this));const o=this.records.get(gO);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof t?null:Wt(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,n=M0,i=ze.Default){this.assertNotDestroyed();const r=f8(this),s=fc(void 0);try{if(!(i&ze.SkipSelf)){let a=this.records.get(t);if(void 0===a){const l=function Rpe(e){return"function"==typeof e||"object"==typeof e&&e instanceof Xe}(t)&&UA(t);a=l&&this.injectableDefInScope(l)?Fp(_O(t),z0):null,this.records.set(t,a)}if(null!=a)return this.hydrate(t,a)}return(i&ze.Self?B4():this.parent).get(t,n=i&ze.Optional&&n===M0?null:n)}catch(o){if("NullInjectorError"===o.name){if((o[cb]=o[cb]||[]).unshift(Wt(t)),r)throw o;return function ade(e,t,n,i){const r=e[cb];throw t[c8]&&r.unshift(t[c8]),e.message=function lde(e,t,n,i=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;let r=Wt(t);if(Array.isArray(t))r=t.map(Wt).join(" -> ");else if("object"==typeof t){let s=[];for(let o in t)if(t.hasOwnProperty(o)){let a=t[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Wt(a)))}r=`{${s.join(", ")}}`}return`${n}${i?"("+i+")":""}[${r}]: ${e.replace(tde,"\n  ")}`}("\n"+e.message,r,n,i),e.ngTokenPath=r,e[cb]=null,e}(o,t,"R3InjectorError",this.source)}throw o}finally{fc(s),f8(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((i,r)=>t.push(Wt(r))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ee(205,!1)}processInjectorType(t,n,i){if(!(t=tt(t)))return!1;let r=w$(t);const s=null==r&&t.ngModule||void 0,o=void 0===s?t:s,a=-1!==i.indexOf(o);if(void 0!==s&&(r=w$(s)),null==r)return!1;if(null!=r.imports&&!a){let c;i.push(o);try{Za(r.imports,f=>{this.processInjectorType(f,n,i)&&(void 0===c&&(c=[]),c.push(f))})}finally{}if(void 0!==c)for(let f=0;f<c.length;f++){const{ngModule:d,providers:h}=c[f];Za(h,p=>this.processProvider(p,d,h||on))}}this.injectorDefTypes.add(o);const l=hd(o)||(()=>new o);this.records.set(o,Fp(l,z0));const u=r.providers;if(null!=u&&!a){const c=t;Za(u,f=>this.processProvider(f,c,u))}return void 0!==s&&void 0!==t.providers}processProvider(t,n,i){let r=Pp(t=tt(t))?t:tt(t&&t.provide);const s=function Tpe(e,t,n){return U4(e)?Fp(void 0,e.useValue):Fp(H4(e),z0)}(t);if(Pp(t)||!0!==t.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=Fp(void 0,z0,!0),o.factory=()=>CT(o.multi),this.records.set(r,o)),r=t,o.multi.push(t)}this.records.set(r,s)}hydrate(t,n){return n.value===z0&&(n.value=Spe,n.value=n.factory()),"object"==typeof n.value&&n.value&&function Ipe(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(n.value)&&this.onDestroy.add(n.value),n.value}injectableDefInScope(t){if(!t.providedIn)return!1;const n=tt(t.providedIn);return"string"==typeof n?"any"===n||n===this.scope:this.injectorDefTypes.has(n)}}function _O(e){const t=UA(e),n=null!==t?t.factory:hd(e);if(null!==n)return n;if(e instanceof Xe)throw new Ee(204,!1);if(e instanceof Function)return function Ape(e){const t=e.length;if(t>0)throw O0(t,"?"),new Ee(204,!1);const n=function Bce(e){const t=e&&(e[V1]||e[D$]);if(t){const n=function $ce(e){if(e.hasOwnProperty("name"))return e.name;const t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),t}return null}(e);return null!==n?()=>n.factory(e):()=>new e}(e);throw new Ee(204,!1)}function H4(e,t,n){let i;if(Pp(e)){const r=tt(e);return hd(r)||_O(r)}if(U4(e))i=()=>tt(e.useValue);else if(function Mpe(e){return!(!e||!e.useFactory)}(e))i=()=>e.useFactory(...CT(e.deps||[]));else if(function Ope(e){return!(!e||!e.useExisting)}(e))i=()=>ge(tt(e.useExisting));else{const r=tt(e&&(e.useClass||e.provide));if(!function kpe(e){return!!e.deps}(e))return hd(r)||_O(r);i=()=>new r(...CT(e.deps))}return i}function Fp(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function U4(e){return null!==e&&"object"==typeof e&&ide in e}function Pp(e){return"function"==typeof e}let gi=(()=>{class e{static create(n,i){var r;if(Array.isArray(n))return $4({name:""},i,n,"");{const s=null!==(r=n.name)&&void 0!==r?r:"";return $4({name:s},n.parent,n.providers,s)}}}return e.THROW_IF_NOT_FOUND=M0,e.NULL=new j4,e.\u0275prov=Te({token:e,providedIn:"any",factory:()=>ge(pO)}),e.__NG_ELEMENT_ID__=-1,e})();function Hpe(e,t){Z1(kT(e)[1],hi())}function Bt(e){let t=function t6(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0;const i=[e];for(;t;){let r;if(Xo(e))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Ee(903,"");r=t.\u0275dir}if(r){if(n){i.push(r);const o=e;o.inputs=bO(e.inputs),o.declaredInputs=bO(e.declaredInputs),o.outputs=bO(e.outputs);const a=r.hostBindings;a&&Wpe(e,a);const l=r.viewQuery,u=r.contentQueries;if(l&&zpe(e,l),u&&Gpe(e,u),$A(e.inputs,r.inputs),$A(e.declaredInputs,r.declaredInputs),$A(e.outputs,r.outputs),Xo(r)&&r.data.animation){const c=e.data;c.animation=(c.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(e),a===Bt&&(n=!1)}}t=Object.getPrototypeOf(t)}!function Upe(e){let t=0,n=null;for(let i=e.length-1;i>=0;i--){const r=e[i];r.hostVars=t+=r.hostVars,r.hostAttrs=ib(r.hostAttrs,n=ib(n,r.hostAttrs))}}(i)}function bO(e){return e===hp?{}:e===on?[]:e}function zpe(e,t){const n=e.viewQuery;e.viewQuery=n?(i,r)=>{t(i,r),n(i,r)}:t}function Gpe(e,t){const n=e.contentQueries;e.contentQueries=n?(i,r,s)=>{t(i,r,s),n(i,r,s)}:t}function Wpe(e,t){const n=e.hostBindings;e.hostBindings=n?(i,r)=>{t(i,r),n(i,r)}:t}let Ab=null;function Lp(){if(!Ab){const e=Jt.Symbol;if(e&&e.iterator)Ab=e.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let n=0;n<t.length;++n){const i=t[n];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(Ab=i)}}}return Ab}function G0(e){return!!wO(e)&&(Array.isArray(e)||!(e instanceof Map)&&Lp()in e)}function wO(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function rr(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function an(e,t,n,i){const r=re();return rr(r,vp(),t)&&(wt(),nl(Bn(),r,e,t,n,i)),an}function Bp(e,t,n,i){return rr(e,vp(),n)?t+Ye(n)+i:Ke}function He(e,t,n,i,r,s,o,a){const l=re(),u=wt(),c=e+20,f=u.firstCreatePass?function Zpe(e,t,n,i,r,s,o,a,l){const u=t.consts,c=kp(t,e,4,o||null,pc(u,a));aO(t,n,c,pc(u,l)),Z1(t,c);const f=c.tViews=Eb(2,c,i,r,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,u);return null!==t.queries&&(t.queries.template(t,c),f.queries=t.queries.embeddedTView(c)),c}(c,u,l,t,n,i,r,s,o):u.data[c];Qa(f,!1);const d=l[11].createComment("");vb(u,l,d,f),ir(d,l),Sb(l,l[c]=N4(d,l,d,f)),q1(f)&&sO(u,l,f),null!=o&&oO(l,f,a)}function H(e,t=ze.Default){const n=re();return null===n?ge(e,t):e8(hi(),n,tt(e),t)}function xO(){throw new Error("invalid")}function ae(e,t,n){const i=re();return rr(i,vp(),t)&&Fs(wt(),Bn(),i,e,t,i[11],n,!1),ae}function AO(e,t,n,i,r){const o=r?"class":"style";L4(e,n,t.inputs[o],o,i)}function B(e,t,n,i){const r=re(),s=wt(),o=20+e,a=r[11],l=r[o]=$T(a,t,function Mfe(){return Ve.lFrame.currentNamespace}()),u=s.firstCreatePass?function bge(e,t,n,i,r,s,o){const a=t.consts,u=kp(t,e,2,r,pc(a,s));return aO(t,n,u,pc(a,o)),null!==u.attrs&&xb(u,u.attrs,!1),null!==u.mergedAttrs&&xb(u,u.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,u),u}(o,s,r,0,t,n,i):s.data[o];Qa(u,!0);const c=u.mergedAttrs;null!==c&&nb(a,l,c);const f=u.classes;null!==f&&WT(a,l,f);const d=u.styles;return null!==d&&e4(a,l,d),64!=(64&u.flags)&&vb(s,r,l,u),0===function pfe(){return Ve.lFrame.elementDepthCount}()&&ir(l,r),function gfe(){Ve.lFrame.elementDepthCount++}(),q1(u)&&(sO(s,r,u),function v4(e,t,n){if(JA(t)){const r=t.directiveEnd;for(let s=t.directiveStart;s<r;s++){const o=e.data[s];o.contentQueries&&o.contentQueries(1,n[s],s)}}}(s,u,r)),null!==i&&oO(r,u),B}function $(){let e=hi();oT()?aT():(e=e.parent,Qa(e,!1));const t=e;!function mfe(){Ve.lFrame.elementDepthCount--}();const n=wt();return n.firstCreatePass&&(Z1(n,e),JA(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function Ffe(e){return 0!=(16&e.flags)}(t)&&AO(n,t,re(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function Pfe(e){return 0!=(32&e.flags)}(t)&&AO(n,t,re(),t.stylesWithoutHost,!1),$}function $t(e,t,n,i){return B(e,t,n,i),$(),$t}function q0(e){return!!e&&"function"==typeof e.then}const MO=function D6(e){return!!e&&"function"==typeof e.subscribe};function Be(e,t,n,i){const r=re(),s=wt(),o=hi();return function E6(e,t,n,i,r,s,o,a){const l=q1(i),c=e.firstCreatePass&&R4(e),f=t[8],d=I4(t);let h=!0;if(3&i.type||a){const m=ho(i,t),_=a?a(m):m,y=d.length,v=a?b=>a(ii(b[i.index])):i.index;if(jn(n)){let b=null;if(!a&&l&&(b=function Dge(e,t,n,i){const r=e.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===n&&r[s+1]===i){const a=t[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(e,t,r,i.index)),null!==b)(b.__ngLastListenerFn__||b).__ngNextListenerFn__=s,b.__ngLastListenerFn__=s,h=!1;else{s=NO(i,t,f,s,!1);const D=n.listen(_,r,s);d.push(s,D),c&&c.push(r,v,y,y+1)}}else s=NO(i,t,f,s,!0),_.addEventListener(r,s,o),d.push(s),c&&c.push(r,v,y,o)}else s=NO(i,t,f,s,!1);const p=i.outputs;let g;if(h&&null!==p&&(g=p[r])){const m=g.length;if(m)for(let _=0;_<m;_+=2){const C=t[g[_]][g[_+1]].subscribe(s),w=d.length;d.push(s,C),c&&c.push(r,i.index,w,-(w+1))}}}(s,r,r[11],o,e,t,!!n,i),Be}function S6(e,t,n,i){try{return!1!==n(i)}catch(r){return P4(e,r),!1}}function NO(e,t,n,i,r){return function s(o){if(o===Function)return i;const a=2&e.flags?Ns(e.index,t):t;0==(32&t[2])&&cO(a);let l=S6(t,0,i,o),u=s.__ngNextListenerFn__;for(;u;)l=S6(t,0,u,o)&&l,u=u.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function Mt(e=1){return function Efe(e){return(Ve.lFrame.contextLView=function Sfe(e,t){for(;e>0;)t=t[15],e--;return t}(e,Ve.lFrame.contextLView))[8]}(e)}function Cge(e,t){let n=null;const i=function Nhe(e){const t=e.attrs;if(null!=t){const n=t.indexOf(5);if(0==(1&n))return t[n+1]}return null}(e);for(let r=0;r<t.length;r++){const s=t[r];if("*"!==s){if(null===i?r4(e,s,!0):Rhe(i,s))return r}else n=r}return n}function Mb(e,t,n){return Nb(e,"",t,"",n),Mb}function Nb(e,t,n,i,r){const s=re(),o=Bp(s,t,n,i);return o!==Ke&&Fs(wt(),Bn(),s,e,o,s[11],r,!1),Nb}function P6(e,t,n,i,r){const s=e[n+1],o=null===t;let a=i?Zo(s):pu(s),l=!1;for(;0!==a&&(!1===l||o);){const c=e[a+1];xge(e[a],t)&&(l=!0,e[a+1]=i?KT(c):qT(c)),a=i?Zo(c):pu(c)}l&&(e[n+1]=i?qT(s):KT(s))}function xge(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&Ap(e,t)>=0}const mi={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function L6(e){return e.substring(mi.key,mi.keyEnd)}function j6(e,t){const n=mi.textEnd;return n===t?-1:(t=mi.keyEnd=function Mge(e,t,n){for(;t<n&&e.charCodeAt(t)>32;)t++;return t}(e,mi.key=t,n),Yp(e,t,n))}function Yp(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function Nn(e,t){return function na(e,t,n,i){const r=re(),s=wt(),o=hu(2);s.firstUpdatePass&&z6(s,e,o,i),t!==Ke&&rr(r,o,t)&&W6(s,s.data[xr()],r,r[11],e,r[o+1]=function $ge(e,t){return null==e||("string"==typeof t?e+=t:"object"==typeof e&&(e=Wt(yc(e)))),e}(t,n),i,o)}(e,t,null,!0),Nn}function _d(e){ia(Is,sl,e,!0)}function sl(e,t){for(let n=function Tge(e){return function $6(e){mi.key=0,mi.keyEnd=0,mi.value=0,mi.valueEnd=0,mi.textEnd=e.length}(e),j6(e,Yp(e,0,mi.textEnd))}(t);n>=0;n=j6(t,n))Is(e,L6(t),!0)}function ia(e,t,n,i){const r=wt(),s=hu(2);r.firstUpdatePass&&z6(r,null,s,i);const o=re();if(n!==Ke&&rr(o,s,n)){const a=r.data[xr()];if(Y6(a,i)&&!U6(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(n=VA(l,n||"")),AO(r,a,o,n,i)}else!function Bge(e,t,n,i,r,s,o,a){r===Ke&&(r=on);let l=0,u=0,c=0<r.length?r[0]:null,f=0<s.length?s[0]:null;for(;null!==c||null!==f;){const d=l<r.length?r[l+1]:void 0,h=u<s.length?s[u+1]:void 0;let g,p=null;c===f?(l+=2,u+=2,d!==h&&(p=f,g=h)):null===f||null!==c&&c<f?(l+=2,p=c):(u+=2,p=f,g=h),null!==p&&W6(e,t,n,i,p,g,o,a),c=l<r.length?r[l]:null,f=u<s.length?s[u]:null}}(r,a,o,o[11],o[s+1],o[s+1]=function jge(e,t,n){if(null==n||""===n)return on;const i=[],r=yc(n);if(Array.isArray(r))for(let s=0;s<r.length;s++)e(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&e(i,s,r[s]);else"string"==typeof r&&t(i,r);return i}(e,t,n),i,s)}}function U6(e,t){return t>=e.expandoStartIndex}function z6(e,t,n,i){const r=e.data;if(null===r[n+1]){const s=r[xr()],o=U6(e,n);Y6(s,i)&&null===t&&!o&&(t=!1),t=function Rge(e,t,n,i){const r=function uT(e){const t=Ve.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e);let s=i?t.residualClasses:t.residualStyles;if(null===r)0===(i?t.classBindings:t.styleBindings)&&(n=Y0(n=IO(null,e,t,n,i),t.attrs,i),s=null);else{const o=t.directiveStylingLast;if(-1===o||e[o]!==r)if(n=IO(r,e,t,n,i),null===s){let l=function Fge(e,t,n){const i=n?t.classBindings:t.styleBindings;if(0!==pu(i))return e[Zo(i)]}(e,t,i);void 0!==l&&Array.isArray(l)&&(l=IO(null,e,t,l[1],i),l=Y0(l,t.attrs,i),function Pge(e,t,n,i){e[Zo(n?t.classBindings:t.styleBindings)]=i}(e,t,i,l))}else s=function Lge(e,t,n){let i;const r=t.directiveEnd;for(let s=1+t.directiveStylingLast;s<r;s++)i=Y0(i,e[s].hostAttrs,n);return Y0(i,t.attrs,n)}(e,t,i)}return void 0!==s&&(i?t.residualClasses=s:t.residualStyles=s),n}(r,s,t,i),function Ege(e,t,n,i,r,s){let o=s?t.classBindings:t.styleBindings,a=Zo(o),l=pu(o);e[i]=n;let c,u=!1;if(Array.isArray(n)){const f=n;c=f[1],(null===c||Ap(f,c)>0)&&(u=!0)}else c=n;if(r)if(0!==l){const d=Zo(e[a+1]);e[i+1]=wb(d,a),0!==d&&(e[d+1]=YT(e[d+1],i)),e[a+1]=function jhe(e,t){return 131071&e|t<<17}(e[a+1],i)}else e[i+1]=wb(a,0),0!==a&&(e[a+1]=YT(e[a+1],i)),a=i;else e[i+1]=wb(l,0),0===a?a=i:e[l+1]=YT(e[l+1],i),l=i;u&&(e[i+1]=qT(e[i+1])),P6(e,c,i,!0),P6(e,c,i,!1),function Sge(e,t,n,i,r){const s=r?e.residualClasses:e.residualStyles;null!=s&&"string"==typeof t&&Ap(s,t)>=0&&(n[i+1]=KT(n[i+1]))}(t,c,e,i,s),o=wb(a,l),s?t.classBindings=o:t.styleBindings=o}(r,s,t,n,o,i)}}function IO(e,t,n,i,r){let s=null;const o=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<o&&(s=t[a],i=Y0(i,s.hostAttrs,r),s!==e);)a++;return null!==e&&(n.directiveStylingLast=a),i}function Y0(e,t,n){const i=n?1:2;let r=-1;if(null!==t)for(let s=0;s<t.length;s++){const o=t[s];"number"==typeof o?r=o:r===i&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),Is(e,o,!!n||t[++s]))}return void 0===e?null:e}function W6(e,t,n,i,r,s,o,a){if(!(3&t.type))return;const l=e.data,u=l[a+1];kb(function u4(e){return 1==(1&e)}(u)?q6(l,t,n,r,pu(u),o):void 0)||(kb(s)||function l4(e){return 2==(2&e)}(u)&&(s=q6(l,null,n,r,a,o)),function xhe(e,t,n,i,r){const s=jn(e);if(t)r?s?e.addClass(n,i):n.classList.add(i):s?e.removeClass(n,i):n.classList.remove(i);else{let o=-1===i.indexOf("-")?void 0:Rs.DashCase;if(null==r)s?e.removeStyle(n,i,o):n.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=Rs.Important),s?e.setStyle(n,i,r,o):n.style.setProperty(i,r,a?"important":"")}}}(i,o,Y1(xr(),n),r,s))}function q6(e,t,n,i,r,s){const o=null===t;let a;for(;r>0;){const l=e[r],u=Array.isArray(l),c=u?l[1]:l,f=null===c;let d=n[r+1];d===Ke&&(d=f?on:void 0);let h=f?bT(d,i):c===i?d:void 0;if(u&&!kb(h)&&(h=bT(l,i)),kb(h)&&(a=h,o))return a;const p=e[r+1];r=o?Zo(p):pu(p)}if(null!==t){let l=s?t.residualClasses:t.residualStyles;null!=l&&(a=bT(l,i))}return a}function kb(e){return void 0!==e}function Y6(e,t){return 0!=(e.flags&(t?16:32))}function Y(e,t=""){const n=re(),i=wt(),r=e+20,s=i.firstCreatePass?kp(i,r,1,t,null):i.data[r],o=n[r]=function BT(e,t){return jn(e)?e.createText(t):e.createTextNode(t)}(n[11],t);vb(i,n,o,s),Qa(s,!1)}function Kp(e){return mo("",e,""),Kp}function mo(e,t,n){const i=re(),r=Bp(i,e,t,n);return r!==Ke&&gu(i,xr(),r),mo}function RO(e,t,n){ia(Is,sl,Bp(re(),e,t,n),!0)}const Ib="en-US";let gV=Ib;function jO(e,t,n,i,r){if(e=tt(e),Array.isArray(e))for(let s=0;s<e.length;s++)jO(e[s],t,n,i,r);else{const s=wt(),o=re();let a=Pp(e)?e:tt(e.provide),l=H4(e);const u=hi(),c=1048575&u.providerIndexes,f=u.directiveStart,d=u.providerIndexes>>20;if(Pp(e)||!e.multi){const h=new C0(l,r,H),p=$O(a,t,r?c:c+d,f);-1===p?(ob(S0(u,o),s,a),BO(s,e,t.length),t.push(a),u.directiveStart++,u.directiveEnd++,r&&(u.providerIndexes+=1048576),n.push(h),o.push(h)):(n[p]=h,o[p]=h)}else{const h=$O(a,t,c+d,f),p=$O(a,t,c,c+d),g=h>=0&&n[h],m=p>=0&&n[p];if(r&&!m||!r&&!g){ob(S0(u,o),s,a);const _=function n0e(e,t,n,i,r){const s=new C0(e,n,H);return s.multi=[],s.index=t,s.componentProviders=0,BV(s,r,i&&!n),s}(r?t0e:e0e,n.length,r,i,l);!r&&m&&(n[p].providerFactory=_),BO(s,e,t.length,0),t.push(a),u.directiveStart++,u.directiveEnd++,r&&(u.providerIndexes+=1048576),n.push(_),o.push(_)}else BO(s,e,h>-1?h:p,BV(n[r?p:h],l,!r&&i));!r&&i&&m&&n[p].componentProviders++}}}function BO(e,t,n,i){const r=Pp(t),s=function Npe(e){return!!e.useClass}(t);if(r||s){const l=(s?tt(t.useClass):t).prototype.ngOnDestroy;if(l){const u=e.destroyHooks||(e.destroyHooks=[]);if(!r&&t.multi){const c=u.indexOf(n);-1===c?u.push(n,[i,l]):u[c+1].push(i,l)}else u.push(n,l)}}}function BV(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function $O(e,t,n,i){for(let r=n;r<i;r++)if(t[r]===e)return r;return-1}function e0e(e,t,n,i){return VO(this.multi,[])}function t0e(e,t,n,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=x0(n,n[1],this.providerFactory.index,i);s=a.slice(0,o),VO(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],VO(r,s);return s}function VO(e,t){for(let n=0;n<e.length;n++)t.push((0,e[n])());return t}function ln(e,t=[]){return n=>{n.providersResolver=(i,r)=>function Zme(e,t,n){const i=wt();if(i.firstCreatePass){const r=Xo(e);jO(n,i.data,i.blueprint,r,!0),jO(t,i.data,i.blueprint,r,!1)}}(i,r?r(e):e,t)}}class $V{}class s0e{resolveComponentFactory(t){throw function r0e(e){const t=Error(`No component factory found for ${Wt(e)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=e,t}(t)}}let Qp=(()=>{class e{}return e.NULL=new s0e,e})();function o0e(){return Zp(hi(),re())}function Zp(e,t){return new dn(ho(e,t))}let dn=(()=>{class e{constructor(n){this.nativeElement=n}}return e.__NG_ELEMENT_ID__=o0e,e})();function a0e(e){return e instanceof dn?e.nativeElement:e}class eg{}let _o=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>function u0e(){const e=re(),n=Ns(hi().index,e);return function l0e(e){return e[11]}(Xa(n)?n:e)}(),e})(),c0e=(()=>{class e{}return e.\u0275prov=Te({token:e,providedIn:"root",factory:()=>null}),e})();class Z0{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const f0e=new Z0("13.3.2"),HO={};function jb(e,t,n,i,r=!1){for(;null!==n;){const s=t[n.index];if(null!==s&&i.push(ii(s)),Jo(s))for(let a=10;a<s.length;a++){const l=s[a],u=l[1].firstChild;null!==u&&jb(l[1],l,u,i)}const o=n.type;if(8&o)jb(e,t,n.child,i);else if(32&o){const a=PT(n,t);let l;for(;l=a();)i.push(l)}else if(16&o){const a=X8(t,n);if(Array.isArray(a))i.push(...a);else{const l=$0(t[16]);jb(l[1],l,a,i,!0)}}n=r?n.projectionNext:n.next}return i}class e_{constructor(t,n){this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,n=t[1];return jb(n,t,n.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(Jo(t)){const n=t[8],i=n?n.indexOf(this):-1;i>-1&&(VT(t,i),lb(n,i))}this._attachedToViewContainer=!1}H8(this._lView[1],this._lView)}onDestroy(t){C4(this._lView[1],this._lView,null,t)}markForCheck(){cO(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){dO(this._lView[1],this._lView,this.context)}checkNoChanges(){!function bpe(e,t,n){J1(!0);try{dO(e,t,n)}finally{J1(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Ee(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function mhe(e,t){V0(e,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Ee(902,"");this._appRef=t}}class d0e extends e_{constructor(t){super(t),this._view=t}detectChanges(){k4(this._view)}checkNoChanges(){!function wpe(e){J1(!0);try{k4(e)}finally{J1(!1)}}(this._view)}get context(){return null}}class HV extends Qp{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const n=er(t);return new UO(n,this.ngModule)}}function UV(e){const t=[];for(let n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}class UO extends $V{constructor(t,n){super(),this.componentDef=t,this.ngModule=n,this.componentType=t.type,this.selector=function Phe(e){return e.map(Fhe).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!n}get inputs(){return UV(this.componentDef.inputs)}get outputs(){return UV(this.componentDef.outputs)}create(t,n,i,r){const s=(r=r||this.ngModule)?function p0e(e,t){return{get:(n,i,r)=>{const s=e.get(n,HO,r);return s!==HO||i===HO?s:t.get(n,i,r)}}}(t,r.injector):t,o=s.get(eg,I$),a=s.get(c0e,null),l=o.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",c=i?function D4(e,t,n){if(jn(e))return e.selectRootElement(t,n===Yo.ShadowDom);let i="string"==typeof t?e.querySelector(t):t;return i.textContent="",i}(l,i,this.componentDef.encapsulation):$T(o.createRenderer(null,this.componentDef),u,function h0e(e){const t=e.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(u)),f=this.componentDef.onPush?576:528,d=function e6(e,t){return{components:[],scheduler:e||lhe,clean:Dpe,playerHandler:t||null,flags:0}}(),h=Eb(0,null,null,1,0,null,null,null,null,null),p=H0(null,h,d,f,null,null,o,l,a,s);let g,m;X1(p);try{const _=function Q4(e,t,n,i,r,s){const o=n[1];n[20]=e;const l=kp(o,20,2,"#host",null),u=l.mergedAttrs=t.hostAttrs;null!==u&&(xb(l,u,!0),null!==e&&(nb(r,e,u),null!==l.classes&&WT(r,e,l.classes),null!==l.styles&&e4(r,e,l.styles)));const c=i.createRenderer(e,t),f=H0(n,b4(t),null,t.onPush?64:16,n[20],l,i,c,s||null,null);return o.firstCreatePass&&(ob(S0(l,n),o,t.type),T4(o,l),O4(l,n.length,1)),Sb(n,f),n[20]=f}(c,this.componentDef,p,o,l);if(c)if(i)nb(l,c,["ng-version",f0e.full]);else{const{attrs:y,classes:v}=function Lhe(e){const t=[],n=[];let i=1,r=2;for(;i<e.length;){let s=e[i];if("string"==typeof s)2===r?""!==s&&t.push(s,e[++i]):8===r&&n.push(s);else{if(!Qo(r))break;r=s}i++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]);y&&nb(l,c,y),v&&v.length>0&&WT(l,c,v.join(" "))}if(m=iT(h,20),void 0!==n){const y=m.projection=[];for(let v=0;v<this.ngContentSelectors.length;v++){const b=n[v];y.push(null!=b?Array.from(b):null)}}g=function Z4(e,t,n,i,r){const s=n[1],o=function rpe(e,t,n){const i=hi();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),M4(e,i,t,Ip(e,t,1,null),n));const r=x0(t,e,i.directiveStart,i);ir(r,t);const s=ho(i,t);return s&&ir(s,t),r}(s,n,t);if(i.components.push(o),e[8]=o,r&&r.forEach(l=>l(o,t)),t.contentQueries){const l=hi();t.contentQueries(1,o,l.directiveStart)}const a=hi();return!s.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(gc(a.index),x4(n[1],a,0,a.directiveStart,a.directiveEnd,t),A4(t,o)),o}(_,this.componentDef,p,d,[Hpe]),U0(h,p,null)}finally{Q1()}return new m0e(this.componentType,g,Zp(m,p),p,m)}}class m0e extends class i0e{}{constructor(t,n,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=n,this.hostView=this.changeDetectorRef=new d0e(r),this.componentType=t}get injector(){return new Dp(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}class _u{}class zV{}const tg=new Map;class qV extends _u{constructor(t,n){super(),this._parent=n,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new HV(this);const i=uo(t);this._bootstrapComponents=tl(i.bootstrap),this._r3Injector=V4(t,n,[{provide:_u,useValue:this},{provide:Qp,useValue:this.componentFactoryResolver}],Wt(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,n=gi.THROW_IF_NOT_FOUND,i=ze.Default){return t===gi||t===_u||t===pO?this:this._r3Injector.get(t,n,i)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class zO extends zV{constructor(t){super(),this.moduleType=t,null!==uo(t)&&function y0e(e){const t=new Set;!function n(i){const r=uo(i,!0),s=r.id;null!==s&&(function GV(e,t,n){if(t&&t!==n)throw new Error(`Duplicate module registered for ${e} - ${Wt(t)} vs ${Wt(t.name)}`)}(s,tg.get(s),i),tg.set(s,i));const o=tl(r.imports);for(const a of o)t.has(a)||(t.add(a),n(a))}(e)}(t)}create(t){return new qV(this.moduleType,t)}}function Cc(e,t,n,i){return YV(re(),Sr(),e,t,n,i)}function YV(e,t,n,i,r,s){const o=t+n;return rr(e,o,r)?function il(e,t,n){return e[t]=n}(e,o+1,s?i.call(s,r):i(r)):function n_(e,t){const n=e[t];return n===Ke?void 0:n}(e,o+1)}function WO(e,t){const n=wt();let i;const r=e+20;n.firstCreatePass?(i=function x0e(e,t){if(t)for(let n=t.length-1;n>=0;n--){const i=t[n];if(e===i.name)return i}}(t,n.pipeRegistry),n.data[r]=i,i.onDestroy&&(n.destroyHooks||(n.destroyHooks=[])).push(r,i.onDestroy)):i=n.data[r];const s=i.factory||(i.factory=hd(i.type)),o=fc(H);try{const a=rb(!1),l=s();return rb(a),function ege(e,t,n,i){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=i}(n,re(),r,l),l}finally{fc(o)}}function qO(e,t,n){const i=e+20,r=re(),s=function yp(e,t){return e[t]}(r,i);return function i_(e,t){return e[1].data[t].pure}(r,i)?YV(r,Sr(),t,s.transform,n,s):s.transform(n)}function YO(e){return t=>{setTimeout(e,void 0,t)}}const it=class N0e extends On{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,n,i){var r,s,o;let a=t,l=n||(()=>null),u=i;if(t&&"object"==typeof t){const f=t;a=null===(r=f.next)||void 0===r?void 0:r.bind(f),l=null===(s=f.error)||void 0===s?void 0:s.bind(f),u=null===(o=f.complete)||void 0===o?void 0:o.bind(f)}this.__isAsync&&(l=YO(l),a&&(a=YO(a)),u&&(u=YO(u)));const c=super.subscribe({next:a,error:l,complete:u});return t instanceof Yn&&t.add(c),c}};function k0e(){return this._results[Lp()]()}class KO{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const n=Lp(),i=KO.prototype;i[n]||(i[n]=k0e)}get changes(){return this._changes||(this._changes=new it)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,n){return this._results.reduce(t,n)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,n){const i=this;i.dirty=!1;const r=po(t);(this._changesDetected=!function Wfe(e,t,n){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],s=t[i];if(n&&(r=n(r),s=n(s)),s!==r)return!1}return!0}(i._results,r,n))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Vn=(()=>{class e{}return e.__NG_ELEMENT_ID__=F0e,e})();const I0e=Vn,R0e=class extends I0e{constructor(t,n,i){super(),this._declarationLView=t,this._declarationTContainer=n,this.elementRef=i}createEmbeddedView(t){const n=this._declarationTContainer.tViews,i=H0(this._declarationLView,n,t,16,null,n.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(n)),U0(n,i,t),new e_(i)}};function F0e(){return Bb(hi(),re())}function Bb(e,t){return 4&e.type?new R0e(t,e,Zp(e,t)):null}let ra=(()=>{class e{}return e.__NG_ELEMENT_ID__=P0e,e})();function P0e(){return tH(hi(),re())}const L0e=ra,ZV=class extends L0e{constructor(t,n,i){super(),this._lContainer=t,this._hostTNode=n,this._hostLView=i}get element(){return Zp(this._hostTNode,this._hostLView)}get injector(){return new Dp(this._hostTNode,this._hostLView)}get parentInjector(){const t=sb(this._hostTNode,this._hostLView);if(K$(t)){const n=wp(t,this._hostLView),i=bp(t);return new Dp(n[1].data[i+8],n)}return new Dp(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const n=eH(this._lContainer);return null!==n&&n[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,n,i){const r=t.createEmbeddedView(n||{});return this.insert(r,i),r}createComponent(t,n,i,r,s){const o=t&&!function T0(e){return"function"==typeof e}(t);let a;if(o)a=n;else{const f=n||{};a=f.index,i=f.injector,r=f.projectableNodes,s=f.ngModuleRef}const l=o?t:new UO(er(t)),u=i||this.parentInjector;if(!s&&null==l.ngModule){const d=(o?u:this.parentInjector).get(_u,null);d&&(s=d)}const c=l.create(u,r,void 0,s);return this.insert(c.hostView,a),c}insert(t,n){const i=t._lView,r=i[1];if(function hfe(e){return Jo(e[3])}(i)){const c=this.indexOf(t);if(-1!==c)this.detach(c);else{const f=i[3],d=new ZV(f,f[6],f[3]);d.detach(d.indexOf(t))}}const s=this._adjustIndex(n),o=this._lContainer;!function yhe(e,t,n,i){const r=10+i,s=n.length;i>0&&(n[r-1][4]=t),i<s-10?(t[4]=n[r],s8(n,10+i,t)):(n.push(t),t[4]=null),t[3]=n;const o=t[17];null!==o&&n!==o&&function vhe(e,t){const n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(o,t);const a=t[19];null!==a&&a.insertView(e),t[2]|=128}(r,i,o,s);const a=zT(s,o),l=i[11],u=yb(l,o[7]);return null!==u&&function ghe(e,t,n,i,r,s){i[0]=r,i[6]=t,V0(e,i,n,1,r,s)}(r,o[6],l,i,u,a),t.attachToViewContainerRef(),s8(JO(o),s,t),t}move(t,n){return this.insert(t,n)}indexOf(t){const n=eH(this._lContainer);return null!==n?n.indexOf(t):-1}remove(t){const n=this._adjustIndex(t,-1),i=VT(this._lContainer,n);i&&(lb(JO(this._lContainer),n),H8(i[1],i))}detach(t){const n=this._adjustIndex(t,-1),i=VT(this._lContainer,n);return i&&null!=lb(JO(this._lContainer),n)?new e_(i):null}_adjustIndex(t,n=0){return null==t?this.length+n:t}};function eH(e){return e[8]}function JO(e){return e[8]||(e[8]=[])}function tH(e,t){let n;const i=t[e.index];if(Jo(i))n=i;else{let r;if(8&e.type)r=ii(i);else{const s=t[11];r=s.createComment("");const o=ho(e,t);gd(s,yb(s,o),r,function Che(e,t){return jn(e)?e.nextSibling(t):t.nextSibling}(s,o),!1)}t[e.index]=n=N4(i,t,r,e),Sb(t,n)}return new ZV(n,e,t)}class XO{constructor(t){this.queryList=t,this.matches=null}clone(){return new XO(this.queryList)}setDirty(){this.queryList.setDirty()}}class QO{constructor(t=[]){this.queries=t}createEmbeddedView(t){const n=t.queries;if(null!==n){const i=null!==t.contentQueries?t.contentQueries[0]:n.length,r=[];for(let s=0;s<i;s++){const o=n.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new QO(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let n=0;n<this.queries.length;n++)null!==oH(t,n).matches&&this.queries[n].setDirty()}}class nH{constructor(t,n,i=null){this.predicate=t,this.flags=n,this.read=i}}class ZO{constructor(t=[]){this.queries=t}elementStart(t,n){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(t,n)}elementEnd(t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(t)}embeddedTView(t){let n=null;for(let i=0;i<this.length;i++){const r=null!==n?n.length:0,s=this.getByIndex(i).embeddedTView(t,r);s&&(s.indexInDeclarationView=i,null!==n?n.push(s):n=[s])}return null!==n?new ZO(n):null}template(t,n){for(let i=0;i<this.queries.length;i++)this.queries[i].template(t,n)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class eM{constructor(t,n=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(t,n){this.isApplyingToNode(n)&&this.matchTNode(t,n)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,n){this.elementStart(t,n)}embeddedTView(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new eM(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const n=this._declarationNodeIndex;let i=t.parent;for(;null!==i&&8&i.type&&i.index!==n;)i=i.parent;return n===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(t,n){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(t,n,$0e(n,s)),this.matchTNodeWithReadOption(t,n,ab(n,t,s,!1,!1))}else i===Vn?4&n.type&&this.matchTNodeWithReadOption(t,n,-1):this.matchTNodeWithReadOption(t,n,ab(n,t,i,!1,!1))}matchTNodeWithReadOption(t,n,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===dn||r===ra||r===Vn&&4&n.type)this.addMatch(n.index,-2);else{const s=ab(n,t,r,!1,!1);null!==s&&this.addMatch(n.index,s)}else this.addMatch(n.index,i)}}addMatch(t,n){null===this.matches?this.matches=[t,n]:this.matches.push(t,n)}}function $0e(e,t){const n=e.localNames;if(null!==n)for(let i=0;i<n.length;i+=2)if(n[i]===t)return n[i+1];return null}function H0e(e,t,n,i){return-1===n?function V0e(e,t){return 11&e.type?Zp(e,t):4&e.type?Bb(e,t):null}(t,e):-2===n?function U0e(e,t,n){return n===dn?Zp(t,e):n===Vn?Bb(t,e):n===ra?tH(t,e):void 0}(e,t,i):x0(e,e[1],n,t)}function iH(e,t,n,i){const r=t[19].queries[i];if(null===r.matches){const s=e.data,o=n.matches,a=[];for(let l=0;l<o.length;l+=2){const u=o[l];a.push(u<0?null:H0e(t,s[u],o[l+1],n.metadata.read))}r.matches=a}return r.matches}function tM(e,t,n,i){const r=e.queries.getByIndex(n),s=r.matches;if(null!==s){const o=iH(e,t,r,n);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const u=s[a+1],c=t[-l];for(let f=10;f<c.length;f++){const d=c[f];d[17]===d[3]&&tM(d[1],d,u,i)}if(null!==c[9]){const f=c[9];for(let d=0;d<f.length;d++){const h=f[d];tM(h[1],h,u,i)}}}}}return i}function kn(e){const t=re(),n=wt(),i=$$();cT(i+1);const r=oH(n,i);if(e.dirty&&R$(t)===(2==(2&r.metadata.flags))){if(null===r.matches)e.reset([]);else{const s=r.crossesNgTemplate?tM(n,t,i,[]):iH(n,t,r,i);e.reset(s,a0e),e.notifyOnChanges()}return!0}return!1}function nM(e,t,n){const i=wt();i.firstCreatePass&&(function sH(e,t,n){null===e.queries&&(e.queries=new ZO),e.queries.track(new eM(t,n))}(i,new nH(e,t,n),-1),2==(2&t)&&(i.staticViewQueries=!0)),function rH(e,t,n){const i=new KO(4==(4&n));C4(e,t,i,i.destroy),null===t[19]&&(t[19]=new QO),t[19].queries.push(new XO(i))}(i,re(),t)}function oH(e,t){return e.queries.getByIndex(t)}function Hb(...e){}const lM=new Xe("Application Initializer");let uM=(()=>{class e{constructor(n){this.appInits=n,this.resolve=Hb,this.reject=Hb,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const n=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(q0(s))n.push(s);else if(MO(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});n.push(o)}}Promise.all(n).then(()=>{i()}).catch(r=>{this.reject(r)}),0===n.length&&i(),this.initialized=!0}}return e.\u0275fac=function(n){return new(n||e)(ge(lM,8))},e.\u0275prov=Te({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const s_=new Xe("AppId",{providedIn:"root",factory:function CH(){return`${cM()}${cM()}${cM()}`}});function cM(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const EH=new Xe("Platform Initializer"),o_=new Xe("Platform ID"),SH=new Xe("appBootstrapListener");let xH=(()=>{class e{log(n){console.log(n)}warn(n){console.warn(n)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})();const Ec=new Xe("LocaleId",{providedIn:"root",factory:()=>sde(Ec,ze.Optional|ze.SkipSelf)||function l_e(){return"undefined"!=typeof $localize&&$localize.locale||Ib}()});class c_e{constructor(t,n){this.ngModuleFactory=t,this.componentFactories=n}}let AH=(()=>{class e{compileModuleSync(n){return new zO(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const i=this.compileModuleSync(n),s=tl(uo(n).declarations).reduce((o,a)=>{const l=er(a);return l&&o.push(new UO(l)),o},[]);return new c_e(i,s)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Te({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const d_e=(()=>Promise.resolve(0))();function fM(e){"undefined"==typeof Zone?d_e.then(()=>{e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}class hn{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new it(!1),this.onMicrotaskEmpty=new it(!1),this.onStable=new it(!1),this.onError=new it(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&n,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function h_e(){let e=Jt.requestAnimationFrame,t=Jt.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function m_e(e){const t=()=>{!function g_e(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Jt,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,hM(e),e.isCheckStableRunning=!0,dM(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),hM(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,i,r,s,o,a)=>{try{return TH(e),n.invokeTask(r,s,o,a)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||e.shouldCoalesceRunChangeDetection)&&t(),OH(e)}},onInvoke:(n,i,r,s,o,a,l)=>{try{return TH(e),n.invoke(r,s,o,a,l)}finally{e.shouldCoalesceRunChangeDetection&&t(),OH(e)}},onHasTask:(n,i,r,s)=>{n.hasTask(r,s),i===r&&("microTask"==s.change?(e._hasPendingMicrotasks=s.microTask,hM(e),dM(e)):"macroTask"==s.change&&(e.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,i,r,s)=>(n.handleError(r,s),e.runOutsideAngular(()=>e.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!hn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(hn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,n,i){return this._inner.run(t,n,i)}runTask(t,n,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,t,p_e,Hb,Hb);try{return s.runTask(o,n,i)}finally{s.cancelTask(o)}}runGuarded(t,n,i){return this._inner.runGuarded(t,n,i)}runOutsideAngular(t){return this._outer.run(t)}}const p_e={};function dM(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function hM(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function TH(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function OH(e){e._nesting--,dM(e)}class __e{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new it,this.onMicrotaskEmpty=new it,this.onStable=new it,this.onError=new it}run(t,n,i){return t.apply(n,i)}runGuarded(t,n,i){return t.apply(n,i)}runOutsideAngular(t){return t()}runTask(t,n,i,r){return t.apply(n,i)}}let pM=(()=>{class e{constructor(n){this._ngZone=n,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{hn.assertNotInAngularZone(),fM(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())fM(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(n)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),n(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:n,timeoutId:s,updateCb:r})}whenStable(n,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(n,i,r){return[]}}return e.\u0275fac=function(n){return new(n||e)(ge(hn))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})(),MH=(()=>{class e{constructor(){this._applications=new Map,gM.addToWindow(this)}registerApplication(n,i){this._applications.set(n,i)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,i=!0){return gM.findTestabilityInTree(this,n,i)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})();class y_e{addToWindow(t){}findTestabilityInTree(t,n,i){return null}}let sa,gM=new y_e;const NH=new Xe("AllowMultipleToken");class kH{constructor(t,n){this.name=t,this.token=n}}function IH(e,t,n=[]){const i=`Platform: ${t}`,r=new Xe(i);return(s=[])=>{let o=RH();if(!o||o.injector.get(NH,!1))if(e)e(n.concat(s).concat({provide:r,useValue:!0}));else{const a=n.concat(s).concat({provide:r,useValue:!0},{provide:gO,useValue:"platform"});!function D_e(e){if(sa&&!sa.destroyed&&!sa.injector.get(NH,!1))throw new Ee(400,"");sa=e.get(FH);const t=e.get(EH,null);t&&t.forEach(n=>n())}(gi.create({providers:a,name:i}))}return function C_e(e){const t=RH();if(!t)throw new Ee(401,"");return t}()}}function RH(){return sa&&!sa.destroyed?sa:null}let FH=(()=>{class e{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,i){const a=function E_e(e,t){let n;return n="noop"===e?new __e:("zone.js"===e?void 0:e)||new hn({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),n}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),l=[{provide:hn,useValue:a}];return a.run(()=>{const u=gi.create({providers:l,parent:this.injector,name:n.moduleType.name}),c=n.create(u),f=c.injector.get(B0,null);if(!f)throw new Ee(402,"");return a.runOutsideAngular(()=>{const d=a.onError.subscribe({next:h=>{f.handleError(h)}});c.onDestroy(()=>{mM(this._modules,c),d.unsubscribe()})}),function S_e(e,t,n){try{const i=n();return q0(i)?i.catch(r=>{throw t.runOutsideAngular(()=>e.handleError(r)),r}):i}catch(i){throw t.runOutsideAngular(()=>e.handleError(i)),i}}(f,a,()=>{const d=c.injector.get(uM);return d.runInitializers(),d.donePromise.then(()=>(function cme(e){Os(e,"Expected localeId to be defined"),"string"==typeof e&&(gV=e.toLowerCase().replace(/_/g,"-"))}(c.injector.get(Ec,Ib)||Ib),this._moduleDoBootstrap(c),c))})})}bootstrapModule(n,i=[]){const r=PH({},i);return function b_e(e,t,n){const i=new zO(n);return Promise.resolve(i)}(0,0,n).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(n){const i=n.injector.get(Ub);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!n.instance.ngDoBootstrap)throw new Ee(403,"");n.instance.ngDoBootstrap(i)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ee(404,"");this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n()),this._destroyed=!0}get destroyed(){return this._destroyed}}return e.\u0275fac=function(n){return new(n||e)(ge(gi))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})();function PH(e,t){return Array.isArray(t)?t.reduce(PH,e):Object.assign(Object.assign({},e),t)}let Ub=(()=>{class e{constructor(n,i,r,s,o){this._zone=n,this._injector=i,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new rn(u=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{u.next(this._stable),u.complete()})}),l=new rn(u=>{let c;this._zone.runOutsideAngular(()=>{c=this._zone.onStable.subscribe(()=>{hn.assertNotInAngularZone(),fM(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,u.next(!0))})})});const f=this._zone.onUnstable.subscribe(()=>{hn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{u.next(!1)}))});return()=>{c.unsubscribe(),f.unsubscribe()}});this.isStable=function kce(...e){const t=_0(e),n=function Sce(e,t){return"number"==typeof jA(e)?e.pop():t}(e,1/0),i=e;return i.length?1===i.length?Zi(i[0]):m0(n)(Ai(i,t)):Wo}(a,l.pipe(function Ice(e={}){const{connector:t=(()=>new On),resetOnError:n=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=e;return s=>{let o=null,a=null,l=null,u=0,c=!1,f=!1;const d=()=>{null==a||a.unsubscribe(),a=null},h=()=>{d(),o=l=null,c=f=!1},p=()=>{const g=o;h(),null==g||g.unsubscribe()};return Kn((g,m)=>{u++,!f&&!c&&d();const _=l=null!=l?l:t();m.add(()=>{u--,0===u&&!f&&!c&&(a=BA(p,r))}),_.subscribe(m),o||(o=new L1({next:y=>_.next(y),error:y=>{f=!0,d(),a=BA(h,n,y),_.error(y)},complete:()=>{c=!0,d(),a=BA(h,i),_.complete()}}),Ai(g).subscribe(o))})(s)}}()))}bootstrap(n,i){if(!this._initStatus.done)throw new Ee(405,"");let r;r=n instanceof $V?n:this._componentFactoryResolver.resolveComponentFactory(n),this.componentTypes.push(r.componentType);const s=function w_e(e){return e.isBoundToModule}(r)?void 0:this._injector.get(_u),a=r.create(gi.NULL,[],i||r.selector,s),l=a.location.nativeElement,u=a.injector.get(pM,null),c=u&&a.injector.get(MH);return u&&c&&c.registerApplication(l,u),a.onDestroy(()=>{this.detachView(a.hostView),mM(this.components,a),c&&c.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new Ee(101,"");try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(n))}finally{this._runningTick=!1}}attachView(n){const i=n;this._views.push(i),i.attachToAppRef(this)}detachView(n){const i=n;mM(this._views,i),i.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(SH,[]).concat(this._bootstrapListeners).forEach(r=>r(n))}ngOnDestroy(){this._views.slice().forEach(n=>n.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return e.\u0275fac=function(n){return new(n||e)(ge(hn),ge(gi),ge(B0),ge(Qp),ge(uM))},e.\u0275prov=Te({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function mM(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}let jH=!0,oa=(()=>{class e{}return e.__NG_ELEMENT_ID__=T_e,e})();function T_e(e){return function O_e(e,t,n){if(W1(e)&&!n){const i=Ns(e.index,t);return new e_(i,i)}return 47&e.type?new e_(t[16],t):null}(hi(),re(),16==(16&e))}class UH{constructor(){}supports(t){return G0(t)}create(t){return new F_e(t)}}const R_e=(e,t)=>t;class F_e{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||R_e}forEachItem(t){let n;for(n=this._itHead;null!==n;n=n._next)t(n)}forEachOperation(t){let n=this._itHead,i=this._removalsHead,r=0,s=null;for(;n||i;){const o=!i||n&&n.currentIndex<GH(i,r,s)?n:i,a=GH(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(n=n._next,null==o.previousIndex)r++;else{s||(s=[]);const u=a-r,c=l-r;if(u!=c){for(let d=0;d<u;d++){const h=d<s.length?s[d]:s[d]=0,p=h+d;c<=p&&p<u&&(s[d]=h+1)}s[o.previousIndex]=c-u}}a!==l&&t(o,a,l)}}forEachPreviousItem(t){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachMovedItem(t){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}forEachIdentityChange(t){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)t(n)}diff(t){if(null==t&&(t=[]),!G0(t))throw new Ee(900,"");return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let r,s,o,n=this._itHead,i=!1;if(Array.isArray(t)){this.length=t.length;for(let a=0;a<this.length;a++)s=t[a],o=this._trackByFn(a,s),null!==n&&Object.is(n.trackById,o)?(i&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)):(n=this._mismatch(n,s,o,a),i=!0),n=n._next}else r=0,function Qpe(e,t){if(Array.isArray(e))for(let n=0;n<e.length;n++)t(e[n]);else{const n=e[Lp()]();let i;for(;!(i=n.next()).done;)t(i.value)}}(t,a=>{o=this._trackByFn(r,a),null!==n&&Object.is(n.trackById,o)?(i&&(n=this._verifyReinsertion(n,a,o,r)),Object.is(n.item,a)||this._addIdentityChange(n,a)):(n=this._mismatch(n,a,o,r),i=!0),n=n._next,r++}),this.length=r;return this._truncate(n),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,n,i,r){let s;return null===t?s=this._itTail:(s=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._reinsertAfter(t,s,r)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._moveAfter(t,s,r)):t=this._addAfter(new P_e(n,i),s,r),t}_verifyReinsertion(t,n,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?t=this._reinsertAfter(s,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const n=t._next;this._addToRemovals(this._unlink(t)),t=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,n,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,s=t._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(t,n,i),this._addToMoves(t,i),t}_moveAfter(t,n,i){return this._unlink(t),this._insertAfter(t,n,i),this._addToMoves(t,i),t}_addAfter(t,n,i){return this._insertAfter(t,n,i),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,n,i){const r=null===n?this._itHead:n._next;return t._next=r,t._prev=n,null===r?this._itTail=t:r._prev=t,null===n?this._itHead=t:n._next=t,null===this._linkedRecords&&(this._linkedRecords=new zH),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const n=t._prev,i=t._next;return null===n?this._itHead=i:n._next=i,null===i?this._itTail=n:i._prev=n,t}_addToMoves(t,n){return t.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new zH),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,n){return t.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class P_e{constructor(t,n){this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class L_e{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,n){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===n||n<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){const n=t._prevDup,i=t._nextDup;return null===n?this._head=i:n._nextDup=i,null===i?this._tail=n:i._prevDup=n,null===this._head}}class zH{constructor(){this.map=new Map}put(t){const n=t.trackById;let i=this.map.get(n);i||(i=new L_e,this.map.set(n,i)),i.add(t)}get(t,n){const r=this.map.get(t);return r?r.get(t,n):null}remove(t){const n=t.trackById;return this.map.get(n).remove(t)&&this.map.delete(n),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function GH(e,t,n){const i=e.previousIndex;if(null===i)return i;let r=0;return n&&i<n.length&&(r=n[i]),i+t+r}class WH{constructor(){}supports(t){return t instanceof Map||wO(t)}create(){return new j_e}}class j_e{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let n;for(n=this._mapHead;null!==n;n=n._next)t(n)}forEachPreviousItem(t){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)t(n)}forEachChangedItem(t){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}diff(t){if(t){if(!(t instanceof Map||wO(t)))throw new Ee(900,"")}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(t,(i,r)=>{if(n&&n.key===r)this._maybeAddToChanges(n,i),this._appendAfter=n,n=n._next;else{const s=this._getOrCreateRecordForKey(r,i);n=this._insertBeforeOrAppend(n,s)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let i=n;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,n){if(t){const i=t._prev;return n._next=t,n._prev=i,t._prev=n,i&&(i._next=n),t===this._mapHead&&(this._mapHead=n),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(t,n){if(this._records.has(t)){const r=this._records.get(t);this._maybeAddToChanges(r,n);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new B_e(t);return this._records.set(t,i),i.currentValue=n,this._addToAdditions(i),i}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,n){Object.is(n,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=n,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,n){t instanceof Map?t.forEach(n):Object.keys(t).forEach(i=>n(t[i],i))}}class B_e{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function qH(){return new Wb([new UH])}let Wb=(()=>{class e{constructor(n){this.factories=n}static create(n,i){if(null!=i){const r=i.factories.slice();n=n.concat(r)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||qH()),deps:[[e,new I0,new _c]]}}find(n){const i=this.factories.find(r=>r.supports(n));if(null!=i)return i;throw new Ee(901,"")}}return e.\u0275prov=Te({token:e,providedIn:"root",factory:qH}),e})();function YH(){return new a_([new WH])}let a_=(()=>{class e{constructor(n){this.factories=n}static create(n,i){if(i){const r=i.factories.slice();n=n.concat(r)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||YH()),deps:[[e,new I0,new _c]]}}find(n){const i=this.factories.find(s=>s.supports(n));if(i)return i;throw new Ee(901,"")}}return e.\u0275prov=Te({token:e,providedIn:"root",factory:YH}),e})();const H_e=IH(null,"core",[{provide:o_,useValue:"unknown"},{provide:FH,deps:[gi]},{provide:MH,deps:[]},{provide:xH,deps:[]}]);let U_e=(()=>{class e{constructor(n){}}return e.\u0275fac=function(n){return new(n||e)(ge(Ub))},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({}),e})(),qb=null;function ol(){return qb}const si=new Xe("DocumentToken");let bd=(()=>{class e{historyGo(n){throw new Error("Not implemented")}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Te({token:e,factory:function(){return function q_e(){return ge(KH)}()},providedIn:"platform"}),e})();const Y_e=new Xe("Location Initialized");let KH=(()=>{class e extends bd{constructor(n){super(),this._doc=n,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ol().getBaseHref(this._doc)}onPopState(n){const i=ol().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",n,!1),()=>i.removeEventListener("popstate",n)}onHashChange(n){const i=ol().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",n,!1),()=>i.removeEventListener("hashchange",n)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(n){this.location.pathname=n}pushState(n,i,r){JH()?this._history.pushState(n,i,r):this.location.hash=r}replaceState(n,i,r){JH()?this._history.replaceState(n,i,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return e.\u0275fac=function(n){return new(n||e)(ge(si))},e.\u0275prov=Te({token:e,factory:function(){return function K_e(){return new KH(ge(si))}()},providedIn:"platform"}),e})();function JH(){return!!window.history.pushState}function wM(e,t){if(0==e.length)return t;if(0==t.length)return e;let n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function XH(e){const t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function vu(e){return e&&"?"!==e[0]?"?"+e:e}let ig=(()=>{class e{historyGo(n){throw new Error("Not implemented")}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Te({token:e,factory:function(){return function J_e(e){const t=ge(si).location;return new QH(ge(bd),t&&t.origin||"")}()},providedIn:"root"}),e})();const DM=new Xe("appBaseHref");let QH=(()=>{class e extends ig{constructor(n,i){if(super(),this._platformLocation=n,this._removeListenerFns=[],null==i&&(i=this._platformLocation.getBaseHrefFromDOM()),null==i)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=i}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return wM(this._baseHref,n)}path(n=!1){const i=this._platformLocation.pathname+vu(this._platformLocation.search),r=this._platformLocation.hash;return r&&n?`${i}${r}`:i}pushState(n,i,r,s){const o=this.prepareExternalUrl(r+vu(s));this._platformLocation.pushState(n,i,o)}replaceState(n,i,r,s){const o=this.prepareExternalUrl(r+vu(s));this._platformLocation.replaceState(n,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,n)}}return e.\u0275fac=function(n){return new(n||e)(ge(bd),ge(DM,8))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})(),X_e=(()=>{class e extends ig{constructor(n,i){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(n){const i=wM(this._baseHref,n);return i.length>0?"#"+i:i}pushState(n,i,r,s){let o=this.prepareExternalUrl(r+vu(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(n,i,o)}replaceState(n,i,r,s){let o=this.prepareExternalUrl(r+vu(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(n,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,n)}}return e.\u0275fac=function(n){return new(n||e)(ge(bd),ge(DM,8))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})(),CM=(()=>{class e{constructor(n,i){this._subject=new it,this._urlChangeListeners=[],this._platformStrategy=n;const r=this._platformStrategy.getBaseHref();this._platformLocation=i,this._baseHref=XH(ZH(r)),this._platformStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}path(n=!1){return this.normalize(this._platformStrategy.path(n))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(n,i=""){return this.path()==this.normalize(n+vu(i))}normalize(n){return e.stripTrailingSlash(function Z_e(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,ZH(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._platformStrategy.prepareExternalUrl(n)}go(n,i="",r=null){this._platformStrategy.pushState(r,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+vu(i)),r)}replaceState(n,i="",r=null){this._platformStrategy.replaceState(r,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+vu(i)),r)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(n=0){var i,r;null===(r=(i=this._platformStrategy).historyGo)||void 0===r||r.call(i,n)}onUrlChange(n){this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}))}_notifyUrlChangeListeners(n="",i){this._urlChangeListeners.forEach(r=>r(n,i))}subscribe(n,i,r){return this._subject.subscribe({next:n,error:i,complete:r})}}return e.normalizeQueryParams=vu,e.joinWithSlash=wM,e.stripTrailingSlash=XH,e.\u0275fac=function(n){return new(n||e)(ge(ig),ge(bd))},e.\u0275prov=Te({token:e,factory:function(){return function Q_e(){return new CM(ge(ig),ge(bd))}()},providedIn:"root"}),e})();function ZH(e){return e.replace(/\/index.html$/,"")}function lU(e,t){t=encodeURIComponent(t);for(const n of e.split(";")){const i=n.indexOf("="),[r,s]=-1==i?[n,""]:[n.slice(0,i),n.slice(i+1)];if(r.trim()===t)return decodeURIComponent(s)}return null}let wd=(()=>{class e{constructor(n,i,r,s){this._iterableDiffers=n,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(n){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof n?n.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(n){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof n?n.split(/\s+/):n,this._rawClass&&(G0(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const n=this._iterableDiffer.diff(this._rawClass);n&&this._applyIterableChanges(n)}else if(this._keyValueDiffer){const n=this._keyValueDiffer.diff(this._rawClass);n&&this._applyKeyValueChanges(n)}}_applyKeyValueChanges(n){n.forEachAddedItem(i=>this._toggleClass(i.key,i.currentValue)),n.forEachChangedItem(i=>this._toggleClass(i.key,i.currentValue)),n.forEachRemovedItem(i=>{i.previousValue&&this._toggleClass(i.key,!1)})}_applyIterableChanges(n){n.forEachAddedItem(i=>{if("string"!=typeof i.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Wt(i.item)}`);this._toggleClass(i.item,!0)}),n.forEachRemovedItem(i=>this._toggleClass(i.item,!1))}_applyClasses(n){n&&(Array.isArray(n)||n instanceof Set?n.forEach(i=>this._toggleClass(i,!0)):Object.keys(n).forEach(i=>this._toggleClass(i,!!n[i])))}_removeClasses(n){n&&(Array.isArray(n)||n instanceof Set?n.forEach(i=>this._toggleClass(i,!1)):Object.keys(n).forEach(i=>this._toggleClass(i,!1)))}_toggleClass(n,i){(n=n.trim())&&n.split(/\s+/g).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return e.\u0275fac=function(n){return new(n||e)(H(Wb),H(a_),H(dn),H(_o))},e.\u0275dir=me({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e})();class Lye{constructor(t,n,i,r){this.$implicit=t,this.ngForOf=n,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let rg=(()=>{class e{constructor(n,i,r){this._viewContainer=n,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const i=this._viewContainer;n.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new Lye(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),uU(a,r)}});for(let r=0,s=i.length;r<s;r++){const a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}n.forEachIdentityChange(r=>{uU(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(n,i){return!0}}return e.\u0275fac=function(n){return new(n||e)(H(ra),H(Vn),H(Wb))},e.\u0275dir=me({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e})();function uU(e,t){e.context.$implicit=t.item}let bo=(()=>{class e{constructor(n,i){this._viewContainer=n,this._context=new jye,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){cU("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){cU("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,i){return!0}}return e.\u0275fac=function(n){return new(n||e)(H(ra),H(Vn))},e.\u0275dir=me({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e})();class jye{constructor(){this.$implicit=null,this.ngIf=null}}function cU(e,t){if(t&&!t.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${Wt(t)}'.`)}let Ps=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({}),e})();let pve=(()=>{class e{}return e.\u0275prov=Te({token:e,providedIn:"root",factory:()=>new gve(ge(si),window)}),e})();class gve{constructor(t,n){this.document=t,this.window=n,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const n=function mve(e,t){const n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow)){const i=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(t)||s.querySelector(`[name="${t}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,t);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const n=this.window.history;n&&n.scrollRestoration&&(n.scrollRestoration=t)}}scrollToElement(t){const n=t.getBoundingClientRect(),i=n.left+this.window.pageXOffset,r=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=pU(this.window.history)||pU(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch(t){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(t){return!1}}}function pU(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}class gU{}class LM extends class _ve extends class W_e{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function G_e(e){qb||(qb=e)}(new LM)}onAndCancel(t,n,i){return t.addEventListener(n,i,!1),()=>{t.removeEventListener(n,i,!1)}}dispatchEvent(t,n){t.dispatchEvent(n)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,n){return(n=n||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,n){return"window"===n?window:"document"===n?t:"body"===n?t.body:null}getBaseHref(t){const n=function yve(){return f_=f_||document.querySelector("base"),f_?f_.getAttribute("href"):null}();return null==n?null:function vve(e){iw=iw||document.createElement("a"),iw.setAttribute("href",e);const t=iw.pathname;return"/"===t.charAt(0)?t:`/${t}`}(n)}resetBaseElement(){f_=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return lU(document.cookie,t)}}let iw,f_=null;const mU=new Xe("TRANSITION_ID"),wve=[{provide:lM,useFactory:function bve(e,t,n){return()=>{n.get(uM).donePromise.then(()=>{const i=ol(),r=t.querySelectorAll(`style[ng-transition="${e}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[mU,si,gi],multi:!0}];class jM{static init(){!function v_e(e){gM=e}(new jM)}addToWindow(t){Jt.getAngularTestability=(i,r=!0)=>{const s=t.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},Jt.getAllAngularTestabilities=()=>t.getAllTestabilities(),Jt.getAllAngularRootElements=()=>t.getAllRootElements(),Jt.frameworkStabilizers||(Jt.frameworkStabilizers=[]),Jt.frameworkStabilizers.push(i=>{const r=Jt.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(t,n,i){if(null==n)return null;const r=t.getTestability(n);return null!=r?r:i?ol().isShadowRoot(n)?this.findTestabilityInTree(t,n.host,!0):this.findTestabilityInTree(t,n.parentElement,!0):null}}let Dve=(()=>{class e{build(){return new XMLHttpRequest}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})();const rw=new Xe("EventManagerPlugins");let sw=(()=>{class e{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(r=>r.manager=this),this._plugins=n.slice().reverse()}addEventListener(n,i,r){return this._findPluginFor(i).addEventListener(n,i,r)}addGlobalEventListener(n,i,r){return this._findPluginFor(i).addGlobalEventListener(n,i,r)}getZone(){return this._zone}_findPluginFor(n){const i=this._eventNameToPlugin.get(n);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(n))return this._eventNameToPlugin.set(n,o),o}throw new Error(`No event manager plugin found for event ${n}`)}}return e.\u0275fac=function(n){return new(n||e)(ge(rw),ge(hn))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})();class _U{constructor(t){this._doc=t}addGlobalEventListener(t,n,i){const r=ol().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${n}`);return this.addEventListener(r,n,i)}}let yU=(()=>{class e{constructor(){this._stylesSet=new Set}addStyles(n){const i=new Set;n.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(n){}getAllStyles(){return Array.from(this._stylesSet)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})(),d_=(()=>{class e extends yU{constructor(n){super(),this._doc=n,this._hostNodes=new Map,this._hostNodes.set(n.head,[])}_addStylesToHost(n,i,r){n.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(n){const i=[];this._addStylesToHost(this._stylesSet,n,i),this._hostNodes.set(n,i)}removeHost(n){const i=this._hostNodes.get(n);i&&i.forEach(vU),this._hostNodes.delete(n)}onStylesAdded(n){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(n,r,i)})}ngOnDestroy(){this._hostNodes.forEach(n=>n.forEach(vU))}}return e.\u0275fac=function(n){return new(n||e)(ge(si))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})();function vU(e){ol().remove(e)}const BM={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},$M=/%COMP%/g;function ow(e,t,n){for(let i=0;i<t.length;i++){let r=t[i];Array.isArray(r)?ow(e,r,n):(r=r.replace($M,e),n.push(r))}return n}function DU(e){return t=>{if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}let aw=(()=>{class e{constructor(n,i,r){this.eventManager=n,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new VM(n)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;switch(i.encapsulation){case Yo.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new Tve(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(n),r}case 1:case Yo.ShadowDom:return new Ove(this.eventManager,this.sharedStylesHost,n,i);default:if(!this.rendererByCompId.has(i.id)){const r=ow(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return e.\u0275fac=function(n){return new(n||e)(ge(sw),ge(d_),ge(s_))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})();class VM{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,n){return n?document.createElementNS(BM[n]||n,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,n){t.appendChild(n)}insertBefore(t,n,i){t&&t.insertBefore(n,i)}removeChild(t,n){t&&t.removeChild(n)}selectRootElement(t,n){let i="string"==typeof t?document.querySelector(t):t;if(!i)throw new Error(`The selector "${t}" did not match any elements`);return n||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,n,i,r){if(r){n=r+":"+n;const s=BM[r];s?t.setAttributeNS(s,n,i):t.setAttribute(n,i)}else t.setAttribute(n,i)}removeAttribute(t,n,i){if(i){const r=BM[i];r?t.removeAttributeNS(r,n):t.removeAttribute(`${i}:${n}`)}else t.removeAttribute(n)}addClass(t,n){t.classList.add(n)}removeClass(t,n){t.classList.remove(n)}setStyle(t,n,i,r){r&(Rs.DashCase|Rs.Important)?t.style.setProperty(n,i,r&Rs.Important?"important":""):t.style[n]=i}removeStyle(t,n,i){i&Rs.DashCase?t.style.removeProperty(n):t.style[n]=""}setProperty(t,n,i){t[n]=i}setValue(t,n){t.nodeValue=n}listen(t,n,i){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,n,DU(i)):this.eventManager.addEventListener(t,n,DU(i))}}class Tve extends VM{constructor(t,n,i,r){super(t),this.component=i;const s=ow(r+"-"+i.id,i.styles,[]);n.addStyles(s),this.contentAttr=function Sve(e){return"_ngcontent-%COMP%".replace($M,e)}(r+"-"+i.id),this.hostAttr=function xve(e){return"_nghost-%COMP%".replace($M,e)}(r+"-"+i.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,n){const i=super.createElement(t,n);return super.setAttribute(i,this.contentAttr,""),i}}class Ove extends VM{constructor(t,n,i,r){super(t),this.sharedStylesHost=n,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=ow(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,n){return super.appendChild(this.nodeOrShadowRoot(t),n)}insertBefore(t,n,i){return super.insertBefore(this.nodeOrShadowRoot(t),n,i)}removeChild(t,n){return super.removeChild(this.nodeOrShadowRoot(t),n)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let Mve=(()=>{class e extends _U{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,r){return n.addEventListener(i,r,!1),()=>this.removeEventListener(n,i,r)}removeEventListener(n,i,r){return n.removeEventListener(i,r)}}return e.\u0275fac=function(n){return new(n||e)(ge(si))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})();const EU=["alt","control","meta","shift"],kve={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},SU={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Ive={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let Rve=(()=>{class e extends _U{constructor(n){super(n)}supports(n){return null!=e.parseEventName(n)}addEventListener(n,i,r){const s=e.parseEventName(i),o=e.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ol().onAndCancel(n,s.domEventName,o))}static parseEventName(n){const i=n.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=e._normalizeKey(i.pop());let o="";if(EU.forEach(l=>{const u=i.indexOf(l);u>-1&&(i.splice(u,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(n){let i="",r=function Fve(e){let t=e.key;if(null==t){if(t=e.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&SU.hasOwnProperty(t)&&(t=SU[t]))}return kve[t]||t}(n);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),EU.forEach(s=>{s!=r&&Ive[s](n)&&(i+=s+".")}),i+=r,i}static eventCallback(n,i,r){return s=>{e.getEventFullKey(s)===n&&r.runGuarded(()=>i(s))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return e.\u0275fac=function(n){return new(n||e)(ge(si))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})();const Bve=IH(H_e,"browser",[{provide:o_,useValue:"browser"},{provide:EH,useValue:function Pve(){LM.makeCurrent(),jM.init()},multi:!0},{provide:si,useFactory:function jve(){return function ufe(e){tT=e}(document),document},deps:[]}]),$ve=[{provide:gO,useValue:"root"},{provide:B0,useFactory:function Lve(){return new B0},deps:[]},{provide:rw,useClass:Mve,multi:!0,deps:[si,hn,o_]},{provide:rw,useClass:Rve,multi:!0,deps:[si]},{provide:aw,useClass:aw,deps:[sw,d_,s_]},{provide:eg,useExisting:aw},{provide:yU,useExisting:d_},{provide:d_,useClass:d_,deps:[si]},{provide:pM,useClass:pM,deps:[hn]},{provide:sw,useClass:sw,deps:[rw,hn]},{provide:gU,useClass:Dve,deps:[]}];let xU=(()=>{class e{constructor(n){if(n)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(n){return{ngModule:e,providers:[{provide:s_,useValue:n.appId},{provide:mU,useExisting:s_},wve]}}}return e.\u0275fac=function(n){return new(n||e)(ge(e,12))},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({providers:$ve,imports:[Ps,U_e]}),e})();function Ge(...e){return Ai(e,_0(e))}"undefined"!=typeof window&&window;class Oi extends On{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const n=super._subscribe(t);return!n.closed&&t.next(this._value),n}getValue(){const{hasError:t,thrownError:n,_value:i}=this;if(t)throw n;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}}const{isArray:Xve}=Array,{getPrototypeOf:Qve,prototype:Zve,keys:e1e}=Object;function OU(e){if(1===e.length){const t=e[0];if(Xve(t))return{args:t,keys:null};if(function t1e(e){return e&&"object"==typeof e&&Qve(e)===Zve}(t)){const n=e1e(t);return{args:n.map(i=>t[i]),keys:n}}}return{args:e,keys:null}}const{isArray:n1e}=Array;function UM(e){return lt(t=>function i1e(e,t){return n1e(t)?e(...t):e(t)}(e,t))}function MU(e,t){return e.reduce((n,i,r)=>(n[i]=t[r],n),{})}function NU(e,t,n){e?uu(n,e,t):t()}function lw(e,t){const n=qe(e)?e:()=>e,i=r=>r.error(n());return new rn(t?r=>t.schedule(i,0,r):i)}const uw=Ue(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function h_(...e){return function s1e(){return m0(1)}()(Ai(e,_0(e)))}function kU(e){return new rn(t=>{Zi(e()).subscribe(t)})}function IU(){return Kn((e,t)=>{let n=null;e._refCount++;const i=_n(t,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(n=null);const r=e._connection,s=n;n=null,r&&(!s||r===s)&&r.unsubscribe(),t.unsubscribe()});e.subscribe(i),i.closed||(n=e.connect())})}class o1e extends rn{constructor(t,n){super(),this.source=t,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,n$(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,null==t||t.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new Yn;const n=this.getSubject();t.add(this.source.subscribe(_n(n,void 0,()=>{this._teardown(),n.complete()},i=>{this._teardown(),n.error(i)},()=>this._teardown()))),t.closed&&(this._connection=null,t=Yn.EMPTY)}return t}refCount(){return IU()(this)}}function wu(e,t){return Kn((n,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();n.subscribe(_n(i,l=>{null==r||r.unsubscribe();let u=0;const c=s++;Zi(e(l,c)).subscribe(r=_n(i,f=>i.next(t?t(l,f,c,u++):f),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function a1e(e,t,n,i,r){return(s,o)=>{let a=n,l=t,u=0;s.subscribe(_n(o,c=>{const f=u++;l=a?e(l,c,f):(a=!0,c),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}function RU(e,t){return Kn(a1e(e,t,arguments.length>=2,!0))}function ns(e,t){return Kn((n,i)=>{let r=0;n.subscribe(_n(i,s=>e.call(t,s,r++)&&i.next(s)))})}function xc(e){return Kn((t,n)=>{let s,i=null,r=!1;i=t.subscribe(_n(n,void 0,void 0,o=>{s=Zi(e(o,xc(e)(t))),i?(i.unsubscribe(),i=null,s.subscribe(n)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(n))})}function sg(e,t){return qe(t)?ti(e,t,1):ti(e,1)}function GM(e){return e<=0?()=>Wo:Kn((t,n)=>{let i=[];t.subscribe(_n(n,r=>{i.push(r),e<i.length&&i.shift()},()=>{for(const r of i)n.next(r);n.complete()},void 0,()=>{i=null}))})}function FU(e=l1e){return Kn((t,n)=>{let i=!1;t.subscribe(_n(n,r=>{i=!0,n.next(r)},()=>i?n.complete():n.error(e())))})}function l1e(){return new uw}function PU(e){return Kn((t,n)=>{let i=!1;t.subscribe(_n(n,r=>{i=!0,n.next(r)},()=>{i||n.next(e),n.complete()}))})}function og(e,t){const n=arguments.length>=2;return i=>i.pipe(e?ns((r,s)=>e(r,s,i)):lu,Hi(1),n?PU(t):FU(()=>new uw))}function Mr(e,t,n){const i=qe(e)||t||n?{next:e,error:t,complete:n}:e;return i?Kn((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(_n(s,l=>{var u;null===(u=i.next)||void 0===u||u.call(i,l),s.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),s.complete()},l=>{var u;a=!1,null===(u=i.error)||void 0===u||u.call(i,l),s.error(l)},()=>{var l,u;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(u=i.finalize)||void 0===u||u.call(i)}))}):lu}class Du{constructor(t,n){this.id=t,this.url=n}}class WM extends Du{constructor(t,n,i="imperative",r=null){super(t,n),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class p_ extends Du{constructor(t,n,i){super(t,n),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class LU extends Du{constructor(t,n,i){super(t,n),this.reason=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class f1e extends Du{constructor(t,n,i){super(t,n),this.error=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class d1e extends Du{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class h1e extends Du{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class p1e extends Du{constructor(t,n,i,r,s){super(t,n),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class g1e extends Du{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class m1e extends Du{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class jU{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class BU{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class _1e{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class y1e{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class v1e{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class b1e{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $U{constructor(t,n,i){this.routerEvent=t,this.position=n,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const dt="primary";class w1e{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n[0]:n}return null}getAll(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function ag(e){return new w1e(e)}const VU="ngNavigationCancelingError";function qM(e){const t=Error("NavigationCancelingError: "+e);return t[VU]=!0,t}function C1e(e,t,n){const i=n.path.split("/");if(i.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||i.length<e.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=e[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:e.slice(0,i.length),posParams:r}}function al(e,t){const n=e?Object.keys(e):void 0,i=t?Object.keys(t):void 0;if(!n||!i||n.length!=i.length)return!1;let r;for(let s=0;s<n.length;s++)if(r=n[s],!HU(e[r],t[r]))return!1;return!0}function HU(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;const n=[...e].sort(),i=[...t].sort();return n.every((r,s)=>i[s]===r)}return e===t}function UU(e){return Array.prototype.concat.apply([],e)}function zU(e){return e.length>0?e[e.length-1]:null}function Ui(e,t){for(const n in e)e.hasOwnProperty(n)&&t(e[n],n)}function ll(e){return MO(e)?e:q0(e)?Ai(Promise.resolve(e)):Ge(e)}const x1e={exact:function qU(e,t,n){if(!Cd(e.segments,t.segments)||!fw(e.segments,t.segments,n)||e.numberOfChildren!==t.numberOfChildren)return!1;for(const i in t.children)if(!e.children[i]||!qU(e.children[i],t.children[i],n))return!1;return!0},subset:YU},GU={exact:function A1e(e,t){return al(e,t)},subset:function T1e(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(n=>HU(e[n],t[n]))},ignored:()=>!0};function WU(e,t,n){return x1e[n.paths](e.root,t.root,n.matrixParams)&&GU[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function YU(e,t,n){return KU(e,t,t.segments,n)}function KU(e,t,n,i){if(e.segments.length>n.length){const r=e.segments.slice(0,n.length);return!(!Cd(r,n)||t.hasChildren()||!fw(r,n,i))}if(e.segments.length===n.length){if(!Cd(e.segments,n)||!fw(e.segments,n,i))return!1;for(const r in t.children)if(!e.children[r]||!YU(e.children[r],t.children[r],i))return!1;return!0}{const r=n.slice(0,e.segments.length),s=n.slice(e.segments.length);return!!(Cd(e.segments,r)&&fw(e.segments,r,i)&&e.children[dt])&&KU(e.children[dt],t,s,i)}}function fw(e,t,n){return t.every((i,r)=>GU[n](e[r].parameters,i.parameters))}class Dd{constructor(t,n,i){this.root=t,this.queryParams=n,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ag(this.queryParams)),this._queryParamMap}toString(){return N1e.serialize(this)}}class mt{constructor(t,n){this.segments=t,this.children=n,this.parent=null,Ui(n,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return dw(this)}}class g_{constructor(t,n){this.path=t,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=ag(this.parameters)),this._parameterMap}toString(){return e7(this)}}function Cd(e,t){return e.length===t.length&&e.every((n,i)=>n.path===t[i].path)}class JU{}class XU{parse(t){const n=new $1e(t);return new Dd(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(t){const n=`/${m_(t.root,!0)}`,i=function R1e(e){const t=Object.keys(e).map(n=>{const i=e[n];return Array.isArray(i)?i.map(r=>`${hw(n)}=${hw(r)}`).join("&"):`${hw(n)}=${hw(i)}`}).filter(n=>!!n);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${n}${i}${"string"==typeof t.fragment?`#${function k1e(e){return encodeURI(e)}(t.fragment)}`:""}`}}const N1e=new XU;function dw(e){return e.segments.map(t=>e7(t)).join("/")}function m_(e,t){if(!e.hasChildren())return dw(e);if(t){const n=e.children[dt]?m_(e.children[dt],!1):"",i=[];return Ui(e.children,(r,s)=>{s!==dt&&i.push(`${s}:${m_(r,!1)}`)}),i.length>0?`${n}(${i.join("//")})`:n}{const n=function M1e(e,t){let n=[];return Ui(e.children,(i,r)=>{r===dt&&(n=n.concat(t(i,r)))}),Ui(e.children,(i,r)=>{r!==dt&&(n=n.concat(t(i,r)))}),n}(e,(i,r)=>r===dt?[m_(e.children[dt],!1)]:[`${r}:${m_(i,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[dt]?`${dw(e)}/${n[0]}`:`${dw(e)}/(${n.join("//")})`}}function QU(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function hw(e){return QU(e).replace(/%3B/gi,";")}function YM(e){return QU(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function pw(e){return decodeURIComponent(e)}function ZU(e){return pw(e.replace(/\+/g,"%20"))}function e7(e){return`${YM(e.path)}${function I1e(e){return Object.keys(e).map(t=>`;${YM(t)}=${YM(e[t])}`).join("")}(e.parameters)}`}const F1e=/^[^\/()?;=#]+/;function gw(e){const t=e.match(F1e);return t?t[0]:""}const P1e=/^[^=?&#]+/,j1e=/^[^&#]+/;class $1e{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new mt([],{}):new mt([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(t.length>0||Object.keys(n).length>0)&&(i[dt]=new mt(t,n)),i}parseSegment(){const t=gw(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new g_(pw(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const n=gw(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){const r=gw(this.remaining);r&&(i=r,this.capture(i))}t[pw(n)]=pw(i)}parseQueryParam(t){const n=function L1e(e){const t=e.match(P1e);return t?t[0]:""}(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){const o=function B1e(e){const t=e.match(j1e);return t?t[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=ZU(n),s=ZU(i);if(t.hasOwnProperty(r)){let o=t[r];Array.isArray(o)||(o=[o],t[r]=o),o.push(s)}else t[r]=s}parseParens(t){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=gw(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let s;i.indexOf(":")>-1?(s=i.substr(0,i.indexOf(":")),this.capture(s),this.capture(":")):t&&(s=dt);const o=this.parseChildren();n[s]=1===Object.keys(o).length?o[dt]:new mt([],o),this.consumeOptional("//")}return n}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class t7{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const n=this.pathFromRoot(t);return n.length>1?n[n.length-2]:null}children(t){const n=KM(t,this._root);return n?n.children.map(i=>i.value):[]}firstChild(t){const n=KM(t,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(t){const n=JM(t,this._root);return n.length<2?[]:n[n.length-2].children.map(r=>r.value).filter(r=>r!==t)}pathFromRoot(t){return JM(t,this._root).map(n=>n.value)}}function KM(e,t){if(e===t.value)return t;for(const n of t.children){const i=KM(e,n);if(i)return i}return null}function JM(e,t){if(e===t.value)return[t];for(const n of t.children){const i=JM(e,n);if(i.length)return i.unshift(t),i}return[]}class Cu{constructor(t,n){this.value=t,this.children=n}toString(){return`TreeNode(${this.value})`}}function lg(e){const t={};return e&&e.children.forEach(n=>t[n.value.outlet]=n),t}class n7 extends t7{constructor(t,n){super(t),this.snapshot=n,XM(this,t)}toString(){return this.snapshot.toString()}}function i7(e,t){const n=function V1e(e,t){const o=new mw([],{},{},"",{},dt,t,null,e.root,-1,{});return new s7("",new Cu(o,[]))}(e,t),i=new Oi([new g_("",{})]),r=new Oi({}),s=new Oi({}),o=new Oi({}),a=new Oi(""),l=new Ed(i,r,o,a,s,dt,t,n.root);return l.snapshot=n.root,new n7(new Cu(l,[]),n)}class Ed{constructor(t,n,i,r,s,o,a,l){this.url=t,this.params=n,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(lt(t=>ag(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(lt(t=>ag(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function r7(e,t="emptyOnly"){const n=e.pathFromRoot;let i=0;if("always"!==t)for(i=n.length-1;i>=1;){const r=n[i],s=n[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function H1e(e){return e.reduce((t,n)=>({params:Object.assign(Object.assign({},t.params),n.params),data:Object.assign(Object.assign({},t.data),n.data),resolve:Object.assign(Object.assign({},t.resolve),n._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(i))}class mw{constructor(t,n,i,r,s,o,a,l,u,c,f){this.url=t,this.params=n,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=u,this._lastPathIndex=c,this._resolve=f}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ag(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ag(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class s7 extends t7{constructor(t,n){super(n),this.url=t,XM(this,n)}toString(){return o7(this._root)}}function XM(e,t){t.value._routerState=e,t.children.forEach(n=>XM(e,n))}function o7(e){const t=e.children.length>0?` { ${e.children.map(o7).join(", ")} } `:"";return`${e.value}${t}`}function QM(e){if(e.snapshot){const t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,al(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),al(t.params,n.params)||e.params.next(n.params),function E1e(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!al(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),al(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function ZM(e,t){const n=al(e.params,t.params)&&function O1e(e,t){return Cd(e,t)&&e.every((n,i)=>al(n.parameters,t[i].parameters))}(e.url,t.url);return n&&!(!e.parent!=!t.parent)&&(!e.parent||ZM(e.parent,t.parent))}function __(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){const i=n.value;i._futureSnapshot=t.value;const r=function z1e(e,t,n){return t.children.map(i=>{for(const r of n.children)if(e.shouldReuseRoute(i.value,r.value.snapshot))return __(e,i,r);return __(e,i)})}(e,t,n);return new Cu(i,r)}{if(e.shouldAttach(t.value)){const s=e.retrieve(t.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=t.value,o.children=t.children.map(a=>__(e,a)),o}}const i=function G1e(e){return new Ed(new Oi(e.url),new Oi(e.params),new Oi(e.queryParams),new Oi(e.fragment),new Oi(e.data),e.outlet,e.component,e)}(t.value),r=t.children.map(s=>__(e,s));return new Cu(i,r)}}function _w(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function y_(e){return"object"==typeof e&&null!=e&&e.outlets}function eN(e,t,n,i,r){let s={};if(i&&Ui(i,(a,l)=>{s[l]=Array.isArray(a)?a.map(u=>`${u}`):`${a}`}),e===t)return new Dd(n,s,r);const o=a7(e,t,n);return new Dd(o,s,r)}function a7(e,t,n){const i={};return Ui(e.children,(r,s)=>{i[s]=r===t?n:a7(r,t,n)}),new mt(e.segments,i)}class l7{constructor(t,n,i){if(this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=i,t&&i.length>0&&_w(i[0]))throw new Error("Root segment cannot have matrix parameters");const r=i.find(y_);if(r&&r!==zU(i))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class tN{constructor(t,n,i){this.segmentGroup=t,this.processChildren=n,this.index=i}}function u7(e,t,n){if(e||(e=new mt([],{})),0===e.segments.length&&e.hasChildren())return yw(e,t,n);const i=function X1e(e,t,n){let i=0,r=t;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<e.segments.length;){if(i>=n.length)return s;const o=e.segments[r],a=n[i];if(y_(a))break;const l=`${a}`,u=i<n.length-1?n[i+1]:null;if(r>0&&void 0===l)break;if(l&&u&&"object"==typeof u&&void 0===u.outlets){if(!f7(l,u,o))return s;i+=2}else{if(!f7(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(e,t,n),r=n.slice(i.commandIndex);if(i.match&&i.pathIndex<e.segments.length){const s=new mt(e.segments.slice(0,i.pathIndex),{});return s.children[dt]=new mt(e.segments.slice(i.pathIndex),e.children),yw(s,0,r)}return i.match&&0===r.length?new mt(e.segments,{}):i.match&&!e.hasChildren()?nN(e,t,n):i.match?yw(e,0,r):nN(e,t,n)}function yw(e,t,n){if(0===n.length)return new mt(e.segments,{});{const i=function J1e(e){return y_(e[0])?e[0].outlets:{[dt]:e}}(n),r={};return Ui(i,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=u7(e.children[o],t,s))}),Ui(e.children,(s,o)=>{void 0===i[o]&&(r[o]=s)}),new mt(e.segments,r)}}function nN(e,t,n){const i=e.segments.slice(0,t);let r=0;for(;r<n.length;){const s=n[r];if(y_(s)){const l=Q1e(s.outlets);return new mt(i,l)}if(0===r&&_w(n[0])){i.push(new g_(e.segments[t].path,c7(n[0]))),r++;continue}const o=y_(s)?s.outlets[dt]:`${s}`,a=r<n.length-1?n[r+1]:null;o&&a&&_w(a)?(i.push(new g_(o,c7(a))),r+=2):(i.push(new g_(o,{})),r++)}return new mt(i,{})}function Q1e(e){const t={};return Ui(e,(n,i)=>{"string"==typeof n&&(n=[n]),null!==n&&(t[i]=nN(new mt([],{}),0,n))}),t}function c7(e){const t={};return Ui(e,(n,i)=>t[i]=`${n}`),t}function f7(e,t,n){return e==n.path&&al(t,n.parameters)}class ebe{constructor(t,n,i,r){this.routeReuseStrategy=t,this.futureState=n,this.currState=i,this.forwardEvent=r}activate(t){const n=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,i,t),QM(this.futureState.root),this.activateChildRoutes(n,i,t)}deactivateChildRoutes(t,n,i){const r=lg(n);t.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Ui(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(t,n,i){const r=t.value,s=n?n.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(t,n,o.children)}else this.deactivateChildRoutes(t,n,i);else s&&this.deactivateRouteAndItsChildren(n,i)}deactivateRouteAndItsChildren(t,n){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,n):this.deactivateRouteAndOutlet(t,n)}detachAndStoreRouteSubtree(t,n){const i=n.getContext(t.value.outlet),r=i&&t.value.component?i.children:n,s=lg(t);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:o,route:t,contexts:a})}}deactivateRouteAndOutlet(t,n){const i=n.getContext(t.value.outlet),r=i&&t.value.component?i.children:n,s=lg(t);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(t,n,i){const r=lg(n);t.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new b1e(s.value.snapshot))}),t.children.length&&this.forwardEvent(new y1e(t.value.snapshot))}activateRoutes(t,n,i){const r=t.value,s=n?n.value:null;if(QM(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(t,n,o.children)}else this.activateChildRoutes(t,n,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),QM(a.route.value),this.activateChildRoutes(t,null,o.children)}else{const a=function tbe(e){for(let t=e.parent;t;t=t.parent){const n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),l=a?a.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=l,o.outlet&&o.outlet.activateWith(r,l),this.activateChildRoutes(t,null,o.children)}}else this.activateChildRoutes(t,null,i)}}class iN{constructor(t,n){this.routes=t,this.module=n}}function Ac(e){return"function"==typeof e}function Sd(e){return e instanceof Dd}const v_=Symbol("INITIAL_VALUE");function b_(){return wu(e=>function zM(...e){const t=_0(e),n=B1(e),{args:i,keys:r}=OU(e);if(0===i.length)return Ai([],t);const s=new rn(function r1e(e,t,n=lu){return i=>{NU(t,()=>{const{length:r}=e,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)NU(t,()=>{const u=Ai(e[l],t);let c=!1;u.subscribe(_n(i,f=>{s[l]=f,c||(c=!0,a--),a||i.next(n(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,t,r?o=>MU(r,o):lu));return n?s.pipe(UM(n)):s}(e.map(t=>t.pipe(Hi(1),function cw(...e){const t=_0(e);return Kn((n,i)=>{(t?h_(e,n,t):h_(e,n)).subscribe(i)})}(v_)))).pipe(RU((t,n)=>{let i=!1;return n.reduce((r,s,o)=>r!==v_?r:(s===v_&&(i=!0),i||!1!==s&&o!==n.length-1&&!Sd(s)?r:s),t)},v_),ns(t=>t!==v_),lt(t=>Sd(t)?t:!0===t),Hi(1)))}class abe{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new w_,this.attachRef=null}}class w_{constructor(){this.contexts=new Map}onChildOutletCreated(t,n){const i=this.getOrCreateContext(t);i.outlet=n,this.contexts.set(t,i)}onChildOutletDestroyed(t){const n=this.getContext(t);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let n=this.getContext(t);return n||(n=new abe,this.contexts.set(t,n)),n}getContext(t){return this.contexts.get(t)||null}}let rN=(()=>{class e{constructor(n,i,r,s,o){this.parentContexts=n,this.location=i,this.resolver=r,this.changeDetector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new it,this.deactivateEvents=new it,this.attachEvents=new it,this.detachEvents=new it,this.name=s||dt,n.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const n=this.parentContexts.getContext(this.name);n&&n.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=n;const o=(i=i||this.resolver).resolveComponentFactory(n._futureSnapshot.routeConfig.component),a=this.parentContexts.getOrCreateContext(this.name).children,l=new lbe(n,a,this.location.injector);this.activated=this.location.createComponent(o,this.location.length,l),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return e.\u0275fac=function(n){return new(n||e)(H(w_),H(ra),H(Qp),function pd(e){return function $fe(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;const n=e.attrs;if(n){const i=n.length;let r=0;for(;r<i;){const s=n[r];if(q$(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof n[r];)r++;else{if(s===t)return n[r+1];r+=2}}}return null}(hi(),e)}("name"),H(oa))},e.\u0275dir=me({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),e})();class lbe{constructor(t,n,i){this.route=t,this.childContexts=n,this.parent=i}get(t,n){return t===Ed?this.route:t===w_?this.childContexts:this.parent.get(t,n)}}let d7=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Mn({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(n,i){1&n&&$t(0,"router-outlet")},directives:[rN],encapsulation:2}),e})();function h7(e,t=""){for(let n=0;n<e.length;n++){const i=e[n];ube(i,cbe(t,i))}}function ube(e,t){e.children&&h7(e.children,t)}function cbe(e,t){return t?e||t.path?e&&!t.path?`${e}/`:!e&&t.path?t.path:`${e}/${t.path}`:"":e}function sN(e){const t=e.children&&e.children.map(sN),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==dt&&(n.component=d7),n}function wo(e){return e.outlet||dt}function p7(e,t){const n=e.filter(i=>wo(i)===t);return n.push(...e.filter(i=>wo(i)!==t)),n}const g7={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function vw(e,t,n){var i;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?Object.assign({},g7):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};const s=(t.matcher||C1e)(n,e,t);if(!s)return Object.assign({},g7);const o={};Ui(s.posParams,(l,u)=>{o[u]=l.path});const a=s.consumed.length>0?Object.assign(Object.assign({},o),s.consumed[s.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:s.consumed,remainingSegments:n.slice(s.consumed.length),parameters:a,positionalParamSegments:null!==(i=s.posParams)&&void 0!==i?i:{}}}function bw(e,t,n,i,r="corrected"){if(n.length>0&&function hbe(e,t,n){return n.some(i=>ww(e,t,i)&&wo(i)!==dt)}(e,n,i)){const o=new mt(t,function dbe(e,t,n,i){const r={};r[dt]=i,i._sourceSegment=e,i._segmentIndexShift=t.length;for(const s of n)if(""===s.path&&wo(s)!==dt){const o=new mt([],{});o._sourceSegment=e,o._segmentIndexShift=t.length,r[wo(s)]=o}return r}(e,t,i,new mt(n,e.children)));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:[]}}if(0===n.length&&function pbe(e,t,n){return n.some(i=>ww(e,t,i))}(e,n,i)){const o=new mt(e.segments,function fbe(e,t,n,i,r,s){const o={};for(const a of i)if(ww(e,n,a)&&!r[wo(a)]){const l=new mt([],{});l._sourceSegment=e,l._segmentIndexShift="legacy"===s?e.segments.length:t.length,o[wo(a)]=l}return Object.assign(Object.assign({},r),o)}(e,t,n,i,e.children,r));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:n}}const s=new mt(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function ww(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function m7(e,t,n,i){return!!(wo(e)===i||i!==dt&&ww(t,n,e))&&("**"===e.path||vw(t,e,n).matched)}function _7(e,t,n){return 0===t.length&&!e.children[n]}class Dw{constructor(t){this.segmentGroup=t||null}}class y7{constructor(t){this.urlTree=t}}function D_(e){return lw(new Dw(e))}function v7(e){return lw(new y7(e))}class ybe{constructor(t,n,i,r,s){this.configLoader=n,this.urlSerializer=i,this.urlTree=r,this.config=s,this.allowRedirects=!0,this.ngModule=t.get(_u)}apply(){const t=bw(this.urlTree.root,[],[],this.config).segmentGroup,n=new mt(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,n,dt).pipe(lt(s=>this.createUrlTree(oN(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(xc(s=>{if(s instanceof y7)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof Dw?this.noMatchError(s):s}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,dt).pipe(lt(r=>this.createUrlTree(oN(r),t.queryParams,t.fragment))).pipe(xc(r=>{throw r instanceof Dw?this.noMatchError(r):r}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,n,i){const r=t.segments.length>0?new mt([],{[dt]:t}):t;return new Dd(r,n,i)}expandSegmentGroup(t,n,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(t,n,i).pipe(lt(s=>new mt([],s))):this.expandSegment(t,i,n,i.segments,r,!0)}expandChildren(t,n,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return Ai(r).pipe(sg(s=>{const o=i.children[s],a=p7(n,s);return this.expandSegmentGroup(t,a,o,s).pipe(lt(l=>({segment:l,outlet:s})))}),RU((s,o)=>(s[o.outlet]=o.segment,s),{}),function u1e(e,t){const n=arguments.length>=2;return i=>i.pipe(e?ns((r,s)=>e(r,s,i)):lu,GM(1),n?PU(t):FU(()=>new uw))}())}expandSegment(t,n,i,r,s,o){return Ai(i).pipe(sg(a=>this.expandSegmentAgainstRoute(t,n,i,a,r,s,o).pipe(xc(u=>{if(u instanceof Dw)return Ge(null);throw u}))),og(a=>!!a),xc((a,l)=>{if(a instanceof uw||"EmptyError"===a.name)return _7(n,r,s)?Ge(new mt([],{})):D_(n);throw a}))}expandSegmentAgainstRoute(t,n,i,r,s,o,a){return m7(r,n,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,n,r,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,n,i,r,s,o):D_(n):D_(n)}expandSegmentAgainstRouteUsingRedirect(t,n,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,n,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,i,r){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?v7(s):this.lineralizeSegments(i,s).pipe(ti(o=>{const a=new mt(o,{});return this.expandSegment(t,a,n,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,n,i,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:u,positionalParamSegments:c}=vw(n,r,s);if(!a)return D_(n);const f=this.applyRedirectCommands(l,r.redirectTo,c);return r.redirectTo.startsWith("/")?v7(f):this.lineralizeSegments(r,f).pipe(ti(d=>this.expandSegment(t,n,i,d.concat(u),o,!1)))}matchSegmentAgainstRoute(t,n,i,r,s){if("**"===i.path)return i.loadChildren?(i._loadedConfig?Ge(i._loadedConfig):this.configLoader.load(t.injector,i)).pipe(lt(f=>(i._loadedConfig=f,new mt(r,{})))):Ge(new mt(r,{}));const{matched:o,consumedSegments:a,remainingSegments:l}=vw(n,i,r);return o?this.getChildConfig(t,i,r).pipe(ti(c=>{const f=c.module,d=c.routes,{segmentGroup:h,slicedSegments:p}=bw(n,a,l,d),g=new mt(h.segments,h.children);if(0===p.length&&g.hasChildren())return this.expandChildren(f,d,g).pipe(lt(v=>new mt(a,v)));if(0===d.length&&0===p.length)return Ge(new mt(a,{}));const m=wo(i)===s;return this.expandSegment(f,g,d,p,m?dt:s,!0).pipe(lt(y=>new mt(a.concat(y.segments),y.children)))})):D_(n)}getChildConfig(t,n,i){return n.children?Ge(new iN(n.children,t)):n.loadChildren?void 0!==n._loadedConfig?Ge(n._loadedConfig):this.runCanLoadGuards(t.injector,n,i).pipe(ti(r=>r?this.configLoader.load(t.injector,n).pipe(lt(s=>(n._loadedConfig=s,s))):function mbe(e){return lw(qM(`Cannot load children because the guard of the route "path: '${e.path}'" returned false`))}(n))):Ge(new iN([],t))}runCanLoadGuards(t,n,i){const r=n.canLoad;return r&&0!==r.length?Ge(r.map(o=>{const a=t.get(o);let l;if(function ibe(e){return e&&Ac(e.canLoad)}(a))l=a.canLoad(n,i);else{if(!Ac(a))throw new Error("Invalid CanLoad guard");l=a(n,i)}return ll(l)})).pipe(b_(),Mr(o=>{if(!Sd(o))return;const a=qM(`Redirecting to "${this.urlSerializer.serialize(o)}"`);throw a.url=o,a}),lt(o=>!0===o)):Ge(!0)}lineralizeSegments(t,n){let i=[],r=n.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return Ge(i);if(r.numberOfChildren>1||!r.children[dt])return lw(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t.redirectTo}'`));r=r.children[dt]}}applyRedirectCommands(t,n,i){return this.applyRedirectCreatreUrlTree(n,this.urlSerializer.parse(n),t,i)}applyRedirectCreatreUrlTree(t,n,i,r){const s=this.createSegmentGroup(t,n.root,i,r);return new Dd(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(t,n){const i={};return Ui(t,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const a=r.substring(1);i[s]=n[a]}else i[s]=r}),i}createSegmentGroup(t,n,i,r){const s=this.createSegments(t,n.segments,i,r);let o={};return Ui(n.children,(a,l)=>{o[l]=this.createSegmentGroup(t,a,i,r)}),new mt(s,o)}createSegments(t,n,i,r){return n.map(s=>s.path.startsWith(":")?this.findPosParam(t,s,r):this.findOrReturn(s,i))}findPosParam(t,n,i){const r=i[n.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${t}'. Cannot find '${n.path}'.`);return r}findOrReturn(t,n){let i=0;for(const r of n){if(r.path===t.path)return n.splice(i),r;i++}return t}}function oN(e){const t={};for(const i of Object.keys(e.children)){const s=oN(e.children[i]);(s.segments.length>0||s.hasChildren())&&(t[i]=s)}return function vbe(e){if(1===e.numberOfChildren&&e.children[dt]){const t=e.children[dt];return new mt(e.segments.concat(t.segments),t.children)}return e}(new mt(e.segments,t))}class b7{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Cw{constructor(t,n){this.component=t,this.route=n}}function wbe(e,t,n){const i=e._root;return C_(i,t?t._root:null,n,[i.value])}function Ew(e,t,n){const i=function Cbe(e){if(!e)return null;for(let t=e.parent;t;t=t.parent){const n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(i?i.module.injector:n).get(e)}function C_(e,t,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=lg(t);return e.children.forEach(o=>{(function Ebe(e,t,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=e.value,o=t?t.value:null,a=n?n.getContext(e.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function Sbe(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!Cd(e.url,t.url);case"pathParamsOrQueryParamsChange":return!Cd(e.url,t.url)||!al(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ZM(e,t)||!al(e.queryParams,t.queryParams);default:return!ZM(e,t)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new b7(i)):(s.data=o.data,s._resolvedData=o._resolvedData),C_(e,t,s.component?a?a.children:null:n,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Cw(a.outlet.component,o))}else o&&E_(t,a,r),r.canActivateChecks.push(new b7(i)),C_(e,null,s.component?a?a.children:null:n,i,r)})(o,s[o.value.outlet],n,i.concat([o.value]),r),delete s[o.value.outlet]}),Ui(s,(o,a)=>E_(o,n.getContext(a),r)),r}function E_(e,t,n){const i=lg(e),r=e.value;Ui(i,(s,o)=>{E_(s,r.component?t?t.children.getContext(o):null:t,n)}),n.canDeactivateChecks.push(new Cw(r.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,r))}class Rbe{}function w7(e){return new rn(t=>t.error(e))}class Pbe{constructor(t,n,i,r,s,o){this.rootComponentType=t,this.config=n,this.urlTree=i,this.url=r,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=o}recognize(){const t=bw(this.urlTree.root,[],[],this.config.filter(o=>void 0===o.redirectTo),this.relativeLinkResolution).segmentGroup,n=this.processSegmentGroup(this.config,t,dt);if(null===n)return null;const i=new mw([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},dt,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Cu(i,n),s=new s7(this.url,r);return this.inheritParamsAndData(s._root),s}inheritParamsAndData(t){const n=t.value,i=r7(n,this.paramsInheritanceStrategy);n.params=Object.freeze(i.params),n.data=Object.freeze(i.data),t.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(t,n,i){return 0===n.segments.length&&n.hasChildren()?this.processChildren(t,n):this.processSegment(t,n,n.segments,i)}processChildren(t,n){const i=[];for(const s of Object.keys(n.children)){const o=n.children[s],a=p7(t,s),l=this.processSegmentGroup(a,o,s);if(null===l)return null;i.push(...l)}const r=D7(i);return function Lbe(e){e.sort((t,n)=>t.value.outlet===dt?-1:n.value.outlet===dt?1:t.value.outlet.localeCompare(n.value.outlet))}(r),r}processSegment(t,n,i,r){for(const s of t){const o=this.processSegmentAgainstRoute(s,n,i,r);if(null!==o)return o}return _7(n,i,r)?[]:null}processSegmentAgainstRoute(t,n,i,r){if(t.redirectTo||!m7(t,n,i,r))return null;let s,o=[],a=[];if("**"===t.path){const h=i.length>0?zU(i).parameters:{};s=new mw(i,h,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,S7(t),wo(t),t.component,t,C7(n),E7(n)+i.length,x7(t))}else{const h=vw(n,t,i);if(!h.matched)return null;o=h.consumedSegments,a=h.remainingSegments,s=new mw(o,h.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,S7(t),wo(t),t.component,t,C7(n),E7(n)+o.length,x7(t))}const l=function jbe(e){return e.children?e.children:e.loadChildren?e._loadedConfig.routes:[]}(t),{segmentGroup:u,slicedSegments:c}=bw(n,o,a,l.filter(h=>void 0===h.redirectTo),this.relativeLinkResolution);if(0===c.length&&u.hasChildren()){const h=this.processChildren(l,u);return null===h?null:[new Cu(s,h)]}if(0===l.length&&0===c.length)return[new Cu(s,[])];const f=wo(t)===r,d=this.processSegment(l,u,c,f?dt:r);return null===d?null:[new Cu(s,d)]}}function Bbe(e){const t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function D7(e){const t=[],n=new Set;for(const i of e){if(!Bbe(i)){t.push(i);continue}const r=t.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),n.add(r)):t.push(i)}for(const i of n){const r=D7(i.children);t.push(new Cu(i.value,r))}return t.filter(i=>!n.has(i))}function C7(e){let t=e;for(;t._sourceSegment;)t=t._sourceSegment;return t}function E7(e){let t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;for(;t._sourceSegment;)t=t._sourceSegment,n+=t._segmentIndexShift?t._segmentIndexShift:0;return n-1}function S7(e){return e.data||{}}function x7(e){return e.resolve||{}}function A7(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}function aN(e){return wu(t=>{const n=e(t);return n?Ai(n).pipe(lt(()=>t)):Ge(t)})}class qbe extends class Wbe{shouldDetach(t){return!1}store(t,n){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,n){return t.routeConfig===n.routeConfig}}{}const lN=new Xe("ROUTES");class T7{constructor(t,n,i,r){this.injector=t,this.compiler=n,this.onLoadStartListener=i,this.onLoadEndListener=r}load(t,n){if(n._loader$)return n._loader$;this.onLoadStartListener&&this.onLoadStartListener(n);const r=this.loadModuleFactory(n.loadChildren).pipe(lt(s=>{this.onLoadEndListener&&this.onLoadEndListener(n);const o=s.create(t);return new iN(UU(o.injector.get(lN,void 0,ze.Self|ze.Optional)).map(sN),o)}),xc(s=>{throw n._loader$=void 0,s}));return n._loader$=new o1e(r,()=>new On).pipe(IU()),n._loader$}loadModuleFactory(t){return ll(t()).pipe(ti(n=>n instanceof zV?Ge(n):Ai(this.compiler.compileModuleAsync(n))))}}class Kbe{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,n){return t}}function Jbe(e){throw e}function Xbe(e,t,n){return t.parse("/")}function O7(e,t){return Ge(null)}const Qbe={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Zbe={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ls=(()=>{class e{constructor(n,i,r,s,o,a,l){this.rootComponentType=n,this.urlSerializer=i,this.rootContexts=r,this.location=s,this.config=l,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new On,this.errorHandler=Jbe,this.malformedUriErrorHandler=Xbe,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:O7,afterPreactivation:O7},this.urlHandlingStrategy=new Kbe,this.routeReuseStrategy=new qbe,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=o.get(_u),this.console=o.get(xH);const f=o.get(hn);this.isNgZoneEnabled=f instanceof hn&&hn.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=function S1e(){return new Dd(new mt([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new T7(o,a,d=>this.triggerEvent(new jU(d)),d=>this.triggerEvent(new BU(d))),this.routerState=i7(this.currentUrlTree,this.rootComponentType),this.transitions=new Oi({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var n;return null===(n=this.location.getState())||void 0===n?void 0:n.\u0275routerPageId}setupNavigations(n){const i=this.events;return n.pipe(ns(r=>0!==r.id),lt(r=>Object.assign(Object.assign({},r),{extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),wu(r=>{let s=!1,o=!1;return Ge(r).pipe(Mr(a=>{this.currentNavigation={id:a.id,initialUrl:a.currentRawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),wu(a=>{const l=this.browserUrlTree.toString(),u=!this.navigated||a.extractedUrl.toString()!==l||l!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||u)&&this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return M7(a.source)&&(this.browserUrlTree=a.extractedUrl),Ge(a).pipe(wu(f=>{const d=this.transitions.getValue();return i.next(new WM(f.id,this.serializeUrl(f.extractedUrl),f.source,f.restoredState)),d!==this.transitions.getValue()?Wo:Promise.resolve(f)}),function bbe(e,t,n,i){return wu(r=>function _be(e,t,n,i,r){return new ybe(e,t,n,i,r).apply()}(e,t,n,r.extractedUrl,i).pipe(lt(s=>Object.assign(Object.assign({},r),{urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Mr(f=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:f.urlAfterRedirects})}),function $be(e,t,n,i,r){return ti(s=>function Fbe(e,t,n,i,r="emptyOnly",s="legacy"){try{const o=new Pbe(e,t,n,i,r,s).recognize();return null===o?w7(new Rbe):Ge(o)}catch(o){return w7(o)}}(e,t,s.urlAfterRedirects,n(s.urlAfterRedirects),i,r).pipe(lt(o=>Object.assign(Object.assign({},s),{targetSnapshot:o}))))}(this.rootComponentType,this.config,f=>this.serializeUrl(f),this.paramsInheritanceStrategy,this.relativeLinkResolution),Mr(f=>{if("eager"===this.urlUpdateStrategy){if(!f.extras.skipLocationChange){const h=this.urlHandlingStrategy.merge(f.urlAfterRedirects,f.rawUrl);this.setBrowserUrl(h,f)}this.browserUrlTree=f.urlAfterRedirects}const d=new d1e(f.id,this.serializeUrl(f.extractedUrl),this.serializeUrl(f.urlAfterRedirects),f.targetSnapshot);i.next(d)}));if(u&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:d,extractedUrl:h,source:p,restoredState:g,extras:m}=a,_=new WM(d,this.serializeUrl(h),p,g);i.next(_);const y=i7(h,this.rootComponentType).snapshot;return Ge(Object.assign(Object.assign({},a),{targetSnapshot:y,urlAfterRedirects:h,extras:Object.assign(Object.assign({},m),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=a.rawUrl,a.resolve(null),Wo}),aN(a=>{const{targetSnapshot:l,id:u,extractedUrl:c,rawUrl:f,extras:{skipLocationChange:d,replaceUrl:h}}=a;return this.hooks.beforePreactivation(l,{navigationId:u,appliedUrlTree:c,rawUrlTree:f,skipLocationChange:!!d,replaceUrl:!!h})}),Mr(a=>{const l=new h1e(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.triggerEvent(l)}),lt(a=>Object.assign(Object.assign({},a),{guards:wbe(a.targetSnapshot,a.currentSnapshot,this.rootContexts)})),function xbe(e,t){return ti(n=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return 0===o.length&&0===s.length?Ge(Object.assign(Object.assign({},n),{guardsResult:!0})):function Abe(e,t,n,i){return Ai(e).pipe(ti(r=>function Ibe(e,t,n,i,r){const s=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return s&&0!==s.length?Ge(s.map(a=>{const l=Ew(a,t,r);let u;if(function obe(e){return e&&Ac(e.canDeactivate)}(l))u=ll(l.canDeactivate(e,t,n,i));else{if(!Ac(l))throw new Error("Invalid CanDeactivate guard");u=ll(l(e,t,n,i))}return u.pipe(og())})).pipe(b_()):Ge(!0)}(r.component,r.route,n,t,i)),og(r=>!0!==r,!0))}(o,i,r,e).pipe(ti(a=>a&&function nbe(e){return"boolean"==typeof e}(a)?function Tbe(e,t,n,i){return Ai(t).pipe(sg(r=>h_(function Mbe(e,t){return null!==e&&t&&t(new _1e(e)),Ge(!0)}(r.route.parent,i),function Obe(e,t){return null!==e&&t&&t(new v1e(e)),Ge(!0)}(r.route,i),function kbe(e,t,n){const i=t[t.length-1],s=t.slice(0,t.length-1).reverse().map(o=>function Dbe(e){const t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(o)).filter(o=>null!==o).map(o=>kU(()=>Ge(o.guards.map(l=>{const u=Ew(l,o.node,n);let c;if(function sbe(e){return e&&Ac(e.canActivateChild)}(u))c=ll(u.canActivateChild(i,e));else{if(!Ac(u))throw new Error("Invalid CanActivateChild guard");c=ll(u(i,e))}return c.pipe(og())})).pipe(b_())));return Ge(s).pipe(b_())}(e,r.path,n),function Nbe(e,t,n){const i=t.routeConfig?t.routeConfig.canActivate:null;if(!i||0===i.length)return Ge(!0);const r=i.map(s=>kU(()=>{const o=Ew(s,t,n);let a;if(function rbe(e){return e&&Ac(e.canActivate)}(o))a=ll(o.canActivate(t,e));else{if(!Ac(o))throw new Error("Invalid CanActivate guard");a=ll(o(t,e))}return a.pipe(og())}));return Ge(r).pipe(b_())}(e,r.route,n))),og(r=>!0!==r,!0))}(i,s,e,t):Ge(a)),lt(a=>Object.assign(Object.assign({},n),{guardsResult:a})))})}(this.ngModule.injector,a=>this.triggerEvent(a)),Mr(a=>{if(Sd(a.guardsResult)){const u=qM(`Redirecting to "${this.serializeUrl(a.guardsResult)}"`);throw u.url=a.guardsResult,u}const l=new p1e(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.triggerEvent(l)}),ns(a=>!!a.guardsResult||(this.restoreHistory(a),this.cancelNavigationTransition(a,""),!1)),aN(a=>{if(a.guards.canActivateChecks.length)return Ge(a).pipe(Mr(l=>{const u=new g1e(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(u)}),wu(l=>{let u=!1;return Ge(l).pipe(function Vbe(e,t){return ti(n=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=n;if(!r.length)return Ge(n);let s=0;return Ai(r).pipe(sg(o=>function Hbe(e,t,n,i){return function Ube(e,t,n,i){const r=A7(e);if(0===r.length)return Ge({});const s={};return Ai(r).pipe(ti(o=>function zbe(e,t,n,i){const r=Ew(e,t,i);return ll(r.resolve?r.resolve(t,n):r(t,n))}(e[o],t,n,i).pipe(Mr(a=>{s[o]=a}))),GM(1),ti(()=>A7(s).length===r.length?Ge(s):Wo))}(e._resolve,e,t,i).pipe(lt(s=>(e._resolvedData=s,e.data=Object.assign(Object.assign({},e.data),r7(e,n).resolve),null)))}(o.route,i,e,t)),Mr(()=>s++),GM(1),ti(o=>s===r.length?Ge(n):Wo))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Mr({next:()=>u=!0,complete:()=>{u||(this.restoreHistory(l),this.cancelNavigationTransition(l,"At least one route resolver didn't emit any value."))}}))}),Mr(l=>{const u=new m1e(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(u)}))}),aN(a=>{const{targetSnapshot:l,id:u,extractedUrl:c,rawUrl:f,extras:{skipLocationChange:d,replaceUrl:h}}=a;return this.hooks.afterPreactivation(l,{navigationId:u,appliedUrlTree:c,rawUrlTree:f,skipLocationChange:!!d,replaceUrl:!!h})}),lt(a=>{const l=function U1e(e,t,n){const i=__(e,t._root,n?n._root:void 0);return new n7(i,t)}(this.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return Object.assign(Object.assign({},a),{targetRouterState:l})}),Mr(a=>{this.currentUrlTree=a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a),this.browserUrlTree=a.urlAfterRedirects)}),((e,t,n)=>lt(i=>(new ebe(t,i.targetRouterState,i.currentRouterState,n).activate(e),i)))(this.rootContexts,this.routeReuseStrategy,a=>this.triggerEvent(a)),Mr({next(){s=!0},complete(){s=!0}}),function c1e(e){return Kn((t,n)=>{try{t.subscribe(n)}finally{n.add(e)}})}(()=>{var a;s||o||this.cancelNavigationTransition(r,`Navigation ID ${r.id} is not equal to the current navigation id ${this.navigationId}`),(null===(a=this.currentNavigation)||void 0===a?void 0:a.id)===r.id&&(this.currentNavigation=null)}),xc(a=>{if(o=!0,function D1e(e){return e&&e[VU]}(a)){const l=Sd(a.url);l||(this.navigated=!0,this.restoreHistory(r,!0));const u=new LU(r.id,this.serializeUrl(r.extractedUrl),a.message);i.next(u),l?setTimeout(()=>{const c=this.urlHandlingStrategy.merge(a.url,this.rawUrlTree),f={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||M7(r.source)};this.scheduleNavigation(c,"imperative",null,f,{resolve:r.resolve,reject:r.reject,promise:r.promise})},0):r.resolve(!1)}else{this.restoreHistory(r,!0);const l=new f1e(r.id,this.serializeUrl(r.extractedUrl),a);i.next(l);try{r.resolve(this.errorHandler(a))}catch(u){r.reject(u)}}return Wo}))}))}resetRootComponentType(n){this.rootComponentType=n,this.routerState.root.component=this.rootComponentType}setTransition(n){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),n))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const i="popstate"===n.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{var r;const s={replaceUrl:!0},o=(null===(r=n.state)||void 0===r?void 0:r.navigationId)?n.state:null;if(o){const l=Object.assign({},o);delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(n.url);this.scheduleNavigation(a,i,o,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(n){this.events.next(n)}resetConfig(n){h7(n),this.config=n.map(sN),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(n,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,u=r||this.routerState.root,c=l?this.currentUrlTree.fragment:o;let f=null;switch(a){case"merge":f=Object.assign(Object.assign({},this.currentUrlTree.queryParams),s);break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=s||null}return null!==f&&(f=this.removeEmptyProps(f)),function W1e(e,t,n,i,r){if(0===n.length)return eN(t.root,t.root,t.root,i,r);const s=function q1e(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new l7(!0,0,e);let t=0,n=!1;const i=e.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Ui(s.outlets,(l,u)=>{a[u]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?n=!0:".."===a?t++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new l7(n,t,i)}(n);if(s.toRoot())return eN(t.root,t.root,new mt([],{}),i,r);const o=function Y1e(e,t,n){if(e.isAbsolute)return new tN(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){const s=n.snapshot._urlSegment;return new tN(s,s===t.root,0)}const i=_w(e.commands[0])?0:1;return function K1e(e,t,n){let i=e,r=t,s=n;for(;s>r;){if(s-=r,i=i.parent,!i)throw new Error("Invalid number of '../'");r=i.segments.length}return new tN(i,!1,r-s)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,e.numberOfDoubleDots)}(s,t,e),a=o.processChildren?yw(o.segmentGroup,o.index,s.commands):u7(o.segmentGroup,o.index,s.commands);return eN(t.root,o.segmentGroup,a,i,r)}(u,this.currentUrlTree,n,f,null!=c?c:null)}navigateByUrl(n,i={skipLocationChange:!1}){const r=Sd(n)?n:this.parseUrl(n),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,i)}navigate(n,i={skipLocationChange:!1}){return function ewe(e){for(let t=0;t<e.length;t++){const n=e[t];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${t}`)}}(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let i;try{i=this.urlSerializer.parse(n)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,n)}return i}isActive(n,i){let r;if(r=!0===i?Object.assign({},Qbe):!1===i?Object.assign({},Zbe):i,Sd(n))return WU(this.currentUrlTree,n,r);const s=this.parseUrl(n);return WU(this.currentUrlTree,s,r)}removeEmptyProps(n){return Object.keys(n).reduce((i,r)=>{const s=n[r];return null!=s&&(i[r]=s),i},{})}processNavigations(){this.navigations.subscribe(n=>{this.navigated=!0,this.lastSuccessfulId=n.id,this.currentPageId=n.targetPageId,this.events.next(new p_(n.id,this.serializeUrl(n.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,n.resolve(!0)},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)})}scheduleNavigation(n,i,r,s,o){var a,l;if(this.disposed)return Promise.resolve(!1);let u,c,f;o?(u=o.resolve,c=o.reject,f=o.promise):f=new Promise((p,g)=>{u=p,c=g});const d=++this.navigationId;let h;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),h=r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?null!==(a=this.browserPageId)&&void 0!==a?a:0:(null!==(l=this.browserPageId)&&void 0!==l?l:0)+1):h=0,this.setTransition({id:d,targetPageId:h,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:n,extras:s,resolve:u,reject:c,promise:f,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),f.catch(p=>Promise.reject(p))}setBrowserUrl(n,i){const r=this.urlSerializer.serialize(n),s=Object.assign(Object.assign({},i.extras.state),this.generateNgRouterState(i.id,i.targetPageId));this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(n,i=!1){var r,s;if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-n.targetPageId;"popstate"!==n.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(r=this.currentNavigation)||void 0===r?void 0:r.finalUrl)||0===o?this.currentUrlTree===(null===(s=this.currentNavigation)||void 0===s?void 0:s.finalUrl)&&0===o&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(o)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(n,i){const r=new LU(n.id,this.serializeUrl(n.extractedUrl),i);this.triggerEvent(r),n.resolve(!1)}generateNgRouterState(n,i){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}}return e.\u0275fac=function(n){xO()},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})();function M7(e){return"imperative"!==e}let Sw=(()=>{class e{constructor(n,i,r){this.router=n,this.route=i,this.locationStrategy=r,this.commands=null,this.href=null,this.onChanges=new On,this.subscription=n.events.subscribe(s=>{s instanceof p_&&this.updateTargetUrlAndHref()})}set routerLink(n){this.commands=null!=n?Array.isArray(n)?n:[n]:null}ngOnChanges(n){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(n,i,r,s,o){if(0!==n||i||r||s||o||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const a={skipLocationChange:ug(this.skipLocationChange),replaceUrl:ug(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,a),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:ug(this.preserveFragment)})}}return e.\u0275fac=function(n){return new(n||e)(H(Ls),H(Ed),H(ig))},e.\u0275dir=me({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(n,i){1&n&&Be("click",function(s){return i.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&n&&an("target",i.target)("href",i.href,_b)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[ni]}),e})();function ug(e){return""===e||!!e}class N7{}class k7{preload(t,n){return Ge(null)}}let I7=(()=>{class e{constructor(n,i,r,s){this.router=n,this.injector=r,this.preloadingStrategy=s,this.loader=new T7(r,i,l=>n.triggerEvent(new jU(l)),l=>n.triggerEvent(new BU(l)))}setUpPreloading(){this.subscription=this.router.events.pipe(ns(n=>n instanceof p_),sg(()=>this.preload())).subscribe(()=>{})}preload(){const n=this.injector.get(_u);return this.processRoutes(n,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,i){const r=[];for(const s of i)if(s.loadChildren&&!s.canLoad&&s._loadedConfig){const o=s._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else s.loadChildren&&!s.canLoad?r.push(this.preloadConfig(n,s)):s.children&&r.push(this.processRoutes(n,s.children));return Ai(r).pipe(m0(),lt(s=>{}))}preloadConfig(n,i){return this.preloadingStrategy.preload(i,()=>(i._loadedConfig?Ge(i._loadedConfig):this.loader.load(n.injector,i)).pipe(ti(s=>(i._loadedConfig=s,this.processRoutes(s.module,s.routes)))))}}return e.\u0275fac=function(n){return new(n||e)(ge(Ls),ge(AH),ge(gi),ge(N7))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})(),cN=(()=>{class e{constructor(n,i,r={}){this.router=n,this.viewportScroller=i,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(n=>{n instanceof WM?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof p_&&(this.lastId=n.id,this.scheduleScrollEvent(n,this.router.parseUrl(n.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(n=>{n instanceof $U&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,i){this.router.triggerEvent(new $U(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return e.\u0275fac=function(n){xO()},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})();const xd=new Xe("ROUTER_CONFIGURATION"),R7=new Xe("ROUTER_FORROOT_GUARD"),rwe=[CM,{provide:JU,useClass:XU},{provide:Ls,useFactory:function uwe(e,t,n,i,r,s,o={},a,l){const u=new Ls(null,e,t,n,i,r,UU(s));return a&&(u.urlHandlingStrategy=a),l&&(u.routeReuseStrategy=l),function cwe(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy),e.canceledNavigationResolution&&(t.canceledNavigationResolution=e.canceledNavigationResolution)}(o,u),o.enableTracing&&u.events.subscribe(c=>{var f,d;null===(f=console.group)||void 0===f||f.call(console,`Router Event: ${c.constructor.name}`),console.log(c.toString()),console.log(c),null===(d=console.groupEnd)||void 0===d||d.call(console)}),u},deps:[JU,w_,CM,gi,AH,lN,xd,[class Ybe{},new _c],[class Gbe{},new _c]]},w_,{provide:Ed,useFactory:function fwe(e){return e.routerState.root},deps:[Ls]},I7,k7,class iwe{preload(t,n){return n().pipe(xc(()=>Ge(null)))}},{provide:xd,useValue:{enableTracing:!1}}];function swe(){return new kH("Router",Ls)}let F7=(()=>{class e{constructor(n,i){}static forRoot(n,i){return{ngModule:e,providers:[rwe,P7(n),{provide:R7,useFactory:lwe,deps:[[Ls,new _c,new I0]]},{provide:xd,useValue:i||{}},{provide:ig,useFactory:awe,deps:[bd,[new fb(DM),new _c],xd]},{provide:cN,useFactory:owe,deps:[Ls,pve,xd]},{provide:N7,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:k7},{provide:kH,multi:!0,useFactory:swe},[fN,{provide:lM,multi:!0,useFactory:dwe,deps:[fN]},{provide:L7,useFactory:hwe,deps:[fN]},{provide:SH,multi:!0,useExisting:L7}]]}}static forChild(n){return{ngModule:e,providers:[P7(n)]}}}return e.\u0275fac=function(n){return new(n||e)(ge(R7,8),ge(Ls,8))},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({}),e})();function owe(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new cN(e,t,n)}function awe(e,t,n={}){return n.useHash?new X_e(e,t):new QH(e,t)}function lwe(e){return"guarded"}function P7(e){return[{provide:Gfe,multi:!0,useValue:e},{provide:lN,multi:!0,useValue:e}]}let fN=(()=>{class e{constructor(n){this.injector=n,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new On}appInitializer(){return this.injector.get(Y_e,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let i=null;const r=new Promise(a=>i=a),s=this.injector.get(Ls),o=this.injector.get(xd);return"disabled"===o.initialNavigation?(s.setUpLocationChangeListener(),i(!0)):"enabled"===o.initialNavigation||"enabledBlocking"===o.initialNavigation?(s.hooks.afterPreactivation=()=>this.initNavigation?Ge(null):(this.initNavigation=!0,i(!0),this.resultOfPreactivationDone),s.initialNavigation()):i(!0),r})}bootstrapListener(n){const i=this.injector.get(xd),r=this.injector.get(I7),s=this.injector.get(cN),o=this.injector.get(Ls),a=this.injector.get(Ub);n===a.components[0]&&(("enabledNonBlocking"===i.initialNavigation||void 0===i.initialNavigation)&&o.initialNavigation(),r.setUpPreloading(),s.init(),o.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return e.\u0275fac=function(n){return new(n||e)(ge(gi))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})();function dwe(e){return e.appInitializer.bind(e)}function hwe(e){return e.bootstrapListener.bind(e)}const L7=new Xe("Router Initializer");let dN=(()=>{class e{constructor(){this.sector=new On,this.sector.next("all-sectors")}getSector(){return this.sector}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})(),gwe=(()=>{class e{constructor(){}ngOnInit(){}ngOnChanges(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Mn({type:e,selectors:[["introductory-section"]],inputs:{sector:"sector"},features:[ni],decls:10,vars:0,consts:[[1,"section","mt-5"],[1,"title"],[1,"subtitle","mt-4"],[1,"mt-4","mb-5"],[1,"button","orange-button"],[1,"button","transparent-button","mt-md-0","mt-3"]],template:function(n,i){1&n&&(B(0,"div",0)(1,"h1",1),Y(2,"Beyond Compliance"),$(),B(3,"div",2),Y(4," A review of statements produced by companies under the UK and AUS Modern Slavery Acts. "),$(),B(5,"div",3)(6,"a",4),Y(7,"Contribute Research"),$(),B(8,"a",5),Y(9,"Download Dataset"),$()()())},styles:[""]}),e})();class st{constructor(t,n){this.name=t,this.value=n}}class j7{}class B7{}class Eu{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(n=>{const i=n.indexOf(":");if(i>0){const r=n.slice(0,i),s=r.toLowerCase(),o=n.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(n=>{let i=t[n];const r=n.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(r,i),this.maybeSetNormalizedName(n,r))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const n=this.headers.get(t.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,n){return this.clone({name:t,value:n,op:"a"})}set(t,n){return this.clone({name:t,value:n,op:"s"})}delete(t,n){return this.clone({name:t,value:n,op:"d"})}maybeSetNormalizedName(t,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,t)}init(){this.lazyInit&&(this.lazyInit instanceof Eu?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(n=>{this.headers.set(n,t.headers.get(n)),this.normalizedNames.set(n,t.normalizedNames.get(n))})}clone(t){const n=new Eu;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof Eu?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}applyUpdate(t){const n=t.name.toLowerCase();switch(t.op){case"a":case"s":let i=t.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(t.name,n);const r=("a"===t.op?this.headers.get(n):void 0)||[];r.push(...i),this.headers.set(n,r);break;case"d":const s=t.value;if(s){let o=this.headers.get(n);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,o)}else this.headers.delete(n),this.normalizedNames.delete(n)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>t(this.normalizedNames.get(n),this.headers.get(n)))}}class mwe{encodeKey(t){return $7(t)}encodeValue(t){return $7(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const ywe=/%(\d[a-f0-9])/gi,vwe={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function $7(e){return encodeURIComponent(e).replace(ywe,(t,n)=>{var i;return null!==(i=vwe[n])&&void 0!==i?i:t})}function V7(e){return`${e}`}class Su{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new mwe,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function _we(e,t){const n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[t.decodeKey(r),""]:[t.decodeKey(r.slice(0,s)),t.decodeValue(r.slice(s+1))],l=n.get(o)||[];l.push(a),n.set(o,l)}),n}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(n=>{const i=t.fromObject[n];this.map.set(n,Array.isArray(i)?i:[i])})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const n=this.map.get(t);return n?n[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,n){return this.clone({param:t,value:n,op:"a"})}appendAll(t){const n=[];return Object.keys(t).forEach(i=>{const r=t[i];Array.isArray(r)?r.forEach(s=>{n.push({param:i,value:s,op:"a"})}):n.push({param:i,value:r,op:"a"})}),this.clone(n)}set(t,n){return this.clone({param:t,value:n,op:"s"})}delete(t,n){return this.clone({param:t,value:n,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const n=this.encoder.encodeKey(t);return this.map.get(t).map(i=>n+"="+this.encoder.encodeValue(i)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const n=new Su({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(t),n}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const n=("a"===t.op?this.map.get(t.param):void 0)||[];n.push(V7(t.value)),this.map.set(t.param,n);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let i=this.map.get(t.param)||[];const r=i.indexOf(V7(t.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(t.param,i):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class bwe{constructor(){this.map=new Map}set(t,n){return this.map.set(t,n),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function H7(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function U7(e){return"undefined"!=typeof Blob&&e instanceof Blob}function z7(e){return"undefined"!=typeof FormData&&e instanceof FormData}class S_{constructor(t,n,i,r){let s;if(this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function wwe(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new Eu),this.context||(this.context=new bwe),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=n;else{const a=n.indexOf("?");this.urlWithParams=n+(-1===a?"?":a<n.length-1?"&":"")+o}}else this.params=new Su,this.urlWithParams=n}serializeBody(){return null===this.body?null:H7(this.body)||U7(this.body)||z7(this.body)||function Dwe(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Su?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||z7(this.body)?null:U7(this.body)?this.body.type||null:H7(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Su?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){var n;const i=t.method||this.method,r=t.url||this.url,s=t.responseType||this.responseType,o=void 0!==t.body?t.body:this.body,a=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,l=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let u=t.headers||this.headers,c=t.params||this.params;const f=null!==(n=t.context)&&void 0!==n?n:this.context;return void 0!==t.setHeaders&&(u=Object.keys(t.setHeaders).reduce((d,h)=>d.set(h,t.setHeaders[h]),u)),t.setParams&&(c=Object.keys(t.setParams).reduce((d,h)=>d.set(h,t.setParams[h]),c)),new S_(i,r,o,{params:c,headers:u,context:f,reportProgress:l,responseType:s,withCredentials:a})}}var li=(()=>((li=li||{})[li.Sent=0]="Sent",li[li.UploadProgress=1]="UploadProgress",li[li.ResponseHeader=2]="ResponseHeader",li[li.DownloadProgress=3]="DownloadProgress",li[li.Response=4]="Response",li[li.User=5]="User",li))();class hN{constructor(t,n=200,i="OK"){this.headers=t.headers||new Eu,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||i,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class pN extends hN{constructor(t={}){super(t),this.type=li.ResponseHeader}clone(t={}){return new pN({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class xw extends hN{constructor(t={}){super(t),this.type=li.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new xw({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class G7 extends hN{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function gN(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let W7=(()=>{class e{constructor(n){this.handler=n}request(n,i,r={}){let s;if(n instanceof S_)s=n;else{let l,u;l=r.headers instanceof Eu?r.headers:new Eu(r.headers),r.params&&(u=r.params instanceof Su?r.params:new Su({fromObject:r.params})),s=new S_(n,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:u,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=Ge(s).pipe(sg(l=>this.handler.handle(l)));if(n instanceof S_||"events"===r.observe)return o;const a=o.pipe(ns(l=>l instanceof xw));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(lt(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(lt(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(lt(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(lt(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(n,i={}){return this.request("DELETE",n,i)}get(n,i={}){return this.request("GET",n,i)}head(n,i={}){return this.request("HEAD",n,i)}jsonp(n,i){return this.request("JSONP",n,{params:(new Su).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,i={}){return this.request("OPTIONS",n,i)}patch(n,i,r={}){return this.request("PATCH",n,gN(r,i))}post(n,i,r={}){return this.request("POST",n,gN(r,i))}put(n,i,r={}){return this.request("PUT",n,gN(r,i))}}return e.\u0275fac=function(n){return new(n||e)(ge(j7))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})();class q7{constructor(t,n){this.next=t,this.interceptor=n}handle(t){return this.interceptor.intercept(t,this.next)}}const Y7=new Xe("HTTP_INTERCEPTORS");let Cwe=(()=>{class e{intercept(n,i){return i.handle(n)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})();const Ewe=/^\)\]\}',?\n/;let K7=(()=>{class e{constructor(n){this.xhrFactory=n}handle(n){if("JSONP"===n.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new rn(i=>{const r=this.xhrFactory.build();if(r.open(n.method,n.urlWithParams),n.withCredentials&&(r.withCredentials=!0),n.headers.forEach((h,p)=>r.setRequestHeader(h,p.join(","))),n.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){const h=n.detectContentTypeHeader();null!==h&&r.setRequestHeader("Content-Type",h)}if(n.responseType){const h=n.responseType.toLowerCase();r.responseType="json"!==h?h:"text"}const s=n.serializeBody();let o=null;const a=()=>{if(null!==o)return o;const h=r.statusText||"OK",p=new Eu(r.getAllResponseHeaders()),g=function Swe(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(r)||n.url;return o=new pN({headers:p,status:r.status,statusText:h,url:g}),o},l=()=>{let{headers:h,status:p,statusText:g,url:m}=a(),_=null;204!==p&&(_=void 0===r.response?r.responseText:r.response),0===p&&(p=_?200:0);let y=p>=200&&p<300;if("json"===n.responseType&&"string"==typeof _){const v=_;_=_.replace(Ewe,"");try{_=""!==_?JSON.parse(_):null}catch(b){_=v,y&&(y=!1,_={error:b,text:_})}}y?(i.next(new xw({body:_,headers:h,status:p,statusText:g,url:m||void 0})),i.complete()):i.error(new G7({error:_,headers:h,status:p,statusText:g,url:m||void 0}))},u=h=>{const{url:p}=a(),g=new G7({error:h,status:r.status||0,statusText:r.statusText||"Unknown Error",url:p||void 0});i.error(g)};let c=!1;const f=h=>{c||(i.next(a()),c=!0);let p={type:li.DownloadProgress,loaded:h.loaded};h.lengthComputable&&(p.total=h.total),"text"===n.responseType&&!!r.responseText&&(p.partialText=r.responseText),i.next(p)},d=h=>{let p={type:li.UploadProgress,loaded:h.loaded};h.lengthComputable&&(p.total=h.total),i.next(p)};return r.addEventListener("load",l),r.addEventListener("error",u),r.addEventListener("timeout",u),r.addEventListener("abort",u),n.reportProgress&&(r.addEventListener("progress",f),null!==s&&r.upload&&r.upload.addEventListener("progress",d)),r.send(s),i.next({type:li.Sent}),()=>{r.removeEventListener("error",u),r.removeEventListener("abort",u),r.removeEventListener("load",l),r.removeEventListener("timeout",u),n.reportProgress&&(r.removeEventListener("progress",f),null!==s&&r.upload&&r.upload.removeEventListener("progress",d)),r.readyState!==r.DONE&&r.abort()}})}}return e.\u0275fac=function(n){return new(n||e)(ge(gU))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})();const mN=new Xe("XSRF_COOKIE_NAME"),_N=new Xe("XSRF_HEADER_NAME");class J7{}let xwe=(()=>{class e{constructor(n,i,r){this.doc=n,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=lU(n,this.cookieName),this.lastCookieString=n),this.lastToken}}return e.\u0275fac=function(n){return new(n||e)(ge(si),ge(o_),ge(mN))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})(),yN=(()=>{class e{constructor(n,i){this.tokenService=n,this.headerName=i}intercept(n,i){const r=n.url.toLowerCase();if("GET"===n.method||"HEAD"===n.method||r.startsWith("http://")||r.startsWith("https://"))return i.handle(n);const s=this.tokenService.getToken();return null!==s&&!n.headers.has(this.headerName)&&(n=n.clone({headers:n.headers.set(this.headerName,s)})),i.handle(n)}}return e.\u0275fac=function(n){return new(n||e)(ge(J7),ge(_N))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})(),Awe=(()=>{class e{constructor(n,i){this.backend=n,this.injector=i,this.chain=null}handle(n){if(null===this.chain){const i=this.injector.get(Y7,[]);this.chain=i.reduceRight((r,s)=>new q7(r,s),this.backend)}return this.chain.handle(n)}}return e.\u0275fac=function(n){return new(n||e)(ge(B7),ge(gi))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})(),Twe=(()=>{class e{static disable(){return{ngModule:e,providers:[{provide:yN,useClass:Cwe}]}}static withOptions(n={}){return{ngModule:e,providers:[n.cookieName?{provide:mN,useValue:n.cookieName}:[],n.headerName?{provide:_N,useValue:n.headerName}:[]]}}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({providers:[yN,{provide:Y7,useExisting:yN,multi:!0},{provide:J7,useClass:xwe},{provide:mN,useValue:"XSRF-TOKEN"},{provide:_N,useValue:"X-XSRF-TOKEN"}]}),e})(),Owe=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({providers:[W7,{provide:j7,useClass:Awe},K7,{provide:B7,useExisting:K7}],imports:[[Twe.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e})(),Tc=(()=>{class e{constructor(n){this.httpClient=n,this.wikirateApiHost="https://wikirate.org",this.metrics={msa_registry_submission:12536930,aus_msa_statement_assessed:12602630,uk_msa_statement_assessed:12602618,meet_uk_min_requirements:6901749,meet_aus_min_requirements:12601871}}getAnswers(n,i){let r=`${this.wikirateApiHost}/~${n}+Answer.json`,s=new Su;for(let o of i)if(Array.isArray(o.value))for(let a of o.value)s=s.append("filter["+o.name+"][]",a);else s=s.append("filter["+o.name+"]",o.value);return s=s.append("limit",0),s=s.append("view","answer_list"),this.httpClient.get(r,{params:s})}}return e.\u0275fac=function(n){return new(n||e)(ge(W7))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})(),X7=(()=>{class e{constructor(n,i){this._renderer=n,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(n,i){this._renderer.setProperty(this._elementRef.nativeElement,n,i)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}}return e.\u0275fac=function(n){return new(n||e)(H(_o),H(dn))},e.\u0275dir=me({type:e}),e})(),Ad=(()=>{class e extends X7{}return e.\u0275fac=function(){let t;return function(i){return(t||(t=nr(e)))(i||e)}}(),e.\u0275dir=me({type:e,features:[Bt]}),e})();const Do=new Xe("NgValueAccessor"),kwe={provide:Do,useExisting:xt(()=>vN),multi:!0},Rwe=new Xe("CompositionEventMode");let vN=(()=>{class e extends X7{constructor(n,i,r){super(n,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Iwe(){const e=ol()?ol().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(n){this.setProperty("value",null==n?"":n)}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}}return e.\u0275fac=function(n){return new(n||e)(H(_o),H(dn),H(Rwe,8))},e.\u0275dir=me({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,i){1&n&&Be("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[ln([kwe]),Bt]}),e})();const sr=new Xe("NgValidators"),Mc=new Xe("NgAsyncValidators");function l9(e){return null!=e}function u9(e){const t=q0(e)?Ai(e):e;return MO(t),t}function c9(e){let t={};return e.forEach(n=>{t=null!=n?Object.assign(Object.assign({},t),n):t}),0===Object.keys(t).length?null:t}function f9(e,t){return t.map(n=>n(e))}function d9(e){return e.map(t=>function Pwe(e){return!e.validate}(t)?t:n=>t.validate(n))}function bN(e){return null!=e?function h9(e){if(!e)return null;const t=e.filter(l9);return 0==t.length?null:function(n){return c9(f9(n,t))}}(d9(e)):null}function wN(e){return null!=e?function p9(e){if(!e)return null;const t=e.filter(l9);return 0==t.length?null:function(n){return function Mwe(...e){const t=B1(e),{args:n,keys:i}=OU(e),r=new rn(s=>{const{length:o}=n;if(!o)return void s.complete();const a=new Array(o);let l=o,u=o;for(let c=0;c<o;c++){let f=!1;Zi(n[c]).subscribe(_n(s,d=>{f||(f=!0,u--),a[c]=d},()=>l--,void 0,()=>{(!l||!f)&&(u||s.next(i?MU(i,a):a),s.complete())}))}});return t?r.pipe(UM(t)):r}(f9(n,t).map(u9)).pipe(lt(c9))}}(d9(e)):null}function g9(e,t){return null===e?[t]:Array.isArray(e)?[...e,t]:[e,t]}function DN(e){return e?Array.isArray(e)?e:[e]:[]}function Tw(e,t){return Array.isArray(e)?e.includes(t):e===t}function y9(e,t){const n=DN(t);return DN(e).forEach(r=>{Tw(n,r)||n.push(r)}),n}function v9(e,t){return DN(t).filter(n=>!Tw(e,n))}class b9{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=bN(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=wN(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,n){return!!this.control&&this.control.hasError(t,n)}getError(t,n){return this.control?this.control.getError(t,n):null}}class Nc extends b9{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Nr extends b9{get formDirective(){return null}get path(){return null}}let cg=(()=>{class e extends class w9{constructor(t){this._cd=t}is(t){var n,i,r;return"submitted"===t?!!(null===(n=this._cd)||void 0===n?void 0:n.submitted):!!(null===(r=null===(i=this._cd)||void 0===i?void 0:i.control)||void 0===r?void 0:r[t])}}{constructor(n){super(n)}}return e.\u0275fac=function(n){return new(n||e)(H(Nc,2))},e.\u0275dir=me({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,i){2&n&&Nn("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))},features:[Bt]}),e})();function x_(e,t){(function SN(e,t){const n=function m9(e){return e._rawValidators}(e);null!==t.validator?e.setValidators(g9(n,t.validator)):"function"==typeof n&&e.setValidators([n]);const i=function _9(e){return e._rawAsyncValidators}(e);null!==t.asyncValidator?e.setAsyncValidators(g9(i,t.asyncValidator)):"function"==typeof i&&e.setAsyncValidators([i]);const r=()=>e.updateValueAndValidity();kw(t._rawValidators,r),kw(t._rawAsyncValidators,r)})(e,t),t.valueAccessor.writeValue(e.value),function Gwe(e,t){t.valueAccessor.registerOnChange(n=>{e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&C9(e,t)})}(e,t),function qwe(e,t){const n=(i,r)=>{t.valueAccessor.writeValue(i),r&&t.viewToModelUpdate(i)};e.registerOnChange(n),t._registerOnDestroy(()=>{e._unregisterOnChange(n)})}(e,t),function Wwe(e,t){t.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&C9(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function zwe(e,t){if(t.valueAccessor.setDisabledState){const n=i=>{t.valueAccessor.setDisabledState(i)};e.registerOnDisabledChange(n),t._registerOnDestroy(()=>{e._unregisterOnDisabledChange(n)})}}(e,t)}function kw(e,t){e.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(t)})}function C9(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function TN(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const A_="VALID",Rw="INVALID",fg="PENDING",T_="DISABLED";function MN(e){return(Fw(e)?e.validators:e)||null}function A9(e){return Array.isArray(e)?bN(e):e||null}function NN(e,t){return(Fw(t)?t.asyncValidators:e)||null}function T9(e){return Array.isArray(e)?wN(e):e||null}function Fw(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}const kN=e=>e instanceof RN;function M9(e){return(e=>e instanceof I9)(e)?e.value:e.getRawValue()}function N9(e,t){const n=kN(e),i=e.controls;if(!(n?Object.keys(i):i).length)throw new Ee(1e3,"");if(!i[t])throw new Ee(1001,"")}function k9(e,t){kN(e),e._forEachChild((i,r)=>{if(void 0===t[r])throw new Ee(1002,"")})}class IN{constructor(t,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=n,this._composedValidatorFn=A9(this._rawValidators),this._composedAsyncValidatorFn=T9(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===A_}get invalid(){return this.status===Rw}get pending(){return this.status==fg}get disabled(){return this.status===T_}get enabled(){return this.status!==T_}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=A9(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=T9(t)}addValidators(t){this.setValidators(y9(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(y9(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(v9(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(v9(t,this._rawAsyncValidators))}hasValidator(t){return Tw(this._rawValidators,t)}hasAsyncValidator(t){return Tw(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=fg,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const n=this._parentMarkedDirty(t.onlySelf);this.status=T_,this.errors=null,this._forEachChild(i=>{i.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:n})),this._onDisabledChange.forEach(i=>i(!0))}enable(t={}){const n=this._parentMarkedDirty(t.onlySelf);this.status=A_,this._forEachChild(i=>{i.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:n})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===A_||this.status===fg)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?T_:A_}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=fg,this._hasOwnPendingAsyncValidator=!0;const n=u9(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,n={}){this.errors=t,this._updateControlsErrors(!1!==n.emitEvent)}get(t){return function Xwe(e,t,n){if(null==t||(Array.isArray(t)||(t=t.split(n)),Array.isArray(t)&&0===t.length))return null;let i=e;return t.forEach(r=>{i=kN(i)?i.controls.hasOwnProperty(r)?i.controls[r]:null:(e=>e instanceof Zwe)(i)&&i.at(r)||null}),i}(this,t,".")}getError(t,n){const i=n?this.get(n):this;return i&&i.errors?i.errors[t]:null}hasError(t,n){return!!this.getError(t,n)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new it,this.statusChanges=new it}_calculateStatus(){return this._allControlsDisabled()?T_:this.errors?Rw:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(fg)?fg:this._anyControlsHaveStatus(Rw)?Rw:A_}_anyControlsHaveStatus(t){return this._anyControls(n=>n.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Fw(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class I9 extends IN{constructor(t=null,n,i){super(MN(n),NN(i,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Fw(n)&&n.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(t)?t.value:t)}setValue(t,n={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==n.emitViewToModelChange)),this.updateValueAndValidity(n)}patchValue(t,n={}){this.setValue(t,n)}reset(t=this.defaultValue,n={}){this._applyFormState(t),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){TN(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){TN(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class RN extends IN{constructor(t,n,i){super(MN(n),NN(i,n)),this.controls=t,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,n){return this.controls[t]?this.controls[t]:(this.controls[t]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(t,n,i={}){this.registerControl(t,n),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(t,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(t,n,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],n&&this.registerControl(t,n),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,n={}){k9(this,t),Object.keys(t).forEach(i=>{N9(this,i),this.controls[i].setValue(t[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(t,n={}){null!=t&&(Object.keys(t).forEach(i=>{this.controls[i]&&this.controls[i].patchValue(t[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(t={},n={}){this._forEachChild((i,r)=>{i.reset(t[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(t,n,i)=>(t[i]=M9(n),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(n,i)=>!!i._syncPendingControls()||n);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(n=>{const i=this.controls[n];i&&t(i,n)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const n of Object.keys(this.controls)){const i=this.controls[n];if(this.contains(n)&&t(i))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,n,i)=>((n.enabled||this.disabled)&&(t[i]=n.value),t))}_reduceChildren(t,n){let i=t;return this._forEachChild((r,s)=>{i=n(i,r,s)}),i}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class Zwe extends IN{constructor(t,n,i){super(MN(n),NN(i,n)),this.controls=t,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[t]}push(t,n={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}insert(t,n,i={}){this.controls.splice(t,0,n),this._registerControl(n),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(t,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity({emitEvent:n.emitEvent})}setControl(t,n,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),n&&(this.controls.splice(t,0,n),this._registerControl(n)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,n={}){k9(this,t),t.forEach((i,r)=>{N9(this,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(t,n={}){null!=t&&(t.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(t=[],n={}){this._forEachChild((i,r)=>{i.reset(t[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this.controls.map(t=>M9(t))}clear(t={}){this.controls.length<1||(this._forEachChild(n=>n._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_syncPendingControls(){let t=this.controls.reduce((n,i)=>!!i._syncPendingControls()||n,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((n,i)=>{t(n,i)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(n=>n.enabled&&t(n))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const nDe={provide:Nc,useExisting:xt(()=>Td)},P9=(()=>Promise.resolve(null))();let Td=(()=>{class e extends Nc{constructor(n,i,r,s,o){super(),this._changeDetectorRef=o,this.control=new I9,this._registered=!1,this.update=new it,this._parent=n,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function AN(e,t){if(!t)return null;let n,i,r;return Array.isArray(t),t.forEach(s=>{s.constructor===vN?n=s:function Jwe(e){return Object.getPrototypeOf(e.constructor)===Ad}(s)?i=s:r=s}),r||i||n||null}(0,s)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){const i=n.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),function xN(e,t){if(!e.hasOwnProperty("model"))return!1;const n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){x_(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(n){P9.then(()=>{var i;this.control.setValue(n,{emitViewToModelChange:!1}),null===(i=this._changeDetectorRef)||void 0===i||i.markForCheck()})}_updateDisabled(n){const i=n.isDisabled.currentValue,r=""===i||i&&"false"!==i;P9.then(()=>{var s;r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),null===(s=this._changeDetectorRef)||void 0===s||s.markForCheck()})}_getPath(n){return this._parent?function Mw(e,t){return[...t.path,e]}(n,this._parent):[n]}}return e.\u0275fac=function(n){return new(n||e)(H(Nr,9),H(sr,10),H(Mc,10),H(Do,10),H(oa,8))},e.\u0275dir=me({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[ln([nDe]),Bt,ni]}),e})(),j9=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({}),e})();const hDe={provide:Do,useExisting:xt(()=>kc),multi:!0};function G9(e,t){return null==e?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let kc=(()=>{class e extends Ad{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){this.value=n;const r=G9(this._getOptionId(n),n);this.setProperty("value",r)}registerOnChange(n){this.onChange=i=>{this.value=this._getOptionValue(i),n(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(n){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i),n))return i;return null}_getOptionValue(n){const i=function pDe(e){return e.split(":")[0]}(n);return this._optionMap.has(i)?this._optionMap.get(i):n}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=nr(e)))(i||e)}}(),e.\u0275dir=me({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,i){1&n&&Be("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[ln([hDe]),Bt]}),e})(),dg=(()=>{class e{constructor(n,i,r){this._element=n,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(n){null!=this._select&&(this._select._optionMap.set(this.id,n),this._setElementValue(G9(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._setElementValue(n),this._select&&this._select.writeValue(this._select.value)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return e.\u0275fac=function(n){return new(n||e)(H(dn),H(_o),H(kc,9))},e.\u0275dir=me({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();const gDe={provide:Do,useExisting:xt(()=>BN),multi:!0};function W9(e,t){return null==e?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let BN=(()=>{class e extends Ad{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){let i;if(this.value=n,Array.isArray(n)){const r=n.map(s=>this._getOptionId(s));i=(s,o)=>{s._setSelected(r.indexOf(o.toString())>-1)}}else i=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(n){this.onChange=i=>{const r=[],s=i.selectedOptions;if(void 0!==s){const o=s;for(let a=0;a<o.length;a++){const u=this._getOptionValue(o[a].value);r.push(u)}}else{const o=i.options;for(let a=0;a<o.length;a++){const l=o[a];if(l.selected){const u=this._getOptionValue(l.value);r.push(u)}}}this.value=r,n(r)}}_registerOption(n){const i=(this._idCounter++).toString();return this._optionMap.set(i,n),i}_getOptionId(n){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i)._value,n))return i;return null}_getOptionValue(n){const i=function mDe(e){return e.split(":")[0]}(n);return this._optionMap.has(i)?this._optionMap.get(i)._value:n}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=nr(e)))(i||e)}}(),e.\u0275dir=me({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,i){1&n&&Be("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[ln([gDe]),Bt]}),e})(),hg=(()=>{class e{constructor(n,i,r){this._element=n,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(n){null!=this._select&&(this._value=n,this._setElementValue(W9(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._select?(this._value=n,this._setElementValue(W9(this.id,n)),this._select.writeValue(this._select.value)):this._setElementValue(n)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}_setSelected(n){this._renderer.setProperty(this._element.nativeElement,"selected",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return e.\u0275fac=function(n){return new(n||e)(H(dn),H(_o),H(BN,9))},e.\u0275dir=me({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})(),xDe=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({imports:[[j9]]}),e})(),nz=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({imports:[xDe]}),e})(),ADe=(()=>{class e{transform(n,i){if(void 0===n)return n;if("string"!=typeof n||Number.isNaN(Number(n))){if("string"==typeof n)return n}else n=Number(n);return Number.isNaN(n)?null:n<1e3?n:n.toString().slice(0,n.toString().length-3)+","+n.toString().slice(-3)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275pipe=Er({name:"numFormat",type:e,pure:!0}),e})();function TDe(e,t){1&e&&(B(0,"div",12)(1,"div",13)(2,"div",14)(3,"span",15),Y(4,"Loading..."),$()()()())}function ODe(e,t){if(1&e&&(B(0,"div",16)(1,"div",17)(2,"div",1)(3,"div",18),Y(4),WO(5,"numFormat"),$()(),B(6,"div",1)(7,"p"),Y(8,"company statements found under MSA"),$()()(),B(9,"div",2)(10,"div",1)(11,"div",18),Y(12),WO(13,"numFormat"),$()(),B(14,"div",1)(15,"p"),Y(16,"MSA statements assessed by Researchers"),$()()(),B(17,"div",17)(18,"div",1)(19,"div",18),Y(20),$()(),B(21,"div",1)(22,"p"),Y(23,"of the assessed statements meet all minimum requirements of the corresponding MSA legislation"),$()()(),B(24,"div",2)(25,"div",1)(26,"div",18),Y(27," 15% "),$()(),B(28,"div",1)(29,"p"),Y(30,"of the assessed statements go beyond compliance and report additional guidelines"),$()()()()),2&e){const n=Mt();ne(4),Kp(qO(5,3,n.numOfCompaniesUnderMSA)),ne(8),Kp(qO(13,5,n.numOfAssessedMSAStatements)),ne(8),mo("",n.meetsMinRequirements,"%")}}let MDe=(()=>{class e{constructor(n){this.dataProvider=n,this.year="",this.legislation="both",this.isLoading=!0}ngOnInit(){this.updateData()}ngOnChanges(){}updateData(){this.isLoading=!0,"both"===this.legislation?this.dataProvider.getAnswers(this.dataProvider.metrics.msa_registry_submission,[new st("year",this.year)]).subscribe(n=>{this.numOfCompaniesUnderMSA=n.length,this.dataProvider.getAnswers(this.dataProvider.metrics.aus_msa_statement_assessed,[new st("year",this.year),new st("value","Yes")]).subscribe(i=>{this.numOfAssessedMSAStatements=i.length,this.dataProvider.getAnswers(this.dataProvider.metrics.uk_msa_statement_assessed,[new st("year",this.year),new st("value","Yes")]).subscribe(r=>{this.numOfAssessedMSAStatements+=r.length,this.dataProvider.getAnswers(this.dataProvider.metrics.meet_aus_min_requirements,[new st("year",this.year),new st("value","Yes")]).subscribe(s=>{this.meetsMinRequirements=s.length,this.dataProvider.getAnswers(this.dataProvider.metrics.meet_uk_min_requirements,[new st("year",this.year),new st("value","Yes")]).subscribe(o=>{this.meetsMinRequirements=Math.round(100*(this.meetsMinRequirements+o.length)/this.numOfAssessedMSAStatements*100)/100},o=>console.log(o),()=>this.isLoading=!1)})})})}):"uk"===this.legislation?this.dataProvider.getAnswers(this.dataProvider.metrics.msa_registry_submission,[new st("year",this.year),new st("value","UK Registry Submission")]).subscribe(n=>{this.numOfCompaniesUnderMSA=n.length,this.dataProvider.getAnswers(this.dataProvider.metrics.uk_msa_statement_assessed,[new st("year",this.year),new st("value","Yes")]).subscribe(i=>{this.numOfAssessedMSAStatements=i.length,this.dataProvider.getAnswers(this.dataProvider.metrics.meet_uk_min_requirements,[new st("year",this.year),new st("value","Yes")]).subscribe(r=>{this.meetsMinRequirements=Math.round(r.length/this.numOfAssessedMSAStatements*100*100)/100},r=>console.log(r),()=>this.isLoading=!1)})}):this.dataProvider.getAnswers(this.dataProvider.metrics.msa_registry_submission,[new st("year",this.year),new st("value","Australian Registry Submission")]).subscribe(n=>{this.numOfCompaniesUnderMSA=n.length,this.dataProvider.getAnswers(this.dataProvider.metrics.aus_msa_statement_assessed,[new st("year",this.year),new st("value","Yes")]).subscribe(i=>{this.numOfAssessedMSAStatements=i.length,this.dataProvider.getAnswers(this.dataProvider.metrics.meet_aus_min_requirements,[new st("year",this.year),new st("value","Yes")]).subscribe(r=>{this.meetsMinRequirements=Math.round(r.length/this.numOfAssessedMSAStatements*100*100)/100},r=>console.log(r),()=>this.isLoading=!1)})})}}return e.\u0275fac=function(n){return new(n||e)(H(Tc))},e.\u0275cmp=Mn({type:e,selectors:[["key-findings-section"]],inputs:{sector:"sector"},features:[ni],decls:27,vars:12,consts:[[1,"section","mt-5","bg-neutral-grey","p-4"],[1,"row"],[1,"col-md-6"],[1,"title"],[1,"col-md-6","ms-md-auto"],[1,"row","ps-3","pe-3","pt-md-0","pt-2"],["aria-label","Default select example",1,"msa-form-select","bg-neutral-grey","ms-md-auto","me-3",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],["aria-label","Default select example",1,"msa-form-select","bg-neutral-grey",3,"ngModel","ngModelChange","change"],["class","row mt-3","style","height: 150px",4,"ngIf"],["class","row mt-3 mb-3",4,"ngIf"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"],[1,"row","mt-3","mb-3"],[1,"col-md-6","pe-md-2"],[1,"msa-primary-info"]],template:function(n,i){1&n&&(B(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),Y(4,"Key Findings"),$()(),B(5,"div",4)(6,"div",5)(7,"select",6),Be("ngModelChange",function(s){return i.year=s})("change",function(){return i.updateData()}),B(8,"option",7),Y(9,"all years"),$(),B(10,"option",8),Y(11,"latest"),$(),B(12,"option",8),Y(13,"2021"),$(),B(14,"option",8),Y(15,"2020"),$(),B(16,"option",8),Y(17,"2019"),$()(),B(18,"select",9),Be("ngModelChange",function(s){return i.legislation=s})("change",function(){return i.updateData()}),B(19,"option",7),Y(20,"Legislation"),$(),B(21,"option",8),Y(22,"UK MSA"),$(),B(23,"option",8),Y(24,"AUS MSA"),$()()()()(),He(25,TDe,5,0,"div",10),He(26,ODe,31,7,"div",11),$()),2&n&&(ne(7),ae("ngModel",i.year),ne(1),ae("ngValue",""),ne(2),ae("ngValue","latest"),ne(2),ae("ngValue",2021),ne(2),ae("ngValue",2020),ne(2),ae("ngValue",2019),ne(2),ae("ngModel",i.legislation),ne(1),ae("ngValue","both"),ne(2),ae("ngValue","uk"),ne(2),ae("ngValue","aus"),ne(2),ae("ngIf",i.isLoading),ne(1),ae("ngIf",!i.isLoading))},directives:[kc,cg,Td,dg,hg,bo],pipes:[ADe],styles:[""]}),e})(),NDe=(()=>{class e{constructor(){this.year="",this.legislation="both"}ngOnInit(){}updateData(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Mn({type:e,selectors:[["treemap"]],decls:25,vars:10,consts:[[1,"section","mt-5","bg-neutral-orange","p-4"],[1,"row"],[1,"col-md-6"],[1,"title"],[1,"col-md-6","ms-md-auto"],[1,"row","ps-3","pe-3","pt-md-0","pt-2"],["aria-label","Default select example",1,"msa-form-select","bg-neutral-orange","ms-md-auto","me-3",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],["aria-label","Default select example",1,"msa-form-select","bg-neutral-orange",3,"ngModel","ngModelChange","change"]],template:function(n,i){1&n&&(B(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),Y(4,"Treepmap"),$()(),B(5,"div",4)(6,"div",5)(7,"select",6),Be("ngModelChange",function(s){return i.year=s})("change",function(){return i.updateData()}),B(8,"option",7),Y(9,"all years"),$(),B(10,"option",7),Y(11,"latest"),$(),B(12,"option",8),Y(13,"2021"),$(),B(14,"option",8),Y(15,"2020"),$(),B(16,"option",8),Y(17,"2019"),$()(),B(18,"select",9),Be("ngModelChange",function(s){return i.legislation=s})("change",function(){return i.updateData()}),B(19,"option",7),Y(20,"Legislation"),$(),B(21,"option",8),Y(22,"UK MSA"),$(),B(23,"option",8),Y(24,"AUS MSA"),$()()()()()()),2&n&&(ne(7),ae("ngModel",i.year),ne(1),ae("ngValue",""),ne(2),ae("ngValue","latest"),ne(2),ae("ngValue",2021),ne(2),ae("ngValue",2020),ne(2),ae("ngValue",2019),ne(2),ae("ngModel",i.legislation),ne(1),ae("ngValue","both"),ne(2),ae("ngValue","uk"),ne(2),ae("ngValue","aus"))},directives:[kc,cg,Td,dg,hg],styles:[""]}),e})();const kDe=JSON.parse('[{"seq":1,"id":1831852,"metric":"Business_Human_Rights_Resource_Centre+MSA_statement_signed","label":"Signed by Appropriate Person","short_label":"signed","color":0,"filter_value":["Signed by CEO","Signed by Director","Signed by Managing Director","Signed by Chairman"]},{"seq":2,"id":1827915,"metric":"Business_Human_Rights_Resource_Centre+MSA_Statement_Approval","label":"Board Approval","short_label":"approved","color":0,"filter_value":["Approved by Board"]},{"seq":3,"id":12536905,"metric":"Walk_Free+MSA_statement_homepage_link","label":"Homepage Link","short_label":"homepage","color":0,"filter_value":["Yes"]}]'),IDe=JSON.parse('[{"seq":1,"id":1831852,"metric":"Business_Human_Rights_Resource_Centre+MSA_statement_signed","label":"Signed by Appropriate Person","short_label":"signed","color":0,"filter_value":["Signed by CEO","Signed by Director","Signed by Managing Director","Signed by Chairman"]},{"seq":2,"id":1827915,"metric":"Business_Human_Rights_Resource_Centre+MSA_Statement_Approval","label":"Board Approval","short_label":"approved","color":0,"filter_value":["Approved by Board"]},{"seq":3,"id":12536930,"metric":"Walk_Free+MSA_registry_submission","label":"Registry Submission","short_label":"registry_submission","color":0,"filter_value":["Australian Registry submission"]},{"seq":4,"id":5454264,"metric":"Walk_Free+MSA_registry_submission","label":"Organizational Structure and Operations","short_label":"organizational_structure","color":0,"filter_value":["Yes"]},{"seq":5,"id":1831908,"metric":"Walk_Free+MSA_supply_chain_disclosure","label":"Supply Chain Disclosure","short_label":"supply_chain_disclosure","color":0,"filter_value":["Geographical","Facility/Supplier"]},{"seq":6,"id":1831932,"metric":"Walk_Free+MSA_Identification_of_risks","label":"Identification of Risks","short_label":"risk_identification","color":0,"filter_value":["Geographic","Resource","Workforce","Industry"]},{"seq":7,"id":2722223,"metric":"Walk_Free+MSA_risk_assessment","label":"Risk Assessment","short_label":"risk_assessment","color":0,"filter_value":["Risk-based questionnaires","Use of risk management tool or software","Conducting desk research"]},{"seq":8,"id":2722169,"metric":"Walk_Free+MSA_risk_management","label":"Risk Management","short_label":"risk_management","color":0,"filter_value":["Audits of suppliers (self- reporting)","Audits of suppliers (independent)","On-site visits (self- reporting)","On-site visits (independent)"]},{"seq":9,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"Incidents Remediation","short_label":"incident_remediation","color":0,"filter_value":["Worker remediation","Corrective action plan","Senior management","Cancel contracts"]},{"seq":10,"id":2722458,"metric":"Walk_Free+MSA_whistleblowing_mechanism_revised","label":"Whistleblowing mechanism","short_label":"whistleblowing_mechanism","color":0,"filter_value":["Hotline, Email, Contact Form (direct employees)","Hotline, Email, Contact Form (supply chain workers)","Whistleblower protection (direct employees)","Whistleblower protection (supply chain workers)","Focal Point (direct employees)","Focal Point (supply chain workers)"]},{"seq":11,"id":1832024,"metric":"Walk_Free+MSA_Performance_Indicators","label":"Key Performance Indicators","short_label":"kpis","color":0,"filter_value":["Yes"]},{"seq":12,"id":8772491,"metric":"Walk_Free+MSA_Consultation_Process","label":"Consultation Process","short_label":"consultation_process","color":0,"filter_value":["Yes"]}]'),RDe=JSON.parse('{"$schema":"https://vega.github.io/schema/vega/v5.json","description":"Companies meeting minimum requirements","width":190,"height":180,"padding":10,"signals":[{"name":"hoverValue","value":null,"on":[{"events":"arc:mouseover, @legendLabel:mouseover, @legendSymbol:mouseover","update":"datum.value"},{"events":"arc:mouseout, @legendLabel:mouseout, @legendSymbol:mouseout","update":"null"}]},{"name":"hoverOpacity","update":"if(hoverValue, 0.5, 1)","value":1}],"data":[{"name":"counts","values":[{"value":"Met","count":100,"sum_count":147},{"value":"Not Met","count":143,"sum_count":147}],"transform":[{"type":"pie","field":"count","sort":false},{"type":"formula","as":"filter","expr":"{ value: [datum.value] }"},{"type":"window","ops":["sum"],"fields":["count"],"frame":[null,null]},{"type":"formula","as":"percentage","expr":"format(datum.count / datum.sum_count, \'.0%\')"},{"type":"collect","sort":{"field":"value"}},{"type":"formula","expr":"datum.count + \' out of \' + datum.sum_count + \' companies\'","as":"count_label"}]}],"marks":[{"type":"arc","from":{"data":"counts"},"encode":{"enter":{"fill":{"scale":"color","field":"value"},"x":{"value":100},"y":{"value":100},"tooltip":{"field":"count_label"}},"update":{"startAngle":{"field":"startAngle"},"endAngle":{"field":"endAngle"},"padAngle":{"value":0},"innerRadius":{"value":0},"outerRadius":{"value":120},"cornerRadius":{"value":0},"opacity":{"signal":"if(hoverValue == datum.value, 1, hoverOpacity)"}},"hover":{"opacity":{"value":1},"cursor":{"value":"pointer"}}}},{"type":"text","from":{"data":"counts"},"encode":{"enter":{"x":{"value":100},"y":{"value":100},"radius":{"value":50},"fontWeight":{"value":"bold"},"fontSize":{"value":15},"theta":{"signal":"(datum.startAngle + datum.endAngle)/2"},"fill":{"value":"white"},"align":{"value":"center"},"baseline":{"value":"middle"},"text":{"field":"percentage"}}}}],"legends":[{"fill":"color","type":"symbol","encode":{"labels":{"name":"legendLabel","interactive":true,"update":{"fontSize":{"value":9},"fontWeight":[{"test":"hoverValue == datum.label","value":"bold"},{"value":400}]}},"symbols":{"name":"legendSymbol","interactive":true}}}],"scales":[{"name":"color","type":"ordinal","range":["#000028","#FF9300"],"domain":["Not Met","Met"]}]}'),FDe=JSON.parse('{"$schema":"https://vega.github.io/schema/vega/v5.json","description":"Modern Slavery Supply Chain Policies","width":250,"height":220,"padding":10,"signals":[{"name":"hoverValue","value":null,"on":[{"events":"arc:mouseover, @legendLabel:mouseover, @legendSymbol:mouseover","update":"datum.value"},{"events":"arc:mouseout, @legendLabel:mouseout, @legendSymbol:mouseout","update":"null"}]},{"name":"hoverOpacity","update":"if(hoverValue, 0.5, 1)","value":1}],"data":[{"name":"counts","source":"answers","transform":[{"type":"aggregate","groupby":["value"],"ops":["count"],"fields":["count"],"as":["count"]},{"type":"pie","field":"count","sort":false},{"type":"formula","as":"filter","expr":"{ value: [datum.value] }"},{"type":"window","ops":["sum"],"fields":["count"],"frame":[null,null]},{"type":"formula","as":"percentage","expr":"format(datum.count / datum.sum_count, \'.0%\')"},{"type":"collect","sort":{"field":"value"}},{"type":"formula","expr":"datum.count + \' out of \' + datum.sum_count + \' companies\'","as":"count_label"}]}],"marks":[{"type":"arc","from":{"data":"counts"},"encode":{"enter":{"fill":{"scale":"color","field":"value"},"x":{"value":100},"y":{"value":100},"tooltip":{"field":"count_label"}},"update":{"startAngle":{"field":"startAngle"},"endAngle":{"field":"endAngle"},"padAngle":{"value":0},"innerRadius":{"value":0},"outerRadius":{"value":120},"cornerRadius":{"value":0},"opacity":{"signal":"if(hoverValue == datum.value, 1, hoverOpacity)"}},"hover":{"opacity":{"value":1},"cursor":{"value":"pointer"}}}},{"type":"text","from":{"data":"counts"},"encode":{"enter":{"x":{"value":100},"y":{"value":100},"radius":{"value":50},"fontWeight":{"value":"bold"},"fontSize":{"value":15},"theta":{"signal":"(datum.startAngle + datum.endAngle)/2"},"fill":{"value":"white"},"align":{"value":"center"},"baseline":{"value":"middle"},"text":{"field":"percentage"}}}}],"legends":[{"fill":"color","type":"symbol","encode":{"labels":{"name":"legendLabel","interactive":true,"update":{"fontSize":{"value":13},"fontWeight":[{"test":"hoverValue == datum.label","value":"bold"},{"value":400}]}},"symbols":{"name":"legendSymbol","interactive":true}}}],"scales":[{"name":"color","type":"ordinal","range":["#000028","#FF9300"],"domain":["direct","beyond tier 1"]}]}'),PDe=JSON.parse('{"$schema":"https://vega.github.io/schema/vega/v5.json","description":"Risk assessment tool and risks identified","width":250,"height":180,"signals":[{"name":"colors","value":{"orange":"#FF9300","purple":"#932191","orange_purple":"#ad3d6f","dark_orange":"#c7594b","deep_orange":"#e17327"}},{"name":"hoverValue","value":null,"on":[{"events":"arc:mouseover, @legendLabel:mouseover, @legendSymbol:mouseover","update":"datum.value"},{"events":"arc:mouseout, @legendLabel:mouseout, @legendSymbol:mouseout","update":"null"}]},{"name":"hoverOpacity","update":"if(hoverValue, 0.5, 1)","value":1}],"data":[{"name":"groups","values":[{"name":"Performs assessment and identifies risks"},{"name":"Performs assessment but does not identify risks"},{"name":"Does not perform assessment but identifies risks"},{"name":"Does not perform assessment or identify risks"}],"transform":[{"type":"window","ops":["row_number"],"as":["seq"]}]},{"name":"counts","source":"answers","transform":[{"type":"aggregate","groupby":["value"],"ops":["count"],"fields":["count"],"as":["count"]},{"type":"lookup","from":"groups","key":"name","fields":["value"],"values":["seq"]},{"type":"collect","sort":{"field":"seq"}},{"type":"pie","field":"count","sort":false},{"type":"formula","as":"filter","expr":"{ value: [datum.value] }"},{"type":"window","ops":["sum"],"fields":["count"],"frame":[null,null]},{"type":"formula","as":"percentage","expr":"format(datum.count / datum.sum_count, \'.0%\')"},{"type":"formula","expr":"datum.count + \' out of \' + datum.sum_count + \' companies\'","as":"count_label"},{"type":"formula","as":"filter","expr":"{ value: [datum.value] }"}]}],"marks":[{"type":"arc","from":{"data":"counts"},"encode":{"enter":{"fill":{"scale":"color","field":"value"},"x":{"value":125},"y":{"value":100},"tooltip":{"field":"count_label"}},"update":{"startAngle":{"field":"startAngle"},"endAngle":{"field":"endAngle"},"padAngle":{"value":0},"innerRadius":{"value":0},"outerRadius":{"value":100},"cornerRadius":{"value":0},"opacity":{"signal":"if(hoverValue == datum.value, 1, hoverOpacity)"}},"hover":{"opacity":{"value":1},"cursor":{"value":"pointer"}}}},{"type":"text","from":{"data":"counts"},"encode":{"enter":{"x":{"value":125},"y":{"value":100},"radius":{"value":50},"theta":{"signal":"(datum.startAngle + datum.endAngle)/2"},"fill":{"value":"white"},"fontWeight":{"value":"bold"},"fontSize":{"value":15},"align":{"value":"center"},"baseline":{"value":"middle"},"text":{"field":"percentage"}}}}],"legends":[{"fill":"color","type":"symbol","orient":"top","encode":{"labels":{"name":"legendLabel","interactive":true,"update":{"limit":{"value":0},"fontSize":{"value":12},"fontWeight":[{"test":"hoverValue == datum.label","value":"bold"},{"value":400}]}},"symbols":{"name":"legendSymbol","interactive":true}}}],"scales":[{"name":"color","type":"ordinal","range":{"signal":"[colors.orange, colors.deep_orange, colors.orange_purple, colors.purple]"},"domain":{"signal":"pluck(data(\'groups\'), \'name\')"}}]}'),iz=JSON.parse('{"$schema":"https://vega.github.io/schema/vega/v5.json","description":"A nested bar chart example, with bars grouped by category.","width":350,"height":200,"signals":[{"name":"barHeight","value":"15"},{"name":"colors","value":{"orange":"#FF9300","red":"#FE0000","blue":"#4169e1","navy":"#000028","yellow":"#FFDC00"}},{"name":"barTitle","value":null,"on":[{"events":"rect:mouseover, text:mouseover","update":"datum.title"},{"events":"rect:mouseout, text:mouseout","update":"null"}]}],"data":[{"name":"assessed","url":"https://wikirate.org/~12602618+Answer.json?limit=0&filter[value]=Yes&filter[year]=latest&view=answer_list"},{"name":"signed","url":"https://wikirate.org/Business_Human_Rights_Resource_Centre+MSA_statement_signed_binary+answer/answer_list.json?limit=0&filter[status]=known&filter[year]=latest","transform":[{"type":"lookup","from":"assessed","key":"company","fields":["company"],"values":["value"],"as":["assessed"]},{"type":"filter","expr":"datum.assessed == \'Yes\'"},{"type":"aggregate","groupby":["value"]},{"type":"impute","key":"value","keyvals":["Yes"],"field":"count","value":0},{"type":"joinaggregate","fields":["count"],"ops":["sum"]},{"type":"filter","expr":"datum.value == \'Yes\'"}]},{"name":"approved","url":"https://wikirate.org/Business_Human_Rights_Resource_Centre+MSA_Statement_Approval+answer/answer_list.json?limit=0&filter[year]=latest","transform":[{"type":"lookup","from":"assessed","key":"company","fields":["company"],"values":["value"],"as":["assessed"]},{"type":"filter","expr":"datum.assessed == \'Yes\'"},{"type":"aggregate","groupby":["value"]},{"type":"impute","key":"value","keyvals":["Approved by Board"],"field":"count","value":0},{"type":"joinaggregate","fields":["count"],"ops":["sum"]},{"type":"filter","expr":"datum.value == \'Approved by Board\'"}]},{"name":"homepage","url":"https://wikirate.org/Business_Human_Rights_Resource_Centre+MSA_homepage_link_archived+answer/answer_list.json?limit=0&filter[year]=latest","transform":[{"type":"lookup","from":"assessed","key":"company","fields":["company"],"values":["value"],"as":["assessed"]},{"type":"filter","expr":"datum.assessed == \'Yes\'"},{"type":"aggregate","groupby":["value"]},{"type":"impute","key":"value","keyvals":["Yes"],"field":"count","value":0},{"type":"joinaggregate","fields":["count"],"ops":["sum"]},{"type":"filter","expr":"datum.value == \'Yes\'"}]},{"name":"all","url":"https://wikirate.org/Walk_Free+Meets_Minimum_UK_MSA_Requirements+answer/answer_list.json?limit=0&filter[company_group][]=MSA_Asset_Managers&filter[year]=latest","transform":[{"type":"aggregate","groupby":["value"]},{"type":"impute","key":"value","keyvals":["Yes"],"field":"count","value":0},{"type":"joinaggregate","fields":["count"],"ops":["sum"]},{"type":"filter","expr":"datum.value == \'Yes\'"}]},{"name":"metrics","values":[{"seq":1,"metric":"Business_Human_Rights_Resource_Centre+MSA_statement_signed","label":"Signed by Appropriate Person","short_label":"signed","color":0,"filter_value":["Signed by CEO","Signed by Director","Signed by Managing Director","Signed by Chairman"]},{"seq":2,"metric":"Business_Human_Rights_Resource_Centre+MSA_Statement_Approval","label":"Board Approval","short_label":"approved","color":0,"filter_value":["Approved by Board"]},{"seq":3,"metric":"Walk_Free+MSA_statement_homepage_link","label":"Homepage Link","short_label":"homepage","color":0,"filter_value":["Yes"]}]},{"name":"counts","source":["signed","approved","homepage"],"transform":[{"type":"window","ops":["row_number"],"as":["seq"]},{"type":"lookup","from":"metrics","key":"seq","fields":["seq"],"values":["label","metric","color","filter_value"],"as":["title","wikirate_page","color","filter_value"]},{"type":"formula","expr":"datum.count/datum.sum_count","as":"percentage"},{"type":"formula","expr":"format(datum.count / datum.sum_count, \'.0%\')","as":"percent_label"},{"type":"formula","expr":"datum.count + \' out of \' + datum.sum_count + \' companies\'","as":"count_label"},{"type":"formula","expr":"{ value: datum.filter_value }","as":"filter"}]}],"scales":[{"name":"xscale","domain":[0,1],"zero":true,"type":"linear","range":"width"},{"name":"yscale","range":"height","domain":{"data":"counts","field":"title"},"type":"band","padding":0.4},{"name":"color","type":"linear","domain":[0,3],"range":{"signal":"[colors.orange, colors.yellow, colors.navy, colors.blue]"}}],"marks":[{"type":"rect","from":{"data":"counts"},"encode":{"update":{"x":{"value":0},"x2":{"scale":"xscale","value":1},"y":{"scale":"yscale","field":"title"},"height":{"signal":"barHeight"},"fill":{"signal":"colors.navy"},"tooltip":{"field":"count_label"},"opacity":{"signal":"if(barTitle == datum.title, 0.5, 1)"}},"hover":{"cursor":{"value":"pointer"}}}},{"type":"rect","from":{"data":"counts"},"encode":{"update":{"x":{"value":0},"x2":{"scale":"xscale","field":"percentage"},"y":{"scale":"yscale","field":"title"},"height":{"signal":"barHeight"},"fill":{"scale":"color","field":"color"},"tooltip":{"field":"count_label"}},"hover":{"cursor":{"value":"pointer"}}}},{"type":"text","from":{"data":"counts"},"encode":{"update":{"fontSize":{"value":15},"font":{"value":"GothamNarrow"},"x":{"scale":"xscale","value":1},"y":{"scale":"yscale","field":"title","offset":-3},"baseline":{"value":"bottom"},"align":{"value":"right"},"text":{"field":"percent_label"},"fontWeight":{"value":"bold"},"fill":{"scale":"color","signal":"if(barTitle == datum.title, datum.color, 2)"}},"hover":{"cursor":{"value":"pointer"}}}},{"type":"text","from":{"data":"counts"},"encode":{"update":{"fontSize":{"value":15},"font":{"value":"GothamNarrow"},"x":{"value":0},"y":{"scale":"yscale","field":"title","offset":-3},"text":{"field":"title"},"baseline":{"value":"bottom"},"fontWeight":{"value":"bold"},"fill":{"signal":"colors.navy"}},"hover":{"cursor":{"value":"pointer"}}}}]}'),LDe=JSON.parse('{"$schema":"https://vega.github.io/schema/vega/v5.json","description":"Risk Management","width":300,"padding":{"right":5},"signals":[{"name":"totalAnswers","update":"data(\'answers\').length"},{"name":"numGroups","update":"data(\'groups\').length"},{"name":"barHeight","value":15},{"name":"height","update":"numGroups * (barHeight + 15)+ 200"},{"name":"colors","value":{"orange":"#FF9300","red":"#FE0000","blue":"#0037F1","navy":"#000028","yellow":"#FFDC00","orange_purple":"#c7594b"}},{"name":"barOver","value":{},"on":[{"events":"rect:mouseover, text:mouseover","update":"datum"},{"events":"rect:mouseout, text:mouseout","update":"{}"}]}],"data":[{"name":"assessed","url":"https://wikirate.org/Walk_Free+UK_MSA_statement_assessed+Answer.json?filter%5Bnot_ids%5D=&filter%5Bcompany_name%5D=&view=answer_list&filter[value][]=Yes&limit=0&filter[year]=latest"},{"name":"answers","url":"https://wikirate.org/Walk_Free+MSA_risk_management_revised+answer/answer_list.json?limit=0&filter[year]=latest","transform":[{"type":"lookup","from":"assessed","key":"company","fields":["company"],"values":["value"],"as":["assessed"]},{"type":"filter","expr":"datum.value != \'\' && datum.assessed == \'Yes\'"},{"type":"formula","expr":"split(datum.value, \', \')","as":"value_array"}]},{"name":"subgroups","values":[{"key":"(self- reporting)","label":"Self reporting","color":0,"seq":1},{"key":"(independent)","label":"Independent","color":1,"seq":2}],"transform":[{"type":"window","ops":["row_number"],"as":["seq"]}]},{"name":"groups","values":[{"title":"Audits of suppliers","term":"Audits of suppliers","seq":1},{"title":"On-site visits","term":"On-site visits","seq":2}],"transform":[{"type":"window","ops":["row_number"],"as":["seq"]}]},{"name":"counts","source":"answers","transform":[{"type":"flatten","fields":["value_array"],"as":["value"]},{"type":"aggregate","ops":["count"],"groupby":["value"]},{"type":"formula","as":"term","expr":"replace(datum.value, / \\\\(.*/, \'\')"},{"type":"formula","as":"parens","expr":"replace(datum.value, /^[^\\\\(]*/, \'\')"},{"type":"formula","expr":"if(datum.count, datum.count, 0)","as":"count"},{"type":"lookup","from":"groups","key":"term","fields":["term"],"values":["seq"],"as":["group_seq"]},{"type":"filter","expr":"datum.group_seq != null"},{"type":"lookup","from":"subgroups","key":"key","fields":["parens"],"values":["seq","label","color"],"as":["subgroup_seq","subgroup_label","color"]},{"type":"collect","sort":{"field":["group_seq","subgroup_seq"]}},{"type":"formula","expr":"datum.count + \' out of \' + totalAnswers + \' compannies\'","as":"count_label"},{"type":"formula","expr":"format(datum.count / totalAnswers, \'.0%\')","as":"percent_label"},{"type":"formula","expr":"datum.term + \' \' + datum.parens","as":"title"},{"type":"formula","as":"filter","expr":"{ value: [datum.value] }"}]}],"scales":[{"name":"xscale","domain":[0,{"signal":"totalAnswers"}],"zero":true,"type":"linear","range":"width"},{"name":"ygroupscale","range":"height","domain":{"data":"counts","field":"term"},"type":"band","padding":0.4},{"name":"color","type":"ordinal","domain":{"data":"counts","field":"subgroup_label"},"range":{"signal":"[colors.orange, colors.orange_purple, colors.yellow, colors.navy]"}},{"name":"textColor","type":"linear","domain":[0,3],"range":{"signal":"[colors.orange, colors.orange_purple, colors.yellow, colors.navy]"}}],"marks":[{"type":"group","from":{"facet":{"name":"faceted_counts","groupby":"term","data":"counts"}},"encode":{"enter":{"fill":{"value":"grey"},"y":{"scale":"ygroupscale","field":"term"}}},"scales":[{"name":"yscale","type":"band","range":"height","domain":{"data":"faceted_counts","field":"title"},"padding":0.1}],"signals":[{"name":"height","update":"bandwidth(\'ygroupscale\')"}],"marks":[{"type":"rect","from":{"data":"faceted_counts"},"encode":{"update":{"x":{"value":0},"x2":{"scale":"xscale","signal":"totalAnswers"},"y":{"scale":"yscale","field":"title"},"height":{"signal":"barHeight"},"fill":{"signal":"colors.navy"},"tooltip":{"field":"count_label"},"opacity":{"signal":"if(barOver.title == datum.title, 0.5, 1)"}},"hover":{"cursor":{"value":"pointer"}}}},{"type":"rect","from":{"data":"faceted_counts"},"encode":{"update":{"x":{"value":0},"x2":{"scale":"xscale","field":"count"},"y":{"scale":"yscale","field":"title"},"height":{"signal":"barHeight"},"fill":{"scale":"textColor","field":"color"},"tooltip":{"field":"percent_label"}},"hover":{"cursor":{"value":"pointer"}}}},{"name":"nocounts","type":"text","from":{"data":"faceted_counts"},"encode":{"update":{"x":{"value":5},"y":{"scale":"yscale","field":"title","offset":2},"baseline":{"value":"top"},"text":{"signal":"if(datum.count == 0, \'None\', \'\')"},"fill":{"value":"white"},"fontStyle":{"value":"italic"}}}},{"type":"text","from":{"data":"faceted_counts"},"encode":{"update":{"fontSize":{"value":15},"font":{"value":"GothamNarrow"},"x":{"scale":"xscale","signal":"totalAnswers","offset":4},"y":{"scale":"yscale","field":"title","offset":2},"baseline":{"value":"top"},"text":{"field":"percent_label"},"fontWeight":{"value":"bold"},"fill":{"scale":"textColor","signal":"if(barOver.title == datum.title, datum.color, 3)"}},"hover":{"cursor":{"value":"pointer"}}}}]},{"type":"text","from":{"data":"groups"},"encode":{"update":{"fontSize":{"value":15},"font":{"value":"GothamNarrow"},"x":{"value":0},"y":{"scale":"ygroupscale","field":"term","offset":-2},"text":{"field":"title"},"baseline":{"value":"bottom"},"fontWeight":{"value":"bold"},"fill":{"signal":"colors.navy"}}}}],"legends":[{"fill":"color","type":"symbol","orient":"none","direction":"horizontal","columnPadding":20,"rowPadding":20,"labelFontSize":{"value":25},"encode":{"legend":{"update":{"fontSize":{"value":13},"x":{"value":0},"y":{"offset":-10}}},"labels":{"update":{"fontSize":{"value":13}}}}}]}');var e,jDe=(e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])})(t,n)},function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),BDe=Object.prototype.hasOwnProperty;function Pw(e,t){return BDe.call(e,t)}function VN(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var i=[];for(var r in e)Pw(e,r)&&i.push(r);return i}function js(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function HN(e){for(var i,t=0,n=e.length;t<n;){if(!((i=e.charCodeAt(t))>=48&&i<=57))return!1;t++}return!0}function xu(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function rz(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function UN(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(UN(e[t]))return!0}else if("object"==typeof e)for(var i=VN(e),r=i.length,s=0;s<r;s++)if(UN(e[i[s]]))return!0;return!1}function oz(e,t){var n=[e];for(var i in t){var r="object"==typeof t[i]?JSON.stringify(t[i],null,2):t[i];void 0!==r&&n.push(i+": "+r)}return n.join("\n")}var az=function(e){function t(n,i,r,s,o){var a=this.constructor,l=e.call(this,oz(n,{name:i,index:r,operation:s,tree:o}))||this;return l.name=i,l.index=r,l.operation=s,l.tree=o,Object.setPrototypeOf(l,a.prototype),l.message=oz(n,{name:i,index:r,operation:s,tree:o}),l}return jDe(t,e),t}(Error),Hn=az,$De=js,pg={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=Lw(n,this.path);i&&(i=js(i));var r=Md(n,{op:"remove",path:this.from}).removed;return Md(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=Lw(n,this.from);return Md(n,{op:"add",path:this.path,value:js(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:M_(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},VDe={add:function(e,t,n){return HN(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:pg.move,copy:pg.copy,test:pg.test,_get:pg._get};function Lw(e,t){if(""==t)return e;var n={op:"_get",path:t};return Md(e,n),n.value}function Md(e,t,n,i,r,s){if(void 0===n&&(n=!1),void 0===i&&(i=!0),void 0===r&&(r=!0),void 0===s&&(s=0),n&&("function"==typeof n?n(t,0,e,t.path):Bw(t,0)),""===t.path){var o={newDocument:e};if("add"===t.op)return o.newDocument=t.value,o;if("replace"===t.op)return o.newDocument=t.value,o.removed=e,o;if("move"===t.op||"copy"===t.op)return o.newDocument=Lw(e,t.from),"move"===t.op&&(o.removed=e),o;if("test"===t.op){if(o.test=M_(e,t.value),!1===o.test)throw new Hn("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o.newDocument=e,o}if("remove"===t.op)return o.removed=e,o.newDocument=null,o;if("_get"===t.op)return t.value=e,o;if(n)throw new Hn("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,t,e);return o}i||(e=js(e));var l=(t.path||"").split("/"),u=e,c=1,f=l.length,d=void 0,h=void 0,p=void 0;for(p="function"==typeof n?n:Bw;;){if((h=l[c])&&-1!=h.indexOf("~")&&(h=rz(h)),r&&("__proto__"==h||"prototype"==h&&c>0&&"constructor"==l[c-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===d&&(void 0===u[h]?d=l.slice(0,c).join("/"):c==f-1&&(d=t.path),void 0!==d&&p(t,0,e,d)),c++,Array.isArray(u)){if("-"===h)h=u.length;else{if(n&&!HN(h))throw new Hn("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,t,e);HN(h)&&(h=~~h)}if(c>=f){if(n&&"add"===t.op&&h>u.length)throw new Hn("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,t,e);if(!1===(o=VDe[t.op].call(t,u,h,e)).test)throw new Hn("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}}else if(c>=f){if(!1===(o=pg[t.op].call(t,u,h,e)).test)throw new Hn("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}if(u=u[h],n&&c<f&&(!u||"object"!=typeof u))throw new Hn("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,t,e)}}function jw(e,t,n,i,r){if(void 0===i&&(i=!0),void 0===r&&(r=!0),n&&!Array.isArray(t))throw new Hn("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=js(e));for(var s=new Array(t.length),o=0,a=t.length;o<a;o++)s[o]=Md(e,t[o],n,!0,r,o),e=s[o].newDocument;return s.newDocument=e,s}function HDe(e,t,n){var i=Md(e,t);if(!1===i.test)throw new Hn("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function Bw(e,t,n,i){if("object"!=typeof e||null===e||Array.isArray(e))throw new Hn("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!pg[e.op])throw new Hn("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!=typeof e.path)throw new Hn("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new Hn('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new Hn("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new Hn("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&UN(e.value))throw new Hn("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var r=e.path.split("/").length,s=i.split("/").length;if(r!==s+1&&r!==s)throw new Hn("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==i)throw new Hn("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var a=lz([{op:"_get",path:e.from,value:void 0}],n);if(a&&"OPERATION_PATH_UNRESOLVABLE"===a.name)throw new Hn("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function lz(e,t,n){try{if(!Array.isArray(e))throw new Hn("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)jw(js(t),js(e),n||!0);else{n=n||Bw;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(r){if(r instanceof Hn)return r;throw r}}function M_(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var r,s,o,n=Array.isArray(e),i=Array.isArray(t);if(n&&i){if((s=e.length)!=t.length)return!1;for(r=s;0!=r--;)if(!M_(e[r],t[r]))return!1;return!0}if(n!=i)return!1;var a=Object.keys(e);if((s=a.length)!==Object.keys(t).length)return!1;for(r=s;0!=r--;)if(!t.hasOwnProperty(a[r]))return!1;for(r=s;0!=r--;)if(!M_(e[o=a[r]],t[o]))return!1;return!0}return e!=e&&t!=t}var zN=new WeakMap,UDe=function e(t){this.observers=new Map,this.obj=t},zDe=function e(t,n){this.callback=t,this.observer=n};function YDe(e,t){t.unobserve()}function KDe(e,t){var i,r=function GDe(e){return zN.get(e)}(e);if(r){var s=function WDe(e,t){return e.observers.get(t)}(r,t);i=s&&s.observer}else r=new UDe(e),zN.set(e,r);if(i)return i;if(i={},r.value=js(e),t){i.callback=t,i.next=null;var o=function(){GN(i)},a=function(){clearTimeout(i.next),i.next=setTimeout(o)};"undefined"!=typeof window&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return i.patches=[],i.object=e,i.unobserve=function(){GN(i),clearTimeout(i.next),function qDe(e,t){e.observers.delete(t.callback)}(r,i),"undefined"!=typeof window&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},r.observers.set(t,new zDe(t,i)),i}function GN(e,t){void 0===t&&(t=!1);var n=zN.get(e.object);WN(n.value,e.object,e.patches,"",t),e.patches.length&&jw(n.value,e.patches);var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function WN(e,t,n,i,r){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var s=VN(t),o=VN(e),l=!1,u=o.length-1;u>=0;u--){var f=e[c=o[u]];if(!Pw(t,c)||void 0===t[c]&&void 0!==f&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:"test",path:i+"/"+xu(c),value:js(f)}),n.push({op:"remove",path:i+"/"+xu(c)}),l=!0):(r&&n.push({op:"test",path:i,value:e}),n.push({op:"replace",path:i,value:t}));else{var d=t[c];"object"==typeof f&&null!=f&&"object"==typeof d&&null!=d&&Array.isArray(f)===Array.isArray(d)?WN(f,d,n,i+"/"+xu(c),r):f!==d&&(r&&n.push({op:"test",path:i+"/"+xu(c),value:js(f)}),n.push({op:"replace",path:i+"/"+xu(c),value:js(d)}))}}if(l||s.length!=o.length)for(u=0;u<s.length;u++){var c;!Pw(e,c=s[u])&&void 0!==t[c]&&n.push({op:"add",path:i+"/"+xu(c),value:js(t[c])})}}}function JDe(e,t,n){void 0===n&&(n=!1);var i=[];return WN(e,t,i,"",n),i}Object.assign({},Pt,Yt,{JsonPatchError:az,deepClone:js,escapePathComponent:xu,unescapePathComponent:rz});var XDe=ue(564),qN=ue.n(XDe);function is(e,t,n){return e.fields=t||[],e.fname=n,e}function Un(e){return null==e?null:e.fname}function or(e){return null==e?null:e.fields}function uz(e){return 1===e.length?QDe(e[0]):ZDe(e)}const QDe=e=>function(t){return t[e]},ZDe=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function Q(e){throw Error(e)}function ul(e){const t=[],n=e.length;let o,a,l,i=null,r=0,s="";function u(){t.push(s+e.substring(o,a)),s="",o=a+1}for(e+="",o=a=0;a<n;++a)if(l=e[a],"\\"===l)s+=e.substring(o,a),s+=e.substring(++a,++a),o=a;else if(l===i)u(),i=null,r=-1;else{if(i)continue;o===r&&'"'===l||o===r&&"'"===l?(o=a+1,i=l):"."!==l||r?"["===l?(a>o&&u(),r=o=a+1):"]"===l&&(r||Q("Access path missing open bracket: "+e),r>0&&u(),r=0,o=a+1):a>o?u():o=a+1}return r&&Q("Access path missing closing bracket: "+e),i&&Q("Access path missing closing quote: "+e),a>o&&(a++,u()),t}function rs(e,t,n){const i=ul(e);return e=1===i.length?i[0]:e,is((n&&n.get||uz)(i),[e],t||e)}const N_=rs("id"),ar=is(e=>e,[],"identity"),Ic=is(()=>0,[],"zero"),gg=is(()=>1,[],"one"),Co=is(()=>!0,[],"true"),Rc=is(()=>!1,[],"false");function eCe(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const cz=0,YN=1,KN=2,fz=3,dz=4;function JN(e,t,n=eCe){let i=e||cz;return{level(r){return arguments.length?(i=+r,this):i},error(){return i>=YN&&n(t||"error","ERROR",arguments),this},warn(){return i>=KN&&n(t||"warn","WARN",arguments),this},info(){return i>=fz&&n(t||"log","INFO",arguments),this},debug(){return i>=dz&&n(t||"log","DEBUG",arguments),this}}}var Z=Array.isArray;function Ce(e){return e===Object(e)}const hz=e=>"__proto__"!==e;function mg(...e){return e.reduce((t,n)=>{for(const i in n)"signals"===i?t.signals=tCe(t.signals,n.signals):_g(t,i,n[i],"legend"===i?{layout:1}:"style"===i||null);return t},{})}function _g(e,t,n,i){if(!hz(t))return;let r,s;if(Ce(n)&&!Z(n))for(r in s=Ce(e[t])?e[t]:e[t]={},n)i&&(!0===i||i[r])?_g(s,r,n[r]):hz(r)&&(s[r]=n[r]);else e[t]=n}function tCe(e,t){if(null==e)return t;const n={},i=[];function r(s){n[s.name]||(n[s.name]=1,i.push(s))}return t.forEach(r),e.forEach(r),i}function yt(e){return e[e.length-1]}function lr(e){return null==e||""===e?null:+e}const pz=e=>t=>e*Math.exp(t),gz=e=>t=>Math.log(e*t),mz=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),_z=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,$w=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function Vw(e,t,n,i){const r=n(e[0]),s=n(yt(e)),o=(s-r)*t;return[i(r-o),i(s-o)]}function yz(e,t){return Vw(e,t,lr,ar)}function vz(e,t){var n=Math.sign(e[0]);return Vw(e,t,gz(n),pz(n))}function bz(e,t,n){return Vw(e,t,$w(n),$w(1/n))}function wz(e,t,n){return Vw(e,t,mz(n),_z(n))}function Hw(e,t,n,i,r){const s=i(e[0]),o=i(yt(e)),a=null!=t?i(t):(s+o)/2;return[r(a+(s-a)*n),r(a+(o-a)*n)]}function XN(e,t,n){return Hw(e,t,n,lr,ar)}function QN(e,t,n){const i=Math.sign(e[0]);return Hw(e,t,n,gz(i),pz(i))}function Uw(e,t,n,i){return Hw(e,t,n,$w(i),$w(1/i))}function ZN(e,t,n,i){return Hw(e,t,n,mz(i),_z(i))}function Dz(e){return 1+~~(new Date(e).getMonth()/3)}function Cz(e){return 1+~~(new Date(e).getUTCMonth()/3)}function ve(e){return null!=e?Z(e)?e:[e]:[]}function Ez(e,t,n){let s,i=e[0],r=e[1];return r<i&&(s=r,r=i,i=s),s=r-i,s>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-s),i+s]}function Qe(e){return"function"==typeof e}function e2(e,t,n){n=n||{},t=ve(t)||[];const i=[],r=[],s={},o=n.comparator||iCe;return ve(e).forEach((a,l)=>{null!=a&&(i.push("descending"===t[l]?-1:1),r.push(a=Qe(a)?a:rs(a,null,n)),(or(a)||[]).forEach(u=>s[u]=1))}),0===r.length?null:is(o(r,i),Object.keys(s))}const zw=(e,t)=>(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t==t?-1:t!=t&&e==e?1:0),iCe=(e,t)=>1===e.length?rCe(e[0],t[0]):sCe(e,t,e.length),rCe=(e,t)=>function(n,i){return zw(e(n),e(i))*t},sCe=(e,t,n)=>(t.push(0),function(i,r){let s,o=0,a=-1;for(;0===o&&++a<n;)s=e[a],o=zw(s(i),s(r));return o*t[a]});function ur(e){return Qe(e)?e:()=>e}function t2(e,t){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(t(i),n=null),e)}}function Ze(e){for(let t,n,i=1,r=arguments.length;i<r;++i)for(n in t=arguments[i],t)e[n]=t[n];return e}function cl(e,t){let i,r,s,o,n=0;if(e&&(i=e.length))if(null==t){for(r=e[n];n<i&&(null==r||r!=r);r=e[++n]);for(s=o=r;n<i;++n)r=e[n],null!=r&&(r<s&&(s=r),r>o&&(o=r))}else{for(r=t(e[n]);n<i&&(null==r||r!=r);r=t(e[++n]));for(s=o=r;n<i;++n)r=t(e[n]),null!=r&&(r<s&&(s=r),r>o&&(o=r))}return[s,o]}function Sz(e,t){const n=e.length;let r,s,o,a,l,i=-1;if(null==t){for(;++i<n;)if(s=e[i],null!=s&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=l=i;++i<n;)s=e[i],null!=s&&(r>s&&(r=s,a=i),o<s&&(o=s,l=i))}else{for(;++i<n;)if(s=t(e[i],i,e),null!=s&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=l=i;++i<n;)s=t(e[i],i,e),null!=s&&(r>s&&(r=s,a=i),o<s&&(o=s,l=i))}return[a,l]}const oCe=Object.prototype.hasOwnProperty;function Oe(e,t){return oCe.call(e,t)}const Gw={};function yg(e){let n,t={};function i(s){return Oe(t,s)&&t[s]!==Gw}const r={size:0,empty:0,object:t,has:i,get:s=>i(s)?t[s]:void 0,set(s,o){return i(s)||(++r.size,t[s]===Gw&&--r.empty),t[s]=o,this},delete(s){return i(s)&&(--r.size,++r.empty,t[s]=Gw),this},clear(){r.size=r.empty=0,r.object=t={}},test(s){return arguments.length?(n=s,r):n},clean(){const s={};let o=0;for(const a in t){const l=t[a];l!==Gw&&(!n||!n(l))&&(s[a]=l,++o)}r.size=o,r.empty=0,r.object=t=s}};return e&&Object.keys(e).forEach(s=>{r.set(s,e[s])}),r}function xz(e,t,n,i,r,s){if(!n&&0!==n)return s;const o=+n;let u,a=e[0],l=yt(e);l<a&&(u=a,a=l,l=u),u=Math.abs(t-a);const c=Math.abs(l-t);return u<c&&u<=o?i:c<=o?r:s}function ce(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Ze(i,n)}function vg(e,t,n,i){let o,r=t[0],s=t[t.length-1];return r>s&&(o=r,r=s,s=o),i=void 0===i||i,((n=void 0===n||n)?r<=e:r<e)&&(i?e<=s:e<s)}function Fc(e){return"boolean"==typeof e}function Pc(e){return"[object Date]"===Object.prototype.toString.call(e)}function Az(e){return e&&Qe(e[Symbol.iterator])}function Xt(e){return"number"==typeof e}function Tz(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function _e(e){return"string"==typeof e}function n2(e,t,n){e&&(e=t?ve(e).map(a=>a.replace(/\\(.)/g,"$1")):ve(e));const i=e&&e.length,r=n&&n.get||uz,s=a=>r(t?[a]:ul(a));let o;if(i)if(1===i){const a=s(e[0]);o=function(l){return""+a(l)}}else{const a=e.map(s);o=function(l){let u=""+a[0](l),c=0;for(;++c<i;)u+="|"+a[c](l);return u}}else o=function(){return""};return is(o,e,"key")}function Oz(e,t){const n=e[0],i=yt(e),r=+t;return r?1===r?i:n+r*(i-n):n}function Mz(e){let t,n,i;e=+e||1e4;const r=()=>{t={},n={},i=0},s=(o,a)=>(++i>e&&(n=t,t={},i=1),t[o]=a);return r(),{clear:r,has:o=>Oe(t,o)||Oe(n,o),get:o=>Oe(t,o)?t[o]:Oe(n,o)?s(o,n[o]):void 0,set:(o,a)=>Oe(t,o)?t[o]=a:s(o,a)}}function Nz(e,t,n,i){const r=t.length,s=n.length;if(!s)return t;if(!r)return n;const o=i||new t.constructor(r+s);let a=0,l=0,u=0;for(;a<r&&l<s;++u)o[u]=e(t[a],n[l])>0?n[l++]:t[a++];for(;a<r;++a,++u)o[u]=t[a];for(;l<s;++l,++u)o[u]=n[l];return o}function k_(e,t){let n="";for(;--t>=0;)n+=e;return n}function kz(e,t,n,i){const r=n||" ",s=e+"",o=t-s.length;return o<=0?s:"left"===i?k_(r,o)+s:"center"===i?k_(r,~~(o/2))+s+k_(r,Math.ceil(o/2)):s+k_(r,o)}function I_(e){return e&&yt(e)-e[0]||0}function fe(e){return Z(e)?"["+e.map(fe)+"]":Ce(e)||_e(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function r2(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e||!e)}const lCe=e=>Xt(e)||Pc(e)?e:Date.parse(e);function s2(e,t){return t=t||lCe,null==e||""===e?null:t(e)}function o2(e){return null==e||""===e?null:e+""}function ua(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function Iz(e,t,n,i){const r=null!=i?i:"\u2026",s=e+"",o=s.length,a=Math.max(0,t-r.length);return o<=t?s:"left"===n?r+s.slice(o-a):"center"===n?s.slice(0,Math.ceil(a/2))+r+s.slice(o-~~(a/2)):s.slice(0,a)+r}function Lc(e,t,n){if(e)if(t){const i=e.length;for(let r=0;r<i;++r){const s=t(e[r]);s&&n(s,r,e)}}else e.forEach(n)}function Rz(e,t,n,i,r,s,o){try{var a=e[s](o),l=a.value}catch(u){return void n(u)}a.done?t(l):Promise.resolve(l).then(i,r)}function kr(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var s=e.apply(t,n);function o(l){Rz(s,i,r,o,a,"next",l)}function a(l){Rz(s,i,r,o,a,"throw",l)}o(void 0)})}}var Fz={},a2={};function Pz(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function Lz(e){var t=Object.create(null),n=[];return e.forEach(function(i){for(var r in i)r in t||n.push(t[r]=r)}),n}function ss(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function dCe(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(f,d){var _,h=[],p=f.length,g=0,m=0,y=p<=0,v=!1;function b(){if(y)return a2;if(v)return v=!1,Fz;var C,E,w=g;if(34===f.charCodeAt(w)){for(;g++<p&&34!==f.charCodeAt(g)||34===f.charCodeAt(++g););return(C=g)>=p?y=!0:10===(E=f.charCodeAt(g++))?v=!0:13===E&&(v=!0,10===f.charCodeAt(g)&&++g),f.slice(w+1,C-1).replace(/""/g,'"')}for(;g<p;){if(10===(E=f.charCodeAt(C=g++)))v=!0;else if(13===E)v=!0,10===f.charCodeAt(g)&&++g;else if(E!==n)continue;return f.slice(w,C)}return y=!0,f.slice(w,p)}for(10===f.charCodeAt(p-1)&&--p,13===f.charCodeAt(p-1)&&--p;(_=b())!==a2;){for(var D=[];_!==Fz&&_!==a2;)D.push(_),_=b();d&&null==(D=d(D,m++))||h.push(D)}return h}function s(f,d){return f.map(function(h){return d.map(function(p){return c(h[p])}).join(e)})}function u(f){return f.map(c).join(e)}function c(f){return null==f?"":f instanceof Date?function fCe(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":function cCe(e){return e<0?"-"+ss(-e,6):e>9999?"+"+ss(e,6):ss(e,4)}(e.getUTCFullYear())+"-"+ss(e.getUTCMonth()+1,2)+"-"+ss(e.getUTCDate(),2)+(r?"T"+ss(t,2)+":"+ss(n,2)+":"+ss(i,2)+"."+ss(r,3)+"Z":i?"T"+ss(t,2)+":"+ss(n,2)+":"+ss(i,2)+"Z":n||t?"T"+ss(t,2)+":"+ss(n,2)+"Z":"")}(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:function i(f,d){var h,p,g=r(f,function(m,_){if(h)return h(m,_-1);p=m,h=d?function uCe(e,t){var n=Pz(e);return function(i,r){return t(n(i),r,e)}}(m,d):Pz(m)});return g.columns=p||[],g},parseRows:r,format:function o(f,d){return null==d&&(d=Lz(f)),[d.map(c).join(e)].concat(s(f,d)).join("\n")},formatBody:function a(f,d){return null==d&&(d=Lz(f)),s(f,d).join("\n")},formatRows:function l(f){return f.map(u).join("\n")},formatRow:u,formatValue:c}}function pCe(e){return e}function mCe(e,t){return"string"==typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(n){return jz(e,n)})}:jz(e,t)}function jz(e,t){var n=t.id,i=t.bbox,r=null==t.properties?{}:t.properties,s=Bz(e,t);return null==n&&null==i?{type:"Feature",properties:r,geometry:s}:null==i?{type:"Feature",id:n,properties:r,geometry:s}:{type:"Feature",id:n,bbox:i,properties:r,geometry:s}}function Bz(e,t){var n=function gCe(e){if(null==e)return pCe;var t,n,i=e.scale[0],r=e.scale[1],s=e.translate[0],o=e.translate[1];return function(a,l){l||(t=n=0);var u=2,c=a.length,f=new Array(c);for(f[0]=(t+=a[0])*i+s,f[1]=(n+=a[1])*r+o;u<c;)f[u]=a[u],++u;return f}}(e.transform),i=e.arcs;function r(c,f){f.length&&f.pop();for(var d=i[c<0?~c:c],h=0,p=d.length;h<p;++h)f.push(n(d[h],h));c<0&&function hCe(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}(f,p)}function s(c){return n(c)}function o(c){for(var f=[],d=0,h=c.length;d<h;++d)r(c[d],f);return f.length<2&&f.push(f[0]),f}function a(c){for(var f=o(c);f.length<4;)f.push(f[0]);return f}function l(c){return c.map(a)}return function u(c){var d,f=c.type;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(u)};case"Point":d=s(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(s);break;case"LineString":d=o(c.arcs);break;case"MultiLineString":d=c.arcs.map(o);break;case"Polygon":d=l(c.arcs);break;case"MultiPolygon":d=c.arcs.map(l);break;default:return null}return{type:f,coordinates:d}}(t)}function _Ce(e,t){var n={},i={},r={},s=[],o=-1;function l(u,c){for(var f in u){var d=u[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),s.push(d)}}return t.forEach(function(u,c){var d,f=e.arcs[u<0?~u:u];f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++o],t[o]=u,t[c]=d)}),t.forEach(function(u){var h,p,c=function a(u){var d,c=e.arcs[u<0?~u:u],f=c[0];return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],u<0?[d,f]:[f,d]}(u),f=c[0],d=c[1];if(h=r[f])if(delete r[h.end],h.push(u),h.end=d,p=i[d]){delete i[p.start];var g=p===h?h:h.concat(p);i[g.start=h.start]=r[g.end=p.end]=g}else i[h.start]=r[h.end]=h;else if(h=i[d])if(delete i[h.start],h.unshift(u),h.start=f,p=r[f]){delete r[p.end];var m=p===h?h:p.concat(h);i[m.start=p.start]=r[m.end=h.end]=m}else i[h.start]=r[h.end]=h;else i[(h=[u]).start=f]=r[h.end=d]=h}),l(r,i),l(i,r),t.forEach(function(u){n[u<0?~u:u]||s.push([u])}),s}function yCe(e){return Bz(e,vCe.apply(this,arguments))}function vCe(e,t,n){var i,r,s;if(arguments.length>1)i=bCe(0,t,n);else for(r=0,i=new Array(s=e.arcs.length);r<s;++r)i[r]=r;return{type:"MultiLineString",arcs:_Ce(e,i)}}function bCe(e,t,n){var s,i=[],r=[];function o(f){var d=f<0?~f:f;(r[d]||(r[d]=[])).push({i:f,g:s})}function a(f){f.forEach(o)}function l(f){f.forEach(a)}return function c(f){switch(s=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":a(f.arcs);break;case"MultiLineString":case"Polygon":l(f.arcs);break;case"MultiPolygon":!function u(f){f.forEach(l)}(f.arcs)}}(t),r.forEach(null==n?function(f){i.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&i.push(f[0].i)}),i}var c2=Math.sqrt(50),f2=Math.sqrt(10),d2=Math.sqrt(2);function h2(e,t,n){var i,s,o,a,r=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((i=t<e)&&(s=e,e=t,t=s),0===(a=$z(e,t,n))||!isFinite(a))return[];if(a>0){let l=Math.round(e/a),u=Math.round(t/a);for(l*a<e&&++l,u*a>t&&--u,o=new Array(s=u-l+1);++r<s;)o[r]=(l+r)*a}else{a=-a;let l=Math.round(e*a),u=Math.round(t*a);for(l/a<e&&++l,u/a>t&&--u,o=new Array(s=u-l+1);++r<s;)o[r]=(l+r)/a}return i&&o.reverse(),o}function $z(e,t,n){var i=(t-e)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),s=i/Math.pow(10,r);return r>=0?(s>=c2?10:s>=f2?5:s>=d2?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(s>=c2?10:s>=f2?5:s>=d2?2:1)}function jc(e,t,n){var i=Math.abs(t-e)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),s=i/r;return s>=c2?r*=10:s>=f2?r*=5:s>=d2&&(r*=2),t<e?-r:r}var zz,wCe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Nd(e){if(!(t=wCe.exec(e)))throw new Error("invalid format: "+e);var t;return new p2({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function p2(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Ww(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function bg(e){return(e=Ww(Math.abs(e)))?e[1]:NaN}function Vz(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(bg(t)/3)))-bg(Math.abs(e)))}function Hz(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,bg(t)-bg(e))+1}function Uz(e){return Math.max(0,-bg(Math.abs(e)))}function Gz(e,t){var n=Ww(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}Nd.prototype=p2.prototype,p2.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Wz={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function DCe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Gz(100*e,t),r:Gz,s:function xCe(e,t){var n=Ww(e,t);if(!n)return e+"";var i=n[0],r=n[1],s=r-(zz=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+Ww(e,Math.max(0,t+s-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function qz(e){return e}var qw,Yw,g2,Yz=Array.prototype.map,Kz=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Jz(e){var t=void 0===e.grouping||void 0===e.thousands?qz:function CCe(e,t){return function(n,i){for(var r=n.length,s=[],o=0,a=e[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),s.push(n.substring(r-=a,r+a)),!((l+=a+1)>i));)a=e[o=(o+1)%e.length];return s.reverse().join(t)}}(Yz.call(e.grouping,Number),e.thousands+""),n=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",r=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?qz:function ECe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}(Yz.call(e.numerals,String)),o=void 0===e.percent?"%":e.percent+"",a=void 0===e.minus?"\u2212":e.minus+"",l=void 0===e.nan?"NaN":e.nan+"";function u(f){var d=(f=Nd(f)).fill,h=f.align,p=f.sign,g=f.symbol,m=f.zero,_=f.width,y=f.comma,v=f.precision,b=f.trim,D=f.type;"n"===D?(y=!0,D="g"):Wz[D]||(void 0===v&&(v=12),b=!0,D="g"),(m||"0"===d&&"="===h)&&(m=!0,d="0",h="=");var C="$"===g?n:"#"===g&&/[boxX]/.test(D)?"0"+D.toLowerCase():"",w="$"===g?i:/[%p]/.test(D)?o:"",E=Wz[D],O=/[defgprs%]/.test(D);function M(N){var A,x,S,R=C,P=w;if("c"===D)P=E(N)+P,N="";else{var k=(N=+N)<0||1/N<0;if(N=isNaN(N)?l:E(Math.abs(N),v),b&&(N=function SCe(e){e:for(var r,t=e.length,n=1,i=-1;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":0===i&&(i=n),r=n;break;default:if(!+e[n])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(r+1):e}(N)),k&&0==+N&&"+"!==p&&(k=!1),R=(k?"("===p?p:a:"-"===p||"("===p?"":p)+R,P=("s"===D?Kz[8+zz/3]:"")+P+(k&&"("===p?")":""),O)for(A=-1,x=N.length;++A<x;)if(48>(S=N.charCodeAt(A))||S>57){P=(46===S?r+N.slice(A+1):N.slice(A))+P,N=N.slice(0,A);break}}y&&!m&&(N=t(N,1/0));var T=R.length+N.length+P.length,F=T<_?new Array(_-T+1).join(d):"";switch(y&&m&&(N=t(F+N,F.length?_-P.length:1/0),F=""),h){case"<":N=R+N+P+F;break;case"=":N=R+F+N+P;break;case"^":N=F.slice(0,T=F.length>>1)+R+N+P+F.slice(T);break;default:N=F+R+N+P}return s(N)}return v=void 0===v?6:/[gprs]/.test(D)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),M.toString=function(){return f+""},M}return{format:u,formatPrefix:function c(f,d){var h=u(((f=Nd(f)).type="f",f)),p=3*Math.max(-8,Math.min(8,Math.floor(bg(d)/3))),g=Math.pow(10,-p),m=Kz[8+p/3];return function(_){return h(g*_)+m}}}}!function ACe(e){qw=Jz(e),Yw=qw.format,g2=qw.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});var m2=new Date,_2=new Date;function Mi(e,t,n,i){function r(s){return e(s=0===arguments.length?new Date:new Date(+s)),s}return r.floor=function(s){return e(s=new Date(+s)),s},r.ceil=function(s){return e(s=new Date(s-1)),t(s,1),e(s),s},r.round=function(s){var o=r(s),a=r.ceil(s);return s-o<a-s?o:a},r.offset=function(s,o){return t(s=new Date(+s),null==o?1:Math.floor(o)),s},r.range=function(s,o,a){var u,l=[];if(s=r.ceil(s),a=null==a?1:Math.floor(a),!(s<o&&a>0))return l;do{l.push(u=new Date(+s)),t(s,a),e(s)}while(u<s&&s<o);return l},r.filter=function(s){return Mi(function(o){if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},function(o,a){if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!s(o););else for(;--a>=0;)for(;t(o,1),!s(o););})},n&&(r.count=function(s,o){return m2.setTime(+s),_2.setTime(+o),e(m2),e(_2),Math.floor(n(m2,_2))},r.every=function(s){return s=Math.floor(s),isFinite(s)&&s>0?s>1?r.filter(i?function(o){return i(o)%s==0}:function(o){return r.count(0,o)%s==0}):r:null}),r}const Au=1e3,Eo=6e4,Tu=60*Eo,kd=24*Tu,y2=7*kd,Xz=30*kd,v2=365*kd;var Qz=Mi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Eo)/kd,e=>e.getDate()-1);const Bc=Qz;function Id(e){return Mi(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+7*n)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Eo)/y2})}var wg=Id(0),Kw=Id(1),Dg=(Id(2),Id(3),Id(4)),Zz=(Id(5),Id(6),Mi(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/kd},function(e){return e.getUTCDate()-1}));const $c=Zz;function Rd(e){return Mi(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+7*n)},function(t,n){return(n-t)/y2})}var Cg=Rd(0),Jw=Rd(1),Eg=(Rd(2),Rd(3),Rd(4)),b2=(Rd(5),Rd(6),Mi(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()}));b2.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Mi(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)}):null};const Vc=b2;var eG=Mi(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()});const Xw=eG;var tG=Mi(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Au-e.getMinutes()*Eo)},function(e,t){e.setTime(+e+t*Tu)},function(e,t){return(t-e)/Tu},function(e){return e.getHours()});const w2=tG;var nG=Mi(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Au)},function(e,t){e.setTime(+e+t*Eo)},function(e,t){return(t-e)/Eo},function(e){return e.getMinutes()});const D2=nG;var iG=Mi(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*Au)},function(e,t){return(t-e)/Au},function(e){return e.getUTCSeconds()});const Hc=iG;var Qw=Mi(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});Qw.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?Mi(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):Qw:null};const C2=Qw;var E2=Mi(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});E2.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Mi(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null};const Uc=E2;var rG=Mi(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()});const Zw=rG;var sG=Mi(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*Tu)},function(e,t){return(t-e)/Tu},function(e){return e.getUTCHours()});const S2=sG;var oG=Mi(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*Eo)},function(e,t){return(t-e)/Eo},function(e){return e.getUTCMinutes()});const x2=oG;function Ou(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function PCe(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function F_(e){let t,n,i;function r(a,l,u=0,c=a.length){if(u<c){if(0!==t(l,l))return c;do{const f=u+c>>>1;n(a[f],l)<0?u=f+1:c=f}while(u<c)}return u}return 2!==e.length?(t=Ou,n=(a,l)=>Ou(e(a),l),i=(a,l)=>e(a)-l):(t=e===Ou||e===PCe?e:LCe,n=e,i=e),{left:r,center:function o(a,l,u=0,c=a.length){const f=r(a,l,u,c-1);return f>u&&i(a[f-1],l)>-i(a[f],l)?f-1:f},right:function s(a,l,u=0,c=a.length){if(u<c){if(0!==t(l,l))return c;do{const f=u+c>>>1;n(a[f],l)<=0?u=f+1:c=f}while(u<c)}return u}}}function LCe(){return 0}const zi="year",os="quarter",cr="month",yi="week",as="date",fr="day",fl="dayofyear",Bs="hours",$s="minutes",So="seconds",ca="milliseconds",A2=[zi,os,cr,yi,as,fr,fl,Bs,$s,So,ca],T2=A2.reduce((e,t,n)=>(e[t]=1+n,e),{});function O2(e){const t=ve(e).slice(),n={};return t.length||Q("Missing time unit."),t.forEach(r=>{Oe(T2,r)?n[r]=1:Q("Invalid time unit: ".concat(r,"."))}),(n[yi]||n[fr]?1:0)+(n[os]||n[cr]||n[as]?1:0)+(n[fl]?1:0)>1&&Q("Incompatible time units: ".concat(e)),t.sort((r,s)=>T2[r]-T2[s]),t}const jCe={[zi]:"%Y ",[os]:"Q%q ",[cr]:"%b ",[as]:"%d ",[yi]:"W%U ",[fr]:"%a ",[fl]:"%j ",[Bs]:"%H:00",[$s]:"00:%M",[So]:":%S",[ca]:".%L",["".concat(zi,"-").concat(cr)]:"%Y-%m ",["".concat(zi,"-").concat(cr,"-").concat(as)]:"%Y-%m-%d ",["".concat(Bs,"-").concat($s)]:"%H:%M"};function aG(e,t){const n=Ze({},jCe,t),i=O2(e),r=i.length;let a,l,s="",o=0;for(o=0;o<r;)for(a=i.length;a>o;--a)if(l=i.slice(o,a).join("-"),null!=n[l]){s+=n[l],o=a;break}return s.trim()}const Fd=new Date;function M2(e){return Fd.setFullYear(e),Fd.setMonth(0),Fd.setDate(1),Fd.setHours(0,0,0,0),Fd}function lG(e){return cG(new Date(e))}function uG(e){return N2(new Date(e))}function cG(e){return Bc.count(M2(e.getFullYear())-1,e)}function N2(e){return wg.count(M2(e.getFullYear())-1,e)}function k2(e){return M2(e).getDay()}function BCe(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(-1,t,n,i,r,s,o);return a.setFullYear(e),a}return new Date(e,t,n,i,r,s,o)}function fG(e){return hG(new Date(e))}function dG(e){return I2(new Date(e))}function hG(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return $c.count(t-1,e)}function I2(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Cg.count(t-1,e)}function R2(e){return Fd.setTime(Date.UTC(e,0,1)),Fd.getUTCDay()}function $Ce(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(Date.UTC(-1,t,n,i,r,s,o));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,i,r,s,o))}function pG(e,t,n,i,r){const s=t||1,o=yt(e),a=(_,y,v)=>function VCe(e,t,n,i){const r=n<=1?e:i?(s,o)=>i+n*Math.floor((e(s,o)-i)/n):(s,o)=>n*Math.floor(e(s,o)/n);return t?(s,o)=>t(r(s,o),o):r}(n[v=v||_],i[v],_===o&&s,y),l=new Date,u=ua(e),c=u[zi]?a(zi):ur(2012),f=u[cr]?a(cr):u[os]?a(os):Ic,d=u[yi]&&u[fr]?a(fr,1,yi+fr):u[yi]?a(yi,1):u[fr]?a(fr,1):u[as]?a(as,1):u[fl]?a(fl,1):gg,h=u[Bs]?a(Bs):Ic,p=u[$s]?a($s):Ic,g=u[So]?a(So):Ic,m=u[ca]?a(ca):Ic;return function(_){l.setTime(+_);const y=c(l);return r(y,f(l),d(l,y),h(l),p(l),g(l),m(l))}}function Sg(e,t,n){return t+7*e-(n+6)%7}const HCe={[zi]:e=>e.getFullYear(),[os]:e=>Math.floor(e.getMonth()/3),[cr]:e=>e.getMonth(),[as]:e=>e.getDate(),[Bs]:e=>e.getHours(),[$s]:e=>e.getMinutes(),[So]:e=>e.getSeconds(),[ca]:e=>e.getMilliseconds(),[fl]:e=>cG(e),[yi]:e=>N2(e),[yi+fr]:(e,t)=>Sg(N2(e),e.getDay(),k2(t)),[fr]:(e,t)=>Sg(1,e.getDay(),k2(t))},UCe={[os]:e=>3*e,[yi]:(e,t)=>Sg(e,0,k2(t))};function gG(e,t){return pG(e,t||1,HCe,UCe,BCe)}const zCe={[zi]:e=>e.getUTCFullYear(),[os]:e=>Math.floor(e.getUTCMonth()/3),[cr]:e=>e.getUTCMonth(),[as]:e=>e.getUTCDate(),[Bs]:e=>e.getUTCHours(),[$s]:e=>e.getUTCMinutes(),[So]:e=>e.getUTCSeconds(),[ca]:e=>e.getUTCMilliseconds(),[fl]:e=>hG(e),[yi]:e=>I2(e),[fr]:(e,t)=>Sg(1,e.getUTCDay(),R2(t)),[yi+fr]:(e,t)=>Sg(I2(e),e.getUTCDay(),R2(t))},GCe={[os]:e=>3*e,[yi]:(e,t)=>Sg(e,0,R2(t))};function mG(e,t){return pG(e,t||1,zCe,GCe,$Ce)}const WCe={[zi]:Vc,[os]:Xw.every(3),[cr]:Xw,[yi]:wg,[as]:Bc,[fr]:Bc,[fl]:Bc,[Bs]:w2,[$s]:D2,[So]:Hc,[ca]:C2},qCe={[zi]:Uc,[os]:Zw.every(3),[cr]:Zw,[yi]:Cg,[as]:$c,[fr]:$c,[fl]:$c,[Bs]:S2,[$s]:x2,[So]:Hc,[ca]:C2};function xg(e){return WCe[e]}function Ag(e){return qCe[e]}function _G(e,t,n){return e?e.offset(t,n):void 0}function yG(e,t,n){return _G(xg(e),t,n)}function vG(e,t,n){return _G(Ag(e),t,n)}function bG(e,t,n,i){return e?e.range(t,n,i):void 0}function wG(e,t,n,i){return bG(xg(e),t,n,i)}function DG(e,t,n,i){return bG(Ag(e),t,n,i)}const L_=6e4,j_=60*L_,eD=24*j_,CG=30*eD,F2=365*eD,EG=[zi,cr,as,Bs,$s,So,ca],B_=EG.slice(0,-1),$_=B_.slice(0,-1),V_=$_.slice(0,-1),KCe=V_.slice(0,-1),SG=[zi,cr],xG=[zi],H_=[[B_,1,1e3],[B_,5,5e3],[B_,15,15e3],[B_,30,3e4],[$_,1,L_],[$_,5,5*L_],[$_,15,15*L_],[$_,30,30*L_],[V_,1,j_],[V_,3,3*j_],[V_,6,6*j_],[V_,12,12*j_],[KCe,1,eD],[[zi,yi],1,6048e5],[SG,1,CG],[SG,3,3*CG],[xG,1,F2]];function AG(e){const t=e.extent,n=e.maxbins||40,i=Math.abs(I_(t))/n;let s,o,r=F_(a=>a[2]).right(H_,i);return r===H_.length?(s=xG,o=jc(t[0]/F2,t[1]/F2,n)):r?(r=H_[i/H_[r-1][2]<H_[r][2]/i?r-1:r],s=r[0],o=r[1]):(s=EG,o=Math.max(jc(t[0],t[1],n),1)),{units:s,step:o}}function P2(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function L2(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function U_(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function TG(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,s=e.days,o=e.shortDays,a=e.months,l=e.shortMonths,u=z_(r),c=G_(r),f=z_(s),d=G_(s),h=z_(o),p=G_(o),g=z_(a),m=G_(a),_=z_(l),y=G_(l),v={a:function k(G){return o[G.getDay()]},A:function T(G){return s[G.getDay()]},b:function F(G){return l[G.getMonth()]},B:function I(G){return a[G.getMonth()]},c:null,d:RG,e:RG,f:vEe,g:OEe,G:NEe,H:mEe,I:_Ee,j:yEe,L:FG,m:bEe,M:wEe,p:function j(G){return r[+(G.getHours()>=12)]},q:function V(G){return 1+~~(G.getMonth()/3)},Q:VG,s:HG,S:DEe,u:CEe,U:EEe,V:SEe,w:xEe,W:AEe,x:null,X:null,y:TEe,Y:MEe,Z:kEe,"%":$G},b={a:function U(G){return o[G.getUTCDay()]},A:function L(G){return s[G.getUTCDay()]},b:function W(G){return l[G.getUTCMonth()]},B:function te(G){return a[G.getUTCMonth()]},c:null,d:LG,e:LG,f:PEe,g:WEe,G:YEe,H:IEe,I:REe,j:FEe,L:jG,m:LEe,M:jEe,p:function q(G){return r[+(G.getUTCHours()>=12)]},q:function se(G){return 1+~~(G.getUTCMonth()/3)},Q:VG,s:HG,S:BEe,u:$Ee,U:VEe,V:HEe,w:UEe,W:zEe,x:null,X:null,y:GEe,Y:qEe,Z:KEe,"%":$G},D={a:function M(G,X,ee){var z=h.exec(X.slice(ee));return z?(G.w=p.get(z[0].toLowerCase()),ee+z[0].length):-1},A:function N(G,X,ee){var z=f.exec(X.slice(ee));return z?(G.w=d.get(z[0].toLowerCase()),ee+z[0].length):-1},b:function R(G,X,ee){var z=_.exec(X.slice(ee));return z?(G.m=y.get(z[0].toLowerCase()),ee+z[0].length):-1},B:function P(G,X,ee){var z=g.exec(X.slice(ee));return z?(G.m=m.get(z[0].toLowerCase()),ee+z[0].length):-1},c:function A(G,X,ee){return E(G,t,X,ee)},d:kG,e:kG,f:dEe,g:NG,G:MG,H:IG,I:IG,j:lEe,L:fEe,m:aEe,M:uEe,p:function O(G,X,ee){var z=u.exec(X.slice(ee));return z?(G.p=c.get(z[0].toLowerCase()),ee+z[0].length):-1},q:oEe,Q:pEe,s:gEe,S:cEe,u:tEe,U:nEe,V:iEe,w:eEe,W:rEe,x:function x(G,X,ee){return E(G,n,X,ee)},X:function S(G,X,ee){return E(G,i,X,ee)},y:NG,Y:MG,Z:sEe,"%":hEe};function C(G,X){return function(ee){var De,Ae,at,z=[],de=-1,ye=0,ke=G.length;for(ee instanceof Date||(ee=new Date(+ee));++de<ke;)37===G.charCodeAt(de)&&(z.push(G.slice(ye,de)),null!=(Ae=OG[De=G.charAt(++de)])?De=G.charAt(++de):Ae="e"===De?" ":"0",(at=X[De])&&(De=at(ee,Ae)),z.push(De),ye=de+1);return z.push(G.slice(ye,de)),z.join("")}}function w(G,X){return function(ee){var ye,ke,z=U_(1900,void 0,1);if(E(z,G,ee+="",0)!=ee.length)return null;if("Q"in z)return new Date(z.Q);if("s"in z)return new Date(1e3*z.s+("L"in z?z.L:0));if(X&&!("Z"in z)&&(z.Z=0),"p"in z&&(z.H=z.H%12+12*z.p),void 0===z.m&&(z.m="q"in z?z.q:0),"V"in z){if(z.V<1||z.V>53)return null;"w"in z||(z.w=1),"Z"in z?(ke=(ye=L2(U_(z.y,0,1))).getUTCDay(),ye=ke>4||0===ke?Jw.ceil(ye):Jw(ye),ye=$c.offset(ye,7*(z.V-1)),z.y=ye.getUTCFullYear(),z.m=ye.getUTCMonth(),z.d=ye.getUTCDate()+(z.w+6)%7):(ke=(ye=P2(U_(z.y,0,1))).getDay(),ye=ke>4||0===ke?Kw.ceil(ye):Kw(ye),ye=Bc.offset(ye,7*(z.V-1)),z.y=ye.getFullYear(),z.m=ye.getMonth(),z.d=ye.getDate()+(z.w+6)%7)}else("W"in z||"U"in z)&&("w"in z||(z.w="u"in z?z.u%7:"W"in z?1:0),ke="Z"in z?L2(U_(z.y,0,1)).getUTCDay():P2(U_(z.y,0,1)).getDay(),z.m=0,z.d="W"in z?(z.w+6)%7+7*z.W-(ke+5)%7:z.w+7*z.U-(ke+6)%7);return"Z"in z?(z.H+=z.Z/100|0,z.M+=z.Z%100,L2(z)):P2(z)}}function E(G,X,ee,z){for(var De,Ae,de=0,ye=X.length,ke=ee.length;de<ye;){if(z>=ke)return-1;if(37===(De=X.charCodeAt(de++))){if(De=X.charAt(de++),!(Ae=D[De in OG?X.charAt(de++):De])||(z=Ae(G,ee,z))<0)return-1}else if(De!=ee.charCodeAt(z++))return-1}return z}return v.x=C(n,v),v.X=C(i,v),v.c=C(t,v),b.x=C(n,b),b.X=C(i,b),b.c=C(t,b),{format:function(G){var X=C(G+="",v);return X.toString=function(){return G},X},parse:function(G){var X=w(G+="",!1);return X.toString=function(){return G},X},utcFormat:function(G){var X=C(G+="",b);return X.toString=function(){return G},X},utcParse:function(G){var X=w(G+="",!0);return X.toString=function(){return G},X}}}var Tg,j2,UG,B2,zG,OG={"-":"",_:" ",0:"0"},Ni=/^\s*\d+/,XCe=/^%/,QCe=/[\\^$*+?|[\]().{}]/g;function Nt(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(t)+r:r)}function ZCe(e){return e.replace(QCe,"\\$&")}function z_(e){return new RegExp("^(?:"+e.map(ZCe).join("|")+")","i")}function G_(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function eEe(e,t,n){var i=Ni.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function tEe(e,t,n){var i=Ni.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function nEe(e,t,n){var i=Ni.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function iEe(e,t,n){var i=Ni.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function rEe(e,t,n){var i=Ni.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function MG(e,t,n){var i=Ni.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function NG(e,t,n){var i=Ni.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function sEe(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function oEe(e,t,n){var i=Ni.exec(t.slice(n,n+1));return i?(e.q=3*i[0]-3,n+i[0].length):-1}function aEe(e,t,n){var i=Ni.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function kG(e,t,n){var i=Ni.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function lEe(e,t,n){var i=Ni.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function IG(e,t,n){var i=Ni.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function uEe(e,t,n){var i=Ni.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function cEe(e,t,n){var i=Ni.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function fEe(e,t,n){var i=Ni.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function dEe(e,t,n){var i=Ni.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function hEe(e,t,n){var i=XCe.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function pEe(e,t,n){var i=Ni.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function gEe(e,t,n){var i=Ni.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function RG(e,t){return Nt(e.getDate(),t,2)}function mEe(e,t){return Nt(e.getHours(),t,2)}function _Ee(e,t){return Nt(e.getHours()%12||12,t,2)}function yEe(e,t){return Nt(1+Bc.count(Vc(e),e),t,3)}function FG(e,t){return Nt(e.getMilliseconds(),t,3)}function vEe(e,t){return FG(e,t)+"000"}function bEe(e,t){return Nt(e.getMonth()+1,t,2)}function wEe(e,t){return Nt(e.getMinutes(),t,2)}function DEe(e,t){return Nt(e.getSeconds(),t,2)}function CEe(e){var t=e.getDay();return 0===t?7:t}function EEe(e,t){return Nt(wg.count(Vc(e)-1,e),t,2)}function PG(e){var t=e.getDay();return t>=4||0===t?Dg(e):Dg.ceil(e)}function SEe(e,t){return e=PG(e),Nt(Dg.count(Vc(e),e)+(4===Vc(e).getDay()),t,2)}function xEe(e){return e.getDay()}function AEe(e,t){return Nt(Kw.count(Vc(e)-1,e),t,2)}function TEe(e,t){return Nt(e.getFullYear()%100,t,2)}function OEe(e,t){return Nt((e=PG(e)).getFullYear()%100,t,2)}function MEe(e,t){return Nt(e.getFullYear()%1e4,t,4)}function NEe(e,t){var n=e.getDay();return Nt((e=n>=4||0===n?Dg(e):Dg.ceil(e)).getFullYear()%1e4,t,4)}function kEe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Nt(t/60|0,"0",2)+Nt(t%60,"0",2)}function LG(e,t){return Nt(e.getUTCDate(),t,2)}function IEe(e,t){return Nt(e.getUTCHours(),t,2)}function REe(e,t){return Nt(e.getUTCHours()%12||12,t,2)}function FEe(e,t){return Nt(1+$c.count(Uc(e),e),t,3)}function jG(e,t){return Nt(e.getUTCMilliseconds(),t,3)}function PEe(e,t){return jG(e,t)+"000"}function LEe(e,t){return Nt(e.getUTCMonth()+1,t,2)}function jEe(e,t){return Nt(e.getUTCMinutes(),t,2)}function BEe(e,t){return Nt(e.getUTCSeconds(),t,2)}function $Ee(e){var t=e.getUTCDay();return 0===t?7:t}function VEe(e,t){return Nt(Cg.count(Uc(e)-1,e),t,2)}function BG(e){var t=e.getUTCDay();return t>=4||0===t?Eg(e):Eg.ceil(e)}function HEe(e,t){return e=BG(e),Nt(Eg.count(Uc(e),e)+(4===Uc(e).getUTCDay()),t,2)}function UEe(e){return e.getUTCDay()}function zEe(e,t){return Nt(Jw.count(Uc(e)-1,e),t,2)}function GEe(e,t){return Nt(e.getUTCFullYear()%100,t,2)}function WEe(e,t){return Nt((e=BG(e)).getUTCFullYear()%100,t,2)}function qEe(e,t){return Nt(e.getUTCFullYear()%1e4,t,4)}function YEe(e,t){var n=e.getUTCDay();return Nt((e=n>=4||0===n?Eg(e):Eg.ceil(e)).getUTCFullYear()%1e4,t,4)}function KEe(){return"+0000"}function $G(){return"%"}function VG(e){return+e}function HG(e){return Math.floor(+e/1e3)}function W_(e){const t={};return n=>t[n]||(t[n]=e(n))}function GG(e){const t=W_(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(i){const r=Nd(i||",");if(null==r.precision){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1}return function XEe(e,t){return n=>{const i=e(n),r=i.indexOf(t);if(r<0)return i;let s=function QEe(e,t){let i,n=e.lastIndexOf("e");if(n>0)return n;for(n=e.length;--n>t;)if(i=e.charCodeAt(n),i>=48&&i<=57)return n+1}(i,r);const o=s<i.length?i.slice(s):"";for(;--s>r;)if("0"!==i[s]){++s;break}return i.slice(0,s)+o}}(t(r),t(".1f")(1)[1])}return t(r)},formatSpan(i,r,s,o){o=Nd(null==o?",f":o);const a=jc(i,r,s),l=Math.max(Math.abs(i),Math.abs(r));let u;if(null==o.precision)switch(o.type){case"s":return isNaN(u=Vz(a,l))||(o.precision=u),n(o,l);case"":case"e":case"g":case"p":case"r":isNaN(u=Hz(a,l))||(o.precision=u-("e"===o.type));break;case"f":case"%":isNaN(u=Uz(a))||(o.precision=u-2*("%"===o.type))}return t(o)}}}let $2,V2;function WG(){return $2=GG({format:Yw,formatPrefix:g2})}function qG(e){return GG(Jz(e))}function tD(e){return arguments.length?$2=qG(e):$2}function YG(e,t,n){Ce(n=n||{})||Q("Invalid time multi-format specifier: ".concat(n));const i=t(So),r=t($s),s=t(Bs),o=t(as),a=t(yi),l=t(cr),u=t(os),c=t(zi),f=e(n[ca]||".%L"),d=e(n[So]||":%S"),h=e(n[$s]||"%I:%M"),p=e(n[Bs]||"%I %p"),g=e(n[as]||n[fr]||"%a %d"),m=e(n[yi]||"%b %d"),_=e(n[cr]||"%B"),y=e(n[os]||"%B"),v=e(n[zi]||"%Y");return b=>(i(b)<b?f:r(b)<b?d:s(b)<b?h:o(b)<b?p:l(b)<b?a(b)<b?g:m:c(b)<b?u(b)<b?_:y:v)(b)}function KG(e){const t=W_(e.format),n=W_(e.utcFormat);return{timeFormat:i=>_e(i)?t(i):YG(t,xg,i),utcFormat:i=>_e(i)?n(i):YG(n,Ag,i),timeParse:W_(e.parse),utcParse:W_(e.utcParse)}}function JG(){return V2=KG({format:j2,parse:UG,utcFormat:B2,utcParse:zG})}function XG(e){return KG(TG(e))}function q_(e){return arguments.length?V2=XG(e):V2}!function JEe(e){Tg=TG(e),j2=Tg.format,UG=Tg.parse,B2=Tg.utcFormat,zG=Tg.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),WG(),JG();const H2=(e,t)=>Ze({},e,t);function QG(e,t){const n=e?qG(e):tD(),i=t?XG(t):q_();return H2(n,i)}function U2(e,t){const n=arguments.length;return n&&2!==n&&Q("defaultLocale expects either zero or two arguments."),n?H2(tD(e),q_(t)):H2(tD(),q_())}function ZEe(){return WG(),JG(),U2()}const eSe=/^(data:|([A-Za-z]+:)?\/\/)/,tSe=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,nSe=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,ZG="file://";function rSe(e,t){return z2.apply(this,arguments)}function z2(){return z2=kr(function*(e,t){const n=yield this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}),z2.apply(this,arguments)}function sSe(e,t){return G2.apply(this,arguments)}function G2(){return G2=kr(function*(e,t){t=Ze({},this.options,t);const n=this.fileAccess,i={href:null};let r,s,o;const a=tSe.test(e.replace(nSe,""));(null==e||"string"!=typeof e||!a)&&Q("Sanitize failure, invalid URI: "+fe(e));const l=eSe.test(e);return(o=t.baseURL)&&!l&&(!e.startsWith("/")&&!o.endsWith("/")&&(e="/"+e),e=o+e),s=(r=e.startsWith(ZG))||"file"===t.mode||"http"!==t.mode&&!l&&n,r?e=e.slice(ZG.length):e.startsWith("//")&&("file"===t.defaultProtocol?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!s}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),"image"===t.context&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}),G2.apply(this,arguments)}function oSe(e){return e?t=>new Promise((n,i)=>{e.readFile(t,(r,s)=>{r?i(r):n(s)})}):aSe}function aSe(){return W2.apply(this,arguments)}function W2(){return(W2=kr(function*(){Q("No file system access.")})).apply(this,arguments)}function lSe(e){return e?function(){var t=kr(function*(n,i){const r=Ze({},this.options.http,i),s=i&&i.response,o=yield e(n,r);return o.ok?Qe(o[s])?o[s]():o.text():Q(o.status+""+o.statusText)});return function(n,i){return t.apply(this,arguments)}}():uSe}function uSe(){return q2.apply(this,arguments)}function q2(){return(q2=kr(function*(){Q("No HTTP fetch method available.")})).apply(this,arguments)}const cSe=e=>null!=e&&e==e,eW=e=>!(Number.isNaN(+e)||e instanceof Date),Y2={boolean:r2,integer:lr,number:lr,date:s2,string:o2,unknown:ar},nD=[e=>"true"===e||"false"===e||!0===e||!1===e,e=>eW(e)&&Number.isInteger(+e),eW,e=>!Number.isNaN(Date.parse(e))],pSe=["boolean","integer","number","date"];function tW(e,t){if(!e||!e.length)return"unknown";const n=e.length,i=nD.length,r=nD.map((s,o)=>o+1);for(let a,l,s=0,o=0;s<n;++s)for(l=t?e[s][t]:e[s],a=0;a<i;++a)if(r[a]&&cSe(l)&&!nD[a](l)&&(r[a]=0,++o,o===nD.length))return"string";return pSe[r.reduce((s,o)=>0===s?o:s,0)-1]}function nW(e,t){return t.reduce((n,i)=>(n[i]=tW(e,i),n),{})}function iW(e){const t=function(n,i){const r={delimiter:e};return K2(n,i?Ze(i,r):r)};return t.responseType="text",t}function K2(e,t){return t.header&&(e=t.header.map(fe).join(t.delimiter)+"\n"+e),dCe(t.delimiter).parse(e+"")}function J2(e,t){const n=t&&t.property?rs(t.property):ar;return Ce(e)&&!function gSe(e){return!("function"!=typeof Buffer||!Qe(Buffer.isBuffer))&&Buffer.isBuffer(e)}(e)?function mSe(e,t){return!Z(e)&&Az(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}(n(e),t):n(JSON.parse(e))}K2.responseType="text",J2.responseType="json";const _Se={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function rW(e,t){let n,i,r,s;return e=J2(e,t),t&&t.feature?(n=mCe,r=t.feature):t&&t.mesh?(n=yCe,r=t.mesh,s=_Se[t.filter]):Q("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,s):Q("Invalid TopoJSON object: "+r),i&&i.features||[i]}rW.responseType="json";const iD={dsv:K2,csv:iW(","),tsv:iW("\t"),json:J2,topojson:rW};function X2(e,t){return arguments.length>1?(iD[e]=t,this):Oe(iD,e)?iD[e]:null}function sW(e){const t=X2(e);return t&&t.responseType||"text"}function oW(e,t,n,i){const r=X2((t=t||{}).type||"json");return r||Q("Unknown data format type: "+t.type),e=r(e,t),t.parse&&function ySe(e,t,n,i){if(!e.length)return;const r=q_();n=n||r.timeParse,i=i||r.utcParse;let o,a,l,u,c,f,s=e.columns||Object.keys(e[0]);"auto"===t&&(t=nW(e,s)),s=Object.keys(t);const d=s.map(h=>{const p=t[h];let g,m;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),m=g[1],("'"===m[0]&&"'"===m[m.length-1]||'"'===m[0]&&'"'===m[m.length-1])&&(m=m.slice(1,-1)),("utc"===g[0]?i:n)(m);if(!Y2[p])throw Error("Illegal format pattern: "+h+":"+p);return Y2[p]});for(l=0,c=e.length,f=s.length;l<c;++l)for(o=e[l],u=0;u<f;++u)a=s[u],o[a]=d[u](o[a])}(e,t.parse,n,i),Oe(e,"columns")&&delete e.columns,e}const rD=function iSe(e,t){return n=>({options:n||{},sanitize:sSe,load:rSe,fileAccess:!!t,file:oSe(t),http:lSe(e)})}("undefined"!=typeof fetch&&fetch,null);function sD(e){const t=e||ar,n=[],i={};return n.add=r=>{const s=t(r);return i[s]||(i[s]=1,n.push(r)),n},n.remove=r=>{const s=t(r);if(i[s]){i[s]=0;const o=n.indexOf(r);o>=0&&n.splice(o,1)}return n},n}function oD(e,t){return Q2.apply(this,arguments)}function Q2(){return Q2=kr(function*(e,t){try{yield t(e)}catch(n){e.error(n)}}),Q2.apply(this,arguments)}const aW=Symbol("vega_id");let vSe=1;function aD(e){return!(!e||!Ie(e))}function Ie(e){return e[aW]}function lW(e,t){return e[aW]=t,e}function jt(e){const t=e===Object(e)?e:{data:e};return Ie(t)?t:lW(t,vSe++)}function Z2(e){return lD(e,jt({}))}function lD(e,t){for(const n in e)t[n]=e[n];return t}function uW(e,t){return lW(t,Ie(e))}function Pd(e,t){return e?t?(n,i)=>e(n,i)||Ie(t(n))-Ie(t(i)):(n,i)=>e(n,i)||Ie(n)-Ie(i):null}function cW(e){return e&&e.constructor===Ld}function Ld(){const e=[],t=[],n=[],i=[],r=[];let s=null,o=!1;return{constructor:Ld,insert(a){const l=ve(a),u=l.length;for(let c=0;c<u;++c)e.push(l[c]);return this},remove(a){const l=Qe(a)?i:t,u=ve(a),c=u.length;for(let f=0;f<c;++f)l.push(u[f]);return this},modify(a,l,u){const c={field:l,value:ur(u)};return Qe(a)?(c.filter=a,r.push(c)):(c.tuple=a,n.push(c)),this},encode(a,l){return Qe(a)?r.push({filter:a,field:l}):n.push({tuple:a,field:l}),this},clean(a){return s=a,this},reflow(){return o=!0,this},pulse(a,l){const u={},c={};let f,d,h,p,g,m;for(f=0,d=l.length;f<d;++f)u[Ie(l[f])]=1;for(f=0,d=t.length;f<d;++f)g=t[f],u[Ie(g)]=-1;for(f=0,d=i.length;f<d;++f)p=i[f],l.forEach(y=>{p(y)&&(u[Ie(y)]=-1)});for(f=0,d=e.length;f<d;++f)g=e[f],m=Ie(g),u[m]?u[m]=1:a.add.push(jt(e[f]));for(f=0,d=l.length;f<d;++f)g=l[f],u[Ie(g)]<0&&a.rem.push(g);function _(y,v,b){b?y[v]=b(y):a.encode=v,o||(c[Ie(y)]=y)}for(f=0,d=n.length;f<d;++f)h=n[f],g=h.tuple,p=h.field,m=u[Ie(g)],m>0&&(_(g,p,h.value),a.modifies(p));for(f=0,d=r.length;f<d;++f)h=r[f],p=h.filter,l.forEach(y=>{p(y)&&u[Ie(y)]>0&&_(y,h.field,h.value)}),a.modifies(h.field);if(o)a.mod=t.length||i.length?l.filter(y=>u[Ie(y)]>0):l.slice();else for(m in c)a.mod.push(c[m]);return(s||null==s&&(t.length||i.length))&&a.clean(!0),a}}}const uD="_:mod:_";function cD(){Object.defineProperty(this,uD,{writable:!0,value:{}})}cD.prototype={set(e,t,n,i){const r=this,s=r[e],o=r[uD];return null!=t&&t>=0?(s[t]!==n||i)&&(s[t]=n,o[t+":"+e]=-1,o[e]=-1):(s!==n||i)&&(r[e]=n,o[e]=Z(n)?1+n.length:-1),r},modified(e,t){const n=this[uD];if(!arguments.length){for(const i in n)if(n[i])return!0;return!1}if(Z(e)){for(let i=0;i<e.length;++i)if(n[e[i]])return!0;return!1}return null!=t&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[uD]={},this}};let bSe=0;const DSe=new cD;function un(e,t,n,i){this.id=++bSe,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,i)}function fW(e){return function(t){const n=this.flags;return 0===arguments.length?!!(n&e):(this.flags=t?n|e:n&~e,this)}}un.prototype={targets(){return this._targets||(this._targets=sD(N_))},set(e){return this.value!==e?(this.value=e,1):0},skip:fW(1),modified:fW(2),parameters(e,t,n){t=!1!==t;const i=this._argval=this._argval||new cD,r=this._argops=this._argops||[],s=[];let o,a,l,u;const c=(f,d,h)=>{h instanceof un?(h!==this&&(t&&h.targets().add(this),s.push(h)),r.push({op:h,name:f,index:d})):i.set(f,d,h)};for(o in e)if(a=e[o],"pulse"===o)ve(a).forEach(f=>{f instanceof un?f!==this&&(f.targets().add(this),s.push(f)):Q("Pulse parameters must be operator instances.")}),this.source=a;else if(Z(a))for(i.set(o,-1,Array(l=a.length)),u=0;u<l;++u)c(o,u,a[u]);else c(o,-1,a);return this.marshall().clear(),n&&(r.initonly=!0),s},marshall(e){const t=this._argval||DSe,n=this._argops;let i,r,s,o;if(n){const a=n.length;for(r=0;r<a;++r)i=n[r],s=i.op,o=s.modified()&&s.stamp===e,t.set(i.name,i.index,s.value,o);if(n.initonly){for(r=0;r<a;++r)i=n[r],i.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,i,r;if(e)for(t=0,n=e.length;t<n;++t)i=e[t],r=i.op,r._targets&&r._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),i=t.call(this,n,e);if(n.clear(),i!==this.value)this.value=i;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};let ASe=0;function fD(e,t,n){this.id=++ASe,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function zc(e,t,n){return new fD(e,t,n)}function ek(){return ek=kr(function*(e,t){const n=this;let r,i=0;try{r=yield n.loader().load(e,{context:"dataflow",response:sW(t&&t.type)});try{r=n.parse(r,t)}catch(s){i=-2,n.warn("Data ingestion failed",e,s)}}catch(s){i=-1,n.warn("Loading failed",e,s)}return{data:r,status:i}}),ek.apply(this,arguments)}function tk(){return tk=kr(function*(e,t,n){const i=this,r=i._pending||ISe(i);r.requests+=1;const s=yield i.request(t,n);return i.pulse(e,i.changeset().remove(Co).insert(s.data||[])),r.done(),s}),tk.apply(this,arguments)}function ISe(e){let t;const n=new Promise(i=>t=i);return n.requests=0,n.done=()=>{0==--n.requests&&(e._pending=null,t(e))},e._pending=n}fD.prototype={_filter:Co,_apply:ar,targets(){return this._targets||(this._targets=sD(N_))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,i=n?n.length:0;for(let r=0;r<i;++r)n[r].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=zc(e);return this.targets().add(t),t},apply(e){const t=zc(null,e);return this.targets().add(t),t},merge(){const e=zc();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=zc();return this.targets().add(zc(null,null,t2(e,n=>{const i=n.dataflow;t.receive(n),i&&i.run&&i.run()}))),t},between(e,t){let n=!1;return e.targets().add(zc(null,null,()=>n=!0)),t.targets().add(zc(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=Co,this._targets=null}};const RSe={skip:!0};function PSe(e,t,n,i,r,s){const o=Ze({},s,RSe);let a,l;Qe(n)||(n=ur(n)),void 0===i?a=u=>e.touch(n(u)):Qe(i)?(l=new un(null,i,r,!1),a=u=>{l.evaluate(u);const c=n(u),f=l.value;cW(f)?e.pulse(c,f,s):e.update(c,f,o)}):a=u=>e.update(n(u),i,o),t.apply(a)}function LSe(e,t,n,i,r,s){if(void 0===i)t.targets().add(n);else{const o=s||{},a=new un(null,function jSe(e,t){return t=Qe(t)?t:ur(t),e?function(n,i){const r=t(n,i);return e.skip()||(e.skip(r!==this.value).value=r),r}:t}(n,i),r,!1);a.modified(o.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}const dD={};function Wc(e,t,n){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function nk(e,t){const n=[];return Lc(e,t,i=>n.push(i)),n}function mW(e,t){const n={};return e.visit(t,i=>{n[Ie(i)]=1}),i=>n[Ie(i)]?null:i}function hD(e,t){return e?(n,i)=>e(n,i)&&t(n,i):t}function ik(e,t,n,i){const r=this,s=n.length;let o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=i||null,this.pulses=n;for(let a=0;a<s;++a){const l=n[a];if(l.stamp===t){if(l.fields){const u=r.fields||(r.fields={});for(const c in l.fields)u[c]=1}l.changed(r.ADD)&&(o|=r.ADD),l.changed(r.REM)&&(o|=r.REM),l.changed(r.MOD)&&(o|=r.MOD)}}this.changes=o}function rk(){return rk=kr(function*(e,t,n){const i=this,r=[];if(i._pulse)return _W(i);if(i._pending&&(yield i._pending),t&&(yield oD(i,t)),!i._touched.length)return i.debug("Dataflow invoked, but nothing to do."),i;const s=++i._clock;i._pulse=new Wc(i,s,e),i._touched.forEach(c=>i._enqueue(c,!0)),i._touched=sD(N_);let a,l,u,o=0;try{for(;i._heap.size()>0;)a=i._heap.pop(),a.rank===a.qrank?(l=a.run(i._getPulse(a,e)),l.then?l=yield l:l.async&&(r.push(l.async),l=dD),l!==dD&&a._targets&&a._targets.forEach(c=>i._enqueue(c)),++o):i._enqueue(a,!0)}catch(c){i._heap.clear(),u=c}if(i._input={},i._pulse=null,i.debug(`Pulse ${s}: ${o} operators`),u&&(i._postrun=[],i.error(u)),i._postrun.length){const c=i._postrun.sort((f,d)=>d.priority-f.priority);i._postrun=[];for(let f=0;f<c.length;++f)yield oD(i,c[f].callback)}return n&&(yield oD(i,n)),r.length&&Promise.all(r).then(c=>i.runAsync(null,()=>{c.forEach(f=>{try{f(i)}catch(d){i.error(d)}})})),i}),rk.apply(this,arguments)}function sk(){return sk=kr(function*(e,t,n){for(;this._running;)yield this._running;const i=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(i,i),this._running}),sk.apply(this,arguments)}function _W(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}Wc.prototype={StopPropagation:dD,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(e){return new Wc(this.dataflow).init(this,e)},clone(){const e=this.fork(7);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(23)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new Wc(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(64&t)&&(n.fields=e.fields),1&t?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),2&t?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),4&t?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),32&t?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||7;return 1&t&&this.add.length||2&t&&this.rem.length||4&t&&this.mod.length},reflow(e){if(e)return this.fork(7).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(4,mW(this,1))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return Z(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return!(!t&&!this.mod.length||!n)&&(arguments.length?Z(e)?e.some(i=>n[i]):n[e]:!!n)},filter(e,t){const n=this;return 1&e&&(n.addF=hD(n.addF,t)),2&e&&(n.remF=hD(n.remF,t)),4&e&&(n.modF=hD(n.modF,t)),16&e&&(n.srcF=hD(n.srcF,t)),n},materialize(e){const t=this;return 1&(e=e||7)&&t.addF&&(t.add=nk(t.add,t.addF),t.addF=null),2&e&&t.remF&&(t.rem=nk(t.rem,t.remF),t.remF=null),4&e&&t.modF&&(t.mod=nk(t.mod,t.modF),t.modF=null),16&e&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,i=t;if(16&e)return Lc(n.source,n.srcF,i),n;1&e&&Lc(n.add,n.addF,i),2&e&&Lc(n.rem,n.remF,i),4&e&&Lc(n.mod,n.modF,i);const r=n.source;if(8&e&&r){const s=n.add.length+n.mod.length;s===r.length||Lc(r,s?mW(n,5):n.srcF,i)}return n}},ce(ik,Wc,{fork(e){const t=new Wc(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?Z(e)?e.some(i=>n[i]):n[e]:0},filter(){Q("MultiPulse does not support filtering.")},materialize(){Q("MultiPulse does not support materialization.")},visit(e,t){const n=this,i=n.pulses,r=i.length;let s=0;if(e&n.SOURCE)for(;s<r;++s)i[s].visit(e,t);else for(;s<r;++s)i[s].stamp===n.stamp&&i[s].visit(e,t);return n}});const ok={skip:!1,force:!1};function yW(e,t,n,i){let r,s;const o=e[n];for(;n>t&&(s=n-1>>1,r=e[s],i(o,r)<0);)e[n]=r,n=s;return e[n]=o}function Mg(){this.logger(JN()),this.logLevel(YN),this._clock=0,this._rank=0,this._locale=U2();try{this._loader=rD()}catch(e){}this._touched=sD(N_),this._input={},this._pulse=null,this._heap=function QSe(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),yW(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let i;return t.length?(i=t[0],t[0]=n,function ZSe(e,t,n){const i=t,r=e.length,s=e[t];let a,o=1+(t<<1);for(;o<r;)a=o+1,a<r&&n(e[o],e[a])>=0&&(o=a),e[t]=e[o],o=1+((t=o)<<1);e[t]=s,yW(e,i,t,n)}(t,0,e)):i=n,i}}}((e,t)=>e.qrank-t.qrank),this._postrun=[]}function K_(e){return function(){return this._log[e].apply(this,arguments)}}function K(e,t){un.call(this,e,null,t)}Mg.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:K_("error"),warn:K_("warn"),info:K_("info"),debug:K_("debug"),logLevel:K_("level"),cleanThreshold:1e4,add:function SSe(e,t,n,i){let s,r=1;return e instanceof un?s=e:e&&e.prototype instanceof un?s=new e:Qe(e)?s=new un(null,e):(r=0,s=new un(e,t)),this.rank(s),r&&(i=n,n=t),n&&this.connect(s,s.parameters(n,i)),this.touch(s),s},connect:function xSe(e,t){const n=e.rank,i=t.length;for(let r=0;r<i;++r)if(n<t[r].rank)return void this.rerank(e)},rank:function BSe(e){e.rank=++this._rank},rerank:function $Se(e){const t=[e];let n,i,r;for(;t.length;)if(this.rank(n=t.pop()),i=n._targets)for(r=i.length;--r>=0;)t.push(n=i[r]),n===e&&Q("Cycle detected in dataflow graph.")},pulse:function XSe(e,t,n){this.touch(e,n||ok);const i=new Wc(this,this._clock+(this._pulse?0:1)),r=e.pulse&&e.pulse.source||[];return i.target=e,this._input[e.id]=t.pulse(i,r),this},touch:function KSe(e,t){const n=t||ok;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this},update:function JSe(e,t,n){const i=n||ok;return(e.set(t)||i.force)&&this.touch(e,i),this},changeset:Ld,ingest:function MSe(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))},parse:function OSe(e,t){const n=this.locale();return oW(e,t,n.timeParse,n.utcParse)},preload:function kSe(e,t,n){return tk.apply(this,arguments)},request:function NSe(e,t){return ek.apply(this,arguments)},events:function TSe(e,t,n,i){const r=this,s=zc(n,i),o=function(u){u.dataflow=r;try{s.receive(u)}catch(c){r.error(c)}finally{r.run()}};let a;a="string"==typeof e&&"undefined"!=typeof document?document.querySelectorAll(e):ve(e);const l=a.length;for(let u=0;u<l;++u)a[u].addEventListener(t,o);return s},on:function FSe(e,t,n,i,r){return(e instanceof un?LSe:PSe)(this,e,t,n,i,r),this},evaluate:function HSe(e,t,n){return rk.apply(this,arguments)},run:function zSe(e,t,n){return this._pulse?_W(this):(this.evaluate(e,t,n),this)},runAsync:function USe(e,t,n){return sk.apply(this,arguments)},runAfter:function GSe(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(i){this.error(i)}},_enqueue:function WSe(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))},_getPulse:function qSe(e,t){const n=e.source,i=this._clock;return n&&Z(n)?new ik(this,i,n.map(r=>r.pulse),t):this._input[e.id]||function YSe(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==dD&&(e.source=t.source),e)}(this._pulse,n&&n.pulse)}},ce(K,un,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Ng={};function vW(e){const t=bW(e);return t&&t.Definition||null}function bW(e){return e=e&&e.toLowerCase(),Oe(Ng,e)?Ng[e]:null}function jd(e,t){let n;if(void 0===t)for(const i of e)null!=i&&(n<i||void 0===n&&i>=i)&&(n=i);else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}function ak(e,t){let n;if(void 0===t)for(const i of e)null!=i&&(n>i||void 0===n&&i>=i)&&(n=i);else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(n>r||void 0===n&&r>=r)&&(n=r)}return n}function pD(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}function DW(e,t,n=0,i=e.length-1,r){for(r=void 0===r?pD:function wW(e=Ou){if(e===Ou)return pD;if("function"!=typeof e)throw new TypeError("compare is not a function");return(t,n)=>{const i=e(t,n);return i||0===i?i:(0===e(n,n))-(0===e(t,t))}}(r);i>n;){if(i-n>600){const l=i-n+1,u=t-n+1,c=Math.log(l),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(l-f)/l)*(u-l/2<0?-1:1);DW(e,t,Math.max(n,Math.floor(t-u*f/l+d)),Math.min(i,Math.floor(t+(l-u)*f/l+d)),r)}const s=e[t];let o=n,a=i;for(J_(e,n,t),r(e[i],s)>0&&J_(e,n,i);o<a;){for(J_(e,o,a),++o,--a;r(e[o],s)<0;)++o;for(;r(e[a],s)>0;)--a}0===r(e[n],s)?J_(e,n,a):(++a,J_(e,a,i)),a<=t&&(n=a+1),t<=a&&(i=a-1)}return e}function J_(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function CW(e){return null===e?NaN:+e}function lk(e,t,n){if(e=Float64Array.from(function*exe(e,t){if(void 0===t)for(let n of e)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)null!=(i=t(i,++n,e))&&(i=+i)>=i&&(yield i)}}(e,n)),i=e.length){if((t=+t)<=0||i<2)return ak(e);if(t>=1)return jd(e);var i,r=(i-1)*t,s=Math.floor(r),o=jd(DW(e,s).subarray(0,s+1));return o+(ak(e.subarray(s+1))-o)*(r-s)}}function EW(e,t,n=CW){if(i=e.length){if((t=+t)<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,s=Math.floor(r),o=+n(e[s],s,e);return o+(+n(e[s+1],s+1,e)-o)*(r-s)}}function SW(e,t){return lk(e,.5,t)}function*xW(e,t){if(null==t)for(let n of e)null!=n&&""!==n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)i=t(i,++n,e),null!=i&&""!==i&&(i=+i)>=i&&(yield i)}}function uk(e,t,n){const i=Float64Array.from(xW(e,n));return i.sort(Ou),t.map(r=>EW(i,r))}function ck(e,t){return uk(e,[.25,.5,.75],t)}function fk(e,t){const n=e.length,i=function nxe(e,t){const n=function txe(e,t){let i,n=0,r=0,s=0;if(void 0===t)for(let o of e)null!=o&&(o=+o)>=o&&(i=o-r,r+=i/++n,s+=i*(o-r));else{let o=-1;for(let a of e)null!=(a=t(a,++o,e))&&(a=+a)>=a&&(i=a-r,r+=i/++n,s+=i*(a-r))}if(n>1)return s/(n-1)}(e,t);return n&&Math.sqrt(n)}(e,t),r=ck(e,t);return 1.06*(Math.min(i,(r[2]-r[0])/1.34)||i||Math.abs(r[0])||1)*Math.pow(n,-.2)}function AW(e){const t=e.maxbins||20,n=e.base||10,i=Math.log(n),r=e.divide||[5,2];let a,l,u,c,f,d,s=e.extent[0],o=e.extent[1];const h=e.span||o-s||Math.abs(s)||1;if(e.step)a=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);a=e.steps[Math.max(0,f-1)]}else{for(l=Math.ceil(Math.log(t)/i),u=e.minstep||0,a=Math.max(u,Math.pow(n,Math.round(Math.log(h)/i)-l));Math.ceil(h/a)>t;)a*=n;for(f=0,d=r.length;f<d;++f)c=a/r[f],c>=u&&h/c<=t&&(a=c)}c=Math.log(a);const g=Math.pow(n,-(c>=0?0:1+~~(-c/i))-1);return(e.nice||void 0===e.nice)&&(c=Math.floor(s/a+g)*a,s=s<c?c-a:c,o=Math.ceil(o/a)*a),{start:s,stop:o===s?s+a:o,step:a}}var xo=Math.random;function ixe(e){xo=e}function TW(e,t,n,i){if(!e.length)return[void 0,void 0];const r=Float64Array.from(xW(e,i)),s=r.length,o=t;let a,l,u,c;for(u=0,c=Array(o);u<o;++u){for(a=0,l=0;l<s;++l)a+=r[~~(xo()*s)];c[u]=a/s}return c.sort(Ou),[lk(c,n/2),lk(c,1-n/2)]}function OW(e,t,n,i){i=i||(d=>d);const r=e.length,s=new Float64Array(r);let f,o=0,a=1,l=i(e[0]),u=l,c=l+t;for(;a<r;++a){if(f=i(e[a]),f>=c){for(u=(l+u)/2;o<a;++o)s[o]=u;c=f+t,l=f}u=f}for(u=(l+u)/2;o<a;++o)s[o]=u;return n?function rxe(e,t){const n=e.length;let s,o,i=0,r=1;for(;e[i]===e[r];)++r;for(;r<n;){for(s=r+1;e[r]===e[s];)++s;if(e[r]-e[r-1]<t){for(o=r+(i+s-r-r>>1);o<r;)e[o++]=e[r];for(;o>r;)e[o--]=e[i]}i=r,r=s}return e}(s,t+t/4):s}function sxe(e){return function(){return(e=(1103515245*e+12345)%2147483647)/2147483647}}function oxe(e,t){let n,i,r;null==t&&(t=e,e=0);const s={min(o){return arguments.length?(n=o||0,r=i-n,s):n},max(o){return arguments.length?(i=o||0,r=i-n,s):i},sample:()=>n+Math.floor(r*xo()),pdf:o=>o===Math.floor(o)&&o>=n&&o<i?1/r:0,cdf(o){const a=Math.floor(o);return a<n?0:a>=i?1:(a-n+1)/r},icdf:o=>o>=0&&o<=1?n-1+Math.floor(o*r):NaN};return s.min(e).max(t)}const MW=Math.sqrt(2*Math.PI),axe=Math.SQRT2;let X_=NaN;function gD(e,t){e=e||0,t=null==t?1:t;let r,s,n=0,i=0;if(X_==X_)n=X_,X_=NaN;else{do{n=2*xo()-1,i=2*xo()-1,r=n*n+i*i}while(0===r||r>1);s=Math.sqrt(-2*Math.log(r)/r),n*=s,X_=i*s}return e+n*t}function dk(e,t,n){const i=(e-(t||0))/(n=null==n?1:n);return Math.exp(-.5*i*i)/(n*MW)}function mD(e,t,n){const i=(e-(t=t||0))/(n=null==n?1:n),r=Math.abs(i);let s;if(r>37)s=0;else{const o=Math.exp(-r*r/2);let a;r<7.07106781186547?(a=.0352624965998911*r+.700383064443688,a=a*r+6.37396220353165,a=a*r+33.912866078383,a=a*r+112.079291497871,a=a*r+221.213596169931,a=a*r+220.206867912376,s=o*a,a=.0883883476483184*r+1.75566716318264,a=a*r+16.064177579207,a=a*r+86.7807322029461,a=a*r+296.564248779674,a=a*r+637.333633378831,a=a*r+793.826512519948,a=a*r+440.413735824752,s/=a):(a=r+.65,a=r+4/a,a=r+3/a,a=r+2/a,a=r+1/a,s=o/a/2.506628274631)}return i>0?1-s:s}function _D(e,t,n){return e<0||e>1?NaN:(t||0)+(null==n?1:n)*axe*function lxe(e){let n,t=-Math.log((1-e)*(1+e));return t<6.25?(t-=3.125,n=-364441206401782e-35,n=n*t-16850591381820166e-35,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=n*t-1333171662854621e-31,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=n*t-4054566272975207e-29,n=n*t-8151934197605472e-29,n=26335093153082323e-28+n*t,n=n*t-12975133253453532e-27,n=n*t-5415412054294628e-26,n=1.0512122733215323e-9+n*t,n=n*t-4.112633980346984e-9,n=n*t-2.9070369957882005e-8,n=4.2347877827932404e-7+n*t,n=n*t-13654692000834679e-22,n=n*t-13882523362786469e-21,n=.00018673420803405714+n*t,n=n*t-.000740702534166267,n=n*t-.006033670871430149,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=2.2137376921775787e-9,n=9.075656193888539e-8+n*t,n=n*t-2.7517406297064545e-7,n=1.8239629214389228e-8+n*t,n=15027403968909828e-22+n*t,n=n*t-4013867526981546e-21,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=n*t-47318229009055734e-21,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=n*t-.0003550375203628475,n=.0009532893797373805+n*t,n=n*t-.0016882755560235047,n=.002491442096107851+n*t,n=n*t-.003751208507569241,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=n*t-2.555641816996525e-10,n=1.5076572693500548e-9+n*t,n=n*t-3.789465440126737e-9,n=7.61570120807834e-9+n*t,n=n*t-1.496002662714924e-8,n=2.914795345090108e-8+n*t,n=n*t-6.771199775845234e-8,n=2.2900482228026655e-7+n*t,n=n*t-9.9298272942317e-7,n=4526062597223154e-21+n*t,n=n*t-1968177810553167e-20,n=7599527703001776e-20+n*t,n=n*t-.00021503011930044477,n=n*t-.00013871931833623122,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}(2*e-1)}function hk(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=null==s?1:s,r):i},sample:()=>gD(n,i),pdf:s=>dk(s,n,i),cdf:s=>mD(s,n,i),icdf:s=>_D(s,n,i)};return r.mean(e).stdev(t)}function pk(e,t){const n=hk();let i=0;const r={data(s){return arguments.length?(e=s,i=s?s.length:0,r.bandwidth(t)):e},bandwidth(s){return arguments.length?(!(t=s)&&e&&(t=fk(e)),r):t},sample:()=>e[~~(xo()*i)]+t*n.sample(),pdf(s){let o=0,a=0;for(;a<i;++a)o+=n.pdf((s-e[a])/t);return o/t/i},cdf(s){let o=0,a=0;for(;a<i;++a)o+=n.cdf((s-e[a])/t);return o/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(e)}function gk(e,t){return e=e||0,t=null==t?1:t,Math.exp(e+gD()*t)}function mk(e,t,n){if(e<=0)return 0;t=t||0,n=null==n?1:n;const i=(Math.log(e)-t)/n;return Math.exp(-.5*i*i)/(n*MW*e)}function _k(e,t,n){return mD(Math.log(e),t,n)}function yk(e,t,n){return Math.exp(_D(e,t,n))}function NW(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=null==s?1:s,r):i},sample:()=>gk(n,i),pdf:s=>mk(s,n,i),cdf:s=>_k(s,n,i),icdf:s=>yk(s,n,i)};return r.mean(e).stdev(t)}function kW(e,t){let i,n=0;const s={weights(o){return arguments.length?(i=function r(o){const a=[];let u,l=0;for(u=0;u<n;++u)l+=a[u]=null==o[u]?1:+o[u];for(u=0;u<n;++u)a[u]/=l;return a}(t=o||[]),s):t},distributions(o){return arguments.length?(o?(n=o.length,e=o):(n=0,e=[]),s.weights(t)):e},sample(){const o=xo();let a=e[n-1],l=i[0],u=0;for(;u<n-1;l+=i[++u])if(o<l){a=e[u];break}return a.sample()},pdf(o){let a=0,l=0;for(;l<n;++l)a+=i[l]*e[l].pdf(o);return a},cdf(o){let a=0,l=0;for(;l<n;++l)a+=i[l]*e[l].cdf(o);return a},icdf(){throw Error("Mixture icdf not supported.")}};return s.distributions(e).weights(t)}function vk(e,t){return null==t&&(t=null==e?1:e,e=0),e+(t-e)*xo()}function bk(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function wk(e,t,n){return null==n&&(n=null==t?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function Dk(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function IW(e,t){let n,i;const r={min(s){return arguments.length?(n=s||0,r):n},max(s){return arguments.length?(i=null==s?1:s,r):i},sample:()=>vk(n,i),pdf:s=>bk(s,n,i),cdf:s=>wk(s,n,i),icdf:s=>Dk(s,n,i)};return null==t&&(t=null==e?1:e,e=0),r.min(e).max(t)}function Q_(e,t,n,i){const r=i-e*e,s=Math.abs(r)<1e-24?0:(n-e*t)/r;return[t-s*e,s]}function yD(e,t,n,i){e=e.filter(h=>{let p=t(h),g=n(h);return null!=p&&(p=+p)>=p&&null!=g&&(g=+g)>=g}),i&&e.sort((h,p)=>t(h)-t(p));const r=e.length,s=new Float64Array(r),o=new Float64Array(r);let c,f,d,a=0,l=0,u=0;for(d of e)s[a]=c=+t(d),o[a]=f=+n(d),++a,l+=(c-l)/a,u+=(f-u)/a;for(a=0;a<r;++a)s[a]-=l,o[a]-=u;return[s,o,l,u]}function Z_(e,t,n,i){let s,o,r=-1;for(const a of e)s=t(a),o=n(a),null!=s&&(s=+s)>=s&&null!=o&&(o=+o)>=o&&i(s,o,++r)}function kg(e,t,n,i,r){let s=0,o=0;return Z_(e,t,n,(a,l)=>{const u=l-r(a),c=l-i;s+=u*u,o+=c*c}),1-s/o}function Ck(e,t,n){let i=0,r=0,s=0,o=0,a=0;Z_(e,t,n,(c,f)=>{++a,i+=(c-i)/a,r+=(f-r)/a,s+=(c*f-s)/a,o+=(c*c-o)/a});const l=Q_(i,r,s,o),u=c=>l[0]+l[1]*c;return{coef:l,predict:u,rSquared:kg(e,t,n,r,u)}}function RW(e,t,n){let i=0,r=0,s=0,o=0,a=0;Z_(e,t,n,(c,f)=>{++a,c=Math.log(c),i+=(c-i)/a,r+=(f-r)/a,s+=(c*f-s)/a,o+=(c*c-o)/a});const l=Q_(i,r,s,o),u=c=>l[0]+l[1]*Math.log(c);return{coef:l,predict:u,rSquared:kg(e,t,n,r,u)}}function FW(e,t,n){const[i,r,s,o]=yD(e,t,n);let d,h,p,a=0,l=0,u=0,c=0,f=0;Z_(e,t,n,(y,v)=>{d=i[f++],h=Math.log(v),p=d*v,a+=(v*h-a)/f,l+=(p-l)/f,u+=(p*h-u)/f,c+=(d*p-c)/f});const[g,m]=Q_(l/o,a/o,u/o,c/o),_=y=>Math.exp(g+m*(y-s));return{coef:[Math.exp(g-m*s),m],predict:_,rSquared:kg(e,t,n,o,_)}}function PW(e,t,n){let i=0,r=0,s=0,o=0,a=0,l=0;Z_(e,t,n,(f,d)=>{const h=Math.log(f),p=Math.log(d);++l,i+=(h-i)/l,r+=(p-r)/l,s+=(h*p-s)/l,o+=(h*h-o)/l,a+=(d-a)/l});const u=Q_(i,r,s,o),c=f=>u[0]*Math.pow(f,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:c,rSquared:kg(e,t,n,a,c)}}function Ek(e,t,n){const[i,r,s,o]=yD(e,t,n),a=i.length;let h,p,g,m,l=0,u=0,c=0,f=0,d=0;for(h=0;h<a;)p=i[h],g=r[h++],m=p*p,l+=(m-l)/h,u+=(m*p-u)/h,c+=(m*m-c)/h,f+=(p*g-f)/h,d+=(m*g-d)/h;const _=c-l*l,y=l*_-u*u,v=(d*l-f*u)/y,b=(f*_-d*u)/y,D=-v*l,C=w=>v*(w-=s)*w+b*w+D+o;return{coef:[D-b*s+v*s*s+o,b-2*v*s,v],predict:C,rSquared:kg(e,t,n,o,C)}}function LW(e,t,n,i){if(1===i)return Ck(e,t,n);if(2===i)return Ek(e,t,n);const[r,s,o,a]=yD(e,t,n),l=r.length,u=[],c=[],f=i+1;let d,h,p,g,m;for(d=0;d<f;++d){for(p=0,g=0;p<l;++p)g+=Math.pow(r[p],d)*s[p];for(u.push(g),m=new Float64Array(f),h=0;h<f;++h){for(p=0,g=0;p<l;++p)g+=Math.pow(r[p],d+h);m[h]=g}c.push(m)}c.push(u);const _=function cxe(e){const t=e.length-1,n=[];let i,r,s,o,a;for(i=0;i<t;++i){for(o=i,r=i+1;r<t;++r)Math.abs(e[i][r])>Math.abs(e[i][o])&&(o=r);for(s=i;s<t+1;++s)a=e[s][i],e[s][i]=e[s][o],e[s][o]=a;for(r=i+1;r<t;++r)for(s=t;s>=i;s--)e[s][r]-=e[s][i]*e[i][r]/e[i][i]}for(r=t-1;r>=0;--r){for(a=0,s=r+1;s<t;++s)a+=e[s][r]*n[s];n[r]=(e[t][r]-a)/e[r][r]}return n}(c),y=v=>{let b=a+_[0]+_[1]*(v-=o)+_[2]*v*v;for(d=3;d<f;++d)b+=_[d]*Math.pow(v,d);return b};return{coef:uxe(f,_,-o,a),predict:y,rSquared:kg(e,t,n,a,y)}}function uxe(e,t,n,i){const r=Array(e);let s,o,a,l;for(s=0;s<e;++s)r[s]=0;for(s=e-1;s>=0;--s)for(a=t[s],l=1,r[s]+=a,o=1;o<=s;++o)l*=(s+1-o)/o,r[s-o]+=a*Math.pow(n,o)*l;return r[0]+=i,r}function $W(e,t,n,i){const[r,s,o,a]=yD(e,t,n,!0),l=r.length,u=Math.max(2,~~(i*l)),c=new Float64Array(l),f=new Float64Array(l),d=new Float64Array(l).fill(1);for(let h=-1;++h<=2;){const p=[0,u-1];for(let m=0;m<l;++m){const _=r[m],y=p[0],v=p[1];let D=0,C=0,w=0,E=0,O=0;const M=1/Math.abs(r[_-r[y]>r[v]-_?y:v]-_||1);for(let P=y;P<=v;++P){const A=r[P],x=s[P],S=fxe(Math.abs(_-A)*M)*d[P],k=A*S;D+=S,C+=k,w+=x*S,E+=x*k,O+=A*k}const[N,R]=Q_(C/D,w/D,E/D,O/D);c[m]=N+R*_,f[m]=Math.abs(s[m]-c[m]),dxe(r,m+1,p)}if(2===h)break;const g=SW(f);if(Math.abs(g)<1e-12)break;for(let _,y,m=0;m<l;++m)_=f[m]/(6*g),d[m]=_>=1?1e-12:(y=1-_*_)*y}return function hxe(e,t,n,i){const r=e.length,s=[];let u,o=0,a=0,l=[];for(;o<r;++o)u=e[o]+n,l[0]===u?l[1]+=(t[o]-l[1])/++a:(a=0,l[1]+=i,l=[u,t[o]],s.push(l));return l[1]+=i,s}(r,c,o,a)}function fxe(e){return(e=1-e*e*e)*e*e}function dxe(e,t,n){const i=e[t];let r=n[0],s=n[1]+1;if(!(s>=e.length))for(;t>r&&e[s]-i<=i-e[r];)n[0]=++r,n[1]=s,++s}const pxe=.5*Math.PI/180;function vD(e,t,n,i){n=n||25,i=Math.max(n,i||200);const r=g=>[g,e(g)],s=t[0],o=t[1],a=o-s,l=a/i,u=[r(s)],c=[];if(n===i){for(let g=1;g<i;++g)u.push(r(s+g/n*a));return u.push(r(o)),u}c.push(r(o));for(let g=n;--g>0;)c.push(r(s+g/n*a));let f=u[0],d=c[c.length-1];const h=1/a,p=function gxe(e,t){let n=e,i=e;const r=t.length;for(let s=0;s<r;++s){const o=t[s][1];o<n&&(n=o),o>i&&(i=o)}return 1/(i-n)}(f[1],c);for(;d;){const g=r((f[0]+d[0])/2);g[0]-f[0]>=l&&mxe(f,g,d,h,p)>pxe?c.push(g):(f=d,u.push(d),c.pop()),d=c[c.length-1]}return u}function mxe(e,t,n,i,r){const s=Math.atan2(r*(n[1]-e[1]),i*(n[0]-e[0])),o=Math.atan2(r*(t[1]-e[1]),i*(t[0]-e[0]));return Math.abs(s-o)}function Vs(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((t-e)/n)),s=new Array(r);++i<r;)s[i]=e+i*n;return s}function Sk(e){return e&&e.length?1===e.length?e[0]:function yxe(e){return t=>{const n=e.length;let i=1,r=String(e[0](t));for(;i<n;++i)r+="|"+e[i](t);return r}}(e):function(){return""}}function VW(e,t,n){return n||e+(t?"_"+t:"")}const xk=()=>{},vxe={init:xk,add:xk,rem:xk,idx:0},ey={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||void 0===e.min)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||void 0===e.max)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},ty=Object.keys(ey);function HW(e,t){return ey[e](t)}function UW(e,t){return e.idx-t.idx}function Dxe(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function Cxe(e,t){null!=e&&""!==e?e==e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t))):++this.missing}function Exe(e,t){null!=e&&""!==e?e==e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t))):--this.missing}function Sxe(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function zW(e,t){const n=t||ar,i=function wxe(e){const t={};e.forEach(i=>t[i.name]=i);const n=i=>{!i.req||i.req.forEach(r=>{t[r]||n(t[r]=ey[r]())})};return e.forEach(n),Object.values(t).sort(UW)}(e),r=e.slice().sort(UW);function s(o){this._ops=i,this._out=r,this.cell=o,this.init()}return s.prototype.init=Dxe,s.prototype.add=Cxe,s.prototype.rem=Exe,s.prototype.set=Sxe,s.prototype.get=n,s.fields=e.map(o=>o.out),s}function Ak(e){this._key=e?rs(e):Ie,this.reset()}ty.forEach(e=>{ey[e]=function bxe(e,t){return n=>Ze({name:e,out:n||e},vxe,t)}(e,ey[e])});const Gi=Ak.prototype;function qc(e){K.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}function Tk(e){K.call(this,null,e)}function GW(e,t,n){const i=e;let r=t||[],s=n||[],o={},a=0;return{add:l=>s.push(l),remove:l=>o[i(l)]=++a,size:()=>r.length,data:(l,u)=>(a&&(r=r.filter(c=>!o[i(c)]),o={},a=0),u&&l&&r.sort(l),s.length&&(r=l?Nz(l,r,s.sort(l)):r.concat(s),s=[]),r)}}function Ok(e){K.call(this,[],e)}function WW(e){un.call(this,null,Axe,e)}function Axe(e){return this.value&&!e.modified()?this.value:e2(e.fields,e.orders)}function Mk(e){K.call(this,null,e)}function Nk(e){K.call(this,null,e)}Gi.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},Gi.add=function(e){this._add.push(e)},Gi.rem=function(e){this._rem.push(e)},Gi.values=function(){if(this._get=null,0===this._rem.length)return this._add;const e=this._add,t=this._rem,n=this._key,i=e.length,r=t.length,s=Array(i-r),o={};let a,l,u;for(a=0;a<r;++a)o[n(t[a])]=1;for(a=0,l=0;a<i;++a)o[n(u=e[a])]?o[n(u)]=0:s[l++]=u;return this._rem=[],this._add=s},Gi.distinct=function(e){const t=this.values(),n={};let s,i=t.length,r=0;for(;--i>=0;)s=e(t[i])+"",Oe(n,s)||(n[s]=1,++r);return r},Gi.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=Sz(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},Gi.argmin=function(e){return this.extent(e)[0]||{}},Gi.argmax=function(e){return this.extent(e)[1]||{}},Gi.min=function(e){const t=this.extent(e)[0];return null!=t?e(t):void 0},Gi.max=function(e){const t=this.extent(e)[1];return null!=t?e(t):void 0},Gi.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=ck(this.values(),e),this._get=e),this._q},Gi.q1=function(e){return this.quartile(e)[0]},Gi.q2=function(e){return this.quartile(e)[1]},Gi.q3=function(e){return this.quartile(e)[2]},Gi.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=TW(this.values(),1e3,.05,e),this._get=e),this._ci},Gi.ci0=function(e){return this.ci(e)[0]},Gi.ci1=function(e){return this.ci(e)[1]},qc.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:ty},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},ce(qc,K,{transform(e,t){const n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.modified();return n.stamp=i.stamp,n.value&&(r||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(n.value=n.value||n.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),i.modifies(n._outputs),n._drop=!1!==e.drop,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},cross(){const e=this,t=e.value,n=e._dnames,i=n.map(()=>({})),r=n.length;function s(a){let l,u,c,f;for(l in a)for(c=a[l].tuple,u=0;u<r;++u)i[u][f=c[n[u]]]=f}s(e._prev),s(t),function o(a,l,u){const c=n[u],f=i[u++];for(const d in f){const h=a?a+"|"+d:d;l[c]=f[d],u<r?o(h,l,u):t[h]||e.cell(h,l)}}("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],i={};function r(m){const _=ve(or(m)),y=_.length;let b,v=0;for(;v<y;++v)i[b=_[v]]||(i[b]=1,t.push(b))}this._dims=ve(e.groupby),this._dnames=this._dims.map(m=>{const _=Un(m);return r(m),n.push(_),_}),this.cellkey=e.key?e.key:Sk(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const s=e.fields||[null],o=e.ops||["count"],a=e.as||[],l=s.length,u={};let c,f,d,h,p,g;for(l!==o.length&&Q("Unmatched number of fields and aggregate ops."),g=0;g<l;++g)c=s[g],f=o[g],null==c&&"count"!==f&&Q("Null aggregate field specified."),h=Un(c),p=VW(f,h,a[g]),n.push(p),"count"!==f?(d=u[h],d||(r(c),d=u[h]=[],d.field=c,this._measures.push(d)),"count"!==f&&(this._countOnly=!1),d.push(HW(f,p))):this._counts.push(p);return this._measures=this._measures.map(m=>zW(m,m.field)),{}},cellkey:Sk(),cell(e,t){let n=this.value[e];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const i=this._measures,r=i.length;n.agg=Array(r);for(let s=0;s<r;++s)n.agg[s]=new i[s](n)}return n.store&&(n.data=new Ak),n},newtuple(e,t){const n=this._dnames,i=this._dims,r=i.length,s={};for(let o=0;o<r;++o)s[n[o]]=i[o](e);return t?uW(t.tuple,s):jt(s)},clean(){const e=this.value;for(const t in e)0===e[t].num&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].add(i[r].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].rem(i[r].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let i=0,r=n.length;i<r;++i)t[n[i]]=e.num;if(!this._countOnly){const i=e.agg;for(let r=0,s=i.length;r<s;++r)i[r].set(t)}return t},changes(e){const t=this._adds,n=this._mods,i=this._prev,r=this._drop,s=e.add,o=e.rem,a=e.mod;let l,u,c,f;if(i)for(u in i)l=i[u],(!r||l.num)&&o.push(l.tuple);for(c=0,f=this._alen;c<f;++c)s.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)l=n[c],(0===l.num&&r?o:a).push(this.celltuple(l)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}}),Tk.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},ce(Tk,K,{transform(e,t){const n=!1!==e.interval,i=this._bins(e),r=i.start,s=i.step,o=e.as||["bin0","bin1"],a=o[0],l=o[1];let u;return u=e.modified()?(t=t.reflow(!0)).SOURCE:t.modified(or(e.field))?t.ADD_MOD:t.ADD,t.visit(u,n?c=>{const f=i(c);c[a]=f,c[l]=null==f?null:r+s*(1+(f-r)/s)}:c=>c[a]=i(c)),t.modifies(n?o:a)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=AW(e),i=n.step;let o,a,r=n.start,s=r+Math.ceil((n.stop-r)/i)*i;null!=(o=e.anchor)&&(a=o-(r+i*Math.floor((o-r)/i)),r+=a,s+=a);const l=function(u){let c=lr(t(u));return null==c?null:c<r?-1/0:c>s?1/0:(c=Math.max(r,Math.min(c,s-i)),r+i*Math.floor(1e-14+(c-r)/i))};return l.start=r,l.stop=n.stop,l.step=i,this.value=is(l,or(t),e.name||"bin_"+Un(t))}}),Ok.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},ce(Ok,K,{transform(e,t){const n=t.fork(t.ALL),i=GW(Ie,this.value,n.materialize(n.ADD).add),r=e.sort,s=t.changed()||r&&(e.modified("sort")||t.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(s),this.value=n.source=i.data(Pd(r),s),t.source&&t.source.root&&(this.value.root=t.source.root),n}}),ce(WW,un),Mk.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},ce(Mk,K,{transform(e,t){const n=f=>d=>{for(var p,h=function Txe(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase()}return e.match(n)}(a(d),e.case,s)||[],g=0,m=h.length;g<m;++g)o.test(p=h[g])||f(p)},i=this._parameterCheck(e,t),r=this._counts,s=this._match,o=this._stop,a=e.field,l=e.as||["text","count"],u=n(f=>r[f]=1+(r[f]||0)),c=n(f=>r[f]-=1);return i?t.visit(t.SOURCE,u):(t.visit(t.ADD,u),t.visit(t.REM,c)),this._finish(t,l)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,i=this._tuples||(this._tuples={}),r=t[0],s=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS);let a,l,u;for(a in n)l=i[a],u=n[a]||0,!l&&u?(i[a]=l=jt({}),l[r]=a,l[s]=u,o.add.push(l)):0===u?(l&&o.rem.push(l),n[a]=null,i[a]=null):l[s]!==u&&(l[s]=u,o.mod.push(l));return o.modifies(t)}}),Nk.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},ce(Nk,K,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.as||["a","b"],r=i[0],s=i[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let a=this.value;return o?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=function Oxe(e,t,n,i){for(var l,u,r=[],s={},o=e.length,a=0;a<o;++a)for(s[t]=u=e[a],l=0;l<o;++l)s[n]=e[l],i(s)&&(r.push(jt(s)),(s={})[t]=u);return r}(a,r,s,e.filter||Co)):n.mod=a,n.source=this.value,n.modifies(i)}});const qW={kde:pk,mixture:kW,normal:hk,lognormal:NW,uniform:IW},YW="function";function KW(e,t){const n=e[YW];Oe(qW,n)||Q("Unknown distribution function: "+n);const i=qW[n]();for(const r in e)"field"===r?i.data((e.from||t()).map(e[r])):"distributions"===r?i[r](e[r].map(s=>KW(s,t))):typeof i[r]===YW&&i[r](e[r]);return i}function kk(e){K.call(this,null,e)}const JW=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}];function XW(e,t){return e?e.map((n,i)=>t[i]||Un(n)):null}function Ik(e,t,n){const i=[],r=f=>f(l);let s,o,a,l,u,c;if(null==t)i.push(e.map(n));else for(s={},o=0,a=e.length;o<a;++o)l=e[o],u=t.map(r),c=s[u],c||(s[u]=c=[],c.dims=u,i.push(c)),c.push(n(l));return i}function Rk(e){K.call(this,null,e)}function ZW(e){un.call(this,null,Fxe,e),this.modified(!0)}function Fxe(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:is(n=>t(n,e),or(t),Un(t))}function Fk(e){K.call(this,[void 0,void 0],e)}function Pk(e,t){un.call(this,e),this.parent=t,this.count=0}function bD(e){K.call(this,{},e),this._keys=yg();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let i=0,r=t.active;i<r;++i)n(t[i],i,t)}}function eq(e){un.call(this,null,Pxe,e)}function Pxe(e){return this.value&&!e.modified()?this.value:Z(e.name)?ve(e.name).map(t=>rs(t)):rs(e.name,e.as)}function Lk(e){K.call(this,yg(),e)}function jk(e){K.call(this,[],e)}function Bk(e){K.call(this,[],e)}function $k(e){K.call(this,null,e)}function tq(e){K.call(this,[],e)}kk.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:JW.concat({key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:JW},{name:"weights",type:"number",array:!0}]})},{name:"as",type:"string",array:!0,default:["value","density"]}]},ce(kk,K,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=KW(e.distribution,function Ixe(e){return()=>e.materialize(e.SOURCE).source}(t)),r=e.steps||e.minsteps||25,s=e.steps||e.maxsteps||200;let o=e.method||"pdf";"pdf"!==o&&"cdf"!==o&&Q("Invalid density method: "+o),!e.extent&&!i.data&&Q("Missing density extent parameter."),o=i[o];const a=e.as||["value","density"],u=vD(o,e.extent||cl(i.data()),r,s).map(c=>{const f={};return f[a[0]]=c[0],f[a[1]]=c[1],jt(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}}),Rk.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]},ce(Rk,K,{transform(e,t){if(this.value&&!e.modified()&&!t.changed())return t;const n=t.materialize(t.SOURCE).source,i=Ik(t.source,e.groupby,ar),r=e.smooth||!1,s=e.field,o=e.step||((e,t)=>I_(cl(e,t))/30)(n,s),a=Pd((p,g)=>s(p)-s(g)),l=e.as||"bin",u=i.length;let h,c=1/0,f=-1/0,d=0;for(;d<u;++d){const p=i[d].sort(a);h=-1;for(const g of OW(p,o,r,s))g<c&&(c=g),g>f&&(f=g),p[++h][l]=g}return this.value={start:c,stop:f,step:o},t.reflow(!0).modifies(l)}}),ce(ZW,un),Fk.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},ce(Fk,K,{transform(e,t){const n=this.value,i=e.field,r=t.changed()||t.modified(i.fields)||e.modified("field");let s=n[0],o=n[1];if((r||null==s)&&(s=1/0,o=-1/0),t.visit(r?t.SOURCE:t.ADD,a=>{const l=lr(i(a));null!=l&&(l<s&&(s=l),l>o&&(o=l))}),!Number.isFinite(s)||!Number.isFinite(o)){let a=Un(i);a&&(a=' for field "'.concat(a,'"')),t.dataflow.warn("Infinite extent".concat(a,": [").concat(s,", ").concat(o,"]")),s=o=void 0}this.value=[s,o]}}),ce(Pk,un,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}}),ce(bD,K,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,i){const r=this.value;let o,a,s=Oe(r,e)&&r[e];return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=i||(a=this._group[e])&&a.tuple,o=n.dataflow,s=new Pk(n.fork(n.NO_SOURCE),this),o.add(s).connect(t(o,e,a)),r[e]=s,this.activate(s)),s},clean(){const e=this.value;let t=0;for(const n in e)if(0===e[n].count){const i=e[n].detachSubflow;i&&i(),delete e[n],++t}if(t){const n=this._targets.filter(i=>i&&i.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,i=e?e.length:0;let r=0;for(;r<i;++r)t[r]=e[r];for(;r<n&&null!=t[r];++r)t[r]=null;t.active=i},transform(e,t){const n=t.dataflow,i=e.key,r=e.subflow,s=this._keys,o=e.modified("key"),a=l=>this.subflow(l,r,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,l=>{const u=Ie(l),c=s.get(u);void 0!==c&&(s.delete(u),a(c).rem(l))}),t.visit(t.ADD,l=>{const u=i(l);s.set(Ie(l),u),a(u).add(l)}),o||t.modified(i.fields)?t.visit(t.MOD,l=>{const u=Ie(l),c=s.get(u),f=i(l);c===f?a(f).mod(l):(s.set(u,f),a(c).rem(l),a(f).add(l))}):t.changed(t.MOD)&&t.visit(t.MOD,l=>{a(s.get(Ie(l))).mod(l)}),o&&t.visit(t.REFLOW,l=>{const u=Ie(l),c=s.get(u),f=i(l);c!==f&&(s.set(u,f),a(c).rem(l),a(f).add(l))}),t.clean()?n.runAfter(()=>{this.clean(),s.clean()}):s.empty>n.cleanThreshold&&n.runAfter(s.clean),t}}),ce(eq,un),Lk.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},ce(Lk,K,{transform(e,t){const n=t.dataflow,i=this.value,r=t.fork(),s=r.add,o=r.rem,a=r.mod,l=e.expr;let u=!0;function c(f){const d=Ie(f),h=l(f,e),p=i.get(d);h&&p?(i.delete(d),s.push(f)):h||p?u&&h&&!p&&a.push(f):(i.set(d,1),o.push(f))}return t.visit(t.REM,f=>{const d=Ie(f);i.has(d)?i.delete(d):o.push(f)}),t.visit(t.ADD,f=>{l(f,e)?s.push(f):i.set(Ie(f),1)}),t.visit(t.MOD,c),e.modified()&&(u=!1,t.visit(t.REFLOW,c)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),r}}),jk.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},ce(jk,K,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=XW(i,e.as||[]),s=e.index||null,o=r.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{const l=i.map(p=>p(a)),u=l.reduce((p,g)=>Math.max(p,g.length),0);let f,d,h,c=0;for(;c<u;++c){for(d=Z2(a),f=0;f<o;++f)d[r[f]]=null==(h=l[f][c])?null:h;s&&(d[s]=c),n.add.push(d)}}),this.value=n.source=n.add,s&&n.modifies(s),n.modifies(r)}}),Bk.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},ce(Bk,K,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=i.map(Un),s=e.as||["key","value"],o=s[0],a=s[1],l=i.length;return n.rem=this.value,t.visit(t.SOURCE,u=>{for(let f,c=0;c<l;++c)f=Z2(u),f[o]=r[c],f[a]=i[c](u),n.add.push(f)}),this.value=n.source=n.add,n.modifies(s)}}),$k.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},ce($k,K,{transform(e,t){const n=e.expr,i=e.as,r=e.modified(),s=e.initonly?t.ADD:r?t.SOURCE:t.modified(n.fields)||t.modified(i)?t.ADD_MOD:t.ADD;return r&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(i),t.visit(s,o=>o[i]=n(o,e))}}),ce(tq,K,{transform(e,t){const n=t.fork(t.ALL),i=e.generator;let o,a,l,r=this.value,s=e.size-r.length;if(s>0){for(o=[];--s>=0;)o.push(l=jt(i(e))),r.push(l);n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else a=r.slice(0,-s),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,r=r.slice(-s);return n.source=this.value=r,n}});const wD={value:"value",median:SW,mean:function _xe(e,t){let n=0,i=0;if(void 0===t)for(let r of e)null!=r&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let s of e)null!=(s=t(s,++r,e))&&(s=+s)>=s&&(++n,i+=s)}if(n)return i/n},min:ak,max:jd},Lxe=[];function Vk(e){K.call(this,[],e)}function Hk(e){qc.call(this,e)}function Uk(e){K.call(this,null,e)}function nq(e){un.call(this,null,Vxe,e)}function Vxe(e){return this.value&&!e.modified()?this.value:n2(e.fields,e.flat)}function iq(e){K.call(this,[],e),this._pending=null}function zk(e,t,n){n.forEach(jt);const i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i}function Gk(e){K.call(this,{},e)}function rq(e){un.call(this,null,Uxe,e)}function Uxe(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let s,o,i=1/0,r=-1/0;for(s=0;s<n;++s)o=t[s],o[0]<i&&(i=o[0]),o[1]>r&&(r=o[1]);return[i,r]}function sq(e){un.call(this,null,zxe,e)}function zxe(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function oq(e){K.call(this,null,e)}function Wk(e){qc.call(this,e)}function aq(e){bD.call(this,e)}function qk(e){K.call(this,null,e)}function lq(e){K.call(this,null,e)}function Yk(e){K.call(this,null,e)}function uq(e){K.call(this,null,e)}function Kk(e){K.call(this,[],e),this.count=0}function Jk(e){K.call(this,null,e)}function cq(e){K.call(this,null,e),this.modified(!0)}function Xk(e){K.call(this,null,e)}Vk.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},ce(Vk,K,{transform(e,t){var d,h,p,g,m,_,y,v,b,D,n=t.fork(t.ALL),i=function jxe(e){var n,t=e.method||wD.value;if(null!=wD[t])return t===wD.value?(n=void 0!==e.value?e.value:0,()=>n):wD[t];Q("Unrecognized imputation method: "+t)}(e),r=function Bxe(e){const t=e.field;return n=>n?t(n):NaN}(e),s=Un(e.field),o=Un(e.key),a=(e.groupby||[]).map(Un),l=function $xe(e,t,n,i){var u,c,f,d,h,p,g,m,r=_=>_(m),s=[],o=i?i.slice():[],a={},l={};for(o.forEach((_,y)=>a[_]=y+1),d=0,g=e.length;d<g;++d)p=n(m=e[d]),h=a[p]||(a[p]=o.push(p)),(f=l[c=(u=t?t.map(r):Lxe)+""])||(f=l[c]=[],s.push(f),f.values=u),f[h-1]=m;return s.domain=o,s}(t.source,e.groupby,e.key,e.keyvals),u=[],c=this.value,f=l.domain.length;for(m=0,v=l.length;m<v;++m)for(p=(d=l[m]).values,h=NaN,y=0;y<f;++y)if(null==d[y]){for(g=l.domain[y],D={_impute:!0},_=0,b=p.length;_<b;++_)D[a[_]]=p[_];D[o]=g,D[s]=Number.isNaN(h)?h=i(d,r):h,u.push(jt(D))}return u.length&&(n.add=n.materialize(n.ADD).add.concat(u)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=u,n}}),Hk.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:ty},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},ce(Hk,qc,{transform(e,t){const n=this,i=e.modified();let r;return n.value&&(i||t.modified(n._inputs,!0))?(r=n.value=i?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(r=n.value=n.value||this.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),n.changes(),t.visit(t.SOURCE,s=>{Ze(s,r[n.cellkey(s)].tuple)}),t.reflow(i).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n)this.celltuple(e[n]),e[n]=null;for(n=0,i=this._mlen;n<i;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}}),Uk.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},ce(Uk,K,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=Ik(i,e.groupby,e.field),s=(e.groupby||[]).map(Un),o=e.bandwidth,a=e.cumulative?"cdf":"pdf",l=e.as||["value","density"],u=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;"pdf"!==a&&"cdf"!==a&&Q("Invalid density method: "+a),"shared"===e.resolve&&(c||(c=cl(i,e.field)),f=d=e.steps||d),r.forEach(h=>{const p=pk(h,o)[a],g=e.counts?h.length:1;vD(p,c||cl(h),f,d).forEach(_=>{const y={};for(let v=0;v<s.length;++v)y[s[v]]=h.dims[v];y[l[0]]=_[0],y[l[1]]=_[1]*g,u.push(jt(y))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}}),ce(nq,un),ce(iq,K,{transform(e,t){const n=t.dataflow;return this._pending?zk(this,t,this._pending):function Hxe(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}(e)?t.StopPropagation:e.values?zk(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(r=>(this._pending=ve(r.data),s=>s.touch(this)))}:n.request(e.url,e.format).then(i=>zk(this,t,ve(i.data)))}}),Gk.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},ce(Gk,K,{transform(e,t){const n=e.fields,i=e.index,r=e.values,s=null==e.default?null:e.default,o=e.modified(),a=n.length;let f,d,h,l=o?t.SOURCE:t.ADD,u=t,c=e.as;return r?(d=r.length,a>1&&!c&&Q('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==a*d&&Q('The "as" parameter has too few output field names.'),c=c||r.map(Un),f=function(p){for(var _,y,g=0,m=0;g<a;++g)if(null==(y=i.get(n[g](p))))for(_=0;_<d;++_,++m)p[c[m]]=s;else for(_=0;_<d;++_,++m)p[c[m]]=r[_](y)}):(c||Q("Missing output field names."),f=function(p){for(var m,g=0;g<a;++g)m=i.get(n[g](p)),p[c[g]]=null==m?s:m}),o?u=t.reflow(!0):(h=n.some(p=>t.modified(p.fields)),l|=h?t.MOD:0),t.visit(l,f),u.modifies(c)}}),ce(rq,un),ce(sq,un),ce(oq,K,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),Wk.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:ty,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},ce(Wk,qc,{_transform:qc.prototype.transform,transform(e,t){return this._transform(function Gxe(e,t){const n=e.field,i=e.value,r=("count"===e.op?"__count__":e.op)||"sum",s=or(n).concat(or(i)),o=function qxe(e,t,n){const i={},r=[];return n.visit(n.SOURCE,s=>{const o=e(s);i[o]||(i[o]=1,r.push(o))}),r.sort(zw),t?r.slice(0,t):r}(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:o.map(()=>r),fields:o.map(a=>function Wxe(e,t,n,i){return is(r=>t(r)===e?n(r):NaN,i,e+"")}(a,n,i,s)),as:o.map(a=>a+""),modified:e.modified.bind(e)}}(e,t),t)}}),ce(aq,bD,{transform(e,t){const n=e.subflow,i=e.field,r=s=>this.subflow(Ie(s),n,t,s);return(e.modified("field")||i&&t.modified(or(i)))&&Q("PreFacet does not support field modification."),this.initTargets(),i?(t.visit(t.MOD,s=>{const o=r(s);i(s).forEach(a=>o.mod(a))}),t.visit(t.ADD,s=>{const o=r(s);i(s).forEach(a=>o.add(jt(a)))}),t.visit(t.REM,s=>{const o=r(s);i(s).forEach(a=>o.rem(a))})):(t.visit(t.MOD,s=>r(s).mod(s)),t.visit(t.ADD,s=>r(s).add(s)),t.visit(t.REM,s=>r(s).rem(s))),t.clean()&&t.runAfter(()=>this.clean()),t}}),qk.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},ce(qk,K,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=XW(e.fields,e.as||[]),s=i?(a,l)=>function Yxe(e,t,n,i){for(let r=0,s=n.length;r<s;++r)t[i[r]]=n[r](e);return t}(a,l,i,r):lD;let o;return this.value?o=this.value:(t=t.addAll(),o=this.value={}),t.visit(t.REM,a=>{const l=Ie(a);n.rem.push(o[l]),o[l]=null}),t.visit(t.ADD,a=>{const l=s(a,jt({}));o[Ie(a)]=l,n.add.push(l)}),t.visit(t.MOD,a=>{n.mod.push(s(a,o[Ie(a)]))}),n}}),ce(lq,K,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}}),Yk.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]},ce(Yk,K,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const s=Ik(t.materialize(t.SOURCE).source,e.groupby,e.field),o=(e.groupby||[]).map(Un),a=[],l=e.step||.01,u=e.probs||Vs(l/2,1-1e-14,l),c=u.length;return s.forEach(f=>{const d=uk(f,u);for(let h=0;h<c;++h){const p={};for(let g=0;g<o.length;++g)p[o[g]]=f.dims[g];p[i[0]]=u[h],p[i[1]]=d[h],a.push(jt(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}}),ce(uq,K,{transform(e,t){let n,i;return this.value?i=this.value:(n=t=t.addAll(),i=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,r=>{const s=Ie(r);n.rem.push(i[s]),i[s]=null}),t.visit(t.ADD,r=>{const s=Z2(r);i[Ie(r)]=s,n.add.push(s)}),t.visit(t.MOD,r=>{const s=i[Ie(r)];for(const o in r)s[o]=r[o],n.modifies(o);n.mod.push(s)})),n}}),Kk.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},ce(Kk,K,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.modified("size"),r=e.size,s=this.value.reduce((c,f)=>(c[Ie(f)]=1,c),{});let o=this.value,a=this.count,l=0;function u(c){let f,d;o.length<r?o.push(c):(d=~~((a+1)*xo()),d<o.length&&d>=l&&(f=o[d],s[Ie(f)]&&n.rem.push(f),o[d]=c)),++a}if(t.rem.length&&(t.visit(t.REM,c=>{const f=Ie(c);s[f]&&(s[f]=-1,n.rem.push(c)),--a}),o=o.filter(c=>-1!==s[Ie(c)])),(t.rem.length||i)&&o.length<r&&t.source&&(l=a=o.length,t.visit(t.SOURCE,c=>{s[Ie(c)]||u(c)}),l=-1),i&&o.length>r){const c=o.length-r;for(let f=0;f<c;++f)s[Ie(o[f])]=-1,n.rem.push(o[f]);o=o.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{s[Ie(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,u),(t.add.length||l<0)&&(n.add=o.filter(c=>!s[Ie(c)])),this.count=a,this.value=n.source=o,n}}),Jk.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},ce(Jk,K,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),i=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Vs(e.start,e.stop,e.step||1).map(r=>{const s={};return s[i]=r,jt(s)}),n.add=t.add.concat(this.value),n}}),ce(cq,K,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});const fq=["unit0","unit1"];function dq(e){K.call(this,yg(),e)}function hq(e){K.call(this,null,e)}Xk.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:A2,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:fq}]},ce(Xk,K,{transform(e,t){const n=e.field,i=!1!==e.interval,r="utc"===e.timezone,s=this._floor(e,t),o=(r?Ag:xg)(s.unit).offset,a=e.as||fq,l=a[0],u=a[1],c=s.step;let f=s.start||1/0,d=s.stop||-1/0,h=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(or(n)))&&(h=(t=t.reflow(!0)).SOURCE,f=1/0,d=-1/0),t.visit(h,p=>{const g=n(p);let m,_;null==g?(p[l]=null,i&&(p[u]=null)):(p[l]=m=_=s(g),i&&(p[u]=_=o(m,c)),m<f&&(f=m),_>d&&(d=_))}),s.start=f,s.stop=d,t.modifies(i?a:l)},_floor(e,t){const n="utc"===e.timezone,{units:i,step:r}=e.units?{units:e.units,step:e.step||1}:AG({extent:e.extent||cl(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),s=O2(i),o=this.value||{},a=(n?mG:gG)(s,r);return a.unit=yt(s),a.units=s,a.step=r,a.start=o.start,a.stop=o.stop,this.value=a}}),ce(dq,K,{transform(e,t){const n=t.dataflow,i=e.field,r=this.value,s=a=>r.set(i(a),a);let o=!0;return e.modified("field")||t.modified(i.fields)?(r.clear(),t.visit(t.SOURCE,s)):t.changed()?(t.visit(t.REM,a=>r.delete(i(a))),t.visit(t.ADD,s)):o=!1,this.modified(o),r.empty>n.cleanThreshold&&n.runAfter(r.clean),t.fork()}}),ce(hq,K,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(Pd(e.sort)):t.source).map(e.field))}});const ny={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?++e:e}}},percent_rank:function(){const e=ny.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,i=t.compare;let r=t.index;if(e<r){for(;r+1<n.length&&!i(n[r],n[r+1]);)++r;e=r}return(1+e)/n.length}}},ntile:function(e,t){(t=+t)>0||Q("ntile num must be greater than zero.");const n=ny.cume_dist(),i=n.next;return{init:n.init,next:r=>Math.ceil(t*i(r))}},lag:function(e,t){return t=+t||1,{next:n=>{const i=n.index-t;return i>=0?e(n.data[i]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const i=n.index+t,r=n.data;return i<r.length?e(r[i]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return(t=+t)>0||Q("nth_value nth must be greater than zero."),{next:n=>{const i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const i=e(n.data[n.index]);return null!=i?t=i:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:i=>{const r=i.data;return i.index<=n?t:(n=function Xxe(e,t,n){for(let i=t.length;n<i;++n)if(null!=e(t[n]))return n;return-1}(e,r,i.index))<0?(n=r.length,t=null):t=e(r[n])}}}},Qxe=Object.keys(ny);function pq(e){const t=ve(e.ops),n=ve(e.fields),i=ve(e.params),r=ve(e.as),s=this.outputs=[],o=this.windows=[],a={},l={},u=[],c=[];let f=!0;function d(h){ve(or(h)).forEach(p=>a[p]=1)}d(e.sort),t.forEach((h,p)=>{const g=n[p],m=Un(g),_=VW(h,m,r[p]);if(d(g),s.push(_),Oe(ny,h))o.push(function Jxe(e,t,n,i){const r=ny[e](t,n);return{init:r.init||Ic,update:function(s,o){o[i]=r.next(s)}}}(h,n[p],i[p],_));else{if(null==g&&"count"!==h&&Q("Null aggregate field specified."),"count"===h)return void u.push(_);f=!1;let y=l[m];y||(y=l[m]=[],y.field=g,c.push(y)),y.push(HW(h,_))}}),(u.length||c.length)&&(this.cell=function Zxe(e,t,n){e=e.map(l=>zW(l,l.field));const i={num:0,agg:null,store:!1,count:t};if(!n)for(var r=e.length,s=i.agg=Array(r),o=0;o<r;++o)s[o]=new e[o](i);if(i.store)var a=i.data=new Ak;return i.add=function(l){if(i.num+=1,!n){a&&a.add(l);for(let u=0;u<r;++u)s[u].add(s[u].get(l),l)}},i.rem=function(l){if(i.num-=1,!n){a&&a.rem(l);for(let u=0;u<r;++u)s[u].rem(s[u].get(l),l)}},i.set=function(l){let u,c;for(a&&a.values(),u=0,c=t.length;u<c;++u)l[t[u]]=i.num;if(!n)for(u=0,c=s.length;u<c;++u)s[u].set(l)},i.init=function(){i.num=0,a&&a.reset();for(let l=0;l<r;++l)s[l].init()},i}(c,u,f)),this.inputs=Object.keys(a)}const gq=pq.prototype;function Qk(e){K.call(this,{},e),this._mlen=0,this._mods=[]}function eAe(e,t,n,i){const r=i.sort,s=r&&!i.ignorePeers,o=i.frame||[null,0],a=e.data(n),l=a.length,u=s?F_(r):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:r||ur(-1)};t.init();for(let f=0;f<l;++f)tAe(c,o,f,l),s&&nAe(c,u),t.update(c,a[f])}function tAe(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=null==t[0]?0:Math.max(0,n-Math.abs(t[0])),e.i1=null==t[1]?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n}function nAe(e,t){const n=e.i0,i=e.i1-1,r=e.compare,s=e.data,o=s.length-1;n>0&&!r(s[n],s[n-1])&&(e.i0=t.left(s,s[n])),i<o&&!r(s[i],s[i+1])&&(e.i1=t.right(s,s[i]))}function DD(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function CD(e){this._context=e}function Yc(){}function mq(e){this._context=e}function _q(e){this._context=e}function yq(e,t){this._basis=new CD(e),this._beta=t}gq.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()},gq.update=function(e,t){const n=this.cell,i=this.windows,r=e.data,s=i&&i.length;let o;if(n){for(o=e.p0;o<e.i0;++o)n.rem(r[o]);for(o=e.p1;o<e.i1;++o)n.add(r[o]);n.set(t)}for(o=0;o<s;++o)i[o].update(e,t)},Qk.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Qxe.concat(ty)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},ce(Qk,K,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),i=Pd(e.sort),r=Sk(e.groupby),s=a=>this.group(r(a));let o=this.state;(!o||n)&&(o=this.state=new pq(e)),n||t.modified(o.inputs)?(this.value={},t.visit(t.SOURCE,a=>s(a).add(a))):(t.visit(t.REM,a=>s(a).remove(a)),t.visit(t.ADD,a=>s(a).add(a)));for(let a=0,l=this._mlen;a<l;++a)eAe(this._mods[a],o,i,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(o.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=GW(Ie),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}}),CD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:DD(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:DD(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},mq.prototype={areaStart:Yc,areaEnd:Yc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:DD(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},_q.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:DD(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},yq.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var l,i=e[0],r=t[0],s=e[n]-i,o=t[n]-r,a=-1;++a<=n;)this._basis.point(this._beta*e[a]+(1-this._beta)*(i+(l=a/n)*s),this._beta*t[a]+(1-this._beta)*(r+l*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const oAe=function e(t){function n(i){return 1===t?new CD(i):new yq(i,t)}return n.beta=function(i){return e(+i)},n}(.85);function ED(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Zk(e,t){this._context=e,this._k=(1-t)/6}Zk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:ED(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:ED(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const aAe=function e(t){function n(i){return new Zk(i,t)}return n.tension=function(i){return e(+i)},n}(0);function eI(e,t){this._context=e,this._k=(1-t)/6}eI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ED(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const lAe=function e(t){function n(i){return new eI(i,t)}return n.tension=function(i){return e(+i)},n}(0);function tI(e,t){this._context=e,this._k=(1-t)/6}tI.prototype={areaStart:Yc,areaEnd:Yc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:ED(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const uAe=function e(t){function n(i){return new tI(i,t)}return n.tension=function(i){return e(+i)},n}(0),vq=Math.abs,dr=Math.atan2,Nu=Math.cos,cAe=Math.max,Ig=Math.min,ls=Math.sin,vn=Math.sqrt,hr=1e-12,Kc=Math.PI,SD=Kc/2,iy=2*Kc;function fAe(e){return e>1?0:e<-1?Kc:Math.acos(e)}function bq(e){return e>=1?SD:e<=-1?-SD:Math.asin(e)}function nI(e,t,n){var i=e._x1,r=e._y1,s=e._x2,o=e._y2;if(e._l01_a>hr){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,r=(r*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>hr){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*u+e._x1*e._l23_2a-t*e._l12_2a)/c,o=(o*u+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(i,r,s,o,e._x2,e._y2)}function wq(e,t){this._context=e,this._alpha=t}wq.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:nI(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const dAe=function e(t){function n(i){return t?new wq(i,t):new Zk(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function Dq(e,t){this._context=e,this._alpha=t}Dq.prototype={areaStart:Yc,areaEnd:Yc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:nI(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const hAe=function e(t){function n(i){return t?new Dq(i,t):new tI(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function Cq(e,t){this._context=e,this._alpha=t}Cq.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:nI(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const pAe=function e(t){function n(i){return t?new Cq(i,t):new eI(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function Eq(e){this._context=e}function iI(e){return new Eq(e)}function Sq(e){this._context=e}function xq(e){return e<0?-1:1}function Aq(e,t,n){var i=e._x1-e._x0,r=t-e._x1,s=(e._y1-e._y0)/(i||r<0&&-0),o=(n-e._y1)/(r||i<0&&-0),a=(s*r+o*i)/(i+r);return(xq(s)+xq(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function Tq(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function rI(e,t,n){var i=e._x0,s=e._x1,o=e._y1,a=(s-i)/3;e._context.bezierCurveTo(i+a,e._y0+a*t,s-a,o-a*n,s,o)}function xD(e){this._context=e}function Oq(e){this._context=new Mq(e)}function Mq(e){this._context=e}function Nq(e){this._context=e}function kq(e){var t,i,n=e.length-1,r=new Array(n),s=new Array(n),o=new Array(n);for(r[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)r[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(r[n-1]=2,s[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)s[t]-=i=r[t]/s[t-1],o[t]-=i*o[t-1];for(r[n-1]=o[n-1]/s[n-1],t=n-2;t>=0;--t)r[t]=(o[t]-r[t+1])/s[t];for(s[n-1]=(e[n]+r[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-r[t+1];return[r,s]}function AD(e,t){this._context=e,this._t=t}Eq.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},Sq.prototype={areaStart:Yc,areaEnd:Yc,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},xD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:rI(this,this._t0,Tq(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,rI(this,Tq(this,n=Aq(this,e,t)),n);break;default:rI(this,this._t0,n=Aq(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(Oq.prototype=Object.create(xD.prototype)).point=function(e,t){xD.prototype.point.call(this,t,e)},Mq.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,s){this._context.bezierCurveTo(t,e,i,n,s,r)}},Nq.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var i=kq(e),r=kq(t),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(i[0][s],r[0][s],i[1][s],r[1][s],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},AD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};const sI=Math.PI,oI=2*sI,Bd=1e-6,DAe=oI-Bd;function aI(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Iq(){return new aI}aI.prototype=Iq.prototype={constructor:aI,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,i){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(e,t,n,i,r,s){this._+="C"+ +e+","+ +t+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+s)},arcTo:function(e,t,n,i,r){var s=this._x1,o=this._y1,a=(n=+n)-(e=+e),l=(i=+i)-(t=+t),u=s-e,c=o-t,f=u*u+c*c;if((r=+r)<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>Bd)if(Math.abs(c*a-l*u)>Bd&&r){var d=n-s,h=i-o,p=a*a+l*l,g=d*d+h*h,m=Math.sqrt(p),_=Math.sqrt(f),y=r*Math.tan((sI-Math.acos((p+f-g)/(2*m*_)))/2),v=y/_,b=y/m;Math.abs(v-1)>Bd&&(this._+="L"+(e+v*u)+","+(t+v*c)),this._+="A"+r+","+r+",0,0,"+ +(c*d>u*h)+","+(this._x1=e+b*a)+","+(this._y1=t+b*l)}else this._+="L"+(this._x1=e)+","+(this._y1=t)},arc:function(e,t,n,i,r,s){e=+e,t=+t,s=!!s;var o=(n=+n)*Math.cos(i),a=n*Math.sin(i),l=e+o,u=t+a,c=1^s,f=s?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+u:(Math.abs(this._x1-l)>Bd||Math.abs(this._y1-u)>Bd)&&(this._+="L"+l+","+u),n&&(f<0&&(f=f%oI+oI),f>DAe?this._+="A"+n+","+n+",0,1,"+c+","+(e-o)+","+(t-a)+"A"+n+","+n+",0,1,"+c+","+(this._x1=l)+","+(this._y1=u):f>Bd&&(this._+="A"+n+","+n+",0,"+ +(f>=sI)+","+c+","+(this._x1=e+n*Math.cos(r))+","+(this._y1=t+n*Math.sin(r))))},rect:function(e,t,n,i){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};const $d=Iq;function Vt(e){return function(){return e}}function CAe(e){return e.innerRadius}function EAe(e){return e.outerRadius}function SAe(e){return e.startAngle}function xAe(e){return e.endAngle}function AAe(e){return e&&e.padAngle}function TAe(e,t,n,i,r,s,o,a){var l=n-e,u=i-t,c=o-r,f=a-s,d=f*l-c*u;if(!(d*d<hr))return[e+(d=(c*(t-s)-f*(e-r))/d)*l,t+d*u]}function TD(e,t,n,i,r,s,o){var a=e-n,l=t-i,u=(o?s:-s)/vn(a*a+l*l),c=u*l,f=-u*a,d=e+c,h=t+f,p=n+c,g=i+f,m=(d+p)/2,_=(h+g)/2,y=p-d,v=g-h,b=y*y+v*v,D=r-s,C=d*g-p*h,w=(v<0?-1:1)*vn(cAe(0,D*D*b-C*C)),E=(C*v-y*w)/b,O=(-C*y-v*w)/b,M=(C*v+y*w)/b,N=(-C*y+v*w)/b,R=E-m,P=O-_,A=M-m,x=N-_;return R*R+P*P>A*A+x*x&&(E=M,O=N),{cx:E,cy:O,x01:-c,y01:-f,x11:E*(r/D-1),y11:O*(r/D-1)}}function Rq(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function Fq(e){return e[0]}function Pq(e){return e[1]}function Lq(e,t){var n=Vt(!0),i=null,r=iI,s=null;function o(a){var l,c,d,u=(a=Rq(a)).length,f=!1;for(null==i&&(s=r(d=$d())),l=0;l<=u;++l)!(l<u&&n(c=a[l],l,a))===f&&((f=!f)?s.lineStart():s.lineEnd()),f&&s.point(+e(c,l,a),+t(c,l,a));if(d)return s=null,d+""||null}return e="function"==typeof e?e:void 0===e?Fq:Vt(e),t="function"==typeof t?t:void 0===t?Pq:Vt(t),o.x=function(a){return arguments.length?(e="function"==typeof a?a:Vt(+a),o):e},o.y=function(a){return arguments.length?(t="function"==typeof a?a:Vt(+a),o):t},o.defined=function(a){return arguments.length?(n="function"==typeof a?a:Vt(!!a),o):n},o.curve=function(a){return arguments.length?(r=a,null!=i&&(s=r(i)),o):r},o.context=function(a){return arguments.length?(null==a?i=s=null:s=r(i=a),o):i},o}function jq(e,t,n){var i=null,r=Vt(!0),s=null,o=iI,a=null;function l(c){var f,d,h,g,_,p=(c=Rq(c)).length,m=!1,y=new Array(p),v=new Array(p);for(null==s&&(a=o(_=$d())),f=0;f<=p;++f){if(!(f<p&&r(g=c[f],f,c))===m)if(m=!m)d=f,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),h=f-1;h>=d;--h)a.point(y[h],v[h]);a.lineEnd(),a.areaEnd()}m&&(y[f]=+e(g,f,c),v[f]=+t(g,f,c),a.point(i?+i(g,f,c):y[f],n?+n(g,f,c):v[f]))}if(_)return a=null,_+""||null}function u(){return Lq().defined(r).curve(o).context(s)}return e="function"==typeof e?e:void 0===e?Fq:Vt(+e),t="function"==typeof t?t:Vt(void 0===t?0:+t),n="function"==typeof n?n:void 0===n?Pq:Vt(+n),l.x=function(c){return arguments.length?(e="function"==typeof c?c:Vt(+c),i=null,l):e},l.x0=function(c){return arguments.length?(e="function"==typeof c?c:Vt(+c),l):e},l.x1=function(c){return arguments.length?(i=null==c?null:"function"==typeof c?c:Vt(+c),l):i},l.y=function(c){return arguments.length?(t="function"==typeof c?c:Vt(+c),n=null,l):t},l.y0=function(c){return arguments.length?(t="function"==typeof c?c:Vt(+c),l):t},l.y1=function(c){return arguments.length?(n=null==c?null:"function"==typeof c?c:Vt(+c),l):n},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(n)},l.lineX1=function(){return u().x(i).y(t)},l.defined=function(c){return arguments.length?(r="function"==typeof c?c:Vt(!!c),l):r},l.curve=function(c){return arguments.length?(o=c,null!=s&&(a=o(s)),l):o},l.context=function(c){return arguments.length?(null==c?s=a=null:a=o(s=c),l):s},l}vn(3);const lI={draw(e,t){const n=vn(t/Kc);e.moveTo(n,0),e.arc(0,0,n,0,iy)}};vn(1/3),ls(Kc/10),ls(7*Kc/10);function Jc(e,t){if("undefined"!=typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}ls(iy/10),Nu(iy/10),vn(3),vn(3),vn(3),vn(12);const Vq=F_(Ou),OD=Vq.right,XAe=Vq.left,ry=(F_(CW),OD);function Rg(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function sy(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function Xc(){}var Fg=1/.7,Pg="\\s*([+-]?\\d+)\\s*",oy="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",hl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",QAe=/^#([0-9a-f]{3,8})$/,ZAe=new RegExp(`^rgb\\(${Pg},${Pg},${Pg}\\)$`),eTe=new RegExp(`^rgb\\(${hl},${hl},${hl}\\)$`),tTe=new RegExp(`^rgba\\(${Pg},${Pg},${Pg},${oy}\\)$`),nTe=new RegExp(`^rgba\\(${hl},${hl},${hl},${oy}\\)$`),iTe=new RegExp(`^hsl\\(${oy},${hl},${hl}\\)$`),rTe=new RegExp(`^hsla\\(${oy},${hl},${hl},${oy}\\)$`),Hq={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Uq(){return this.rgb().formatHex()}function zq(){return this.rgb().formatRgb()}function ay(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=QAe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Gq(t):3===n?new ki(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?MD(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?MD(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=ZAe.exec(e))?new ki(t[1],t[2],t[3],1):(t=eTe.exec(e))?new ki(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=tTe.exec(e))?MD(t[1],t[2],t[3],t[4]):(t=nTe.exec(e))?MD(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=iTe.exec(e))?Yq(t[1],t[2]/100,t[3]/100,1):(t=rTe.exec(e))?Yq(t[1],t[2]/100,t[3]/100,t[4]):Hq.hasOwnProperty(e)?Gq(Hq[e]):"transparent"===e?new ki(NaN,NaN,NaN,0):null}function Gq(e){return new ki(e>>16&255,e>>8&255,255&e,1)}function MD(e,t,n,i){return i<=0&&(e=t=n=NaN),new ki(e,t,n,i)}function fI(e){return e instanceof Xc||(e=ay(e)),e?new ki((e=e.rgb()).r,e.g,e.b,e.opacity):new ki}function Qc(e,t,n,i){return 1===arguments.length?fI(e):new ki(e,t,n,null==i?1:i)}function ki(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}function Wq(){return`#${Ud(this.r)}${Ud(this.g)}${Ud(this.b)}`}function qq(){const e=ND(this.opacity);return`${1===e?"rgb(":"rgba("}${Hd(this.r)}, ${Hd(this.g)}, ${Hd(this.b)}${1===e?")":`, ${e})`}`}function ND(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Hd(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ud(e){return((e=Hd(e))<16?"0":"")+e.toString(16)}function Yq(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new fa(e,t,n,i)}function Kq(e){if(e instanceof fa)return new fa(e.h,e.s,e.l,e.opacity);if(e instanceof Xc||(e=ay(e)),!e)return new fa;if(e instanceof fa)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),s=Math.max(t,n,i),o=NaN,a=s-r,l=(s+r)/2;return a?(o=t===s?(n-i)/a+6*(n<i):n===s?(i-t)/a+2:(t-n)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new fa(o,a,l,e.opacity)}function kD(e,t,n,i){return 1===arguments.length?Kq(e):new fa(e,t,n,null==i?1:i)}function fa(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function Jq(e){return(e=(e||0)%360)<0?e+360:e}function ID(e){return Math.max(0,Math.min(1,e||0))}function dI(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Xq(e,t,n,i,r){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*i+o*r)/6}function Qq(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],s=e[i+1];return Xq((n-i/t)*t,i>0?e[i-1]:2*r-s,r,s,i<t-1?e[i+2]:2*s-r)}}function Zq(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t);return Xq((n-i/t)*t,e[(i+t-1)%t],e[i%t],e[(i+1)%t],e[(i+2)%t])}}Rg(Xc,ay,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Uq,formatHex:Uq,formatHex8:function sTe(){return this.rgb().formatHex8()},formatHsl:function oTe(){return Kq(this).formatHsl()},formatRgb:zq,toString:zq}),Rg(ki,Qc,sy(Xc,{brighter(e){return e=null==e?Fg:Math.pow(Fg,e),new ki(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new ki(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ki(Hd(this.r),Hd(this.g),Hd(this.b),ND(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Wq,formatHex:Wq,formatHex8:function aTe(){return`#${Ud(this.r)}${Ud(this.g)}${Ud(this.b)}${Ud(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:qq,toString:qq})),Rg(fa,kD,sy(Xc,{brighter(e){return e=null==e?Fg:Math.pow(Fg,e),new fa(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new fa(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new ki(dI(e>=240?e-240:e+120,r,i),dI(e,r,i),dI(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new fa(Jq(this.h),ID(this.s),ID(this.l),ND(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ND(this.opacity);return`${1===e?"hsl(":"hsla("}${Jq(this.h)}, ${100*ID(this.s)}%, ${100*ID(this.l)}%${1===e?")":`, ${e})`}`}}));const RD=e=>()=>e;function eY(e,t){return function(n){return e+n*t}}function FD(e,t){var n=t-e;return n?eY(e,n>180||n<-180?n-360*Math.round(n/360):n):RD(isNaN(e)?t:e)}function Ii(e,t){var n=t-e;return n?eY(e,n):RD(isNaN(e)?t:e)}const hI=function e(t){var n=function uTe(e){return 1==(e=+e)?Ii:function(t,n){return n-t?function lTe(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}(t,n,e):RD(isNaN(t)?n:t)}}(t);function i(r,s){var o=n((r=Qc(r)).r,(s=Qc(s)).r),a=n(r.g,s.g),l=n(r.b,s.b),u=Ii(r.opacity,s.opacity);return function(c){return r.r=o(c),r.g=a(c),r.b=l(c),r.opacity=u(c),r+""}}return i.gamma=e,i}(1);function tY(e){return function(t){var o,a,n=t.length,i=new Array(n),r=new Array(n),s=new Array(n);for(o=0;o<n;++o)a=Qc(t[o]),i[o]=a.r||0,r[o]=a.g||0,s[o]=a.b||0;return i=e(i),r=e(r),s=e(s),a.opacity=1,function(l){return a.r=i(l),a.g=r(l),a.b=s(l),a+""}}}var cTe=tY(Qq),fTe=tY(Zq);function pI(e,t){t||(t=[]);var r,n=e?Math.min(t.length,e.length):0,i=t.slice();return function(s){for(r=0;r<n;++r)i[r]=e[r]*(1-s)+t[r]*s;return i}}function nY(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function dTe(e,t){return(nY(t)?pI:iY)(e,t)}function iY(e,t){var o,n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),s=new Array(n);for(o=0;o<i;++o)r[o]=Zc(e[o],t[o]);for(;o<n;++o)s[o]=t[o];return function(a){for(o=0;o<i;++o)s[o]=r[o](a);return s}}function rY(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function da(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function sY(e,t){var r,n={},i={};for(r in(null===e||"object"!=typeof e)&&(e={}),(null===t||"object"!=typeof t)&&(t={}),t)r in e?n[r]=Zc(e[r],t[r]):i[r]=t[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var gI=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,mI=new RegExp(gI.source,"g");function oY(e,t){var i,r,s,n=gI.lastIndex=mI.lastIndex=0,o=-1,a=[],l=[];for(e+="",t+="";(i=gI.exec(e))&&(r=mI.exec(t));)(s=r.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,l.push({i:o,x:da(i,r)})),n=mI.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?function pTe(e){return function(t){return e(t)+""}}(l[0].x):function hTe(e){return function(){return e}}(t):(t=l.length,function(u){for(var f,c=0;c<t;++c)a[(f=l[c]).i]=f.x(u);return a.join("")})}function Zc(e,t){var i,n=typeof t;return null==t||"boolean"===n?RD(t):("number"===n?da:"string"===n?(i=ay(t))?(t=i,hI):oY:t instanceof ay?hI:t instanceof Date?rY:nY(t)?pI:Array.isArray(t)?iY:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?sY:da)(e,t)}function ly(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function _I(e){return+e}var aY=[0,1];function us(e){return e}function yI(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function gTe(e){return function(){return e}}(isNaN(t)?NaN:.5)}function _Te(e,t,n){var i=e[0],r=e[1],s=t[0],o=t[1];return r<i?(i=yI(r,i),s=n(o,s)):(i=yI(i,r),s=n(s,o)),function(a){return s(i(a))}}function yTe(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),s=new Array(i),o=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<i;)r[o]=yI(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(a){var l=ry(e,a,1,i)-1;return s[l](r[l](a))}}function uy(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function PD(){var i,r,s,a,l,u,e=aY,t=aY,n=Zc,o=us;function c(){var d=Math.min(e.length,t.length);return o!==us&&(o=function mTe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}(e[0],e[d-1])),a=d>2?yTe:_Te,l=u=null,f}function f(d){return null==d||isNaN(d=+d)?s:(l||(l=a(e.map(i),t,n)))(i(o(d)))}return f.invert=function(d){return o(r((u||(u=a(t,e.map(i),da)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,_I),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=ly,c()},f.clamp=function(d){return arguments.length?(o=!!d||us,c()):o!==us},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(s=d,f):s},function(d,h){return i=d,r=h,c()}}function lY(){return PD()(us,us)}function pl(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function ef(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}function uY(e,t,n,i){var s,r=jc(e,t,n);switch((i=Nd(null==i?",f":i)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null==i.precision&&!isNaN(s=Vz(r,o))&&(i.precision=s),g2(i,o);case"":case"e":case"g":case"p":case"r":null==i.precision&&!isNaN(s=Hz(r,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=s-("e"===i.type));break;case"f":case"%":null==i.precision&&!isNaN(s=Uz(r))&&(i.precision=s-2*("%"===i.type))}return Yw(i)}function zd(e){var t=e.domain;return e.ticks=function(n){var i=t();return h2(i[0],i[i.length-1],null==n?10:n)},e.tickFormat=function(n,i){var r=t();return uY(r[0],r[r.length-1],null==n?10:n,i)},e.nice=function(n){null==n&&(n=10);var l,u,i=t(),r=0,s=i.length-1,o=i[r],a=i[s],c=10;for(a<o&&(u=o,o=a,a=u,u=r,r=s,s=u);c-- >0;){if((u=$z(o,a,n))===l)return i[r]=o,i[s]=a,t(i);if(u>0)o=Math.floor(o/u)*u,a=Math.ceil(a/u)*u;else{if(!(u<0))break;o=Math.ceil(o*u)/u,a=Math.floor(a*u)/u}l=u}return e},e}function dY(e,t){var o,n=0,i=(e=e.slice()).length-1,r=e[n],s=e[i];return s<r&&(o=n,n=i,i=o,o=r,r=s,s=o),e[n]=t.floor(r),e[i]=t.ceil(s),e}function hY(e){return Math.log(e)}function pY(e){return Math.exp(e)}function vTe(e){return-Math.log(-e)}function bTe(e){return-Math.exp(-e)}function wTe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function gY(e){return(t,n)=>-e(-t,n)}function vI(e){const t=e(hY,pY),n=t.domain;let r,s,i=10;function o(){return r=function CTe(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(i),s=function DTe(e){return 10===e?wTe:e===Math.E?Math.exp:t=>Math.pow(e,t)}(i),n()[0]<0?(r=gY(r),s=gY(s),e(vTe,bTe)):e(hY,pY),t}return t.base=function(a){return arguments.length?(i=+a,o()):i},t.domain=function(a){return arguments.length?(n(a),o()):n()},t.ticks=a=>{const l=n();let u=l[0],c=l[l.length-1];const f=c<u;f&&([u,c]=[c,u]);let p,g,d=r(u),h=r(c);const m=null==a?10:+a;let _=[];if(!(i%1)&&h-d<m){if(d=Math.floor(d),h=Math.ceil(h),u>0){for(;d<=h;++d)for(p=1;p<i;++p)if(g=d<0?p/s(-d):p*s(d),!(g<u)){if(g>c)break;_.push(g)}}else for(;d<=h;++d)for(p=i-1;p>=1;--p)if(g=d>0?p/s(-d):p*s(d),!(g<u)){if(g>c)break;_.push(g)}2*_.length<m&&(_=h2(u,c,m))}else _=h2(d,h,Math.min(h-d,m)).map(s);return f?_.reverse():_},t.tickFormat=(a,l)=>{if(null==a&&(a=10),null==l&&(l=10===i?"s":","),"function"!=typeof l&&(!(i%1)&&null==(l=Nd(l)).precision&&(l.trim=!0),l=Yw(l)),a===1/0)return l;const u=Math.max(1,i*a/t.ticks().length);return c=>{let f=c/s(Math.round(r(c)));return f*i<i-.5&&(f*=i),f<=u?l(c):""}},t.nice=()=>n(dY(n(),{floor:a=>s(Math.floor(r(a))),ceil:a=>s(Math.ceil(r(a)))})),t}function _Y(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function ETe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function STe(e){return e<0?-e*e:e*e}function bI(e){var t=e(us,us),n=1;function i(){return 1===n?e(us,us):.5===n?e(ETe,STe):e(_Y(n),_Y(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,i()):n},zd(t)}function wI(){var e=bI(PD());return e.copy=function(){return uy(e,wI()).exponent(e.exponent())},pl.apply(e,arguments),e}function yY(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function vY(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function DI(e){var t=1,n=e(yY(t),vY(t));return n.constant=function(i){return arguments.length?e(yY(t=+i),vY(t)):t},zd(n)}function wY(e,t,n,i,r,s){const o=[[Hc,1,Au],[Hc,5,5e3],[Hc,15,15e3],[Hc,30,3e4],[s,1,Eo],[s,5,5*Eo],[s,15,15*Eo],[s,30,30*Eo],[r,1,Tu],[r,3,3*Tu],[r,6,6*Tu],[r,12,12*Tu],[i,1,kd],[i,2,2*kd],[n,1,y2],[t,1,Xz],[t,3,3*Xz],[e,1,v2]];function l(u,c,f){const d=Math.abs(c-u)/f,h=F_(([,,m])=>m).right(o,d);if(h===o.length)return e.every(jc(u/v2,c/v2,f));if(0===h)return C2.every(Math.max(jc(u,c,f),1));const[p,g]=o[d/o[h-1][2]<o[h][2]/d?h-1:h];return p.every(g)}return[function a(u,c,f){const d=c<u;d&&([u,c]=[c,u]);const h=f&&"function"==typeof f.range?f:l(u,c,f),p=h?h.range(u,+c+1):[];return d?p.reverse():p},l]}const[ATe,TTe]=wY(Uc,Zw,Cg,$c,S2,x2),[OTe,MTe]=wY(Vc,Xw,wg,Bc,w2,D2);function NTe(e){return new Date(e)}function kTe(e){return e instanceof Date?+e:+new Date(+e)}function CI(e,t,n,i,r,s,o,a,l,u){var c=lY(),f=c.invert,d=c.domain,h=u(".%L"),p=u(":%S"),g=u("%I:%M"),m=u("%I %p"),_=u("%a %d"),y=u("%b %d"),v=u("%B"),b=u("%Y");function D(C){return(l(C)<C?h:a(C)<C?p:o(C)<C?g:s(C)<C?m:i(C)<C?r(C)<C?_:y:n(C)<C?v:b)(C)}return c.invert=function(C){return new Date(f(C))},c.domain=function(C){return arguments.length?d(Array.from(C,kTe)):d().map(NTe)},c.ticks=function(C){var w=d();return e(w[0],w[w.length-1],null==C?10:C)},c.tickFormat=function(C,w){return null==w?D:u(w)},c.nice=function(C){var w=d();return(!C||"function"!=typeof C.range)&&(C=t(w[0],w[w.length-1],null==C?10:C)),C?d(dY(w,C)):c},c.copy=function(){return uy(c,CI(e,t,n,i,r,s,o,a,l,u))},c}function LD(){var n,i,r,s,l,e=0,t=1,o=us,a=!1;function u(f){return null==f||isNaN(f=+f)?l:o(0===r?.5:(f=(s(f)-n)*r,a?Math.max(0,Math.min(1,f)):f))}function c(f){return function(d){var h,p;return arguments.length?([h,p]=d,o=f(h,p),u):[o(0),o(1)]}}return u.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),i=s(t=+t),r=n===i?0:1/(i-n),u):[e,t]},u.clamp=function(f){return arguments.length?(a=!!f,u):a},u.interpolator=function(f){return arguments.length?(o=f,u):o},u.range=c(Zc),u.rangeRound=c(ly),u.unknown=function(f){return arguments.length?(l=f,u):l},function(f){return s=f,n=f(e),i=f(t),r=n===i?0:1/(i-n),u}}function tf(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function EI(){var e=zd(LD()(us));return e.copy=function(){return tf(e,EI())},ef.apply(e,arguments)}function SI(){var e=bI(LD());return e.copy=function(){return tf(e,SI()).exponent(e.exponent())},ef.apply(e,arguments)}function xI(e,t){void 0===t&&(t=e,e=Zc);for(var n=0,i=t.length-1,r=t[0],s=new Array(i<0?0:i);n<i;)s[n]=e(r,r=t[++n]);return function(o){var a=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return s[a](o-a)}}function jD(){var r,s,o,a,l,c,d,e=0,t=.5,n=1,i=1,u=us,f=!1;function h(g){return isNaN(g=+g)?d:(g=.5+((g=+c(g))-s)*(i*g<i*s?a:l),u(f?Math.max(0,Math.min(1,g)):g))}function p(g){return function(m){var _,y,v;return arguments.length?([_,y,v]=m,u=xI(g,[_,y,v]),h):[u(0),u(.5),u(1)]}}return h.domain=function(g){return arguments.length?([e,t,n]=g,r=c(e=+e),s=c(t=+t),o=c(n=+n),a=r===s?0:.5/(s-r),l=s===o?0:.5/(o-s),i=s<r?-1:1,h):[e,t,n]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(u=g,h):u},h.range=p(Zc),h.rangeRound=p(ly),h.unknown=function(g){return arguments.length?(d=g,h):d},function(g){return c=g,r=g(e),s=g(t),o=g(n),a=r===s?0:.5/(s-r),l=s===o?0:.5/(o-s),i=s<r?-1:1,h}}function AI(){var e=bI(jD());return e.copy=function(){return tf(e,AI()).exponent(e.exponent())},ef.apply(e,arguments)}class MY extends Map{constructor(t,n=IY){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),null!=t)for(const[i,r]of t)this.set(i,r)}get(t){return super.get(TI(this,t))}has(t){return super.has(TI(this,t))}set(t,n){return super.set(NY(this,t),n)}delete(t){return super.delete(kY(this,t))}}class BD extends Set{constructor(t,n=IY){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),null!=t)for(const i of t)this.add(i)}has(t){return super.has(TI(this,t))}add(t){return super.add(NY(this,t))}delete(t){return super.delete(kY(this,t))}}function TI({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function NY({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function kY({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}function IY(e){return null!==e&&"object"==typeof e?e.valueOf():e}const OI=Symbol("implicit");function MI(){var e=new MY,t=[],n=[],i=OI;function r(s){let o=e.get(s);if(void 0===o){if(i!==OI)return i;e.set(s,o=t.push(s)-1)}return n[o%n.length]}return r.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new MY;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return r},r.range=function(s){return arguments.length?(n=Array.from(s),r):n.slice()},r.unknown=function(s){return arguments.length?(i=s,r):i},r.copy=function(){return MI(t,n).unknown(i)},pl.apply(r,arguments),r}function LTe(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function jTe(e,t){var n=FD(+e,+t);return function(i){var r=n(i);return r-360*Math.floor(r/360)}}var $D,RY=180/Math.PI,NI={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function FY(e,t,n,i,r,s){var o,a,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*i)&&(n-=e*l,i-=t*l),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,l/=a),e*i<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(t,e)*RY,skewX:Math.atan(l)*RY,scaleX:o,scaleY:a}}function PY(e,t,n,i){function r(u){return u.length?u.pop()+" ":""}return function(u,c){var f=[],d=[];return u=e(u),c=e(c),function s(u,c,f,d,h,p){if(u!==f||c!==d){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:da(u,f)},{i:g-2,x:da(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}(u.translateX,u.translateY,c.translateX,c.translateY,f,d),function o(u,c,f,d){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),d.push({i:f.push(r(f)+"rotate(",null,i)-2,x:da(u,c)})):c&&f.push(r(f)+"rotate("+c+i)}(u.rotate,c.rotate,f,d),function a(u,c,f,d){u!==c?d.push({i:f.push(r(f)+"skewX(",null,i)-2,x:da(u,c)}):c&&f.push(r(f)+"skewX("+c+i)}(u.skewX,c.skewX,f,d),function l(u,c,f,d,h,p){if(u!==f||c!==d){var g=h.push(r(h)+"scale(",null,",",null,")");p.push({i:g-4,x:da(u,f)},{i:g-2,x:da(c,d)})}else(1!==f||1!==d)&&h.push(r(h)+"scale("+f+","+d+")")}(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,d),u=c=null,function(h){for(var m,p=-1,g=d.length;++p<g;)f[(m=d[p]).i]=m.x(h);return f.join("")}}}var VTe=PY(function BTe(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?NI:FY(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),HTe=PY(function $Te(e){return null!=e&&($D||($D=document.createElementNS("http://www.w3.org/2000/svg","g")),$D.setAttribute("transform",e),e=$D.transform.baseVal.consolidate())?FY((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):NI},", ",")",")");function LY(e){return((e=Math.exp(e))+1/e)/2}const WTe=function e(t,n,i){function r(s,o){var m,_,a=s[0],l=s[1],u=s[2],d=o[2],h=o[0]-a,p=o[1]-l,g=h*h+p*p;if(g<1e-12)_=Math.log(d/u)/t,m=function(w){return[a+w*h,l+w*p,u*Math.exp(t*w*_)]};else{var y=Math.sqrt(g),v=(d*d-u*u+i*g)/(2*u*n*y),b=(d*d-u*u-i*g)/(2*d*n*y),D=Math.log(Math.sqrt(v*v+1)-v),C=Math.log(Math.sqrt(b*b+1)-b);_=(C-D)/t,m=function(w){var E=w*_,O=LY(D),M=u/(n*y)*(O*function GTe(e){return((e=Math.exp(2*e))-1)/(e+1)}(t*E+D)-function zTe(e){return((e=Math.exp(e))-1/e)/2}(D));return[a+M*h,l+M*p,u*O/LY(t*E+D)]}}return m.duration=1e3*_*t/Math.SQRT2,m}return r.rho=function(s){var o=Math.max(.001,+s),a=o*o;return e(o,a,a*a)},r}(Math.SQRT2,2,4);function jY(e){return function(t,n){var i=e((t=kD(t)).h,(n=kD(n)).h),r=Ii(t.s,n.s),s=Ii(t.l,n.l),o=Ii(t.opacity,n.opacity);return function(a){return t.h=i(a),t.s=r(a),t.l=s(a),t.opacity=o(a),t+""}}}const qTe=jY(FD);var YTe=jY(Ii);const BY=Math.PI/180,$Y=180/Math.PI,zY=4/29,Lg=6/29,GY=3*Lg*Lg;function WY(e){if(e instanceof ha)return new ha(e.l,e.a,e.b,e.opacity);if(e instanceof gl)return YY(e);e instanceof ki||(e=fI(e));var s,o,t=FI(e.r),n=FI(e.g),i=FI(e.b),r=kI((.2225045*t+.7168786*n+.0606169*i)/1);return t===n&&n===i?s=o=r:(s=kI((.4360747*t+.3850649*n+.1430804*i)/.96422),o=kI((.0139322*t+.0971045*n+.7141733*i)/.82521)),new ha(116*r-16,500*(s-r),200*(r-o),e.opacity)}function HD(e,t,n,i){return 1===arguments.length?WY(e):new ha(e,t,n,null==i?1:i)}function ha(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}function kI(e){return e>.008856451679035631?Math.pow(e,1/3):e/GY+zY}function II(e){return e>Lg?e*e*e:GY*(e-zY)}function RI(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function FI(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function qY(e){if(e instanceof gl)return new gl(e.h,e.c,e.l,e.opacity);if(e instanceof ha||(e=WY(e)),0===e.a&&0===e.b)return new gl(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*$Y;return new gl(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function UD(e,t,n,i){return 1===arguments.length?qY(e):new gl(e,t,n,null==i?1:i)}function gl(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function YY(e){if(isNaN(e.h))return new ha(e.l,0,0,e.opacity);var t=e.h*BY;return new ha(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}function JTe(e,t){var n=Ii((e=HD(e)).l,(t=HD(t)).l),i=Ii(e.a,t.a),r=Ii(e.b,t.b),s=Ii(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=i(o),e.b=r(o),e.opacity=s(o),e+""}}function KY(e){return function(t,n){var i=e((t=UD(t)).h,(n=UD(n)).h),r=Ii(t.c,n.c),s=Ii(t.l,n.l),o=Ii(t.opacity,n.opacity);return function(a){return t.h=i(a),t.c=r(a),t.l=s(a),t.opacity=o(a),t+""}}}Rg(ha,HD,sy(Xc,{brighter(e){return new ha(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker(e){return new ha(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new ki(RI(3.1338561*(t=.96422*II(t))-1.6168667*(e=1*II(e))-.4906146*(n=.82521*II(n))),RI(-.9787684*t+1.9161415*e+.033454*n),RI(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),Rg(gl,UD,sy(Xc,{brighter(e){return new gl(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker(e){return new gl(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb(){return YY(this).rgb()}}));const XTe=KY(FD);var QTe=KY(Ii),PI=1.78277,LI=-.29227,zD=-.90649,cy=1.97294,XY=cy*zD,QY=cy*PI,ZY=PI*LI- -.14861*zD;function ZTe(e){if(e instanceof Gd)return new Gd(e.h,e.s,e.l,e.opacity);e instanceof ki||(e=fI(e));var n=e.g/255,i=e.b/255,r=(ZY*i+XY*(e.r/255)-QY*n)/(ZY+XY-QY),s=i-r,o=(cy*(n-r)-LI*s)/zD,a=Math.sqrt(o*o+s*s)/(cy*r*(1-r)),l=a?Math.atan2(o,s)*$Y-120:NaN;return new Gd(l<0?l+360:l,a,r,e.opacity)}function jI(e,t,n,i){return 1===arguments.length?ZTe(e):new Gd(e,t,n,null==i?1:i)}function Gd(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function eK(e){return function t(n){function i(r,s){var o=e((r=jI(r)).h,(s=jI(s)).h),a=Ii(r.s,s.s),l=Ii(r.l,s.l),u=Ii(r.opacity,s.opacity);return function(c){return r.h=o(c),r.s=a(c),r.l=l(Math.pow(c,n)),r.opacity=u(c),r+""}}return n=+n,i.gamma=t,i}(1)}Rg(Gd,jI,sy(Xc,{brighter(e){return e=null==e?Fg:Math.pow(Fg,e),new Gd(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new Gd(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*BY,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new ki(255*(t+n*(-.14861*i+PI*r)),255*(t+n*(LI*i+zD*r)),255*(t+n*(cy*i)),this.opacity)}}));const eOe=eK(FD);var tOe=eK(Ii);function nOe(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}function BI(e,t,n){const i=e-t+2*n;return e?i>0?i:1:0}const jg="linear",ku="log",fy="pow",dy="sqrt",GD="symlog",Wd="time",qd="utc",ml="sequential",Bg="diverging",$g="quantile",WD="quantize",qD="threshold",$I="ordinal",VI="point",HI="bin-ordinal",vi="continuous",hy="discrete",py="discretizing",Oo="interpolating",UI="temporal";function zI(){const e=MI().unknown(void 0),t=e.domain,n=e.range;let r,s,i=[0,1],o=!1,a=0,l=0,u=.5;function c(){const f=t().length,d=i[1]<i[0],h=i[1-d],p=BI(f,a,l);let g=i[d-0];r=(h-g)/(p||1),o&&(r=Math.floor(r)),g+=(h-g-r*(f-a))*u,s=r*(1-a),o&&(g=Math.round(g),s=Math.round(s));const m=Vs(f).map(_=>g+r*_);return n(d?m.reverse():m)}return delete e.unknown,e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(i=[+f[0],+f[1]],c()):i.slice()},e.rangeRound=function(f){return i=[+f[0],+f[1]],o=!0,c()},e.bandwidth=function(){return s},e.step=function(){return r},e.round=function(f){return arguments.length?(o=!!f,c()):o},e.padding=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),a=l,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.invertRange=function(f){if(null==f[0]||null==f[1])return;const d=i[1]<i[0],h=d?n().reverse():n(),p=h.length-1;let _,y,v,g=+f[0],m=+f[1];return g!=g||m!=m||(m<g&&(v=g,g=m,m=v),m<h[0]||g>i[1-d])?void 0:(_=Math.max(0,OD(h,g)-1),y=g===m?_:OD(h,m)-1,g-h[_]>s+1e-10&&++_,d&&(v=_,_=p-y,y=p-v),_>y?void 0:t().slice(_,y+1))},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return zI().domain(t()).range(i).round(o).paddingInner(a).paddingOuter(l).align(u)},c()}function nK(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return nK(t())},e}var aOe=Array.prototype.map;function lOe(e){return aOe.call(e,lr)}const uOe=Array.prototype.slice,YD={};function cOe(e,t,n){const i=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?function rOe(e){return function(t){let r,n=t[0],i=t[1];return i<n&&(r=n,n=i,i=r),[e.invert(n),e.invert(i)]}}(s):s.invertExtent?function sOe(e){return function(t){const n=e.range();let o,a,l,u,i=t[0],r=t[1],s=-1;for(r<i&&(a=i,i=r,r=a),l=0,u=n.length;l<u;++l)n[l]>=i&&n[l]<=r&&(s<0&&(s=l),o=l);if(!(s<0))return i=e.invertExtent(n[s]),r=e.invertExtent(n[o]),[void 0===i[0]?i[1]:i[0],void 0===r[1]?r[0]:r[1]]}}(s):void 0),s.type=e,s};return i.metadata=ua(ve(n)),i}function kt(e,t,n){return arguments.length>1?(YD[e]=cOe(e,t,n),this):rK(e)?YD[e]:void 0}function rK(e){return Oe(YD,e)}function Yd(e,t){const n=YD[e];return n&&n.metadata[t]}function GI(e){return Yd(e,vi)}function Vg(e){return Yd(e,hy)}function WI(e){return Yd(e,py)}function sK(e){return Yd(e,ku)}function oK(e){return Yd(e,Oo)}function aK(e){return Yd(e,$g)}kt("identity",function fY(e){var t;function n(i){return null==i||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,_I),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return fY(e).unknown(t)},e=arguments.length?Array.from(e,_I):[0,1],zd(n)}),kt(jg,function cY(){var e=lY();return e.copy=function(){return uy(e,cY())},pl.apply(e,arguments),zd(e)},vi),kt(ku,function mY(){const e=vI(PD()).domain([1,10]);return e.copy=()=>uy(e,mY()).base(e.base()),pl.apply(e,arguments),e},[vi,ku]),kt(fy,wI,vi),kt(dy,function xTe(){return wI.apply(null,arguments).exponent(.5)},vi),kt(GD,function bY(){var e=DI(PD());return e.copy=function(){return uy(e,bY()).constant(e.constant())},pl.apply(e,arguments)},vi),kt(Wd,function ITe(){return pl.apply(CI(OTe,MTe,Vc,Xw,wg,Bc,w2,D2,Hc,j2).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},[vi,UI]),kt(qd,function RTe(){return pl.apply(CI(ATe,TTe,Uc,Zw,Cg,$c,S2,x2,Hc,B2).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},[vi,UI]),kt(ml,EI,[vi,Oo]),kt("".concat(ml,"-").concat(jg),EI,[vi,Oo]),kt("".concat(ml,"-").concat(ku),function DY(){var e=vI(LD()).domain([1,10]);return e.copy=function(){return tf(e,DY()).base(e.base())},ef.apply(e,arguments)},[vi,Oo,ku]),kt("".concat(ml,"-").concat(fy),SI,[vi,Oo]),kt("".concat(ml,"-").concat(dy),function FTe(){return SI.apply(null,arguments).exponent(.5)},[vi,Oo]),kt("".concat(ml,"-").concat(GD),function CY(){var e=DI(LD());return e.copy=function(){return tf(e,CY()).constant(e.constant())},ef.apply(e,arguments)},[vi,Oo]),kt("".concat(Bg,"-").concat(jg),function EY(){var e=zd(jD()(us));return e.copy=function(){return tf(e,EY())},ef.apply(e,arguments)},[vi,Oo]),kt("".concat(Bg,"-").concat(ku),function SY(){var e=vI(jD()).domain([.1,1,10]);return e.copy=function(){return tf(e,SY()).base(e.base())},ef.apply(e,arguments)},[vi,Oo,ku]),kt("".concat(Bg,"-").concat(fy),AI,[vi,Oo]),kt("".concat(Bg,"-").concat(dy),function PTe(){return AI.apply(null,arguments).exponent(.5)},[vi,Oo]),kt("".concat(Bg,"-").concat(GD),function xY(){var e=DI(jD());return e.copy=function(){return tf(e,xY()).constant(e.constant())},ef.apply(e,arguments)},[vi,Oo]),kt($g,function AY(){var i,e=[],t=[],n=[];function r(){var o=0,a=Math.max(1,t.length);for(n=new Array(a-1);++o<a;)n[o-1]=EW(e,o/a);return s}function s(o){return null==o||isNaN(o=+o)?i:t[ry(n,o)]}return s.invertExtent=function(o){var a=t.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let a of o)null!=a&&!isNaN(a=+a)&&e.push(a);return e.sort(Ou),r()},s.range=function(o){return arguments.length?(t=Array.from(o),r()):t.slice()},s.unknown=function(o){return arguments.length?(i=o,s):i},s.quantiles=function(){return n.slice()},s.copy=function(){return AY().domain(e).range(t).unknown(i)},pl.apply(s,arguments)},[py,$g]),kt(WD,function TY(){var s,e=0,t=1,n=1,i=[.5],r=[0,1];function o(l){return null!=l&&l<=l?r[ry(i,l,0,n)]:s}function a(){var l=-1;for(i=new Array(n);++l<n;)i[l]=((l+1)*t-(l-n)*e)/(n+1);return o}return o.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,a()):[e,t]},o.range=function(l){return arguments.length?(n=(r=Array.from(l)).length-1,a()):r.slice()},o.invertExtent=function(l){var u=r.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,i[0]]:u>=n?[i[n-1],t]:[i[u-1],i[u]]},o.unknown=function(l){return arguments.length&&(s=l),o},o.thresholds=function(){return i.slice()},o.copy=function(){return TY().domain([e,t]).range(r).unknown(s)},pl.apply(zd(o),arguments)},py),kt(qD,function OY(){var n,e=[.5],t=[0,1],i=1;function r(s){return null!=s&&s<=s?t[ry(e,s,0,i)]:n}return r.domain=function(s){return arguments.length?(e=Array.from(s),i=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(s){return arguments.length?(t=Array.from(s),i=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},r.unknown=function(s){return arguments.length?(n=s,r):n},r.copy=function(){return OY().domain(e).range(t).unknown(n)},pl.apply(r,arguments)},py),kt(HI,function iK(){let e=[],t=[];function n(i){return null==i||i!=i?void 0:t[(ry(e,i)-1)%t.length]}return n.domain=function(i){return arguments.length?(e=lOe(i),n):e.slice()},n.range=function(i){return arguments.length?(t=uOe.call(i),n):t.slice()},n.tickFormat=function(i,r){return uY(e[0],yt(e),null==i?10:i,r)},n.copy=function(){return iK().domain(n.domain()).range(n.range())},n},[hy,py]),kt($I,MI,hy),kt("band",zI,hy),kt(VI,function oOe(){return nK(zI().paddingInner(1))},hy);const dOe=["clamp","base","constant","exponent"];function lK(e,t){const n=t[0],i=yt(t)-n;return function(r){return e(n+r*i)}}function KD(e,t,n){return xI(qI(t||"rgb",n),e)}function uK(e,t){const n=new Array(t),i=t+1;for(let r=0;r<t;)n[r]=e(++r/i);return n}function cK(e,t,n){const i=n-t;let r,s,o;return i&&Number.isFinite(i)?(r=(s=e.type).indexOf("-"),s=r<0?s:s.slice(r+1),o=kt(s)().domain([t,n]).range([0,1]),dOe.forEach(a=>e[a]?o[a](e[a]()):0),o):ur(.5)}function qI(e,t){const n=nn[function hOe(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}function fK(e){const t=e.length/6|0,n=new Array(t);for(let i=0;i<t;)n[i]="#"+e.slice(6*i,6*++i);return n}function dK(e,t){for(const n in e)YI(n,t(e[n]))}const hK={};function YI(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(hK[e]=t,this):hK[e]}dK({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},fK),dK({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},e=>KD(fK(e)));const JD="symbol",yOe=e=>Z(e)?e.map(t=>String(t)):String(e),vOe=(e,t)=>e[1]-t[1],bOe=(e,t)=>t[1]-e[1];function KI(e,t,n){let i;return Xt(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),null!=n&&(t=Math.min(t,Math.floor(I_(e.domain())/n||1)))),Ce(t)&&(i=t.step,t=t.interval),_e(t)&&(t=e.type===Wd?xg(t):e.type==qd?Ag(t):Q("Only time and utc scales accept interval strings."),i&&(t=t.every(i))),t}function pK(e,t,n){let i=e.range(),r=i[0],s=yt(i),o=vOe;if(r>s&&(i=s,s=r,r=i,o=bOe),r=Math.floor(r),s=Math.ceil(s),t=t.map(a=>[a,e(a)]).filter(a=>r<=a[1]&&a[1]<=s).sort(o).map(a=>a[0]),n>0&&t.length>1){const a=[t[0],yt(t)];for(;t.length>n&&t.length>=3;)t=t.filter((l,u)=>!(u%2));t.length<3&&(t=a)}return t}function JI(e,t){return e.bins?pK(e,e.bins):e.ticks?e.ticks(t):e.domain()}function gK(e,t,n,i,r,s){const o=t.type;let a=yOe;if(o===Wd||r===Wd)a=e.timeFormat(i);else if(o===qd||r===qd)a=e.utcFormat(i);else if(sK(o)){const l=e.formatFloat(i);if(s||t.bins)a=l;else{const u=mK(t,n,!1);a=c=>u(c)?l(c):""}}else if(t.tickFormat){const l=t.domain();a=e.formatSpan(l[0],l[l.length-1],n,i)}else i&&(a=e.format(i));return a}function mK(e,t,n){const i=JI(e,t),r=e.base(),s=Math.log(r),o=Math.max(1,r*t/i.length),a=l=>{let u=l/Math.pow(r,Math.round(Math.log(l)/s));return u*r<r-.5&&(u*=r),u<=o};return n?i.filter(a):a}const XI={[$g]:"quantiles",[WD]:"thresholds",[qD]:"domain"},_K={[$g]:"quantiles",[WD]:"domain"};function yK(e,t){return e.bins?function COe(e){const t=e.slice(0,-1);return t.max=yt(e),t}(e.bins):e.type===ku?mK(e,t,!0):XI[e.type]?function DOe(e){const t=[-1/0].concat(e);return t.max=1/0,t}(e[XI[e.type]]()):JI(e,t)}function vK(e,t,n,i,r,s,o){const a=_K[t.type]&&s!==Wd&&s!==qd?function wOe(e,t,n){const i=t[_K[t.type]](),r=i.length;let o,s=r>1?i[1]-i[0]:i[0];for(o=1;o<r;++o)s=Math.min(s,i[o]-i[o-1]);return e.formatSpan(0,s,30,n)}(e,t,r):gK(e,t,n,r,s,o);return i===JD&&(e=>XI[e.type]||e.bins)(t)?SOe(a):"discrete"===i?xOe(a):AOe(a)}const SOe=e=>(t,n,i)=>{const r=bK(i[n+1],bK(i.max,1/0)),s=wK(t,e),o=wK(r,e);return s&&o?s+" \u2013 "+o:o?"< "+o:"\u2265 "+s},bK=(e,t)=>null!=e?e:t,xOe=e=>(t,n)=>n?e(t):null,AOe=e=>t=>e(t),wK=(e,t)=>Number.isFinite(e)?t(e):null;function DK(e,t,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=function OOe(e,t,n,i){const r=i||t.type;return _e(n)&&function fOe(e){return Yd(e,UI)}(r)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||r!==Wd?n||r!==qd?vK(e,t,5,null,n,i,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X")}(e,t,n.format,n.formatType);if(WI(t.type)){const s=yK(t).slice(1).map(r),o=s.length;return"".concat(o," boundar").concat(1===o?"y":"ies",": ").concat(s.join(", "))}if(Vg(t.type)){const s=t.domain(),o=s.length,a=o>i?s.slice(0,i-2).map(r).join(", ")+", ending with "+s.slice(-1).map(r):s.map(r).join(", ");return"".concat(o," value").concat(1===o?"":"s",": ").concat(a)}{const s=t.domain();return"values from ".concat(r(s[0])," to ").concat(r(yt(s)))}}let CK=0;function QI(e){return e&&e.gradient}function EK(e,t,n){const i=e.gradient;let r=e.id,s="radial"===i?"p_":"";return r||(r=e.id="gradient_"+CK++,"radial"===i?(e.x1=_l(e.x1,.5),e.y1=_l(e.y1,.5),e.r1=_l(e.r1,0),e.x2=_l(e.x2,.5),e.y2=_l(e.y2,.5),e.r2=_l(e.r2,.5),s="p_"):(e.x1=_l(e.x1,0),e.y1=_l(e.y1,0),e.x2=_l(e.x2,1),e.y2=_l(e.y2,0))),t[r]=e,"url("+(n||"")+"#"+s+r+")"}function _l(e,t){return null!=e?e:t}function SK(e,t){var i,n=[];return i={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(r,s){return n.push({offset:r,color:s}),i}}}const xK={basis:{curve:function iAe(e){return new CD(e)}},"basis-closed":{curve:function rAe(e){return new mq(e)}},"basis-open":{curve:function sAe(e){return new _q(e)}},bundle:{curve:oAe,tension:"beta",value:.85},cardinal:{curve:aAe,tension:"tension",value:0},"cardinal-open":{curve:lAe,tension:"tension",value:0},"cardinal-closed":{curve:uAe,tension:"tension",value:0},"catmull-rom":{curve:dAe,tension:"alpha",value:.5},"catmull-rom-closed":{curve:hAe,tension:"alpha",value:.5},"catmull-rom-open":{curve:pAe,tension:"alpha",value:.5},linear:{curve:iI},"linear-closed":{curve:function gAe(e){return new Sq(e)}},monotone:{horizontal:function _Ae(e){return new Oq(e)},vertical:function mAe(e){return new xD(e)}},natural:{curve:function yAe(e){return new Nq(e)}},step:{curve:function vAe(e){return new AD(e,.5)}},"step-after":{curve:function wAe(e){return new AD(e,1)}},"step-before":{curve:function bAe(e){return new AD(e,0)}}};function ZI(e,t,n){var i=Oe(xK,e)&&xK[e],r=null;return i&&(r=i.curve||i[t||"vertical"],i.tension&&null!=n&&(r=r[i.tension](n))),r}const NOe={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},kOe=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,IOe=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,ROe=/^((\s+,?\s*)|(,\s*))/,FOe=/^[01]/;function Hg(e){const t=[];return(e.match(kOe)||[]).forEach(i=>{let r=i[0];const s=r.toLowerCase(),o=NOe[s],a=function POe(e,t,n){const i=[];for(let r=0;t&&r<n.length;)for(let s=0;s<t;++s){const o="a"!==e||3!==s&&4!==s?IOe:FOe,a=n.slice(r).match(o);if(null===a)throw Error("Invalid SVG path, incorrect parameter type");r+=a[0].length,i.push(+a[0]);const l=n.slice(r).match(ROe);null!==l&&(r+=l[0].length)}return i}(s,o,i.slice(1).trim()),l=a.length;if(l<o||l&&l%o!=0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([r,...a.slice(0,o)]),l!==o){"m"===s&&(r="M"===r?"L":"l");for(let u=o;u<l;u+=o)t.push([r,...a.slice(u,u+o)])}}),t}const nf=Math.PI/180,Kd=Math.PI/2,yl=2*Math.PI,Ug=Math.sqrt(3)/2;var eR={},tR={},AK=[].join;function BOe(e){const t=AK.call(e);if(tR[t])return tR[t];var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7];const c=u*o,f=-l*a,d=l*o,h=u*a,p=Math.cos(r),g=Math.sin(r),m=Math.cos(s),_=Math.sin(s),y=.5*(s-r),v=Math.sin(.5*y),b=8/3*v*v/Math.sin(y),D=n+p-b*g,C=i+g+b*p,w=n+m,E=i+_,O=w+b*_,M=E-b*m;return tR[t]=[c*D+f*C,d*D+h*C,c*O+f*M,d*O+h*M,c*w+f*E,d*w+h*E]}const Mo=["l",0,0,0,0,0,0,0];function $Oe(e,t,n){const i=Mo[0]=e[0];if("a"===i||"A"===i)Mo[1]=t*e[1],Mo[2]=n*e[2],Mo[3]=e[3],Mo[4]=e[4],Mo[5]=e[5],Mo[6]=t*e[6],Mo[7]=n*e[7];else if("h"===i||"H"===i)Mo[1]=t*e[1];else if("v"===i||"V"===i)Mo[1]=n*e[1];else for(var r=1,s=e.length;r<s;++r)Mo[r]=(r%2==1?t:n)*e[r];return Mo}function gy(e,t,n,i,r,s){var o,d,h,p,g,a=null,l=0,u=0,c=0,f=0,m=0,_=0;null==n&&(n=0),null==i&&(i=0),null==r&&(r=1),null==s&&(s=r),e.beginPath&&e.beginPath();for(var y=0,v=t.length;y<v;++y){switch(o=t[y],(1!==r||1!==s)&&(o=$Oe(o,r,s)),o[0]){case"l":e.lineTo((l+=o[1])+n,(u+=o[2])+i);break;case"L":e.lineTo((l=o[1])+n,(u=o[2])+i);break;case"h":e.lineTo((l+=o[1])+n,u+i);break;case"H":e.lineTo((l=o[1])+n,u+i);break;case"v":e.lineTo(l+n,(u+=o[1])+i);break;case"V":e.lineTo(l+n,(u=o[1])+i);break;case"m":m=l+=o[1],_=u+=o[2],e.moveTo(l+n,u+i);break;case"M":m=l=o[1],_=u=o[2],e.moveTo(l+n,u+i);break;case"c":e.bezierCurveTo(l+o[1]+n,u+o[2]+i,(c=l+o[3])+n,(f=u+o[4])+i,(d=l+o[5])+n,(h=u+o[6])+i),l=d,u=h;break;case"C":e.bezierCurveTo(o[1]+n,o[2]+i,(c=o[3])+n,(f=o[4])+i,(l=o[5])+n,(u=o[6])+i);break;case"s":e.bezierCurveTo((c=2*l-c)+n,(f=2*u-f)+i,l+o[1]+n,u+o[2]+i,(d=l+o[3])+n,(h=u+o[4])+i),c=l+o[1],f=u+o[2],l=d,u=h;break;case"S":e.bezierCurveTo((c=2*l-c)+n,(f=2*u-f)+i,o[1]+n,o[2]+i,(d=o[3])+n,(h=o[4])+i),l=d,u=h,c=o[1],f=o[2];break;case"q":e.quadraticCurveTo((c=l+o[1])+n,(f=u+o[2])+i,(d=l+o[3])+n,(h=u+o[4])+i),l=d,u=h;break;case"Q":e.quadraticCurveTo(o[1]+n,o[2]+i,(d=o[3])+n,(h=o[4])+i),l=d,u=h,c=o[1],f=o[2];break;case"t":d=l+o[1],h=u+o[2],null===a[0].match(/[QqTt]/)?(c=l,f=u):"t"===a[0]?(c=2*l-p,f=2*u-g):"q"===a[0]&&(c=2*l-c,f=2*u-f),p=c,g=f,e.quadraticCurveTo(c+n,f+i,d+n,h+i),c=(l=d)+o[1],f=(u=h)+o[2];break;case"T":e.quadraticCurveTo((c=2*l-c)+n,(f=2*u-f)+i,(d=o[1])+n,(h=o[2])+i),l=d,u=h;break;case"a":TK(e,l+n,u+i,[o[1],o[2],o[3],o[4],o[5],o[6]+l+n,o[7]+u+i]),l+=o[6],u+=o[7];break;case"A":TK(e,l+n,u+i,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+i]),l=o[6],u=o[7];break;case"z":case"Z":l=m,u=_,e.closePath()}a=o}}function TK(e,t,n,i){const r=function jOe(e,t,n,i,r,s,o,a,l){const u=AK.call(arguments);if(eR[u])return eR[u];const c=o*nf,f=Math.sin(c),d=Math.cos(c),h=d*(a-e)*.5+f*(l-t)*.5,p=d*(l-t)*.5-f*(a-e)*.5;let g=h*h/((n=Math.abs(n))*n)+p*p/((i=Math.abs(i))*i);g>1&&(g=Math.sqrt(g),n*=g,i*=g);const m=d/n,_=f/n,y=-f/i,v=d/i,b=m*a+_*l,D=y*a+v*l,C=m*e+_*t,w=y*e+v*t;let O=1/((C-b)*(C-b)+(w-D)*(w-D))-.25;O<0&&(O=0);let M=Math.sqrt(O);s==r&&(M=-M);const N=.5*(b+C)-M*(w-D),R=.5*(D+w)+M*(C-b),P=Math.atan2(D-R,b-N);let x=Math.atan2(w-R,C-N)-P;x<0&&1===s?x+=yl:x>0&&0===s&&(x-=yl);const S=Math.ceil(Math.abs(x/(Kd+.001))),k=[];for(let T=0;T<S;++T)k[T]=[N,R,P+T*x/S,P+(T+1)*x/S,n,i,f,d];return eR[u]=k}(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n);for(let s=0;s<r.length;++s){const o=BOe(r[s]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const OK=.5773502691896257,MK={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,yl)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,s=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-s),e.lineTo(r,-s),e.lineTo(0,-n),e.lineTo(-r,-s),e.lineTo(-i,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=Ug*n,r=i-n*OK,s=n/4;e.moveTo(0,-i-r),e.lineTo(-s,i-r),e.lineTo(s,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=Ug*n,r=i-n*OK;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Ug*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Ug*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Ug*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Ug*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function NK(e){return Oe(MK,e)?MK[e]:function VOe(e){if(!Oe(nR,e)){const t=Hg(e);nR[e]={draw:function(n,i){gy(n,t,0,0,Math.sqrt(i)/2)}}}return nR[e]}(e)}var nR={};const rf=.448084975506;function HOe(e){return e.x}function UOe(e){return e.y}function zOe(e){return e.width}function GOe(e){return e.height}function Iu(e){return"function"==typeof e?e:()=>+e}function QD(e,t,n){return Math.max(t,Math.min(e,n))}function kK(){var e=HOe,t=UOe,n=zOe,i=GOe,r=Iu(0),s=r,o=r,a=r,l=null;function u(c,f,d){var h,p=null!=f?f:+e.call(this,c),g=null!=d?d:+t.call(this,c),m=+n.call(this,c),_=+i.call(this,c),y=Math.min(m,_)/2,v=QD(+r.call(this,c),0,y),b=QD(+s.call(this,c),0,y),D=QD(+o.call(this,c),0,y),C=QD(+a.call(this,c),0,y);if(l||(l=h=$d()),v<=0&&b<=0&&D<=0&&C<=0)l.rect(p,g,m,_);else{var w=p+m,E=g+_;l.moveTo(p+v,g),l.lineTo(w-b,g),l.bezierCurveTo(w-rf*b,g,w,g+rf*b,w,g+b),l.lineTo(w,E-C),l.bezierCurveTo(w,E-rf*C,w-rf*C,E,w-C,E),l.lineTo(p+D,E),l.bezierCurveTo(p+rf*D,E,p,E-rf*D,p,E-D),l.lineTo(p,g+v),l.bezierCurveTo(p,g+rf*v,p+rf*v,g,p+v,g),l.closePath()}if(h)return l=null,h+""||null}return u.x=function(c){return arguments.length?(e=Iu(c),u):e},u.y=function(c){return arguments.length?(t=Iu(c),u):t},u.width=function(c){return arguments.length?(n=Iu(c),u):n},u.height=function(c){return arguments.length?(i=Iu(c),u):i},u.cornerRadius=function(c,f,d,h){return arguments.length?(r=Iu(c),s=null!=f?Iu(f):r,a=null!=d?Iu(d):r,o=null!=h?Iu(h):s,u):r},u.context=function(c){return arguments.length?(l=null==c?null:c,u):l},u}function IK(){var e,t,n,i,s,o,a,l,r=null;function u(f,d,h){const p=h/2;if(s){var g=a-d,m=f-o;if(g||m){var _=Math.sqrt(g*g+m*m),y=(g/=_)*l,v=(m/=_)*l,b=Math.atan2(m,g);r.moveTo(o-y,a-v),r.lineTo(f-g*p,d-m*p),r.arc(f,d,p,b-Math.PI,b),r.lineTo(o+y,a+v),r.arc(o,a,l,b,b+Math.PI)}else r.arc(f,d,p,0,yl);r.closePath()}else s=1;o=f,a=d,l=p}function c(f){var d,p,m,h=f.length,g=!1;for(null==r&&(r=m=$d()),d=0;d<=h;++d)!(d<h&&i(p=f[d],d,f))===g&&(g=!g)&&(s=0),g&&u(+e(p,d,f),+t(p,d,f),+n(p,d,f));if(m)return r=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(i=f,c):i},c.context=function(f){return arguments.length?(r=null==f?null:f,c):r},c}function my(e,t){return null!=e?e:t}const _y=e=>e.x||0,yy=e=>e.y||0,ZD=e=>!1!==e.defined,uMe=function OAe(){var e=CAe,t=EAe,n=Vt(0),i=null,r=SAe,s=xAe,o=AAe,a=null;function l(){var u,c,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=r.apply(this,arguments)-SD,p=s.apply(this,arguments)-SD,g=vq(p-h),m=p>h;if(a||(a=u=$d()),d<f&&(c=d,d=f,f=c),d>hr)if(g>iy-hr)a.moveTo(d*Nu(h),d*ls(h)),a.arc(0,0,d,h,p,!m),f>hr&&(a.moveTo(f*Nu(p),f*ls(p)),a.arc(0,0,f,p,h,m));else{var R,P,_=h,y=p,v=h,b=p,D=g,C=g,w=o.apply(this,arguments)/2,E=w>hr&&(i?+i.apply(this,arguments):vn(f*f+d*d)),O=Ig(vq(d-f)/2,+n.apply(this,arguments)),M=O,N=O;if(E>hr){var A=bq(E/f*ls(w)),x=bq(E/d*ls(w));(D-=2*A)>hr?(v+=A*=m?1:-1,b-=A):(D=0,v=b=(h+p)/2),(C-=2*x)>hr?(_+=x*=m?1:-1,y-=x):(C=0,_=y=(h+p)/2)}var S=d*Nu(_),k=d*ls(_),T=f*Nu(b),F=f*ls(b);if(O>hr){var L,I=d*Nu(y),j=d*ls(y),V=f*Nu(v),U=f*ls(v);if(g<Kc&&(L=TAe(S,k,V,U,I,j,T,F))){var W=S-L[0],te=k-L[1],q=I-L[0],se=j-L[1],G=1/ls(fAe((W*q+te*se)/(vn(W*W+te*te)*vn(q*q+se*se)))/2),X=vn(L[0]*L[0]+L[1]*L[1]);M=Ig(O,(f-X)/(G-1)),N=Ig(O,(d-X)/(G+1))}}C>hr?N>hr?(R=TD(V,U,S,k,d,N,m),P=TD(I,j,T,F,d,N,m),a.moveTo(R.cx+R.x01,R.cy+R.y01),N<O?a.arc(R.cx,R.cy,N,dr(R.y01,R.x01),dr(P.y01,P.x01),!m):(a.arc(R.cx,R.cy,N,dr(R.y01,R.x01),dr(R.y11,R.x11),!m),a.arc(0,0,d,dr(R.cy+R.y11,R.cx+R.x11),dr(P.cy+P.y11,P.cx+P.x11),!m),a.arc(P.cx,P.cy,N,dr(P.y11,P.x11),dr(P.y01,P.x01),!m))):(a.moveTo(S,k),a.arc(0,0,d,_,y,!m)):a.moveTo(S,k),f>hr&&D>hr?M>hr?(R=TD(T,F,I,j,f,-M,m),P=TD(S,k,V,U,f,-M,m),a.lineTo(R.cx+R.x01,R.cy+R.y01),M<O?a.arc(R.cx,R.cy,M,dr(R.y01,R.x01),dr(P.y01,P.x01),!m):(a.arc(R.cx,R.cy,M,dr(R.y01,R.x01),dr(R.y11,R.x11),!m),a.arc(0,0,f,dr(R.cy+R.y11,R.cx+R.x11),dr(P.cy+P.y11,P.cx+P.x11),m),a.arc(P.cx,P.cy,M,dr(P.y11,P.x11),dr(P.y01,P.x01),!m))):a.arc(0,0,f,b,v,m):a.lineTo(T,F)}else a.moveTo(0,0);if(a.closePath(),u)return a=null,u+""||null}return l.centroid=function(){var u=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-Kc/2;return[Nu(c)*u,ls(c)*u]},l.innerRadius=function(u){return arguments.length?(e="function"==typeof u?u:Vt(+u),l):e},l.outerRadius=function(u){return arguments.length?(t="function"==typeof u?u:Vt(+u),l):t},l.cornerRadius=function(u){return arguments.length?(n="function"==typeof u?u:Vt(+u),l):n},l.padRadius=function(u){return arguments.length?(i=null==u?null:"function"==typeof u?u:Vt(+u),l):i},l.startAngle=function(u){return arguments.length?(r="function"==typeof u?u:Vt(+u),l):r},l.endAngle=function(u){return arguments.length?(s="function"==typeof u?u:Vt(+u),l):s},l.padAngle=function(u){return arguments.length?(o="function"==typeof u?u:Vt(+u),l):o},l.context=function(u){return arguments.length?(a=null==u?null:u,l):a},l}().startAngle(e=>e.startAngle||0).endAngle(e=>e.endAngle||0).padAngle(e=>e.padAngle||0).innerRadius(e=>e.innerRadius||0).outerRadius(e=>e.outerRadius||0).cornerRadius(e=>e.cornerRadius||0),cMe=jq().x(_y).y1(yy).y0(e=>(e.y||0)+(e.height||0)).defined(ZD),fMe=jq().y(yy).x1(_y).x0(e=>(e.x||0)+(e.width||0)).defined(ZD),dMe=Lq().x(_y).y(yy).defined(ZD),hMe=kK().x(_y).y(yy).width(e=>e.width||0).height(e=>e.height||0).cornerRadius(e=>my(e.cornerRadiusTopLeft,e.cornerRadius)||0,e=>my(e.cornerRadiusTopRight,e.cornerRadius)||0,e=>my(e.cornerRadiusBottomRight,e.cornerRadius)||0,e=>my(e.cornerRadiusBottomLeft,e.cornerRadius)||0),pMe=function KAe(e,t){let n=null;function i(){let r;if(n||(n=r=$d()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return e="function"==typeof e?e:Vt(e||lI),t="function"==typeof t?t:Vt(void 0===t?64:+t),i.type=function(r){return arguments.length?(e="function"==typeof r?r:Vt(r),i):e},i.size=function(r){return arguments.length?(t="function"==typeof r?r:Vt(+r),i):t},i.context=function(r){return arguments.length?(n=null==r?null:r,i):n},i}().type(e=>NK(e.shape||"circle")).size(e=>my(e.size,64)),gMe=IK().x(_y).y(yy).defined(ZD).size(e=>e.size||1);function iR(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function zg(e,t,n,i){return hMe.context(e)(t,n,i)}var RK=1;function FK(){RK=1}function rR(e,t,n){var i=t.clip,r=e._defs,s=t.clip_id||(t.clip_id="clip"+RK++),o=r.clipping[s]||(r.clipping[s]={id:s});return Qe(i)?o.path=i(null):iR(n)?o.path=zg(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+s+")"}function ui(e){this.clear(),e&&this.union(e)}function eC(e){this.mark=e,this.bounds=this.bounds||new ui}function tC(e){eC.call(this,e),this.items=this.items||[]}function sR(e){this._pending=0,this._loader=e||rD()}function PK(e){e._pending+=1}function vy(e){e._pending-=1}function Ru(e,t,n){if(t.stroke&&0!==t.opacity&&0!==t.strokeOpacity){const i=null!=t.strokeWidth?+t.strokeWidth:1;e.expand(i+(n?function DMe(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}(t,i):0))}return e}ui.prototype={clone(){return new ui(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(e,t,n){var{x1:i,y1:r,x2:s,y2:o}=this,a=Math.cos(e),l=Math.sin(e),u=t-t*a+n*l,c=n-t*l-n*a;return[a*i-l*r+u,l*i+a*r+c,a*i-l*o+u,l*i+a*o+c,a*s-l*r+u,l*s+a*r+c,a*s-l*o+u,l*s+a*o+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},ce(tC,eC),sR.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return PK(t),t._loader.sanitize(e,{context:"href"}).then(n=>(vy(t),n)).catch(()=>(vy(t),null))},loadImage(e){const t=this,n="undefined"!=typeof Image?Image:null;return PK(t),t._loader.sanitize(e,{context:"image"}).then(i=>{const r=i.href;if(!r||!n)throw{url:r};const s=new n,o=Oe(i,"crossOrigin")?i.crossOrigin:"anonymous";return null!=o&&(s.crossOrigin=o),s.onload=()=>vy(t),s.onerror=()=>vy(t),s.src=r,s}).catch(i=>(vy(t),{complete:!1,width:0,height:0,src:i&&i.url||""}))},ready(){const e=this;return new Promise(t=>{!function n(i){e.pending()?setTimeout(()=>{n(!0)},10):t(i)}(!1)})}};const CMe=yl-1e-8;let nC,iC,rC,Jd,oR,sC,aR,lR;const sf=(e,t)=>nC.add(e,t),oC=(e,t)=>sf(iC=e,rC=t),LK=e=>sf(e,nC.y1),jK=e=>sf(nC.x1,e),Xd=(e,t)=>oR*e+aR*t,Qd=(e,t)=>sC*e+lR*t,uR=(e,t)=>sf(Xd(e,t),Qd(e,t)),cR=(e,t)=>oC(Xd(e,t),Qd(e,t));function by(e,t){return nC=e,t?(Jd=t*nf,oR=lR=Math.cos(Jd),sC=Math.sin(Jd),aR=-sC):(oR=lR=1,Jd=sC=aR=0),EMe}const EMe={beginPath(){},closePath(){},moveTo:cR,lineTo:cR,rect(e,t,n,i){Jd?(uR(e+n,t),uR(e+n,t+i),uR(e,t+i),cR(e,t)):(sf(e+n,t+i),oC(e,t))},quadraticCurveTo(e,t,n,i){const r=Xd(e,t),s=Qd(e,t),o=Xd(n,i),a=Qd(n,i);BK(iC,r,o,LK),BK(rC,s,a,jK),oC(o,a)},bezierCurveTo(e,t,n,i,r,s){const o=Xd(e,t),a=Qd(e,t),l=Xd(n,i),u=Qd(n,i),c=Xd(r,s),f=Qd(r,s);$K(iC,o,l,c,LK),$K(rC,a,u,f,jK),oC(c,f)},arc(e,t,n,i,r,s){if(i+=Jd,r+=Jd,iC=n*Math.cos(r)+e,rC=n*Math.sin(r)+t,Math.abs(r-i)>CMe)sf(e-n,t-n),sf(e+n,t+n);else{const o=u=>sf(n*Math.cos(u)+e,n*Math.sin(u)+t);let a,l;if(o(i),o(r),r!==i)if((i%=yl)<0&&(i+=yl),(r%=yl)<0&&(r+=yl),r<i&&(s=!s,a=i,i=r,r=a),s)for(r-=yl,a=i-i%Kd,l=0;l<4&&a>r;++l,a-=Kd)o(a);else for(a=i-i%Kd+Kd,l=0;l<4&&a<r;++l,a+=Kd)o(a)}}};function BK(e,t,n,i){const r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function $K(e,t,n,i,r){const s=i-e+3*t-3*n,o=e+n-2*t,a=e-t;let c,l=0,u=0;Math.abs(s)>1e-14?(c=o*o+a*s,c>=0&&(c=Math.sqrt(c),l=(-o+c)/s,u=(-o-c)/s)):l=.5*a/o,0<l&&l<1&&r(VK(l,e,t,n,i)),0<u&&u<1&&r(VK(u,e,t,n,i))}function VK(e,t,n,i,r){const s=1-e,o=s*s,a=e*e;return o*s*t+3*o*e*n+3*s*a*i+a*e*r}var af=(af=Jc(1,1))?af.getContext("2d"):null;const fR=new ui;function dR(e){return function(t,n){if(!af)return!0;e(af,t),fR.clear().union(t.bounds).intersect(n).round();const{x1:i,y1:r,x2:s,y2:o}=fR;for(let a=r;a<=o;++a)for(let l=i;l<=s;++l)if(af.isPointInPath(l,a))return!0;return!1}}function hR(e,t){return t.contains(e.x||0,e.y||0)}function HK(e,t){const n=e.x||0,i=e.y||0;return t.intersects(fR.set(n,i,n+(e.width||0),i+(e.height||0)))}function UK(e,t){const n=e.x||0,i=e.y||0;return Gg(t,n,i,null!=e.x2?e.x2:n,null!=e.y2?e.y2:i)}function Gg(e,t,n,i,r){const{x1:s,y1:o,x2:a,y2:l}=e,u=i-t,c=r-n;let h,p,g,m,f=0,d=1;for(m=0;m<4;++m){if(0===m&&(h=-u,p=-(s-t)),1===m&&(h=u,p=a-t),2===m&&(h=-c,p=-(o-n)),3===m&&(h=c,p=l-n),Math.abs(h)<1e-10&&p<0)return!1;if(g=p/h,h<0){if(g>d)return!1;g>f&&(f=g)}else if(h>0){if(g<f)return!1;g<d&&(d=g)}}return!0}function Wg(e,t){e.globalCompositeOperation=t.blend||"source-over"}function pa(e,t){return null==e?t:e}function zK(e,t){const n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}function GK(e,t,n){return QI(n)?function SMe(e,t,n){const i=n.width(),r=n.height();let s;if("radial"===t.gradient)s=e.createRadialGradient(n.x1+pa(t.x1,.5)*i,n.y1+pa(t.y1,.5)*r,Math.max(i,r)*pa(t.r1,0),n.x1+pa(t.x2,.5)*i,n.y1+pa(t.y2,.5)*r,Math.max(i,r)*pa(t.r2,.5));else{const o=pa(t.x1,0),a=pa(t.y1,0),l=pa(t.x2,1),u=pa(t.y2,0);if(o!==l&&a!==u&&i!==r){const c=Jc(Math.ceil(i),Math.ceil(r)),f=c.getContext("2d");return f.scale(i,r),f.fillStyle=zK(f.createLinearGradient(o,a,l,u),t.stops),f.fillRect(0,0,i,r),e.createPattern(c,"no-repeat")}s=e.createLinearGradient(n.x1+o*i,n.y1+a*r,n.x1+l*i,n.y1+u*r)}return zK(s,t.stops)}(e,n,t.bounds):n}function aC(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=GK(e,t,t.fill),!0)}var xMe=[];function qg(e,t,n){var i=null!=(i=t.strokeWidth)?i:1;return!(i<=0)&&(n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=GK(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||xMe),e.lineDashOffset=t.strokeDashOffset||0),!0)}function AMe(e,t){return e.zindex-t.zindex||e.index-t.index}function pR(e){if(!e.zdirty)return e.zitems;var i,r,s,t=e.items,n=[];for(r=0,s=t.length;r<s;++r)(i=t[r]).index=r,i.zindex&&n.push(i);return e.zdirty=!1,e.zitems=n.sort(AMe)}function ga(e,t){var i,r,n=e.items;if(!n||!n.length)return;const s=pR(e);if(s&&s.length){for(i=0,r=n.length;i<r;++i)n[i].zindex||t(n[i]);n=s}for(i=0,r=n.length;i<r;++i)t(n[i])}function lC(e,t){var i,r,n=e.items;if(!n||!n.length)return null;const s=pR(e);for(s&&s.length&&(n=s),r=n.length;--r>=0;)if(i=t(n[r]))return i;if(n===s)for(r=(n=e.items).length;--r>=0;)if(!n[r].zindex&&(i=t(n[r])))return i;return null}function gR(e){return function(t,n,i){ga(n,r=>{(!i||i.intersects(r.bounds))&&WK(e,t,r,r)})}}function TMe(e){return function(t,n,i){n.items.length&&(!i||i.intersects(n.bounds))&&WK(e,t,n.items[0],n.items)}}function WK(e,t,n,i){var r=null==n.opacity?1:n.opacity;0!==r&&(e(t,i)||(Wg(t,n),n.fill&&aC(t,n,r)&&t.fill(),n.stroke&&qg(t,n,r)&&t.stroke()))}function uC(e){return e=e||Co,function(t,n,i,r,s,o){return i*=t.pixelRatio,r*=t.pixelRatio,lC(n,a=>{const l=a.bounds;if((!l||l.contains(s,o))&&l&&e(t,a,i,r,s,o))return a})}}function wy(e,t){return function(n,i,r,s){var u,c,o=Array.isArray(i)?i[0]:i,a=null==t?o.fill:t,l=o.stroke&&n.isPointInStroke;return l&&(c=o.strokeCap,n.lineWidth=null!=(u=o.strokeWidth)?u:1,n.lineCap=null!=c?c:"butt"),!e(n,i)&&(a&&n.isPointInPath(r,s)||l&&n.isPointInStroke(r,s))}}function mR(e){return uC(wy(e))}function Zd(e,t){return"translate("+e+","+t+")"}function _R(e){return"rotate("+e+")"}function qK(e){return Zd(e.x||0,e.y||0)}function yR(e,t,n){function s(o,a){var l=a.x||0,u=a.y||0,c=a.angle||0;o.translate(l,u),c&&o.rotate(c*=nf),o.beginPath(),t(o,a),c&&o.rotate(-c),o.translate(-l,-u)}return{type:e,tag:"path",nested:!1,attr:function i(o,a){o("transform",function MMe(e){return Zd(e.x||0,e.y||0)+(e.angle?" "+_R(e.angle):"")}(a)),o("d",t(null,a))},bound:function r(o,a){return t(by(o,a.angle),a),Ru(o,a).translate(a.x||0,a.y||0)},draw:gR(s),pick:mR(s),isect:n||dR(s)}}var kMe=yR("arc",function mMe(e,t){return uMe.context(e)(t)});function vR(e,t,n){function s(l,u){l.beginPath(),t(l,u)}const o=wy(s);return{type:e,tag:"path",nested:!0,attr:function i(l,u){var c=u.mark.items;c.length&&l("d",t(null,c))},bound:function r(l,u){var c=u.items;return 0===c.length?l:(t(by(l),c),Ru(l,c[0]))},draw:TMe(s),pick:function a(l,u,c,f,d,h){var p=u.items,g=u.bounds;return!p||!p.length||g&&!g.contains(d,h)?null:o(l,p,c*=l.pixelRatio,f*=l.pixelRatio)?p[0]:null},isect:hR,tip:n}}var PMe=vR("area",function _Me(e,t){const n=t[0];return("horizontal"===n.orient?fMe:cMe).curve(ZI(n.interpolate||"linear",n.orient,n.tension)).context(e)(t)},function IMe(e,t){for(var o,a,n="horizontal"===e[0].orient?t[1]:t[0],i="horizontal"===e[0].orient?"y":"x",r=e.length,s=1/0;--r>=0;)!1!==e[r].defined&&(a=Math.abs(e[r][i]-n))<s&&(s=a,o=e[r]);return o});function YK(e,t){e.beginPath(),iR(t)?zg(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function KK(e){const t=pa(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function JK(e,t){const n=KK(t);e("d",zg(null,t,n,n))}function Dy(e,t,n,i){const r=KK(t);e.beginPath(),zg(e,t,(n||0)+r,(i||0)+r)}const UMe=wy(Dy),zMe=wy(Dy,!1),GMe=wy(Dy,!0);var KMe={type:"group",tag:"g",nested:!1,attr:function jMe(e,t){e("transform",qK(t))},bound:function HMe(e,t){if(!t.clip&&t.items){const n=t.items,i=n.length;for(let r=0;r<i;++r)e.union(n[r].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Ru(e,t),e.translate(t.x||0,t.y||0)},draw:function WMe(e,t,n){ga(t,i=>{const r=i.x||0,s=i.y||0,o=i.strokeForeground,a=null==i.opacity?1:i.opacity;(i.stroke||i.fill)&&a&&(Dy(e,i,r,s),Wg(e,i),i.fill&&aC(e,i,a)&&e.fill(),i.stroke&&!o&&qg(e,i,a)&&e.stroke()),e.save(),e.translate(r,s),i.clip&&YK(e,i),n&&n.translate(-r,-s),ga(i,l=>{this.draw(e,l,n)}),n&&n.translate(r,s),e.restore(),o&&i.stroke&&a&&(Dy(e,i,r,s),Wg(e,i),qg(e,i,a)&&e.stroke())})},pick:function qMe(e,t,n,i,r,s){if(t.bounds&&!t.bounds.contains(r,s)||!t.items)return null;const o=n*e.pixelRatio,a=i*e.pixelRatio;return lC(t,l=>{let u,c,f;const d=l.bounds;if(d&&!d.contains(r,s))return;c=l.x||0,f=l.y||0;const g=l.clip;if(g&&(r<c||r>c+(l.width||0)||s<f||s>f+(l.height||0)))return;if(e.save(),e.translate(c,f),c=r-c,f=s-f,g&&iR(l)&&!GMe(e,l,o,a))return e.restore(),null;const m=l.strokeForeground,_=!1!==t.interactive;return _&&m&&l.stroke&&zMe(e,l,o,a)?(e.restore(),l):(u=lC(l,y=>function YMe(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}(y,c,f)?this.pick(y,n,i,c,f):null),!u&&_&&(l.fill||!m&&l.stroke)&&UMe(e,l,o,a)&&(u=l),e.restore(),u||null)})},isect:HK,content:function VMe(e,t,n){e("clip-path",t.clip?rR(n,t,t):null)},background:function BMe(e,t){e("class","background"),e("aria-hidden",!0),JK(e,t)},foreground:function $Me(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?JK(e,t):e("d","")}},Cy={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function bR(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(i=>{e.image=i,e.image.url=e.url})),n}function wR(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function DR(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function cC(e,t){return"center"===e?t/2:"right"===e?t:0}function fC(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var ZMe={type:"image",tag:"image",nested:!1,attr:function JMe(e,t,n){const i=bR(t,n),r=wR(t,i),s=DR(t,i),o=(t.x||0)-cC(t.align,r),a=(t.y||0)-fC(t.baseline,s);e("href",!i.src&&i.toDataURL?i.toDataURL():i.src||"",Cy["xmlns:xlink"],"xlink:href"),e("transform",Zd(o,a)),e("width",r),e("height",s),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")},bound:function XMe(e,t){const n=t.image,i=wR(t,n),r=DR(t,n),s=(t.x||0)-cC(t.align,i),o=(t.y||0)-fC(t.baseline,r);return e.set(s,o,s+i,o+r)},draw:function QMe(e,t,n){ga(t,i=>{if(n&&!n.intersects(i.bounds))return;const r=bR(i,this);let s=wR(i,r),o=DR(i,r);if(0===s||0===o)return;let u,c,f,d,a=(i.x||0)-cC(i.align,s),l=(i.y||0)-fC(i.baseline,o);!1!==i.aspect&&(c=r.width/r.height,f=i.width/i.height,c==c&&f==f&&c!==f&&(f<c?(d=s/c,l+=(o-d)/2,o=d):(d=o*c,a+=(s-d)/2,s=d))),(r.complete||r.toDataURL)&&(Wg(e,i),e.globalAlpha=null!=(u=i.opacity)?u:1,e.imageSmoothingEnabled=!1!==i.smooth,e.drawImage(r,a,l,s,o))})},pick:uC(),isect:Co,get:bR,xOffset:cC,yOffset:fC},eNe=vR("line",function yMe(e,t){const n=t[0];return dMe.curve(ZI(n.interpolate||"linear",n.orient,n.tension)).context(e)(t)},function RMe(e,t){for(var r,s,n=Math.pow(e[0].strokeWidth||1,2),i=e.length;--i>=0;)if(!1!==e[i].defined&&(r=e[i].x-t[0])*r+(s=e[i].y-t[1])*s<n)return e[i];return null});function dC(e,t){var n=t.path;if(null==n)return!0;var i=t.x||0,r=t.y||0,s=t.scaleX||1,o=t.scaleY||1,a=(t.angle||0)*nf,l=t.pathCache;(!l||l.path!==n)&&((t.pathCache=l=Hg(n)).path=n),a&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(a),gy(e,l,0,0,s,o),e.rotate(-a),e.translate(-i,-r)):gy(e,l,i,r,s,o)}var iNe={type:"path",tag:"path",nested:!1,attr:function tNe(e,t){(1!==(t.scaleX||1)||1!==(t.scaleY||1))&&e("vector-effect","non-scaling-stroke"),e("transform",function NMe(e){return Zd(e.x||0,e.y||0)+(e.angle?" "+_R(e.angle):"")+(e.scaleX||e.scaleY?" "+function OMe(e,t){return"scale("+e+","+t+")"}(e.scaleX||1,e.scaleY||1):"")}(t)),e("d",t.path)},bound:function nNe(e,t){return dC(by(e,t.angle),t)?e.set(0,0,0,0):Ru(e,t,!0)},draw:gR(dC),pick:mR(dC),isect:dR(dC)};function XK(e,t){e.beginPath(),zg(e,t)}var oNe={type:"rect",tag:"path",nested:!1,attr:function rNe(e,t){e("d",zg(null,t))},bound:function sNe(e,t){var n,i;return Ru(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)},draw:gR(XK),pick:mR(XK),isect:HK};function QK(e,t,n){var i,r,s,o;return!(!t.stroke||!qg(e,t,n)||(i=t.x||0,r=t.y||0,s=null!=t.x2?t.x2:i,o=null!=t.y2?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(s,o),0))}var fNe={type:"rule",tag:"line",nested:!1,attr:function aNe(e,t){e("transform",qK(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function lNe(e,t){var n,i;return Ru(e.set(n=t.x||0,i=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:i),t)},draw:function uNe(e,t,n){ga(t,i=>{if(!n||n.intersects(i.bounds)){var r=null==i.opacity?1:i.opacity;r&&QK(e,i,r)&&(Wg(e,i),e.stroke())}})},pick:uC(function cNe(e,t,n,i){return!!e.isPointInStroke&&QK(e,t,1)&&e.isPointInStroke(n,i)}),isect:UK},dNe=yR("shape",function vMe(e,t){return(t.mark.shape||t.shape).context(e)(t)}),hNe=yR("symbol",function bMe(e,t){return pMe.context(e)(t)},hR);const ZK=Mz();var ma={height:vl,measureWidth:ER,estimateWidth:CR,width:CR,canvas:eJ};function eJ(e){ma.width=e&&af?ER:CR}function CR(e,t){return tJ(uf(e,t),vl(e))}function tJ(e,t){return~~(.8*e.length*t)}function ER(e,t){return vl(e)<=0||!(t=uf(e,t))?0:nJ(t,hC(e))}function nJ(e,t){const n="(".concat(t,") ").concat(e);let i=ZK.get(n);return void 0===i&&(af.font=t,i=af.measureText(e).width,ZK.set(n,i)),i}function vl(e){return null!=e.fontSize?+e.fontSize||0:11}function lf(e){return null!=e.lineHeight?e.lineHeight:vl(e)+2}function Ey(e){return function pNe(e){return Z(e)?e.length>1?e:e[0]:e}(e.lineBreak&&e.text&&!Z(e.text)?e.text.split(e.lineBreak):e.text)}function SR(e){const t=Ey(e);return(Z(t)?t.length-1:0)*lf(e)}function uf(e,t){const n=null==t?"":(t+"").trim();return e.limit>0&&n.length?function mNe(e,t){var n=+e.limit,i=function gNe(e){if(ma.width===ER){const t=hC(e);return n=>nJ(n,t)}{const t=vl(e);return n=>tJ(n,t)}}(e);if(i(t)<n)return t;var l,r=e.ellipsis||"\u2026",s="rtl"===e.dir,o=0,a=t.length;if(n-=i(r),s){for(;o<a;)i(t.slice(l=o+a>>>1))>n?o=l+1:a=l;return r+t.slice(o)}for(;o<a;)i(t.slice(0,l=1+(o+a>>>1)))<n?o=l:a=l-1;return t.slice(0,o)+r}(e,n):n}function Sy(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function hC(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+vl(e)+"px "+Sy(e,t)}function xR(e){var t=e.baseline,n=vl(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:"line-top"===t?.29*n+.5*lf(e):"line-bottom"===t?.29*n-.5*lf(e):0)}eJ(!0);const _Ne={left:"start",center:"middle",right:"end"},xy=new ui;function pC(e){var r,t=e.x||0,n=e.y||0,i=e.radius||0;return i&&(r=(e.theta||0)-Kd,t+=i*Math.cos(r),n+=i*Math.sin(r)),xy.x1=t,xy.y1=n,xy}function AR(e,t,n){var f,i=ma.height(t),r=t.align,s=pC(t),o=s.x1,a=s.y1,l=t.dx||0,u=(t.dy||0)+xR(t)-Math.round(.8*i),c=Ey(t);if(Z(c)?(i+=lf(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,ma.width(t,h)),0)):f=ma.width(t,c),"center"===r?l-=f/2:"right"===r&&(l-=f),e.set(l+=o,u+=a,l+f,u+i),t.angle&&!n)e.rotate(t.angle*nf,o,a);else if(2===n)return e.rotatedPoints(t.angle*nf,o,a);return e}var DNe={type:"text",tag:"text",nested:!1,attr:function yNe(e,t){var l,n=t.dx||0,i=(t.dy||0)+xR(t),r=pC(t),s=r.x1,o=r.y1,a=t.angle||0;e("text-anchor",_Ne[t.align]||"start"),a?(l=Zd(s,o)+" "+_R(a),(n||i)&&(l+=" "+Zd(n,i))):l=Zd(s+n,o+i),e("transform",l)},bound:AR,draw:function vNe(e,t,n){ga(t,i=>{var s,o,a,l,u,c,f,r=null==i.opacity?1:i.opacity;if(!(n&&!n.intersects(i.bounds)||0===r||i.fontSize<=0||null==i.text||0===i.text.length)){if(e.font=hC(i),e.textAlign=i.align||"left",o=(s=pC(i)).x1,a=s.y1,i.angle&&(e.save(),e.translate(o,a),e.rotate(i.angle*nf),o=a=0),o+=i.dx||0,a+=(i.dy||0)+xR(i),c=Ey(i),Wg(e,i),Z(c))for(u=lf(i),l=0;l<c.length;++l)f=uf(i,c[l]),i.fill&&aC(e,i,r)&&e.fillText(f,o,a),i.stroke&&qg(e,i,r)&&e.strokeText(f,o,a),a+=u;else f=uf(i,c),i.fill&&aC(e,i,r)&&e.fillText(f,o,a),i.stroke&&qg(e,i,r)&&e.strokeText(f,o,a);i.angle&&e.restore()}})},pick:uC(function bNe(e,t,n,i,r,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=pC(t),a=o.x1,l=o.y1,u=AR(xy,t,1),c=-t.angle*nf,f=Math.cos(c),d=Math.sin(c);return u.contains(f*r-d*s+(a-f*a+d*l),d*r+f*s+(l-d*a-f*l))}),isect:function wNe(e,t){const n=AR(xy,e,2);return Gg(t,n[0],n[1],n[2],n[3])||Gg(t,n[0],n[1],n[4],n[5])||Gg(t,n[4],n[5],n[6],n[7])||Gg(t,n[2],n[3],n[6],n[7])}},CNe=vR("trail",function wMe(e,t){return gMe.context(e)(t)},function FMe(e,t){for(var i,r,n=e.length;--n>=0;)if(!1!==e[n].defined&&(i=e[n].x-t[0])*i+(r=e[n].y-t[1])*r<(i=e[n].size||1)*i)return e[n];return null}),Hs={arc:kMe,area:PMe,group:KMe,image:ZMe,line:eNe,path:iNe,rect:oNe,rule:fNe,shape:dNe,symbol:hNe,text:DNe,trail:CNe};function TR(e,t,n){var i=Hs[e.mark.marktype];return i.nested&&(e=e.mark),(t||i.bound)(e.bounds||(e.bounds=new ui),e,n)}var iJ={mark:null};function rJ(e,t,n){var a,l,u,c,i=Hs[e.marktype],r=i.bound,s=e.items,o=s&&s.length;if(i.nested)return o?u=s[0]:(iJ.mark=e,u=iJ),c=TR(u,r,n),t&&t.union(c)||c;if(t=t||e.bounds&&e.bounds.clear()||new ui,o)for(a=0,l=s.length;a<l;++a)t.union(TR(s[a],r,n));return e.bounds=t}const ENe=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function sJ(e,t){return JSON.stringify(e,ENe,t)}function oJ(e){return aJ("string"==typeof e?JSON.parse(e):e)}function aJ(e){var i,r,s,t=e.marktype,n=e.items;if(n)for(r=0,s=n.length;r<s;++r)n[r][i=t?"mark":"group"]=e,n[r].zindex&&(n[r][i].zdirty=!0),"group"===(t||i)&&aJ(n[r]);return t&&rJ(e),e}function OR(e){arguments.length?this.root=oJ(e):(this.root=lJ({marktype:"group",name:"root",role:"frame"}),this.root.items=[new tC(this.root)])}function lJ(e,t){const n={bounds:new ui,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return null!=e.aria&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function cf(e,t,n){return!e&&"undefined"!=typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function MR(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function cs(e,t,n,i){var s,r=e.childNodes[t];return(!r||r.tagName.toLowerCase()!==n.toLowerCase())&&(s=r||null,r=cf(e.ownerDocument,n,i),e.insertBefore(r,s)),r}function _a(e,t){for(var n=e.childNodes,i=n.length;i>t;)e.removeChild(n[--i]);return e}function uJ(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function gC(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function ff(e,t){this._active=null,this._handlers={},this._loader=e||rD(),this._tooltip=t||xNe}function xNe(e,t,n,i){e.element().setAttribute("title",i||"")}function bl(e){this._el=null,this._bgcolor=null,this._loader=new sR(e)}OR.prototype={toJSON(e){return sJ(this.root,e||0)},mark(e,t,n){const i=lJ(e,t=t||this.root.items[0]);return t.items[n]=i,i.zindex&&(i.group.zdirty=!0),i}},ff.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let i=e?e.length:0;--i>=0;)if(e[i].type===t&&(!n||e[i].handler===n))return i;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const i in t)n.push(...t[i]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(i=>{const r=new MouseEvent(e.type,e),s=cf(null,"a");for(const o in i)s.setAttribute(o,i[o]);s.dispatchEvent(r)}).catch(()=>{})},handleTooltip(e,t,n){t&&null!=t.tooltip&&(t=function SNe(e,t,n,i){var s,o,r=e&&e.mark;if(r&&(s=Hs[r.marktype]).tip){for((o=gC(t,n))[0]-=i[0],o[1]-=i[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=s.tip(r.items,o)}return e}(t,e,this.canvas(),this._origin),this._tooltip.call(this._obj,this,e,t,n&&t&&t.tooltip||null))},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),i=this._origin,r=e.bounds,s=r.width(),o=r.height();let a=r.x1+i[0]+n.left,l=r.y1+i[1]+n.top;for(;e.mark&&(e=e.mark.group);)a+=e.x||0,l+=e.y||0;return{x:a,y:l,width:s,height:o,left:a,top:l,right:a+s,bottom:l+o}}},bl.prototype={initialize(e,t,n,i,r){return this._el=e,this.resize(t,n,i,r)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,i){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=i||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,i=n._loader[e](t);if(!n._ready){const r=n._call;n._ready=n._loader.ready().then(s=>{s&&r(),n._ready=null})}return i},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const cJ="dragenter",mC="dragleave",fJ="dragover",NR="mousedown",_C="mousemove",Ay="mouseout",dJ="mouseover",yC="click",hJ="mousewheel",vC="touchstart",bC="touchmove",wC="touchend",kR=_C,Ty=Ay,IR=yC;function Oy(e,t){ff.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}function pJ(e,t){(e=>e===vC||e===bC||e===wC?[vC,bC,wC]:[e])(t).forEach(n=>function FNe(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?i=>e[t](i):i=>e.fire(t,i)))}(e,n))}function gJ(e,t,n){return function(i){const r=this._active,s=this.pickEvent(i);s===r||((!r||!r.exit)&&this.fire(n,i),this._active=s,this.fire(t,i)),this.fire(e,i)}}function mJ(e){return function(t){this.fire(e,t),this._active=null}}ce(Oy,ff,{initialize(e,t,n){return this._canvas=e&&MR(e,"canvas"),[yC,NR,_C,Ay,mC].forEach(i=>pJ(this,i)),ff.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",cJ,mC,fJ,NR,"mouseup",_C,Ay,dJ,yC,"dblclick","wheel",hJ,vC,bC,wC],DOMMouseScroll(e){this.fire(hJ,e)},mousemove:gJ(_C,dJ,Ay),dragover:gJ(fJ,cJ,mC),mouseout:mJ(Ay),dragleave:mJ(mC),mousedown(e){this._down=this._active,this.fire(NR,e)},click(e){this._down===this._active&&(this.fire(yC,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(vC,e,!0)},touchmove(e){this.fire(bC,e,!0)},touchend(e){this.fire(wC,e,!0),this._touch=null},fire(e,t,n){const i=n?this._touch:this._active,r=this._handlers[e];if(t.vegaType=e,e===IR&&i&&i.href?this.handleHref(t,i,i.href):(e===kR||e===Ty)&&this.handleTooltip(t,i,e!==Ty),r)for(let s=0,o=r.length;s<o;++s)r[s].handler.call(this._obj,t,i)},on(e,t){const n=this.eventName(e),i=this._handlers;return this._handlerIndex(i[n],e,t)<0&&(pJ(this,e),(i[n]||(i[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&i.splice(r,1),this},pickEvent(e){const t=gC(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,i,r){const s=this.context();return Hs[e.marktype].pick.call(this,s,e,t,n,i,r)}});var LNe=function PNe(){return"undefined"!=typeof window&&window.devicePixelRatio||1}();function DC(e){bl.call(this,e),this._options={},this._redraw=!1,this._dirty=new ui,this._tempb=new ui}const _J=bl.prototype;function RR(e,t){ff.call(this,e,t);const n=this;n._hrefHandler=FR(n,(i,r)=>{r&&r.href&&n.handleHref(i,r,r.href)}),n._tooltipHandler=FR(n,(i,r)=>{n.handleTooltip(i,r,i.type!==Ty)})}ce(DC,bl,{initialize(e,t,n,i,r,s){return this._options=s||{},this._canvas=this._options.externalContext?null:Jc(1,1),e&&this._canvas&&(_a(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),_J.initialize.call(this,e,t,n,i,r)},resize(e,t,n,i){if(_J.resize.call(this,e,t,n,i),this._canvas)!function jNe(e,t,n,i,r,s){const o="undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,a=e.getContext("2d"),l=o?LNe:r;e.width=t*l,e.height=n*l;for(const u in s)a[u]=s[u];o&&1!==l&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=l,a.setTransform(l,0,0,l,l*i[0],l*i[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const r=this._options.externalContext;r||Q("CanvasRenderer is missing a valid canvas or context"),r.scale(this._scale,this._scale),r.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,i=this._width,r=this._height,s=this._dirty,o=((e,t,n)=>(new ui).set(0,0,t,n).translate(-e[0],-e[1]))(n,i,r);t.save();const a=this._redraw||s.empty()?(this._redraw=!1,o.expand(1)):function $Ne(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(t,o.intersect(s),n);return this.clear(-n[0],-n[1],i,r),this.draw(t,e,a),t.restore(),s.clear(),this},draw(e,t,n){const i=Hs[t.marktype];t.clip&&function LMe(e,t){var n=t.clip;e.save(),Qe(n)?(e.beginPath(),n(e),e.clip()):YK(e,t.group)}(e,t),i.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,i){const r=this._options,s=this.context();"pdf"!==r.type&&!r.externalContext&&s.clearRect(e,t,n,i),null!=this._bgcolor&&(s.fillStyle=this._bgcolor,s.fillRect(e,t,n,i))}});const FR=(e,t)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,t.call(e._obj,n,i)};ce(RR,ff,{initialize(e,t,n){let i=this._svg;return i&&(i.removeEventListener(IR,this._hrefHandler),i.removeEventListener(kR,this._tooltipHandler),i.removeEventListener(Ty,this._tooltipHandler)),this._svg=i=e&&MR(e,"svg"),i&&(i.addEventListener(IR,this._hrefHandler),i.addEventListener(kR,this._tooltipHandler),i.addEventListener(Ty,this._tooltipHandler)),ff.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),i=this._handlers;if(this._handlerIndex(i[n],e,t)<0){const s={type:e,handler:t,listener:FR(this,t)};(i[n]||(i[n]=[])).push(s),this._svg&&this._svg.addEventListener(n,s.listener)}return this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&(this._svg&&this._svg.removeEventListener(n,i[r].listener),i.splice(r,1)),this}});const yJ="aria-hidden",PR="aria-label",LR="role",jR="aria-roledescription",vJ="graphics-object",BR="graphics-symbol",bJ=(e,t,n)=>({[LR]:e,[jR]:t,[PR]:n||void 0}),VNe=ua(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),wJ={axis:{desc:"axis",caption:function zNe(e){const t=e.datum,n=e.orient,i=t.title?xJ(e):null,r=e.context,s=r.scales[t.scale].value,o=r.dataflow.locale(),a=s.type;return"".concat("left"===n||"right"===n?"Y":"X","-axis")+(i?" titled '".concat(i,"'"):"")+" for a ".concat(Vg(a)?"discrete":a," scale")+" with ".concat(DK(o,s,e))}},legend:{desc:"legend",caption:function GNe(e){const t=e.datum,n=t.title?xJ(e):null,i="".concat(t.type||""," legend").trim(),r=t.scales,s=Object.keys(r),o=e.context,a=o.scales[r[s[0]]].value,l=o.dataflow.locale();return function qNe(e){return e.length?e[0].toUpperCase()+e.slice(1):e}(i)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function WNe(e){return e=e.map(t=>t+("fill"===t||"stroke"===t?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+yt(e)}(s))+" with ".concat(DK(l,a,e))}},"title-text":{desc:"title",caption:e=>"Title text '".concat(SJ(e),"'")},"title-subtitle":{desc:"subtitle",caption:e=>"Subtitle text '".concat(SJ(e),"'")}},DJ={ariaRole:LR,ariaRoleDescription:jR,description:PR};function CJ(e,t){const n=!1===t.aria;if(e(yJ,n||void 0),n||null==t.description)for(const i in DJ)e(DJ[i],void 0);else{const i=t.mark.marktype;e(PR,t.description),e(LR,t.ariaRole||("group"===i?vJ:BR)),e(jR,t.ariaRoleDescription||"".concat(i," mark"))}}function EJ(e){return!1===e.aria?{[yJ]:!0}:VNe[e.role]?null:wJ[e.role]?function UNe(e,t){try{const n=e.items[0],i=t.caption||(()=>"");return bJ(t.role||BR,t.desc,n.description||i(n))}catch(n){return null}}(e,wJ[e.role]):function HNe(e){const t=e.marktype,n="group"===t||"text"===t||e.items.some(i=>null!=i.description&&!1!==i.aria);return bJ(n?vJ:BR,"".concat(t," mark container"),e.description)}(e)}function SJ(e){return ve(e.text).join(" ")}function xJ(e){try{return ve(yt(e.items).items[0].text).join(" ")}catch(t){return null}}const AJ=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function $R(){let e="",t="",n="";const i=[],r=()=>t=n="",o=(l,u)=>(null!=u&&(t+=" ".concat(l,'="').concat((e=>AJ(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))(u),'"')),a),a={open(l){(l=>{t&&(e+="".concat(t,">").concat(n),r()),i.push(l)})(l),t="<"+l;for(var u=arguments.length,c=new Array(u>1?u-1:0),f=1;f<u;f++)c[f-1]=arguments[f];for(const d of c)for(const h in d)o(h,d[h]);return a},close(){const l=i.pop();return e+=t?t+(n?">".concat(n,"</").concat(l,">"):"/>"):"</".concat(l,">"),r(),a},attr:o,text:l=>(n+=AJ(l),a),toString:()=>e};return a}const TJ=e=>OJ($R(),e)+"";function OJ(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,i=n.length;for(let r=0;r<i;++r)e.attr(n[r].name,n[r].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const i of n)3===i.nodeType?e.text(i.nodeValue):OJ(e,i)}return e.close()}const CC={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},EC={blend:"mix-blend-mode"},MJ={fill:"none","stroke-miterlimit":10},NJ="http://www.w3.org/2000/xmlns/",bi=Cy.xmlns;function VR(e){bl.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const HR=bl.prototype;function kJ(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function KNe(e,t,n){let i,r,s;if("radial"===t.gradient){let o=cs(e,n++,"pattern",bi);df(o,{id:"p_"+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o=cs(o,0,"rect",bi),df(o,{width:1,height:1,fill:"url(".concat(RJ(),"#").concat(t.id,")")}),df(e=cs(e,n++,"radialGradient",bi),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else df(e=cs(e,n++,"linearGradient",bi),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(i=0,r=t.stops.length;i<r;++i)s=cs(e,i,"stop",bi),s.setAttribute("offset",t.stops[i].offset),s.setAttribute("stop-color",t.stops[i].color);return _a(e,i),n}function JNe(e,t,n){let i;return(e=cs(e,n,"clipPath",bi)).setAttribute("id",t.id),t.path?(i=cs(e,0,"path",bi),i.setAttribute("d",t.path)):(i=cs(e,0,"rect",bi),df(i,{x:0,y:0,width:t.width,height:t.height})),_a(e,1),n+1}function IJ(e,t,n,i,r){let o,s=e._svg;if(!s&&(o=t.ownerDocument,s=cf(o,i,bi),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},"g"===i))){const a=cf(o,"path",bi);s.appendChild(a),a.__data__=e;const l=cf(o,"g",bi);s.appendChild(l),l.__data__=e;const u=cf(o,"path",bi);s.appendChild(u),u.__data__=e,u.__values__={fill:"default"}}return(s.ownerSVGElement!==r||function QNe(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}ce(VR,bl,{initialize(e,t,n,i,r){return this._defs={},this._clearDefs(),e&&(this._svg=cs(e,0,"svg",bi),this._svg.setAttributeNS(NJ,"xmlns",bi),this._svg.setAttributeNS(NJ,"xmlns:xlink",Cy["xmlns:xlink"]),this._svg.setAttribute("version",Cy.version),this._svg.setAttribute("class","marks"),_a(e,1),this._root=cs(this._svg,0,"g",bi),df(this._root,MJ),_a(this._svg,1)),this.background(this._bgcolor),HR.initialize.call(this,e,t,n,i,r)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),HR.background.apply(this,arguments)},resize(e,t,n,i){return HR.resize.call(this,e,t,n,i),this._svg&&(df(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=cs(e,0,"rect",bi),df(n,{width:this._width,height:this._height,fill:t}));const i=TJ(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),i},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),_a(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,i,r,s,o,a,l;for(o=0,a=e.length;o<a;++o)if(n=e[o],i=n.mark,i.marktype!==r&&(r=i.marktype,s=Hs[r]),i.zdirty&&i.dirty!==t&&(this._dirtyAll=!1,kJ(n,t),i.items.forEach(u=>{u.dirty=t})),!i.zdirty){if(n.exit){s.nested&&i.items.length?(l=i.items[0],l._svg&&this._update(s,l._svg,l)):n._svg&&(l=n._svg.parentNode,l&&l.removeChild(n._svg)),n._svg=null;continue}n=s.nested?i.items[0]:n,n._update!==t&&(n._svg&&n._svg.ownerSVGElement?this._update(s,n._svg,n):(this._dirtyAll=!1,kJ(n,t)),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const i=this._svg,r=Hs[t.marktype],s=!1===t.interactive?"none":null,o="g"===r.tag,a=IJ(t,e,n,"g",i);a.setAttribute("class",uJ(t));const l=EJ(t);for(const d in l)Ir(a,d,l[d]);o||Ir(a,"pointer-events",s),Ir(a,"clip-path",t.clip?rR(this,t,t.group):null);let u=null,c=0;const f=d=>{const h=this.isDirty(d),p=IJ(d,a,u,r.tag,i);h&&(this._update(r,p,d),o&&function XNe(e,t,n){t=t.lastChild.previousSibling;let i,r=0;ga(n,s=>{i=e.mark(t,s,i),++r}),_a(t,1+r)}(this,p,d)),u=p,++c};return r.nested?t.items.length&&f(t.items[0]):ga(t,f),_a(a,c),a},_update(e,t,n){Fu=t,pr=t.__values__,CJ(Ny,n),e.attr(Ny,n,this);const i=ZNe[e.type];i&&i.call(this,e,t,n),Fu&&this.style(Fu,n)},style(e,t){if(null!=t){for(const n in CC){let i="font"===n?Sy(t):t[n];if(i===pr[n])continue;const r=CC[n];null==i?e.removeAttribute(r):(QI(i)&&(i=EK(i,this._defs.gradient,RJ())),e.setAttribute(r,i+"")),pr[n]=i}for(const n in EC)SC(e,EC[n],t[n])}},defs(){const e=this._svg,t=this._defs;let n=t.el,i=0;for(const r in t.gradient)n||(t.el=n=cs(e,1,"defs",bi)),i=KNe(n,t.gradient[r],i);for(const r in t.clipping)n||(t.el=n=cs(e,1,"defs",bi)),i=JNe(n,t.clipping[r],i);n&&(0===i?(e.removeChild(n),t.el=null):_a(n,i))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});let Fu=null,pr=null;const ZNe={group(e,t,n){const i=Fu=t.childNodes[2];pr=i.__values__,e.foreground(Ny,n,this),pr=t.__values__,Fu=t.childNodes[1],e.content(Ny,n,this);const r=Fu=t.childNodes[0];e.background(Ny,n,this);const s=!1===n.mark.interactive?"none":null;if(s!==pr.events&&(Ir(i,"pointer-events",s),Ir(r,"pointer-events",s),pr.events=s),n.strokeForeground&&n.stroke){const o=n.fill;Ir(i,"display",null),this.style(r,n),Ir(r,"stroke",null),o&&(n.fill=null),pr=i.__values__,this.style(i,n),o&&(n.fill=o),Fu=null}else Ir(i,"display","none")},image(e,t,n){!1===n.smooth?(SC(t,"image-rendering","optimizeSpeed"),SC(t,"image-rendering","pixelated")):SC(t,"image-rendering",null)},text(e,t,n){const i=Ey(n);let r,s,o,a;Z(i)?(s=i.map(l=>uf(n,l)),r=s.join("\n"),r!==pr.text&&(_a(t,0),o=t.ownerDocument,a=lf(n),s.forEach((l,u)=>{const c=cf(o,"tspan",bi);c.__data__=n,c.textContent=l,u&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),pr.text=r)):(s=uf(n,i),s!==pr.text&&(t.textContent=s,pr.text=s)),Ir(t,"font-family",Sy(n)),Ir(t,"font-size",vl(n)+"px"),Ir(t,"font-style",n.fontStyle),Ir(t,"font-variant",n.fontVariant),Ir(t,"font-weight",n.fontWeight)}};function Ny(e,t,n){t!==pr[e]&&(n?function e2e(e,t,n,i){null!=n?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}(Fu,e,t,n):Ir(Fu,e,t),pr[e]=t)}function SC(e,t,n){n!==pr[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),pr[t]=n)}function df(e,t){for(const n in t)Ir(e,n,t[n])}function Ir(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function RJ(){let e;return"undefined"==typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function UR(e){bl.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}ce(UR,bl,{svg(){return this._text},_render(e){const t=$R();t.open("svg",Ze({},Cy,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",MJ,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=Hs[t.marktype],i=n.tag,r=[CJ,n.attr];e.open("g",{class:uJ(t),"clip-path":t.clip?rR(this,t,t.group):null},EJ(t),{"pointer-events":"g"!==i&&!1===t.interactive?"none":null});const s=o=>{const a=this.href(o);if(a&&e.open("a",a),e.open(i,this.attr(t,o,r,"g"!==i?i:null)),"text"===i){const l=Ey(o);if(Z(l)){const u={x:0,dy:lf(o)};for(let c=0;c<l.length;++c)e.open("tspan",c?u:null).text(uf(o,l[c])).close()}else e.text(uf(o,l))}else if("g"===i){const l=o.strokeForeground,u=o.fill,c=o.stroke;l&&c&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),ga(o,f=>this.mark(e,f)),e.close(),l&&c?(u&&(o.fill=null),o.stroke=c,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),u&&(o.fill=u)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),a&&e.close()};return n.nested?t.items&&t.items.length&&s(t.items[0]):ga(t,s),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(i=>{i["xlink:href"]=i.href,i.href=null,(this._hrefs||(this._hrefs={}))[t]=i})}return null},attr(e,t,n,i){const r={},s=(o,a,l,u)=>{r[u||o]=a};return Array.isArray(n)?n.forEach(o=>o(s,t,this)):n(s,t,this),i&&function t2e(e,t,n,i,r){let s;if(null==t||("bgrect"===i&&!1===n.interactive&&(e["pointer-events"]="none"),"bgfore"===i&&(!1===n.interactive&&(e["pointer-events"]="none"),e.display="none",null!==t.fill)))return e;"image"===i&&!1===t.smooth&&(s=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),"text"===i&&(e["font-family"]=Sy(t),e["font-size"]=vl(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const o in CC){let a=t[o];const l=CC[o];"transparent"===a&&("fill"===l||"stroke"===l)||null!=a&&(QI(a)&&(a=EK(a,r.gradient,"")),e[l]=a)}for(const o in EC){const a=t[o];null!=a&&(s=s||[],s.push("".concat(EC[o],": ").concat(a,";")))}s&&(e.style=s.join(" "))}(r,t,e,i,this._defs),r},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const r in t){const s=t[r],o=s.stops;"radial"===s.gradient?(e.open("pattern",{id:"p_"+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),e.close(),e.open("radialGradient",{id:r,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):e.open("linearGradient",{id:r,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let a=0;a<o.length;++a)e.open("stop",{offset:o[a].offset,"stop-color":o[a].color}).close();e.close()}for(const r in n){const s=n[r];e.open("clipPath",{id:r}),s.path?e.open("path",{d:s.path}).close():e.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),e.close()}e.close()}}});const hf={Canvas:"canvas",PNG:"png",SVG:"svg",None:"none"},Yg={};function xC(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Yg[e]=t,this):Yg[e]}function BJ(e,t,n){const i=[],r=(new ui).union(t),s=e.marktype;return s?$J(e,r,n,i):"group"===s?VJ(e,r,n,i):Q("Intersect scene must be mark node or group item.")}function $J(e,t,n,i){if(function n2e(e,t,n){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!n||n(e)))}(e,t,n)){const r=e.items,s=e.marktype,o=r.length;let a=0;if("group"===s)for(;a<o;++a)VJ(r[a],t,n,i);else for(const l=Hs[s].isect;a<o;++a){const u=r[a];HJ(u,t,l)&&i.push(u)}}return i}function VJ(e,t,n,i){n&&n(e.mark)&&HJ(e,t,Hs.group.isect)&&i.push(e);const r=e.items,s=r&&r.length;if(s){const o=e.x||0,a=e.y||0;t.translate(-o,-a);for(let l=0;l<s;++l)$J(r[l],t,n,i);t.translate(o,a)}return i}function HJ(e,t,n){const i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}Yg.canvas=Yg.png={renderer:DC,headless:DC,handler:Oy},Yg.svg={renderer:VR,headless:UR,handler:RR},Yg.none={};const zR=new ui;function UJ(e){const t=e.clip;if(Qe(t))t(by(zR.clear()));else{if(!t)return;zR.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(zR)}function GR(e,t,n){return e===t||("path"===n?zJ(e,t):e instanceof Date&&t instanceof Date?+e==+t:Xt(e)&&Xt(t)?Math.abs(e-t)<=1e-9:e&&t&&(Ce(e)||Ce(t))?function r2e(e,t){var r,s,n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(n.sort(),i.sort(),s=n.length-1;s>=0;s--)if(n[s]!=i[s])return!1;for(s=n.length-1;s>=0;s--)if(!GR(e[r=n[s]],t[r],r))return!1;return typeof e==typeof t}(e,t):e==t)}function zJ(e,t){return GR(Hg(e),Hg(t))}function s2e(){FK(),function MOe(){CK=0}()}const Kg="top",ya="left",va="right",pf="bottom",WR="start",qR="middle",Rr="end",AC="group",YR="axis",KR="title",JR="legend",GJ="row-header",WJ="row-footer",qJ="row-title",YJ="column-header",KJ="column-footer",JJ="column-title",XR="none",TC="all",QR="each",ZR="flush",gf="column",mf="row";function QJ(e){K.call(this,null,e)}function OC(e,t,n){return t(e.bounds.clear(),e,n)}ce(QJ,K,{transform(e,t){const n=t.dataflow,i=e.mark,r=i.marktype,s=Hs[r],o=s.bound;let l,a=i.bounds;if(s.nested)i.items.length&&n.dirty(i.items[0]),a=OC(i,o),i.items.forEach(u=>{u.bounds.clear().union(a)});else if(r===AC||e.modified())switch(t.visit(t.MOD,u=>n.dirty(u)),a.clear(),i.items.forEach(u=>a.union(OC(u,o))),i.role){case YR:case JR:case KR:t.reflow()}else l=t.changed(t.REM),t.visit(t.ADD,u=>{a.union(OC(u,o))}),t.visit(t.MOD,u=>{l=l||a.alignsWith(u.bounds),n.dirty(u),a.union(OC(u,o))}),l&&(a.clear(),i.items.forEach(u=>a.union(u.bounds)));return UJ(i),t.modifies("bounds")}});const ZJ=":vega_identifier:";function eF(e){K.call(this,0,e)}function eX(e){K.call(this,null,e)}function tX(e){K.call(this,null,e)}eF.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},ce(eF,K,{transform(e,t){const n=function v2e(e){return e._signals[ZJ]||(e._signals[ZJ]=e.add(0))}(t.dataflow),i=e.as;let r=n.value;return t.visit(t.ADD,s=>s[i]=s[i]||++r),n.set(this.value=r),t}}),ce(eX,K,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,function b2e(e){const t=e.groups,n=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const i=n.marktype===AC?tC:eC;return t.visit(t.ADD,r=>i.call(r,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});const nX={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((i,r)=>r&&iX(n.bounds,i.bounds,t)?i.opacity=0:(n=i,1))}},iX=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),rX=(e,t)=>{for(var s,n=1,i=e.length,r=e[0].bounds;n<i;r=s,++n)if(iX(r,s=e[n].bounds,t))return!0},w2e=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},sX=e=>(e.forEach(t=>t.opacity=1),e),oX=(e,t)=>e.reflow(t.modified()).modifies("opacity");function aX(e){K.call(this,null,e)}ce(tX,K,{transform(e,t){const n=nX[e.method]||nX.parity,i=e.separation||0;let s,o,r=t.materialize(t.SOURCE).source;if(!r||!r.length)return;if(!e.method)return e.modified("method")&&(sX(r),t=oX(t,e)),t;if(r=r.filter(w2e),!r.length)return;if(e.sort&&(r=r.slice().sort(e.sort)),s=sX(r),t=oX(t,e),s.length>=3&&rX(s,i)){do{s=n(s,i)}while(s.length>=3&&rX(s,i));s.length<3&&!yt(r).opacity&&(s.length>1&&(yt(s).opacity=0),yt(r).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(o=((e,t,n)=>{var i=e.range(),r=new ui;return t===Kg||t===pf?r.set(i[0],-1/0,i[1],1/0):r.set(-1/0,i[0],1/0,i[1]),r.expand(n||1),s=>r.encloses(s.bounds)})(e.boundScale,e.boundOrient,+e.boundTolerance),r.forEach(l=>{o(l)||(l.opacity=0)}));const a=s[0].mark.bounds.clear();return r.forEach(l=>{l.opacity&&a.union(l.bounds)}),t}}),ce(aX,K,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,i=>n.dirty(i)),t.fields&&t.fields.zindex){const i=t.source&&t.source[0];i&&(i.mark.zdirty=!0)}}});const gr=new ui;function Jg(e,t,n){return e[t]===n?0:(e[t]=n,1)}function C2e(e){var t=e.items[0].orient;return t===ya||t===va}function S2e(e,t,n,i){var b,D,r=t.items[0],s=r.datum,o=null!=r.translate?r.translate:.5,a=r.orient,l=function E2e(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}(s),u=r.range,c=r.offset,f=r.position,d=r.minExtent,h=r.maxExtent,p=s.title&&r.items[l[2]].items[0],g=r.titlePadding,m=r.bounds,_=p&&SR(p),y=0,v=0;switch(gr.clear().union(m),m.clear(),(b=l[0])>-1&&m.union(r.items[b].bounds),(b=l[1])>-1&&m.union(r.items[b].bounds),a){case Kg:y=f||0,v=-c,D=Math.max(d,Math.min(h,-m.y1)),m.add(0,-D).add(u,0),p&&MC(e,p,D,g,_,0,-1,m);break;case ya:y=-c,v=f||0,D=Math.max(d,Math.min(h,-m.x1)),m.add(-D,0).add(0,u),p&&MC(e,p,D,g,_,1,-1,m);break;case va:y=n+c,v=f||0,D=Math.max(d,Math.min(h,m.x2)),m.add(0,0).add(D,u),p&&MC(e,p,D,g,_,1,1,m);break;case pf:y=f||0,v=i+c,D=Math.max(d,Math.min(h,m.y2)),m.add(0,0).add(u,D),p&&MC(e,p,D,g,0,0,1,m);break;default:y=r.x,v=r.y}return Ru(m.translate(y,v),r),Jg(r,"x",y+o)|Jg(r,"y",v+o)&&(r.bounds=gr,e.dirty(r),r.bounds=m,e.dirty(r)),r.mark.bounds.clear().union(m)}function MC(e,t,n,i,r,s,o,a){const l=t.bounds;if(t.auto){const u=o*(n+r+i);let c=0,f=0;e.dirty(t),s?c=(t.x||0)-(t.x=u):f=(t.y||0)-(t.y=u),t.mark.bounds.clear().union(l.translate(-c,-f)),e.dirty(t)}a.union(l)}const lX=(e,t)=>Math.floor(Math.min(e,t)),uX=(e,t)=>Math.ceil(Math.max(e,t));function A2e(e){return(new ui).set(0,0,e.width||0,e.height||0)}function T2e(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function En(e,t,n){const i=Ce(e)?e[t]:e;return null!=i?i:void 0!==n?n:0}function cX(e){return e<0?Math.ceil(-e):0}function fX(e,t,n){var C,w,E,O,M,N,R,P,A,x,S,i=!n.nodirty,r=n.bounds===ZR?A2e:T2e,s=gr.set(0,0,0,0),o=En(n.align,gf),a=En(n.align,mf),l=En(n.padding,gf),u=En(n.padding,mf),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),p=Array(c),g=0,m=Array(d),_=Array(f),y=0,v=Array(d),b=Array(d),D=Array(d);for(w=0;w<c;++w)p[w]=0;for(w=0;w<f;++w)_[w]=0;for(w=0;w<d;++w)M=D[w]=r(N=t[w]),N.x=N.x||0,v[w]=0,N.y=N.y||0,b[w]=0,E=w%c,O=~~(w/c),g=Math.max(g,R=Math.ceil(M.x2)),y=Math.max(y,P=Math.ceil(M.y2)),p[E]=Math.max(p[E],R),_[O]=Math.max(_[O],P),h[w]=l+cX(M.x1),m[w]=u+cX(M.y1),i&&e.dirty(t[w]);for(w=0;w<d;++w)w%c==0&&(h[w]=0),w<c&&(m[w]=0);if(o===QR)for(E=1;E<c;++E){for(S=0,w=E;w<d;w+=c)S<h[w]&&(S=h[w]);for(w=E;w<d;w+=c)h[w]=S+p[E-1]}else if(o===TC){for(S=0,w=0;w<d;++w)w%c&&S<h[w]&&(S=h[w]);for(w=0;w<d;++w)w%c&&(h[w]=S+g)}else for(o=!1,E=1;E<c;++E)for(w=E;w<d;w+=c)h[w]+=p[E-1];if(a===QR)for(O=1;O<f;++O){for(S=0,C=(w=O*c)+c;w<C;++w)S<m[w]&&(S=m[w]);for(w=O*c;w<C;++w)m[w]=S+_[O-1]}else if(a===TC){for(S=0,w=c;w<d;++w)S<m[w]&&(S=m[w]);for(w=c;w<d;++w)m[w]=S+y}else for(a=!1,O=1;O<f;++O)for(C=(w=O*c)+c;w<C;++w)m[w]+=_[O-1];for(A=0,w=0;w<d;++w)v[w]+=(A=h[w]+(w%c?A:0))-t[w].x;for(E=0;E<c;++E)for(x=0,w=E;w<d;w+=c)b[w]+=(x+=m[w])-t[w].y;if(o&&En(n.center,gf)&&f>1)for(w=0;w<d;++w)(A=(M=o===TC?g:p[w%c])-D[w].x2-t[w].x-v[w])>0&&(v[w]+=A/2);if(a&&En(n.center,mf)&&1!==c)for(w=0;w<d;++w)(x=(M=a===TC?y:_[~~(w/c)])-D[w].y2-t[w].y-b[w])>0&&(b[w]+=x/2);for(w=0;w<d;++w)s.union(D[w].translate(v[w],b[w]));switch(A=En(n.anchor,"x"),x=En(n.anchor,"y"),En(n.anchor,gf)){case Rr:A-=s.width();break;case qR:A-=s.width()/2}switch(En(n.anchor,mf)){case Rr:x-=s.height();break;case qR:x-=s.height()/2}for(A=Math.round(A),x=Math.round(x),s.clear(),w=0;w<d;++w)t[w].mark.bounds.clear();for(w=0;w<d;++w)(N=t[w]).x+=v[w]+=A,N.y+=b[w]+=x,s.union(N.mark.bounds.union(N.bounds.translate(v[w],b[w]))),i&&e.dirty(N);return s}function M2e(e,t){return"x1"===t?e.x||0:"y1"===t?e.y||0:"x2"===t?(e.x||0)+(e.width||0):"y2"===t?(e.y||0)+(e.height||0):void 0}function N2e(e,t){return e.bounds[t]}function NC(e,t,n,i,r,s,o,a,l,u,c,f,d,h){var _,y,v,b,D,C,w,E,O,p=n.length,g=0,m=0;if(!p)return g;for(_=c;_<p;_+=f)n[_]&&(g=o(g,l(n[_],u)));if(!t.length)return g;for(t.length>r&&(e.warn("Grid headers exceed limit: "+r),t=t.slice(0,r)),g+=s,y=0,b=t.length;y<b;++y)e.dirty(t[y]),t[y].mark.bounds.clear();for(_=c,y=0,b=t.length;y<b;++y,_+=f){for(D=(C=t[y]).mark.bounds,v=_;v>=0&&null==(w=n[v]);v-=d);a?(E=null==h?w.x:Math.round(w.bounds.x1+h*w.bounds.width()),O=g):(E=g,O=null==h?w.y:Math.round(w.bounds.y1+h*w.bounds.height())),D.union(C.bounds.translate(E-(C.x||0),O-(C.y||0))),C.x=E,C.y=O,e.dirty(C),m=o(m,D[u])}return m}function dX(e,t,n,i,r,s){if(t){e.dirty(t);var o=n,a=n;i?o=Math.round(r.x1+s*r.width()):a=Math.round(r.y1+s*r.height()),t.bounds.translate(o-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=a,e.dirty(t)}}function R2e(e,t,n,i,r,s,o){const a=function k2e(e,t){const n=e[t]||{};return(i,r)=>null!=n[i]?n[i]:null!=e[i]?e[i]:r}(n,t),l=function I2e(e,t){let n=-1/0;return e.forEach(i=>{null!=i.offset&&(n=Math.max(n,i.offset))}),n>-1/0?n:t}(e,a("offset",0)),u=a("anchor",WR),c=u===Rr?1:u===qR?.5:0,f={align:QR,bounds:a("bounds",ZR),columns:"vertical"===a("direction")?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case ya:f.anchor={x:Math.floor(i.x1)-l,column:Rr,y:c*(o||i.height()+2*i.y1),row:u};break;case va:f.anchor={x:Math.ceil(i.x2)+l,y:c*(o||i.height()+2*i.y1),row:u};break;case Kg:f.anchor={y:Math.floor(r.y1)-l,row:Rr,x:c*(s||r.width()+2*r.x1),column:u};break;case pf:f.anchor={y:Math.ceil(r.y2)+l,x:c*(s||r.width()+2*r.x1),column:u};break;case"top-left":f.anchor={x:l,y:l};break;case"top-right":f.anchor={x:s-l,y:l,column:Rr};break;case"bottom-left":f.anchor={x:l,y:o-l,row:Rr};break;case"bottom-right":f.anchor={x:s-l,y:o-l,column:Rr,row:Rr}}return f}function F2e(e,t){var l,u,n=t.items[0],i=n.datum,r=n.orient,s=n.bounds,o=n.x,a=n.y;return n._bounds?n._bounds.clear().union(s):n._bounds=s.clone(),s.clear(),function L2e(e,t,n){var i=t.padding,r=i-n.x,s=i-n.y;if(t.datum.title){var o=t.items[1].items[0],a=o.anchor,l=t.titlePadding||0,u=i-o.x,c=i-o.y;switch(o.orient){case ya:r+=Math.ceil(o.bounds.width())+l;break;case va:case pf:break;default:s+=o.bounds.height()+l}switch((r||s)&&ky(e,n,r,s),o.orient){case ya:c+=Xg(t,n,o,a,1,1);break;case va:u+=Xg(t,n,o,Rr,0,0)+l,c+=Xg(t,n,o,a,1,1);break;case pf:u+=Xg(t,n,o,a,0,0),c+=Xg(t,n,o,Rr,-1,0,1)+l;break;default:u+=Xg(t,n,o,a,0,0)}(u||c)&&ky(e,o,u,c),(u=Math.round(o.bounds.x1-i))<0&&(ky(e,n,-u,0),ky(e,o,-u,0))}else(r||s)&&ky(e,n,r,s)}(e,n,n.items[0].items[0]),s=function P2e(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}(n,s),l=2*n.padding,u=2*n.padding,s.empty()||(l=Math.ceil(s.width()+l),u=Math.ceil(s.height()+u)),"symbol"===i.type&&function j2e(e){const t=e.reduce((n,i)=>(n[i.column]=Math.max(i.bounds.x2-i.x,n[i.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}(n.items[0].items[0].items[0].items),r!==XR&&(n.x=o=0,n.y=a=0),n.width=l,n.height=u,Ru(s.set(o,a,o+l,a+u),n),n.mark.bounds.clear().union(s),n}function Xg(e,t,n,i,r,s,o){const l=n.datum.vgrad,c=("symbol"===e.datum.type||!s&&l||o?t:t.items[0]).bounds[r?"y2":"x2"]-e.padding,f=l&&s?c:0,d=l&&s?0:c,h=r<=0?0:SR(n);return Math.round(i===WR?f:i===Rr?d-h:.5*(c-h))}function ky(e,t,n,i){t.x+=n,t.y+=i,t.bounds.translate(n,i),t.mark.bounds.translate(n,i),e.dirty(t)}function hX(e){K.call(this,null,e)}function pX(e,t){let n=0;if(void 0===t)for(let i of e)(i=+i)&&(n+=i);else{let i=-1;for(let r of e)(r=+t(r,++i,e))&&(n+=r)}return n}function gX(e){K.call(this,null,e)}function mX(e){K.call(this,null,e)}function U2e(){return jt({})}function _X(e){K.call(this,null,e)}function yX(e){K.call(this,[],e)}ce(hX,K,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(i=>{e.layout&&function O2e(e,t,n){var c,f,d,h,p,g,m,i=function x2e(e){var r,s,t=e.items,n=t.length,i=0;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;i<n;++i)if(s=(r=t[i]).items,r.marktype===AC)switch(r.role){case YR:case JR:case KR:break;case GJ:o.rowheaders.push(...s);break;case WJ:o.rowfooters.push(...s);break;case YJ:o.colheaders.push(...s);break;case KJ:o.colfooters.push(...s);break;case qJ:o.rowtitle=s[0];break;case JJ:o.coltitle=s[0];break;default:o.marks.push(...s)}return o}(t),r=i.marks,s=n.bounds===ZR?M2e:N2e,o=n.offset,a=n.columns||r.length,l=a<=0?1:Math.ceil(r.length/a),u=l*a;const _=fX(e,r,n);_.empty()&&_.set(0,0,0,0),i.rowheaders&&(g=En(n.headerBand,mf,null),c=NC(e,i.rowheaders,r,0,l,-En(o,"rowHeader"),lX,0,s,"x1",0,a,1,g)),i.colheaders&&(g=En(n.headerBand,gf,null),f=NC(e,i.colheaders,r,0,a,-En(o,"columnHeader"),lX,1,s,"y1",0,1,a,g)),i.rowfooters&&(g=En(n.footerBand,mf,null),d=NC(e,i.rowfooters,r,0,l,En(o,"rowFooter"),uX,0,s,"x2",a-1,a,1,g)),i.colfooters&&(g=En(n.footerBand,gf,null),h=NC(e,i.colfooters,r,0,a,En(o,"columnFooter"),uX,1,s,"y2",u-a,1,a,g)),i.rowtitle&&(p=En(n.titleAnchor,mf),m=En(o,"rowTitle"),m=p===Rr?d+m:c-m,g=En(n.titleBand,mf,.5),dX(e,i.rowtitle,m,0,_,g)),i.coltitle&&(p=En(n.titleAnchor,gf),m=En(o,"columnTitle"),m=p===Rr?h+m:f-m,g=En(n.titleBand,gf,.5),dX(e,i.coltitle,m,1,_,g))}(n,i,e.layout),function V2e(e,t,n){var c,f,d,p,g,i=t.items,r=Math.max(0,t.width||0),s=Math.max(0,t.height||0),o=(new ui).set(0,0,r,s),a=o.clone(),l=o.clone(),u=[];for(p=0,g=i.length;p<g;++p)switch(f=i[p],f.role){case YR:(C2e(f)?a:l).union(S2e(e,f,r,s));break;case KR:c=f;break;case JR:u.push(F2e(e,f));break;case"frame":case"scope":case GJ:case WJ:case qJ:case YJ:case KJ:case JJ:a.union(f.bounds),l.union(f.bounds);break;default:o.union(f.bounds)}if(u.length){const m={};u.forEach(_=>{(d=_.orient||va)!==XR&&(m[d]||(m[d]=[])).push(_)});for(const _ in m){const y=m[_];fX(e,y,R2e(y,_,n.legends,a,l,r,s))}u.forEach(_=>{const y=_.bounds;if(y.equals(_._bounds)||(_.bounds=_._bounds,e.dirty(_),_.bounds=y,e.dirty(_)),n.autosize&&"fit"===n.autosize.type)switch(_.orient){case ya:case va:o.add(y.x1,0).add(y.x2,0);break;case Kg:case pf:o.add(0,y.y1).add(0,y.y2)}else o.union(y)})}o.union(a).union(l),c&&o.union(function B2e(e,t,n,i,r){var v,s=t.items[0],a=s.orient,l=s.anchor,u=s.offset,c=s.padding,f=s.items[0].items[0],d=s.items[1]&&s.items[1].items[0],h=a===ya||a===va?i:n,p=0,g=0,m=0,_=0,y=0;if(s.frame!==AC?a===ya?(p=r.y2,h=r.y1):a===va?(p=r.y1,h=r.y2):(p=r.x1,h=r.x2):a===ya&&(p=i,h=0),v=l===WR?p:l===Rr?h:(p+h)/2,d&&d.text){switch(a){case Kg:case pf:y=f.bounds.height()+c;break;case ya:_=f.bounds.width()+c;break;case va:_=-f.bounds.width()-c}gr.clear().union(d.bounds),gr.translate(_-(d.x||0),y-(d.y||0)),Jg(d,"x",_)|Jg(d,"y",y)&&(e.dirty(d),d.bounds.clear().union(gr),d.mark.bounds.clear().union(gr),e.dirty(d)),gr.clear().union(d.bounds)}else gr.clear();switch(gr.union(f.bounds),a){case Kg:g=v,m=r.y1-gr.height()-u;break;case ya:g=r.x1-gr.width()-u,m=v;break;case va:g=r.x2+gr.width()+u,m=v;break;case pf:g=v,m=r.y2+u;break;default:g=s.x,m=s.y}return Jg(s,"x",g)|Jg(s,"y",m)&&(gr.translate(g,m),e.dirty(s),s.bounds.clear().union(gr),t.bounds.clear().union(gr),e.dirty(s)),s.bounds}(e,c,r,s,o)),t.clip&&o.set(0,0,t.width||0,t.height||0),function H2e(e,t,n,i){const r=i.autosize||{},s=r.type;if(e._autosize<1||!s)return;let o=e._width,a=e._height,l=Math.max(0,t.width||0),u=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-l)),h=Math.max(0,Math.ceil(n.y2-c));if("padding"===r.contains){const p=e.padding();o-=p.left+p.right,a-=p.top+p.bottom}s===XR?(u=0,f=0,l=o,c=a):"fit"===s?(l=Math.max(0,o-u-d),c=Math.max(0,a-f-h)):"fit-x"===s?(l=Math.max(0,o-u-d),a=c+f+h):"fit-y"===s?(o=l+u+d,c=Math.max(0,a-f-h)):"pad"===s&&(o=l+u+d,a=c+f+h),e._resizeView(o,a,l,c,[u,f],r.resize)}(e,t,o,n)}(n,i,e)}),function $2e(e){return e&&"legend-entry"!==e.mark.role}(e.mark.group)?t.reflow():t}}),ce(gX,K,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.scale,a=KI(s,null==e.count?e.values?e.values.length:10:e.count,e.minstep),l=e.format||gK(n,s,a,e.formatSpecifier,e.formatType,!!e.values),u=e.values?pK(s,e.values,a):JI(s,a);return r&&(i.rem=r),r=u.map((c,f)=>jt({index:f/(u.length-1||1),value:c,label:l(c)})),e.extra&&r.length&&r.push(jt({index:-1,extra:{value:r[0].value},label:""})),i.source=r,i.add=r,this.value=r,i}}),ce(mX,K,{transform(e,t){var n=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||U2e,s=e.key||Ie,o=this.value;return Z(i.encode)&&(i.encode=null),o&&(e.modified("key")||t.modified(s))&&Q("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=function z2e(e){const t=yg().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}(s)),t.visit(t.ADD,a=>{const l=s(a);let u=o.get(l);u?u.exit?(o.empty--,i.add.push(u)):i.mod.push(u):(u=r(a),o.set(l,u),i.add.push(u)),u.datum=a,u.exit=!1}),t.visit(t.MOD,a=>{const l=s(a),u=o.get(l);u&&(u.datum=a,i.mod.push(u))}),t.visit(t.REM,a=>{const l=s(a),u=o.get(l);a===u.datum&&!u.exit&&(i.rem.push(u),u.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&i.modifies("datum"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),i}}),ce(_X,K,{transform(e,t){var n=t.fork(t.ADD_REM),i=e.mod||!1,r=e.encoders,s=t.encode;if(Z(s)){if(!n.changed()&&!s.every(f=>r[f]))return t.StopPropagation;s=s[0],n.encode=null}var o="enter"===s,a=r.update||Rc,l=r.enter||Rc,u=r.exit||Rc,c=(s&&!o?r[s]:a)||Rc;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{l(f,e),a(f,e)}),n.modifies(l.output),n.modifies(a.output),c!==Rc&&c!==a&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&u!==Rc&&(t.visit(t.REM,f=>{u(f,e)}),n.modifies(u.output)),o||c!==Rc){const f=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(f,d=>{const h=l(d,e)||i;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(l.output)):t.visit(f,d=>{(c(d,e)||i)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}}),ce(yX,K,{transform(e,t){if(null!=this.value&&!e.modified())return t.StopPropagation;var d,h,p,g,m,n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.type||JD,o=e.scale,a=+e.limit,l=KI(o,null==e.count?5:e.count,e.minstep),c=e.format||vK(n,o,l,s,e.formatSpecifier,e.formatType,!!e.values||s===JD),f=e.values||yK(o,l);return r&&(i.rem=r),s===JD?(a&&f.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),r=f.slice(0,a-1),m=!0):r=f,Qe(p=e.size)?(!e.values&&0===o(r[0])&&(r=r.slice(1)),g=r.reduce((_,y)=>Math.max(_,p(y,e)),0)):p=ur(g=p||8),r=r.map((_,y)=>jt({index:y,label:c(_,y,r),value:_,offset:g,size:p(_,e)})),m&&(m=f[r.length],r.push(jt({index:r.length,label:"\u2026".concat(f.length-r.length," entries"),value:m,offset:g,size:p(m,e)})))):"gradient"===s?(d=o.domain(),h=cK(o,d[0],yt(d)),f.length<3&&!e.values&&d[0]!==yt(d)&&(f=[d[0],yt(d)]),r=f.map((_,y)=>jt({index:y,label:c(_,y,f),value:_,perc:h(_)}))):(p=f.length-1,h=function TOe(e){const t=e.domain(),n=t.length-1;let i=+t[0],r=+yt(t),s=r-i;if(e.type===qD){const o=n?s/n:.1;i-=o,r+=o,s=r-i}return o=>(o-i)/s}(o),r=f.map((_,y)=>jt({index:y,label:c(_,y,f),value:_,perc:y?h(_):0,perc2:y===p?1:h(f[y+1])}))),i.source=r,i.add=r,this.value=r,i}});const G2e=e=>e.source.x,W2e=e=>e.source.y,q2e=e=>e.target.x,Y2e=e=>e.target.y;function tF(e){K.call(this,{},e)}tF.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},ce(tF,K,{transform(e,t){var n=e.sourceX||G2e,i=e.sourceY||W2e,r=e.targetX||q2e,s=e.targetY||Y2e,o=e.as||"path",l=e.shape||"line",u=DX.get(l+"-"+(e.orient||"vertical"))||DX.get(l);return u||Q("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[o]=u(n(c),i(c),r(c),s(c))}),t.reflow(e.modified()).modifies(o)}});const vX=(e,t,n,i)=>"M"+e+","+t+"L"+n+","+i,bX=(e,t,n,i)=>{var r=n-e,s=i-t,o=Math.sqrt(r*r+s*s)/2;return"M"+e+","+t+"A"+o+","+o+" "+180*Math.atan2(s,r)/Math.PI+" 0 1 "+n+","+i},wX=(e,t,n,i)=>{const r=n-e,s=i-t,o=.2*(r+s),a=.2*(s-r);return"M"+e+","+t+"C"+(e+o)+","+(t+a)+" "+(n+a)+","+(i-o)+" "+n+","+i},DX=yg({line:vX,"line-radial":(e,t,n,i)=>vX(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),arc:bX,"arc-radial":(e,t,n,i)=>bX(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),curve:wX,"curve-radial":(e,t,n,i)=>wX(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),"orthogonal-horizontal":(e,t,n,i)=>"M"+e+","+t+"V"+i+"H"+n,"orthogonal-vertical":(e,t,n,i)=>"M"+e+","+t+"H"+n+"V"+i,"orthogonal-radial":(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n);return"M"+t*r+","+t*s+"A"+t+","+t+" 0 0,"+((Math.abs(n-e)>Math.PI?n<=e:n>e)?1:0)+" "+t*o+","+t*a+"L"+i*o+","+i*a},"diagonal-horizontal":(e,t,n,i)=>{const r=(e+n)/2;return"M"+e+","+t+"C"+r+","+t+" "+r+","+i+" "+n+","+i},"diagonal-vertical":(e,t,n,i)=>{const r=(t+i)/2;return"M"+e+","+t+"C"+e+","+r+" "+n+","+r+" "+n+","+i},"diagonal-radial":(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),l=(t+i)/2;return"M"+t*r+","+t*s+"C"+l*r+","+l*s+" "+l*o+","+l*a+" "+i*o+","+i*a}});function nF(e){K.call(this,null,e)}function CX(e){return GI(e)&&e!==ml}nF.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},ce(nF,K,{transform(e,t){var p,g,m,n=e.as||["startAngle","endAngle"],i=n[0],r=n[1],o=e.startAngle||0,a=null!=e.endAngle?e.endAngle:2*Math.PI,l=t.source,u=l.map(e.field||gg),c=u.length,f=o,d=(a-o)/pX(u),h=Vs(c);for(e.sort&&h.sort((_,y)=>u[_]-u[y]),p=0;p<c;++p)m=u[h[p]],(g=l[h[p]])[i]=f,g[r]=f+=m*d;return this.value=u,t.reflow(e.modified()).modifies(n)}});const Z2e=ua(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function EX(e){K.call(this,null,e),this.modified(!0)}function SX(e,t,n){return sK(e)&&Math.abs(t.reduce((r,s)=>r+(s<0?-1:s>0?1:0),0))!==t.length&&n.warn("Log scale domain includes zero: "+fe(t)),t}function xX(e,t,n){return Qe(e)&&(t||n)?lK(e,iF(t||[0,1],n)):e}function iF(e,t){return t?e.slice().reverse():e}function AX(e){K.call(this,null,e)}ce(EX,K,{transform(e,t){var n=t.dataflow,i=this.value,r=function eke(e){var i,t=e.type,n="";return t===ml?ml+"-"+jg:(function tke(e){const t=e.type;return GI(t)&&t!==Wd&&t!==qd&&(e.scheme||e.range&&e.range.length&&e.range.every(_e))}(e)&&(n=2===(i=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(null!=e.domainMid):0)?ml+"-":3===i?Bg+"-":""),(n+t||jg).toLowerCase())}(e);for(r in(!i||r!==i.type)&&(this.value=i=kt(r)()),e)if(!Z2e[r]){if("padding"===r&&CX(i.type))continue;Qe(i[r])?i[r](e[r]):n.warn("Unsupported scale property: "+r)}return function oke(e,t,n){var i=e.type,r=t.round||!1,s=t.range;if(null!=t.rangeStep)s=function ake(e,t,n){return"band"!==e&&e!==VI&&Q("Only band and point scales support rangeStep."),[0,t.rangeStep*BI(n,e===VI?1:(null!=t.paddingInner?t.paddingInner:t.padding)||0,(null!=t.paddingOuter?t.paddingOuter:t.padding)||0)]}(i,t,n);else if(t.scheme&&Qe(s=function lke(e,t,n){var s,i=t.schemeExtent;return Z(t.scheme)?s=KD(t.scheme,t.interpolate,t.interpolateGamma):(s=YI(t.scheme.toLowerCase()))||Q("Unrecognized scheme name: ".concat(t.scheme)),n=e===qD?n+1:e===HI?n-1:e===$g||e===WD?+t.schemeCount||5:n,oK(e)?xX(s,i,t.reverse):Qe(s)?uK(xX(s,i),n):e===$I?s:s.slice(0,n)}(i,t,n))){if(e.interpolator)return e.interpolator(s);Q("Scale type ".concat(i," does not support interpolating color schemes."))}if(s&&oK(i))return e.interpolator(KD(iF(s,t.reverse),t.interpolate,t.interpolateGamma));s&&t.interpolate&&e.interpolate?e.interpolate(qI(t.interpolate,t.interpolateGamma)):Qe(e.round)?e.round(r):Qe(e.rangeRound)&&e.interpolate(r?ly:Zc),s&&e.range(iF(s,t.reverse))}(i,e,function ske(e,t,n){let i=t.bins;if(i&&!Z(i)){const r=e.domain(),s=r[0],o=yt(r),a=i.step;let l=null==i.start?s:i.start,u=null==i.stop?o:i.stop;a||Q("Scale bins parameter missing step property."),l<s&&(l=a*Math.ceil(s/a)),u>o&&(u=a*Math.floor(o/a)),i=Vs(l,u+a/2,a)}return i?e.bins=i:e.bins&&delete e.bins,e.type===HI&&(i?!t.domain&&!t.domainRaw&&(e.domain(i),n=i.length):e.bins=e.domain()),n}(i,e,function nke(e,t,n){const i=function ike(e,t,n){return t?(e.domain(SX(e.type,t,n)),t.length):-1}(e,t.domainRaw,n);if(i>-1)return i;var a,l,r=t.domain,s=e.type,o=t.zero||void 0===t.zero&&function Q2e(e){const t=e.type;return!e.bins&&(t===jg||t===fy||t===dy)}(e);if(!r)return 0;if(CX(s)&&t.padding&&r[0]!==yt(r)&&(r=function rke(e,t,n,i,r,s){var o=Math.abs(yt(n)-n[0]),a=o/(o-2*i),l=e===ku?QN(t,null,a):e===dy?Uw(t,null,a,.5):e===fy?Uw(t,null,a,r||1):e===GD?ZN(t,null,a,s||1):XN(t,null,a);return(t=t.slice())[0]=l[0],t[t.length-1]=l[1],t}(s,r,t.range,t.padding,t.exponent,t.constant)),(o||null!=t.domainMin||null!=t.domainMax||null!=t.domainMid)&&(a=(r=r.slice()).length-1||1,o&&(r[0]>0&&(r[0]=0),r[a]<0&&(r[a]=0)),null!=t.domainMin&&(r[0]=t.domainMin),null!=t.domainMax&&(r[a]=t.domainMax),null!=t.domainMid)){const u=(l=t.domainMid)>r[a]?a+1:l<r[0]?0:a;u!==a&&n.warn("Scale domainMid exceeds domain min or max.",l),r.splice(u,0,l)}return e.domain(SX(s,r,n)),s===$I&&e.unknown(t.domainImplicit?OI:void 0),t.nice&&e.nice&&e.nice(!0!==t.nice&&KI(e,t.nice)||null),r.length}(i,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),ce(AX,K,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(Pd(e.sort)),this.modified(n),t}});const MX="normalize",NX=["y0","y1"];function rF(e){K.call(this,null,e)}function uke(e,t,n,i,r){for(var l,s=(t-e.sum)/2,o=e.length,a=0;a<o;++a)(l=e[a])[i]=s,l[r]=s+=Math.abs(n(l))}function cke(e,t,n,i,r){for(var c,s=1/e.sum,o=0,a=e.length,l=0,u=0;l<a;++l)(c=e[l])[i]=o,c[r]=o=s*(u+=Math.abs(n(c)))}function fke(e,t,n,i,r){for(var u,c,s=0,o=0,a=e.length,l=0;l<a;++l)(u=+n(c=e[l]))<0?(c[i]=o,c[r]=o+=u):(c[i]=s,c[r]=s+=u)}rF.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:"zero",values:["zero","center",MX]},{name:"as",type:"string",array:!0,length:2,default:NX}]},ce(rF,K,{transform(e,t){var l,u,c,f,n=e.as||NX,i=n[0],r=n[1],s=Pd(e.sort),o=e.field||gg,a="center"===e.offset?uke:e.offset===MX?cke:fke;for(l=function dke(e,t,n,i){var o,a,l,u,c,f,d,h,p,r=[],s=g=>g(c);if(null==t)r.push(e.slice());else for(o={},a=0,l=e.length;a<l;++a)c=e[a],(d=o[f=t.map(s)])||(o[f]=d=[],r.push(d)),d.push(c);for(f=0,p=0,u=r.length;f<u;++f){for(a=0,h=0,l=(d=r[f]).length;a<l;++a)h+=Math.abs(i(d[a]));d.sum=h,h>p&&(p=h),n&&d.sort(n)}return r.max=p,r}(t.source,e.groupby,s,o),u=0,c=l.length,f=l.max;u<c;++u)a(l[u],f,o,i,r);return t.reflow(e.modified()).modifies(n)}});const Iy=e=>e;function kC(e,t){e&&IX.hasOwnProperty(e.type)&&IX[e.type](e,t)}var kX={Feature:function(e,t){kC(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)kC(n[i].geometry,t)}},IX={Sphere:function(e,t){t.sphere()},Point:function(e,t){t.point((e=e.coordinates)[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)t.point((e=n[i])[0],e[1],e[2])},LineString:function(e,t){sF(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)sF(n[i],t,0)},Polygon:function(e,t){RX(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)RX(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)kC(n[i],t)}};function sF(e,t,n){var s,i=-1,r=e.length-n;for(t.lineStart();++i<r;)t.point((s=e[i])[0],s[1],s[2]);t.lineEnd()}function RX(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)sF(e[n],t,1);t.polygonEnd()}function Pu(e,t){e&&kX.hasOwnProperty(e.type)?kX[e.type](e,t):kC(e,t)}class Wi{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const s=n[r],o=t+s,a=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);a&&(n[i++]=a),t=o}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let i,r,s,n=this._n,o=0;if(n>0){for(o=t[--n];n>0&&(i=o,r=t[--n],o=i+r,s=r-(o-i),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(r=2*s,i=o+r,r==i-o&&(o=i))}return o}}var Fe=1e-6,IC=1e-12,ut=Math.PI,zn=ut/2,RC=ut/4,Fr=2*ut,Zn=180/ut,ct=ut/180,Dt=Math.abs,Qg=Math.atan,No=Math.atan2,Le=Math.cos,FC=Math.ceil,FX=Math.exp,oF=(Math,Math.hypot),PC=Math.log,aF=Math.pow,Me=Math.sin,ko=Math.sign||function(e){return e>0?1:e<0?-1:0},Pr=Math.sqrt,lF=Math.tan;function PX(e){return e>1?0:e<-1?ut:Math.acos(e)}function fs(e){return e>1?zn:e<-1?-zn:Math.asin(e)}function qi(){}var LX,jX,fF,dF,uF=new Wi,cF=new Wi,_f={point:qi,lineStart:qi,lineEnd:qi,polygonStart:function(){_f.lineStart=hke,_f.lineEnd=gke},polygonEnd:function(){_f.lineStart=_f.lineEnd=_f.point=qi,uF.add(Dt(cF)),cF=new Wi},result:function(){var e=uF/2;return uF=new Wi,e}};function hke(){_f.point=pke}function pke(e,t){_f.point=BX,LX=fF=e,jX=dF=t}function BX(e,t){cF.add(dF*e-fF*t),fF=e,dF=t}function gke(){BX(LX,jX)}const $X=_f;var Zg=1/0,LC=Zg,Ry=-Zg,jC=Ry,mke={point:function _ke(e,t){e<Zg&&(Zg=e),e>Ry&&(Ry=e),t<LC&&(LC=t),t>jC&&(jC=t)},lineStart:qi,lineEnd:qi,polygonStart:qi,polygonEnd:qi,result:function(){var e=[[Zg,LC],[Ry,jC]];return Ry=jC=-(LC=Zg=1/0),e}};const BC=mke;var VX,HX,wl,Dl,hF=0,pF=0,Fy=0,$C=0,VC=0,em=0,gF=0,mF=0,Py=0,ba={point:eh,lineStart:UX,lineEnd:zX,polygonStart:function(){ba.lineStart=bke,ba.lineEnd=wke},polygonEnd:function(){ba.point=eh,ba.lineStart=UX,ba.lineEnd=zX},result:function(){var e=Py?[gF/Py,mF/Py]:em?[$C/em,VC/em]:Fy?[hF/Fy,pF/Fy]:[NaN,NaN];return hF=pF=Fy=$C=VC=em=gF=mF=Py=0,e}};function eh(e,t){hF+=e,pF+=t,++Fy}function UX(){ba.point=yke}function yke(e,t){ba.point=vke,eh(wl=e,Dl=t)}function vke(e,t){var n=e-wl,i=t-Dl,r=Pr(n*n+i*i);$C+=r*(wl+e)/2,VC+=r*(Dl+t)/2,em+=r,eh(wl=e,Dl=t)}function zX(){ba.point=eh}function bke(){ba.point=Dke}function wke(){GX(VX,HX)}function Dke(e,t){ba.point=GX,eh(VX=wl=e,HX=Dl=t)}function GX(e,t){var n=e-wl,i=t-Dl,r=Pr(n*n+i*i);$C+=r*(wl+e)/2,VC+=r*(Dl+t)/2,em+=r,gF+=(r=Dl*e-wl*t)*(wl+e),mF+=r*(Dl+t),Py+=3*r,eh(wl=e,Dl=t)}const WX=ba;function qX(e){this._context=e}qX.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Fr)}},result:qi};var yF,YX,KX,Ly,jy,_F=new Wi,HC={point:qi,lineStart:function(){HC.point=Cke},lineEnd:function(){yF&&JX(YX,KX),HC.point=qi},polygonStart:function(){yF=!0},polygonEnd:function(){yF=null},result:function(){var e=+_F;return _F=new Wi,e}};function Cke(e,t){HC.point=JX,YX=Ly=e,KX=jy=t}function JX(e,t){_F.add(Pr((Ly-=e)*Ly+(jy-=t)*jy)),Ly=e,jy=t}const XX=HC;function QX(){this._string=[]}function ZX(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function eQ(e,t){var i,r,n=4.5;function s(o){return o&&("function"==typeof n&&r.pointRadius(+n.apply(this,arguments)),Pu(o,i(r))),r.result()}return s.area=function(o){return Pu(o,i($X)),$X.result()},s.measure=function(o){return Pu(o,i(XX)),XX.result()},s.bounds=function(o){return Pu(o,i(BC)),BC.result()},s.centroid=function(o){return Pu(o,i(WX)),WX.result()},s.projection=function(o){return arguments.length?(i=null==o?(e=null,Iy):(e=o).stream,s):e},s.context=function(o){return arguments.length?(r=null==o?(t=null,new QX):new qX(t=o),"function"!=typeof n&&r.pointRadius(n),s):t},s.pointRadius=function(o){return arguments.length?(n="function"==typeof o?o:(r.pointRadius(+o),+o),s):n},s.projection(e).context(t)}function tQ(){var t,e=[];return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:qi,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function UC(e,t){return Dt(e[0]-t[0])<Fe&&Dt(e[1]-t[1])<Fe}function zC(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function nQ(e,t,n,i,r){var a,l,s=[],o=[];if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,y,m=p[0],_=p[g];if(UC(m,_)){if(!m[2]&&!_[2]){for(r.lineStart(),a=0;a<g;++a)r.point((m=p[a])[0],m[1]);return void r.lineEnd()}_[0]+=2*Fe}s.push(y=new zC(m,p,null,!0)),o.push(y.o=new zC(m,null,y,!1)),s.push(y=new zC(_,p,null,!1)),o.push(y.o=new zC(_,null,y,!0))}}),s.length){for(o.sort(t),iQ(s),iQ(o),a=0,l=o.length;a<l;++a)o[a].e=n=!n;for(var c,f,u=s[0];;){for(var d=u,h=!0;d.v;)if((d=d.n)===u)return;c=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(a=0,l=c.length;a<l;++a)r.point((f=c[a])[0],f[1]);else i(d.x,d.n.x,1,r);d=d.n}else{if(h)for(a=(c=d.p.z).length-1;a>=0;--a)r.point((f=c[a])[0],f[1]);else i(d.x,d.p.x,-1,r);d=d.p}c=(d=d.o).z,h=!h}while(!d.v);r.lineEnd()}}}function iQ(e){if(t=e.length){for(var t,r,n=0,i=e[0];++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function GC(e){return[No(e[1],e[0]),fs(e[2])]}function th(e){var t=e[0],n=e[1],i=Le(n);return[i*Le(t),i*Me(t),Me(n)]}function WC(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function tm(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function vF(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function qC(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function YC(e){var t=Pr(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function bF(e){return Dt(e[0])<=ut?e[0]:ko(e[0])*((Dt(e[0])+ut)%Fr-ut)}function rQ(e){return Array.from(function*Ske(e){for(const t of e)yield*t}(e))}function sQ(e,t,n,i){return function(r){var u,c,f,s=t(r),o=tQ(),a=t(o),l=!1,d={point:h,lineStart:g,lineEnd:m,polygonStart:function(){d.point=_,d.lineStart=y,d.lineEnd=v,c=[],u=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=m,c=rQ(c);var b=function Eke(e,t){var n=bF(t),i=t[1],r=Me(i),s=[Me(n),-Le(n),0],o=0,a=0,l=new Wi;1===r?i=zn+Fe:-1===r&&(i=-zn-Fe);for(var u=0,c=e.length;u<c;++u)if(d=(f=e[u]).length)for(var f,d,h=f[d-1],p=bF(h),g=h[1]/2+RC,m=Me(g),_=Le(g),y=0;y<d;++y,p=b,m=C,_=w,h=v){var v=f[y],b=bF(v),D=v[1]/2+RC,C=Me(D),w=Le(D),E=b-p,O=E>=0?1:-1,M=O*E,N=M>ut,R=m*C;if(l.add(No(R*O*Me(M),_*w+R*Le(M))),o+=N?E+O*Fr:E,N^p>=n^b>=n){var P=tm(th(h),th(v));YC(P);var A=tm(s,P);YC(A);var x=(N^E>=0?-1:1)*fs(A[2]);(i>x||i===x&&(P[0]||P[1]))&&(a+=N^E>=0?1:-1)}}return(o<-Fe||o<Fe&&l<-IC)^1&a}(u,i);c.length?(l||(r.polygonStart(),l=!0),nQ(c,Ake,b,n,r)):b&&(l||(r.polygonStart(),l=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),l&&(r.polygonEnd(),l=!1),c=u=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function h(b,D){e(b,D)&&r.point(b,D)}function p(b,D){s.point(b,D)}function g(){d.point=p,s.lineStart()}function m(){d.point=h,s.lineEnd()}function _(b,D){f.push([b,D]),a.point(b,D)}function y(){a.lineStart(),f=[]}function v(){_(f[0][0],f[0][1]),a.lineEnd();var C,E,O,M,b=a.clean(),D=o.result(),w=D.length;if(f.pop(),u.push(f),f=null,w){if(1&b){if((E=(O=D[0]).length-1)>0){for(l||(r.polygonStart(),l=!0),r.lineStart(),C=0;C<E;++C)r.point((M=O[C])[0],M[1]);r.lineEnd()}return}w>1&&2&b&&D.push(D.pop().concat(D.shift())),c.push(D.filter(xke))}}return d}}function xke(e){return e.length>1}function Ake(e,t){return((e=e.x)[0]<0?e[1]-zn-Fe:zn-e[1])-((t=t.x)[0]<0?t[1]-zn-Fe:zn-t[1])}QX.prototype={_radius:4.5,_circle:ZX(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._string.push("M",e,",",t),this._point=1;break;case 1:this._string.push("L",e,",",t);break;default:null==this._circle&&(this._circle=ZX(this._radius)),this._string.push("M",e,",",t,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}};const oQ=sQ(function(){return!0},function Tke(e){var r,t=NaN,n=NaN,i=NaN;return{lineStart:function(){e.lineStart(),r=1},point:function(s,o){var a=s>0?ut:-ut,l=Dt(s-t);Dt(l-ut)<Fe?(e.point(t,n=(n+o)/2>0?zn:-zn),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(s,n),r=0):i!==a&&l>=ut&&(Dt(t-i)<Fe&&(t-=i*Fe),Dt(s-a)<Fe&&(s-=a*Fe),n=function Oke(e,t,n,i){var r,s,o=Me(e-n);return Dt(o)>Fe?Qg((Me(t)*(s=Le(i))*Me(n)-Me(i)*(r=Le(t))*Me(e))/(r*s*o)):(t+i)/2}(t,n,s,o),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),r=0),e.point(t=s,n=o),i=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}},function Mke(e,t,n,i){var r;if(null==e)i.point(-ut,r=n*zn),i.point(0,r),i.point(ut,r),i.point(ut,0),i.point(ut,-r),i.point(0,-r),i.point(-ut,-r),i.point(-ut,0),i.point(-ut,r);else if(Dt(e[0]-t[0])>Fe){var s=e[0]<t[0]?ut:-ut;i.point(-s,r=n*s/2),i.point(0,r),i.point(s,r)}else i.point(t[0],t[1])},[-ut,-zn]);function lQ(e,t){(t=th(t))[0]-=e,YC(t);var n=PX(-t[1]);return((-t[2]<0?-n:n)+Fr-Fe)%Fr}function Nke(e){var t=Le(e),n=6*ct,i=t>0,r=Dt(t)>Fe;function o(c,f){return Le(c)*Le(f)>t}function l(c,f,d){var g=[1,0,0],m=tm(th(c),th(f)),_=WC(m,m),y=m[0],v=_-y*y;if(!v)return!d&&c;var b=t*_/v,D=-t*y/v,C=tm(g,m),w=qC(g,b);vF(w,qC(m,D));var O=C,M=WC(w,O),N=WC(O,O),R=M*M-N*(WC(w,w)-1);if(!(R<0)){var P=Pr(R),A=qC(O,(-M-P)/N);if(vF(A,w),A=GC(A),!d)return A;var F,x=c[0],S=f[0],k=c[1],T=f[1];S<x&&(F=x,x=S,S=F);var I=S-x,j=Dt(I-ut)<Fe;if(!j&&T<k&&(F=k,k=T,T=F),j||I<Fe?j?k+T>0^A[1]<(Dt(A[0]-x)<Fe?k:T):k<=A[1]&&A[1]<=T:I>ut^(x<=A[0]&&A[0]<=S)){var U=qC(O,(-M+P)/N);return vF(U,w),[A,GC(U)]}}}function u(c,f){var d=i?e:ut-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return sQ(o,function a(c){var f,d,h,p,g;return{lineStart:function(){p=h=!1,g=1},point:function(m,_){var v,y=[m,_],b=o(m,_),D=i?b?0:u(m,_):b?u(m+(m<0?ut:-ut),_):0;if(!f&&(p=h=b)&&c.lineStart(),b!==h&&(!(v=l(f,y))||UC(f,v)||UC(y,v))&&(y[2]=1),b!==h)g=0,b?(c.lineStart(),v=l(y,f),c.point(v[0],v[1])):(v=l(f,y),c.point(v[0],v[1],2),c.lineEnd()),f=v;else if(r&&f&&i^b){var C;!(D&d)&&(C=l(y,f,!0))&&(g=0,i?(c.lineStart(),c.point(C[0][0],C[0][1]),c.point(C[1][0],C[1][1]),c.lineEnd()):(c.point(C[1][0],C[1][1]),c.lineEnd(),c.lineStart(),c.point(C[0][0],C[0][1],3)))}b&&(!f||!UC(f,y))&&c.point(y[0],y[1]),f=y,h=b,d=D},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return g|(p&&h)<<1}}},function s(c,f,d,h){!function aQ(e,t,n,i,r,s){if(n){var o=Le(t),a=Me(t),l=i*n;null==r?(r=t+i*Fr,s=t-l/2):(r=lQ(o,r),s=lQ(o,s),(i>0?r<s:r>s)&&(r+=i*Fr));for(var u,c=r;i>0?c>s:c<s;c-=l)u=GC([o,-a*Le(c),-a*Me(c)]),e.point(u[0],u[1])}}(h,e,n,d,c,f)},i?[0,-e]:[-ut,e-ut])}var By=1e9,KC=-By;function uQ(e,t,n,i){function r(u,c){return e<=u&&u<=n&&t<=c&&c<=i}function s(u,c,f,d){var h=0,p=0;if(null==u||(h=o(u,f))!==(p=o(c,f))||l(u,c)<0^f>0)do{d.point(0===h||3===h?e:n,h>1?i:t)}while((h=(h+f+4)%4)!==p);else d.point(c[0],c[1])}function o(u,c){return Dt(u[0]-e)<Fe?c>0?0:3:Dt(u[0]-n)<Fe?c>0?2:1:Dt(u[1]-t)<Fe?c>0?1:0:c>0?3:2}function a(u,c){return l(u.x,c.x)}function l(u,c){var f=o(u,1),d=o(c,1);return f!==d?f-d:0===f?c[1]-u[1]:1===f?u[0]-c[0]:2===f?u[1]-c[1]:c[0]-u[0]}return function(u){var d,h,p,g,m,_,y,v,b,D,C,c=u,f=tQ(),w={point:E,lineStart:function R(){w.point=A,h&&h.push(p=[]),D=!0,b=!1,y=v=NaN},lineEnd:function P(){d&&(A(g,m),_&&b&&f.rejoin(),d.push(f.result())),w.point=E,b&&c.lineEnd()},polygonStart:function M(){c=f,d=[],h=[],C=!0},polygonEnd:function N(){var x=function O(){for(var x=0,S=0,k=h.length;S<k;++S)for(var V,U,T=h[S],F=1,I=T.length,j=T[0],L=j[0],W=j[1];F<I;++F)V=L,U=W,L=(j=T[F])[0],W=j[1],U<=i?W>i&&(L-V)*(i-U)>(W-U)*(e-V)&&++x:W<=i&&(L-V)*(i-U)<(W-U)*(e-V)&&--x;return x}(),S=C&&x,k=(d=rQ(d)).length;(S||k)&&(u.polygonStart(),S&&(u.lineStart(),s(null,null,1,u),u.lineEnd()),k&&nQ(d,a,x,s,u),u.polygonEnd()),c=u,d=h=p=null}};function E(x,S){r(x,S)&&c.point(x,S)}function A(x,S){var k=r(x,S);if(h&&p.push([x,S]),D)g=x,m=S,_=k,D=!1,k&&(c.lineStart(),c.point(x,S));else if(k&&b)c.point(x,S);else{var T=[y=Math.max(KC,Math.min(By,y)),v=Math.max(KC,Math.min(By,v))],F=[x=Math.max(KC,Math.min(By,x)),S=Math.max(KC,Math.min(By,S))];!function kke(e,t,n,i,r,s){var p,o=e[0],a=e[1],c=0,f=1,d=t[0]-o,h=t[1]-a;if(p=n-o,d||!(p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=r-o,d||!(p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}if(p=i-a,h||!(p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=s-a,h||!(p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=o+c*d,e[1]=a+c*h),f<1&&(t[0]=o+f*d,t[1]=a+f*h),!0}}}}}(T,F,e,t,n,i)?k&&(c.lineStart(),c.point(x,S),C=!1):(b||(c.lineStart(),c.point(T[0],T[1])),c.point(F[0],F[1]),k||c.lineEnd(),C=!1)}y=x,v=S,b=k}return w}}function wF(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return(i=t.invert(i,r))&&e.invert(i[0],i[1])}),n}function DF(e,t){return[Dt(e)>ut?e+Math.round(-e/Fr)*Fr:e,t]}function cQ(e,t,n){return(e%=Fr)?t||n?wF(dQ(e),hQ(t,n)):dQ(e):t||n?hQ(t,n):DF}function fQ(e){return function(t,n){return[(t+=e)>ut?t-Fr:t<-ut?t+Fr:t,n]}}function dQ(e){var t=fQ(e);return t.invert=fQ(-e),t}function hQ(e,t){var n=Le(e),i=Me(e),r=Le(t),s=Me(t);function o(a,l){var u=Le(l),c=Le(a)*u,f=Me(a)*u,d=Me(l),h=d*n+c*i;return[No(f*r-h*s,c*n-d*i),fs(h*r+f*s)]}return o.invert=function(a,l){var u=Le(l),c=Le(a)*u,f=Me(a)*u,d=Me(l),h=d*r-f*s;return[No(f*r+d*s,c*n+h*i),fs(h*n-c*i)]},o}function $y(e){return function(t){var n=new CF;for(var i in e)n[i]=e[i];return n.stream=t,n}}function CF(){}function EF(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=i&&e.clipExtent(null),Pu(n,e.stream(BC)),t(BC.result()),null!=i&&e.clipExtent(i),e}function JC(e,t,n){return EF(e,function(i){var r=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(r/(i[1][0]-i[0][0]),s/(i[1][1]-i[0][1])),a=+t[0][0]+(r-o*(i[1][0]+i[0][0]))/2,l=+t[0][1]+(s-o*(i[1][1]+i[0][1]))/2;e.scale(150*o).translate([a,l])},n)}function SF(e,t,n){return JC(e,[[0,0],t],n)}function xF(e,t,n){return EF(e,function(i){var r=+t,s=r/(i[1][0]-i[0][0]),o=(r-s*(i[1][0]+i[0][0]))/2,a=-s*i[0][1];e.scale(150*s).translate([o,a])},n)}function AF(e,t,n){return EF(e,function(i){var r=+t,s=r/(i[1][1]-i[0][1]),o=-s*i[0][0],a=(r-s*(i[1][1]+i[0][1]))/2;e.scale(150*s).translate([o,a])},n)}DF.invert=DF,CF.prototype={constructor:CF,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Rke=Le(30*ct);function gQ(e,t){return+t?function Pke(e,t){function n(i,r,s,o,a,l,u,c,f,d,h,p,g,m){var _=u-i,y=c-r,v=_*_+y*y;if(v>4*t&&g--){var b=o+d,D=a+h,C=l+p,w=Pr(b*b+D*D+C*C),E=fs(C/=w),O=Dt(Dt(C)-1)<Fe||Dt(s-f)<Fe?(s+f)/2:No(D,b),M=e(O,E),N=M[0],R=M[1],P=N-i,A=R-r,x=y*P-_*A;(x*x/v>t||Dt((_*P+y*A)/v-.5)>.3||o*d+a*h+l*p<Rke)&&(n(i,r,s,o,a,l,N,R,O,b/=w,D/=w,C,g,m),m.point(N,R),n(N,R,O,b,D,C,u,c,f,d,h,p,g,m))}}return function(i){var r,s,o,a,l,u,c,f,d,h,p,g,m={point:_,lineStart:y,lineEnd:b,polygonStart:function(){i.polygonStart(),m.lineStart=D},polygonEnd:function(){i.polygonEnd(),m.lineStart=y}};function _(E,O){E=e(E,O),i.point(E[0],E[1])}function y(){f=NaN,m.point=v,i.lineStart()}function v(E,O){var M=th([E,O]),N=e(E,O);n(f,d,c,h,p,g,f=N[0],d=N[1],c=E,h=M[0],p=M[1],g=M[2],16,i),i.point(f,d)}function b(){m.point=_,i.lineEnd()}function D(){y(),m.point=C,m.lineEnd=w}function C(E,O){v(r=E,O),s=f,o=d,a=h,l=p,u=g,m.point=v}function w(){n(f,d,c,h,p,g,s,o,r,a,l,u,16,i),m.lineEnd=b,b()}return m}}(e,t):function Fke(e){return $y({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)}var Lke=$y({point:function(e,t){this.stream.point(e*ct,t*ct)}});function mQ(e,t,n,i,r,s){if(!s)return function Bke(e,t,n,i,r){function s(o,a){return[t+e*(o*=i),n-e*(a*=r)]}return s.invert=function(o,a){return[(o-t)/e*i,(n-a)/e*r]},s}(e,t,n,i,r);var o=Le(s),a=Me(s),l=o*e,u=a*e,c=o/e,f=a/e,d=(a*n-o*t)/e,h=(a*t+o*n)/e;function p(g,m){return[l*(g*=i)-u*(m*=r)+t,n-u*g-l*m]}return p.invert=function(g,m){return[i*(c*g-f*m+d),r*(h-f*g-c*m)]},p}function Cl(e){return _Q(function(){return e})()}function _Q(e){var t,c,_,y,v,C,w,E,O,M,n=150,i=480,r=250,s=0,o=0,a=0,l=0,u=0,f=0,d=1,h=1,p=null,g=oQ,m=null,b=Iy,D=.5;function N(x){return E(x[0]*ct,x[1]*ct)}function R(x){return(x=E.invert(x[0],x[1]))&&[x[0]*Zn,x[1]*Zn]}function P(){var x=mQ(n,0,0,d,h,f).apply(null,t(s,o)),S=mQ(n,i-x[0],r-x[1],d,h,f);return c=cQ(a,l,u),w=wF(t,S),E=wF(c,w),C=gQ(w,D),A()}function A(){return O=M=null,N}return N.stream=function(x){return O&&M===x?O:O=Lke(function jke(e){return $y({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}(c)(g(C(b(M=x)))))},N.preclip=function(x){return arguments.length?(g=x,p=void 0,A()):g},N.postclip=function(x){return arguments.length?(b=x,m=_=y=v=null,A()):b},N.clipAngle=function(x){return arguments.length?(g=+x?Nke(p=x*ct):(p=null,oQ),A()):p*Zn},N.clipExtent=function(x){return arguments.length?(b=null==x?(m=_=y=v=null,Iy):uQ(m=+x[0][0],_=+x[0][1],y=+x[1][0],v=+x[1][1]),A()):null==m?null:[[m,_],[y,v]]},N.scale=function(x){return arguments.length?(n=+x,P()):n},N.translate=function(x){return arguments.length?(i=+x[0],r=+x[1],P()):[i,r]},N.center=function(x){return arguments.length?(s=x[0]%360*ct,o=x[1]%360*ct,P()):[s*Zn,o*Zn]},N.rotate=function(x){return arguments.length?(a=x[0]%360*ct,l=x[1]%360*ct,u=x.length>2?x[2]%360*ct:0,P()):[a*Zn,l*Zn,u*Zn]},N.angle=function(x){return arguments.length?(f=x%360*ct,P()):f*Zn},N.reflectX=function(x){return arguments.length?(d=x?-1:1,P()):d<0},N.reflectY=function(x){return arguments.length?(h=x?-1:1,P()):h<0},N.precision=function(x){return arguments.length?(C=gQ(w,D=x*x),A()):Pr(D)},N.fitExtent=function(x,S){return JC(N,x,S)},N.fitSize=function(x,S){return SF(N,x,S)},N.fitWidth=function(x,S){return xF(N,x,S)},N.fitHeight=function(x,S){return AF(N,x,S)},function(){return t=e.apply(this,arguments),N.invert=t.invert&&R,P()}}function TF(e){var t=0,n=ut/3,i=_Q(e),r=i(t,n);return r.parallels=function(s){return arguments.length?i(t=s[0]*ct,n=s[1]*ct):[t*Zn,n*Zn]},r}function Vke(e,t){var n=Me(e),i=(n+Me(t))/2;if(Dt(i)<Fe)return function $ke(e){var t=Le(e);function n(i,r){return[i*t,Me(r)/t]}return n.invert=function(i,r){return[i/t,fs(r*t)]},n}(e);var r=1+n*(2*i-n),s=Pr(r)/i;function o(a,l){var u=Pr(r-2*i*Me(l))/i;return[u*Me(a*=i),s-u*Le(a)]}return o.invert=function(a,l){var u=s-l,c=No(a,Dt(u))*ko(u);return u*i<0&&(c-=ut*ko(a)*ko(u)),[c/i,fs((r-(a*a+u*u)*i*i)/(2*i))]},o}function XC(){return TF(Vke).scale(155.424).center([0,33.6442])}function yQ(){return XC().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function vQ(e){return function(t,n){var i=Le(t),r=Le(n),s=e(i*r);return s===1/0?[2,0]:[s*r*Me(t),s*Me(n)]}}function Vy(e){return function(t,n){var i=Pr(t*t+n*n),r=e(i),s=Me(r),o=Le(r);return[No(t*s,i*o),fs(i&&n*s/i)]}}var bQ=vQ(function(e){return Pr(2/(1+e))});bQ.invert=Vy(function(e){return 2*fs(e/2)});var wQ=vQ(function(e){return(e=PX(e))&&e/Me(e)});function QC(e,t){return[e,PC(lF((zn+t)/2))]}function DQ(e){var a,l,u,t=Cl(e),n=t.center,i=t.scale,r=t.translate,s=t.clipExtent,o=null;function c(){var f=ut*i(),d=t(function Ike(e){function t(n){return(n=e(n[0]*ct,n[1]*ct))[0]*=Zn,n[1]*=Zn,n}return e=cQ(e[0]*ct,e[1]*ct,e.length>2?e[2]*ct:0),t.invert=function(n){return(n=e.invert(n[0]*ct,n[1]*ct))[0]*=Zn,n[1]*=Zn,n},t}(t.rotate()).invert([0,0]));return s(null==o?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===QC?[[Math.max(d[0]-f,o),a],[Math.min(d[0]+f,l),u]]:[[o,Math.max(d[1]-f,a)],[l,Math.min(d[1]+f,u)]])}return t.scale=function(f){return arguments.length?(i(f),c()):i()},t.translate=function(f){return arguments.length?(r(f),c()):r()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(null==f?o=a=l=u=null:(o=+f[0][0],a=+f[0][1],l=+f[1][0],u=+f[1][1]),c()):null==o?null:[[o,a],[l,u]]},c()}function ZC(e){return lF((zn+e)/2)}function qke(e,t){var n=Le(e),i=e===t?Me(e):PC(n/Le(t))/PC(ZC(t)/ZC(e)),r=n*aF(ZC(e),i)/i;if(!i)return QC;function s(o,a){r>0?a<-zn+Fe&&(a=-zn+Fe):a>zn-Fe&&(a=zn-Fe);var l=r/aF(ZC(a),i);return[l*Me(i*o),r-l*Le(i*o)]}return s.invert=function(o,a){var l=r-a,u=ko(i)*Pr(o*o+l*l),c=No(o,Dt(l))*ko(l);return l*i<0&&(c-=ut*ko(o)*ko(l)),[c/i,2*Qg(aF(r/u,1/i))-zn]},s}function eE(e,t){return[e,t]}function Jke(e,t){var n=Le(e),i=e===t?Me(e):(n-Le(t))/(t-e),r=n/i+e;if(Dt(i)<Fe)return eE;function s(o,a){var l=r-a,u=i*o;return[l*Me(u),r-l*Le(u)]}return s.invert=function(o,a){var l=r-a,u=No(o,Dt(l))*ko(l);return l*i<0&&(u-=ut*ko(o)*ko(l)),[u/i,r-ko(i)*Pr(o*o+l*l)]},s}wQ.invert=Vy(function(e){return e}),QC.invert=function(e,t){return[e,2*Qg(FX(t))-zn]},eE.invert=eE;var Hy=1.340264,Uy=-.081106,zy=893e-6,Gy=.003796,tE=Pr(3)/2;function CQ(e,t){var n=fs(tE*Me(t)),i=n*n,r=i*i*i;return[e*Le(n)/(tE*(Hy+3*Uy*i+r*(7*zy+9*Gy*i))),n*(Hy+Uy*i+r*(zy+Gy*i))]}function EQ(e,t){var n=Le(t),i=Le(e)*n;return[n*Me(e)/i,Me(t)/i]}function SQ(e,t){var n=t*t,i=n*n;return[e*(.8707-.131979*n+i*(i*(.003971*n-.001529*i)-.013791)),t*(1.007226+n*(.015085+i*(.028874*n-.044475-.005916*i)))]}function xQ(e,t){return[Le(t)*Me(e),Me(t)]}function AQ(e,t){var n=Le(t),i=1+Le(e)*n;return[n*Me(e)/i,Me(t)/i]}function TQ(e,t){return[PC(lF((zn+t)/2)),-e]}CQ.invert=function(e,t){for(var o,n=t,i=n*n,r=i*i*i,s=0;s<12&&(r=(i=(n-=o=(n*(Hy+Uy*i+r*(zy+Gy*i))-t)/(Hy+3*Uy*i+r*(7*zy+9*Gy*i)))*n)*i*i,!(Dt(o)<IC));++s);return[tE*e*(Hy+3*Uy*i+r*(7*zy+9*Gy*i))/Le(n),fs(Me(n)/tE)]},EQ.invert=Vy(Qg),SQ.invert=function(e,t){var r,n=t,i=25;do{var s=n*n,o=s*s;n-=r=(n*(1.007226+s*(.015085+o*(.028874*s-.044475-.005916*o)))-t)/(1.007226+s*(.045255+o*(.259866*s-.311325-.005916*11*o)))}while(Dt(r)>Fe&&--i>0);return[e/(.8707+(s=n*n)*(s*(s*s*s*(.003971-.001529*s)-.013791)-.131979)),n]},xQ.invert=Vy(fs),AQ.invert=Vy(function(e){return 2*Qg(e)}),TQ.invert=function(e,t){return[-t,2*Qg(FX(e))-zn]};var oIe=Math.abs,OF=(Math,Math,Math,Math.cos),nE=(Math,Math,Math,Math,Math,Math,Math,Math,Math.sin),yf=(Math,Math.PI),MF=yf/2,MQ=(Math,iE(2));function NQ(e){return e>1?MF:e<-1?-MF:Math.asin(e)}function iE(e){return e>0?Math.sqrt(e):0}function lIe(e,t){var r,n=e*nE(t),i=30;do{t-=r=(t+nE(t)-n)/(1+OF(t))}while(oIe(r)>1e-6&&--i>0);return t/2}iE(yf);var cIe=function uIe(e,t,n){function i(r,s){return[e*r*OF(s=lIe(n,s)),t*nE(s)]}return i.invert=function(r,s){return s=NQ(s/t),[r/(e*OF(s)),NQ((2*s+nE(2*s))/n)]},i}(MQ/MF,MQ,yf);const dIe=eQ(),NF=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function hIe(e,t){return function n(){const i=t();return i.type=e,i.path=eQ().projection(i),i.copy=i.copy||function(){const r=n();return NF.forEach(s=>{i[s]&&r[s](i[s]())}),r.path.pointRadius(i.path.pointRadius()),r},i}}function kF(e,t){if(!e||"string"!=typeof e)throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(rE[e]=hIe(e,t),this):rE[e]||null}function kQ(e){return e&&e.path||dIe}const rE={albers:yQ,albersusa:function Uke(){var e,t,i,s,a,l,n=yQ(),r=XC().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o=XC().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(d,h){l=[d,h]}};function c(d){var h=d[0],p=d[1];return l=null,i.point(h,p),l||(s.point(h,p),l)||(a.point(h,p),l)}function f(){return e=t=null,c}return c.invert=function(d){var h=n.scale(),p=n.translate(),g=(d[0]-p[0])/h,m=(d[1]-p[1])/h;return(m>=.12&&m<.234&&g>=-.425&&g<-.214?r:m>=.166&&m<.234&&g>=-.214&&g<-.115?o:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=function Hke(e){var t=e.length;return{point:function(n,i){for(var r=-1;++r<t;)e[r].point(n,i)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}([n.stream(t=d),r.stream(d),o.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),r.precision(d),o.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),r.scale(.35*d),o.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),p=+d[0],g=+d[1];return i=n.translate(d).clipExtent([[p-.455*h,g-.238*h],[p+.455*h,g+.238*h]]).stream(u),s=r.translate([p-.307*h,g+.201*h]).clipExtent([[p-.425*h+Fe,g+.12*h+Fe],[p-.214*h-Fe,g+.234*h-Fe]]).stream(u),a=o.translate([p-.205*h,g+.212*h]).clipExtent([[p-.214*h+Fe,g+.166*h+Fe],[p-.115*h-Fe,g+.234*h-Fe]]).stream(u),f()},c.fitExtent=function(d,h){return JC(c,d,h)},c.fitSize=function(d,h){return SF(c,d,h)},c.fitWidth=function(d,h){return xF(c,d,h)},c.fitHeight=function(d,h){return AF(c,d,h)},c.scale(1070)},azimuthalequalarea:function zke(){return Cl(bQ).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function Gke(){return Cl(wQ).scale(79.4188).clipAngle(179.999)},conicconformal:function Yke(){return TF(qke).scale(109.5).parallels([30,30])},conicequalarea:XC,conicequidistant:function Xke(){return TF(Jke).scale(131.154).center([0,13.9389])},equalEarth:function Zke(){return Cl(CQ).scale(177.158)},equirectangular:function Kke(){return Cl(eE).scale(152.63)},gnomonic:function eIe(){return Cl(EQ).scale(144.049).clipAngle(60)},identity:function tIe(){var o,a,u,c,f,m,_,e=1,t=0,n=0,i=1,r=1,s=0,l=null,d=1,h=1,p=$y({point:function(b,D){var C=v([b,D]);this.stream.point(C[0],C[1])}}),g=Iy;function y(){return d=e*i,h=e*r,m=_=null,v}function v(b){var D=b[0]*d,C=b[1]*h;if(s){var w=C*o-D*a;D=D*o+C*a,C=w}return[D+t,C+n]}return v.invert=function(b){var D=b[0]-t,C=b[1]-n;if(s){var w=C*o+D*a;D=D*o-C*a,C=w}return[D/d,C/h]},v.stream=function(b){return m&&_===b?m:m=p(g(_=b))},v.postclip=function(b){return arguments.length?(g=b,l=u=c=f=null,y()):g},v.clipExtent=function(b){return arguments.length?(g=null==b?(l=u=c=f=null,Iy):uQ(l=+b[0][0],u=+b[0][1],c=+b[1][0],f=+b[1][1]),y()):null==l?null:[[l,u],[c,f]]},v.scale=function(b){return arguments.length?(e=+b,y()):e},v.translate=function(b){return arguments.length?(t=+b[0],n=+b[1],y()):[t,n]},v.angle=function(b){return arguments.length?(a=Me(s=b%360*ct),o=Le(s),y()):s*Zn},v.reflectX=function(b){return arguments.length?(i=b?-1:1,y()):i<0},v.reflectY=function(b){return arguments.length?(r=b?-1:1,y()):r<0},v.fitExtent=function(b,D){return JC(v,b,D)},v.fitSize=function(b,D){return SF(v,b,D)},v.fitWidth=function(b,D){return xF(v,b,D)},v.fitHeight=function(b,D){return AF(v,b,D)},v},mercator:function Wke(){return DQ(QC).scale(961/Fr)},mollweide:function fIe(){return Cl(cIe).scale(169.529)},naturalEarth1:function nIe(){return Cl(SQ).scale(175.295)},orthographic:function iIe(){return Cl(xQ).scale(249.5).clipAngle(90+Fe)},stereographic:function rIe(){return Cl(AQ).scale(250).clipAngle(142)},transversemercator:function sIe(){var e=DQ(TQ),t=e.center,n=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):[(i=t())[1],-i[0]]},e.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):[(i=n())[0],i[1],i[2]-90]},n([0,0,90]).scale(159.155)}};for(const e in rE)kF(e,rE[e]);function IQ(e,t,n){var i=Vs(e,t-Fe,n).concat(t);return function(r){return i.map(function(s){return[r,s]})}}function RQ(e,t,n){var i=Vs(e,t-Fe,n).concat(t);return function(r){return i.map(function(s){return[s,r]})}}function pIe(){}const Lu=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function PQ(){var e=1,t=1,n=a;function i(l,u){return u.map(c=>r(l,c))}function r(l,u){var c=[],f=[];return function s(l,u,c){var h,p,m,_,y,f=new Array,d=new Array;for(h=p=-1,Lu[(m=l[0]>=u)<<1].forEach(v);++h<e-1;)Lu[m|(m=l[h+1]>=u)<<1].forEach(v);for(Lu[m<<0].forEach(v);++p<t-1;){for(h=-1,Lu[(m=l[p*e+e]>=u)<<1|(_=l[p*e]>=u)<<2].forEach(v);++h<e-1;)y=_,Lu[m|(m=l[p*e+e+h+1]>=u)<<1|(_=l[p*e+h+1]>=u)<<2|y<<3].forEach(v);Lu[m|_<<3].forEach(v)}for(h=-1,Lu[(_=l[p*e]>=u)<<2].forEach(v);++h<e-1;)y=_,Lu[(_=l[p*e+h+1]>=u)<<2|y<<3].forEach(v);function v(b){var O,M,D=[b[0][0]+h,b[0][1]+p],C=[b[1][0]+h,b[1][1]+p],w=o(D),E=o(C);(O=d[w])?(M=f[E])?(delete d[O.end],delete f[M.start],O===M?(O.ring.push(C),c(O.ring)):f[O.start]=d[M.end]={start:O.start,end:M.end,ring:O.ring.concat(M.ring)}):(delete d[O.end],O.ring.push(C),d[O.end=E]=O):(O=f[E])?(M=d[w])?(delete f[O.start],delete d[M.end],O===M?(O.ring.push(C),c(O.ring)):f[M.start]=d[O.end]={start:M.start,end:O.end,ring:M.ring.concat(O.ring)}):(delete f[O.start],O.ring.unshift(D),f[O.start=w]=O):f[w]=d[E]={start:w,end:E,ring:[D,C]}}Lu[_<<3].forEach(v)}(l,u,d=>{n(d,l,u),function gIe(e){for(var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var g,h=0,p=c.length;h<p;++h)if(-1!==mIe((g=c[h])[0],d))return void g.push(d)}),{type:"MultiPolygon",value:u,coordinates:c}}function o(l){return 2*l[0]+l[1]*(e+1)*4}function a(l,u,c){l.forEach(f=>{var m,d=f[0],h=f[1],p=0|d,g=0|h,_=u[g*e+p];d>0&&d<e&&p===d&&(f[0]=d+(c-(m=u[g*e+p-1]))/(_-m)-.5),h>0&&h<t&&g===h&&(f[1]=h+(c-(m=u[(g-1)*e+p]))/(_-m)-.5)})}return i.contour=r,i.size=function(l){if(!arguments.length)return[e,t];var u=Math.floor(l[0]),c=Math.floor(l[1]);return u>=0&&c>=0||Q("invalid size"),e=u,t=c,i},i.smooth=function(l){return arguments.length?(n=l?a:pIe,i):n===a},i}function mIe(e,t){for(var r,n=-1,i=t.length;++n<i;)if(r=_Ie(e,t[n]))return r;return 0}function _Ie(e,t){for(var n=t[0],i=t[1],r=-1,s=0,o=e.length,a=o-1;s<o;a=s++){var l=e[s],u=l[0],c=l[1],f=e[a],d=f[0],h=f[1];if(yIe(l,f,t))return 0;c>i!=h>i&&n<(d-u)*(i-c)/(h-c)+u&&(r=-r)}return r}function yIe(e,t,n){var i;return function vIe(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}(e,t,n)&&function bIe(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}(e[i=+(e[0]===t[0])],n[i],t[i])}function LQ(e,t,n){return function(i){var r=cl(i),s=n?Math.min(r[0],0):r[0],o=r[1],a=o-s,l=t?jc(s,o,e):a/(e+1);return Vs(s+l,o,l)}}function IF(e){K.call(this,null,e)}function jQ(e,t,n,i,r){const s=e.x1||0,o=e.y1||0,a=t*n<0;function l(f){f.forEach(u)}function u(f){a&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-s)*t+i,f[1]=(f[1]-o)*n+r}return function(f){return f.coordinates.forEach(l),f}}function BQ(e,t,n){const i=e>=0?e:fk(t,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function RF(e){return Qe(e)?e:ur(+e)}function $Q(){var e=l=>l[0],t=l=>l[1],n=gg,i=[-1,-1],r=960,s=500,o=2;function a(l,u){const c=BQ(i[0],l,e)>>o,f=BQ(i[1],l,t)>>o,d=c?c+2:0,h=f?f+2:0,p=2*d+(r>>o),g=2*h+(s>>o),m=new Float32Array(p*g),_=new Float32Array(p*g);let y=m;l.forEach(b=>{const D=d+(+e(b)>>o),C=h+(+t(b)>>o);D>=0&&D<p&&C>=0&&C<g&&(m[D+C*p]+=+n(b))}),c>0&&f>0?(nm(p,g,m,_,c),im(p,g,_,m,f),nm(p,g,m,_,c),im(p,g,_,m,f),nm(p,g,m,_,c),im(p,g,_,m,f)):c>0?(nm(p,g,m,_,c),nm(p,g,_,m,c),nm(p,g,m,_,c),y=_):f>0&&(im(p,g,m,_,f),im(p,g,_,m,f),im(p,g,m,_,f),y=_);const v=u?Math.pow(2,-2*o):1/pX(y);for(let b=0,D=p*g;b<D;++b)y[b]*=v;return{values:y,scale:1<<o,width:p,height:g,x1:d,y1:h,x2:d+(r>>o),y2:h+(s>>o)}}return a.x=function(l){return arguments.length?(e=RF(l),a):e},a.y=function(l){return arguments.length?(t=RF(l),a):t},a.weight=function(l){return arguments.length?(n=RF(l),a):n},a.size=function(l){if(!arguments.length)return[r,s];var u=+l[0],c=+l[1];return u>=0&&c>=0||Q("invalid size"),r=u,s=c,a},a.cellSize=function(l){return arguments.length?((l=+l)>=1||Q("invalid cell size"),o=Math.floor(Math.log(l)/Math.LN2),a):1<<o},a.bandwidth=function(l){return arguments.length?(1===(l=ve(l)).length&&(l=[+l[0],+l[0]]),2!==l.length&&Q("invalid bandwidth"),i=l,a):i},a}function nm(e,t,n,i,r){const s=1+(r<<1);for(let o=0;o<t;++o)for(let a=0,l=0;a<e+r;++a)a<e&&(l+=n[a+o*e]),a>=r&&(a>=s&&(l-=n[a-s+o*e]),i[a-r+o*e]=l/Math.min(a+1,e-1+s-a,s))}function im(e,t,n,i,r){const s=1+(r<<1);for(let o=0;o<e;++o)for(let a=0,l=0;a<t+r;++a)a<t&&(l+=n[o+a*e]),a>=r&&(a>=s&&(l-=n[o+(a-s)*e]),i[o+(a-r)*e]=l/Math.min(a+1,t-1+s-a,s))}function FF(e){K.call(this,null,e)}IF.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},ce(IF,K,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=e.field||ar,s=PQ().smooth(!1!==e.smooth),o=e.thresholds||function wIe(e,t,n){const i=LQ(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?i:i(e.map(r=>jd(t(r).values)))}(i,r,e),a=null===e.as?null:e.as||"contour",l=[];return i.forEach(u=>{const c=r(u),f=s.size([c.width,c.height])(c.values,Z(o)?o:o(c.values));(function DIe(e,t,n,i){let r=i.scale||t.scale,s=i.translate||t.translate;if(Qe(r)&&(r=r(n,i)),Qe(s)&&(s=s(n,i)),(1===r||null==r)&&!s)return;const o=(Xt(r)?r:r[0])||1,a=(Xt(r)?r:r[1])||1;e.forEach(jQ(t,o,a,s&&s[0]||0,s&&s[1]||0))})(f,c,u,e),f.forEach(d=>{l.push(lD(u,jt(null!=a?{[a]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}}),FF.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const CIe=["x","y","weight","size","cellSize","bandwidth"];function VQ(e,t){return CIe.forEach(n=>null!=t[n]?e[n](t[n]):0),e}function PF(e){K.call(this,null,e)}ce(FF,K,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var l,n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=function EIe(e,t){var r,s,o,a,l,u,n=[],i=c=>c(a);if(null==t)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],(u=r[l=t.map(i)])||(r[l]=u=[],u.dims=l,n.push(u)),u.push(a);return n}(t.materialize(t.SOURCE).source,e.groupby),s=(e.groupby||[]).map(Un),o=VQ($Q(),e),a=e.as||"grid";return l=r.map(c=>jt(function u(c,f){for(let d=0;d<s.length;++d)c[s[d]]=f[d];return c}({[a]:o(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}}),PF.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},ce(PF,K,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var a,l,n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=PQ().smooth(!1!==e.smooth),r=e.values,s=e.thresholds||LQ(e.count||10,e.nice,!!r),o=e.size;return r||(r=t.materialize(t.SOURCE).source,l=jQ(a=VQ($Q(),e)(r,!0),a.scale||1,a.scale||1,0,0),o=[a.width,a.height],r=a.values),s=Z(s)?s:s(r),r=i.size(o)(r,s),l&&r.forEach(l),this.value&&(n.rem=this.value),this.value=n.source=n.add=(r||[]).map(jt),n}});const LF="Feature",jF="FeatureCollection";function BF(e){K.call(this,null,e)}function $F(e){K.call(this,null,e)}function VF(e){K.call(this,null,e)}function HF(e){K.call(this,null,e)}function UF(e){K.call(this,[],e),this.generator=function FQ(){var e,t,n,i,r,s,o,a,d,h,p,g,l=10,u=l,c=90,f=360,m=2.5;function _(){return{type:"MultiLineString",coordinates:y()}}function y(){return Vs(FC(i/c)*c,n,c).map(p).concat(Vs(FC(a/f)*f,o,f).map(g)).concat(Vs(FC(t/l)*l,e,l).filter(function(v){return Dt(v%c)>Fe}).map(d)).concat(Vs(FC(s/u)*u,r,u).filter(function(v){return Dt(v%f)>Fe}).map(h))}return _.lines=function(){return y().map(function(v){return{type:"LineString",coordinates:v}})},_.outline=function(){return{type:"Polygon",coordinates:[p(i).concat(g(o).slice(1),p(n).reverse().slice(1),g(a).reverse().slice(1))]}},_.extent=function(v){return arguments.length?_.extentMajor(v).extentMinor(v):_.extentMinor()},_.extentMajor=function(v){return arguments.length?(a=+v[0][1],o=+v[1][1],(i=+v[0][0])>(n=+v[1][0])&&(v=i,i=n,n=v),a>o&&(v=a,a=o,o=v),_.precision(m)):[[i,a],[n,o]]},_.extentMinor=function(v){return arguments.length?(s=+v[0][1],r=+v[1][1],(t=+v[0][0])>(e=+v[1][0])&&(v=t,t=e,e=v),s>r&&(v=s,s=r,r=v),_.precision(m)):[[t,s],[e,r]]},_.step=function(v){return arguments.length?_.stepMajor(v).stepMinor(v):_.stepMinor()},_.stepMajor=function(v){return arguments.length?(c=+v[0],f=+v[1],_):[c,f]},_.stepMinor=function(v){return arguments.length?(l=+v[0],u=+v[1],_):[l,u]},_.precision=function(v){return arguments.length?(m=+v,d=IQ(s,r,90),h=RQ(t,e,m),p=IQ(a,o,90),g=RQ(i,n,m),_):m},_.extentMajor([[-180,-90+Fe],[180,90-Fe]]).extentMinor([[-180,-80-Fe],[180,80+Fe]])}()}function zF(e){K.call(this,null,e)}function HQ(e){if(!Qe(e))return!1;const t=ua(or(e));return t.$x||t.$y||t.$value||t.$max}function UQ(e){K.call(this,null,e),this.modified(!0)}function zQ(e,t,n){Qe(e[t])&&e[t](n)}function GQ(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,f,d,h,p,g,m,_,y,s=e._root,o={data:i},a=e._x0,l=e._y0,u=e._x1,c=e._y1;if(!s)return e._root=o,e;for(;s.length;)if((g=t>=(f=(a+u)/2))?a=f:u=f,(m=n>=(d=(l+c)/2))?l=d:c=d,r=s,!(s=s[_=m<<1|g]))return r[_]=o,e;if(h=+e._x.call(null,s.data),p=+e._y.call(null,s.data),t===h&&n===p)return o.next=s,r?r[_]=o:e._root=o,e;do{r=r?r[_]=new Array(4):e._root=new Array(4),(g=t>=(f=(a+u)/2))?a=f:u=f,(m=n>=(d=(l+c)/2))?l=d:c=d}while((_=m<<1|g)==(y=(p>=d)<<1|h>=f));return r[y]=s,r[_]=o,e}function Lr(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function YIe(e){return e[0]}function JIe(e){return e[1]}function GF(e,t,n){var i=new WF(null==t?YIe:t,null==n?JIe:n,NaN,NaN,NaN,NaN);return null==e?i:i.addAll(e)}function WF(e,t,n,i,r,s){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=s,this._root=void 0}function WQ(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}BF.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},ce(BF,K,{transform(e,t){var u,n=this._features,i=this._points,r=e.fields,s=r&&r[0],o=r&&r[1],a=e.geojson||!r&&ar,l=t.ADD;u=e.modified()||t.changed(t.REM)||t.modified(or(a))||s&&t.modified(or(s))||o&&t.modified(or(o)),(!this.value||u)&&(l=t.SOURCE,this._features=n=[],this._points=i=[]),a&&t.visit(l,c=>n.push(a(c))),s&&o&&(t.visit(l,c=>{var f=s(c),d=o(c);null!=f&&null!=d&&(f=+f)===f&&(d=+d)===d&&i.push([f,d])}),n=n.concat({type:LF,geometry:{type:"MultiPoint",coordinates:i}})),this.value={type:jF,features:n}}}),$F.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},ce($F,K,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.field||ar,s=e.as||"path",o=n.SOURCE;!i||e.modified()?(this.value=i=kQ(e.projection),n.materialize().reflow()):o=r===ar||t.modified(r.fields)?n.ADD_MOD:n.ADD;const a=function xIe(e,t){const n=e.pointRadius();return e.context(null),null!=t&&e.pointRadius(t),n}(i,e.pointRadius);return n.visit(o,l=>l[s]=i(r(l))),i.pointRadius(a),n.modifies(s)}}),VF.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},ce(VF,K,{transform(e,t){var l,n=e.projection,i=e.fields[0],r=e.fields[1],s=e.as||["x","y"],o=s[0],a=s[1];function u(c){const f=n([i(c),r(c)]);f?(c[o]=f[0],c[a]=f[1]):(c[o]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,u):(l=t.modified(i.fields)||t.modified(r.fields),t.visit(l?t.ADD_MOD:t.ADD,u)),t.modifies(s)}}),HF.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},ce(HF,K,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.as||"shape",s=n.ADD;return(!i||e.modified())&&(this.value=i=function AIe(e,t,n){const i=null==n?r=>e(t(r)):r=>{var s=e.pointRadius(),o=e.pointRadius(n)(t(r));return e.pointRadius(s),o};return i.context=r=>(e.context(r),i),i}(kQ(e.projection),e.field||rs("datum"),e.pointRadius),n.materialize().reflow(),s=n.SOURCE),n.visit(s,o=>o[r]=i),n.modifies(r)}}),UF.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},ce(UF,K,{transform(e,t){var r,n=this.value,i=this.generator;if(!n.length||e.modified())for(const s in e)Qe(i[s])&&i[s](e[s]);return r=i(),n.length?t.mod.push(uW(n[0],r)):t.add.push(jt(r)),n[0]=r,t}}),zF.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},ce(zF,K,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,i="shared"===e.resolve,r=e.field||ar,s=function OIe(e,t){let n;return Qe(e)?(n=i=>e(i,t),n.dep=HQ(e)):e?n=ur(e):(n=i=>i.$value/i.$max||0,n.dep=!0),n}(e.opacity,e),o=function TIe(e,t){let n;return Qe(e)?(n=i=>Qc(e(i,t)),n.dep=HQ(e)):n=ur(Qc(e||"#888")),n}(e.color,e),a=e.as||"image",l={$x:0,$y:0,$value:0,$max:i?jd(n.map(u=>jd(r(u).values))):0};return n.forEach(u=>{const c=r(u),f=Ze({},u,l);i||(f.$max=jd(c.values||[])),u[a]=function MIe(e,t,n,i){const r=e.width,o=e.x1||0,a=e.y1||0,l=e.x2||r,u=e.y2||e.height,c=e.values,f=c?m=>c[m]:Ic,d=Jc(l-o,u-a),h=d.getContext("2d"),p=h.getImageData(0,0,l-o,u-a),g=p.data;for(let m=a,_=0;m<u;++m){t.$y=m-a;for(let y=o,v=m*r;y<l;++y,_+=4){t.$x=y-o,t.$value=f(y+v);const b=n(t);g[_+0]=b.r,g[_+1]=b.g,g[_+2]=b.b,g[_+3]=~~(255*i(t))}}return h.putImageData(p,0,0),d}(c,f,o.dep?o:ur(o(f)),s.dep?s:ur(s(f)))}),t.reflow(!0).modifies(a)}}),ce(UQ,K,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=function kIe(e){const t=kF((e||"mercator").toLowerCase());return t||Q("Unrecognized projection type: "+e),t()}(e.type),NF.forEach(i=>{null!=e[i]&&zQ(n,i,e[i])})):NF.forEach(i=>{e.modified(i)&&zQ(n,i,e[i])}),null!=e.pointRadius&&n.path.pointRadius(e.pointRadius),e.fit&&function NIe(e,t){const n=function IIe(e){return 1===(e=ve(e)).length?e[0]:{type:jF,features:e.reduce((t,n)=>t.concat(function RIe(e){return e.type===jF?e.features:ve(e).filter(t=>null!=t).map(t=>t.type===LF?t:{type:LF,geometry:t})}(n)),[])}}(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});var jr=GF.prototype=WF.prototype;function Br(e){return function(){return e}}function vf(e){return 1e-6*(e()-.5)}function QIe(e){return e.x+e.vx}function ZIe(e){return e.y+e.vy}jr.copy=function(){var n,i,e=new WF(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root;if(!t)return e;if(!t.length)return e._root=WQ(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(i=t.source[r])&&(i.length?n.push({source:i,target:t.target[r]=new Array(4)}):t.target[r]=WQ(i));return e},jr.add=function PIe(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return GQ(this.cover(t,n),t,n,e)},jr.addAll=function LIe(e){var t,n,r,s,i=e.length,o=new Array(i),a=new Array(i),l=1/0,u=1/0,c=-1/0,f=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(o[n]=r,a[n]=s,r<l&&(l=r),r>c&&(c=r),s<u&&(u=s),s>f&&(f=s));if(l>c||u>f)return this;for(this.cover(l,u).cover(c,f),n=0;n<i;++n)GQ(this,o[n],a[n],e[n]);return this},jr.cover=function jIe(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,s=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,s=(i=Math.floor(t))+1;else{for(var l,u,o=r-n||1,a=this._root;n>e||e>=r||i>t||t>=s;)switch(u=(t<i)<<1|e<n,l=new Array(4),l[u]=a,a=l,o*=2,u){case 0:r=n+o,s=i+o;break;case 1:n=r-o,s=i+o;break;case 2:r=n+o,i=s-o;break;case 3:n=r-o,i=s-o}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=i,this._x1=r,this._y1=s,this},jr.data=function BIe(){var e=[];return this.visit(function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)}),e},jr.extent=function $Ie(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},jr.find=function VIe(e,t,n){var i,o,a,l,u,p,g,r=this._x0,s=this._y0,c=this._x1,f=this._y1,d=[],h=this._root;for(h&&d.push(new Lr(h,r,s,c,f)),null==n?n=1/0:(r=e-n,s=t-n,c=e+n,f=t+n,n*=n);p=d.pop();)if(!(!(h=p.node)||(o=p.x0)>c||(a=p.y0)>f||(l=p.x1)<r||(u=p.y1)<s))if(h.length){var m=(o+l)/2,_=(a+u)/2;d.push(new Lr(h[3],m,_,l,u),new Lr(h[2],o,_,m,u),new Lr(h[1],m,a,l,_),new Lr(h[0],o,a,m,_)),(g=(t>=_)<<1|e>=m)&&(p=d[d.length-1],d[d.length-1]=d[d.length-1-g],d[d.length-1-g]=p)}else{var y=e-+this._x.call(null,h.data),v=t-+this._y.call(null,h.data),b=y*y+v*v;if(b<n){var D=Math.sqrt(n=b);r=e-D,s=t-D,c=e+D,f=t+D,i=h.data}}return i},jr.remove=function HIe(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,i,r,s,c,f,d,h,p,g,m,_,n=this._root,o=this._x0,a=this._y0,l=this._x1,u=this._y1;if(!n)return this;if(n.length)for(;;){if((p=c>=(d=(o+l)/2))?o=d:l=d,(g=f>=(h=(a+u)/2))?a=h:u=h,t=n,!(n=n[m=g<<1|p]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(i=t,_=m)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,r?(s?r.next=s:delete r.next,this):t?(s?t[m]=s:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(i?i[_]=n:this._root=n),this):(this._root=s,this)},jr.removeAll=function UIe(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},jr.root=function zIe(){return this._root},jr.size=function GIe(){var e=0;return this.visit(function(t){if(!t.length)do{++e}while(t=t.next)}),e},jr.visit=function WIe(e){var n,r,s,o,a,l,t=[],i=this._root;for(i&&t.push(new Lr(i,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(i=n.node,s=n.x0,o=n.y0,a=n.x1,l=n.y1)&&i.length){var u=(s+a)/2,c=(o+l)/2;(r=i[3])&&t.push(new Lr(r,u,c,a,l)),(r=i[2])&&t.push(new Lr(r,s,c,u,l)),(r=i[1])&&t.push(new Lr(r,u,o,a,c)),(r=i[0])&&t.push(new Lr(r,s,o,u,c))}return this},jr.visitAfter=function qIe(e){var i,t=[],n=[];for(this._root&&t.push(new Lr(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var r=i.node;if(r.length){var s,o=i.x0,a=i.y0,l=i.x1,u=i.y1,c=(o+l)/2,f=(a+u)/2;(s=r[0])&&t.push(new Lr(s,o,a,c,f)),(s=r[1])&&t.push(new Lr(s,c,a,l,f)),(s=r[2])&&t.push(new Lr(s,o,f,c,u)),(s=r[3])&&t.push(new Lr(s,c,f,l,u))}n.push(i)}for(;i=n.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this},jr.x=function KIe(e){return arguments.length?(this._x=e,this):this._x},jr.y=function XIe(e){return arguments.length?(this._y=e,this):this._y};var tRe={value:()=>{}};function qQ(){for(var i,e=0,t=arguments.length,n={};e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new sE(n)}function sE(e){this._=e}function nRe(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}function iRe(e,t){for(var r,n=0,i=e.length;n<i;++n)if((r=e[n]).name===t)return r.value}function YQ(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=tRe,e=e.slice(0,i).concat(e.slice(i+1));break}return null!=n&&e.push({name:t,value:n}),e}sE.prototype=qQ.prototype={constructor:sE,on:function(e,t){var r,n=this._,i=nRe(e+"",n),s=-1,o=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++s<o;)if(r=(e=i[s]).type)n[r]=YQ(n[r],e.name,t);else if(null==t)for(r in n)n[r]=YQ(n[r],e.name,null);return this}for(;++s<o;)if((r=(e=i[s]).type)&&(r=iRe(n[r],e.name)))return r},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new sE(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var r,s,n=new Array(r),i=0;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,r=(s=this._[e]).length;i<r;++i)s[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)}};const rRe=qQ;var oE,Ky,rm=0,qy=0,Yy=0,aE=0,nh=0,lE=0,Jy="object"==typeof performance&&performance.now?performance:Date,JQ="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function qF(){return nh||(JQ(sRe),nh=Jy.now()+lE)}function sRe(){nh=0}function uE(){this._call=this._time=this._next=null}function XQ(e,t,n){var i=new uE;return i.restart(e,t,n),i}function QQ(){nh=(aE=Jy.now())+lE,rm=qy=0;try{!function oRe(){qF(),++rm;for(var t,e=oE;e;)(t=nh-e._time)>=0&&e._call.call(void 0,t),e=e._next;--rm}()}finally{rm=0,function lRe(){for(var e,n,t=oE,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:oE=n);Ky=e,YF(i)}(),nh=0}}function aRe(){var e=Jy.now(),t=e-aE;t>1e3&&(lE-=t,aE=e)}function YF(e){rm||(qy&&(qy=clearTimeout(qy)),e-nh>24?(e<1/0&&(qy=setTimeout(QQ,e-Jy.now()-lE)),Yy&&(Yy=clearInterval(Yy))):(Yy||(aE=Jy.now(),Yy=setInterval(aRe,1e3)),rm=1,JQ(QQ)))}uE.prototype=XQ.prototype={constructor:uE,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?qF():+n)+(null==t?0:+t),!this._next&&Ky!==this&&(Ky?Ky._next=this:oE=this,Ky=this),this._call=e,this._time=n,YF()},stop:function(){this._call&&(this._call=null,this._time=1/0,YF())}};const ZQ=4294967296;function dRe(e){return e.x}function hRe(e){return e.y}var gRe=Math.PI*(3-Math.sqrt(5));function yRe(e){return e.index}function eZ(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}const tZ={center:function FIe(e,t){var n,i=1;function r(){var s,a,o=n.length,l=0,u=0;for(s=0;s<o;++s)l+=(a=n[s]).x,u+=a.y;for(l=(l/o-e)*i,u=(u/o-t)*i,s=0;s<o;++s)(a=n[s]).x-=l,a.y-=u}return null==e&&(e=0),null==t&&(t=0),r.initialize=function(s){n=s},r.x=function(s){return arguments.length?(e=+s,r):e},r.y=function(s){return arguments.length?(t=+s,r):t},r.strength=function(s){return arguments.length?(i=+s,r):i},r},collide:function eRe(e){var t,n,i,r=1,s=1;function o(){for(var u,f,d,h,p,g,m,c=t.length,_=0;_<s;++_)for(f=GF(t,QIe,ZIe).visitAfter(a),u=0;u<c;++u)m=(g=n[(d=t[u]).index])*g,h=d.x+d.vx,p=d.y+d.vy,f.visit(y);function y(v,b,D,C,w){var E=v.data,O=v.r,M=g+O;if(!E)return b>h+M||C<h-M||D>p+M||w<p-M;if(E.index>d.index){var N=h-E.x-E.vx,R=p-E.y-E.vy,P=N*N+R*R;P<M*M&&(0===N&&(P+=(N=vf(i))*N),0===R&&(P+=(R=vf(i))*R),P=(M-(P=Math.sqrt(P)))/P*r,d.vx+=(N*=P)*(M=(O*=O)/(m+O)),d.vy+=(R*=P)*M,E.vx-=N*(M=1-M),E.vy-=R*M)}}}function a(u){if(u.data)return u.r=n[u.data.index];for(var c=u.r=0;c<4;++c)u[c]&&u[c].r>u.r&&(u.r=u[c].r)}function l(){if(t){var u,f,c=t.length;for(n=new Array(c),u=0;u<c;++u)n[(f=t[u]).index]=+e(f,u,t)}}return"function"!=typeof e&&(e=Br(null==e?1:+e)),o.initialize=function(u,c){t=u,i=c,l()},o.iterations=function(u){return arguments.length?(s=+u,o):s},o.strength=function(u){return arguments.length?(r=+u,o):r},o.radius=function(u){return arguments.length?(e="function"==typeof u?u:Br(+u),l(),o):e},o},nbody:function _Re(){var e,t,n,i,s,r=Br(-30),o=1,a=1/0,l=.81;function u(h){var p,g=e.length,m=GF(e,dRe,hRe).visitAfter(f);for(i=h,p=0;p<g;++p)t=e[p],m.visit(d)}function c(){if(e){var h,g,p=e.length;for(s=new Array(p),h=0;h<p;++h)s[(g=e[h]).index]=+r(g,h,e)}}function f(h){var g,m,y,v,b,p=0,_=0;if(h.length){for(y=v=b=0;b<4;++b)(g=h[b])&&(m=Math.abs(g.value))&&(p+=g.value,_+=m,y+=m*g.x,v+=m*g.y);h.x=y/_,h.y=v/_}else{(g=h).x=g.data.x,g.y=g.data.y;do{p+=s[g.data.index]}while(g=g.next)}h.value=p}function d(h,p,g,m){if(!h.value)return!0;var _=h.x-t.x,y=h.y-t.y,v=m-p,b=_*_+y*y;if(v*v/l<b)return b<a&&(0===_&&(b+=(_=vf(n))*_),0===y&&(b+=(y=vf(n))*y),b<o&&(b=Math.sqrt(o*b)),t.vx+=_*h.value*i/b,t.vy+=y*h.value*i/b),!0;if(!(h.length||b>=a)){(h.data!==t||h.next)&&(0===_&&(b+=(_=vf(n))*_),0===y&&(b+=(y=vf(n))*y),b<o&&(b=Math.sqrt(o*b)));do{h.data!==t&&(t.vx+=_*(v=s[h.data.index]*i/b),t.vy+=y*v)}while(h=h.next)}}return u.initialize=function(h,p){e=h,n=p,c()},u.strength=function(h){return arguments.length?(r="function"==typeof h?h:Br(+h),c(),u):r},u.distanceMin=function(h){return arguments.length?(o=h*h,u):Math.sqrt(o)},u.distanceMax=function(h){return arguments.length?(a=h*h,u):Math.sqrt(a)},u.theta=function(h){return arguments.length?(l=h*h,u):Math.sqrt(l)},u},link:function vRe(e){var i,s,o,a,l,u,t=yRe,n=function f(m){return 1/Math.min(a[m.source.index],a[m.target.index])},r=Br(30),c=1;function d(m){for(var _=0,y=e.length;_<c;++_)for(var b,D,C,w,E,O,M,v=0;v<y;++v)w=(C=(b=e[v]).target).x+C.vx-(D=b.source).x-D.vx||vf(u),E=C.y+C.vy-D.y-D.vy||vf(u),E*=O=((O=Math.sqrt(w*w+E*E))-s[v])/O*m*i[v],C.vx-=(w*=O)*(M=l[v]),C.vy-=E*M,D.vx+=w*(M=1-M),D.vy+=E*M}function h(){if(o){var m,b,_=o.length,y=e.length,v=new Map(o.map((D,C)=>[t(D,C,o),D]));for(m=0,a=new Array(_);m<y;++m)(b=e[m]).index=m,"object"!=typeof b.source&&(b.source=eZ(v,b.source)),"object"!=typeof b.target&&(b.target=eZ(v,b.target)),a[b.source.index]=(a[b.source.index]||0)+1,a[b.target.index]=(a[b.target.index]||0)+1;for(m=0,l=new Array(y);m<y;++m)l[m]=a[(b=e[m]).source.index]/(a[b.source.index]+a[b.target.index]);i=new Array(y),p(),s=new Array(y),g()}}function p(){if(o)for(var m=0,_=e.length;m<_;++m)i[m]=+n(e[m],m,e)}function g(){if(o)for(var m=0,_=e.length;m<_;++m)s[m]=+r(e[m],m,e)}return null==e&&(e=[]),d.initialize=function(m,_){o=m,u=_,h()},d.links=function(m){return arguments.length?(e=m,h(),d):e},d.id=function(m){return arguments.length?(t=m,d):t},d.iterations=function(m){return arguments.length?(c=+m,d):c},d.strength=function(m){return arguments.length?(n="function"==typeof m?m:Br(+m),p(),d):n},d.distance=function(m){return arguments.length?(r="function"==typeof m?m:Br(+m),g(),d):r},d},x:function bRe(e){var n,i,r,t=Br(.1);function s(a){for(var c,l=0,u=n.length;l<u;++l)(c=n[l]).vx+=(r[l]-c.x)*i[l]*a}function o(){if(n){var a,l=n.length;for(i=new Array(l),r=new Array(l),a=0;a<l;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return"function"!=typeof e&&(e=Br(null==e?0:+e)),s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t="function"==typeof a?a:Br(+a),o(),s):t},s.x=function(a){return arguments.length?(e="function"==typeof a?a:Br(+a),o(),s):e},s},y:function wRe(e){var n,i,r,t=Br(.1);function s(a){for(var c,l=0,u=n.length;l<u;++l)(c=n[l]).vy+=(r[l]-c.y)*i[l]*a}function o(){if(n){var a,l=n.length;for(i=new Array(l),r=new Array(l),a=0;a<l;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return"function"!=typeof e&&(e=Br(null==e?0:+e)),s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t="function"==typeof a?a:Br(+a),o(),s):t},s.y=function(a){return arguments.length?(e="function"==typeof a?a:Br(+a),o(),s):e},s}},Xy="forces",KF=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],DRe=["static","iterations"],nZ=["x","y","vx","vy"];function JF(e){K.call(this,null,e)}function iZ(e,t,n,i){var s,o,a,l,r=ve(t.forces);for(s=0,o=KF.length;s<o;++s)(a=KF[s])!==Xy&&t.modified(a)&&e[a](t[a]);for(s=0,o=r.length;s<o;++s)l=Xy+s,(a=n||t.modified(Xy,s)?xRe(r[s]):i&&SRe(r[s],i)?e.force(l):null)&&e.force(l,a);for(o=e.numForces||0;s<o;++s)e.force(Xy+s,null);return e.numForces=r.length,e}function SRe(e,t){var n,i;for(n in e)if(Qe(i=e[n])&&t.modified(or(i)))return 1;return 0}function xRe(e){var t,n;for(n in Oe(tZ,e.force)||Q("Unrecognized force: "+e.force),t=tZ[e.force](),e)Qe(t[n])&&ARe(t[n],e[n],e);return t}function ARe(e,t,n){e(Qe(t)?i=>t(i,n):t)}function TRe(e){var t=0,n=e.children,i=n&&n.length;if(i)for(;--i>=0;)t+=n[i].value;else t=1;e.value=t}function XF(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=GRe)):void 0===t&&(t=zRe);for(var i,s,o,a,l,n=new sm(e),r=[n];i=r.pop();)if((o=t(i.data))&&(l=(o=Array.from(o)).length))for(i.children=o,a=l-1;a>=0;--a)r.push(s=o[a]=new sm(o[a])),s.parent=i,s.depth=i.depth+1;return n.eachBefore(rZ)}function zRe(e){return e.children}function GRe(e){return Array.isArray(e)?e[1]:null}function WRe(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function rZ(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function sm(e){this.data=e,this.depth=this.height=0,this.parent=null}function cE(e){return null==e?null:sZ(e)}function sZ(e){if("function"!=typeof e)throw new Error;return e}function ih(){return 0}function om(e){return function(){return e}}JF.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:nZ}]},ce(JF,K,{transform(e,t){var n=this.value,i=t.changed(t.ADD_REM),r=e.modified(KF),s=e.iterations||300;if(n?(i&&(t.modifies("index"),n.nodes(t.source)),(r||t.changed(t.MOD))&&iZ(n,e,0,t)):(this.value=n=function ERe(e,t){const n=function mRe(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),s=0,o=.6,a=new Map,l=XQ(f),u=rRe("tick","end"),c=function fRe(){let e=1;return()=>(e=(1664525*e+1013904223)%ZQ)/ZQ}();function f(){d(),u.call("tick",t),n<i&&(l.stop(),u.call("end",t))}function d(g){var m,y,_=e.length;void 0===g&&(g=1);for(var v=0;v<g;++v)for(n+=(s-n)*r,a.forEach(function(b){b(n)}),m=0;m<_;++m)null==(y=e[m]).fx?y.x+=y.vx*=o:(y.x=y.fx,y.vx=0),null==y.fy?y.y+=y.vy*=o:(y.y=y.fy,y.vy=0);return t}function h(){for(var _,g=0,m=e.length;g<m;++g){if((_=e[g]).index=g,null!=_.fx&&(_.x=_.fx),null!=_.fy&&(_.y=_.fy),isNaN(_.x)||isNaN(_.y)){var y=10*Math.sqrt(.5+g),v=g*gRe;_.x=y*Math.cos(v),_.y=y*Math.sin(v)}(isNaN(_.vx)||isNaN(_.vy))&&(_.vx=_.vy=0)}}function p(g){return g.initialize&&g.initialize(e,c),g}return null==e&&(e=[]),h(),t={tick:d,restart:function(){return l.restart(f),t},stop:function(){return l.stop(),t},nodes:function(g){return arguments.length?(e=g,h(),a.forEach(p),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(i=+g,t):i},alphaDecay:function(g){return arguments.length?(r=+g,t):+r},alphaTarget:function(g){return arguments.length?(s=+g,t):s},velocityDecay:function(g){return arguments.length?(o=1-g,t):1-o},randomSource:function(g){return arguments.length?(c=g,a.forEach(p),t):c},force:function(g,m){return arguments.length>1?(null==m?a.delete(g):a.set(g,p(m)),t):a.get(g)},find:function(g,m,_){var b,D,C,w,E,y=0,v=e.length;for(null==_?_=1/0:_*=_,y=0;y<v;++y)(C=(b=g-(w=e[y]).x)*b+(D=m-w.y)*D)<_&&(E=w,_=C);return E},on:function(g,m){return arguments.length>1?(u.on(g,m),t):u.on(g)}}}(e),i=n.stop,r=n.restart;let s=!1;return n.stopped=()=>s,n.restart=()=>(s=!1,r()),n.stop=()=>(s=!0,i()),iZ(n,t,!0).on("end",()=>s=!0)}(t.source,e),n.on("tick",function CRe(e,t){return()=>e.touch(t).run()}(t.dataflow,this)),e.static||(i=!0,n.tick()),t.modifies("index")),r||i||e.modified(DRe)||t.changed()&&e.restart)if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/s)),e.static)for(n.stop();--s>=0;)n.tick();else if(n.stopped()&&n.restart(),!i)return t.StopPropagation;return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let c,a=this._argops,l=0,u=a.length;l<u;++l)if(c=a[l],c.name===Xy&&"link"===c.op._argval.force)for(var o,i=c.op._argops,r=0,s=i.length;r<s;++r)if("links"===i[r].name&&(o=i[r].op.source)){n.pulse(o,n.changeset().reflow());break}return t.reflow(e.modified()).modifies(nZ)}}),sm.prototype=XF.prototype={constructor:sm,count:function ORe(){return this.eachAfter(TRe)},each:function MRe(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this},eachAfter:function kRe(e,t){for(var s,o,a,n=this,i=[n],r=[],l=-1;n=i.pop();)if(r.push(n),s=n.children)for(o=0,a=s.length;o<a;++o)i.push(s[o]);for(;n=r.pop();)e.call(t,n,++l,this);return this},eachBefore:function NRe(e,t){for(var r,s,n=this,i=[n],o=-1;n=i.pop();)if(e.call(t,n,++o,this),r=n.children)for(s=r.length-1;s>=0;--s)i.push(r[s]);return this},find:function IRe(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i},sum:function RRe(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n})},sort:function FRe(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})},path:function PRe(e){for(var t=this,n=function LRe(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}(t,e),i=[t];t!==n;)i.push(t=t.parent);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i},ancestors:function jRe(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function BRe(){return Array.from(this)},leaves:function $Re(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e},links:function VRe(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t},copy:function URe(){return XF(this).eachBefore(WRe)},[Symbol.iterator]:function*HRe(){var t,i,r,s,e=this,n=[e];do{for(t=n.reverse(),n=[];e=t.pop();)if(yield e,i=e.children)for(r=0,s=i.length;r<s;++r)n.push(i[r])}while(n.length)}};const oZ=4294967296;function QRe(e,t){var n,i;if(QF(t,e))return[t];for(n=0;n<e.length;++n)if(fE(t,e[n])&&QF(Qy(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(i=n+1;i<e.length;++i)if(fE(Qy(e[n],e[i]),t)&&fE(Qy(e[n],t),e[i])&&fE(Qy(e[i],t),e[n])&&QF(uZ(e[n],e[i],t),e))return[e[n],e[i],t];throw new Error}function fE(e,t){var n=e.r-t.r,i=t.x-e.x,r=t.y-e.y;return n<0||n*n<i*i+r*r}function lZ(e,t){var n=e.r-t.r+1e-9*Math.max(e.r,t.r,1),i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function QF(e,t){for(var n=0;n<t.length;++n)if(!lZ(e,t[n]))return!1;return!0}function ZRe(e){switch(e.length){case 1:return function eFe(e){return{x:e.x,y:e.y,r:e.r}}(e[0]);case 2:return Qy(e[0],e[1]);case 3:return uZ(e[0],e[1],e[2])}}function Qy(e,t){var n=e.x,i=e.y,r=e.r,s=t.x,o=t.y,a=t.r,l=s-n,u=o-i,c=a-r,f=Math.sqrt(l*l+u*u);return{x:(n+s+l/f*c)/2,y:(i+o+u/f*c)/2,r:(f+r+a)/2}}function uZ(e,t,n){var i=e.x,r=e.y,s=e.r,o=t.x,a=t.y,l=t.r,u=n.x,c=n.y,f=n.r,d=i-o,h=i-u,p=r-a,g=r-c,m=l-s,_=f-s,y=i*i+r*r-s*s,v=y-o*o-a*a+l*l,b=y-u*u-c*c+f*f,D=h*p-d*g,C=(p*b-g*v)/(2*D)-i,w=(g*m-p*_)/D,E=(h*v-d*b)/(2*D)-r,O=(d*_-h*m)/D,M=w*w+O*O-1,N=2*(s+C*w+E*O),R=C*C+E*E-s*s,P=-(Math.abs(M)>1e-6?(N+Math.sqrt(N*N-4*M*R))/(2*M):R/N);return{x:i+C+w*P,y:r+E+O*P,r:P}}function cZ(e,t,n){var r,s,a,l,i=e.x-t.x,o=e.y-t.y,u=i*i+o*o;u?(s=t.r+n.r,l=e.r+n.r,(s*=s)>(l*=l)?(r=(u+l-s)/(2*u),a=Math.sqrt(Math.max(0,l/u-r*r)),n.x=e.x-r*i-a*o,n.y=e.y-r*o+a*i):(r=(u+s-l)/(2*u),a=Math.sqrt(Math.max(0,s/u-r*r)),n.x=t.x+r*i-a*o,n.y=t.y+r*o+a*i)):(n.x=t.x+n.r,n.y=t.y)}function fZ(e,t){var n=e.r+t.r-1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function dZ(e){var t=e._,n=e.next._,i=t.r+n.r,r=(t.x*n.r+n.x*t.r)/i,s=(t.y*n.r+n.y*t.r)/i;return r*r+s*s}function dE(e){this._=e,this.next=null,this.previous=null}function hZ(e,t){if(!(s=(e=function JRe(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}(e)).length))return 0;var n,i,r,s,o,a,l,u,c,f,d;if((n=e[0]).x=0,n.y=0,!(s>1))return n.r;if(n.x=-(i=e[1]).r,i.x=n.r,i.y=0,!(s>2))return n.r+i.r;cZ(i,n,r=e[2]),n=new dE(n),i=new dE(i),r=new dE(r),n.next=r.previous=i,i.next=n.previous=r,r.next=i.previous=n;e:for(l=3;l<s;++l){cZ(n._,i._,r=e[l]),r=new dE(r),u=i.next,c=n.previous,f=i._.r,d=n._.r;do{if(f<=d){if(fZ(u._,r._)){n.next=i=u,i.previous=n,--l;continue e}f+=u._.r,u=u.next}else{if(fZ(c._,r._)){(n=c).next=i,i.previous=n,--l;continue e}d+=c._.r,c=c.previous}}while(u!==c.next);for(r.previous=n,r.next=i,n.next=i.previous=i=r,o=dZ(n);(r=r.next)!==i;)(a=dZ(r))<o&&(n=r,o=a);i=n.next}for(n=[i._],r=i;(r=r.next)!==i;)n.push(r._);for(r=function aZ(e,t){for(var s,o,n=0,i=(e=function XRe(e,t){let i,r,n=e.length;for(;n;)r=t()*n--|0,i=e[n],e[n]=e[r],e[r]=i;return e}(Array.from(e),t)).length,r=[];n<i;)s=e[n],o&&lZ(o,s)?++n:(o=ZRe(r=QRe(r,s)),n=0);return o}(n,t),l=0;l<s;++l)(n=e[l]).x-=r.x,n.y-=r.y;return r.r}function tFe(e){return Math.sqrt(e.value)}function pZ(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function ZF(e,t,n){return function(i){if(r=i.children){var r,s,l,o=r.length,a=e(i)*t||0;if(a)for(s=0;s<o;++s)r[s].r+=a;if(l=hZ(r,n),a)for(s=0;s<o;++s)r[s].r-=a;i.r=l+a}}}function gZ(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function mZ(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Zy(e,t,n,i,r){for(var o,s=e.children,a=-1,l=s.length,u=e.value&&(i-t)/e.value;++a<l;)(o=s[a]).y0=n,o.y1=r,o.x0=t,o.x1=t+=o.value*u}var rFe={depth:-1},_Z={},eP={};function sFe(e){return e.id}function oFe(e){return e.parentId}function yZ(){var n,e=sFe,t=oFe;function i(r){var l,u,c,f,d,h,p,g,s=Array.from(r),o=e,a=t,m=new Map;if(null!=n){const _=s.map((b,D)=>function aFe(e){let t=(e=`${e}`).length;return tP(e,t-1)&&!tP(e,t-2)&&(e=e.slice(0,-1)),"/"===e[0]?e:`/${e}`}(n(b,D,r))),y=_.map(vZ),v=new Set(_).add("");for(const b of y)v.has(b)||(v.add(b),_.push(b),y.push(vZ(b)),s.push(eP));o=(b,D)=>_[D],a=(b,D)=>y[D]}for(c=0,l=s.length;c<l;++c)h=s[c]=new sm(u=s[c]),null!=(p=o(u,c,r))&&(p+="")&&(g=h.id=p,m.set(g,m.has(g)?_Z:h)),null!=(p=a(u,c,r))&&(p+="")&&(h.parent=p);for(c=0;c<l;++c)if(p=(h=s[c]).parent){if(!(d=m.get(p)))throw new Error("missing: "+p);if(d===_Z)throw new Error("ambiguous: "+p);d.children?d.children.push(h):d.children=[h],h.parent=d}else{if(f)throw new Error("multiple roots");f=h}if(!f)throw new Error("no root");if(null!=n){for(;f.data===eP&&1===f.children.length;)f=f.children[0],--l;for(let _=s.length-1;_>=0&&(h=s[_]).data===eP;--_)h.data=null}if(f.parent=rFe,f.eachBefore(function(_){_.depth=_.parent.depth+1,--l}).eachBefore(rZ),f.parent=null,l>0)throw new Error("cycle");return f}return i.id=function(r){return arguments.length?(e=cE(r),i):e},i.parentId=function(r){return arguments.length?(t=cE(r),i):t},i.path=function(r){return arguments.length?(n=cE(r),i):n},i}function vZ(e){let t=e.length;if(t<2)return"";for(;--t>1&&!tP(e,t););return e.slice(0,t)}function tP(e,t){if("/"===e[t]){let n=0;for(;t>0&&"\\"===e[--t];)++n;if(0==(1&n))return!0}return!1}function lFe(e,t){return e.parent===t.parent?1:2}function nP(e){var t=e.children;return t?t[0]:e.t}function iP(e){var t=e.children;return t?t[t.length-1]:e.t}function uFe(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function fFe(e,t,n){return e.a.parent===t.parent?e.a:n}function hE(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function pFe(e,t){return e.parent===t.parent?1:2}function mFe(e,t){return e+t.x}function yFe(e,t){return Math.max(e,t.y)}function pE(e,t,n,i,r){for(var o,s=e.children,a=-1,l=s.length,u=e.value&&(r-n)/e.value;++a<l;)(o=s[a]).x0=t,o.x1=i,o.y0=n,o.y1=n+=o.value*u}hE.prototype=Object.create(sm.prototype);var bZ=(1+Math.sqrt(5))/2;function wZ(e,t,n,i,r,s){for(var l,u,h,p,m,_,y,v,b,D,C,o=[],a=t.children,c=0,f=0,d=a.length,g=t.value;c<d;){h=r-n,p=s-i;do{m=a[f++].value}while(!m&&f<d);for(_=y=m,C=m*m*(D=Math.max(p/h,h/p)/(g*e)),b=Math.max(y/C,C/_);f<d;++f){if(m+=u=a[f].value,u<_&&(_=u),u>y&&(y=u),C=m*m*D,(v=Math.max(y/C,C/_))>b){m-=u;break}b=v}o.push(l={value:m,dice:h<p,children:a.slice(c,f)}),l.dice?Zy(l,n,i,r,g?i+=p*m/g:s):pE(l,n,i,g?n+=h*m/g:r,s),g-=m,c=f}return o}const DZ=function e(t){function n(i,r,s,o,a){wZ(t,i,r,s,o,a)}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(bZ),EFe=function e(t){function n(i,r,s,o,a){if((l=i._squarify)&&l.ratio===t)for(var l,u,c,f,h,d=-1,p=l.length,g=i.value;++d<p;){for(c=(u=l[d]).children,f=u.value=0,h=c.length;f<h;++f)u.value+=c[f].value;u.dice?Zy(u,r,s,o,g?s+=(a-s)*u.value/g:a):pE(u,r,s,g?r+=(o-r)*u.value/g:o,a),g-=u.value}else i._squarify=l=wZ(t,i,r,s,o,a),l.ratio=t}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(bZ);function rP(e,t,n){const i={};return e.each(r=>{const s=r.data;n(s)&&(i[t(s)]=r)}),e.lookup=i,e}function sP(e){K.call(this,null,e)}sP.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const xFe=e=>e.values;function AFe(){const e=[],t={entries:r=>i(n(r,0),0),key:r=>(e.push(r),t)};function n(r,s){if(s>=e.length)return r;const o=r.length,a=e[s++],l={},u={};let f,d,h,c=-1;for(;++c<o;)f=a(d=r[c])+"",(h=l[f])?h.push(d):l[f]=[d];for(f in l)u[f]=n(l[f],s);return u}function i(r,s){if(++s>e.length)return r;const o=[];for(const a in r)o.push({key:a,values:i(r[a],s)});return o}return t}function ju(e){K.call(this,null,e)}ce(sP,K,{transform(e,t){t.source||Q("Nest transform requires an upstream data source.");var n=e.generate,i=e.modified(),r=t.clone(),s=this.value;return(!s||i||t.changed())&&(s&&s.each(o=>{o.children&&aD(o.data)&&r.rem.push(o.data)}),this.value=s=XF({values:ve(e.keys).reduce((o,a)=>(o.key(a),o),AFe()).entries(r.source)},xFe),n&&s.each(o=>{o.children&&(o=jt(o.data),r.add.push(o),r.source.push(o))}),rP(s,Ie,Ie)),r.source.root=s,r}});const TFe=(e,t)=>e.parent===t.parent?1:2;ce(ju,K,{transform(e,t){(!t.source||!t.source.root)&&Q(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),i=this.fields,r=t.source.root,s=e.as||i;e.field?r.sum(e.field):r.count(),e.sort&&r.sort(Pd(e.sort,o=>o.data)),function OFe(e,t,n){for(let i,r=0,s=t.length;r<s;++r)i=t[r],i in n&&e[i](n[i])}(n,this.params,e),n.separation&&n.separation(!1!==e.separation?TFe:gg);try{this.value=n(r)}catch(o){Q(o)}return r.each(o=>function MFe(e,t,n){const i=e.data,r=t.length-1;for(let s=0;s<r;++s)i[n[s]]=e[t[s]];i[n[r]]=e.children?e.children.length:0}(o,i,s)),t.reflow(e.modified()).modifies(s).modifies("leaf")}});const oP=["x","y","r","depth","children"];function aP(e){ju.call(this,e)}aP.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:oP.length,default:oP}]},ce(aP,ju,{layout:function nFe(){var e=null,t=1,n=1,i=ih;function r(s){const o=function KRe(){let e=1;return()=>(e=(1664525*e+1013904223)%oZ)/oZ}();return s.x=t/2,s.y=n/2,e?s.eachBefore(pZ(e)).eachAfter(ZF(i,.5,o)).eachBefore(gZ(1)):s.eachBefore(pZ(tFe)).eachAfter(ZF(ih,1,o)).eachAfter(ZF(i,s.r/Math.min(t,n),o)).eachBefore(gZ(Math.min(t,n)/(2*s.r))),s}return r.radius=function(s){return arguments.length?(e=cE(s),r):e},r.size=function(s){return arguments.length?(t=+s[0],n=+s[1],r):[t,n]},r.padding=function(s){return arguments.length?(i="function"==typeof s?s:om(+s),r):i},r},params:["radius","size","padding"],fields:oP});const lP=["x0","y0","x1","y1","depth","children"];function uP(e){ju.call(this,e)}function cP(e){K.call(this,null,e)}uP.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:lP.length,default:lP}]},ce(uP,ju,{layout:function iFe(){var e=1,t=1,n=0,i=!1;function r(o){var a=o.height+1;return o.x0=o.y0=n,o.x1=e,o.y1=t/a,o.eachBefore(function s(o,a){return function(l){l.children&&Zy(l,l.x0,o*(l.depth+1)/a,l.x1,o*(l.depth+2)/a);var u=l.x0,c=l.y0,f=l.x1-n,d=l.y1-n;f<u&&(u=f=(u+f)/2),d<c&&(c=d=(c+d)/2),l.x0=u,l.y0=c,l.x1=f,l.y1=d}}(t,a)),i&&o.eachBefore(mZ),o}return r.round=function(o){return arguments.length?(i=!!o,r):i},r.size=function(o){return arguments.length?(e=+o[0],t=+o[1],r):[e,t]},r.padding=function(o){return arguments.length?(n=+o,r):n},r},params:["size","round","padding"],fields:lP}),cP.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},ce(cP,K,{transform(e,t){t.source||Q("Stratify transform requires an upstream data source.");let n=this.value;const i=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),s=!n||i||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),s&&(n=r.source.length?rP(yZ().id(e.key).parentId(e.parentKey)(r.source),e.key,Co):rP(yZ()([{}]),e.key,e.key)),r.source.root=this.value=n,r}});const CZ={tidy:function hFe(){var e=lFe,t=1,n=1,i=null;function r(u){var c=function dFe(e){for(var n,r,s,o,a,t=new hE(e,0),i=[t];n=i.pop();)if(s=n._.children)for(n.children=new Array(a=s.length),o=a-1;o>=0;--o)i.push(r=n.children[o]=new hE(s[o],o)),r.parent=n;return(t.parent=new hE(null,0)).children=[t],t}(u);if(c.eachAfter(s),c.parent.m=-c.z,c.eachBefore(o),i)u.eachBefore(l);else{var f=u,d=u,h=u;u.eachBefore(function(y){y.x<f.x&&(f=y),y.x>d.x&&(d=y),y.depth>h.depth&&(h=y)});var p=f===d?1:e(f,d)/2,g=p-f.x,m=t/(d.x+p+g),_=n/(h.depth||1);u.eachBefore(function(y){y.x=(y.x+g)*m,y.y=y.depth*_})}return u}function s(u){var c=u.children,f=u.parent.children,d=u.i?f[u.i-1]:null;if(c){!function cFe(e){for(var s,t=0,n=0,i=e.children,r=i.length;--r>=0;)(s=i[r]).z+=t,s.m+=t,t+=s.s+(n+=s.c)}(u);var h=(c[0].z+c[c.length-1].z)/2;d?(u.z=d.z+e(u._,d._),u.m=u.z-h):u.z=h}else d&&(u.z=d.z+e(u._,d._));u.parent.A=function a(u,c,f){if(c){for(var b,d=u,h=u,p=c,g=d.parent.children[0],m=d.m,_=h.m,y=p.m,v=g.m;p=iP(p),d=nP(d),p&&d;)g=nP(g),(h=iP(h)).a=u,(b=p.z+y-d.z-m+e(p._,d._))>0&&(uFe(fFe(p,u,f),u,b),m+=b,_+=b),y+=p.m,m+=d.m,v+=g.m,_+=h.m;p&&!iP(h)&&(h.t=p,h.m+=y-_),d&&!nP(g)&&(g.t=d,g.m+=m-v,f=u)}return f}(u,d,u.parent.A||f[0])}function o(u){u._.x=u.z+u.parent.m,u.m+=u.parent.m}function l(u){u.x*=t,u.y=u.depth*n}return r.separation=function(u){return arguments.length?(e=u,r):e},r.size=function(u){return arguments.length?(i=!1,t=+u[0],n=+u[1],r):i?null:[t,n]},r.nodeSize=function(u){return arguments.length?(i=!0,t=+u[0],n=+u[1],r):i?[t,n]:null},r},cluster:function wFe(){var e=pFe,t=1,n=1,i=!1;function r(s){var o,a=0;s.eachAfter(function(d){var h=d.children;h?(d.x=function gFe(e){return e.reduce(mFe,0)/e.length}(h),d.y=function _Fe(e){return 1+e.reduce(yFe,0)}(h)):(d.x=o?a+=e(d,o):0,d.y=0,o=d)});var l=function vFe(e){for(var t;t=e.children;)e=t[0];return e}(s),u=function bFe(e){for(var t;t=e.children;)e=t[t.length-1];return e}(s),c=l.x-e(l,u)/2,f=u.x+e(u,l)/2;return s.eachAfter(i?function(d){d.x=(d.x-s.x)*t,d.y=(s.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(s.y?d.y/s.y:1))*n})}return r.separation=function(s){return arguments.length?(e=s,r):e},r.size=function(s){return arguments.length?(i=!1,t=+s[0],n=+s[1],r):i?null:[t,n]},r.nodeSize=function(s){return arguments.length?(i=!0,t=+s[0],n=+s[1],r):i?[t,n]:null},r}},fP=["x","y","depth","children"];function dP(e){ju.call(this,e)}function hP(e){K.call(this,[],e)}dP.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:fP.length,default:fP}]},ce(dP,ju,{layout(e){const t=e||"tidy";if(Oe(CZ,t))return CZ[t]();Q("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:fP}),hP.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},ce(hP,K,{transform(e,t){const n=this.value,i=t.source&&t.source.root,r=t.fork(t.NO_SOURCE),s={};return i||Q("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(r.rem=n,t.visit(t.SOURCE,o=>s[Ie(o)]=1),i.each(o=>{const a=o.data,l=o.parent&&o.parent.data;l&&s[Ie(a)]&&s[Ie(l)]&&r.add.push(jt({source:l,target:a}))}),this.value=r.add):t.changed(t.MOD)&&(t.visit(t.MOD,o=>s[Ie(o)]=1),n.forEach(o=>{(s[Ie(o.source)]||s[Ie(o.target)])&&r.mod.push(o)})),r}});const EZ={binary:function DFe(e,t,n,i,r){var o,l,s=e.children,a=s.length,u=new Array(a+1);for(u[0]=l=o=0;o<a;++o)u[o+1]=l+=s[o].value;!function c(f,d,h,p,g,m,_){if(f>=d-1){var y=s[f];return y.x0=p,y.y0=g,y.x1=m,void(y.y1=_)}for(var v=u[f],b=h/2+v,D=f+1,C=d-1;D<C;){var w=D+C>>>1;u[w]<b?D=w+1:C=w}b-u[D-1]<u[D]-b&&f+1<D&&--D;var E=u[D]-v,O=h-E;if(m-p>_-g){var M=h?(p*O+m*E)/h:m;c(f,D,E,p,g,M,_),c(D,d,O,M,g,m,_)}else{var N=h?(g*O+_*E)/h:_;c(f,D,E,p,g,m,N),c(D,d,O,p,N,m,_)}}(0,a,e.value,t,n,i,r)},dice:Zy,slice:pE,slicedice:function CFe(e,t,n,i,r){(1&e.depth?pE:Zy)(e,t,n,i,r)},squarify:DZ,resquarify:EFe},pP=["x0","y0","x1","y1","depth","children"];function gP(e){ju.call(this,e)}gP.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:pP.length,default:pP}]},ce(gP,ju,{layout(){const e=function SFe(){var e=DZ,t=!1,n=1,i=1,r=[0],s=ih,o=ih,a=ih,l=ih,u=ih;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=i,d.eachBefore(f),r=[0],t&&d.eachBefore(mZ),d}function f(d){var h=r[d.depth],p=d.x0+h,g=d.y0+h,m=d.x1-h,_=d.y1-h;m<p&&(p=m=(p+m)/2),_<g&&(g=_=(g+_)/2),d.x0=p,d.y0=g,d.x1=m,d.y1=_,d.children&&(h=r[d.depth+1]=s(d)/2,p+=u(d)-h,g+=o(d)-h,(m-=a(d)-h)<p&&(p=m=(p+m)/2),(_-=l(d)-h)<g&&(g=_=(g+_)/2),e(d,p,g,m,_))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],i=+d[1],c):[n,i]},c.tile=function(d){return arguments.length?(e=sZ(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(s="function"==typeof d?d:om(+d),c):s},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(o="function"==typeof d?d:om(+d),c):o},c.paddingRight=function(d){return arguments.length?(a="function"==typeof d?d:om(+d),c):a},c.paddingBottom=function(d){return arguments.length?(l="function"==typeof d?d:om(+d),c):l},c.paddingLeft=function(d){return arguments.length?(u="function"==typeof d?d:om(+d),c):u},c}();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{Oe(EZ,t)?e.tile(EZ[t]):Q("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:pP});const mP=4278190080;function _P(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function gE(e,t,n){if(!t.length)return;const i=t[0].mark.marktype;"group"===i?t.forEach(r=>{r.items.forEach(s=>gE(e,s.items,n))}):Hs[i].draw(e,{items:n?t.map(IFe):t})}function IFe(e){const t=lD(e,{});return t.stroke&&0!==t.strokeOpacity||t.fill&&0!==t.fillOpacity?tce(ece({},t),{strokeOpacity:1,stroke:"#000",fillOpacity:0}):t}const bf=new Uint32Array(33),wa=new Uint32Array(33);wa[0]=0,bf[0]=~wa[0];for(let e=1;e<=32;++e)wa[e]=wa[e-1]<<1|1,bf[e]=~wa[e];function mE(e,t,n,i,r,s){let o=n/2;return e-o<0||e+o>r||t-(o=i/2)<0||t+o>s}function wf(e,t,n,i,r,s,o,a){const l=r*s/(2*i),u=e(t-l),c=e(t+l),f=e(n-(s/=2)),d=e(n+s);return o.outOfBounds(u,f,c,d)||o.getRange(u,f,c,d)||a&&a.getRange(u,f,c,d)}const jFe=[-1,-1,1,1],BFe=[-1,1,-1,1],VFe=["right","center","left"],HFe=["bottom","middle","top"];function SZ(e,t,n,i,r,s,o,a,l,u,c,f){return!(r.outOfBounds(e,n,t,i)||(f&&s||r).getRange(e,n,t,i))}const zFe={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},GFe={naive:function PFe(e,t,n,i){const r=e.width,s=e.height;return function(o){const a=o.datum.datum.items[i].items,l=a.length,u=o.datum.fontSize,c=ma.width(o.datum,o.datum.text);let d,h,p,g,m,_,y,f=0;for(let v=0;v<l;++v)d=a[v].x,p=a[v].y,h=void 0===a[v].x2?d:a[v].x2,g=void 0===a[v].y2?p:a[v].y2,m=(d+h)/2,_=(p+g)/2,y=Math.abs(h-d+g-p),y>=f&&(f=y,o.x=m,o.y=_);return m=c/2,_=u/2,d=o.x-m,h=o.x+m,p=o.y-_,g=o.y+_,o.align="center",d<0&&h<=r?o.align="left":0<=d&&r<h&&(o.align="right"),o.baseline="middle",p<0&&g<=s?o.baseline="top":0<=p&&s<g&&(o.baseline="bottom"),!0}},"reduced-search":function LFe(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1];function l(u,c,f,d,h){const p=e.invert(u),g=e.invert(c);let y,m=f,_=s;if(!mE(p,g,d,h,r,s)&&!wf(e,p,g,h,d,m,o,a)&&!wf(e,p,g,h,d,h,o,null)){for(;_-m>=1;)y=(m+_)/2,wf(e,p,g,h,d,y,o,a)?_=y:m=y;if(m>f)return[p,g,m,!0]}}return function(u){const c=u.datum.datum.items[i].items,f=c.length,d=u.datum.fontSize,h=ma.width(u.datum,u.datum.text);let y,v,b,D,C,w,E,O,M,N,R,P,A,x,S,k,T,p=n?d:0,g=!1,m=!1,_=0;for(let F=0;F<f;++F){for(y=c[F].x,b=c[F].y,v=void 0===c[F].x2?y:c[F].x2,D=void 0===c[F].y2?b:c[F].y2,y>v&&(T=y,y=v,v=T),b>D&&(T=b,b=D,D=T),M=e(y),R=e(v),N=~~((M+R)/2),P=e(b),x=e(D),A=~~((P+x)/2),E=N;E>=M;--E)for(O=A;O>=P;--O)k=l(E,O,p,h,d),k&&([u.x,u.y,p,g]=k);for(E=N;E<=R;++E)for(O=A;O<=x;++O)k=l(E,O,p,h,d),k&&([u.x,u.y,p,g]=k);!g&&!n&&(S=Math.abs(v-y+D-b),C=(y+v)/2,w=(b+D)/2,S>=_&&!mE(C,w,h,d,r,s)&&!wf(e,C,w,d,h,d,o,null)&&(_=S,u.x=C,u.y=w,m=!0))}return!(!g&&!m||(C=h/2,w=d/2,o.setRange(e(u.x-C),e(u.y-w),e(u.x+C),e(u.y+w)),u.align="center",u.baseline="middle",0))}},floodfill:function $Fe(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1],l=e.bitmap();return function(u){const c=u.datum.datum.items[i].items,f=c.length,d=u.datum.fontSize,h=ma.width(u.datum,u.datum.text),p=[];let v,b,D,C,w,E,O,M,N,R,P,A,g=n?d:0,m=!1,_=!1,y=0;for(let x=0;x<f;++x){for(v=c[x].x,D=c[x].y,b=void 0===c[x].x2?v:c[x].x2,C=void 0===c[x].y2?D:c[x].y2,p.push([e((v+b)/2),e((D+C)/2)]);p.length;)if([O,M]=p.pop(),!(o.get(O,M)||a.get(O,M)||l.get(O,M))){l.set(O,M);for(let S=0;S<4;++S)w=O+jFe[S],E=M+BFe[S],l.outOfBounds(w,E,w,E)||p.push([w,E]);if(w=e.invert(O),E=e.invert(M),N=g,R=s,!mE(w,E,h,d,r,s)&&!wf(e,w,E,d,h,N,o,a)&&!wf(e,w,E,d,h,d,o,null)){for(;R-N>=1;)P=(N+R)/2,wf(e,w,E,d,h,P,o,a)?R=P:N=P;N>g&&(u.x=w,u.y=E,g=N,m=!0)}}!m&&!n&&(A=Math.abs(b-v+C-D),w=(v+b)/2,E=(D+C)/2,A>=y&&!mE(w,E,h,d,r,s)&&!wf(e,w,E,d,h,d,o,null)&&(y=A,u.x=w,u.y=E,_=!0))}return!(!m&&!_||(w=h/2,E=d/2,o.setRange(e(u.x-w),e(u.y-E),e(u.x+w),e(u.y+E)),u.align="center",u.baseline="middle",0))}}};function WFe(e,t,n,i,r,s,o,a,l,u,c){if(!e.length)return e;const f=Math.max(i.length,r.length),d=function qFe(e,t){const n=new Float64Array(t),i=e.length;for(let r=0;r<i;++r)n[r]=e[r]||0;for(let r=i;r<t;++r)n[r]=n[i-1];return n}(i,f),h=function YFe(e,t){const n=new Int8Array(t),i=e.length;for(let r=0;r<i;++r)n[r]|=zFe[e[r]];for(let r=i;r<t;++r)n[r]=n[i-1];return n}(r,f),p=function KFe(e){return e&&e.mark&&e.mark.marktype}(e[0].datum),g="group"===p&&e[0].datum.items[l].marktype,m="area"===g,_=function JFe(e,t,n,i){const r=s=>[s.x,s.x,s.x,s.y,s.y,s.y];return e?"line"===e||"area"===e?s=>r(s.datum):"line"===t?s=>{const o=s.datum.items[i].items;return r(o.length?o["start"===n?0:o.length-1]:{x:NaN,y:NaN})}:s=>{const o=s.datum.bounds;return[o.x1,(o.x1+o.x2)/2,o.x2,o.y1,(o.y1+o.y2)/2,o.y2]}:r}(p,g,a,l),y=null===u||u===1/0,v=m&&"naive"===c;let b=-1,D=-1;const C=e.map(M=>{const N=y?ma.width(M,M.text):void 0;return b=Math.max(b,N),D=Math.max(D,M.fontSize),{datum:M,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:_(M),textWidth:N}});u=null===u||u===1/0?Math.max(b,D)+Math.max(...i):u;const w=function FFe(e,t,n){const i=Math.max(1,Math.sqrt(e*t/1e6)),r=~~((e+2*n+i)/i),s=~~((t+2*n+i)/i),o=a=>~~((a+n)/i);return o.invert=a=>a*i-n,o.bitmap=()=>function RFe(e,t){const n=new Uint32Array(~~((e*t+32)/32));function i(s,o){n[s]|=o}function r(s,o){n[s]&=o}return{array:n,get:(s,o)=>{const a=o*e+s;return n[a>>>5]&1<<(31&a)},set:(s,o)=>{const a=o*e+s;i(a>>>5,1<<(31&a))},clear:(s,o)=>{const a=o*e+s;r(a>>>5,~(1<<(31&a)))},getRange:(s,o,a,l)=>{let c,f,d,h,u=l;for(;u>=o;--u)if(c=u*e+s,f=u*e+a,d=c>>>5,h=f>>>5,d===h){if(n[d]&bf[31&c]&wa[1+(31&f)])return!0}else{if(n[d]&bf[31&c]||n[h]&wa[1+(31&f)])return!0;for(let p=d+1;p<h;++p)if(n[p])return!0}return!1},setRange:(s,o,a,l)=>{let u,c,f,d,h;for(;o<=l;++o)if(u=o*e+s,c=o*e+a,f=u>>>5,d=c>>>5,f===d)i(f,bf[31&u]&wa[1+(31&c)]);else for(i(f,bf[31&u]),i(d,wa[1+(31&c)]),h=f+1;h<d;++h)i(h,4294967295)},clearRange:(s,o,a,l)=>{let u,c,f,d,h;for(;o<=l;++o)if(u=o*e+s,c=o*e+a,f=u>>>5,d=c>>>5,f===d)r(f,wa[31&u]|bf[1+(31&c)]);else for(r(f,wa[31&u]),r(d,bf[1+(31&c)]),h=f+1;h<d;++h)r(h,0)},outOfBounds:(s,o,a,l)=>s<0||o<0||l>=t||a>=e}}(r,s),o.ratio=i,o.padding=n,o.width=e,o.height=t,o}(t[0],t[1],u);let E;if(!v){n&&C.sort((R,P)=>n(R.datum,P.datum));let M=!1;for(let R=0;R<h.length&&!M;++R)M=5===h[R]||d[R]<0;const N=(p&&o||m)&&e.map(R=>R.datum);E=s.length||N?function kFe(e,t,n,i,r){const s=e.width,o=e.height,a=i||r,l=Jc(s,o).getContext("2d"),u=Jc(s,o).getContext("2d"),c=a&&Jc(s,o).getContext("2d");n.forEach(E=>gE(l,E,!1)),gE(u,t,!1),a&&gE(c,t,!0);const f=_P(l,s,o),d=_P(u,s,o),h=a&&_P(c,s,o),p=e.bitmap(),g=a&&e.bitmap();let m,_,y,v,b,D,C,w;for(_=0;_<o;++_)for(m=0;m<s;++m)b=_*s+m,D=f[b]&mP,w=d[b]&mP,C=a&&h[b]&mP,(D||C||w)&&(y=e(m),v=e(_),!r&&(D||w)&&p.set(y,v),a&&(D||C)&&g.set(y,v));return[p,g]}(w,N||[],s,M,m):function NFe(e,t){const n=e.bitmap();return(t||[]).forEach(i=>n.set(e(i.boundary[0]),e(i.boundary[3]))),[n,void 0]}(w,o&&C)}const O=m?GFe[c](w,E,o,l):function UFe(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1],l=i.length;return function(u){var c;const f=u.boundary,d=u.datum.fontSize;if(f[2]<0||f[5]<0||f[0]>r||f[3]>s)return!1;let p,g,m,_,y,v,b,D,C,w,E,O,M,N,R,h=null!==(c=u.textWidth)&&void 0!==c?c:0;for(let P=0;P<l;++P){if(p=(3&n[P])-1,g=(n[P]>>>2&3)-1,m=0===p&&0===g||i[P]<0,_=p&&g?Math.SQRT1_2:1,y=i[P]<0?-1:1,v=f[1+p]+i[P]*p*_,E=f[4+g]+y*d*g/2+i[P]*g*_,D=E-d/2,C=E+d/2,O=e(v),N=e(D),R=e(C),!h){if(!SZ(O,O,N,R,o,a,0,0,0,0,0,m))continue;h=ma.width(u.datum,u.datum.text)}if(w=v+y*h*p/2,v=w-h/2,b=w+h/2,O=e(v),M=e(b),SZ(O,M,N,R,o,a,0,0,0,0,0,m))return u.x=p?p*y<0?b:v:w,u.y=g?g*y<0?C:D:E,u.align=VFe[p*y+1],u.baseline=HFe[g*y+1],o.setRange(O,N,M,R),!0}return!1}}(w,E,h,d);return C.forEach(M=>M.opacity=+O(M)),C}const EP=["x","y","opacity","align","baseline"],xZ=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function SP(e){K.call(this,null,e)}function AZ(e,t){var r,s,o,a,l,u,n=[],i=function(c){return c(a)};if(null==t)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],(u=r[l=t.map(i)])||(r[l]=u=[],u.dims=l,n.push(u)),u.push(a);return n}function xP(e){K.call(this,null,e)}SP.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:xZ},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:EP.length,default:EP}]},ce(SP,K,{transform(e,t){const i=e.modified();if(!(i||t.changed(t.ADD_REM)||function n(s){const o=e[s];return Qe(o)&&t.modified(o.fields)}("sort")))return;(!e.size||2!==e.size.length)&&Q("Size parameter should be specified as a [width, height] array.");const r=e.as||EP;return WFe(t.materialize(t.SOURCE).source||[],e.size,e.sort,ve(null==e.offset?1:e.offset),ve(e.anchor||xZ),e.avoidMarks||[],!1!==e.avoidBaseMark,e.lineAnchor||"end",e.markIndex||0,void 0===e.padding?0:e.padding,e.method||"naive").forEach(s=>{const o=s.datum;o[r[0]]=s.x,o[r[1]]=s.y,o[r[2]]=s.opacity,o[r[3]]=s.align,o[r[4]]=s.baseline}),t.reflow(i).modifies(r)}}),xP.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},ce(xP,K,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=AZ(t.materialize(t.SOURCE).source,e.groupby),s=(e.groupby||[]).map(Un),o=s.length,a=e.as||[Un(e.x),Un(e.y)],l=[];r.forEach(u=>{$W(u,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<o;++d)f[s[d]]=u.dims[d];f[a[0]]=c[0],f[a[1]]=c[1],l.push(jt(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});const AP={linear:Ck,log:RW,exp:FW,pow:PW,quad:Ek,poly:LW};function TP(e){K.call(this,null,e)}TP.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(AP)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},ce(TP,K,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=AZ(t.materialize(t.SOURCE).source,e.groupby),s=(e.groupby||[]).map(Un),o=e.method||"linear",a=e.order||3,l=((e,t)=>"poly"===e?t:"quad"===e?2:1)(o,a),u=e.as||[Un(e.x),Un(e.y)],c=AP[o],f=[];let d=e.extent;Oe(AP,o)||Q("Invalid regression method: "+o),null!=d&&"log"===o&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),r.forEach(h=>{if(h.length<=l)return void t.dataflow.warn("Skipping regression with more parameters than data points.");const g=c(h,e.x,e.y,a);if(e.params)return void f.push(jt({keys:h.dims,coef:g.coef,rSquared:g.rSquared}));const m=d||cl(h,e.x),_=y=>{const v={};for(let b=0;b<s.length;++b)v[s[b]]=h.dims[b];v[u[0]]=y[0],v[u[1]]=y[1],f.push(jt(v))};"linear"===o?m.forEach(y=>_([y,g.predict(y)])):vD(g.predict,m,25,200).forEach(_)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});const wi=134217729;function tv(e,t,n,i,r){let s,o,a,l,u=t[0],c=i[0],f=0,d=0;c>u==c>-u?(s=u,u=t[++f]):(s=c,c=i[++d]);let h=0;if(f<e&&d<n)for(c>u==c>-u?(o=u+s,a=s-(o-u),u=t[++f]):(o=c+s,a=s-(o-c),c=i[++d]),s=o,0!==a&&(r[h++]=a);f<e&&d<n;)c>u==c>-u?(o=s+u,l=o-s,a=s-(o-l)+(u-l),u=t[++f]):(o=s+c,l=o-s,a=s-(o-l)+(c-l),c=i[++d]),s=o,0!==a&&(r[h++]=a);for(;f<e;)o=s+u,l=o-s,a=s-(o-l)+(u-l),u=t[++f],s=o,0!==a&&(r[h++]=a);for(;d<n;)o=s+c,l=o-s,a=s-(o-l)+(c-l),c=i[++d],s=o,0!==a&&(r[h++]=a);return(0!==s||0===h)&&(r[h++]=s),h}function oe(e){return new Float64Array(e)}const am=oe(4),TZ=oe(8),OZ=oe(12),MZ=oe(16),Vr=oe(4);function _E(e,t,n,i,r,s){const o=(t-s)*(n-r),a=(e-r)*(i-s),l=o-a;if(0===o||0===a||o>0!=a>0)return l;const u=Math.abs(o+a);return Math.abs(l)>=33306690738754716e-32*u?l:-function iPe(e,t,n,i,r,s,o){let a,l,u,c,f,d,h,p,g,m,_,y,v,b,D,C,w,E;const O=e-r,M=n-r,N=t-s,R=i-s;b=O*R,d=wi*O,h=d-(d-O),p=O-h,d=wi*R,g=d-(d-R),m=R-g,D=p*m-(b-h*g-p*g-h*m),C=N*M,d=wi*N,h=d-(d-N),p=N-h,d=wi*M,g=d-(d-M),m=M-g,w=p*m-(C-h*g-p*g-h*m),_=D-w,f=D-_,am[0]=D-(_+f)+(f-w),y=b+_,f=y-b,v=b-(y-f)+(_-f),_=v-C,f=v-_,am[1]=v-(_+f)+(f-C),E=y+_,f=E-y,am[2]=y-(E-f)+(_-f),am[3]=E;let P=function ZFe(e,t){let n=t[0];for(let i=1;i<e;i++)n+=t[i];return n}(4,am),A=22204460492503146e-32*o;if(P>=A||-P>=A||(f=e-O,a=e-(O+f)+(f-r),f=n-M,u=n-(M+f)+(f-r),f=t-N,l=t-(N+f)+(f-s),f=i-R,c=i-(R+f)+(f-s),0===a&&0===l&&0===u&&0===c)||(A=11093356479670487e-47*o+33306690738754706e-32*Math.abs(P),P+=O*c+R*a-(N*u+M*l),P>=A||-P>=A))return P;b=a*R,d=wi*a,h=d-(d-a),p=a-h,d=wi*R,g=d-(d-R),m=R-g,D=p*m-(b-h*g-p*g-h*m),C=l*M,d=wi*l,h=d-(d-l),p=l-h,d=wi*M,g=d-(d-M),m=M-g,w=p*m-(C-h*g-p*g-h*m),_=D-w,f=D-_,Vr[0]=D-(_+f)+(f-w),y=b+_,f=y-b,v=b-(y-f)+(_-f),_=v-C,f=v-_,Vr[1]=v-(_+f)+(f-C),E=y+_,f=E-y,Vr[2]=y-(E-f)+(_-f),Vr[3]=E;const x=tv(4,am,4,Vr,TZ);b=O*c,d=wi*O,h=d-(d-O),p=O-h,d=wi*c,g=d-(d-c),m=c-g,D=p*m-(b-h*g-p*g-h*m),C=N*u,d=wi*N,h=d-(d-N),p=N-h,d=wi*u,g=d-(d-u),m=u-g,w=p*m-(C-h*g-p*g-h*m),_=D-w,f=D-_,Vr[0]=D-(_+f)+(f-w),y=b+_,f=y-b,v=b-(y-f)+(_-f),_=v-C,f=v-_,Vr[1]=v-(_+f)+(f-C),E=y+_,f=E-y,Vr[2]=y-(E-f)+(_-f),Vr[3]=E;const S=tv(x,TZ,4,Vr,OZ);b=a*c,d=wi*a,h=d-(d-a),p=a-h,d=wi*c,g=d-(d-c),m=c-g,D=p*m-(b-h*g-p*g-h*m),C=l*u,d=wi*l,h=d-(d-l),p=l-h,d=wi*u,g=d-(d-u),m=u-g,w=p*m-(C-h*g-p*g-h*m),_=D-w,f=D-_,Vr[0]=D-(_+f)+(f-w),y=b+_,f=y-b,v=b-(y-f)+(_-f),_=v-C,f=v-_,Vr[1]=v-(_+f)+(f-C),E=y+_,f=E-y,Vr[2]=y-(E-f)+(_-f),Vr[3]=E;const k=tv(S,OZ,4,Vr,MZ);return MZ[k-1]}(e,t,n,i,r,s,u)}oe(4),oe(4),oe(4),oe(4),oe(4),oe(4),oe(4),oe(4),oe(4),oe(8),oe(8),oe(8),oe(4),oe(8),oe(8),oe(8),oe(12),oe(192),oe(192),oe(4),oe(4),oe(4),oe(4),oe(4),oe(4),oe(4),oe(4),oe(8),oe(8),oe(8),oe(8),oe(8),oe(8),oe(8),oe(8),oe(8),oe(4),oe(4),oe(4),oe(8),oe(16),oe(16),oe(16),oe(32),oe(32),oe(48),oe(64),oe(1152),oe(1152),oe(4),oe(4),oe(4),oe(4),oe(4),oe(4),oe(4),oe(4),oe(4),oe(4),oe(24),oe(24),oe(24),oe(24),oe(24),oe(24),oe(24),oe(24),oe(24),oe(24),oe(1152),oe(1152),oe(1152),oe(1152),oe(1152),oe(2304),oe(2304),oe(3456),oe(5760),oe(8),oe(8),oe(8),oe(16),oe(24),oe(48),oe(48),oe(96),oe(192),oe(384),oe(384),oe(384),oe(768),oe(96),oe(96),oe(96),oe(1152);const XZ=Math.pow(2,-52),AE=new Uint32Array(512);class TE{static from(t,n=CPe,i=EPe){const r=t.length,s=new Float64Array(2*r);for(let o=0;o<r;o++){const a=t[o];s[2*o]=n(a),s[2*o+1]=i(a)}return new TE(s)}constructor(t){const n=t.length>>1;if(n>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(3*i),this._halfedges=new Int32Array(3*i),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:s}=this,o=t.length>>1;let a=1/0,l=1/0,u=-1/0,c=-1/0;for(let M=0;M<o;M++){const N=t[2*M],R=t[2*M+1];N<a&&(a=N),R<l&&(l=R),N>u&&(u=N),R>c&&(c=R),this._ids[M]=M}const f=(a+u)/2,d=(l+c)/2;let p,g,m,h=1/0;for(let M=0;M<o;M++){const N=eL(f,d,t[2*M],t[2*M+1]);N<h&&(p=M,h=N)}const _=t[2*p],y=t[2*p+1];h=1/0;for(let M=0;M<o;M++){if(M===p)continue;const N=eL(_,y,t[2*M],t[2*M+1]);N<h&&N>0&&(g=M,h=N)}let v=t[2*g],b=t[2*g+1],D=1/0;for(let M=0;M<o;M++){if(M===p||M===g)continue;const N=wPe(_,y,v,b,t[2*M],t[2*M+1]);N<D&&(m=M,D=N)}let C=t[2*m],w=t[2*m+1];if(D===1/0){for(let R=0;R<o;R++)this._dists[R]=t[2*R]-t[0]||t[2*R+1]-t[1];gm(this._ids,this._dists,0,o-1);const M=new Uint32Array(o);let N=0;for(let R=0,P=-1/0;R<o;R++){const A=this._ids[R];this._dists[A]>P&&(M[N++]=A,P=this._dists[A])}return this.hull=M.subarray(0,N),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(_E(_,y,v,b,C,w)<0){const M=g,N=v,R=b;g=m,v=C,b=w,m=M,C=N,w=R}const E=function DPe(e,t,n,i,r,s){const o=n-e,a=i-t,l=r-e,u=s-t,c=o*o+a*a,f=l*l+u*u,d=.5/(o*u-a*l);return{x:e+(u*c-a*f)*d,y:t+(o*f-l*c)*d}}(_,y,v,b,C,w);this._cx=E.x,this._cy=E.y;for(let M=0;M<o;M++)this._dists[M]=eL(t[2*M],t[2*M+1],E.x,E.y);gm(this._ids,this._dists,0,o-1),this._hullStart=p;let O=3;i[p]=n[m]=g,i[g]=n[p]=m,i[m]=n[g]=p,r[p]=0,r[g]=1,r[m]=2,s.fill(-1),s[this._hashKey(_,y)]=p,s[this._hashKey(v,b)]=g,s[this._hashKey(C,w)]=m,this.trianglesLen=0,this._addTriangle(p,g,m,-1,-1,-1);for(let N,R,M=0;M<this._ids.length;M++){const P=this._ids[M],A=t[2*P],x=t[2*P+1];if(M>0&&Math.abs(A-N)<=XZ&&Math.abs(x-R)<=XZ||(N=A,R=x,P===p||P===g||P===m))continue;let S=0;for(let j=0,V=this._hashKey(A,x);j<this._hashSize&&(S=s[(V+j)%this._hashSize],-1===S||S===i[S]);j++);S=n[S];let T,k=S;for(;T=i[k],_E(A,x,t[2*k],t[2*k+1],t[2*T],t[2*T+1])>=0;)if(k=T,k===S){k=-1;break}if(-1===k)continue;let F=this._addTriangle(k,P,i[k],-1,-1,r[k]);r[P]=this._legalize(F+2),r[k]=F,O++;let I=i[k];for(;T=i[I],_E(A,x,t[2*I],t[2*I+1],t[2*T],t[2*T+1])<0;)F=this._addTriangle(I,P,T,r[P],-1,r[I]),r[P]=this._legalize(F+2),i[I]=I,O--,I=T;if(k===S)for(;T=n[k],_E(A,x,t[2*T],t[2*T+1],t[2*k],t[2*k+1])<0;)F=this._addTriangle(T,P,k,-1,r[k],r[T]),this._legalize(F+2),r[T]=F,i[k]=k,O--,k=T;this._hullStart=n[P]=k,i[k]=n[I]=P,i[P]=I,s[this._hashKey(A,x)]=P,s[this._hashKey(t[2*k],t[2*k+1])]=k}this.hull=new Uint32Array(O);for(let M=0,N=this._hullStart;M<O;M++)this.hull[M]=N,N=i[N];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(function vPe(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:i,coords:r}=this;let s=0,o=0;for(;;){const a=i[t],l=t-t%3;if(o=l+(t+2)%3,-1===a){if(0===s)break;t=AE[--s];continue}const u=a-a%3,f=u+(a+2)%3,d=n[o],h=n[t],p=n[l+(t+1)%3],g=n[f];if(bPe(r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*p],r[2*p+1],r[2*g],r[2*g+1])){n[t]=g,n[a]=d;const _=i[f];if(-1===_){let v=this._hullStart;do{if(this._hullTri[v]===f){this._hullTri[v]=t;break}v=this._hullPrev[v]}while(v!==this._hullStart)}this._link(t,_),this._link(a,i[o]),this._link(o,f);const y=u+(a+1)%3;s<AE.length&&(AE[s++]=y)}else{if(0===s)break;t=AE[--s]}}return o}_link(t,n){this._halfedges[t]=n,-1!==n&&(this._halfedges[n]=t)}_addTriangle(t,n,i,r,s,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=i,this._link(a,r),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function eL(e,t,n,i){const r=e-n,s=t-i;return r*r+s*s}function bPe(e,t,n,i,r,s,o,a){const l=e-o,u=t-a,c=n-o,f=i-a,d=r-o,h=s-a,g=c*c+f*f,m=d*d+h*h;return l*(f*m-g*h)-u*(c*m-g*d)+(l*l+u*u)*(c*h-f*d)<0}function wPe(e,t,n,i,r,s){const o=n-e,a=i-t,l=r-e,u=s-t,c=o*o+a*a,f=l*l+u*u,d=.5/(o*u-a*l),h=(u*c-a*f)*d,p=(o*f-l*c)*d;return h*h+p*p}function gm(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const s=e[r],o=t[s];let a=r-1;for(;a>=n&&t[e[a]]>o;)e[a+1]=e[a--];e[a+1]=s}else{let s=n+1,o=i;sv(e,n+i>>1,s),t[e[n]]>t[e[i]]&&sv(e,n,i),t[e[s]]>t[e[i]]&&sv(e,s,i),t[e[n]]>t[e[s]]&&sv(e,n,s);const a=e[s],l=t[a];for(;;){do{s++}while(t[e[s]]<l);do{o--}while(t[e[o]]>l);if(o<s)break;sv(e,s,o)}e[n+1]=e[o],e[o]=a,i-s+1>=o-n?(gm(e,t,s,i),gm(e,t,n,o-1)):(gm(e,t,n,o-1),gm(e,t,s,i))}}function sv(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function CPe(e){return e[0]}function EPe(e){return e[1]}class dh{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,i){const r=(t=+t)+(i=+i),s=n=+n;if(i<0)throw new Error("negative radius");null===this._x1?this._+=`M${r},${s}`:(Math.abs(this._x1-r)>1e-6||Math.abs(this._y1-s)>1e-6)&&(this._+="L"+r+","+s),i&&(this._+=`A${i},${i},0,1,1,${t-i},${n}A${i},${i},0,1,1,${this._x1=r},${this._y1=s}`)}rect(t,n,i,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class tL{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class SPe{constructor(t,[n,i,r,s]=[0,0,960,500]){if(!((r=+r)>=(n=+n)&&(s=+s)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=r,this.xmin=n,this.ymax=s,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:i},vectors:r}=this,s=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let m,_,h=0,p=0,g=i.length;h<g;h+=3,p+=2){const y=2*i[h],v=2*i[h+1],b=2*i[h+2],D=t[y],C=t[y+1],O=t[b],M=t[b+1],N=t[v]-D,R=t[v+1]-C,P=O-D,A=M-C,x=2*(N*A-R*P);if(Math.abs(x)<1e-9){let S=1e9;const k=2*i[0];S*=Math.sign((t[k]-D)*A-(t[k+1]-C)*P),m=(D+O)/2-S*A,_=(C+M)/2+S*P}else{const S=1/x,k=N*N+R*R,T=P*P+A*A;m=D+(A*k-R*T)*S,_=C+(N*T-P*k)*S}s[p]=m,s[p+1]=_}let a,u,f,o=n[n.length-1],l=4*o,c=t[2*o],d=t[2*o+1];r.fill(0);for(let h=0;h<n.length;++h)o=n[h],a=l,u=c,f=d,l=4*o,c=t[2*o],d=t[2*o+1],r[a+2]=r[l]=f-d,r[a+3]=r[l+1]=c-u}render(t){const n=null==t?t=new dh:void 0,{delaunay:{halfedges:i,inedges:r,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let c=0,f=i.length;c<f;++c){const d=i[c];if(d<c)continue;const h=2*Math.floor(c/3),p=2*Math.floor(d/3);this._renderSegment(o[h],o[h+1],o[p],o[p+1],t)}let l,u=s[s.length-1];for(let c=0;c<s.length;++c){l=u,u=s[c];const f=2*Math.floor(r[u]/3),d=o[f],h=o[f+1],p=4*l,g=this._project(d,h,a[p+2],a[p+3]);g&&this._renderSegment(d,h,g[0],g[1],t)}return n&&n.value()}renderBounds(t){const n=null==t?t=new dh:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const i=null==n?n=new dh:void 0,r=this._clip(t);if(null===r||!r.length)return;n.moveTo(r[0],r[1]);let s=r.length;for(;r[0]===r[s-2]&&r[1]===r[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(r[o]!==r[o-2]||r[o+1]!==r[o-1])&&n.lineTo(r[o],r[o+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,i=t.length/2;n<i;++n){const r=this.cellPolygon(n);r&&(r.index=n,yield r)}}cellPolygon(t){const n=new tL;return this.renderCell(t,n),n.value()}_renderSegment(t,n,i,r,s){let o;const a=this._regioncode(t,n),l=this._regioncode(i,r);0===a&&0===l?(s.moveTo(t,n),s.lineTo(i,r)):(o=this._clipSegment(t,n,i,r,a,l))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(t,n,i){return(n=+n)==n&&(i=+i)==i&&this.delaunay._step(t,n,i)===t}*neighbors(t){const n=this._clip(t);if(n)for(const i of this.delaunay.neighbors(t)){const r=this._clip(i);if(r)e:for(let s=0,o=n.length;s<o;s+=2)for(let a=0,l=r.length;a<l;a+=2)if(n[s]==r[a]&&n[s+1]==r[a+1]&&n[(s+2)%o]==r[(a+l-2)%l]&&n[(s+3)%o]==r[(a+l-1)%l]){yield i;break e}}}_cell(t){const{circumcenters:n,delaunay:{inedges:i,halfedges:r,triangles:s}}=this,o=i[t];if(-1===o)return null;const a=[];let l=o;do{const u=Math.floor(l/3);if(a.push(n[2*u],n[2*u+1]),l=l%3==2?l-2:l+1,s[l]!==t)break;l=r[l]}while(l!==o&&-1!==l);return a}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(null===n)return null;const{vectors:i}=this,r=4*t;return i[r]||i[r+1]?this._clipInfinite(t,n,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(t,n)}_clipFinite(t,n){const i=n.length;let s,o,u,f,r=null,a=n[i-2],l=n[i-1],c=this._regioncode(a,l),d=0;for(let h=0;h<i;h+=2)if(s=a,o=l,a=n[h],l=n[h+1],u=c,c=this._regioncode(a,l),0===u&&0===c)f=d,d=0,r?r.push(a,l):r=[a,l];else{let p,g,m,_,y;if(0===u){if(null===(p=this._clipSegment(s,o,a,l,u,c)))continue;[g,m,_,y]=p}else{if(null===(p=this._clipSegment(a,l,s,o,c,u)))continue;[_,y,g,m]=p,f=d,d=this._edgecode(g,m),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(g,m):r=[g,m]}f=d,d=this._edgecode(_,y),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(_,y):r=[_,y]}if(r)f=d,d=this._edgecode(r[0],r[1]),f&&d&&this._edge(t,f,d,r,r.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(t,n,i,r,s,o){for(;;){if(0===s&&0===o)return[t,n,i,r];if(s&o)return null;let a,l,u=s||o;8&u?(a=t+(i-t)*(this.ymax-n)/(r-n),l=this.ymax):4&u?(a=t+(i-t)*(this.ymin-n)/(r-n),l=this.ymin):2&u?(l=n+(r-n)*(this.xmax-t)/(i-t),a=this.xmax):(l=n+(r-n)*(this.xmin-t)/(i-t),a=this.xmin),s?s=this._regioncode(t=a,n=l):o=this._regioncode(i=a,r=l)}}_clipInfinite(t,n,i,r,s,o){let l,a=Array.from(n);if((l=this._project(a[0],a[1],i,r))&&a.unshift(l[0],l[1]),(l=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(l[0],l[1]),a=this._clipFinite(t,a))for(let f,u=0,c=a.length,d=this._edgecode(a[c-2],a[c-1]);u<c;u+=2)f=d,d=this._edgecode(a[u],a[u+1]),f&&d&&(u=this._edge(t,f,d,a,u),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,i,r,s){for(;n!==i;){let o,a;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,a=this.ymin}(r[s]!==o||r[s+1]!==a)&&this.contains(t,o,a)&&(r.splice(s,0,o,a),s+=2)}if(r.length>4)for(let o=0;o<r.length;o+=2){const a=(o+2)%r.length,l=(o+4)%r.length;(r[o]===r[a]&&r[a]===r[l]||r[o+1]===r[a+1]&&r[a+1]===r[l+1])&&(r.splice(a,2),o-=2)}return s}_project(t,n,i,r){let o,a,l,s=1/0;if(r<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/r)<s&&(l=this.ymin,a=t+(s=o)*i)}else if(r>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/r)<s&&(l=this.ymax,a=t+(s=o)*i)}if(i>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/i)<s&&(a=this.xmax,l=n+(s=o)*r)}else if(i<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/i)<s&&(a=this.xmin,l=n+(s=o)*r)}return[a,l]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const xPe=2*Math.PI,mm=Math.pow;function APe(e){return e[0]}function TPe(e){return e[1]}function MPe(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class nL{static from(t,n=APe,i=TPe,r){return new nL("length"in t?function NPe(e,t,n,i){const r=e.length,s=new Float64Array(2*r);for(let o=0;o<r;++o){const a=e[o];s[2*o]=t.call(i,a,o,e),s[2*o+1]=n.call(i,a,o,e)}return s}(t,n,i,r):Float64Array.from(function*kPe(e,t,n,i){let r=0;for(const s of e)yield t.call(i,s,r,e),yield n.call(i,s,r,e),++r}(t,n,i,r)))}constructor(t){this._delaunator=new TE(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&function OPe(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const r=2*t[i],s=2*t[i+1],o=2*t[i+2];if((n[o]-n[r])*(n[s+1]-n[r+1])-(n[s]-n[r])*(n[o+1]-n[r+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const l=this.collinear[0],u=this.collinear[this.collinear.length-1],c=[n[2*l],n[2*l+1],n[2*u],n[2*u+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const p=MPe(n[2*d],n[2*d+1],f);n[2*d]=p[0],n[2*d+1]=p[1]}this._delaunator=new TE(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let l=0,u=i.length;l<u;++l){const c=s[l%3==2?l-2:l+1];(-1===i[l]||-1===o[c])&&(o[c]=l)}for(let l=0,u=r.length;l<u;++l)a[r[l]]=l;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,2===r.length&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(t){return new SPe(this,t)}*neighbors(t){const{inedges:n,hull:i,_hullIndex:r,halfedges:s,triangles:o,collinear:a}=this;if(a){const f=a.indexOf(t);return f>0&&(yield a[f-1]),void(f<a.length-1&&(yield a[f+1]))}const l=n[t];if(-1===l)return;let u=l,c=-1;do{if(yield c=o[u],u=u%3==2?u-2:u+1,o[u]!==t)return;if(u=s[u],-1===u){const f=i[(r[t]+1)%i.length];return void(f!==c&&(yield f))}}while(u!==l)}find(t,n,i=0){if((t=+t)!=t||(n=+n)!=n)return-1;const r=i;let s;for(;(s=this._step(i,t,n))>=0&&s!==i&&s!==r;)i=s;return s}_step(t,n,i){const{inedges:r,hull:s,_hullIndex:o,halfedges:a,triangles:l,points:u}=this;if(-1===r[t]||!u.length)return(t+1)%(u.length>>1);let c=t,f=mm(n-u[2*t],2)+mm(i-u[2*t+1],2);const d=r[t];let h=d;do{let p=l[h];const g=mm(n-u[2*p],2)+mm(i-u[2*p+1],2);if(g<f&&(f=g,c=p),h=h%3==2?h-2:h+1,l[h]!==t)break;if(h=a[h],-1===h){if(h=s[(o[t]+1)%s.length],h!==p&&mm(n-u[2*h],2)+mm(i-u[2*h+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=null==t?t=new dh:void 0,{points:i,halfedges:r,triangles:s}=this;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l<o)continue;const u=2*s[o],c=2*s[l];t.moveTo(i[u],i[u+1]),t.lineTo(i[c],i[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){void 0===n&&(!t||"function"!=typeof t.moveTo)&&(n=t,t=null),n=null==n?2:+n;const i=null==t?t=new dh:void 0,{points:r}=this;for(let s=0,o=r.length;s<o;s+=2){const a=r[s],l=r[s+1];t.moveTo(a+n,l),t.arc(a,l,n,0,xPe)}return i&&i.value()}renderHull(t){const n=null==t?t=new dh:void 0,{hull:i,points:r}=this,s=2*i[0],o=i.length;t.moveTo(r[s],r[s+1]);for(let a=1;a<o;++a){const l=2*i[a];t.lineTo(r[l],r[l+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new tL;return this.renderHull(t),t.value()}renderTriangle(t,n){const i=null==n?n=new dh:void 0,{points:r,triangles:s}=this,o=2*s[t*=3],a=2*s[t+1],l=2*s[t+2];return n.moveTo(r[o],r[o+1]),n.lineTo(r[a],r[a+1]),n.lineTo(r[l],r[l+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,i=t.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new tL;return this.renderTriangle(t,n),n.value()}}function iL(e){K.call(this,null,e)}iL.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const IPe=[-1e5,-1e5,1e5,1e5];function RPe(e){const t=e[0][0],n=e[0][1];let i=e.length-1;for(;e[i][0]===t&&e[i][1]===n;--i);return"M"+e.slice(0,i+1).join("L")+"Z"}ce(iL,K,{transform(e,t){const n=e.as||"path",i=t.source;if(!i||!i.length)return t;let r=e.size;r=r?[0,0,r[0],r[1]]:(r=e.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:IPe;const s=this.value=nL.from(i,e.x,e.y).voronoi(r);for(let o=0,a=i.length;o<a;++o){const l=s.cellPolygon(o);i[o][n]=l?RPe(l):null}return t.reflow(e.modified()).modifies(n)}});var rL=Math.PI/180;function PPe(e,t,n,i){if(!t.sprite){var r=e.context,s=e.ratio;r.clearRect(0,0,2048/s,2048/s);var c,f,d,h,p,o=0,a=0,l=0,u=n.length;for(--i;++i<u;){if(t=n[i],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font,c=r.measureText(t.text+"m").width*s,d=t.size<<1,t.rotate){var g=Math.sin(t.rotate*rL),m=Math.cos(t.rotate*rL),_=c*m,y=c*g,v=d*m,b=d*g;c=Math.max(Math.abs(_+b),Math.abs(_-b))+31>>5<<5,d=~~Math.max(Math.abs(y+v),Math.abs(y-v))}else c=c+31>>5<<5;if(d>l&&(l=d),o+c>=2048&&(o=0,a+=l,l=0),a+d>=2048)break;r.translate((o+(c>>1))/s,(a+(d>>1))/s),t.rotate&&r.rotate(t.rotate*rL),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=c,t.height=d,t.xoff=o,t.yoff=a,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,o+=c}for(var D=r.getImageData(0,0,2048/s,2048/s).data,C=[];--i>=0;)if((t=n[i]).hasText){for(f=(c=t.width)>>5,d=t.y1-t.y0,h=0;h<d*f;h++)C[h]=0;if(null==(o=t.xoff))return;a=t.yoff;var w=0,E=-1;for(p=0;p<d;p++){for(h=0;h<c;h++){var M=D[2048*(a+p)+(o+h)<<2]?1<<31-h%32:0;C[f*p+(h>>5)]|=M,w|=M}w?E=p:(t.y0++,d--,p--,a++)}t.y1=t.y0+E,t.sprite=C.slice(0,(t.y1-t.y0)*f)}}}function LPe(e,t,n){for(var c,i=e.sprite,r=e.width>>5,s=e.x-(r<<4),o=127&s,a=32-o,l=e.y1-e.y0,u=(e.y+e.y0)*(n>>=5)+(s>>5),f=0;f<l;f++){c=0;for(var d=0;d<=r;d++)if((c<<a|(d<r?(c=i[f*r+d])>>>o:0))&t[u+d])return!0;u+=n}return!1}function jPe(e,t){var n=e[0],i=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>i.x&&(i.x=t.x+t.x1),t.y+t.y1>i.y&&(i.y=t.y+t.y1)}function BPe(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function ZZ(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function hh(e){return"function"==typeof e?e:function(){return e}}var HPe={archimedean:ZZ,rectangular:function $Pe(e){var n=4*e[0]/e[1],i=0,r=0;return function(s){var o=s<0?-1:1;switch(Math.sqrt(1+4*o*s)-o&3){case 0:i+=n;break;case 1:r+=4;break;case 2:i-=n;break;default:r-=4}return[i,r]}}};const eee=["x","y","font","fontSize","fontStyle","fontWeight","angle"],UPe=["text","font","rotate","fontSize","fontStyle","fontWeight"];function sL(e){K.call(this,function FPe(){var t,n,i,r,s,o,a,e=[256,256],l=ZZ,u=[],c=Math.random,f={};function h(p,g,m){for(var w,E,O,_=g.x,y=g.y,v=Math.sqrt(e[0]*e[0]+e[1]*e[1]),b=l(e),D=c()<.5?1:-1,C=-D;(w=b(C+=D))&&(E=~~w[0],O=~~w[1],!(Math.min(Math.abs(E),Math.abs(O))>=v));)if(g.x=_+E,g.y=y+O,!(g.x+g.x0<0||g.y+g.y0<0||g.x+g.x1>e[0]||g.y+g.y1>e[1])&&(!m||!LPe(g,p,e[0]))&&(!m||BPe(g,m))){for(var T,M=g.sprite,N=g.width>>5,R=e[0]>>5,P=g.x-(N<<4),A=127&P,x=32-A,S=g.y1-g.y0,k=(g.y+g.y0)*R+(P>>5),F=0;F<S;F++){T=0;for(var I=0;I<=N;I++)p[k+I]|=T<<x|(I<N?(T=M[F*N+I])>>>A:0);k+=R}return g.sprite=null,!0}return!1}return f.layout=function(){for(var p=function d(p){p.width=p.height=1;var g=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=2048/g,p.height=2048/g;var m=p.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:g}}(Jc()),g=function VPe(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}((e[0]>>5)*e[1]),m=null,_=u.length,y=-1,v=[],b=u.map(C=>({text:t(C),font:n(C),style:r(C),weight:s(C),rotate:o(C),size:~~(i(C)+1e-14),padding:a(C),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:C})).sort((C,w)=>w.size-C.size);++y<_;){var D=b[y];D.x=e[0]*(c()+.5)>>1,D.y=e[1]*(c()+.5)>>1,PPe(p,D,b,y),D.hasText&&h(g,D,m)&&(v.push(D),m?jPe(m,D):m=[{x:D.x+D.x0,y:D.y+D.y0},{x:D.x+D.x1,y:D.y+D.y1}],D.x-=e[0]>>1,D.y-=e[1]>>1)}return v},f.words=function(p){return arguments.length?(u=p,f):u},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=hh(p),f):n},f.fontStyle=function(p){return arguments.length?(r=hh(p),f):r},f.fontWeight=function(p){return arguments.length?(s=hh(p),f):s},f.rotate=function(p){return arguments.length?(o=hh(p),f):o},f.text=function(p){return arguments.length?(t=hh(p),f):t},f.spiral=function(p){return arguments.length?(l=HPe[p]||p,f):l},f.fontSize=function(p){return arguments.length?(i=hh(p),f):i},f.padding=function(p){return arguments.length?(a=hh(p),f):a},f.random=function(p){return arguments.length?(c=p,f):c},f}(),e)}sL.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:eee}]},ce(sL,K,{transform(e,t){e.size&&(!e.size[0]||!e.size[1])&&Q("Wordcloud size dimensions must be non-zero.");const i=e.modified();if(!(i||t.changed(t.ADD_REM)||UPe.some(function n(p){const g=e[p];return Qe(g)&&t.modified(g.fields)})))return;const r=t.materialize(t.SOURCE).source,s=this.value,o=e.as||eee;let l,a=e.fontSize||14;if(Qe(a)?l=e.fontSizeRange:a=ur(a),l){const p=a,g=kt("sqrt")().domain(cl(r,p)).range(l);a=m=>g(p(m))}r.forEach(p=>{p[o[0]]=NaN,p[o[1]]=NaN,p[o[3]]=0});const u=s.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(xo).layout(),c=s.size(),f=c[0]>>1,d=c[1]>>1,h=u.length;for(let g,m,p=0;p<h;++p)g=u[p],m=g.datum,m[o[0]]=g.x+f,m[o[1]]=g.y+d,m[o[2]]=g.font,m[o[3]]=g.size,m[o[4]]=g.style,m[o[5]]=g.weight,m[o[6]]=g.rotate;return t.reflow(i).modifies(o)}});const GPe=e=>new Uint8Array(e),WPe=e=>new Uint16Array(e),av=e=>new Uint32Array(e);function ME(e,t,n){const i=(t<257?GPe:t<65537?WPe:av)(e);return n&&i.set(n),i}function tee(e,t,n){const i=1<<t;return{one:i,zero:~i,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(r,s){const o=this,a=o.bisect(o.range,r.value),l=r.index,u=a[0],c=a[1],f=l.length;let d;for(d=0;d<u;++d)s[l[d]]|=i;for(d=c;d<f;++d)s[l[d]]|=i;return o}}}function nee(){let e=av(0),t=[],n=0;return{insert:function i(a,l,u){if(!l.length)return[];const c=n,f=l.length,d=av(f);let p,g,m,h=Array(f);for(m=0;m<f;++m)h[m]=a(l[m]),d[m]=m;if(h=function KPe(e,t){return e.sort.call(t,(n,i)=>{const r=e[n],s=e[i];return r<s?-1:r>s?1:0}),function zPe(e,t){return Array.from(t,n=>e[n])}(e,t)}(h,d),c)p=t,g=e,t=Array(c+f),e=av(c+f),function JPe(e,t,n,i,r,s,o,a,l){let f,u=0,c=0;for(f=0;u<i&&c<o;++f)t[u]<r[c]?(a[f]=t[u],l[f]=n[u++]):(a[f]=r[c],l[f]=s[c++]+e);for(;u<i;++u,++f)a[f]=t[u],l[f]=n[u];for(;c<o;++c,++f)a[f]=r[c],l[f]=s[c]+e}(u,p,g,c,h,d,f,t,e);else{if(u>0)for(m=0;m<f;++m)d[m]+=u;t=h,e=d}return n=c+f,{index:d,value:h}},remove:function r(a,l){const u=n;let c,f,d;for(f=0;!l[e[f]]&&f<u;++f);for(d=f;f<u;++f)l[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=u-a},bisect:function o(a,l){let u;return l?u=l.length:(l=t,u=n),[XAe(l,a[0],0,u),OD(l,a[1],0,u)]},reindex:function s(a){for(let l=0,u=n;l<u;++l)e[l]=a[e[l]]},index:()=>e,size:()=>n}}function oL(e){K.call(this,function qPe(){let e=8,t=[],n=av(0),i=ME(0,e),r=ME(0,e);return{data:()=>t,seen:()=>n=function YPe(e,t,n){return e.length>=t?e:((n=n||new e.constructor(t)).set(e),n)}(n,t.length),add(s){for(let u,o=0,a=t.length,l=s.length;o<l;++o)u=s[o],u._index=a++,t.push(u)},remove(s,o){const a=t.length,l=Array(a-s),u=t;let c,f,d;for(f=0;!o[f]&&f<a;++f)l[f]=t[f],u[f]=f;for(d=f;f<a;++f)c=t[f],o[f]?u[f]=-1:(u[f]=d,i[d]=i[f],r[d]=r[f],l[d]=c,c._index=d++),i[f]=0;return t=l,u},size:()=>t.length,curr:()=>i,prev:()=>r,reset:s=>r[s]=i[s],all:()=>e<257?255:e<65537?65535:4294967295,set(s,o){i[s]|=o},clear(s,o){i[s]&=~o},resize(s,o){(s>i.length||o>e)&&(e=Math.max(o,e),i=ME(s,e,i),r=ME(s,e))}}}(),e),this._indices=null,this._dims=null}function aL(e){K.call(this,null,e)}oL.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},ce(oL,K,{transform(e,t){return this._dims?e.modified("fields")||e.fields.some(i=>t.modified(i.fields))?this.reinit(e,t):this.eval(e,t):this.init(e,t)},init(e,t){const n=e.fields,i=e.query,r=this._indices={},s=this._dims=[],o=i.length;let l,u,a=0;for(;a<o;++a)l=n[a].fname,u=r[l]||(r[l]=nee()),s.push(tee(u,a,i[a]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),i=e.fields,r=e.query,s=this._indices,o=this._dims,a=this.value,l=a.curr(),u=a.prev(),c=a.all(),f=n.rem=n.add,d=n.mod,h=r.length,p={};let g,m,_,y,v,b,D,C,w;if(u.set(l),t.rem.length&&(v=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(b={},y=t.mod,D=0,C=y.length;D<C;++D)b[y[D]._index]=1;for(D=0;D<h;++D)w=i[D],(!o[D]||e.modified("fields",D)||t.modified(w.fields))&&(_=w.fname,(g=p[_])||(s[_]=m=nee(),p[_]=g=m.insert(w,t.source,0)),o[D]=tee(m,D,r[D]).onAdd(g,l));for(D=0,C=a.data().length;D<C;++D)v[D]||(u[D]!==l[D]?f.push(D):b[D]&&l[D]!==c&&d.push(D));return a.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),i=this._dims.length;let r=0;return t.rem.length&&(this.remove(e,t,n),r|=(1<<i)-1),e.modified("query")&&!e.modified("fields")&&(r|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),r|=(1<<i)-1),t.mod.length&&(this.modify(t,n),r|=(1<<i)-1),this.value.mask=r,n},insert(e,t,n){const i=t.add,r=this.value,s=this._dims,o=this._indices,a=e.fields,l={},u=n.add,c=r.size()+i.length,f=s.length;let h,p,g,d=r.size();r.resize(c,f),r.add(i);const m=r.curr(),_=r.prev(),y=r.all();for(h=0;h<f;++h)p=a[h].fname,g=l[p]||(l[p]=o[p].insert(a[h],i,d)),s[h].onAdd(g,m);for(;d<c;++d)_[d]=y,m[d]!==y&&u.push(d)},modify(e,t){const n=t.mod,i=this.value,r=i.curr(),s=i.all(),o=e.mod;let a,l,u;for(a=0,l=o.length;a<l;++a)u=o[a]._index,r[u]!==s&&n.push(u)},remove(e,t,n){const i=this._indices,r=this.value,s=r.curr(),o=r.prev(),a=r.all(),l={},u=n.rem,c=t.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,l[h]=1,o[h]=p=s[h],s[h]=a,p!==a&&u.push(h);for(h in i)i[h].remove(d,l);return this.reindex(t,d,l),l},reindex(e,t,n){const i=this._indices,r=this.value;e.runAfter(()=>{const s=r.remove(t,n);for(const o in i)i[o].reindex(s)})},update(e,t,n){const i=this._dims,r=e.query,s=t.stamp,o=i.length;let l,u,a=0;for(n.filters=0,u=0;u<o;++u)e.modified("query",u)&&(l=u,++a);if(1===a)a=i[l].one,this.incrementOne(i[l],r[l],n.add,n.rem);else for(u=0,a=0;u<o;++u)!e.modified("query",u)||(a|=i[u].one,this.incrementAll(i[u],r[u],s,n.add),n.rem=n.add);return a},incrementAll(e,t,n,i){const r=this.value,s=r.seen(),o=r.curr(),a=r.prev(),l=e.index(),u=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=u[0],p=u[1],g=e.one;let m,_,y;if(f<h)for(m=f,_=Math.min(h,d);m<_;++m)y=l[m],s[y]!==n&&(a[y]=o[y],s[y]=n,i.push(y)),o[y]^=g;else if(f>h)for(m=h,_=Math.min(f,p);m<_;++m)y=l[m],s[y]!==n&&(a[y]=o[y],s[y]=n,i.push(y)),o[y]^=g;if(d>p)for(m=Math.max(f,p),_=d;m<_;++m)y=l[m],s[y]!==n&&(a[y]=o[y],s[y]=n,i.push(y)),o[y]^=g;else if(d<p)for(m=Math.max(h,d),_=p;m<_;++m)y=l[m],s[y]!==n&&(a[y]=o[y],s[y]=n,i.push(y)),o[y]^=g;e.range=t.slice()},incrementOne(e,t,n,i){const s=this.value.curr(),o=e.index(),a=e.bisect(e.range),l=e.bisect(t),u=l[0],c=l[1],f=a[0],d=a[1],h=e.one;let p,g,m;if(u<f)for(p=u,g=Math.min(f,c);p<g;++p)m=o[p],s[m]^=h,n.push(m);else if(u>f)for(p=f,g=Math.min(u,d);p<g;++p)m=o[p],s[m]^=h,i.push(m);if(c>d)for(p=Math.max(u,d),g=c;p<g;++p)m=o[p],s[m]^=h,n.push(m);else if(c<d)for(p=Math.max(f,c),g=d;p<g;++p)m=o[p],s[m]^=h,i.push(m);e.range=t.slice()}}),aL.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},ce(aL,K,{transform(e,t){const n=~(e.ignore||0),i=e.filter,r=i.mask;if(0==(r&n))return t.StopPropagation;const s=t.fork(t.ALL),o=i.data(),a=i.curr(),l=i.prev(),u=c=>a[c]&n?null:o[c];return s.filter(s.MOD,u),r&r-1?(s.filter(s.ADD,c=>{const f=a[c]&n;return!f&&f^l[c]&n?o[c]:null}),s.filter(s.REM,c=>{const f=a[c]&n;return!f||f^f^l[c]&n?null:o[c]})):(s.filter(s.ADD,u),s.filter(s.REM,c=>(a[c]&n)===r?o[c]:null)),s.filter(s.SOURCE,c=>u(c._index))}});const ph="Literal",iee="CallExpression";function Ea(e){this.type=e}var Tl,xe,J,mr,qt;Ea.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=function aLe(e){switch(e.type){case"ArrayExpression":return e.elements;case"BinaryExpression":case"LogicalExpression":return[e.left,e.right];case iee:return[e.callee].concat(e.arguments);case"ConditionalExpression":return[e.test,e.consequent,e.alternate];case"MemberExpression":return[e.object,e.property];case"ObjectExpression":return e.properties;case"Property":return[e.key,e.value];case"UnaryExpression":return[e.argument];default:return[]}}(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1},(Tl={})[1]="Boolean",Tl[2]="<end>",Tl[3]="Identifier",Tl[4]="Keyword",Tl[5]="Null",Tl[6]="Numeric",Tl[7]="Punctuator",Tl[8]="String",Tl[9]="RegularExpression";var ree="Identifier",Ri="Unexpected token %0",lL="Invalid regular expression",uL="Invalid regular expression: missing /",see="Octal literals are not allowed in strict mode.",Yi="ILLEGAL",cv="Disabled.",SLe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),xLe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function IE(e,t){if(!e)throw new Error("ASSERT: "+t)}function $u(e){return e>=48&&e<=57}function cL(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function fv(e){return"01234567".indexOf(e)>=0}function ALe(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function dv(e){return 10===e||13===e||8232===e||8233===e}function hv(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&SLe.test(String.fromCharCode(e))}function RE(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&xLe.test(String.fromCharCode(e))}const TLe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function oee(){for(;J<mr;){const e=xe.charCodeAt(J);if(!ALe(e)&&!dv(e))break;++J}}function fL(e){var t,n,i,r=0;for(n="u"===e?4:2,t=0;t<n;++t)J<mr&&cL(xe[J])?(i=xe[J++],r=16*r+"0123456789abcdef".indexOf(i.toLowerCase())):It({},Ri,Yi);return String.fromCharCode(r)}function OLe(){var e,t;for(t=0,"}"===(e=xe[J])&&It({},Ri,Yi);J<mr&&cL(e=xe[J++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&It({},Ri,Yi),t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}function aee(){var e,t;for(e=xe.charCodeAt(J++),t=String.fromCharCode(e),92===e&&(117!==xe.charCodeAt(J)&&It({},Ri,Yi),++J,(!(e=fL("u"))||"\\"===e||!hv(e.charCodeAt(0)))&&It({},Ri,Yi),t=e);J<mr&&RE(e=xe.charCodeAt(J));)++J,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==xe.charCodeAt(J)&&It({},Ri,Yi),++J,(!(e=fL("u"))||"\\"===e||!RE(e.charCodeAt(0)))&&It({},Ri,Yi),t+=e);return t}function dL(){var n,r,s,o,e=J,t=xe.charCodeAt(J),i=xe[J];switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++J,{type:7,value:String.fromCharCode(t),start:e,end:J};default:if(61===(n=xe.charCodeAt(J+1)))switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return J+=2,{type:7,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:J};case 33:case 61:return 61===xe.charCodeAt(J+=2)&&++J,{type:7,value:xe.slice(e,J),start:e,end:J}}}return">>>="===(o=xe.substr(J,4))?{type:7,value:o,start:e,end:J+=4}:">>>"===(s=o.substr(0,3))||"<<="===s||">>="===s?{type:7,value:s,start:e,end:J+=3}:i===(r=s.substr(0,2))[1]&&"+-<>&|".indexOf(i)>=0||"=>"===r?{type:7,value:r,start:e,end:J+=2}:("//"===r&&It({},Ri,Yi),"<>=!+-*%&|^/".indexOf(i)>=0?{type:7,value:i,start:e,end:++J}:void It({},Ri,Yi))}function lee(){var e,t,n;if(IE($u((n=xe[J]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=J,e="","."!==n){if(e=xe[J++],n=xe[J],"0"===e){if("x"===n||"X"===n)return++J,function kLe(e){let t="";for(;J<mr&&cL(xe[J]);)t+=xe[J++];return 0===t.length&&It({},Ri,Yi),hv(xe.charCodeAt(J))&&It({},Ri,Yi),{type:6,value:parseInt("0x"+t,16),start:e,end:J}}(t);if(fv(n))return function ILe(e){let t="0"+xe[J++];for(;J<mr&&fv(xe[J]);)t+=xe[J++];return(hv(xe.charCodeAt(J))||$u(xe.charCodeAt(J)))&&It({},Ri,Yi),{type:6,value:parseInt(t,8),octal:!0,start:e,end:J}}(t);n&&$u(n.charCodeAt(0))&&It({},Ri,Yi)}for(;$u(xe.charCodeAt(J));)e+=xe[J++];n=xe[J]}if("."===n){for(e+=xe[J++];$u(xe.charCodeAt(J));)e+=xe[J++];n=xe[J]}if("e"===n||"E"===n)if(e+=xe[J++],("+"===(n=xe[J])||"-"===n)&&(e+=xe[J++]),$u(xe.charCodeAt(J)))for(;$u(xe.charCodeAt(J));)e+=xe[J++];else It({},Ri,Yi);return hv(xe.charCodeAt(J))&&It({},Ri,Yi),{type:6,value:parseFloat(e),start:t,end:J}}function uee(){if(oee(),J>=mr)return{type:2,start:J,end:J};const e=xe.charCodeAt(J);return hv(e)?function NLe(){var e,t;return e=J,t=92===xe.charCodeAt(J)?aee():function MLe(){var e,t;for(e=J++;J<mr;){if(92===(t=xe.charCodeAt(J)))return J=e,aee();if(!RE(t))break;++J}return xe.slice(e,J)}(),{type:1===t.length?3:TLe.hasOwnProperty(t)?4:"null"===t?5:"true"===t||"false"===t?1:3,value:t,start:e,end:J}}():40===e||41===e||59===e?dL():39===e||34===e?function RLe(){var t,n,i,r,e="",s=!1;for(IE("'"===(t=xe[J])||'"'===t,"String literal must starts with a quote"),n=J,++J;J<mr;){if((i=xe[J++])===t){t="";break}if("\\"===i)if((i=xe[J++])&&dv(i.charCodeAt(0)))"\r"===i&&"\n"===xe[J]&&++J;else switch(i){case"u":case"x":"{"===xe[J]?(++J,e+=OLe()):e+=fL(i);break;case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:fv(i)?(0!==(r="01234567".indexOf(i))&&(s=!0),J<mr&&fv(xe[J])&&(s=!0,r=8*r+"01234567".indexOf(xe[J++]),"0123".indexOf(i)>=0&&J<mr&&fv(xe[J])&&(r=8*r+"01234567".indexOf(xe[J++]))),e+=String.fromCharCode(r)):e+=i}else{if(dv(i.charCodeAt(0)))break;e+=i}}return""!==t&&It({},Ri,Yi),{type:8,value:e,octal:s,start:n,end:J}}():46===e?$u(xe.charCodeAt(J+1))?lee():dL():$u(e)?lee():dL()}function gs(){const e=qt;return J=e.end,qt=uee(),J=e.end,e}function cee(){const e=J;qt=uee(),J=e}function fee(e,t,n){const i=new Ea("||"===e||"&&"===e?"LogicalExpression":"BinaryExpression");return i.operator=e,i.left=t,i.right=n,i}function VLe(e,t){const n=new Ea("CallExpression");return n.callee=e,n.arguments=t,n}function hL(e){const t=new Ea(ree);return t.name=e,t}function pv(e){const t=new Ea("Literal");return t.value=e.value,t.raw=xe.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function dee(e,t,n){const i=new Ea("MemberExpression");return i.computed="["===e,i.object=t,i.property=n,i.computed||(n.member=!0),i}function hee(e,t,n){const i=new Ea("Property");return i.key=t,i.value=n,i.kind=e,i}function It(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(s,o)=>(IE(o<i.length,"Message reference must be in range"),i[o]));throw(n=new Error(r)).index=J,n.description=r,n}function FE(e){2===e.type&&It(e,"Unexpected end of input"),6===e.type&&It(e,"Unexpected number"),8===e.type&&It(e,"Unexpected string"),3===e.type&&It(e,"Unexpected identifier"),4===e.type&&It(e,"Unexpected reserved word"),It(e,Ri,e.value)}function _r(e){const t=gs();(7!==t.type||t.value!==e)&&FE(t)}function bn(e){return 7===qt.type&&qt.value===e}function pL(e){return 4===qt.type&&qt.value===e}function pee(){J=qt.start;const e=gs();return 8===e.type||6===e.type?(e.octal&&It(e,see),pv(e)):hL(e.value)}function WLe(){var e,t,n;return J=qt.start,3===(e=qt).type?(n=pee(),_r(":"),hee("init",n,_h())):2!==e.type&&7!==e.type?(t=pee(),_r(":"),hee("init",t,_h())):void FE(e)}const KLe={if:1};function JLe(){var e,t,n;if(bn("("))return function YLe(){_r("(");const e=gL();return _r(")"),e}();if(bn("["))return function GLe(){const e=[];for(J=qt.start,_r("[");!bn("]");)bn(",")?(gs(),e.push(null)):(e.push(_h()),bn("]")||_r(","));return gs(),function $Le(e){const t=new Ea("ArrayExpression");return t.elements=e,t}(e)}();if(bn("{"))return function qLe(){var t,i,e=[],r={},s=String;for(J=qt.start,_r("{");!bn("}");)i="$"+((t=WLe()).key.type===ree?t.key.name:s(t.key.value)),Object.prototype.hasOwnProperty.call(r,i)?It({},"Duplicate data property in object literal not allowed in strict mode"):r[i]=!0,e.push(t),bn("}")||_r(",");return _r("}"),function ULe(e){const t=new Ea("ObjectExpression");return t.properties=e,t}(e)}();if(J=qt.start,3===(e=qt.type)||KLe[qt.value])n=hL(gs().value);else if(8===e||6===e)qt.octal&&It(qt,see),n=pv(gs());else{if(4===e)throw new Error(cv);1===e?((t=gs()).value="true"===t.value,n=pv(t)):5===e?((t=gs()).value=null,n=pv(t)):bn("/")||bn("/=")?(n=pv(function jLe(){var e,t,n,i;return qt=null,oee(),e=J,t=function PLe(){var e,t,n,i;for(IE("/"===(e=xe[J]),"Regular expression literal must start with a slash"),t=xe[J++],n=!1,i=!1;J<mr;)if(t+=e=xe[J++],"\\"===e)dv((e=xe[J++]).charCodeAt(0))&&It({},uL),t+=e;else if(dv(e.charCodeAt(0)))It({},uL);else if(n)"]"===e&&(n=!1);else{if("/"===e){i=!0;break}"["===e&&(n=!0)}return i||It({},uL),{value:t.substr(1,t.length-2),literal:t}}(),n=function LLe(){var e,t,n;for(t="",n="";J<mr&&RE((e=xe[J]).charCodeAt(0));)++J,"\\"===e&&J<mr?It({},Ri,Yi):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&It({},lL,n),{value:n,literal:t}}(),i=function FLe(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";It({},lL)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(i){It({},lL)}try{return new RegExp(e,t)}catch(i){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:J}}()),cee()):FE(gs())}return n}function XLe(){const e=[];if(_r("("),!bn(")"))for(;J<mr&&(e.push(_h()),!bn(")"));)_r(",");return _r(")"),e}function e3e(){_r("[");const e=gL();return _r("]"),e}function gee(){const e=function t3e(){var e;for(e=JLe();;)if(bn("."))e=dee(".",e,(_r("."),function QLe(){J=qt.start;const e=gs();return function BLe(e){return 3===e.type||4===e.type||1===e.type||5===e.type}(e)||FE(e),hL(e.value)}()));else if(bn("("))e=VLe(e,XLe());else{if(!bn("["))break;e=dee("[",e,e3e())}return e}();if(7===qt.type&&(bn("++")||bn("--")))throw new Error(cv);return e}function PE(){var e,t;if(7!==qt.type&&4!==qt.type)t=gee();else{if(bn("++")||bn("--"))throw new Error(cv);if(bn("+")||bn("-")||bn("~")||bn("!"))e=gs(),t=PE(),t=function zLe(e,t){const n=new Ea("UnaryExpression");return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if(pL("delete")||pL("void")||pL("typeof"))throw new Error(cv);t=gee()}}return t}function mee(e){let t=0;if(7!==e.type&&4!==e.type)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function _h(){var e,t;return e=function n3e(){var e,t,n,i,r,s,o,a,l,u;if(e=qt,l=PE(),0===(r=mee(i=qt)))return l;for(i.prec=r,gs(),t=[e,qt],s=[l,i,o=PE()];(r=mee(qt))>0;){for(;s.length>2&&r<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,l=s.pop(),t.pop(),n=fee(a,l,o),s.push(n);(i=gs()).prec=r,s.push(i),t.push(qt),n=PE(),s.push(n)}for(n=s[u=s.length-1],t.pop();u>1;)t.pop(),n=fee(s[u-1].value,s[u-2],n),u-=2;return n}(),bn("?")&&(gs(),t=_h(),_r(":"),e=function HLe(e,t,n){const i=new Ea("ConditionalExpression");return i.test=e,i.consequent=t,i.alternate=n,i}(e,t,_h())),e}function gL(){const e=_h();if(bn(","))throw new Error(cv);return e}function mL(e){J=0,mr=(xe=e).length,qt=null,cee();const t=gL();if(2!==qt.type)throw new Error("Unexpect token after expression.");return t}var _ee={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function yee(e){function n(o,a,l){return u=>function t(o,a,l,u){let c=e(a[0]);return l&&(c=l+"("+c+")",0===l.lastIndexOf("new ",0)&&(c="("+c+")")),c+"."+o+(u<0?"":0===u?"()":"("+a.slice(1).map(e).join(",")+")")}(o,u,a,l)}const i="new Date",r="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&Q("Missing arguments to clamp function."),o.length>3&&Q("Too many arguments to clamp function.");const a=o.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:n("getDate",i,0),day:n("getDay",i,0),year:n("getFullYear",i,0),month:n("getMonth",i,0),hours:n("getHours",i,0),minutes:n("getMinutes",i,0),seconds:n("getSeconds",i,0),milliseconds:n("getMilliseconds",i,0),time:n("getTime",i,0),timezoneoffset:n("getTimezoneOffset",i,0),utcdate:n("getUTCDate",i,0),utcday:n("getUTCDay",i,0),utcyear:n("getUTCFullYear",i,0),utcmonth:n("getUTCMonth",i,0),utchours:n("getUTCHours",i,0),utcminutes:n("getUTCMinutes",i,0),utcseconds:n("getUTCSeconds",i,0),utcmilliseconds:n("getUTCMilliseconds",i,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",r,0),lower:n("toLowerCase",r,0),substring:n("substring",r),split:n("split",r),trim:n("trim",r,0),regexp:s,test:n("test",s),if:function(o){o.length<3&&Q("Missing arguments to if function."),o.length>3&&Q("Too many arguments to if function.");const a=o.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function vee(e){const t=(e=e||{}).allowed?ua(e.allowed):{},n=e.forbidden?ua(e.forbidden):{},i=e.constants||_ee,r=(e.functions||yee)(f),s=e.globalvar,o=e.fieldvar,a=Qe(s)?s:p=>`${s}["${p}"]`;let l={},u={},c=0;function f(p){if(_e(p))return p;const g=d[p.type];return null==g&&Q("Unsupported type: "+p.type),g(p)}const d={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:Oe(n,g)?Q("Illegal identifier: "+g):Oe(i,g)?i[g]:Oe(t,g)?g:(l[g]=1,a(g))},MemberExpression:p=>{const g=!p.computed,m=f(p.object);g&&(c+=1);const _=f(p.property);return m===o&&(u[function i3e(e){const t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}(_)]=1),g&&(c-=1),m+(g?"."+_:"["+_+"]")},CallExpression:p=>{"Identifier"!==p.callee.type&&Q("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,_=Oe(r,g)&&r[g];return _||Q("Unrecognized function: "+g),Qe(_)?_(m):_+"("+m.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function h(p){const g={code:f(p),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},g}return h.functions=r,h.constants=i,h}var bee,wee,_L,yL,vL,LE=new Wi,jE=new Wi,Ol={point:qi,lineStart:qi,lineEnd:qi,polygonStart:function(){LE=new Wi,Ol.lineStart=r3e,Ol.lineEnd=s3e},polygonEnd:function(){var e=+LE;jE.add(e<0?Fr+e:e),this.lineStart=this.lineEnd=this.point=qi},sphere:function(){jE.add(Fr)}};function r3e(){Ol.point=o3e}function s3e(){Dee(bee,wee)}function o3e(e,t){Ol.point=Dee,bee=e,wee=t,_L=e*=ct,yL=Le(t=(t*=ct)/2+RC),vL=Me(t)}function Dee(e,t){var n=(e*=ct)-_L,i=n>=0?1:-1,r=i*n,s=Le(t=(t*=ct)/2+RC),o=Me(t),a=vL*o,l=yL*s+a*Le(r),u=a*i*Me(r);LE.add(No(u,l)),_L=e,yL=s,vL=o}var Fn,ms,Gn,Ks,yh,Cee,Eee,_m,gv,Tf,Vu,Hu={point:bL,lineStart:xee,lineEnd:Aee,polygonStart:function(){Hu.point=Tee,Hu.lineStart=l3e,Hu.lineEnd=u3e,gv=new Wi,Ol.polygonStart()},polygonEnd:function(){Ol.polygonEnd(),Hu.point=bL,Hu.lineStart=xee,Hu.lineEnd=Aee,LE<0?(Fn=-(Gn=180),ms=-(Ks=90)):gv>Fe?Ks=90:gv<-Fe&&(ms=-90),Vu[0]=Fn,Vu[1]=Gn},sphere:function(){Fn=-(Gn=180),ms=-(Ks=90)}};function bL(e,t){Tf.push(Vu=[Fn=e,Gn=e]),t<ms&&(ms=t),t>Ks&&(Ks=t)}function See(e,t){var n=th([e*ct,t*ct]);if(_m){var i=tm(_m,n),s=tm([i[1],-i[0],0],i);YC(s),s=GC(s);var u,o=e-yh,a=o>0?1:-1,l=s[0]*Zn*a,c=Dt(o)>180;c^(a*yh<l&&l<a*e)?(u=s[1]*Zn)>Ks&&(Ks=u):c^(a*yh<(l=(l+360)%360-180)&&l<a*e)?(u=-s[1]*Zn)<ms&&(ms=u):(t<ms&&(ms=t),t>Ks&&(Ks=t)),c?e<yh?Js(Fn,e)>Js(Fn,Gn)&&(Gn=e):Js(e,Gn)>Js(Fn,Gn)&&(Fn=e):Gn>=Fn?(e<Fn&&(Fn=e),e>Gn&&(Gn=e)):e>yh?Js(Fn,e)>Js(Fn,Gn)&&(Gn=e):Js(e,Gn)>Js(Fn,Gn)&&(Fn=e)}else Tf.push(Vu=[Fn=e,Gn=e]);t<ms&&(ms=t),t>Ks&&(Ks=t),_m=n,yh=e}function xee(){Hu.point=See}function Aee(){Vu[0]=Fn,Vu[1]=Gn,Hu.point=bL,_m=null}function Tee(e,t){if(_m){var n=e-yh;gv.add(Dt(n)>180?n+(n>0?360:-360):n)}else Cee=e,Eee=t;Ol.point(e,t),See(e,t)}function l3e(){Ol.lineStart()}function u3e(){Tee(Cee,Eee),Ol.lineEnd(),Dt(gv)>Fe&&(Fn=-(Gn=180)),Vu[0]=Fn,Vu[1]=Gn,_m=null}function Js(e,t){return(t-=e)<0?t+360:t}function c3e(e,t){return e[0]-t[0]}function Oee(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var mv,BE,$E,VE,HE,UE,zE,GE,wL,DL,CL,Mee,Nee,zr,Gr,Wr,Sa={sphere:qi,point:EL,lineStart:kee,lineEnd:Iee,polygonStart:function(){Sa.lineStart=p3e,Sa.lineEnd=g3e},polygonEnd:function(){Sa.lineStart=kee,Sa.lineEnd=Iee}};function EL(e,t){e*=ct;var n=Le(t*=ct);_v(n*Le(e),n*Me(e),Me(t))}function _v(e,t,n){++mv,$E+=(e-$E)/mv,VE+=(t-VE)/mv,HE+=(n-HE)/mv}function kee(){Sa.point=d3e}function d3e(e,t){e*=ct;var n=Le(t*=ct);zr=n*Le(e),Gr=n*Me(e),Wr=Me(t),Sa.point=h3e,_v(zr,Gr,Wr)}function h3e(e,t){e*=ct;var n=Le(t*=ct),i=n*Le(e),r=n*Me(e),s=Me(t),o=No(Pr((o=Gr*s-Wr*r)*o+(o=Wr*i-zr*s)*o+(o=zr*r-Gr*i)*o),zr*i+Gr*r+Wr*s);BE+=o,UE+=o*(zr+(zr=i)),zE+=o*(Gr+(Gr=r)),GE+=o*(Wr+(Wr=s)),_v(zr,Gr,Wr)}function Iee(){Sa.point=EL}function p3e(){Sa.point=m3e}function g3e(){Ree(Mee,Nee),Sa.point=EL}function m3e(e,t){Mee=e,Nee=t,e*=ct,t*=ct,Sa.point=Ree;var n=Le(t);zr=n*Le(e),Gr=n*Me(e),Wr=Me(t),_v(zr,Gr,Wr)}function Ree(e,t){e*=ct;var n=Le(t*=ct),i=n*Le(e),r=n*Me(e),s=Me(t),o=Gr*s-Wr*r,a=Wr*i-zr*s,l=zr*r-Gr*i,u=oF(o,a,l),c=fs(u),f=u&&-c/u;wL.add(f*o),DL.add(f*a),CL.add(f*l),BE+=c,UE+=c*(zr+(zr=i)),zE+=c*(Gr+(Gr=r)),GE+=c*(Wr+(Wr=s)),_v(zr,Gr,Wr)}function Fee(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function w3e(e){return e instanceof BD?e:new BD(e)}const SL="intersect",Ml="_vgsid_",yv=rs(Ml),WE="index:unit";function jee(e,t){for(var o,a,n=t.fields,i=t.values,r=n.length,s=0;s<r;++s)if((a=n[s]).getter=rs.getter||rs(a.field),Pc(o=a.getter(e))&&(o=lr(o)),Pc(i[s])&&(i[s]=lr(i[s])),Pc(i[s][0])&&(i[s]=i[s].map(lr)),"E"===a.type){if(Z(i[s])?i[s].indexOf(o)<0:o!==i[s])return!1}else if("R"===a.type){if(!vg(o,i[s]))return!1}else if("R-RE"===a.type){if(!vg(o,i[s],!0,!1))return!1}else if("R-E"===a.type){if(!vg(o,i[s],!1,!1))return!1}else if("R-LE"===a.type&&!vg(o,i[s],!1,!0))return!1;return!0}const Bee=function y3e(e){let t=e,n=e,i=e;function r(a,l,u=0,c=a.length){if(u<c){if(0!==n(l,l))return c;do{const f=u+c>>>1;i(a[f],l)<0?u=f+1:c=f}while(u<c)}return u}return 2!==e.length&&(t=(a,l)=>e(a)-l,n=Fee,i=(a,l)=>Fee(e(a),l)),{left:r,center:function o(a,l,u=0,c=a.length){const f=r(a,l,u,c-1);return f>u&&t(a[f-1],l)>-t(a[f],l)?f-1:f},right:function s(a,l,u=0,c=a.length){if(u<c){if(0!==n(l,l))return c;do{const f=u+c>>>1;i(a[f],l)<=0?u=f+1:c=f}while(u<c)}return u}}}(yv),N3e=Bee.left,k3e=Bee.right;var xL={["".concat(Ml,"_union")]:function v3e(...e){const t=new BD;for(const n of e)for(const i of n)t.add(i);return t},["".concat(Ml,"_intersect")]:function b3e(e,...t){e=new BD(e),t=t.map(w3e);e:for(const n of e)for(const i of t)if(!i.has(n)){e.delete(n);continue e}return e},E_union:function(e,t){if(!e.length)return t;for(var n=0,i=t.length;n<i;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=lr(t[0]),i=lr(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<i&&(e[1]=i),e):[n,i]},R_intersect:function(e,t){var n=lr(t[0]),i=lr(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?i<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>i&&(e[1]=i),e):[n,i]}};function AL(e,t,n,i){t[0].type!==ph&&Q("First argument to selection functions must be a string literal.");const r=t[0].value,o="unit",a="@"+o,l=":"+r;(t.length>=2&&yt(t).value)===SL&&!Oe(i,a)&&(i[a]=n.getData(r).indataRef(n,o)),Oe(i,l)||(i[l]=n.getData(r).tuplesRef())}function $ee(e){const t=this.context.data[e];return t?t.values.value:[]}const vv=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},V3e=vv("format"),Vee=vv("timeFormat"),H3e=vv("utcFormat"),U3e=vv("timeParse"),z3e=vv("utcParse"),qE=new Date(2e3,0,1);function YE(e,t,n){return Number.isInteger(e)&&Number.isInteger(t)?(qE.setYear(2e3),qE.setMonth(e),qE.setDate(t),Vee.call(this,qE,n)):""}function OL(e,t,n,i){t[0].type!==ph&&Q("First argument to data functions must be a string literal.");const r=t[0].value,s=":"+r;if(!Oe(s,i))try{i[s]=n.getData(r).tuplesRef()}catch(o){}}function _s(e,t,n,i){if(t[0].type===ph)Uee(n,i,t[0].value);else for(e in n.scales)Uee(n,i,e)}function Uee(e,t,n){const i="%"+n;if(!Oe(t,i))try{t[i]=e.scaleRef(n)}catch(r){}}function Uu(e,t){let n;return Qe(e)?e:_e(e)?(n=t.scales[e])&&n.value:void 0}function ML(e,t){return function(n,i,r){if(n){const s=Uu(n,(r||this).context);return s&&s.path[e](i)}return t(i)}}const Z3e=ML("area",function a3e(e){return jE=new Wi,Pu(e,Ol),2*jE}),eje=ML("bounds",function f3e(e){var t,n,i,r,s,o,a;if(Ks=Gn=-(Fn=ms=1/0),Tf=[],Pu(e,Hu),n=Tf.length){for(Tf.sort(c3e),t=1,s=[i=Tf[0]];t<n;++t)Oee(i,(r=Tf[t])[0])||Oee(i,r[1])?(Js(i[0],r[1])>Js(i[0],i[1])&&(i[1]=r[1]),Js(r[0],i[1])>Js(i[0],i[1])&&(i[0]=r[0])):s.push(i=r);for(o=-1/0,t=0,i=s[n=s.length-1];t<=n;i=r,++t)(a=Js(i[1],(r=s[t])[0]))>o&&(o=a,Fn=r[0],Gn=i[1])}return Tf=Vu=null,Fn===1/0||ms===1/0?[[NaN,NaN],[NaN,NaN]]:[[Fn,ms],[Gn,Ks]]}),tje=ML("centroid",function _3e(e){mv=BE=$E=VE=HE=UE=zE=GE=0,wL=new Wi,DL=new Wi,CL=new Wi,Pu(e,Sa);var t=+wL,n=+DL,i=+CL,r=oF(t,n,i);return r<IC&&(t=UE,n=zE,i=GE,BE<Fe&&(t=$E,n=VE,i=HE),(r=oF(t,n,i))<IC)?[NaN,NaN]:[No(n,t)*Zn,fs(i/r)*Zn]});function NL(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(i){e.warn(i)}return n[n.length-1]}function kL(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function IL(e){const t=Qc(e);return.2126*kL(t.r)+.7152*kL(t.g)+.0722*kL(t.b)}function zee(e,t){return e===t||e!=e&&t!=t||(Z(e)?!(!Z(t)||e.length!==t.length)&&function lje(e,t){for(let n=0,i=e.length;n<i;++n)if(!zee(e[n],t[n]))return!1;return!0}(e,t):!(!Ce(e)||!Ce(t))&&Gee(e,t))}function Gee(e,t){for(const n in e)if(!zee(e[n],t[n]))return!1;return!0}function Wee(e){return t=>Gee(e,t)}const qee={};function RL(e){return Z(e)||ArrayBuffer.isView(e)?e:null}function FL(e){return RL(e)||(_e(e)?e:null)}const Yee=e=>e.data;function Kee(e,t){const n=$ee.call(t,e);return n.root&&n.root.lookup||{}}const Jee=()=>"undefined"!=typeof window&&window||null;function Xee(e,t,n){if(!e)return[];const[i,r]=e,s=(new ui).set(i[0],i[1],r[0],r[1]);return BJ(n||this.context.dataflow.scenegraph().root,s,function Rje(e){let t=null;if(e){const n=ve(e.marktype),i=ve(e.markname);t=r=>(!n.length||n.some(s=>r.marktype===s))&&(!i.length||i.some(s=>r.name===s))}return t}(t))}const bv={random:()=>xo(),cumulativeNormal:mD,cumulativeLogNormal:_k,cumulativeUniform:wk,densityNormal:dk,densityLogNormal:mk,densityUniform:bk,quantileNormal:_D,quantileLogNormal:yk,quantileUniform:Dk,sampleNormal:gD,sampleLogNormal:gk,sampleUniform:vk,isArray:Z,isBoolean:Fc,isDate:Pc,isDefined:e=>void 0!==e,isNumber:Xt,isObject:Ce,isRegExp:Tz,isString:_e,isTuple:aD,isValid:e=>null!=e&&e==e,toBoolean:r2,toDate:e=>s2(e),toNumber:lr,toString:o2,indexof:function pje(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return FL(e).indexOf(...n)},join:function hje(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return RL(e).join(...n)},lastindexof:function gje(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return FL(e).lastIndexOf(...n)},replace:function _je(e,t,n){return Qe(n)&&Q("Function argument passed to replace."),String(e).replace(t,n)},reverse:function yje(e){return RL(e).slice().reverse()},slice:function mje(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return FL(e).slice(...n)},flush:xz,lerp:Oz,merge:function aje(){const e=[].slice.call(arguments);return e.unshift({}),Ze(...e)},pad:kz,peek:yt,pluck:function dje(e,t){const n=qee[t]||(qee[t]=rs(t));return Z(e)?e.map(n):n(e)},span:I_,inrange:vg,truncate:Iz,rgb:Qc,lab:HD,hcl:UD,hsl:kD,luminance:IL,contrast:function oje(e,t){const n=IL(e),i=IL(t);return(Math.max(n,i)+.05)/(Math.min(n,i)+.05)},sequence:Vs,format:V3e,utcFormat:H3e,utcParse:z3e,utcOffset:vG,utcSequence:DG,timeFormat:Vee,timeParse:U3e,timeOffset:yG,timeSequence:wG,timeUnitSpecifier:aG,monthFormat:function G3e(e){return YE.call(this,e,1,"%B")},monthAbbrevFormat:function W3e(e){return YE.call(this,e,1,"%b")},dayFormat:function q3e(e){return YE.call(this,0,2+e,"%A")},dayAbbrevFormat:function Y3e(e){return YE.call(this,0,2+e,"%a")},quarter:Dz,utcquarter:Cz,week:uG,utcweek:dG,dayofyear:lG,utcdayofyear:fG,warn:function ije(){return NL(this.context.dataflow,"warn",arguments)},info:function rje(){return NL(this.context.dataflow,"info",arguments)},debug:function sje(){return NL(this.context.dataflow,"debug",arguments)},extent:e=>cl(e),inScope:function nje(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n},intersect:Xee,clampRange:Ez,pinchDistance:function cje(e){const t=e.touches,n=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+i*i)},pinchAngle:function fje(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)},screen:function Nje(){const e=Jee();return e?e.screen:{}},containerSize:function Ije(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]},windowSize:function kje(){const e=Jee();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]},bandspace:function vje(e,t,n){return BI(e||0,t||0,n||0)},setdata:function B3e(e,t){const n=this.context.dataflow;return n.pulse(this.context.data[e].input,n.changeset().remove(Co).insert(t)),1},pathShape:function Tje(e){let t=null;return function(n){return n?gy(n,t=t||Hg(e)):e}},panLinear:yz,panLog:vz,panPow:bz,panSymlog:wz,zoomLinear:XN,zoomLog:QN,zoomPow:Uw,zoomSymlog:ZN,encode:function $3e(e,t,n){if(e){const i=this.context.dataflow;i.pulse(e.mark.source,i.changeset().encode(e,t))}return void 0!==n?n:e},modify:function uje(e,t,n,i,r,s){const o=this.context.dataflow,a=this.context.data[e],l=a.input,u=o.stamp();let f,d,c=a.changes;if(!1===o._trigger||!(l.value.length||t||i))return 0;if((!c||c.stamp<u)&&(a.changes=c=o.changeset(),c.stamp=u,o.runAfter(()=>{a.modified=!0,o.pulse(l,c).run()},!0,1)),n&&(f=!0===n?Co:Z(n)||aD(n)?n:Wee(n),c.remove(f)),t&&c.insert(t),i&&(f=Wee(i),l.value.some(f)?c.remove(f):c.insert(i)),r)for(d in s)c.modify(r,d,s[d]);return 1},lassoAppend:function Fje(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;const r=e[e.length-1];return void 0===r||Math.sqrt((r[0]-t)**2+(r[1]-n)**2)>i?(e.push([t,n]),[...e]):e},lassoPath:function Pje(e){return(null!=e?e:[]).reduce((t,n,i)=>{let[r,s]=n;return t+(0==i?"M ".concat(r,",").concat(s," "):i===e.length-1?" Z":"L ".concat(r,",").concat(s," "))},"")},intersectLasso:function Lje(e,t,n){const{x:i,y:r,mark:s}=n,o=(new ui).set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[l,u]of t)l<o.x1&&(o.x1=l),l>o.x2&&(o.x2=l),u<o.y1&&(o.y1=u),u>o.y2&&(o.y2=u);return o.translate(i,r),Xee([[o.x1,o.y1],[o.x2,o.y2]],e,s).filter(l=>function jje(e,t,n){let i=0;for(let r=0,s=n.length-1;r<n.length;s=r++){const[o,a]=n[s],[l,u]=n[r];u>t!=a>t&&e<(o-l)*(t-u)/(a-u)+l&&i++}return 1&i}(l.x,l.y,t))}},Bje=["view","item","group","xy","x","y"],PL={},Zee={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>"_[".concat(fe("$"+e),"]"),functions:function Vje(e){const t=yee(e);Bje.forEach(n=>t[n]="event.vega."+n);for(const n in bv)t[n]="this."+n;return Ze(t,function Q3e(e,t,n){t.__bandwidth=r=>r&&r.bandwidth?r.bandwidth():0,n._bandwidth=_s,n._range=_s,n._scale=_s;const i=r=>"_["+(r.type===ph?fe("%"+r.value):fe("%")+"+"+e(r))+"]";return{_bandwidth:r=>"this.__bandwidth(".concat(i(r[0]),")"),_range:r=>"".concat(i(r[0]),".range()"),_scale:r=>"".concat(i(r[0]),"(").concat(e(r[1]),")")}}(e,bv,PL)),t},constants:_ee,visitors:PL},LL=vee(Zee);function ci(e,t,n){return 1===arguments.length?bv[e]:(bv[e]=t,n&&(PL[e]=n),LL&&(LL.functions[e]="this."+e),this)}function Nl(e,t){const n={};let i;try{i=mL(e=_e(e)?e:fe(e)+"")}catch(s){Q("Expression parse error: "+e)}i.visit(s=>{if(s.type!==iee)return;const o=s.callee.name,a=Zee.visitors[o];a&&a(o,s.arguments,t,n)});const r=LL(i);return r.globals.forEach(s=>{const o="$"+s;!Oe(n,o)&&t.getSignal(s)&&(n[o]=t.signalRef(s))}),{$expr:Ze({code:r.code},t.options.ast?{ast:i}:null),$fields:r.fields,$params:n}}ci("bandwidth",function bje(e,t){const n=Uu(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0},_s),ci("copy",function wje(e,t){const n=Uu(e,(t||this).context);return n?n.copy():void 0},_s),ci("domain",function Dje(e,t){const n=Uu(e,(t||this).context);return n?n.domain():[]},_s),ci("range",function Eje(e,t){const n=Uu(e,(t||this).context);return n&&n.range?n.range():[]},_s),ci("invert",function Cje(e,t,n){const i=Uu(e,(n||this).context);return i?Z(t)?(i.invertRange||i.invert)(t):(i.invert||i.invertExtent)(t):void 0},_s),ci("scale",function Sje(e,t,n){const i=Uu(e,(n||this).context);return i?i(t):void 0},_s),ci("gradient",function xje(e,t,n,i,r){e=Uu(e,(r||this).context);const s=SK(t,n);let o=e.domain(),a=o[0],l=yt(o),u=ar;return l-a?u=cK(e,a,l):e=(e.interpolator?kt("sequential")().interpolator(e.interpolator()):kt("linear")().interpolate(e.interpolate()).range(e.range())).domain([a=0,l=1]),e.ticks&&(o=e.ticks(+i||15),a!==o[0]&&o.unshift(a),l!==yt(o)&&o.push(l)),o.forEach(c=>s.stop(u(c),e(c))),s},_s),ci("geoArea",Z3e,_s),ci("geoBounds",eje,_s),ci("geoCentroid",tje,_s),ci("geoShape",function Aje(e,t,n){const i=Uu(e,(n||this).context);return function(r){return i?i.path.context(r)(t):""}},_s),ci("indata",function j3e(e,t,n){const i=this.context.data[e]["index:"+t],r=i?i.value.get(n):void 0;return r&&r.count},function X3e(e,t,n,i){t[0].type!==ph&&Q("First argument to indata must be a string literal."),t[1].type!==ph&&Q("Second argument to indata must be a string literal.");const r=t[0].value,s=t[1].value,o="@"+s;Oe(o,i)||(i[o]=n.getData(r).indataRef(n,s))}),ci("data",$ee,OL),ci("treePath",function Oje(e,t,n){const i=Kee(e,this),r=i[t],s=i[n];return r&&s?r.path(s).map(Yee):void 0},OL),ci("treeAncestors",function Mje(e,t){const n=Kee(e,this)[t];return n?n.ancestors().map(Yee):void 0},OL),ci("vlSelectionTest",function M3e(e,t,n){for(var u,c,f,d,h,i=this.context.data[e],r=i?i.values.value:[],s=i?i[WE]&&i[WE].value:void 0,o=n===SL,a=r.length,l=0;l<a;++l)if(u=r[l],s&&o){if(-1===(f=(c=c||{})[d=u.unit]||0))continue;if(h=jee(t,u),c[d]=h?-1:++f,h&&1===s.size)return!0;if(!h&&f===s.get(d).count)return!1}else if(o^(h=jee(t,u)))return h;return a&&o},AL),ci("vlSelectionIdTest",function I3e(e,t,n){const i=this.context.data[e],r=i?i.values.value:[],s=i?i[WE]&&i[WE].value:void 0,o=n===SL,a=yv(t),l=N3e(r,a);if(l===r.length||yv(r[l])!==a)return!1;if(s&&o){if(1===s.size)return!0;if(k3e(r,a)-l<s.size)return!1}return!0},AL),ci("vlSelectionResolve",function F3e(e,t,n,i){for(var u,c,f,d,h,p,g,m,_,y,D,C,r=this.context.data[e],s=r?r.values.value:[],o={},a={},l={},v=s.length,b=0;b<v;++b)if(d=(u=s[b]).unit,f=u.values,(c=u.fields)&&f){for(D=0,C=c.length;D<C;++D)m=(g=o[(h=c[D]).field]||(o[h.field]={}))[d]||(g[d]=[]),l[h.field]=_=h.type.charAt(0),y=xL["".concat(_,"_union")],g[d]=y(m,ve(f[D]));n&&(m=a[d]||(a[d]=[])).push(ve(f).reduce((w,E,O)=>(w[c[O].field]=E,w),{}))}else h=Ml,p=yv(u),(m=(g=o[h]||(o[h]={}))[d]||(g[d]=[])).push(p),n&&(m=a[d]||(a[d]=[])).push({[Ml]:p});return t=t||"union",o[Ml]?o[Ml]=xL["".concat(Ml,"_").concat(t)](...Object.values(o[Ml])):Object.keys(o).forEach(w=>{o[w]=Object.keys(o[w]).map(E=>o[w][E]).reduce((E,O)=>void 0===E?O:xL["".concat(l[w],"_").concat(t)](E,O))}),s=Object.keys(a),n&&s.length&&(o[i?"vlPoint":"vlMulti"]="union"===t?{or:s.reduce((E,O)=>(E.push(...a[O]),E),[])}:{and:s.map(E=>({or:a[E]}))}),o},AL),ci("vlSelectionTuples",function R3e(e,t){return e.map(n=>Ze(t.fields?{values:t.fields.map(i=>(i.getter||(i.getter=rs(i.field)))(n.datum))}:{[Ml]:yv(n.datum)},t))});const Uje=ua(["rule"]),ete=ua(["group","image","rect"]);function jL(e){return(e+"").toLowerCase()}function wv(e,t,n){";"!==n[n.length-1]&&(n="return("+n+");");const i=Function(...t.concat(n));return e&&e.functions?i.bind(e.functions):i}var Yje={operator:(e,t)=>wv(e,["_"],t.code),parameter:(e,t)=>wv(e,["datum","_"],t.code),event:(e,t)=>wv(e,["event"],t.code),handler:(e,t)=>wv(e,["_","event"],"var datum=event.item&&event.item.datum;return ".concat(t.code,";")),encode:(e,t)=>{const{marktype:n,channels:i}=t;let r="var o=item,datum=o.datum,m=0,$;";for(const s in i){const o="o["+fe(s)+"]";r+="$=".concat(i[s].code,";if(").concat(o,"!==$)").concat(o,"=$,m=1;")}return r+=function zje(e,t){let n="";return Uje[t]||(e.x2&&(e.x?(ete[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(ete[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(i,n),r+="return m;",wv(e,["item","_"],r)},codegen:{get(e){const t="[".concat(e.map(fe).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator(e,t){let n;const r=Function("a","b","var u, v; return "+e.map((s,o)=>{const a=t[o];let l,u;return s.path?(l="a".concat(s.path),u="b".concat(s.path)):((n=n||{})["f"+o]=s,l="this.f".concat(o,"(a)"),u="this.f".concat(o,"(b)")),function qje(e,t,n,i){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(i,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(i," : ")}(l,u,-a,a)}).join("")+"0;");return n?r.bind(n):r}}};function tte(e,t,n){if(!e||!Ce(e))return e;for(let s,i=0,r=nte.length;i<r;++i)if(s=nte[i],Oe(e,s.key))return s.parse(e,t,n);return e}var nte=[{key:"$ref",parse:function Qje(e,t){return t.get(e.$ref)||Q("Operator not defined: "+e.$ref)}},{key:"$key",parse:function eBe(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=n2(e.$key,e.$flat,t.expr.codegen))}},{key:"$expr",parse:function Zje(e,t,n){e.$params&&t.parseParameters(e.$params,n);const i="e:"+e.$expr.code+"_"+e.$name;return t.fn[i]||(t.fn[i]=is(t.parameterExpression(e.$expr),e.$fields,e.$name))}},{key:"$field",parse:function tBe(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=rs(e.$field,e.$name,t.expr.codegen))}},{key:"$encode",parse:function iBe(e,t){const n=e.$encode,i={};for(const r in n){const s=n[r];i[r]=is(t.encodeExpression(s.$expr),s.$fields),i[r].output=s.$output}return i}},{key:"$compare",parse:function nBe(e,t){const n="c:"+e.$compare+"_"+e.$order,i=ve(e.$compare).map(r=>r&&r.$tupleid?Ie:r);return t.fn[n]||(t.fn[n]=e2(i,e.$order,t.expr.codegen))}},{key:"$context",parse:function rBe(e,t){return t}},{key:"$subflow",parse:function sBe(e,t){const n=e.$subflow;return function(i,r,s){const o=t.fork().parse(n),a=o.get(n.operators[0].id),l=o.signals.parent;return l&&l.set(s),a.detachSubflow=()=>t.detach(o),a}}},{key:"$tupleid",parse:function oBe(){return Ie}}];const uBe={skip:!0};function ite(e,t,n,i){return new rte(e,t,n,i)}function rte(e,t,n,i){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=i||Yje,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function ste(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}function ote(e,t){e&&(null==t?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}rte.prototype=ste.prototype={fork(){const e=new ste(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,i=n.dataflow,r=e.value;if(n.set(e.id,t),function Wje(e){return"collect"===jL(e)}(e.type)&&r&&(r.$ingest?i.ingest(t,r.$ingest,r.$format):r.$request?i.preload(t,r.$request,r.$format):i.pulse(t,i.changeset().insert(r))),e.root&&(n.root=t),e.parent){let s=n.get(e.parent.$ref);s?(i.connect(s,[t]),t.targets().add(s)):(n.unresolved=n.unresolved||[]).push(()=>{s=n.get(e.parent.$ref),i.connect(s,[t]),t.targets().add(s)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const s in e.data){const o=n.data[s]||(n.data[s]={});e.data[s].forEach(a=>o[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[jL(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,i,r){this.dataflow.on(t,n,i,r,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:function Hje(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(i=>t.parseOperator(i)),n.forEach(i=>t.parseOperatorParameters(i)),(e.streams||[]).forEach(i=>t.parseStream(i)),(e.updates||[]).forEach(i=>t.parseUpdate(i)),t.resolve()},parseOperator:function Kje(e){const t=this;!function Gje(e){return"operator"===jL(e)}(e.type)&&e.type?t.transform(e,e.type):t.operator(e,e.update?t.operatorExpression(e.update):null)},parseOperatorParameters:function Jje(e){const t=this;if(e.params){const n=t.get(e.id);n||Q("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}},parseParameters:function Xje(e,t){t=t||{};const n=this;for(const i in e){const r=e[i];t[i]=Z(r)?r.map(s=>tte(s,n,t)):tte(r,n,t)}return t},parseStream:function aBe(e){var r,t=this,n=null!=e.filter?t.eventExpression(e.filter):void 0,i=null!=e.stream?t.get(e.stream):void 0;e.source?i=t.events(e.source,e.type,n):e.merge&&(i=(r=e.merge.map(s=>t.get(s)))[0].merge.apply(r[0],r.slice(1))),e.between&&(r=e.between.map(s=>t.get(s)),i=i.between(r[0],r[1])),e.filter&&(i=i.filter(n)),null!=e.throttle&&(i=i.throttle(+e.throttle)),null!=e.debounce&&(i=i.debounce(+e.debounce)),null==i&&Q("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),t.stream(e,i)},parseUpdate:function lBe(e){var r,t=this,n=Ce(n=e.source)?n.$ref:n,i=t.get(n),s=e.update,o=void 0;i||Q("Source not defined: "+e.source),r=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),s&&s.$expr&&(s.$params&&(o=t.parseParameters(s.$params)),s=t.handlerExpression(s.$expr)),t.update(e,i,r,s,o)},getState:function cBe(e){var t=this,n={};if(e.signals){var i=n.signals={};Object.keys(t.signals).forEach(s=>{const o=t.signals[s];e.signals(s,o)&&(i[s]=o.value)})}if(e.data){var r=n.data={};Object.keys(t.data).forEach(s=>{const o=t.data[s];e.data(s,o)&&(r[s]=o.input.value)})}return t.subcontext&&!1!==e.recurse&&(n.subcontext=t.subcontext.map(s=>s.getState(e))),n},setState:function fBe(e){var t=this,n=t.dataflow,i=e.data,r=e.signals;Object.keys(r||{}).forEach(s=>{n.update(t.signals[s],r[s],uBe)}),Object.keys(i||{}).forEach(s=>{n.pulse(t.data[s].input,n.changeset().remove(Co).insert(i[s]))}),(e.subcontext||[]).forEach((s,o)=>{const a=t.subcontext[o];a&&a.setState(s)})}};const BL="default";function $L(e,t){const n=e.globalCursor()?"undefined"!=typeof document&&document.body:e.container();if(n)return null==t?n.style.removeProperty("cursor"):n.style.cursor=t}function KE(e,t){var n=e._runtime.data;return Oe(n,t)||Q("Unrecognized data set: "+t),n[t]}function JE(e,t){cW(t)||Q("Second argument to changes must be a changeset.");const n=KE(this,e);return n.modified=!0,this.pulse(n.input,t)}function ate(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function lte(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function XE(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}const EBe={trap:!1};function cte(e,t,n,i){e._eventListeners.push({type:n,sources:ve(t),handler:i})}function QE(e,t,n){const i=e._eventConfig&&e._eventConfig[t];return!(!1===i||Ce(i)&&!i[n])||(e.warn("Blocked ".concat(t," ").concat(n," event listener.")),!1)}function fte(e){return e.item}function dte(e){return e.item.mark.source}function hte(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function Xs(e,t,n){const i=document.createElement(e);for(const r in t)i.setAttribute(r,t[r]);return null!=n&&(i.textContent=n),i}function IBe(e,t,n){if(!t)return;const i=n.param;let r=n.state;return r||(r=n.state={elements:null,active:!1,set:null,update:o=>{o!=e.signal(i.signal)&&e.runAsync(null,()=>{r.source=!0,e.signal(i.signal,o)})}},i.debounce&&(r.update=t2(i.debounce,r.update))),(null==i.input&&i.element?RBe:PBe)(r,t,i,e),r.active||(e.on(e._signals[i.signal],null,()=>{r.source?r.source=!1:r.set(e.signal(i.signal))}),r.active=!0),r}function RBe(e,t,n,i){const r=n.event||"input",s=()=>e.update(t.value);i.signal(n.signal,t.value),t.addEventListener(r,s),cte(i,t,r,s),e.set=o=>{t.value=o,t.dispatchEvent(function FBe(e){return"undefined"!=typeof Event?new Event(e):{type:e}}(r))}}function PBe(e,t,n,i){const r=i.signal(n.signal),s=Xs("div",{class:"vega-bind"}),o="radio"===n.input?s:s.appendChild(Xs("label"));o.appendChild(Xs("span",{class:"vega-bind-name"},n.name||n.signal)),t.appendChild(s);let a=LBe;switch(n.input){case"checkbox":a=jBe;break;case"select":a=BBe;break;case"radio":a=$Be;break;case"range":a=VBe}a(e,o,n,r)}function LBe(e,t,n,i){const r=Xs("input");for(const s in n)"signal"!==s&&"element"!==s&&r.setAttribute("input"===s?"type":s,n[s]);r.setAttribute("name",n.signal),r.value=i,t.appendChild(r),r.addEventListener("input",()=>e.update(r.value)),e.elements=[r],e.set=s=>r.value=s}function jBe(e,t,n,i){const r={type:"checkbox",name:n.signal};i&&(r.checked=!0);const s=Xs("input",r);t.appendChild(s),s.addEventListener("change",()=>e.update(s.checked)),e.elements=[s],e.set=o=>s.checked=!!o||null}function BBe(e,t,n,i){const r=Xs("select",{name:n.signal}),s=n.labels||[];n.options.forEach((o,a)=>{const l={value:o};ZE(o,i)&&(l.selected=!0),r.appendChild(Xs("option",l,(s[a]||o)+""))}),t.appendChild(r),r.addEventListener("change",()=>{e.update(n.options[r.selectedIndex])}),e.elements=[r],e.set=o=>{for(let a=0,l=n.options.length;a<l;++a)if(ZE(n.options[a],o))return void(r.selectedIndex=a)}}function $Be(e,t,n,i){const r=Xs("span",{class:"vega-bind-radio"}),s=n.labels||[];t.appendChild(r),e.elements=n.options.map((o,a)=>{const l={type:"radio",name:n.signal,value:o};ZE(o,i)&&(l.checked=!0);const u=Xs("input",l);u.addEventListener("change",()=>e.update(o));const c=Xs("label",{},(s[a]||o)+"");return c.prepend(u),r.appendChild(c),u}),e.set=o=>{const a=e.elements,l=a.length;for(let u=0;u<l;++u)ZE(a[u].value,o)&&(a[u].checked=!0)}}function VBe(e,t,n,i){i=void 0!==i?i:(+n.max+ +n.min)/2;const r=null!=n.max?n.max:Math.max(100,+i)||100,s=n.min||Math.min(0,r,+i)||0,o=n.step||jc(s,r,100),a=Xs("input",{type:"range",name:n.signal,min:s,max:r,step:o});a.value=i;const l=Xs("span",{},+i);t.appendChild(a),t.appendChild(l);const u=()=>{l.textContent=a.value,e.update(+a.value)};a.addEventListener("input",u),a.addEventListener("change",u),e.elements=[a],e.set=c=>{a.value=c,l.textContent=c}}function ZE(e,t){return e===t||e+""==t+""}function pte(e,t,n,i,r,s){return(t=t||new i(e.loader())).initialize(n,ate(e),lte(e),XE(e),r,s).background(e.background())}function VL(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function HL(e,t,n){if("string"==typeof t){if("undefined"==typeof document)return e.error("DOM document instance not found."),null;if(!(t=document.querySelector(t)))return e.error("Signal bind element not found: "+t),null}if(t&&n)try{t.textContent=""}catch(i){t=null,e.error(i)}return t}const Dv=e=>+e||0;function gte(e){return Ce(e)?{top:Dv(e.top),bottom:Dv(e.bottom),left:Dv(e.left),right:Dv(e.right)}:(e=>({top:e,bottom:e,left:e,right:e}))(Dv(e))}function UL(e,t,n,i){return zL.apply(this,arguments)}function zL(){return zL=kr(function*(e,t,n,i){const r=xC(t),s=r&&r.headless;return s||Q("Unrecognized renderer type: "+t),yield e.runAsync(),pte(e,null,null,s,n,i).renderAsync(e._scenegraph.root)}),zL.apply(this,arguments)}function GL(){return GL=kr(function*(e,t){e!==hf.Canvas&&e!==hf.SVG&&e!==hf.PNG&&Q("Unrecognized image type: "+e);const n=yield UL(this,e,t);return e===hf.SVG?WBe(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}),GL.apply(this,arguments)}function WBe(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}function WL(){return WL=kr(function*(e,t){return(yield UL(this,hf.Canvas,e,t)).canvas()}),WL.apply(this,arguments)}function qL(){return qL=kr(function*(e){return(yield UL(this,hf.SVG,e)).svg()}),qL.apply(this,arguments)}var YL="padding",yte={skip:!0};function vte(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===YL?i.left+i.right:0)}function bte(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===YL?i.top+i.bottom:0)}function e5e(e,t){return t.modified&&Z(t.input.value)&&e.indexOf("_:vega:_")}function t5e(e,t){return!("parent"===e||t instanceof Ng.proxy)}function r5e(e,t,n,i){const r=e.element();r&&r.setAttribute("title",function s5e(e){return null==e?"":Z(e)?wte(e):Ce(e)&&!Pc(e)?function o5e(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(Z(n)?wte(n):Dte(n))}).join("\n")}(e):e+""}(i))}function wte(e){return"["+e.map(Dte).join(", ")+"]"}function Dte(e){return Z(e)?"[\u2026]":Ce(e)&&!Pc(e)?"{\u2026}":e}function Cte(e,t){const n=this;if(t=t||{},Mg.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),null!=t.logLevel&&n.logLevel(t.logLevel),t.locale||e.locale){const s=Ze({},e.locale,t.locale);n.locale(QG(s.number,s.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||hf.Canvas,n._scenegraph=new OR;const i=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||r5e,n._redraw=!0,n._handler=(new Oy).scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function SBe(e){const t=Ze({defaults:{}},e),n=(i,r)=>{r.forEach(s=>{Z(i[s])&&(i[s]=ua(i[s]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const r=function KBe(e,t,n){return ite(e,Ng,bv,n).parse(t)}(n,e,t.expr);n._runtime=r,n._signals=r.signals,n._bind=(e.bindings||[]).map(s=>({state:null,param:Ze({},s)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=vte(n,n._width),n._viewHeight=bte(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function XBe(e){var t=e._signals,n=t.width,i=t.height,r=t[YL];function s(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=vte(e,a.size),s()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=bte(e,a.size),s()},{size:i});const o=e.add(null,s,{pad:r});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=i.rank+1,o.rank=r.rank+1}(n),function pBe(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}(n),function gBe(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:BL,item:null}));e.on(e.events("view","mousemove"),t,(n,i)=>{const r=t.value,s=r?_e(r)?r:r.user:BL,o=i.item&&i.item.cursor||null;return r&&s===r.user&&o==r.item?r:{user:s,item:o}}),e.add(null,function(n){let i=n.cursor,r=this.value;return _e(i)||(r=i.item,i=i.user),$L(e,i&&i!==BL?i:r||i),r},{cursor:t})}(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function eS(e,t){return Oe(e._signals,t)?e._signals[t]:Q("Unrecognized signal name: "+fe(t))}function Ete(e,t){const n=(e._targets||[]).filter(i=>i._update&&i._update.handler===t);return n.length?n[0]:null}function Ste(e,t,n,i){let r=Ete(n,i);return r||(r=VL(e,()=>i(t,n.value)),r.handler=i,e.on(n,null,r)),e}function xte(e,t,n){const i=Ete(t,n);return i&&t._targets.remove(i),e}ce(Cte,Mg,{evaluate(e,t,n){var i=this;return kr(function*(){if(yield Mg.prototype.evaluate.call(i,e,t),i._redraw||i._resize)try{i._renderer&&(i._resize&&(i._resize=0,function vBe(e){var t=XE(e),n=ate(e),i=lte(e);e._renderer.background(e.background()),e._renderer.resize(n,i,t),e._handler.origin(t),e._resizeListeners.forEach(r=>{try{r(n,i)}catch(s){e.error(s)}})}(i)),yield i._renderer.renderAsync(i._scenegraph.root)),i._redraw=!1}catch(r){i.error(r)}return n&&oD(i,n),i})()},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=null!=e?e+"":null;return t!==this._desc&&ote(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const i=eS(this,e);return 1===arguments.length?i.value:this.update(i,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",gte(e)):gte(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(xC(e)||Q("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Mg.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(eS(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function QBe(e,t,n,i,r,s){this.runAfter(o=>{let a=0;o._autosize=0,o.width()!==n&&(a=1,o.signal("width",n,yte),o._resizeWidth.skip(!0)),o.height()!==i&&(a=1,o.signal("height",i,yte),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),(o._origin[0]!==r[0]||o._origin[1]!==r[1])&&(o._resize=1,o._origin=r),a&&o.run("enter"),s&&o.runAfter(l=>l.resize())},!1,1)},addEventListener(e,t,n){let i=t;return n&&!1===n.trap||(i=VL(this,t),i.raw=t),this._handler.on(e,i),this},removeEventListener(e,t){for(var r,s,n=this._handler.handlers(e),i=n.length;--i>=0;)if(r=n[i].handler,e===(s=n[i].type)&&(t===r||t===r.raw)){this._handler.off(s,r);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return Ste(this,e,eS(this,e),t)},removeSignalListener(e,t){return xte(this,eS(this,e),t)},addDataListener(e,t){return Ste(this,e,KE(this,e).values,t)},removeDataListener(e,t){return xte(this,KE(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=$L(this,null);this._globalCursor=!!e,t&&$L(this,t)}return this}return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:function i5e(e,t){this._timers.push(function dBe(e,t,n){var i=new uE,r=t;return null==t?(i.restart(e,t,n),i):(i._restart=i.restart,i.restart=function(s,o,a){o=+o,a=null==a?qF():+a,i._restart(function l(u){u+=r,i._restart(l,r+=o,a),s(u)},o,a)},i.restart(e,t,n),i)}(function n(i){e({timestamp:Date.now(),elapsed:i})},t))},events:function ABe(e,t,n){var o,i=this,r=new fD(n),s=function(u,c){i.runAsync(null,()=>{"view"===e&&function xBe(e,t){var n=e._eventConfig.defaults,i=n.prevent,r=n.allow;return!1!==i&&!0!==r&&(!0===i||!1===r||(i?i[t]:r?!r[t]:e.preventDefault()))}(i,t)&&u.preventDefault(),r.receive(function bBe(e,t,n){var s,a,i=e._renderer,r=i&&i.canvas();return r&&(a=XE(e),(s=gC(t.changedTouches?t.changedTouches[0]:t,r))[0]-=a[0],s[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=function wBe(e,t,n){const i=t?"group"===t.mark.marktype?t:t.mark.group:null;function r(o){var l,a=i;if(o)for(l=t;l;l=l.mark.group)if(l.mark.name===o){a=l;break}return a&&a.mark&&a.mark.interactive?a:{}}function s(o){if(!o)return n;_e(o)&&(o=r(o));const a=n.slice();for(;o;)a[0]-=o.x||0,a[1]-=o.y||0,o=o.mark&&o.mark.group;return a}return{view:ur(e),item:ur(t||{}),group:r,xy:s,x:o=>s(o)[0],y:o=>s(o)[1]}}(e,n,s),t}(i,u,c))})};if("timer"===e)QE(i,"timer",t)&&i.timer(s,t);else if("view"===e)QE(i,"view",t)&&i.addEventListener(t,s,EBe);else if("window"===e?QE(i,"window",t)&&"undefined"!=typeof window&&(o=[window]):"undefined"!=typeof document&&QE(i,"selector",t)&&(o=document.querySelectorAll(e)),o){for(var a=0,l=o.length;a<l;++a)o[a].addEventListener(t,s);cte(i,o,t,s)}else i.warn("Can not resolve event source: "+e);return r},finalize:function OBe(){var i,r,s,e=this._tooltip,t=this._timers,n=this._eventListeners;for(i=t.length;--i>=0;)t[i].stop();for(i=n.length;--i>=0;)for(r=(s=n[i]).sources.length;--r>=0;)s.sources[r].removeEventListener(s.type,s.handler);return e&&e.call(this,this._handler,null,null,null),this},hover:function TBe(e,t){return t=[t||"update",(e=[e||"hover"])[0]],this.on(this.events("view","mouseover",fte),dte,hte(e)),this.on(this.events("view","mouseout",fte),dte,hte(t)),this},data:function mBe(e,t){return arguments.length<2?KE(this,e).values.value:JE.call(this,e,Ld().remove(Co).insert(t))},change:JE,insert:function _Be(e,t){return JE.call(this,e,Ld().insert(t))},remove:function yBe(e,t){return JE.call(this,e,Ld().remove(t))},scale:function JBe(e){var t=this._runtime.scales;return Oe(t,e)||Q("Unrecognized scale or projection: "+e),t[e].value},initialize:function UBe(e,t){const n=this,i=n._renderType,r=n._eventConfig.bind,s=xC(i);e=n._el=e?HL(n,e,!0):null,function hBe(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),ote(t,e.description()))}(n),s||n.error("Unrecognized renderer type: "+i);const o=s.handler||Oy,a=e?s.renderer:s.headless;return n._renderer=a?pte(n,n._renderer,e,a):null,n._handler=function HBe(e,t,n,i){const r=new i(e.loader(),VL(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,XE(e),e);return t&&t.handlers().forEach(s=>{r.on(s.type,s.handler)}),r}(n,n._handler,e,o),n._redraw=!0,e&&"none"!==r&&(t=t?n._elBind=HL(n,t,!0):e.appendChild(Xs("form",{class:"vega-bindings"})),n._bind.forEach(l=>{l.param.element&&"container"!==r&&(l.element=HL(n,l.param.element,!!l.param.input))}),n._bind.forEach(l=>{IBe(n,l.element||t,l)})),n},toImageURL:function GBe(e,t){return GL.apply(this,arguments)},toCanvas:function qBe(e,t){return WL.apply(this,arguments)},toSVG:function YBe(e){return qL.apply(this,arguments)},getState:function ZBe(e){return this._runtime.getState(e||{data:e5e,signals:t5e,recurse:!0})},setState:function n5e(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}});const f5e=/[[\]{}]/,d5e={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let Mte,Nte;function Of(e,t,n){return Mte=t||"view",Nte=n||d5e,kte(e.trim()).map(KL)}function Cv(e,t,n,i,r){const s=e.length;let a,o=0;for(;t<s;++t){if(a=e[t],!o&&a===n)return t;r&&r.indexOf(a)>=0?--o:i&&i.indexOf(a)>=0&&++o}return t}function kte(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=Cv(e,r,",","[{","]}"),t.push(e.substring(i,r).trim()),i=++r;if(0===t.length)throw"Empty event selector: "+e;return t}function KL(e){return"["===e[0]?function p5e(e){const t=e.length;let i,n=1;if(n=Cv(e,n,"]","[","]"),n===t)throw"Empty between selector: "+e;if(i=kte(e.substring(1,n)),2!==i.length)throw"Between selector must have two elements: "+e;if(">"!==(e=e.slice(n+1).trim())[0])throw"Expected '>' after between selector: "+e;i=i.map(KL);const r=KL(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}(e):function g5e(e){const t={source:Mte},n=[];let l,u,i=[0,0],r=0,s=0,o=e.length,a=0;if("}"===e[o-1]){if(a=e.lastIndexOf("{"),!(a>=0))throw"Unmatched right brace: "+e;try{i=function m5e(e){const t=e.split(",");if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!=i)throw e;return i})}(e.substring(a+1,o-1))}catch(c){throw"Invalid throttle specification: "+e}o=(e=e.slice(0,a).trim()).length,a=0}if(!o)throw e;if("@"===e[0]&&(r=++a),l=Cv(e,a,":"),l<o&&(n.push(e.substring(s,l).trim()),s=a=++l),a=Cv(e,a,"["),a===o)n.push(e.substring(s,o).trim());else if(n.push(e.substring(s,a).trim()),u=[],s=++a,s===o)throw"Unmatched left bracket: "+e;for(;a<o;){if(a=Cv(e,a,"]"),a===o)throw"Unmatched left bracket: "+e;if(u.push(e.substring(s,a).trim()),a<o-1&&"["!==e[++a])throw"Expected left bracket: "+e;s=++a}if(!(o=n.length)||f5e.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],r?t.markname=n[0].slice(1):function h5e(e){return Nte[e]}(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],"!"===t.type.slice(-1)&&(t.consume=!0,t.type=t.type.slice(0,-1)),null!=u&&(t.filter=u),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}(e)}function _5e(e){return Ce(e)?e:{type:e||"pad"}}const Ev=e=>+e||0;function v5e(e){return Ce(e)?e.signal?e:{top:Ev(e.top),bottom:Ev(e.bottom),left:Ev(e.left),right:Ev(e.right)}:(e=>({top:e,bottom:e,left:e,right:e}))(Ev(e))}const Fi=e=>Ce(e)&&!Z(e)?Ze({},e):{value:e};function Ite(e,t,n,i){return null!=n?(Ce(n)&&!Z(n)||Z(n)&&n.length&&Ce(n[0])?e.update[t]=n:e[i||"enter"][t]={value:n},1):0}function Ki(e,t,n){for(const i in t)Ite(e,i,t[i]);for(const i in n)Ite(e,i,n[i],"update")}function ym(e,t,n){for(const i in t)n&&Oe(n,i)||(e[i]=Ze(e[i]||{},t[i]));return e}function vm(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const JL="mark",XL="frame",QL="scope",Rte="legend-label";function ZL(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const Fte=e=>_e(e)?fe(e):e.signal?`(${e.signal})`:Pte(e);function iS(e){if(null!=e.gradient)return function L5e(e){const t=[e.start,e.stop,e.count].map(n=>null==n?null:fe(n));for(;t.length&&null==yt(t);)t.pop();return t.unshift(Fte(e.gradient)),`gradient(${t.join(",")})`}(e);let t=e.signal?`(${e.signal})`:e.color?function P5e(e){return e.c?rS("hcl",e.h,e.c,e.l):e.h||e.s?rS("hsl",e.h,e.s,e.l):e.l||e.a?rS("lab",e.l,e.a,e.b):e.r||e.g||e.b?rS("rgb",e.r,e.g,e.b):null}(e.color):null!=e.field?Pte(e.field):void 0!==e.value?fe(e.value):void 0;return null!=e.scale&&(t=function j5e(e,t){const n=Fte(e.scale);return null!=e.range?t=`lerp(_range(${n}), ${+e.range})`:(void 0!==t&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(1==+e.band?"":"*"+sS(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),null==t&&(t="0")),t}(e,t)),void 0===t&&(t=null),null!=e.exponent&&(t=`pow(${t},${sS(e.exponent)})`),null!=e.mult&&(t+=`*${sS(e.mult)}`),null!=e.offset&&(t+=`+${sS(e.offset)}`),e.round&&(t=`round(${t})`),t}const rS=(e,t,n,i)=>`(${e}(${[t,n,i].map(iS).join(",")})+'')`;function sS(e){return Ce(e)?"("+iS(e)+")":e}function Pte(e){return Lte(Ce(e)?e:{datum:e})}function Lte(e){let t,n,i;if(e.signal)t="datum",i=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(i=e.parent,t+=".datum"):i=e.group}else e.datum?(t="datum",i=e.datum):Q("Invalid field reference: "+fe(e));return e.signal||(i=_e(i)?ul(i).map(fe).join("]["):Lte(i)),t+"["+i+"]"}function jte(e,t,n,i,r,s){const o={};(s=s||{}).encoders={$encode:o},e=function F5e(e,t,n,i,r){const s={},o={};let a,l,u,c;for(l in l="lineBreak","text"===t&&null!=r[l]&&!vm(l,e)&&ZL(s,l,r[l]),("legend"==n||String(n).startsWith("axis"))&&(n=null),c=n===XL?r.group:n===JL?Ze({},r.mark,r[t]):null,c)u=vm(l,e)||("fill"===l||"stroke"===l)&&(vm("fill",e)||vm("stroke",e)),u||ZL(s,l,c[l]);for(l in ve(i).forEach(f=>{const d=r.style&&r.style[f];for(const h in d)vm(h,e)||ZL(s,h,d[h])}),e=Ze({},e),s)c=s[l],c.signal?(a=a||{})[l]=c:o[l]=c;return e.enter=Ze(o,e.enter),a&&(e.update=Ze(a,e.update)),e}(e,t,n,i,r.config);for(const a in e)o[a]=$5e(e[a],t,s,r);return s}function $5e(e,t,n,i){const r={},s={};for(const o in e)null!=e[o]&&(r[o]=H5e(V5e(e[o]),i,n,s));return{$expr:{marktype:t,channels:r},$fields:Object.keys(s),$output:Object.keys(e)}}function V5e(e){return Z(e)?function B5e(e){let t="";return e.forEach(n=>{const i=iS(n);t+=n.test?`(${n.test})?${i}:`:i}),":"===yt(t)&&(t+="null"),t}(e):iS(e)}function H5e(e,t,n,i){const r=Nl(e,t);return r.$fields.forEach(s=>i[s]=1),Ze(n,r.$params),r.$expr}const z5e=["value","update","init","react","bind"];function Bte(e,t){Q(e+' for "outer" push: '+fe(t))}function $te(e,t){const n=e.name;if("outer"===e.push)t.signals[n]||Bte("No prior signal definition",n),z5e.forEach(i=>{void 0!==e[i]&&Bte("Invalid property ",i)});else{const i=t.addSignal(n,e.value);!1===e.react&&(i.react=!1),e.bind&&t.addBinding(n,e.bind)}}function e3(e,t,n,i){this.id=-1,this.type=e,this.value=t,this.params=n,i&&(this.parent=i)}function oS(e,t,n,i){return new e3(e,t,n,i)}function aS(e,t){return oS("operator",e,t)}function Re(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function Sv(e,t){return t?{$field:e,$name:t}:{$field:e}}const t3=Sv("key");function Vte(e,t){return{$compare:e,$order:t}}function lS(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const n3="scope",r3="view";function Di(e){return e&&e.signal}function uS(e){if(Di(e))return!0;if(Ce(e))for(const t in e)if(uS(e[t]))return!0;return!1}function xa(e,t){return null!=e?e:t}function vh(e){return e&&e.signal||e}function xv(e,t){return(e.merge?X5e:e.stream?Q5e:e.type?Z5e:Q("Invalid stream specification: "+fe(e)))(e,t)}function X5e(e,t){const i=s3({merge:e.merge.map(r=>xv(r,t))},e,t);return t.addStream(i).id}function Q5e(e,t){const i=s3({stream:xv(e.stream,t)},e,t);return t.addStream(i).id}function Z5e(e,t){let n;"timer"===e.type?(n=t.event("timer",e.throttle),e={between:e.between,filter:e.filter}):n=t.event(function J5e(e){return e===n3?r3:e||r3}(e.source),e.type);const i=s3({stream:n},e,t);return 1===Object.keys(i).length?n:t.addStream(i).id}function s3(e,t,n){let i=t.between;return i&&(2!==i.length&&Q('Stream "between" parameter must have 2 entries: '+fe(t)),e.between=[xv(i[0],n),xv(i[1],n)]),i=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&i.push(function e$e(e,t,n){const i="event.item";return i+(e&&"*"!==e?"&&"+i+".mark.marktype==='"+e+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(t?"&&"+i+".mark.name==='"+t+"'":"")}(t.marktype,t.markname,t.markrole)),t.source===n3&&i.push("inScope(event.item)"),i.length&&(e.filter=Nl("("+i.join(")&&(")+")",n).$expr),null!=(i=t.throttle)&&(e.throttle=+i),null!=(i=t.debounce)&&(e.debounce=+i),t.consume&&(e.consume=!0),e}const t$e={code:"_.$value",ast:{type:"Identifier",value:"value"}};function r$e(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}const Qt=e=>(t,n,i)=>oS(e,n,t||void 0,i),Ute=Qt("aggregate"),o$e=Qt("axisticks"),zte=Qt("bound"),Aa=Qt("collect"),Gte=Qt("compare"),a$e=Qt("datajoin"),Wte=Qt("encode"),l$e=Qt("expression"),u$e=Qt("facet"),c$e=Qt("field"),f$e=Qt("key"),d$e=Qt("legendentries"),h$e=Qt("load"),p$e=Qt("mark"),g$e=Qt("multiextent"),m$e=Qt("multivalues"),_$e=Qt("overlap"),y$e=Qt("params"),qte=Qt("prefacet"),v$e=Qt("projection"),b$e=Qt("proxy"),w$e=Qt("relay"),Yte=Qt("render"),D$e=Qt("scale"),bh=Qt("sieve"),C$e=Qt("sortitems"),Kte=Qt("viewlayout"),E$e=Qt("values");let S$e=0;const Jte={min:"min",max:"max",count:"sum"};function A$e(e,t){const n=t.getScale(e.name).params;let i;for(i in n.domain=Xte(e.domain,e,t),null!=e.range&&(n.range=Zte(e,t,n)),null!=e.interpolate&&function L$e(e,t){t.interpolate=Io(e.type||e),null!=e.gamma&&(t.interpolateGamma=Io(e.gamma))}(e.interpolate,n),null!=e.nice&&(n.nice=function P$e(e){return Ce(e)?{interval:Io(e.interval),step:Io(e.step)}:Io(e)}(e.nice)),null!=e.bins&&(n.bins=function F$e(e,t){return e.signal||Z(e)?cS(e,t):t.objectProperty(e)}(e.bins,t)),e)Oe(n,i)||"name"===i||(n[i]=Io(e[i],t))}function Io(e,t){return Ce(e)?e.signal?t.signalRef(e.signal):Q("Unsupported object: "+fe(e)):e}function cS(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Io(n,t))}function fS(e){Q("Can not find data set: "+fe(e))}function Xte(e,t,n){if(e)return e.signal?n.signalRef(e.signal):(Z(e)?T$e:e.fields?M$e:O$e)(e,t,n);(null!=t.domainMin||null!=t.domainMax)&&Q("No scale domain defined for domainMin/domainMax to override.")}function T$e(e,t,n){return e.map(i=>Io(i,n))}function O$e(e,t,n){const i=n.getData(e.data);return i||fS(e.data),Vg(t.type)?i.valuesRef(n,e.field,Qte(e.sort,!1)):aK(t.type)?i.domainRef(n,e.field):i.extentRef(n,e.field)}function M$e(e,t,n){const i=e.data,r=e.fields.reduce((s,o)=>(o=_e(o)?{data:i,field:o}:Z(o)||o.signal?function N$e(e,t){const n="_:vega:_"+S$e++,i=Aa({});if(Z(e))i.value={$ingest:e};else if(e.signal){const r="setdata("+fe(n)+","+e.signal+")";i.params.input=t.signalRef(r)}return t.addDataPipeline(n,[i,bh({})]),{data:n,field:"data"}}(o,n):o,s.push(o),s),[]);return(Vg(t.type)?k$e:aK(t.type)?I$e:R$e)(e,n,r)}function k$e(e,t,n){const i=Qte(e.sort,!0);let r,s;const o=n.map(u=>{const c=t.getData(u.data);return c||fS(u.data),c.countsRef(t,u.field,i)}),a={groupby:t3,pulse:o};i&&(r=i.op||"count",s=i.field?lS(r,i.field):"count",a.ops=[Jte[r]],a.fields=[t.fieldRef(s)],a.as=[s]),r=t.add(Ute(a));const l=t.add(Aa({pulse:Re(r)}));return s=t.add(E$e({field:t3,sort:t.sortRef(i),pulse:Re(l)})),Re(s)}function Qte(e,t){return e&&(e.field||e.op?e.field||"count"===e.op?t&&e.field&&e.op&&!Jte[e.op]&&Q("Multiple domain scales can not be sorted using "+e.op):Q("No field provided for sort aggregate op: "+e.op):Ce(e)?e.field="key":e={field:"key"}),e}function I$e(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||fS(r.data),s.domainRef(t,r.field)});return Re(t.add(m$e({values:i})))}function R$e(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||fS(r.data),s.extentRef(t,r.field)});return Re(t.add(g$e({extents:i})))}function Zte(e,t,n){const i=t.config.range;let r=e.range;if(r.signal)return t.signalRef(r.signal);if(_e(r)){if(i&&Oe(i,r))return Zte(e=Ze({},e,{range:i[r]}),t,n);"width"===r?r=[0,{signal:"width"}]:"height"===r?r=Vg(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:Q("Unrecognized scale range value: "+fe(r))}else{if(r.scheme)return n.scheme=Z(r.scheme)?cS(r.scheme,t):Io(r.scheme,t),r.extent&&(n.schemeExtent=cS(r.extent,t)),void(r.count&&(n.schemeCount=Io(r.count,t)));if(r.step)return void(n.rangeStep=Io(r.step,t));if(Vg(e.type)&&!Z(r))return Xte(r,e,t);Z(r)||Q("Unsupported range type: "+fe(r))}return r.map(s=>(Z(s)?cS:Io)(s,t))}function o3(e,t,n){return Z(e)?e.map(i=>o3(i,t,n)):Ce(e)?e.signal?n.signalRef(e.signal):"fit"===t?e:Q("Unsupported parameter object: "+fe(e)):e}const Ta="top",Mf="bottom",l3="label",Ro="value",Av="guide-label",u3="guide-title",dS="gradient",c3="discrete",d3=["size","shape","fill","stroke","strokeWidth","strokeDash","opacity"],Tv={name:1,style:1,interactive:1},Et={value:0},Fo={value:1},hS="group",h3="rule",wh="text";function Ov(e){return e.type=hS,e.interactive=e.interactive||!1,e}function ys(e,t){const n=(i,r)=>xa(e[i],xa(t[i],r));return n.isVertical=i=>"vertical"===xa(e.direction,t.direction||(i?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>xa(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>xa(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>xa(e.columns,xa(t.columns,+n.isVertical(!0))),n}function ine(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function pS(e,t,n){return`item.anchor === 'start' ? ${e} : item.anchor === 'end' ? ${t} : ${n}`}const p3=pS(fe("left"),fe("right"),fe("center"));function rne(e,t){return t?e?Ce(e)?Object.assign({},e,{offset:rne(e.offset,t)}):{value:e,offset:t}:t:e}function Qs(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=ym(e.encode,t,Tv)):e.interactive=!1,e}function J$e(e,t,n,i){const r=ys(e,n),s=r.isVertical(),o=r.gradientThickness(),a=r.gradientLength();let l,u,c,f,d;s?(u=[0,1],c=[0,0],f=o,d=a):(u=[0,0],c=[1,0],f=a,d=o);const h={enter:l={opacity:Et,x:Et,y:Et,width:Fi(f),height:Fi(d)},update:Ze({},l,{opacity:Fo,fill:{gradient:t,start:u,stop:c}}),exit:{opacity:Et}};return Ki(h,{stroke:r("gradientStrokeColor"),strokeWidth:r("gradientStrokeWidth")},{opacity:r("gradientOpacity")}),Qs({type:"rect",role:"legend-gradient",encode:h},i)}function X$e(e,t,n,i,r){const s=ys(e,n),o=s.isVertical(),a=s.gradientThickness(),l=s.gradientLength();let u,c,f,d,h="";o?(u="y",f="y2",c="x",d="width",h="1-"):(u="x",f="x2",c="y",d="height");const p={opacity:Et,fill:{scale:t,field:Ro}};p[u]={signal:h+"datum.perc",mult:l},p[c]=Et,p[f]={signal:h+"datum.perc2",mult:l},p[d]=Fi(a);const g={enter:p,update:Ze({},p,{opacity:Fo}),exit:{opacity:Et}};return Ki(g,{stroke:s("gradientStrokeColor"),strokeWidth:s("gradientStrokeWidth")},{opacity:s("gradientOpacity")}),Qs({type:"rect",role:"legend-band",key:Ro,from:r,encode:g},i)}const Z$e=`datum.perc<=0?"${Mf}":datum.perc>=1?"top":"middle"`;function sne(e,t,n,i){const r=ys(e,t),s=r.isVertical(),o=Fi(r.gradientThickness()),a=r.gradientLength();let u,c,f,d,l=r("labelOverlap"),h="";const p={enter:u={opacity:Et},update:c={opacity:Fo,text:{field:l3}},exit:{opacity:Et}};return Ki(p,{fill:r("labelColor"),fillOpacity:r("labelOpacity"),font:r("labelFont"),fontSize:r("labelFontSize"),fontStyle:r("labelFontStyle"),fontWeight:r("labelFontWeight"),limit:xa(e.labelLimit,t.gradientLabelLimit)}),s?(u.align={value:"left"},u.baseline=c.baseline={signal:Z$e},f="y",d="x",h="1-"):(u.align=c.align={signal:'datum.perc<=0?"left":datum.perc>=1?"right":"center"'},u.baseline={value:"top"},f="x",d="y"),u[f]=c[f]={signal:h+"datum.perc",mult:a},u[d]=c[d]=o,o.offset=xa(e.labelOffset,t.gradientLabelOffset)||0,l=l?{separation:r("labelSeparation"),method:l,order:"datum.index"}:void 0,Qs({type:wh,role:Rte,style:Av,key:Ro,from:i,encode:p,overlap:l},n)}function e8e(e,t,n,i,r){const s=ys(e,t),o=n.entries,a=!(!o||!o.interactive),l=o?o.name:void 0,u=s("clipHeight"),c=s("symbolOffset"),f={data:"value"},d=`(${r}) ? datum.offset : datum.size`,h=u?Fi(u):{field:"size"},p="datum.index",g=`max(1, ${r})`;let m,_,y,v,b;h.mult=.5,m={enter:_={opacity:Et,x:{signal:d,mult:.5,offset:c},y:h},update:y={opacity:Fo,x:_.x,y:_.y},exit:{opacity:Et}};let D=null,C=null;e.fill||(D=t.symbolBaseFillColor,C=t.symbolBaseStrokeColor),Ki(m,{fill:s("symbolFillColor",D),shape:s("symbolType"),size:s("symbolSize"),stroke:s("symbolStrokeColor",C),strokeDash:s("symbolDash"),strokeDashOffset:s("symbolDashOffset"),strokeWidth:s("symbolStrokeWidth")},{opacity:s("symbolOpacity")}),d3.forEach(M=>{e[M]&&(y[M]=_[M]={scale:e[M],field:Ro})});const w=Qs({type:"symbol",role:"legend-symbol",key:Ro,from:f,clip:!!u||void 0,encode:m},n.symbols),E=Fi(c);E.offset=s("labelOffset"),m={enter:_={opacity:Et,x:{signal:d,offset:E},y:h},update:y={opacity:Fo,text:{field:l3},x:_.x,y:_.y},exit:{opacity:Et}},Ki(m,{align:s("labelAlign"),baseline:s("labelBaseline"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontStyle:s("labelFontStyle"),fontWeight:s("labelFontWeight"),limit:s("labelLimit")});const O=Qs({type:wh,role:Rte,style:Av,key:Ro,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!u},width:Et,height:u?Fi(u):Et,opacity:Et},exit:{opacity:Et},update:y={opacity:Fo,row:{signal:null},column:{signal:null}}},s.isVertical(!0)?(v=`ceil(item.mark.items.length / ${g})`,y.row.signal=`${p}%${v}`,y.column.signal=`floor(${p} / ${v})`,b={field:["row",p]}):(y.row.signal=`floor(${p} / ${g})`,y.column.signal=`${p} % ${g}`,b={field:p}),y.column.signal=`(${r})?${y.column.signal}:${p}`,Ov({role:QL,from:i={facet:{data:i,name:"value",groupby:"index"}},encode:ym(m,o,Tv),marks:[w,O],name:l,interactive:a,sort:b})}const g3='item.orient === "left"',m3='item.orient === "right"',gS=`(${g3} || ${m3})`,n8e=`datum.vgrad && ${gS}`,i8e=pS('"top"','"bottom"','"middle"'),s8e=`datum.vgrad && ${m3} ? (${pS('"right"','"left"','"center"')}) : (${gS} && !(datum.vgrad && ${g3})) ? "left" : ${p3}`,o8e=`item._anchor || (${gS} ? "middle" : "start")`,a8e=`${n8e} ? (${g3} ? -90 : 90) : 0`,l8e=`${gS} ? (datum.vgrad ? (${m3} ? "bottom" : "top") : ${i8e}) : "top"`;function c8e(e,t){let n;return Ce(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+one(e.path)+")":e.sphere&&(n="geoShape("+one(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function one(e){return Ce(e)&&e.signal?e.signal:fe(e)}function ane(e){const t=e.role||"";return t.indexOf("axis")&&t.indexOf("legend")&&t.indexOf("title")?e.type===hS?QL:t||JL:t}function f8e(e){return{marktype:e.type,name:e.name||void 0,role:e.role||ane(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function d8e(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e}function _3(e,t){const n=vW(e.type);n||Q("Unrecognized transform type: "+fe(e.type));const i=oS(n.type.toLowerCase(),null,lne(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(i)),i.metadata=n.metadata||{},i}function lne(e,t,n){const i={},r=e.params.length;for(let s=0;s<r;++s){const o=e.params[s];i[o.name]=h8e(o,t,n)}return i}function h8e(e,t,n){const i=e.type,r=t[e.name];return"index"===i?function p8e(e,t,n){return _e(t.from)||Q('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}(0,t,n):void 0!==r?"param"===i?function g8e(e,t,n){const i=t[e.name];return e.array?(Z(i)||Q("Expected an array of sub-parameters. Instead: "+fe(i)),i.map(r=>cne(e,r,n))):cne(e,i,n)}(e,t,n):"projection"===i?n.projectionRef(t[e.name]):e.array&&!Di(r)?r.map(s=>une(e,s,n)):une(e,r,n):void(e.required&&Q("Missing required "+fe(t.type)+" parameter: "+fe(e.name)))}function une(e,t,n){const i=e.type;if(Di(t))return fne(i)?Q("Expression references can not be signals."):y3(i)?n.fieldRef(t):dne(i)?n.compareRef(t):n.signalRef(t.signal);{const r=e.expr||y3(i);return r&&m8e(t)?n.exprRef(t.expr,t.as):r&&_8e(t)?Sv(t.field,t.as):fne(i)?Nl(t,n):y8e(i)?Re(n.getData(t).values):y3(i)?Sv(t):dne(i)?n.compareRef(t):t}}function cne(e,t,n){const i=e.params.length;let r;for(let o=0;o<i;++o){r=e.params[o];for(const a in r.key)if(r.key[a]!==t[a]){r=null;break}if(r)break}r||Q("Unsupported parameter: "+fe(t));const s=Ze(lne(r,t,n),r.key);return Re(n.add(y$e(s)))}const m8e=e=>e&&e.expr,_8e=e=>e&&e.field,y8e=e=>"data"===e,fne=e=>"expr"===e,y3=e=>"field"===e,dne=e=>"compare"===e;function mS(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:Re(t.getData(e.data).output)}function Dh(e,t,n,i,r){this.scope=e,this.input=t,this.output=n,this.values=i,this.aggregate=r,this.index={}}function hne(e){return _e(e)?e:null}function pne(e,t,n){const i=lS(n.op,n.field);let r;if(t.ops){for(let s=0,o=t.as.length;s<o;++s)if(t.as[s]===i)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(i))}function Mv(e,t,n,i,r,s,o){const a=t[n]||(t[n]={}),l=function Y5e(e){return Ce(e)?("descending"===e.order?"-":"+")+lS(e.op,e.field):""}(s);let c,f,u=hne(r);if(null!=u&&(e=t.scope,u+=l?"|"+l:"",c=a[u]),!c){const d=s?{field:t3,pulse:t.countsRef(e,r,s)}:{field:e.fieldRef(r),pulse:Re(t.output)};l&&(d.sort=e.sortRef(s)),f=e.add(oS(i,void 0,d)),o&&(t.index[r]=f),c=Re(f),null!=u&&(a[u]=c)}return c}function gne(e,t,n){const i=e.remove,r=e.insert,s=e.toggle,o=e.modify,a=e.values,l=t.add(aS()),c=Nl("if("+e.trigger+',modify("'+n+'",'+[r,i,s,o,a].map(f=>null==f?"null":f).join(",")+"),0)",t);l.update=c.$expr,l.params=c.$params}function _S(e,t){const n=ane(e),i=e.type===hS,r=e.from&&e.from.facet,s=e.overlap;let a,l,u,c,f,d,h,o=e.layout||n===QL||n===XL;const p=n===JL||o||r,g=function v8e(e,t,n){let i,r,s,o,a;return e?(i=e.facet)&&(t||Q("Only group marks can be faceted."),null!=i.field?o=a=mS(i,n):(e.data?a=Re(n.getData(e.data).aggregate):(s=_3(Ze({type:"aggregate",groupby:ve(i.groupby)},i.aggregate),n),s.params.key=n.keyRef(i.groupby),s.params.pulse=mS(i,n),o=a=Re(n.add(s))),r=n.keyRef(i.groupby,!0))):o=Re(n.add(Aa(null,[{}]))),o||(o=mS(e,n)),{key:r,pulse:o,parent:a}}(e.from,i,t);l=t.add(a$e({key:g.key||(e.key?Sv(e.key):void 0),pulse:g.pulse,clean:!i}));const m=Re(l);l=u=t.add(Aa({pulse:m})),l=t.add(p$e({markdef:f8e(e),interactive:d8e(e.interactive,t),clip:c8e(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:Re(l)}));const _=Re(l);l=c=t.add(Wte(jte(e.encode,e.type,n,e.style,t,{mod:!1,pulse:_}))),l.params.parent=t.encode(),e.transform&&e.transform.forEach(C=>{const w=_3(C,t),E=w.metadata;(E.generates||E.changes)&&Q("Mark transforms should not generate new data."),E.nomod||(c.params.mod=!0),w.params.pulse=Re(l),t.add(l=w)}),e.sort&&(l=t.add(C$e({sort:t.compareRef(e.sort),pulse:Re(l)})));const y=Re(l);(r||o)&&(o=t.add(Kte({layout:t.objectProperty(e.layout),legends:t.legends,mark:_,pulse:y})),d=Re(o));const v=t.add(zte({mark:_,pulse:d||y}));h=Re(v),i&&(p&&(a=t.operators,a.pop(),o&&a.pop()),t.pushState(y,d||h,m),r?function b8e(e,t,n){const i=e.from.facet,r=i.name,s=mS(i,t);let o;i.name||Q("Facet must have a name: "+fe(i)),i.data||Q("Facet must reference a data set: "+fe(i)),i.field?o=t.add(qte({field:t.fieldRef(i.field),pulse:s})):i.groupby?o=t.add(u$e({key:t.keyRef(i.groupby),group:Re(t.proxy(n.parent)),pulse:s})):Q("Facet must specify groupby or field: "+fe(i));const a=t.fork(),l=a.add(Aa()),u=a.add(bh({pulse:Re(l)}));a.addData(r,new Dh(a,l,l,u)),a.addSignal("parent",null),o.params.subflow={$subflow:a.parse(e).toRuntime()}}(e,t,g):p?function w8e(e,t,n){const i=t.add(qte({pulse:n.pulse})),r=t.fork();r.add(bh()),r.addSignal("parent",null),i.params.subflow={$subflow:r.parse(e).toRuntime()}}(e,t,g):t.parse(e),t.popState(),p&&(o&&a.push(o),a.push(v))),s&&(h=function D8e(e,t,n){const i=e.method,r=e.bound,s=e.separation,o={separation:Di(s)?n.signalRef(s.signal):s,method:Di(i)?n.signalRef(i.signal):i,pulse:t};if(e.order&&(o.sort=n.compareRef({field:e.order})),r){const a=r.tolerance;o.boundTolerance=Di(a)?n.signalRef(a.signal):+a,o.boundScale=n.scaleRef(r.scale),o.boundOrient=r.orient}return Re(n.add(_$e(o)))}(s,h,t));const b=t.add(Yte({pulse:h})),D=t.add(bh({pulse:Re(b)},void 0,t.parent()));null!=e.name&&(f=e.name,t.addData(f,new Dh(t,u,b,D)),e.on&&e.on.forEach(C=>{(C.insert||C.remove||C.toggle)&&Q("Marks only support modify triggers."),gne(C,t,f)}))}function x8e(e,t,n){const i={enter:{},update:{}};return Ki(i,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),i}function mne(e,t,n){return t[e]?`scale("${t[e]}",datum)`:ine(e,n[0].encode)}function k8e(e,t){const n={enter:{},update:{}};return Ki(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:p3},angle:{signal:'item.orient==="left"?-90:item.orient==="right"?90:0'},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),ym(n,t,Tv)}function Ch(e){const t=Aa({},e);return t.metadata={source:!0},t}function _ne(e,t){return h$e({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}Dh.fromEntries=function(e,t){const n=t.length,i=t[n-1],r=t[n-2];let s=t[0],o=null,a=1;for(s&&"load"===s.type&&(s=t[1]),e.add(t[0]);a<n;++a)t[a].params.pulse=Re(t[a-1]),e.add(t[a]),"aggregate"===t[a].type&&(o=t[a]);return new Dh(e,s,r,i,o)},Dh.prototype={countsRef(e,t,n){const i=this,r=i.counts||(i.counts={}),s=hne(t);let o,a,l;return null!=s&&(e=i.scope,o=r[s]),o?n&&n.field&&pne(e,o.agg.params,n):(l={groupby:e.fieldRef(t,"key"),pulse:Re(i.output)},n&&n.field&&pne(e,l,n),a=e.add(Ute(l)),o=e.add(Aa({pulse:Re(a)})),o={agg:a,ref:Re(o)},null!=s&&(r[s]=o)),o.ref},tuplesRef(){return Re(this.values)},extentRef(e,t){return Mv(e,this,"extent","extent",t,!1)},domainRef(e,t){return Mv(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return Mv(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return Mv(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return Mv(e,this,"indata","tupleindex",t,!0,!0)}};const yne=e=>e===Mf||e===Ta,yS=(e,t,n)=>Di(e)?$8e(e.signal,t,n):"left"===e||e===Ta?t:n,Pi=(e,t,n)=>Di(e)?j8e(e.signal,t,n):yne(e)?t:n,Oa=(e,t,n)=>Di(e)?B8e(e.signal,t,n):yne(e)?n:t,vne=(e,t,n)=>Di(e)?V8e(e.signal,t,n):e===Ta?{value:t}:{value:n},j8e=(e,t,n)=>bne(`${e} === 'top' || ${e} === '${Mf}'`,t,n),B8e=(e,t,n)=>bne(`${e} !== 'top' && ${e} !== '${Mf}'`,t,n),$8e=(e,t,n)=>v3(`${e} === 'left' || ${e} === 'top'`,t,n),V8e=(e,t,n)=>v3(`${e} === 'top'`,t,n),bne=(e,t,n)=>(t=null!=t?Fi(t):t,n=null!=n?Fi(n):n,wne(t)&&wne(n)?{signal:`${e} ? (${t=t?t.signal||fe(t.value):null}) : (${n=n?n.signal||fe(n.value):null})`}:[Ze({test:e},t)].concat(n||[])),wne=e=>null==e||1===Object.keys(e).length,v3=(e,t,n)=>({signal:`${e} ? (${Cm(t)}) : (${Cm(n)})`}),U8e=(e,t,n,i,r)=>({signal:(null!=i?`${e} === 'left' ? (${Cm(i)}) : `:"")+(null!=n?`${e} === '${Mf}' ? (${Cm(n)}) : `:"")+(null!=r?`${e} === 'right' ? (${Cm(r)}) : `:"")+(null!=t?`${e} === 'top' ? (${Cm(t)}) : `:"")+"(null)"}),Cm=e=>Di(e)?e.signal:null==e?null:fe(e),Em=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function Sm(e,t,n,i){let r;if(t&&Oe(t,e))return t[e];if(Oe(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=e[5].toLowerCase()+e.slice(6)}return i[u3][r]}if(e.startsWith("label")){switch(e){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=e[5].toLowerCase()+e.slice(6)}return i[Av][r]}return null}function Dne(e){const t={};for(const n of e)if(n)for(const i in n)t[i]=1;return Object.keys(t)}function Cne(e,t){return{scale:e.scale,range:t}}function b3(e,t,n,i,r){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+i+","+r+")"}}function J8e(e,t,n,i,r,s){const o=ys(e,t),a=e.orient,l=e.scale,u=yS(a,-1,1),c=vh(o("labelFlush")),f=vh(o("labelFlushOffset")),d=o("labelAlign"),h=o("labelBaseline");let g,p=0===c||!!c;const m=Fi(r);m.mult=u,m.offset=Fi(o("labelPadding")||0),m.offset.mult=u;const _={scale:l,field:Ro,band:.5,offset:rne(s.offset,o("labelOffset"))},y=Pi(a,p?b3(l,c,'"left"','"right"','"center"'):{value:"center"},((e,t,n)=>Di(e)?((e,t,n)=>v3(`${e} === 'right'`,t,n))(e.signal,t,n):"right"===e?{value:t}:{value:n})(a,"left","right")),v=Pi(a,vne(a,"bottom","top"),p?b3(l,c,'"top"','"bottom"','"middle"'):{value:"middle"}),b=b3(l,c,`-(${f})`,f,0);p=p&&f;const D={opacity:Et,x:Pi(a,_,m),y:Oa(a,_,m)},C={enter:D,update:g={opacity:Fo,text:{field:l3},x:D.x,y:D.y,align:y,baseline:v},exit:{opacity:Et,x:D.x,y:D.y}};Ki(C,{dx:!d&&p?Pi(a,b):null,dy:!h&&p?Oa(a,b):null}),Ki(C,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:d,baseline:h});const w=o("labelBound");let E=o("labelOverlap");return E=E||w?{separation:o("labelSeparation"),method:E,order:"datum.index",bound:w?{scale:l,orient:a,tolerance:w}:null}:void 0,g.align!==y&&(g.align=Em(g.align,y)),g.baseline!==v&&(g.baseline=Em(g.baseline,v)),Qs({type:wh,role:"axis-label",style:Av,key:Ro,from:i,encode:C,overlap:E},n)}function Z8e(e,t){const n=function G8e(e,t){var a,l,u,n=t.config,i=n.style,r=n.axis,s="band"===t.scaleType(e.scale)&&n.axisBand,o=e.orient;if(Di(o)){const f=Dne([n.axisX,n.axisY]),d=Dne([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);for(u of(a={},f))a[u]=Pi(o,Sm(u,n.axisX,r,i),Sm(u,n.axisY,r,i));for(u of(l={},d))l[u]=U8e(o.signal,Sm(u,n.axisTop,r,i),Sm(u,n.axisBottom,r,i),Sm(u,n.axisLeft,r,i),Sm(u,n.axisRight,r,i))}else a=o===Ta||o===Mf?n.axisX:n.axisY,l=n["axis"+o[0].toUpperCase()+o.slice(1)];return a||l||s?Ze({},r,a,l,s):r}(e,t),i=e.encode||{},r=i.axis||{},s=r.name||void 0,o=r.interactive,a=r.style,l=ys(e,n),u=function K$e(e){const t=e("tickBand");let i,r,n=e("tickOffset");return t?t.signal?(i={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${t.signal}) === 'extent'`},Ce(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):"extent"===t?(i=1,r=!0,n=0):(i=.5,r=!1):(i=e("bandPosition"),r=e("tickExtra")),{extra:r,band:i,offset:n}}(l),c={scale:e.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:null!=e.title},f=Re(t.add(Aa({},[c]))),d=Re(t.add(o$e({scale:t.scaleRef(e.scale),extra:t.property(u.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(function q8e(e,t,n,i,r){const s=ys(e,t),o=e.orient,a=e.gridScale,l=yS(o,1,-1),u=function Y8e(e,t){if(1!==t)if(Ce(e)){let n=e=Ze({},e);for(;null!=n.mult;){if(!Ce(n.mult))return n.mult=Di(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n=n.mult=Ze({},n.mult)}n.mult=t}else e=Di(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);return e}(e.offset,l);let c,f,d;const h={enter:c={opacity:Et},update:d={opacity:Fo},exit:f={opacity:Et}};Ki(h,{stroke:s("gridColor"),strokeCap:s("gridCap"),strokeDash:s("gridDash"),strokeDashOffset:s("gridDashOffset"),strokeOpacity:s("gridOpacity"),strokeWidth:s("gridWidth")});const p={scale:e.scale,field:Ro,band:r.band,extra:r.extra,offset:r.offset,round:s("tickRound")},g=Pi(o,{signal:"height"},{signal:"width"}),m=a?{scale:a,range:0,mult:l,offset:u}:{value:0,offset:u},_=a?{scale:a,range:1,mult:l,offset:u}:Ze(g,{mult:l,offset:u});return c.x=d.x=Pi(o,p,m),c.y=d.y=Oa(o,p,m),c.x2=d.x2=Oa(o,_),c.y2=d.y2=Pi(o,_),f.x=Pi(o,p),f.y=Oa(o,p),Qs({type:h3,role:"axis-grid",key:Ro,from:i,encode:h},n)}(e,n,i.grid,d,u)),c.ticks&&(p=l("tickSize"),h.push(function K8e(e,t,n,i,r,s){const o=ys(e,t),a=e.orient,l=yS(a,-1,1);let u,c,f;const d={enter:u={opacity:Et},update:f={opacity:Fo},exit:c={opacity:Et}};Ki(d,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const h=Fi(r);h.mult=l;const p={scale:e.scale,field:Ro,band:s.band,extra:s.extra,offset:s.offset,round:o("tickRound")};return f.y=u.y=Pi(a,Et,p),f.y2=u.y2=Pi(a,h),c.x=Pi(a,p),f.x=u.x=Oa(a,Et,p),f.x2=u.x2=Oa(a,h),c.y=Oa(a,p),Qs({type:h3,role:"axis-tick",key:Ro,from:i,encode:d},n)}(e,n,i.ticks,d,p,u))),c.labels&&(p=c.ticks?p:0,h.push(J8e(e,n,i.labels,d,p,u))),c.domain&&h.push(function W8e(e,t,n,i){const r=ys(e,t),s=e.orient;let o,a;const l={enter:o={opacity:Et},update:a={opacity:Fo},exit:{opacity:Et}};Ki(l,{stroke:r("domainColor"),strokeCap:r("domainCap"),strokeDash:r("domainDash"),strokeDashOffset:r("domainDashOffset"),strokeWidth:r("domainWidth"),strokeOpacity:r("domainOpacity")});const u=Cne(e,0),c=Cne(e,1);return o.x=a.x=Pi(s,u,Et),o.x2=a.x2=Pi(s,c),o.y=a.y=Oa(s,u,Et),o.y2=a.y2=Oa(s,c),Qs({type:h3,role:"axis-domain",from:i,encode:l},n)}(e,n,i.domain,f)),c.title&&h.push(function X8e(e,t,n,i){const r=ys(e,t),s=e.orient,o=yS(s,-1,1);let a,l;const u={enter:a={opacity:Et,anchor:Fi(r("titleAnchor",null)),align:{signal:p3}},update:l=Ze({},a,{opacity:Fo,text:Fi(e.title)}),exit:{opacity:Et}},c={signal:`lerp(range("${e.scale}"), ${pS(0,1,.5)})`};return l.x=Pi(s,c),l.y=Oa(s,c),a.angle=Pi(s,Et,((e,t)=>Di(e)?{signal:`(${e.signal}) * 90`}:{value:90*e})(o)),a.baseline=Pi(s,vne(s,Mf,Ta),{value:Mf}),l.angle=a.angle,l.baseline=a.baseline,Ki(u,{fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),angle:r("titleAngle"),baseline:r("titleBaseline")}),function Q8e(e,t,n,i){const r=(a,l)=>null!=a?(n.update[l]=Em(Fi(a),n.update[l]),!1):!vm(l,i),s=r(e("titleX"),"x"),o=r(e("titleY"),"y");n.enter.auto=o===s?Fi(o):Pi(t,Fi(o),Fi(s))}(r,s,u,n),u.update.align=Em(u.update.align,a.align),u.update.angle=Em(u.update.angle,a.angle),u.update.baseline=Em(u.update.baseline,a.baseline),Qs({type:wh,role:"axis-title",style:u3,from:i,encode:u},n)}(e,n,i.title,f)),_S(Ov({role:"axis",from:f,encode:ym(e4e(l,e),r,Tv),marks:h,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:s,interactive:o,style:a}),t)}function e4e(e,t){const n={enter:{},update:{}};return Ki(n,{orient:e("orient"),offset:e("offset")||0,position:xa(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function Ene(e,t,n){const i=ve(e.signals),r=ve(e.scales);return n||i.forEach(s=>$te(s,t)),ve(e.projections).forEach(s=>function j$e(e,t){const n=t.config.projection||{},i={};for(const r in e)"name"!==r&&(i[r]=o3(e[r],r,t));for(const r in n)null==i[r]&&(i[r]=o3(n[r],r,t));t.addProjection(e.name,i)}(s,t)),r.forEach(s=>function x$e(e,t){const n=e.type||"linear";rK(n)||Q("Unrecognized scale type: "+fe(n)),t.addScale(e.name,{type:n,domain:void 0})}(s,t)),ve(e.data).forEach(s=>function F8e(e,t){const n=[];e.transform&&e.transform.forEach(i=>{n.push(_3(i,t))}),e.on&&e.on.forEach(i=>{gne(i,t,e.name)}),t.addDataPipeline(e.name,function P8e(e,t,n){const i=[];let a,l,u,c,f,r=null,s=!1,o=!1;for(e.values?Di(e.values)||uS(e.format)?(i.push(_ne(t,e)),i.push(r=Ch())):i.push(r=Ch({$ingest:e.values,$format:e.format})):e.url?uS(e.url)||uS(e.format)?(i.push(_ne(t,e)),i.push(r=Ch())):i.push(r=Ch({$request:e.url,$format:e.format})):e.source&&(r=a=ve(e.source).map(d=>Re(t.getData(d).output)),i.push(null)),l=0,u=n.length;l<u;++l)c=n[l],f=c.metadata,!r&&!f.source&&i.push(r=Ch()),i.push(c),f.generates&&(o=!0),f.modifies&&!o&&(s=!0),f.source?r=c:f.changes&&(r=null);return a&&(u=a.length-1,i[0]=w$e({derive:s,pulse:u?a:a[0]}),(s||u)&&i.splice(1,0,Ch())),r||i.push(Ch()),i.push(bh({})),i}(e,t,n))}(s,t)),r.forEach(s=>A$e(s,t)),(n||i).forEach(s=>function s$e(e,t){const n=t.getSignal(e.name);let i=e.update;e.init&&(i?Q("Signals can not include both init and update expressions."):(i=e.init,n.initonly=!0)),i&&(i=Nl(i,t),n.update=i.$expr,n.params=i.$params),e.on&&e.on.forEach(r=>function n$e(e,t,n){const i=e.encode,r={target:n};let s=e.events,o=e.update,a=[];s||Q("Signal update missing events specification."),_e(s)&&(s=Of(s,t.isSubscope()?n3:r3)),s=ve(s).filter(l=>l.signal||l.scale?(a.push(l),0):1),a.length>1&&(a=[r$e(a)]),s.length&&a.push(s.length>1?{merge:s}:s[0]),null!=i&&(o&&Q("Signal encode and update are mutually exclusive."),o="encode(item(),"+fe(i)+")"),r.update=_e(o)?Nl(o,t):null!=o.expr?Nl(o.expr,t):null!=o.value?o.value:null!=o.signal?{$expr:t$e,$params:{$value:t.signalRef(o.signal)}}:Q("Invalid signal update specification."),e.force&&(r.options={force:!0}),a.forEach(l=>t.addUpdate(Ze(function i$e(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):xv(e,t)}}(l,t),r)))}(r,t,n.id))}(s,t)),ve(e.axes).forEach(s=>Z8e(s,t)),ve(e.marks).forEach(s=>_S(s,t)),ve(e.legends).forEach(s=>function C8e(e,t){const n=t.config.legend,i=e.encode||{},r=ys(e,n),s=i.legend||{},o=s.name||void 0,a=s.interactive,l=s.style,u={};let f,d,h,c=0;d3.forEach(v=>e[v]?(u[v]=e[v],c=c||e[v]):0),c||Q("Missing valid scale for legend.");const p=function E8e(e,t){let n=e.type||"symbol";return!e.type&&1===function S8e(e){return d3.reduce((t,n)=>t+(e[n]?1:0),0)}(e)&&(e.fill||e.stroke)&&(n=GI(t)?dS:WI(t)?c3:"symbol"),n!==dS?n:WI(t)?c3:dS}(e,t.scaleType(c)),g={title:null!=e.title,scales:u,type:p,vgrad:"symbol"!==p&&r.isVertical()},m=Re(t.add(Aa(null,[g]))),y=Re(t.add(d$e(d={type:p,scale:t.scaleRef(c),count:t.objectProperty(r("tickCount")),limit:t.property(r("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===dS?(h=[J$e(e,c,n,i.gradient),sne(e,n,i.labels,y)],d.count=d.count||t.signalRef(`max(2,2*floor((${vh(r.gradientLength())})/100))`)):p===c3?h=[X$e(e,c,n,i.gradient,y),sne(e,n,i.labels,y)]:(f=function t8e(e,t){const n=ys(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(e,n),h=[e8e(e,n,i,y,vh(f.columns))],d.size=function A8e(e,t,n){const i=vh(mne("size",e,n)),r=vh(mne("strokeWidth",e,n)),s=vh(function T8e(e,t,n){return ine("fontSize",e)||function Y$e(e,t,n){const i=t.config.style[n];return i&&i[e]}("fontSize",t,n)}(n[1].encode,t,Av));return Nl(`max(ceil(sqrt(${i})+${r}),${s})`,t)}(e,t,h[0].marks)),h=[Ov({role:"legend-entry",from:m,encode:{enter:{x:{value:0},y:{value:0}}},marks:h,layout:f,interactive:a})],g.title&&h.push(function u8e(e,t,n,i){const r=ys(e,t),s={enter:{opacity:Et},update:{opacity:Fo,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:Et}};return Ki(s,{orient:r("titleOrient"),_anchor:r("titleAnchor"),anchor:{signal:o8e},angle:{signal:a8e},align:{signal:s8e},baseline:{signal:l8e},text:e.title,fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),baseline:r("titleBaseline")}),Qs({type:wh,role:"legend-title",style:u3,from:i,encode:s},n)}(e,n,i.title,m)),_S(Ov({role:"legend",from:m,encode:ym(x8e(r,e,n),s,Tv),marks:h,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:o,interactive:a,style:l}),t)}(s,t)),e.title&&function M8e(e,t){const n=ys(e=_e(e)?{text:e}:e,t.config.title),i=e.encode||{},r=i.group||{},s=r.name||void 0,o=r.interactive,a=r.style,l=[],c=Re(t.add(Aa(null,[{}])));return l.push(function I8e(e,t,n,i){const r={value:0},o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return Ki(o,{text:e.text,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Qs({type:wh,role:"title-text",style:"group-title",from:i,encode:o},n)}(e,n,function N8e(e){const t=e.encode;return t&&t.title||Ze({name:e.name,interactive:e.interactive,style:e.style},t)}(e),c)),e.subtitle&&l.push(function R8e(e,t,n,i){const r={value:0},o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return Ki(o,{text:e.subtitle,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Qs({type:wh,role:"title-subtitle",style:"group-subtitle",from:i,encode:o},n)}(e,n,i.subtitle,c)),_S(Ov({role:"title",from:c,encode:k8e(n,r),marks:l,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:s,interactive:o,style:a}),t)}(e.title,t),t.parseLambdas(),t}function Nv(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function Sne(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function xne(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}function w3(e){return(Z(e)?r4e:s4e)(e)}function r4e(e){const t=e.length;let n="[";for(let i=0;i<t;++i){const r=e[i];n+=(i>0?",":"")+(Ce(r)?r.signal||w3(r):fe(r))}return n+"]"}function s4e(e){let i,r,t="{",n=0;for(i in e)r=e[i],t+=(++n>1?",":"")+fe(i)+":"+(Ce(r)?r.signal||w3(r):fe(r));return t+"}"}function a4e(e,t,n){return Ce(e)||Q("Input Vega specification must be an object."),function n4e(e,t){const n=t.config,i=Re(t.root=t.add(aS())),r=function i4e(e,t){const n=o=>xa(e[o],t[o]),i=[Nv("background",n("background")),Nv("autosize",_5e(n("autosize"))),Nv("padding",v5e(n("padding"))),Nv("width",n("width")||0),Nv("height",n("height")||0)],r=i.reduce((o,a)=>(o[a.name]=a,o),{}),s={};return ve(e.signals).forEach(o=>{Oe(r,o.name)?o=Ze(r[o.name],o):i.push(o),s[o.name]=o}),ve(t.signals).forEach(o=>{!Oe(s,o.name)&&!Oe(r,o.name)&&i.push(o)}),i}(e,n);r.forEach(u=>$te(u,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const s=t.add(Aa()),o=t.add(Wte(jte((e=>ym({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e))(e.encode),hS,XL,e.style,t,{pulse:Re(s)}))),a=t.add(Kte({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:i,pulse:Re(o)}));t.operators.pop(),t.pushState(Re(o),Re(a),null),Ene(e,t,r),t.operators.push(a);let l=t.add(zte({mark:i,pulse:Re(a)}));return l=t.add(Yte({pulse:Re(l)})),l=t.add(bh({pulse:Re(l)})),t.addData("root",new Dh(t,s,s,l)),t}(e,new Sne(t=mg(function o4e(){const e="sans-serif",i="#4c78a8",r="#000",s="#888",o="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i},area:{fill:i},image:null,line:{stroke:i,strokeWidth:2},path:{stroke:i},rect:{fill:i},rule:{stroke:r},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:r,font:e,fontSize:11},trail:{fill:i,size:2},style:{"guide-label":{fill:r,font:e,fontSize:10},"guide-title":{fill:r,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:o}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:s,grid:!1,gridWidth:1,gridColor:o,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:s,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:o,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:s,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}(),t,e.config),n)).toRuntime()}Sne.prototype=xne.prototype={parse(e){return Ene(e,this)},fork(){return new xne(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof e3?Re(e):e;return this.add(b$e({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(i,r,s){let o,a;i&&(o=i.data||(i.data={}),a=o[r]||(o[r]=[]),a.push(s))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const i in t.index)n(t.index[i],e,"index:"+i)}return this},pushState(e,t,n){this._encode.push(Re(this.add(bh({pulse:e})))),this._parent.push(t),this._lookup.push(n?Re(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return yt(this._parent)},encode(){return yt(this._encode)},lookup(){return yt(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(_e(e))return Sv(e,t);e.signal||Q("Unsupported field reference: "+fe(e));const n=e.signal;let i=this.field[n];if(!i){const r={name:this.signalRef(n)};t&&(r.as=t),this.field[n]=i=Re(this.add(c$e(r)))}return i},compareRef(e){let t=!1;const n=s=>Di(s)?(t=!0,this.signalRef(s.signal)):function K5e(e){return e&&e.expr}(s)?(t=!0,this.exprRef(s.expr)):s,i=ve(e.field).map(n),r=ve(e.order).map(n);return t?Re(this.add(Gte({fields:i,orders:r}))):Vte(i,r)},keyRef(e,t){let n=!1;const r=this.signals;return e=ve(e).map(s=>Di(s)?(n=!0,Re(r[s.signal])):s),n?Re(this.add(f$e({fields:e,flat:t}))):function G5e(e,t){const n={$key:e};return t&&(n.$flat=!0),n}(e,t)},sortRef(e){if(!e)return e;const t=lS(e.op,e.field),n=e.order||"ascending";return n.signal?Re(this.add(Gte({fields:t,orders:this.signalRef(n.signal)}))):Vte(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:e,type:t}),this.events[n]=i}return this.events[n]},hasOwnSignal(e){return Oe(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&Q("Duplicate signal name: "+fe(e));const n=t instanceof e3?t:this.add(aS(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||Q("Unrecognized signal name: "+fe(e)),this.signals[e]},signalRef(e){return this.signals[e]?Re(this.signals[e]):(Oe(this.lambdas,e)||(this.lambdas[e]=this.add(aS(null))),Re(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const i=e[t],r=Nl(i,this),s=this.lambdas[i];s.params=r.$params,s.update=r.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return e&&Ce(e)?this.signalRef(e.signal||w3(e)):e},exprRef(e,t){const n={expr:Nl(e,this)};return t&&(n.expr.$name=t),Re(this.add(l$e(n)))},addBinding(e,t){this.bindings||Q("Nested signals do not support binding: "+fe(e)),this.bindings.push(Ze({signal:e},t))},addScaleProj(e,t){Oe(this.scales,e)&&Q("Duplicate scale or projection name: "+fe(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,D$e(t))},addProjection(e,t){this.addScaleProj(e,v$e(t))},getScale(e){return this.scales[e]||Q("Unrecognized scale name: "+fe(e)),this.scales[e]},scaleRef(e){return Re(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return Oe(this.data,e)&&Q("Duplicate data set name: "+fe(e)),this.data[e]=t},getData(e){return this.data[e]||Q("Undefined data set name: "+fe(e)),this.data[e]},addDataPipeline(e,t){return Oe(this.data,e)&&Q("Duplicate data set name: "+fe(e)),this.addData(e,Dh.fromEntries(this,t))}};var l4e="5.22.1";Ze(Ng,Kt,ot,Wn,At,xs,St,As,pt,Vi,lo,Go);var c4e={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},f4e={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},d4e={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const h4e=Array.prototype.slice,Eh=(e,t,n)=>{const i=n?n(t[0]):t[0];return i[e].apply(i,h4e.call(t,1))};var g4e={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:(e,t,n,i,r,s,o)=>new Date(e,t||0,null!=n?n:1,i||0,r||0,s||0,o||0),date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return Eh("join",arguments)},indexof:function(){return Eh("indexOf",arguments)},lastindexof:function(){return Eh("lastIndexOf",arguments)},slice:function(){return Eh("slice",arguments)},reverse:e=>e.slice().reverse(),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return Eh("substring",arguments,String)},split:function(){return Eh("split",arguments,String)},replace:function(){return Eh("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const m4e=["view","item","group","xy","x","y"],_4e={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:"datum"===n?e.datum:"event"===n?e.event:"item"===n?e.item:c4e[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,i=e(t.object);n&&(e.memberDepth+=1);const r=e(t.property);return n&&(e.memberDepth-=1),i[r]},CallExpression:(e,t)=>{const n=t.arguments;let i=t.callee.name;return i.startsWith("_")&&(i=i.slice(1)),"if"===i?e(n[0])?e(n[1]):e(n[2]):(e.fn[i]||g4e[i]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>f4e[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>d4e[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>"&&"===t.operator?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,i)=>{e.memberDepth+=1;const r=e(i.key);return e.memberDepth-=1,n[r]=e(i.value),n},{})};function kv(e,t,n,i,r,s){const o=a=>_4e[a.type](o,a);return o.memberDepth=0,o.fn=Object.create(t),o.params=n,o.datum=i,o.event=r,o.item=s,m4e.forEach(a=>o.fn[a]=(...l)=>r.vega[a](...l)),o(e)}var y4e={operator(e,t){const n=t.ast,i=e.functions;return r=>kv(n,i,r)},parameter(e,t){const n=t.ast,i=e.functions;return(r,s)=>kv(n,i,s,r)},event(e,t){const n=t.ast,i=e.functions;return r=>kv(n,i,void 0,void 0,r)},handler(e,t){const n=t.ast,i=e.functions;return(r,s)=>kv(n,i,r,s.item&&s.item.datum,s)},encode(e,t){const{marktype:n,channels:i}=t,r=e.functions,s="group"===n||"image"===n||"rect"===n;return(o,a)=>{const l=o.datum;let c,u=0;for(const f in i)c=kv(i[f].ast,r,a,l,void 0,o),o[f]!==c&&(o[f]=c,u=1);return"rule"!==n&&function u4e(e,t,n){let i;t.x2&&(t.x?(n&&e.x>e.x2&&(i=e.x,e.x=e.x2,e.x2=i),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(i=e.y,e.y=e.y2,e.y2=i),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}(o,i,s),u}}};Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,i){return Array.isArray(i)?n.push.apply(n,e.call(i,t-1)):n.push(i),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var b4e=ue(478),w4e=ue.n(b4e),D4e=ue(559),C4e=ue.n(D4e),E4e=ue(245),D3=ue.n(E4e);function C3(e){return!!e.or}function E3(e){return!!e.and}function S3(e){return!!e.not}function vS(e,t){if(S3(e))vS(e.not,t);else if(E3(e))for(const n of e.and)vS(n,t);else if(C3(e))for(const n of e.or)vS(n,t);else t(e)}function xm(e,t){return S3(e)?{not:xm(e.not,t)}:E3(e)?{and:e.and.map(n=>xm(n,t))}:C3(e)?{or:e.or.map(n=>xm(n,t))}:t(e)}const kl=C4e(),Je=w4e();function Ane(e){throw new Error(e)}function Am(e,t){const n={};for(const i of t)Oe(e,i)&&(n[i]=e[i]);return n}function Zs(e,t){const n=Object.assign({},e);for(const i of t)delete n[i];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>D3()(e)).join(",")})`};const gn=D3();function vt(e){if(Xt(e))return e;const t=_e(e)?e:D3()(e);if(t.length<250)return t;let n=0;for(let i=0;i<t.length;i++)n=(n<<5)-n+t.charCodeAt(i),n&=n;return n}function x3(e){return!1===e||null===e}function bt(e,t){return e.includes(t)}function Sh(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function A3(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function Tne(e,...t){for(const n of t)S4e(e,null!=n?n:{});return e}function S4e(e,t){for(const n of ie(t))_g(e,n,t[n],!0)}function Il(e,t){const n=[],i={};let r;for(const s of e)r=t(s),!(r in i)&&(i[r]=1,n.push(s));return n}function x4e(e,t){const n=ie(e),i=ie(t);if(n.length!==i.length)return!1;for(const r of n)if(e[r]!==t[r])return!1;return!0}function One(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function T3(e,t){for(const n of e)if(t.has(n))return!0;return!1}function O3(e){const t=new Set;for(const n of e){const r=ul(n).map((o,a)=>0===a?o:`[${o}]`),s=r.map((o,a)=>r.slice(0,a+1).join(""));for(const o of s)t.add(o)}return t}function M3(e,t){return void 0===e||void 0===t||T3(O3(e),O3(t))}function Zt(e){return 0===ie(e).length}const ie=Object.keys,yr=Object.values,Nf=Object.entries;function Iv(e){return!0===e||!1===e}function An(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function Rv(e,t){return S3(e)?`!(${Rv(e.not,t)})`:E3(e)?`(${e.and.map(n=>Rv(n,t)).join(") && (")})`:C3(e)?`(${e.or.map(n=>Rv(n,t)).join(") || (")})`:t(e)}function bS(e,t){if(0===t.length)return!0;const n=t.shift();return n in e&&bS(e[n],t)&&delete e[n],Zt(e)}function Fv(e){return e.charAt(0).toUpperCase()+e.substr(1)}function N3(e,t="datum"){const n=ul(e),i=[];for(let r=1;r<=n.length;r++){const s=`[${n.slice(0,r).map(fe).join("][")}]`;i.push(`${t}${s}`)}return i.join(" && ")}function Mne(e,t="datum"){return`${t}[${fe(ul(e).join("."))}]`}function A4e(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Po(e){return`${ul(e).map(A4e).join("\\.")}`}function xh(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function k3(e){return`${ul(e).join(".")}`}function Tm(e){return e?ul(e).length:0}function fi(...e){for(const t of e)if(void 0!==t)return t}let Nne=42;function kne(e){const t=++Nne;return e?String(e)+t:t}function T4e(){Nne=42}function Ine(e){return Rne(e)?e:`__${e}`}function Rne(e){return e.startsWith("__")}function Pv(e){if(void 0!==e)return(e%360+360)%360}function wS(e){return!!Xt(e)||!isNaN(e)&&!isNaN(parseFloat(e))}var Lv=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};const zu="row",Gu="column",DS="facet",Pn="x",Li="y",Ma="x2",Rl="y2",kf="xOffset",Om="yOffset",Fl="radius",Wu="radius2",Na="theta",qu="theta2",Pl="latitude",Ll="longitude",ka="latitude2",Lo="longitude2",vs="color",jl="fill",Bl="stroke",bs="shape",Yu="size",Ah="angle",Ku="opacity",If="fillOpacity",Rf="strokeOpacity",Ff="strokeWidth",Pf="strokeDash",jv="text",Bv="order",$v="detail",CS="key",Th="tooltip",ES="href",SS="url",xS="description",Fne={theta:1,theta2:1,radius:1,radius2:1};function Pne(e){return e in Fne}const I3={longitude:1,longitude2:1,latitude:1,latitude2:1},k4e=ie(I3),AS=Object.assign(Object.assign(Object.assign(Object.assign({},{x:1,y:1,x2:1,y2:1}),Fne),I3),{xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function Mm(e){return e===vs||e===jl||e===Bl}const Lne={row:1,column:1,facet:1},jo=ie(Lne),TS=Object.assign(Object.assign({},AS),Lne),I4e=ie(TS),R3=Lv(TS,["order","detail","tooltip"]),jne=Lv(R3,["row","column","facet"]);function R4e(e){return!!jne[e]}function Bne(e){return!!TS[e]}ie(R3),ie(jne);const F4e=[Ma,Rl,ka,Lo,qu,Wu];function $ne(e){return Oh(e)!==e}function Oh(e){switch(e){case Ma:return Pn;case Rl:return Li;case ka:return Pl;case Lo:return Ll;case qu:return Na;case Wu:return Fl}return e}function Lf(e){if(Pne(e))switch(e){case Na:return"startAngle";case qu:return"endAngle";case Fl:return"outerRadius";case Wu:return"innerRadius"}return e}function Ju(e){switch(e){case Pn:return Ma;case Li:return Rl;case Pl:return ka;case Ll:return Lo;case Na:return qu;case Fl:return Wu}}function ws(e){switch(e){case Pn:case Ma:return"width";case Li:case Rl:return"height"}}function Vne(e){switch(e){case Pn:return"xOffset";case Li:return"yOffset"}}function Hne(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const L4e=ie(AS),OS=Lv(AS,["x","y","x2","y2","xOffset","yOffset","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),j4e=ie(OS),F3={x:1,y:1},$l=ie(F3);function Ji(e){return e in F3}const P3={theta:1,radius:1},B4e=ie(P3);function MS(e){return"width"===e?Pn:Li}const L3={xOffset:1,yOffset:1};function Nm(e){return e in L3}ie(L3);const Une=Lv(OS,["text","tooltip","href","url","description","detail","key","order"]),$4e=ie(Une),zne=Object.assign(Object.assign(Object.assign(Object.assign({},F3),P3),L3),Une),NS=ie(zne);function jf(e){return!!zne[e]}const j3={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},z4e=Lv(j3,["geoshape"]);function B3(e){switch(e){case Pn:case Li:case Na:case Fl:case kf:case Om:case Yu:case Ah:case Ff:case Ku:case If:case Rf:case Ma:case Rl:case qu:case Wu:return;case DS:case zu:case Gu:case bs:case Pf:case jv:case Th:case ES:case SS:case xS:return"discrete";case vs:case jl:case Bl:return"flexible";case Pl:case Ll:case ka:case Lo:case $v:case CS:case Bv:return}}const W4e={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},q4e={count:1,min:1,max:1};function Xu(e){return!!e&&!!e.argmin}function Bf(e){return!!e&&!!e.argmax}function $3(e){return _e(e)&&!!W4e[e]}const Y4e=new Set(["count","valid","missing","distinct"]);function Gne(e){return _e(e)&&Y4e.has(e)}const J4e=new Set(["count","sum","distinct","valid","missing"]),X4e=new Set(["mean","average","median","q1","q3","min","max"]);function Wne(e){return Fc(e)&&(e=ZS(e,void 0)),"bin"+ie(e).map(t=>kS(e[t])?An(`_${t}_${Nf(e[t])}`):An(`_${t}_${e[t]}`)).join("")}function mn(e){return!0===e||Mh(e)&&!e.binned}function qr(e){return"binned"===e||Mh(e)&&!0===e.binned}function Mh(e){return Ce(e)}function kS(e){return null==e?void 0:e.param}function qne(e){switch(e){case zu:case Gu:case Yu:case vs:case jl:case Bl:case Ff:case Ku:case If:case Rf:case bs:return 6;case Pf:return 4;default:return 10}}function Vv(e){return e&&!!e.expr}function Ds(e){const t=ie(e||{}),n={};for(const i of t)n[i]=eo(e[i]);return n}function Yne(e){const{anchor:t,frame:n,offset:i,orient:r,angle:s,limit:o,color:a,subtitleColor:l,subtitleFont:u,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:h,subtitlePadding:p}=e,g=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["anchor","frame","offset","orient","angle","limit","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),m=Object.assign(Object.assign({},g),a?{fill:a}:{}),_=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),i?{offset:i}:{}),r?{orient:r}:{}),void 0!==s?{angle:s}:{}),void 0!==o?{limit:o}:{}),y=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{subtitleColor:l}:{}),u?{subtitleFont:u}:{}),c?{subtitleFontSize:c}:{}),f?{subtitleFontStyle:f}:{}),d?{subtitleFontWeight:d}:{}),h?{subtitleLineHeight:h}:{}),p?{subtitlePadding:p}:{});return{titleMarkConfig:m,subtitleMarkConfig:Am(e,["align","baseline","dx","dy","limit"]),nonMarkTitleProperties:_,subtitle:y}}function $f(e){return _e(e)||Z(e)&&_e(e[0])}function Ne(e){return e&&!!e.signal}function Vf(e){return!!e.step}function Qu(e){return!Z(e)&&"field"in e&&"data"in e}const t6e=ie({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1}),n6e={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},V3=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];var H3=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Kne(e){const t=Z(e.condition)?e.condition.map(Jne):Jne(e.condition);return Object.assign(Object.assign({},eo(e)),{condition:t})}function eo(e){if(Vv(e)){const{expr:t}=e,n=H3(e,["expr"]);return Object.assign({signal:t},n)}return e}function Jne(e){if(Vv(e)){const{expr:t}=e,n=H3(e,["expr"]);return Object.assign({signal:t},n)}return e}function wn(e){if(Vv(e)){const{expr:t}=e,n=H3(e,["expr"]);return Object.assign({signal:t},n)}return Ne(e)?e:void 0!==e?{value:e}:void 0}function i6e(e){return Ne(e)?e.signal:fe(e)}function Xne(e){return Ne(e)?e.signal:fe(e.value)}function Zu(e){return Ne(e)?e.signal:null==e?null:fe(e)}function Qne(e){var t;return[].concat(e.type,null!==(t=e.style)&&void 0!==t?t:[])}function Gt(e,t,n,i={}){const{vgChannel:r,ignoreVgConfig:s}=i;return r&&void 0!==t[r]?t[r]:void 0!==t[e]?t[e]:!s||r&&r!==e?Nh(e,t,n,i):void 0}function Nh(e,t,n,{vgChannel:i}={}){return fi(i?IS(e,t,n.style):void 0,IS(e,t,n.style),i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function IS(e,t,n){return Zne(e,Qne(t),n)}function Zne(e,t,n){let i;t=ve(t);for(const r of t){const s=n[r];s&&void 0!==s[e]&&(i=s[e])}return i}function eie(e,t){return ve(e).reduce((n,i)=>{var r;return n.field.push(pe(i,t)),n.order.push(null!==(r=i.sort)&&void 0!==r?r:"ascending"),n},{field:[],order:[]})}function tie(e,t){const n=[...e];return t.forEach(i=>{for(const r of n)if(kl(r,i))return;n.push(i)}),n}function nie(e,t){return kl(e,t)||!t?e:e?[...ve(e),...ve(t)].join(", "):t}function iie(e,t){const n=e.value,i=t.value;if(null==n||null===i)return{explicit:e.explicit,value:null};if(($f(n)||Ne(n))&&($f(i)||Ne(i)))return{explicit:e.explicit,value:nie(n,i)};if($f(n)||Ne(n))return{explicit:e.explicit,value:n};if($f(i)||Ne(i))return{explicit:e.explicit,value:i};if(!($f(n)||Ne(n)||$f(i)||Ne(i)))return{explicit:e.explicit,value:tie(n,i)};throw new Error("It should never reach here")}function U3(e){return`Invalid specification ${gn(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}function rie(e){return("width"==e?"Width":"Height")+' "container" only works for single views and layered views.'}function sie(e){return`${"width"==e?"Width":"Height"} "container" only works well with autosize "fit" or "fit-${"width"==e?"x":"y"}".`}function oie(e){return e?`Dropping "fit-${e}" because spec has discrete ${ws(e)}.`:'Dropping "fit" because spec has discrete size.'}function z3(e){return`Unknown field for ${e}. Cannot calculate view size.`}function aie(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function o6e(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function lie(e){return`Selection not supported for ${e} yet.`}function uie(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}function cie(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}function v6e(e){return`Ignoring an invalid transform: ${gn(e)}.`}function fie(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function C6e(e){return`${e}Offset dropped because ${e} is continuous`}function E6e(e){return`There is no ${e} encoding. Replacing ${e}Offset encoding as ${e}.`}function die(e){return`Invalid field type "${e}".`}function hie(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`}function G3(e,t){return`Dropping ${gn(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}function RS(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function M6e(e){return`${e} encoding has no scale, so specified scale is ignored.`}function N6e(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function k6e(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function I6e(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function W3(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${"ordinal"===t?"order":"magnitude"}.`}function $6e(e){return`Using unaggregated domain with raw field has no effect (${gn(e)}).`}function V6e(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function H6e(e){return`Unaggregated domain is currently unsupported for log scale (${gn(e)}).`}function pie(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function gie(e){return`The step for "${e}" is dropped because the ${"width"===e?"x":"y"} is continuous.`}const mie="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";function FS(e,t){return`Invalid ${e}: ${gn(t)}.`}function _ie(e){return`1D error band does not support ${e}.`}function yie(e){return`Channel ${e} is required for "binned" bin.`}const vie=JN(KN);let Vl=vie;function le(...e){Vl.warn(...e)}function kh(e){if(e&&Ce(e))for(const t of Y3)if(t in e)return!0;return!1}const wie=["january","february","march","april","may","june","july","august","september","october","november","december"],dVe=wie.map(e=>e.substr(0,3)),Die=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],hVe=Die.map(e=>e.substr(0,3));function q3(e,t){const n=[];if(t&&void 0!==e.day&&ie(e).length>1&&(le(function nVe(e){return`Dropping day from datetime ${gn(e)} as day cannot be combined with other units.`}(e)),delete(e=Je(e)).day),n.push(void 0!==e.year?e.year:2012),void 0!==e.month){const i=t?function gVe(e){if(wS(e)&&(e=+e),Xt(e))return e-1;{const t=e.toLowerCase(),n=wie.indexOf(t);if(-1!==n)return n;const i=t.substr(0,3),r=dVe.indexOf(i);if(-1!==r)return r;throw new Error(FS("month",e))}}(e.month):e.month;n.push(i)}else if(void 0!==e.quarter){const i=t?function pVe(e){if(wS(e)&&(e=+e),Xt(e))return e>4&&le(FS("quarter",e)),e-1;throw new Error(FS("quarter",e))}(e.quarter):e.quarter;n.push(Xt(i)?3*i:`${i}*3`)}else n.push(0);if(void 0!==e.date)n.push(e.date);else if(void 0!==e.day){const i=t?function mVe(e){if(wS(e)&&(e=+e),Xt(e))return e%7;{const t=e.toLowerCase(),n=Die.indexOf(t);if(-1!==n)return n;const i=t.substr(0,3),r=hVe.indexOf(i);if(-1!==r)return r;throw new Error(FS("day",e))}}(e.day):e.day;n.push(Xt(i)?i+1:`${i}+1`)}else n.push(1);for(const i of["hours","minutes","seconds","milliseconds"]){const r=e[i];n.push(void 0===r?0:r)}return n}function Uv(e){const n=q3(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}const Cie={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},Y3=ie(Cie);function K3(e){return e.startsWith("utc")}const DVe={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function J3(e){return Y3.filter(t=>Eie(e,t))}function Eie(e,t){const n=e.indexOf(t);return!(n<0||n>0&&"seconds"===t&&"i"===e.charAt(n-1)||e.length>n+3&&"day"===t&&"o"===e.charAt(n+3)||n>0&&"year"===t&&"f"===e.charAt(n-1))}function Sie(e){if(!e)return;const t=J3(e);return`timeUnitSpecifier(${gn(t)}, ${gn(DVe)})`}function Yr(e){if(!e)return;let t;return _e(e)?t={unit:e}:Ce(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),K3(t.unit)&&(t.utc=!0,t.unit=function wVe(e){return e.substr(3)}(t.unit)),t}function X3(e){return e&&!!e.field&&void 0!==e.equal}function Q3(e){return e&&!!e.field&&void 0!==e.lt}function Z3(e){return e&&!!e.field&&void 0!==e.lte}function ej(e){return e&&!!e.field&&void 0!==e.gt}function tj(e){return e&&!!e.field&&void 0!==e.gte}function nj(e){if(null==e?void 0:e.field){if(Z(e.range)&&2===e.range.length)return!0;if(Ne(e.range))return!0}return!1}function ij(e){return e&&!!e.field&&(Z(e.oneOf)||Z(e.in))}function xie(e){return ij(e)||X3(e)||nj(e)||Q3(e)||ej(e)||Z3(e)||tj(e)}function Hl(e,t){return ex(e,{timeUnit:t,wrapTime:!0})}function Aie(e,t=!0){var n;const{field:i}=e,r=null===(n=Yr(e.timeUnit))||void 0===n?void 0:n.unit,s=r?`time(${function CVe(e,t,{end:n}={end:!1}){const i=N3(t),r=K3(e)?"utc":"";function s(l){return"quarter"===l?`(${r}quarter(${i})-1)`:`${r}${l}(${i})`}let o;const a={};for(const l of Y3)Eie(e,l)&&(a[l]=s(l),o=l);return n&&(a[o]+="+1"),function _Ve(e){const n=q3(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}(a)}(r,i)})`:pe(e,{expr:"datum"});if(X3(e))return`${s}===${Hl(e.equal,r)}`;if(Q3(e))return`${s}<${Hl(e.lt,r)}`;if(ej(e))return`${s}>${Hl(e.gt,r)}`;if(Z3(e))return`${s}<=${Hl(e.lte,r)}`;if(tj(e))return`${s}>=${Hl(e.gte,r)}`;if(ij(e))return`indexof([${function TVe(e,t){return e.map(n=>Hl(n,t))}(e.oneOf,r).join(",")}], ${s}) !== -1`;if(function AVe(e){return e&&!!e.field&&void 0!==e.valid}(e))return rj(s,e.valid);if(nj(e)){const{range:o}=e,a=Ne(o)?{signal:`${o.signal}[0]`}:o[0],l=Ne(o)?{signal:`${o.signal}[1]`}:o[1];if(null!==a&&null!==l&&t)return"inrange("+s+", ["+Hl(a,r)+", "+Hl(l,r)+"])";const u=[];return null!==a&&u.push(`${s} >= ${Hl(a,r)}`),null!==l&&u.push(`${s} <= ${Hl(l,r)}`),u.length>0?u.join(" && "):"true"}throw new Error(`Invalid field predicate: ${gn(e)}`)}function rj(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function OVe(e){var t;return xie(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:null===(t=Yr(e.timeUnit))||void 0===t?void 0:t.unit}):e}const Ih={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function MVe(e){return"quantitative"===e||"temporal"===e}function Tie(e){return"ordinal"===e||"nominal"===e}const Rh=Ih.quantitative,sj=Ih.ordinal,km=Ih.temporal,oj=Ih.nominal,Im=Ih.geojson;ie(Ih);const PS={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function IVe(e,t){const n=PS[e],i=PS[t];return n===i||"ordinal-position"===n&&"time"===i||"ordinal-position"===i&&"time"===n}ie(PS);const RVe={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function Oie(e){return RVe[e]}const Mie=new Set(["linear","log","pow","sqrt","symlog"]),Nie=new Set([...Mie,"time","utc"]);function kie(e){return Mie.has(e)}const Iie=new Set(["quantile","quantize","threshold"]),FVe=new Set([...Nie,...Iie,"sequential","identity"]),PVe=new Set(["ordinal","bin-ordinal","point","band"]);function ji(e){return PVe.has(e)}function to(e){return FVe.has(e)}function Ia(e){return Nie.has(e)}function Rm(e){return Iie.has(e)}function Rie(e){return null==e?void 0:e.param}const aj={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},VVe=(ie(aj),function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(aj,["type","domain","range","rangeMax","rangeMin","scheme"])),HVe=ie(VVe);function lj(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return Ia(e)||"band"===e||"point"===e;case"padding":case"rangeMin":case"rangeMax":return Ia(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return"band"===e;case"domainMax":case"domainMid":case"domainMin":case"clamp":return Ia(e);case"nice":return Ia(e)||"quantize"===e||"threshold"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"constant":return"symlog"===e;case"zero":return to(e)&&!bt(["log","time","utc","threshold","quantile"],e)}}function Fie(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return Mm(e)?void 0:function j6e(e){return`Cannot use the scale property "${e}" with non-color channel.`}(e);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}const vr={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},Pie=vr.arc,LS=vr.area,jS=vr.bar,GVe=vr.image,BS=vr.line,$S=vr.point,WVe=vr.rect,VS=vr.rule,Lie=vr.text,uj=vr.tick,qVe=vr.trail,cj=vr.circle,fj=vr.square,jie=vr.geoshape;function Uf(e){return["line","area","trail"].includes(e)}function Bie(e){return["rect","bar","image","arc"].includes(e)}const $ie=new Set(ie(vr));function Ra(e){return e.type}const JVe=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],Vie=ie({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1}),Hie=ie({mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1});function Fm(e){return e&&null!=e.band}const ZVe={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]};function dj(e){const{channel:t,channelDef:n,markDef:i,scale:r,config:s}=e,o=pj(e);return he(n)&&!Gne(n.aggregate)&&r&&Ia(r.get("type"))?function rHe({fieldDef:e,channel:t,markDef:n,ref:i,config:r}){return Uf(n.type)?i:null===Gt("invalid",n,r)?[sHe(e,t),i]:i}({fieldDef:n,channel:t,markDef:i,ref:o,config:s}):o}function sHe(e,t){const n=hj(e,!0),r="y"===Oh(t)?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function hj(e,t=!0){return rj(_e(e)?e:pe(e,{expr:"datum"}),!t)}function Fh(e,t,n,i){const r={};if(t&&(r.scale=t),zl(e)){const{datum:s}=e;kh(s)?r.signal=Uv(s):Ne(s)?r.signal=s.signal:Vv(s)?r.signal=s.expr:r.value=s}else r.field=pe(e,n);if(i){const{offset:s,band:o}=i;s&&(r.offset=s),o&&(r.band=o)}return r}function HS({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,bandPosition:s=.5}){const o=0<s&&s<1?"datum":void 0,a=pe(t,{expr:o,suffix:r}),l=void 0!==n?pe(n,{expr:o}):pe(t,{suffix:"end",expr:o}),u={};if(0===s||1===s)u.scale=e,u.field=0===s?a:l;else{const c=Ne(s)?`${s.signal} * ${a} + (1-${s.signal}) * ${l}`:`${s} * ${a} + ${1-s} * ${l}`;u.signal=`scale("${e}", ${c})`}return i&&(u.offset=i),u}function pj({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:l,defaultRef:u,bandPosition:c}){var f;if(t){if(We(t)){const d=null==o?void 0:o.get("type");if(Bo(t)){null!=c||(c=tre({fieldDef:t,fieldDef2:n,markDef:i,config:r}));const{bin:h,timeUnit:p,type:g}=t;if(mn(h)||c&&p&&g===km)return(null==a?void 0:a.impute)?Fh(t,s,{binSuffix:"mid"},{offset:l}):c&&!ji(d)?HS({scaleName:s,fieldOrDatumDef:t,bandPosition:c,offset:l}):Fh(t,s,qv(t,e)?{binSuffix:"range"}:{},{offset:l});if(qr(h)){if(he(n))return HS({scaleName:s,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:l});le(yie(e===Pn?Ma:Rl))}}return Fh(t,s,ji(d)?{binSuffix:"range"}:{},{offset:l,band:"band"===d?null!==(f=null!=c?c:t.bandPosition)&&void 0!==f?f:.5:void 0})}if(Fa(t)){const h=l?{offset:l}:{};return Object.assign(Object.assign({},zv(e,t.value)),h)}}return Qe(u)&&(u=u()),u&&Object.assign(Object.assign({},u),l?{offset:l}:{})}function zv(e,t){return bt(["x","x2"],e)&&"width"===t?{field:{group:"width"}}:bt(["y","y2"],e)&&"height"===t?{field:{group:"height"}}:wn(t)}function Ph(e){return e&&"number"!==e&&"time"!==e}function zie(e,t,n){return`${e}(${t}${n?`, ${gn(n)}`:""})`}function gj({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s}){var o,a;if(Ph(n))return mj({fieldOrDatumDef:e,format:t,formatType:n,expr:i,config:s});const l=Gie(e,i,r);if(jm(e)){const u=function uHe(e,t,n,i,r){return!t||n?`${r?"utc":"time"}Format(${e}, '${n=_e(n)?n:i}')`:function EVe(e,t,n){if(!e)return;const i=Sie(e);return`${n||K3(e)?"utc":"time"}Format(${t}, ${i})`}(t,e,r)}(l,he(e)?null===(o=Yr(e.timeUnit))||void 0===o?void 0:o.unit:void 0,t,s.timeFormat,Lh(e)&&"utc"===(null===(a=e.scale)||void 0===a?void 0:a.type));return u?{signal:u}:void 0}return t=Yie(YS(e),t,s),he(e)&&mn(e.bin)?{signal:US(l,pe(e,{expr:i,binSuffix:"end"}),t,n,s)}:t||"quantitative"===YS(e)?{signal:`${Kie(l,t)}`}:{signal:`isValid(${l}) ? ${l} : ""+${l}`}}function Gie(e,t,n){return he(e)?n?`${pe(e,{expr:t,suffix:"end"})}-${pe(e,{expr:t,suffix:"start"})}`:pe(e,{expr:t}):function oHe(e){const{datum:t}=e;return kh(t)?Uv(t):`${gn(t)}`}(e)}function mj({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s,field:o}){return null!=o||(o=Gie(e,i,r)),he(e)&&mn(e.bin)?{signal:US(o,pe(e,{expr:i,binSuffix:"end"}),t,n,s)}:{signal:zie(n,o,t)}}function Wie(e,t,n,i,r,s){var o;if(!Ph(i))return jm(e)?function lHe(e,t,n,i){return e||(t?{signal:Sie(t)}:i?void 0:n.timeFormat)}(n,he(e)?null===(o=Yr(e.timeUnit))||void 0===o?void 0:o.unit:void 0,r,s):Yie(t,n,r)}function qie(e,t,n){return e&&(Ne(e)||"number"===e||"time"===e)?e:jm(t)&&"time"!==n&&"utc"!==n?"time":void 0}function Yie(e,t,n){return _e(t)?t:e===Rh?n.numberFormat:void 0}function Kie(e,t){return`format(${e}, "${t||""}")`}function Jie(e,t,n,i){var r;return Ph(n)?zie(n,e,t):Kie(e,null!==(r=_e(t)?t:void 0)&&void 0!==r?r:i.numberFormat)}function US(e,t,n,i,r){const s=Jie(e,n,i,r),o=Jie(t,n,i,r);return`${rj(e,!1)} ? "null" : ${s} + " \u2013 " + ${o}`}const zS="min",cHe={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function Xie(e){return e in cHe}function Qie(e){return!!e&&!!e.encoding}function Ul(e){return!(!e||"count"!==e.op&&!e.field)}function Zie(e){return!!e&&Z(e)}function Gv(e){return"row"in e||"column"in e}function _j(e){return!!e&&"header"in e}function GS(e){return"facet"in e}var yj=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function ere(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),i?{bin:i}:{}),r?{aggregate:r}:{}),{field:t})}function vj(e){return"sort"in e}function tre({fieldDef:e,fieldDef2:t,markDef:n,config:i}){if(We(e)&&void 0!==e.bandPosition)return e.bandPosition;if(he(e)){const{timeUnit:r,bin:s}=e;if(r&&!t)return Bie(n.type)?0:Nh("timeUnitBandPosition",n,i);if(mn(s))return.5}}function nre({channel:e,fieldDef:t,fieldDef2:n,markDef:i,config:r,scaleType:s,useVlSizeChannel:o}){var a,l,u;const c=ws(e),f=Gt(o?"size":c,i,r,{vgChannel:c});if(void 0!==f)return f;if(he(t)){const{timeUnit:d,bin:h}=t;if(d&&!n)return{band:Nh("timeUnitBandSize",i,r)};if(mn(h)&&!ji(s))return{band:1}}return Bie(i.type)?s?ji(s)?(null===(a=r[i.type])||void 0===a?void 0:a.discreteBandSize)||{band:1}:null===(l=r[i.type])||void 0===l?void 0:l.continuousBandSize:null===(u=r[i.type])||void 0===u?void 0:u.discreteBandSize:void 0}function ire(e,t,n,i){return!!(mn(e.bin)||e.timeUnit&&Bo(e)&&"temporal"===e.type)&&void 0!==tre({fieldDef:e,fieldDef2:t,markDef:n,config:i})}function WS(e){return e&&"condition"in e}function qS(e){const t=e&&e.condition;return!!t&&!Z(t)&&he(t)}function Wv(e){const t=e&&e.condition;return!!t&&!Z(t)&&We(t)}function he(e){return e&&(!!e.field||"count"===e.aggregate)}function YS(e){return e&&e.type}function zl(e){return e&&"datum"in e}function Gl(e){return Bo(e)&&!JS(e)||KS(e)}function KS(e){return zl(e)&&Xt(e.datum)}function We(e){return he(e)||zl(e)}function Bo(e){return e&&("field"in e||"count"===e.aggregate)&&"type"in e}function Fa(e){return e&&"value"in e&&"value"in e}function Lh(e){return e&&("scale"in e||"sort"in e)}function bj(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function rre(e){return e&&"legend"in e}function sre(e){return e&&("format"in e||"formatType"in e)}function pHe(e){return Zs(e,["legend","axis","header","scale"])}function pe(e,t={}){var n,i,r;let s=e.field;const o=t.prefix;let a=t.suffix,l="";if(function _He(e){return"count"===e.aggregate}(e))s=Ine("count");else{let u;if(!t.nofn)if(function gHe(e){return"op"in e}(e))u=e.op;else{const{bin:c,aggregate:f,timeUnit:d}=e;mn(c)?(u=Wne(c),a=(null!==(n=t.binSuffix)&&void 0!==n?n:"")+(null!==(i=t.suffix)&&void 0!==i?i:"")):f?Bf(f)?(l=`["${s}"]`,s=`argmax_${f.argmax}`):Xu(f)?(l=`["${s}"]`,s=`argmin_${f.argmin}`):u=String(f):d&&(u=function SVe(e){const t=Yr(e),{utc:n}=t,i=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["utc"]);return i.unit?(n?"utc":"")+ie(i).map(r=>An(`${"unit"===r?"":`_${r}_`}${i[r]}`)).join(""):(n?"utc":"")+"timeunit"+ie(i).map(r=>An(`_${r}_${i[r]}`)).join("")}(d),a=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(null!==(r=t.suffix)&&void 0!==r?r:""))}u&&(s=s?`${u}_${s}`:u)}return a&&(s=`${s}_${a}`),o&&(s=`${o}_${s}`),t.forAs?k3(s):t.expr?Mne(s,t.expr)+l:Po(s)+l}function JS(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return he(e)&&!!e.bin;case"temporal":return!1}throw new Error(die(e.type))}const ore=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return function vHe(e){const{aggregate:t,bin:n,timeUnit:i,field:r}=e;if(Bf(t))return`${r} for argmax(${t.argmax})`;if(Xu(t))return`${r} for argmin(${t.argmin})`;const s=Yr(i),o=t||(null==s?void 0:s.unit)||(null==s?void 0:s.maxbins)&&"timeunit"||mn(n)&&"bin";return o?`${o.toUpperCase()}(${r})`:r}(e);default:return function yHe(e,t){var n;const{field:i,bin:r,timeUnit:s,aggregate:o}=e;if("count"===o)return t.countTitle;if(mn(r))return`${i} (binned)`;if(s){const a=null===(n=Yr(s))||void 0===n?void 0:n.unit;if(a)return`${i} (${J3(a).join("-")})`}else if(o)return Bf(o)?`${i} for max ${o.argmax}`:Xu(o)?`${i} for min ${o.argmin}`:`${Fv(o)} of ${i}`;return i}(e,t)}};let are=ore;function lre(e){are=e}function Pm(e,t,{allowDisabling:n,includeDefault:i=!0}){var r,s;const o=null===(r=wj(e))||void 0===r?void 0:r.title;if(!he(e))return null!=o?o:e.title;const a=e,l=i?Dj(a,t):void 0;return n?fi(o,a.title,l):null!==(s=null!=o?o:a.title)&&void 0!==s?s:l}function wj(e){return bj(e)&&e.axis?e.axis:rre(e)&&e.legend?e.legend:_j(e)&&e.header?e.header:void 0}function Dj(e,t){return are(e,t)}function XS(e){var t;if(sre(e)){const{format:n,formatType:i}=e;return{format:n,formatType:i}}{const n=null!==(t=wj(e))&&void 0!==t?t:{},{format:i,formatType:r}=n;return{format:i,formatType:r}}}function Wl(e){return he(e)?e:qS(e)?e.condition:void 0}function Ci(e){return We(e)?e:Wv(e)?e.condition:void 0}function ure(e,t,n,i={}){return _e(e)||Xt(e)||Fc(e)?(le(function S6e(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${gn(n)}}.`}(t,_e(e)?"string":Xt(e)?"number":"boolean",e)),{value:e}):We(e)?QS(e,t,n,i):Wv(e)?Object.assign(Object.assign({},e),{condition:QS(e.condition,t,n,i)}):e}function QS(e,t,n,i){if(sre(e)){const{formatType:s}=e,o=yj(e,["format","formatType"]);if(Ph(s)&&!n.customFormatTypes)return le(fie(t)),QS(o,t,n,i)}else{const r=bj(e)?"axis":rre(e)?"legend":_j(e)?"header":null;if(r&&e[r]){const s=e[r],{formatType:a}=s,l=yj(s,["format","formatType"]);if(Ph(a)&&!n.customFormatTypes)return le(fie(t)),QS(Object.assign(Object.assign({},e),{[r]:l}),t,n,i)}}return he(e)?Cj(e,t,i):function DHe(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=Xt(n)?"quantitative":_e(n)?"nominal":kh(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}(e)}function Cj(e,t,{compositeMark:n=!1}={}){const{aggregate:i,timeUnit:r,bin:s,field:o}=e,a=Object.assign({},e);if(!n&&i&&!$3(i)&&!Bf(i)&&!Xu(i)&&(le(function A6e(e){return`Invalid aggregation operator "${e}".`}(i)),delete a.aggregate),r&&(a.timeUnit=Yr(r)),o&&(a.field=`${o}`),mn(s)&&(a.bin=ZS(s,t)),qr(s)&&!Ji(t)&&le(function oVe(e){return`Channel ${e} should not be used with "binned" bin.`}(t)),Bo(a)){const{type:l}=a,u=function NVe(e){if(e)switch(e=e.toLowerCase(),e){case"q":case Rh:return"quantitative";case"t":case km:return"temporal";case"o":case sj:return"ordinal";case"n":case oj:return"nominal";case Im:return"geojson"}}(l);l!==u&&(a.type=u),"quantitative"!==l&&Gne(i)&&(le(function x6e(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}(l,i)),a.type="quantitative")}else if(!$ne(t)){const l=function wHe(e,t){var n;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(vj(e)&&Z(e.sort))return"ordinal";const{aggregate:i,bin:r,timeUnit:s}=e;if(s)return"temporal";if(r||i&&!Bf(i)&&!Xu(i))return"quantitative";if(Lh(e)&&(null===(n=e.scale)||void 0===n?void 0:n.type))switch(PS[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}(a,t);a.type=l}if(Bo(a)){const{compatible:l,warning:u}=function CHe(e,t){const n=e.type;if("geojson"===n&&"shape"!==t)return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case zu:case Gu:case DS:return JS(e)?Lm:{compatible:!1,warning:k6e(t)};case Pn:case Li:case kf:case Om:case vs:case jl:case Bl:case jv:case $v:case CS:case Th:case ES:case SS:case Ah:case Na:case Fl:case xS:return Lm;case Ll:case Lo:case Pl:case ka:return n!==Rh?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Lm;case Ku:case If:case Rf:case Ff:case Yu:case qu:case Wu:case Ma:case Rl:return"nominal"!==n||e.sort?Lm:{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`};case bs:case Pf:return JS(e)||function mHe(e){var t;return Lh(e)&&Rm(null===(t=e.scale)||void 0===t?void 0:t.type)}(e)?Lm:{compatible:!1,warning:I6e(t)};case Bv:return"nominal"!==e.type||"sort"in e?Lm:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(a,t)||{};!1===l&&le(u)}if(vj(a)&&_e(a.sort)){const{sort:l}=a;if(Xie(l))return Object.assign(Object.assign({},a),{sort:{encoding:l}});const u=l.substr(1);if("-"===l.charAt(0)&&Xie(u))return Object.assign(Object.assign({},a),{sort:{encoding:u,order:"descending"}})}if(_j(a)){const{header:l}=a;if(l){const{orient:u}=l,c=yj(l,["orient"]);if(u)return Object.assign(Object.assign({},a),{header:Object.assign(Object.assign({},c),{labelOrient:l.labelOrient||u,titleOrient:l.titleOrient||u})})}}return a}function ZS(e,t){return Fc(e)?{maxbins:qne(t)}:"binned"===e?{binned:!0}:e.maxbins||e.step?e:Object.assign(Object.assign({},e),{maxbins:qne(t)})}const Lm={compatible:!0};function jm(e){const{formatType:t}=XS(e);return"time"===t||!t&&function EHe(e){return e&&("temporal"===e.type||he(e)&&!!e.timeUnit)}(e)}function ex(e,{timeUnit:t,type:n,wrapTime:i,undefinedIfExprNotRequired:r}){var s;const o=t&&(null===(s=Yr(t))||void 0===s?void 0:s.unit);let l,a=o||"temporal"===n;return Vv(e)?l=e.expr:Ne(e)?l=e.signal:kh(e)?(a=!0,l=Uv(e)):(_e(e)||Xt(e))&&a&&(l=`datetime(${gn(e)})`,function bVe(e){return!!Cie[e]}(o)&&(Xt(e)&&e<1e4||_e(e)&&isNaN(Date.parse(e)))&&(l=Uv({[o]:e}))),l?i&&a?`time(${l})`:l:r?void 0:gn(e)}function cre(e,t){const{type:n}=e;return t.map(i=>{const r=ex(i,{timeUnit:he(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==r?{signal:r}:i})}function qv(e,t){return mn(e.bin)?jf(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const fre={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function Yv(e){return e&&e.condition}const dre=["domain","grid","labels","ticks","title"],SHe={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},hre={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},pre=Object.assign(Object.assign({},hre),{style:1,labelExpr:1,encoding:1});function gre(e){return!!pre[e]}ie(pre);const mre=ie({axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1});function ec(e){return"mark"in e}class tx{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return!!ec(t)&&function iHe(e){return Ra(e)?e.type:e}(t.mark)===this.name}}function jh(e,t){const n=e&&e[t];return!!n&&(Z(n)?Sh(n,i=>!!i.field):he(n)||qS(n))}function _re(e,t){const n=e&&e[t];return!!n&&(Z(n)?Sh(n,i=>!!i.field):he(n)||zl(n)||Wv(n))}function Ej(e,t){if(Ji(t)){const n=e[t];if((he(n)||zl(n))&&Tie(n.type))return _re(e,Vne(t))}return!1}function Sj(e){return Sh(I4e,t=>{if(jh(e,t)){const n=e[t];if(Z(n))return Sh(n,i=>!!i.aggregate);{const i=Wl(n);return i&&!!i.aggregate}}return!1})}function yre(e,t){const n=[],i=[],r=[],s=[],o={};return xj(e,(a,l)=>{if(he(a)){const{field:u,aggregate:c,bin:f,timeUnit:d}=a,h=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(a,["field","aggregate","bin","timeUnit"]);if(c||d||f){const p=wj(a),g=null==p?void 0:p.title;let m=pe(a,{forAs:!0});const _=Object.assign(Object.assign(Object.assign({},g?[]:{title:Pm(a,t,{allowDisabling:!0})}),h),{field:m});if(c){let y;if(Bf(c)?(y="argmax",m=pe({op:"argmax",field:c.argmax},{forAs:!0}),_.field=`${m}.${u}`):Xu(c)?(y="argmin",m=pe({op:"argmin",field:c.argmin},{forAs:!0}),_.field=`${m}.${u}`):"boxplot"!==c&&"errorbar"!==c&&"errorband"!==c&&(y=c),y){const v={op:y,as:m};u&&(v.field=u),s.push(v)}}else if(n.push(m),Bo(a)&&mn(f))i.push({bin:f,field:u,as:m}),n.push(pe(a,{binSuffix:"end"})),qv(a,l)&&n.push(pe(a,{binSuffix:"range"})),Ji(l)&&(o[`${l}2`]={field:`${m}_end`}),_.bin="binned",$ne(l)||(_.type=Rh);else if(d){r.push({timeUnit:d,field:u,as:m});const y=Bo(a)&&a.type!==km&&"time";y&&(l===jv||l===Th?_.formatType=y:function V4e(e){return!!OS[e]}(l)?_.legend=Object.assign({formatType:y},_.legend):Ji(l)&&(_.axis=Object.assign({formatType:y},_.axis)))}o[l]=_}else n.push(u),o[l]=e[l]}else o[l]=e[l]}),{bins:i,timeUnits:r,aggregate:s,groupby:n,encoding:o}}function AHe(e,t,n){const i=function U4e(e,t){return function G4e(e){switch(e){case vs:case jl:case Bl:case xS:case $v:case CS:case Th:case ES:case Bv:case Ku:case If:case Rf:case Ff:case DS:case zu:case Gu:return j3;case Pn:case Li:case kf:case Om:case Pl:case Ll:return z4e;case Ma:case Rl:case ka:case Lo:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case Yu:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Pf:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case bs:return{point:"always",geoshape:"always"};case jv:return{text:"always"};case Ah:return{point:"always",square:"always",text:"always"};case SS:return{image:"always"};case Na:case Fl:return{text:"always",arc:"always"};case qu:case Wu:return{arc:"always"}}}(e)[t]}(t,n);if(!i)return!1;if("binned"===i){const r=e[t===Ma?Pn:Li];return!!(he(r)&&he(e[t])&&qr(r.bin))}return!0}function nx(e,t){const n={};for(const i of ie(e)){const r=ure(e[i],i,t,{compositeMark:!0});n[i]=r}return n}function xj(e,t,n){if(e)for(const i of ie(e)){const r=e[i];if(Z(r))for(const s of r)t.call(n,s,i);else t.call(n,r,i)}}function vre(e,t){return ie(t).reduce((n,i)=>{switch(i){case Pn:case Li:case ES:case xS:case SS:case Ma:case Rl:case kf:case Om:case Na:case qu:case Fl:case Wu:case Pl:case Ll:case ka:case Lo:case jv:case bs:case Ah:case Th:return n;case Bv:if("line"===e||"trail"===e)return n;case $v:case CS:{const r=t[i];if(Z(r)||he(r))for(const s of ve(r))s.aggregate||n.push(pe(s,{}));return n}case Yu:if("trail"===e)return n;case vs:case jl:case Bl:case Ku:case If:case Rf:case Pf:case Ff:{const r=Wl(t[i]);return r&&!r.aggregate&&n.push(pe(r,{})),n}}},[])}var bre=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Aj(e,t,n,i=!0){if("tooltip"in n)return{tooltip:n.tooltip};const r=e.map(({fieldPrefix:o,titlePrefix:a})=>{const l=i?` of ${Tj(t)}`:"";return{field:o+t.field,type:t.type,title:Ne(a)?{signal:`${a}"${escape(l)}"`}:a+l}}),s=function OHe(e){const t=[];for(const n of ie(e))if(jh(e,n)){const r=ve(e[n]);for(const s of r)he(s)?t.push(s):qS(s)&&t.push(s.condition)}return t}(n).map(pHe);return{tooltip:[...r,...Il(s,vt)]}}function Tj(e){const{title:t,field:n}=e;return fi(t,n)}function Oj(e,t,n,i,r){const{scale:s,axis:o}=n;return({partName:a,mark:l,positionPrefix:u,endPositionPrefix:c,extraEncoding:f={}})=>{const d=Tj(n);return wre(e,a,r,{mark:l,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:`${u}_${n.field}`,type:n.type},void 0!==d?{title:d}:{}),void 0!==s?{scale:s}:{}),void 0!==o?{axis:o}:{})},_e(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{}),i),f)})}}function wre(e,t,n,i){const{clip:r,color:s,opacity:o}=e,a=e.type;return e[t]||void 0===e[t]&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),r?{clip:r}:{}),s?{color:s}:{}),o?{opacity:o}:{}),Ra(i.mark)?i.mark:{type:i.mark}),{style:`${a}-${t}`}),Fc(e[t])?{}:e[t])})]:[]}function Dre(e,t,n){const{encoding:i}=e,r="vertical"===t?"y":"x",o=i[`${r}2`],a=i[`${r}Error`],l=i[`${r}Error2`];return{continuousAxisChannelDef:ix(i[r],n),continuousAxisChannelDef2:ix(o,n),continuousAxisChannelDefError:ix(a,n),continuousAxisChannelDefError2:ix(l,n),continuousAxis:r}}function ix(e,t){if(null==e?void 0:e.aggregate){const{aggregate:n}=e,i=bre(e,["aggregate"]);return n!==t&&le(function sVe(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}(n,t)),i}return e}function Cre(e,t){const{mark:n,encoding:i}=e,{x:r,y:s}=i;if(Ra(n)&&n.orient)return n.orient;if(Gl(r)){if(Gl(s)){const o=he(r)&&r.aggregate,a=he(s)&&s.aggregate;if(!o&&a===t)return"vertical";if(!a&&o===t)return"horizontal";if(o===t&&a===t)throw new Error("Both x and y cannot have aggregate");return jm(s)&&!jm(r)?"horizontal":"vertical"}return"horizontal"}if(Gl(s))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}var rx=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};const sx="boxplot",IHe=new tx(sx,Sre);function Ere(e){return Xt(e)?"tukey":e}function Sre(e,{config:t}){var n,i;e=Object.assign(Object.assign({},e),{encoding:nx(e.encoding,t)});const{mark:r,params:o}=e,l=rx(e,["mark","encoding","params","projection"]),u=Ra(r)?r:{type:r};o&&le(lie("boxplot"));const c=null!==(n=u.extent)&&void 0!==n?n:t.boxplot.extent,f=Gt("size",u,t),d=Ere(c),{bins:h,timeUnits:p,transform:g,continuousAxisChannelDef:m,continuousAxis:_,groupby:y,aggregate:v,encodingWithoutContinuousAxis:b,ticksOrient:D,boxOrient:C,customTooltipWithoutAggregatedField:w}=function RHe(e,t,n){const i=Cre(e,sx),{continuousAxisChannelDef:r,continuousAxis:s}=Dre(e,i,sx),o=r.field,a=Ere(t),l=[...xre(o),{op:"median",field:o,as:`mid_box_${o}`},{op:"min",field:o,as:("min-max"===a?"lower_whisker_":"min_")+o},{op:"max",field:o,as:("min-max"===a?"upper_whisker_":"max_")+o}],u="min-max"===a||"tukey"===a?[]:[{calculate:`datum["upper_box_${o}"] - datum["lower_box_${o}"]`,as:`iqr_${o}`},{calculate:`min(datum["upper_box_${o}"] + datum["iqr_${o}"] * ${t}, datum["max_${o}"])`,as:`upper_whisker_${o}`},{calculate:`max(datum["lower_box_${o}"] - datum["iqr_${o}"] * ${t}, datum["min_${o}"])`,as:`lower_whisker_${o}`}],h=rx(e.encoding,["symbol"==typeof s?s:s+""]),{customTooltipWithoutAggregatedField:p,filteredEncoding:g}=function NHe(e){const{tooltip:t}=e,n=bre(e,["tooltip"]);if(!t)return{filteredEncoding:n};let i,r;if(Z(t)){for(const s of t)s.aggregate?(i||(i=[]),i.push(s)):(r||(r=[]),r.push(s));i&&(n.tooltip=i)}else t.aggregate?n.tooltip=t:r=t;return Z(r)&&1===r.length&&(r=r[0]),{customTooltipWithoutAggregatedField:r,filteredEncoding:n}}(h),{bins:m,timeUnits:_,aggregate:y,groupby:v,encoding:b}=yre(g,n),D="vertical"===i?"horizontal":"vertical",C=i;return{bins:m,timeUnits:_,transform:[...m,..._,{aggregate:[...y,...l],groupby:v},...u],groupby:v,aggregate:y,continuousAxisChannelDef:r,continuousAxis:s,encodingWithoutContinuousAxis:b,ticksOrient:D,boxOrient:C,customTooltipWithoutAggregatedField:p}}(e,c,t),{color:E,size:O}=b,M=rx(b,["color","size"]),N=Ae=>Oj(u,_,m,Ae,t.boxplot),R=N(M),P=N(b),A=N(Object.assign(Object.assign({},M),O?{size:O}:{})),x=Aj([{fieldPrefix:"min-max"===d?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===d?"lower_whisker_":"min_",titlePrefix:"Min"}],m,b),S={type:"tick",color:"black",opacity:1,orient:D,invalid:null,aria:!1},k="min-max"===d?x:Aj([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],m,b),T=[...R({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:k}),...R({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:k}),...R({partName:"ticks",mark:S,positionPrefix:"lower_whisker",extraEncoding:k}),...R({partName:"ticks",mark:S,positionPrefix:"upper_whisker",extraEncoding:k})],F=[..."tukey"!==d?T:[],...P({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:C,invalid:null,ariaRoleDescription:"box"}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:x}),...A({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},Ce(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),f?{size:f}:{}),{orient:D,aria:!1}),positionPrefix:"mid_box",extraEncoding:x})];if("min-max"===d)return Object.assign(Object.assign({},l),{transform:(null!==(i=l.transform)&&void 0!==i?i:[]).concat(g),layer:F});const I=`datum["lower_box_${m.field}"]`,j=`datum["upper_box_${m.field}"]`,V=`(${j} - ${I})`,U=`${I} - ${c} * ${V}`,L=`${j} + ${c} * ${V}`,W=`datum["${m.field}"]`,te={joinaggregate:xre(m.field),groupby:y},q={transform:[{filter:`(${U} <= ${W}) && (${W} <= ${L})`},{aggregate:[{op:"min",field:m.field,as:`lower_whisker_${m.field}`},{op:"max",field:m.field,as:`upper_whisker_${m.field}`},{op:"min",field:`lower_box_${m.field}`,as:`lower_box_${m.field}`},{op:"max",field:`upper_box_${m.field}`,as:`upper_box_${m.field}`},...v],groupby:y}],layer:T},G=rx(M,["tooltip"]),{scale:X,axis:ee}=m,z=Tj(m),de=Zs(ee,["title"]),ye=wre(u,"outliers",t.boxplot,{transform:[{filter:`(${W} < ${U}) || (${W} > ${L})`}],mark:"point",encoding:Object.assign(Object.assign(Object.assign({[_]:Object.assign(Object.assign(Object.assign({field:m.field,type:m.type},void 0!==z?{title:z}:{}),void 0!==X?{scale:X}:{}),Zt(de)?{}:{axis:de})},G),E?{color:E}:{}),w?{tooltip:w}:{})})[0];let ke;const De=[...h,...p,te];return ye?ke={transform:De,layer:[ye,q]}:(ke=q,ke.transform.unshift(...De)),Object.assign(Object.assign({},l),{layer:[ke,{transform:g,layer:F}]})}function xre(e){return[{op:"q1",field:e,as:`lower_box_${e}`},{op:"q3",field:e,as:`upper_box_${e}`}]}var Are=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};const Mj="errorbar",PHe=new tx(Mj,Tre);function Tre(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:nx(e.encoding,t)});const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,ticksOrient:o,markDef:a,outerSpec:l,tooltipEncoding:u}=Ore(e,Mj,t);delete s.size;const c=Oj(a,r,i,s,t.errorbar),f=a.thickness,d=a.size,h=Object.assign(Object.assign({type:"tick",orient:o,aria:!1},void 0!==f?{thickness:f}:{}),void 0!==d?{size:d}:{}),p=[...c({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:u}),...c({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:u}),...c({partName:"rule",mark:Object.assign({type:"rule",ariaRoleDescription:"errorbar"},void 0!==f?{size:f}:{}),positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u})];return Object.assign(Object.assign(Object.assign({},l),{transform:n}),p.length>1?{layer:p}:Object.assign({},p[0]))}function Ore(e,t,n){var i;const{mark:r,encoding:s,params:o}=e,l=Are(e,["mark","encoding","params","projection"]),u=Ra(r)?r:{type:r};o&&le(lie(t));const{orient:c,inputType:f}=function LHe(e,t){const{encoding:n}=e;if(function jHe(e){return(We(e.x)||We(e.y))&&!We(e.x2)&&!We(e.y2)&&!We(e.xError)&&!We(e.xError2)&&!We(e.yError)&&!We(e.yError2)}(n))return{orient:Cre(e,t),inputType:"raw"};const i=function BHe(e){return We(e.x2)||We(e.y2)}(n),r=function $He(e){return We(e.xError)||We(e.xError2)||We(e.yError)||We(e.yError2)}(n),s=n.x,o=n.y;if(i){if(r)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const a=n.x2,l=n.y2;if(We(a)&&We(l))throw new Error(`${t} cannot have both x2 and y2`);if(We(a)){if(Gl(s))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}if(We(l)){if(Gl(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}{const a=n.xError,u=n.yError,c=n.yError2;if(We(n.xError2)&&!We(a))throw new Error(`${t} cannot have xError2 without xError`);if(We(c)&&!We(u))throw new Error(`${t} cannot have yError2 without yError`);if(We(a)&&We(u))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(We(a)){if(Gl(s))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(We(u)){if(Gl(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}(e,t),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:g,continuousAxis:m}=Dre(e,c,t),{errorBarSpecificAggregate:_,postAggregateCalculates:y,tooltipSummary:v,tooltipTitleWithFieldName:b}=function VHe(e,t,n,i,r,s,o,a){let l=[],u=[];const c=t.field;let f,d=!1;if("raw"===s){const h=e.center?e.center:e.extent?"iqr"===e.extent?"median":"mean":a.errorbar.center,p=e.extent?e.extent:"mean"===h?"stderr":"iqr";if("median"===h!=("iqr"===p)&&le(function rVe(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}(h,p,o)),"stderr"===p||"stdev"===p)l=[{op:p,field:c,as:`extent_${c}`},{op:h,field:c,as:`center_${c}`}],u=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:Fv(h)},{fieldPrefix:"upper_",titlePrefix:Mre(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:Mre(h,p,"-")}],d=!0;else{let g,m,_;"ci"===p?(g="mean",m="ci0",_="ci1"):(g="median",m="q1",_="q3"),l=[{op:m,field:c,as:`lower_${c}`},{op:_,field:c,as:`upper_${c}`},{op:g,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:Pm({field:c,aggregate:_,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Pm({field:c,aggregate:m,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Pm({field:c,aggregate:g,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&le(function iVe(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}(e.center,e.extent)),"aggregated-upper-lower"===s?(f=[],u=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):"aggregated-error"===s&&(f=[{fieldPrefix:"",titlePrefix:c}],u=[{calculate:`datum["${c}"] + datum["${i.field}"]`,as:`upper_${c}`}],u.push(r?{calculate:`datum["${c}"] + datum["${r.field}"]`,as:`lower_${c}`}:{calculate:`datum["${c}"] - datum["${i.field}"]`,as:`lower_${c}`}));for(const h of u)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:xh(xh(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:l,tooltipSummary:f,tooltipTitleWithFieldName:d}}(u,d,h,p,g,f,t,n),E="x"===m?"x2":"y2",M="x"===m?"xError":"yError",R="x"===m?"xError2":"yError2",A=Are(s,["symbol"==typeof m?m:m+"","symbol"==typeof E?E:E+"","symbol"==typeof M?M:M+"","symbol"==typeof R?R:R+""]),{bins:x,timeUnits:S,aggregate:k,groupby:T,encoding:F}=yre(A,n),I=[...k,..._],j="raw"!==f?[]:T,V=Aj(v,d,F,b);return{transform:[...null!==(i=l.transform)&&void 0!==i?i:[],...x,...S,...0===I.length?[]:[{aggregate:I,groupby:j}],...y],groupby:j,continuousAxisChannelDef:d,continuousAxis:m,encodingWithoutContinuousAxis:F,ticksOrient:"vertical"===c?"horizontal":"vertical",markDef:u,outerSpec:l,tooltipEncoding:V}}function Mre(e,t,n){return`${Fv(e)} ${n} ${t}`}const Nj="errorband",UHe=new tx(Nj,Nre);function Nre(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:nx(e.encoding,t)});const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,markDef:o,outerSpec:a,tooltipEncoding:l}=Ore(e,Nj,t),u=o,c=Oj(u,r,i,s,t.errorband),f=void 0!==e.encoding.x&&void 0!==e.encoding.y;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const p=Object.assign(Object.assign({},u.interpolate?{interpolate:u.interpolate}:{}),u.tension&&u.interpolate?{tension:u.tension}:{});return f?(d=Object.assign(Object.assign(Object.assign({},d),p),{ariaRoleDescription:"errorband"}),h=Object.assign(Object.assign(Object.assign({},h),p),{aria:!1})):u.interpolate?le(_ie("interpolate")):u.tension&&le(_ie("tension")),Object.assign(Object.assign({},a),{transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l}),...c({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:l}),...c({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:l})]})}const kj={};function Ij(e,t,n){const i=new tx(e,t);kj[e]={normalizer:i,parts:n}}Ij(sx,Sre,["box","median","outliers","rule","ticks"]),Ij(Mj,Tre,["ticks","rule"]),Ij(Nj,Nre,["band","borders"]);const GHe=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],kre={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},Ire={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},WHe=ie(kre),qHe=ie(Ire),Rre=ie({header:1,headerRow:1,headerColumn:1,headerFacet:1}),Fre=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],Pre={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Kv=(ie(Pre),"_vgsid_"),KHe={point:{on:"click",fields:[Kv],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function Rj(e){return!(!e||"legend"!==e&&!e.legend)}function Fj(e){return Rj(e)&&Ce(e)}function Pj(e){return!!e.select}var JHe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Lre(e){const t=[];for(const n of e||[]){if(Pj(n))continue;const{expr:i,bind:r}=n,s=JHe(n,["expr","bind"]);if(r&&i){const o=Object.assign(Object.assign({},s),{bind:r,init:i});t.push(o)}else{const o=Object.assign(Object.assign(Object.assign({},s),i?{update:i}:{}),r?{bind:r}:{});t.push(o)}}return t}function Lj(e){return"concat"in e}function ox(e){return"vconcat"in e}function jj(e){return"hconcat"in e}function jre({step:e,offsetIsDiscrete:t}){var n;return t?null!==(n=e.for)&&void 0!==n?n:"offset":"position"}function ql(e){return Ce(e)&&void 0!==e.step}function Bre(e){return e.view||e.width||e.height}const QHe=ie({align:1,bounds:1,center:1,columns:1,spacing:1});function Bj(e,t){var n;return null!==(n=e[t])&&void 0!==n?n:e["width"===t?"continuousWidth":"continuousHeight"]}function ax(e,t){const n=lx(e,t);return ql(n)?n.step:Vre}function lx(e,t){var n;return fi(null!==(n=e[t])&&void 0!==n?n:e["width"===t?"discreteWidth":"discreteHeight"],{step:e.step})}const Vre=20,nUe={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:Vre},mark:{color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},arc:{},area:{},bar:{binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},circle:{},geoshape:{},image:{},line:{},point:{},rect:{binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5},rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:KHe,style:{},title:{},facet:{spacing:20},concat:{spacing:20}},tc=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],Hre={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},Ure={blue:tc[0],orange:tc[1],red:tc[2],teal:tc[3],green:tc[4],yellow:tc[5],purple:tc[6],pink:tc[7],brown:tc[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function zre(e){const t=ie(e||{}),n={};for(const i of t){const r=e[i];n[i]=Yv(r)?Kne(r):eo(r)}return n}const aUe=[...Hie,...mre,...Rre,"background","padding","legend","lineBreak","scale","style","title","view"];function Gre(e={}){const{color:t,font:n,fontSize:i,selection:r}=e,s=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["color","font","fontSize","selection"]),o=mg({},Je(nUe),n?function sUe(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}(n):{},t?function iUe(e={}){return{signals:[{name:"color",value:Ce(e)?Object.assign(Object.assign({},Ure),e):Ure}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(t):{},i?function rUe(e){return{signals:[{name:"fontSize",value:Ce(e)?Object.assign(Object.assign({},Hre),e):Hre}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(i):{},s||{});r&&_g(o,"selection",r,!0);const a=Zs(o,aUe);for(const l of["background","lineBreak","padding"])o[l]&&(a[l]=eo(o[l]));for(const l of Hie)o[l]&&(a[l]=Ds(o[l]));for(const l of mre)o[l]&&(a[l]=zre(o[l]));for(const l of Rre)o[l]&&(a[l]=Ds(o[l]));return o.legend&&(a.legend=Ds(o.legend)),o.scale&&(a.scale=Ds(o.scale)),o.style&&(a.style=function oUe(e){const t=ie(e),n={};for(const i of t)n[i]=zre(e[i]);return n}(o.style)),o.title&&(a.title=Ds(o.title)),o.view&&(a.view=Ds(o.view)),a}const lUe=new Set(["view",...$ie]),uUe=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],cUe=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},{area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]});function hUe(e,t,n,i){"view"===t&&(n="cell");const s=Object.assign(Object.assign({},i?e[t][i]:e[t]),e.style[null!=n?n:t]);Zt(s)||(e.style[null!=n?n:t]=s),i||delete e[t]}function ux(e){return"layer"in e}class $j{map(t,n){return GS(t)?this.mapFacet(t,n):function pUe(e){return"repeat"in e}(t)?this.mapRepeat(t,n):jj(t)?this.mapHConcat(t,n):ox(t)?this.mapVConcat(t,n):Lj(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(ux(t))return this.mapLayer(t,n);if(ec(t))return this.mapUnit(t,n);throw new Error(U3(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(i=>this.mapLayerOrUnit(i,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(i=>this.map(i,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(i=>this.map(i,n))})}mapConcat(t,n){const{concat:i}=t,r=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["concat"]);return Object.assign(Object.assign({},r),{concat:i.map(s=>this.map(s,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const _Ue={zero:1,center:1,normalize:1},vUe=new Set([Pie,jS,LS,VS,$S,cj,fj,BS,Lie,uj]),bUe=new Set([jS,LS,Pie]);function Bm(e){return he(e)&&"quantitative"===YS(e)&&!e.bin}function Wre(e,t){var n,i;const r="x"===t?"y":"radius",s=e[t],o=e[r];if(he(s)&&he(o))if(Bm(s)&&Bm(o)){if(s.stack)return t;if(o.stack)return r;const a=he(s)&&!!s.aggregate;if(a!==(he(o)&&!!o.aggregate))return a?t:r;{const u=null===(n=s.scale)||void 0===n?void 0:n.type,c=null===(i=o.scale)||void 0===i?void 0:i.type;if(u&&"linear"!==u)return r;if(c&&"linear"!==c)return t}}else{if(Bm(s))return t;if(Bm(o))return r}else{if(Bm(s))return t;if(Bm(o))return r}}function qre(e,t,n={}){var i,r;const s=Ra(e)?e.type:e;if(!vUe.has(s))return null;const o=Wre(t,"x")||Wre(t,"theta");if(!o)return null;const a=t[o],l=he(a)?pe(a,{}):void 0,u=function wUe(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(o),c=[],f=new Set;if(t[u]){const p=t[u],g=he(p)?pe(p,{}):void 0;g&&g!==l&&(c.push(u),f.add(g));const m="x"===u?"xOffset":"yOffset",_=t[m],y=he(_)?pe(_,{}):void 0;y&&y!==l&&(c.push(m),f.add(y))}const d=j4e.reduce((p,g)=>{if("tooltip"!==g&&jh(t,g)){const m=t[g];for(const _ of ve(m)){const y=Wl(_);if(y.aggregate)continue;const v=pe(y,{});(!v||!f.has(v))&&p.push({channel:g,fieldDef:y})}}return p},[]);let h;if(void 0!==a.stack?h=Fc(a.stack)?a.stack?"zero":null:a.stack:bUe.has(s)&&(h="zero"),!h||!function yUe(e){return e in _Ue}(h)||Sj(t)&&0===d.length)return null;if((null===(i=null==a?void 0:a.scale)||void 0===i?void 0:i.type)&&"linear"!==(null===(r=null==a?void 0:a.scale)||void 0===r?void 0:r.type)){if(n.disallowNonLinearStack)return null;le(function eVe(e){return`Cannot stack non-linear scale (${e}).`}(a.scale.type))}return We(t[Ju(o)])?(void 0!==a.stack&&le(function Z6e(e){return`Cannot stack "${e}" if there is already "${e}2".`}(o)),null):(he(a)&&a.aggregate&&!J4e.has(a.aggregate)&&le(function tVe(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}(a.aggregate)),{groupbyChannels:c,groupbyFields:f,fieldChannel:o,impute:null!==a.impute&&Uf(s),stackBy:d,offset:h})}var Yre=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function DUe(e){const i=Yre(e,["point","line"]);return ie(i).length>1?i:i.type}function CUe(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:Zs(e[t],["point","line"])}));return e}function Vj(e,t={},n){return"transparent"===e.point?{opacity:0}:e.point?Ce(e.point)?e.point:{}:void 0!==e.point?null:t.point||n.shape?Ce(t.point)?t.point:{}:void 0}function Kre(e,t={}){return e.line?!0===e.line?{}:e.line:void 0!==e.line?null:t.line?!0===t.line?{}:t.line:void 0}class EUe{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(ec(t)){const{mark:i,encoding:r}=t,s=Ra(i)?i:{type:i};switch(s.type){case"line":case"rule":case"trail":return!!Vj(s,n[s.type],r);case"area":return!!Vj(s,n[s.type],r)||!!Kre(s,n[s.type])}}return!1}run(t,n,i){const{config:r}=n,{params:s,projection:o,mark:a,encoding:l}=t,u=Yre(t,["params","projection","mark","encoding"]),c=nx(l,r),f=Ra(a)?a:{type:a},d=Vj(f,r[f.type],c),h="area"===f.type&&Kre(f,r[f.type]),p=[Object.assign(Object.assign({},s?{params:s}:{}),{mark:DUe(Object.assign(Object.assign({},"area"===f.type&&void 0===f.opacity&&void 0===f.fillOpacity?{opacity:.7}:{}),f)),encoding:Zs(c,["shape"])})],g=qre(f,c);let m=c;if(g){const{fieldChannel:_,offset:y}=g;m=Object.assign(Object.assign({},c),{[_]:Object.assign(Object.assign({},c[_]),y?{stack:y}:{})})}return h&&p.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},Am(f,["clip","interpolate","tension","tooltip"])),h),encoding:m})),d&&p.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},Am(f,["clip","tooltip"])),d),encoding:m})),i(Object.assign(Object.assign({},u),{layer:p}),Object.assign(Object.assign({},n),{config:CUe(r)}))}}function xUe(e,t){return t?Gv(e)?Zre(e,t):Jre(e,t):e}function Hj(e,t){return t?Zre(e,t):e}function Uj(e,t,n){const i=t[e];return function dHe(e){return e&&!_e(e)&&"repeat"in e}(i)?i.repeat in n?Object.assign(Object.assign({},t),{[e]:n[i.repeat]}):void le(function g6e(e){return`Unknown repeated value "${e}".`}(i.repeat)):t}function Jre(e,t){if(void 0!==(e=Uj("field",e,t))){if(null===e)return null;if(vj(e)&&Ul(e.sort)){const n=Uj("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function Xre(e,t){if(he(e))return Jre(e,t);{const n=Uj("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function Qre(e,t){if(!We(e)){if(Wv(e)){const n=Xre(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["condition"])}return e}{const n=Xre(e,t);if(n)return n;if(WS(e))return{condition:e.condition}}}function Zre(e,t){const n={};for(const i in e)if(Oe(e,i)){const r=e[i];if(Z(r))n[i]=r.map(s=>Qre(s,t)).filter(s=>s);else{const s=Qre(r,t);void 0!==s&&(n[i]=s)}}return n}class AUe{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(ec(t)){const{encoding:n,mark:i}=t;if("line"===i||Ra(i)&&"line"===i.type)for(const r of F4e){const o=n[Oh(r)];if(n[r]&&(he(o)&&!qr(o.bin)||zl(o)))return!0}}return!1}run(t,n,i){const{encoding:r,mark:s}=t;return le(function P6e(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}(!!r.x2,!!r.y2)),i(Object.assign(Object.assign({},t),{mark:Ce(s)?Object.assign(Object.assign({},s),{type:"rule"}):"rule"}),n)}}var zf=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function ese({parentEncoding:e,encoding:t={},layer:n}){let i={};if(e){const r=new Set([...ie(e),...ie(t)]);for(const s of r){const o=t[s],a=e[s];if(We(o)){const l=Object.assign(Object.assign({},a),o);i[s]=l}else Wv(o)?i[s]=Object.assign(Object.assign({},o),{condition:Object.assign(Object.assign({},a),o.condition)}):o||null===o?i[s]=o:(n||Fa(a)||Ne(a)||We(a)||Z(a))&&(i[s]=a)}}else i=t;return!i||Zt(i)?void 0:i}function tse(e){const{parentProjection:t,projection:n}=e;return t&&n&&le(function w6e(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${gn(t)} is overridden by a child projection ${gn(n)}.`}({parentProjection:t,projection:n})),null!=n?n:t}function zj(e){return"filter"in e}function OUe(e){return void 0!==(null==e?void 0:e.stop)}function nse(e){return"lookup"in e}function kUe(e){return"pivot"in e}function IUe(e){return"density"in e}function RUe(e){return"quantile"in e}function FUe(e){return"regression"in e}function PUe(e){return"loess"in e}function LUe(e){return"sample"in e}function jUe(e){return"window"in e}function BUe(e){return"joinaggregate"in e}function $Ue(e){return"flatten"in e}function VUe(e){return"calculate"in e}function ise(e){return"bin"in e}function HUe(e){return"impute"in e}function UUe(e){return"timeUnit"in e}function zUe(e){return"aggregate"in e}function GUe(e){return"stack"in e}function WUe(e){return"fold"in e}var Gf=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function rse(e,t){const{transform:n}=e,i=Gf(e,["transform"]);if(n){const r=n.map(s=>{if(zj(s))return{filter:Gj(s,t)};if(ise(s)&&Mh(s.bin))return Object.assign(Object.assign({},s),{bin:ose(s.bin)});if(nse(s)){const o=s.from,{selection:a}=o,l=Gf(o,["selection"]);return a?Object.assign(Object.assign({},s),{from:Object.assign({param:a},l)}):s}return s});return Object.assign(Object.assign({},i),{transform:r})}return e}function sse(e,t){var n,i;const r=Je(e);if(he(r)&&Mh(r.bin)&&(r.bin=ose(r.bin)),Lh(r)&&(null===(i=null===(n=r.scale)||void 0===n?void 0:n.domain)||void 0===i?void 0:i.selection)){const s=r.scale.domain,{selection:o}=s,a=Gf(s,["selection"]);r.scale.domain=Object.assign(Object.assign({},a),o?{param:o}:{})}if(WS(r))if(Z(r.condition))r.condition=r.condition.map(s=>{const{param:a}=s,u=Gf(s,["selection","param","test"]);return a?s:Object.assign(Object.assign({},u),{test:Gj(s,t)})});else{const s=sse(r.condition,t),{param:a}=s,u=Gf(s,["selection","param","test"]);r.condition=a?r.condition:Object.assign(Object.assign({},u),{test:Gj(r.condition,t)})}return r}function ose(e){const t=e.extent;if(null==t?void 0:t.selection){const{selection:n}=t,i=Gf(t,["selection"]);return Object.assign(Object.assign({},e),{extent:Object.assign(Object.assign({},i),{param:n})})}return e}function Gj(e,t){const n=i=>xm(i,r=>{var s,o,a;const u={param:r,empty:null===(s=t.emptySelections[r])||void 0===s||s};return null!==(o=(a=t.selectionPredicates)[r])&&void 0!==o||(a[r]=[]),t.selectionPredicates[r].push(u),u});return e.selection?n(e.selection):xm(e.test||e.filter,i=>i.selection?n(i.selection):i)}class Wj extends $j{map(t,n){var i;const r=null!==(i=n.selections)&&void 0!==i?i:[];if(t.params&&!ec(t)){const s=[];for(const o of t.params)Pj(o)?r.push(o):s.push(o);t.params=s}return n.selections=r,super.map(t,ase(t,n))}mapUnit(t,n){var i;const r=n.selections;if(!r||!r.length)return t;const s=(null!==(i=n.path)&&void 0!==i?i:[]).concat(t.name),o=[];for(const a of r)if(a.views&&a.views.length)for(const l of a.views)(_e(l)&&(l===t.name||s.indexOf(l)>=0)||Z(l)&&l.map(u=>s.indexOf(u)).every((u,c,f)=>-1!==u&&(0===c||u>f[c-1])))&&o.push(a);else o.push(a);return o.length&&(t.params=o),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=Wj.prototype[e];Wj.prototype[e]=function(n,i){return t.call(this,n,ase(n,i))}}function ase(e,t){var n;return e.name?Object.assign(Object.assign({},t),{path:(null!==(n=t.path)&&void 0!==n?n:[]).concat(e.name)}):t}function lse(e,t){void 0===t&&(t=Gre(e.config));const n=function QUe(e,t={}){const n={config:t};return XUe.map(KUe.map(JUe.map(e,n),n),n)}(e,t),{width:i,height:r}=e,s=function ZUe(e,t,n){let{width:i,height:r}=t;const s=ec(e)||ux(e),o={};s?"container"==i&&"container"==r?(o.type="fit",o.contains="padding"):"container"==i?(o.type="fit-x",o.contains="padding"):"container"==r&&(o.type="fit-y",o.contains="padding"):("container"==i&&(le(rie("width")),i=void 0),"container"==r&&(le(rie("height")),r=void 0));const a=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?use(n.autosize):{}),use(e.autosize));if("fit"===a.type&&!s&&(le('Autosize "fit" only works for single views and layered views.'),a.type="pad"),"container"==i&&!("fit"==a.type||"fit-x"==a.type)&&le(sie("width")),"container"==r&&!("fit"==a.type||"fit-y"==a.type)&&le(sie("height")),!kl(a,{type:"pad"}))return a}(n,{width:i,height:r,autosize:e.autosize},t);return Object.assign(Object.assign({},n),s?{autosize:s}:{})}const KUe=new class TUe extends $j{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[IHe,PHe,UHe,new EUe,new AUe]}map(t,n){if(ec(t)){const i=jh(t.encoding,zu),r=jh(t.encoding,Gu),s=jh(t.encoding,DS);if(i||r||s)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:i,parentProjection:r}=n,s=Hj(t.encoding,n.repeater),o=Object.assign(Object.assign({},t),s?{encoding:s}:{});if(i||r)return this.mapUnitWithParentEncodingOrProjection(o,n);const a=this.mapLayerOrUnit.bind(this);for(const l of this.nonFacetUnitNormalizers)if(l.hasMatchingType(o,n.config))return l.run(o,n,a);return o}mapRepeat(t,n){return function gUe(e){return!Z(e.repeat)&&e.repeat.layer}(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:i,spec:r}=t,s=zf(t,["repeat","spec"]),{row:o,column:a,layer:l}=i,{repeater:u={},repeaterPrefix:c=""}=n;return o||a?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),a?{column:a}:{}),spec:{repeat:{layer:l},spec:r}}),n):Object.assign(Object.assign({},s),{layer:l.map(f=>{const d=Object.assign(Object.assign({},u),{layer:f}),h=`${(r.name||"")+c}child__layer_${An(f)}`,p=this.mapLayerOrUnit(r,Object.assign(Object.assign({},n),{repeater:d,repeaterPrefix:h}));return p.name=h,p})})}mapNonLayerRepeat(t,n){var i;const{repeat:r,spec:s,data:o}=t,a=zf(t,["repeat","spec","data"]);!Z(r)&&t.columns&&(t=Zs(t,["columns"]),le(uie("repeat")));const l=[],{repeater:u={},repeaterPrefix:c=""}=n,f=!Z(r)&&r.row||[u?u.row:null],d=!Z(r)&&r.column||[u?u.column:null],h=Z(r)&&r||[u?u.repeat:null];for(const g of h)for(const m of f)for(const _ of d){const y={repeat:g,row:m,column:_,layer:u.layer},v=(s.name||"")+c+"child__"+(Z(r)?`${An(g)}`:(r.row?`row_${An(m)}`:"")+(r.column?`column_${An(_)}`:"")),b=this.map(s,Object.assign(Object.assign({},n),{repeater:y,repeaterPrefix:v}));b.name=v,l.push(Zs(b,["data"]))}const p=Z(r)?t.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:null!==(i=s.data)&&void 0!==i?i:o,align:"all"},a),{columns:p,concat:l})}mapFacet(t,n){const{facet:i}=t;return Gv(i)&&t.columns&&(t=Zs(t,["columns"]),le(uie("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:i,projection:r}=t,{parentEncoding:s,parentProjection:o,config:a}=n,l=tse({parentProjection:o,projection:r}),u=ese({parentEncoding:s,encoding:Hj(i,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),l?{projection:l}:{}),u?{encoding:u}:{}),{config:a})}mapFacetedUnit(t,n){const i=t.encoding,{row:r,column:s,facet:o}=i,a=zf(i,["row","column","facet"]),{mark:l,width:u,projection:c,height:f,view:d,params:h}=t,g=zf(t,["mark","width","projection","height","view","params","encoding"]),{facetMapping:m,layout:_}=this.getFacetMappingAndLayout({row:r,column:s,facet:o},n),y=Hj(a,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},g),_),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u?{width:u}:{}),f?{height:f}:{}),d?{view:d}:{}),c?{projection:c}:{}),{mark:l,encoding:y}),h?{params:h}:{})}),n)}getFacetMappingAndLayout(t,n){var i;const{row:r,column:s,facet:o}=t;if(r||s){o&&le(function R6e(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}([...r?[zu]:[],...s?[Gu]:[]]));const a={},l={};for(const u of[zu,Gu]){const c=t[u];if(c){const g=zf(c,["align","center","spacing","columns"]);a[u]=g;for(const m of["align","center","spacing"])void 0!==c[m]&&(null!==(i=l[m])&&void 0!==i||(l[m]={}),l[m][u]=c[m])}}return{facetMapping:a,layout:l}}{const{align:a,center:l,spacing:u,columns:c}=o;return{facetMapping:xUe(zf(o,["align","center","spacing","columns"]),n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},a?{align:a}:{}),l?{center:l}:{}),u?{spacing:u}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:i,parentProjection:r}=n,s=zf(n,["parentEncoding","parentProjection"]);const{encoding:o,projection:a}=t,l=zf(t,["encoding","projection"]),u=Object.assign(Object.assign({},s),{parentEncoding:ese({parentEncoding:i,encoding:o,layer:!0}),parentProjection:tse({parentProjection:r,projection:a})});return super.mapLayer(l,u)}},JUe=new class YUe extends $j{map(t,n){var i,r;return null!==(i=n.emptySelections)&&void 0!==i||(n.emptySelections={}),null!==(r=n.selectionPredicates)&&void 0!==r||(n.selectionPredicates={}),t=rse(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if((t=rse(t,n)).encoding){const i={};for(const[r,s]of Nf(t.encoding))i[r]=sse(s,n);t=Object.assign(Object.assign({},t),{encoding:i})}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const i=t,{selection:r}=i,s=Gf(i,["selection"]);return r?Object.assign(Object.assign({},s),{params:Nf(r).map(([o,a])=>{var l;const u=a,{init:c,bind:f,empty:d}=u,h=Gf(u,["init","bind","empty"]);"single"===h.type?(h.type="point",h.toggle=!1):"multi"===h.type&&(h.type="point"),n.emptySelections[o]="none"!==d;for(const p of yr(null!==(l=n.selectionPredicates[o])&&void 0!==l?l:{}))p.empty="none"!==d;return{name:o,value:c,select:h,bind:f}})}):t}},XUe=new Wj;function use(e){return _e(e)?{type:e}:null!=e?e:{}}const n7e=["background","padding"];function cse(e,t){const n={};for(const i of n7e)e&&void 0!==e[i]&&(n[i]=eo(e[i]));return t&&(n.params=e.params),n}class nc{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new nc(Je(this.explicit),Je(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return fi(this.explicit[t],this.implicit[t])}getWithExplicit(t){return void 0!==this.explicit[t]?{explicit:!0,value:this.explicit[t]}:void 0!==this.implicit[t]?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:i}){void 0!==n&&this.set(t,n,i)}set(t,n,i){return delete this[i?"implicit":"explicit"][t],this[i?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:i}){void 0!==n[t]?this.set(t,n[t],!0):void 0!==i[t]&&this.set(t,i[t],!1)}copyKeyFromObject(t,n){void 0!==n[t]&&this.set(t,n[t],!0)}copyAll(t){for(const n of ie(t.combine())){const i=t.getWithExplicit(n);this.setWithExplicit(n,i)}}}function Yl(e){return{explicit:!0,value:e}}function no(e){return{explicit:!1,value:e}}function fse(e){return(t,n,i,r)=>{const s=e(t.value,n.value);return s>0?t:s<0?n:cx(t,n,i,r)}}function cx(e,t,n,i){return e.explicit&&t.explicit&&le(function W6e(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${gn(n)} and ${gn(i)}). Using ${gn(n)}.`}(n,i,e.value,t.value)),e}function Wf(e,t,n,i,r=cx){return void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:kl(e.value,t.value)?e:r(e,t,n,i)}class i7e extends nc{constructor(t={},n={},i=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=i}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function $m(e){return"url"in e}function Jv(e){return"values"in e}function dse(e){return"name"in e&&!$m(e)&&!Jv(e)&&!qf(e)}function qf(e){return e&&(hse(e)||pse(e)||qj(e))}function hse(e){return"sequence"in e}function pse(e){return"sphere"in e}function qj(e){return"graticule"in e}var cn=(()=>(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup"}(cn||(cn={})),cn))(),r7e=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Vm(e,t=!0,n=ar){if(Z(e)){const i=e.map(r=>Vm(r,t,n));return t?`[${i.join(", ")}]`:i}return kh(e)?n(t?Uv(e):function yVe(e){const t=q3(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}(e)):t?n(gn(e)):e}function s7e(e,t){var n;for(const i of yr(null!==(n=e.component.selection)&&void 0!==n?n:{})){const r=i.name;let s=`${r}${Jf}, ${"global"===i.resolve?"true":`{unit: ${zm(e)}}`}`;for(const o of gx)!o.defined(i)||(o.signals&&(t=o.signals(e,i,t)),o.modifyExpr&&(s=o.modifyExpr(e,i,s)));t.push({name:r+B7e,on:[{events:{signal:i.name+Jf},update:`modify(${fe(i.name+Bh)}, ${s})`}]})}return Yj(t)}function o7e(e,t){if(e.component.selection&&ie(e.component.selection).length){const n=fe(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Of("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return Yj(t)}function gse(e,t){var n;for(const i of yr(null!==(n=e.component.selection)&&void 0!==n?n:{}))for(const r of gx)r.defined(i)&&r.marks&&(t=r.marks(e,i,t));return t}function Yj(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}class en{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){this._children.includes(t)?le("Attempt to add the same child twice."):void 0!==n?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const i of this._children)i.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class Kr extends en{constructor(t,n,i,r){super(t,n),this.type=i,this.refCounts=r,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash=`Output ${kne()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}var mse=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};class Kl extends en{constructor(t,n){super(t),this.formula=n}clone(){return new Kl(null,Je(this.formula))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s)=>{const{field:o,timeUnit:a}=s;if(a){const l=pe(s,{forAs:!0});r[vt({as:l,field:o,timeUnit:a})]={as:l,field:o,timeUnit:a}}return r},{});return Zt(i)?null:new Kl(t,i)}static makeFromTransform(t,n){const i=Object.assign({},n),{timeUnit:r}=i,s=mse(i,["timeUnit"]),o=Yr(r),a=Object.assign(Object.assign({},s),{timeUnit:o});return new Kl(t,{[vt(a)]:a})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)this.formula[n]||(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[i,r]of Nf(this.formula))t.has(r.as)||(n[i]=r);this.formula=n}producedFields(){return new Set(yr(this.formula).map(t=>t.as))}dependentFields(){return new Set(yr(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${vt(this.formula)}`}assemble(){const t=[];for(const n of yr(this.formula)){const{field:i,as:r,timeUnit:s}=n,o=Yr(s),{unit:a,utc:l}=o,u=mse(o,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:Po(i),type:"timeunit"},a?{units:J3(a)}:{}),l?{timezone:"utc"}:{}),u),{as:[r,`${r}_end`]}))}return t}}const Xv="_tuple_fields";class d7e{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const h7e={defined:()=>!0,parse:(e,t,n)=>{var i;const r=t.name,s=null!==(i=t.project)&&void 0!==i?i:t.project=new d7e,o={},a={},l=new Set,u=(g,m)=>{const _="visual"===m?g.channel:g.field;let y=An(`${r}_${_}`);for(let v=1;l.has(y);v++)y=An(`${r}_${_}_${v}`);return l.add(y),{[m]:y}},c=t.type,f=e.config.selection[c],d=void 0!==n.value?ve(n.value):null;let{fields:h,encodings:p}=Ce(n.select)?n.select:{};if(!h&&!p&&d)for(const g of d)if(Ce(g))for(const m of ie(g))R4e(m)?(p||(p=[])).push(m):"interval"===c?(le('Interval selections should be initialized using "x" and/or "y" keys.'),p=f.encodings):(h||(h=[])).push(m);!h&&!p&&(p=f.encodings,"fields"in f&&(h=f.fields));for(const g of null!=p?p:[]){const m=e.fieldDef(g);if(m){let _=m.field;if(m.aggregate){le(o6e(g,m.aggregate));continue}if(!_){le(aie(g));continue}if(m.timeUnit){_=e.vgField(g);const y={timeUnit:m.timeUnit,as:_,field:m.field};a[vt(y)]=y}if(!o[_]){let y="E";"interval"===c?to(e.getScaleComponent(g).get("type"))&&(y="R"):m.bin&&(y="R-RE");const v={field:_,channel:g,type:y};v.signals=Object.assign(Object.assign({},u(v,"data")),u(v,"visual")),s.items.push(o[_]=v),s.hasField[_]=s.hasChannel[g]=o[_]}}else le(aie(g))}for(const g of null!=h?h:[]){if(s.hasField[g])continue;const m={type:"E",field:g};m.signals=Object.assign({},u(m,"data")),s.items.push(m),s.hasField[g]=m}d&&(t.init=d.map(g=>s.items.map(m=>Ce(g)?void 0!==g[m.channel]?g[m.channel]:g[m.field]:g))),Zt(a)||(s.timeUnit=new Kl(null,a))},signals:(e,t,n)=>{const i=t.name+Xv;return n.filter(s=>s.name===i).length>0?n:n.concat({name:i,value:t.project.items.map(s=>{const l=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(s,["signals","hasLegend"]);return l.field=Po(l.field),l})})}},Yf={defined:e=>"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind,parse:(e,t)=>{const n=t.scales=[];for(const i of t.project.items){const r=i.channel;if(!jf(r))continue;const s=e.getScaleComponent(r),o=s?s.get("type"):void 0;s&&to(o)?(s.set("selectionExtent",{param:t.name,field:i.field},!0),n.push(i)):le("Scale bindings are currently only supported for scales with unbinned, continuous domains.")}},topLevelSignals:(e,t,n)=>{const i=t.scales.filter(o=>0===n.filter(a=>a.name===o.signals.data).length);if(!e.parent||Jj(e)||0===i.length)return n;const r=n.filter(o=>o.name===t.name)[0];let s=r.update;if(s.indexOf(Lse)>=0)r.update=`{${i.map(o=>`${fe(Po(o.field))}: ${o.signals.data}`).join(", ")}}`;else{for(const o of i){const a=`${fe(Po(o.field))}: ${o.signals.data}`;s.includes(a)||(s=`${s.substring(0,s.length-1)}, ${a}}`)}r.update=s}return n.concat(i.map(o=>({name:o.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!Jj(e))for(const i of t.scales){const r=n.filter(s=>s.name===i.signals.data)[0];r.push="outer",delete r.value,delete r.update}return n}};function Kj(e,t){return`domain(${fe(e.scaleName(t))})`}function Jj(e){var t;return e.parent&&Xm(e.parent)&&(null!==(t=!e.parent.parent)&&void 0!==t?t:Jj(e.parent.parent))}const Hm="_brush",Xj="_scale_trigger",g7e={defined:e=>"interval"===e.type,signals:(e,t,n)=>{const i=t.name,r=i+Xv,s=Yf.defined(t),o=t.init?t.init[0]:null,a=[],l=[];if(t.translate&&!s){const c=`!event.item || event.item.mark.name !== ${fe(i+Hm)}`;_se(t,(f,d)=>{var h,p;const g=ve(null!==(h=(p=d.between[0]).filter)&&void 0!==h?h:p.filter=[]);return g.includes(c)||g.push(c),f})}t.project.items.forEach((c,f)=>{const d=c.channel;if(d!==Pn&&d!==Li)return void le("Interval selections only support x and y encoding channels.");const p=function m7e(e,t,n,i){const r=n.channel,s=n.signals.visual,o=n.signals.data,a=Yf.defined(t),l=fe(e.scaleName(r)),u=e.getScaleComponent(r),c=u?u.get("type"):void 0,f=g=>`scale(${l}, ${g})`,d=e.getSizeSignalRef(r===Pn?"width":"height").signal,h=`${r}(unit)`,p=_se(t,(g,m)=>[...g,{events:m.between[0],update:`[${h}, ${h}]`},{events:m,update:`[${s}[0], clamp(${h}, 0, ${d})]`}]);return p.push({events:{signal:t.name+Xj},update:to(c)?`[${f(`${o}[0]`)}, ${f(`${o}[1]`)}]`:"[0, 0]"}),a?[{name:o,on:[]}]:[Object.assign(Object.assign({name:s},i?{init:Vm(i,!0,f)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:o},i?{init:Vm(i)}:{}),{on:[{events:{signal:s},update:`${s}[0] === ${s}[1] ? null : invert(${l}, ${s})`}]})]}(e,t,c,o?o[f]:null),g=c.signals.data,m=c.signals.visual,_=fe(e.scaleName(d)),v=to(e.getScaleComponent(d).get("type"))?"+":"";n.push(...p),a.push(g),l.push({scaleName:e.scaleName(d),expr:`(!isArray(${g}) || (${v}invert(${_}, ${m})[0] === ${v}${g}[0] && ${v}invert(${_}, ${m})[1] === ${v}${g}[1]))`})}),!s&&l.length&&n.push({name:i+Xj,value:{},on:[{events:l.map(c=>({scale:c.scaleName})),update:`${l.map(c=>c.expr).join(" && ")} ? ${i+Xj} : {}`}]});const u=`unit: ${zm(e)}, fields: ${r}, values`;return n.concat(Object.assign(Object.assign({name:i+Jf},o?{init:`{${u}: ${Vm(o)}}`}:{}),a.length?{on:[{events:[{signal:a.join(" || ")}],update:`${a.join(" && ")} ? {${u}: [${a}]} : null`}]}:{}))},marks:(e,t,n)=>{const i=t.name,{x:r,y:s}=t.project.hasChannel,o=null==r?void 0:r.signals.visual,a=null==s?void 0:s.signals.visual,l=`data(${fe(t.name+Bh)})`;if(Yf.defined(t)||!r&&!s)return n;const u={x:void 0!==r?{signal:`${o}[0]`}:{value:0},y:void 0!==s?{signal:`${a}[0]`}:{value:0},x2:void 0!==r?{signal:`${o}[1]`}:{field:{group:"width"}},y2:void 0!==s?{signal:`${a}[1]`}:{field:{group:"height"}}};if("global"===t.resolve)for(const m of ie(u))u[m]=[Object.assign({test:`${l}.length && ${l}[0].unit === ${zm(e)}`},u[m]),{value:0}];const c=t.mark,{fill:f,fillOpacity:d,cursor:h}=c,p=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(c,["fill","fillOpacity","cursor"]),g=ie(p).reduce((m,_)=>(m[_]=[{test:[void 0!==r&&`${o}[0] !== ${o}[1]`,void 0!==s&&`${a}[0] !== ${a}[1]`].filter(y=>y).join(" && "),value:p[_]},{value:null}],m),{});return[{name:`${i+Hm}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:d}},update:u}},...n,{name:i+Hm,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},h?{cursor:{value:h}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},u),g)}}]}};function _se(e,t){return e.events.reduce((n,i)=>i.between?t(n,i):(le(`${i} is not an ordered event stream for interval selections.`),n),[])}const _7e={defined:e=>"point"===e.type,signals:(e,t,n)=>{var i;const r=t.name,s=r+Xv,a="(item().isVoronoi ? datum.datum : datum)",l=t.project.items.map(h=>{const p=e.fieldDef(h.channel);return(null==p?void 0:p.bin)?`[${a}[${fe(e.vgField(h.channel,{}))}], ${a}[${fe(e.vgField(h.channel,{binSuffix:"end"}))}]]`:`${a}[${fe(h.field)}]`}).join(", "),u=`unit: ${zm(e)}, fields: ${s}, values`,c=t.events,f=yr(null!==(i=e.component.selection)&&void 0!==i?i:{}).reduce((h,p)=>"interval"===p.type?h.concat(p.name+Hm):h,[]).map(h=>`indexof(item().mark.name, '${h}') < 0`).join(" && ");return n.concat([{name:r+Jf,on:c?[{events:c,update:`${"datum && item().mark.marktype !== 'group'"+(f?` && ${f}`:"")} ? {${u}: [${l}]} : null`,force:!0}]:[]}])}};function Um(e,t,n,i){const r=WS(t)&&t.condition,s=i(t);return r?{[n]:[...ve(r).map(l=>{const u=i(l);if(function fHe(e){return e.param}(l)){const{param:c,empty:f}=l,d=Vse(e,{param:c,empty:f});return Object.assign({test:d},u)}{const c=mx(e,l.test);return Object.assign({test:c},u)}}),...void 0!==s?[s]:[]]}:void 0!==s?{[n]:s}:{}}function Qj(e,t="text"){return Um(e,e.encoding[t],t,i=>fx(i,e.config))}function fx(e,t,n="datum"){if(e){if(Fa(e))return wn(e.value);if(We(e)){const{format:i,formatType:r}=XS(e);return gj({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t})}}}function yse(e,t={}){const{encoding:n,markDef:i,config:r,stack:s}=e,o=n.tooltip;if(Z(o))return{tooltip:bse({tooltip:o},s,r,t)};{const a=t.reactiveGeom?"datum.datum":"datum";return Um(e,o,"tooltip",l=>{const u=fx(l,r,a);if(u)return u;if(null===l)return;let c=Gt("tooltip",i,r);return!0===c&&(c={content:"encoding"}),_e(c)?{value:c}:Ce(c)?Ne(c)?c:"encoding"===c.content?bse(n,s,r,t):{signal:a}:void 0})}}function vse(e,t,n,{reactiveGeom:i}={}){const r={},s=i?"datum.datum":"datum",o=[];function a(u,c){const f=Oh(c),d=Bo(u)?u:Object.assign(Object.assign({},u),{type:e[f].type}),p=ve(d.title||Dj(d,n)).join(", ");let g;if(Ji(c)){const m="x"===c?"x2":"y2",_=Wl(e[m]);if(qr(d.bin)&&_){const y=pe(d,{expr:s}),v=pe(_,{expr:s}),{format:b,formatType:D}=XS(d);g=US(y,v,b,D,n),r[m]=!0}else if(t&&t.fieldChannel===c&&"normalize"===t.offset){const{format:y,formatType:v}=XS(d);g=gj({fieldOrDatumDef:d,format:y,formatType:v,expr:s,config:n,normalizeStack:!0}).signal}}null!=g||(g=fx(d,n,s).signal),o.push({channel:c,key:p,value:g})}xj(e,(u,c)=>{he(u)?a(u,c):qS(u)&&a(u.condition,c)});const l={};for(const{channel:u,key:c,value:f}of o)!r[u]&&!l[c]&&(l[c]=f);return l}function bse(e,t,n,{reactiveGeom:i}={}){const r=vse(e,t,n,{reactiveGeom:i}),s=Nf(r).map(([o,a])=>`"${o}": ${a}`);return s.length>0?{signal:`{${s.join(", ")}}`}:void 0}function Bi(e,t,n={}){const{markDef:i,encoding:r,config:s}=t,{vgChannel:o}=n;let{defaultRef:a,defaultValue:l}=n;return void 0===a&&(null!=l||(l=Gt(e,i,s,{vgChannel:o,ignoreVgConfig:!0})),void 0!==l&&(a=wn(l))),Um(t,r[e],null!=o?o:e,c=>pj({channel:e,channelDef:c,markDef:i,config:s,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:a}))}function wse(e,t={filled:void 0}){var n,i,r,s;const{markDef:o,encoding:a,config:l}=e,{type:u}=o,c=null!==(n=t.filled)&&void 0!==n?n:Gt("filled",o,l),f=bt(["bar","point","circle","square","geoshape"],u)?"transparent":void 0,d=null!==(r=null!==(i=Gt(!0===c?"color":void 0,o,l,{vgChannel:"fill"}))&&void 0!==i?i:l.mark[!0===c&&"color"])&&void 0!==r?r:f,h=null!==(s=Gt(!1===c?"color":void 0,o,l,{vgChannel:"stroke"}))&&void 0!==s?s:l.mark[!1===c&&"color"],p=c?"fill":"stroke",g=Object.assign(Object.assign({},d?{fill:wn(d)}:{}),h?{stroke:wn(h)}:{});return o.color&&(c?o.fill:o.stroke)&&le(hie("property",{fill:"fill"in o,stroke:"stroke"in o})),Object.assign(Object.assign(Object.assign(Object.assign({},g),Bi("color",e,{vgChannel:p,defaultValue:c?d:h})),Bi("fill",e,{defaultValue:a.fill?d:void 0})),Bi("stroke",e,{defaultValue:a.stroke?h:void 0}))}function Qv({channel:e,markDef:t,encoding:n={},model:i,bandPosition:r}){const s=`${e}Offset`,o=t[s],a=n[s];if(("xOffset"===s||"yOffset"===s)&&a)return{offsetType:"encoding",offset:pj({channel:s,channelDef:a,markDef:t,config:null==i?void 0:i.config,scaleName:i.scaleName(s),scale:i.getScaleComponent(s),stack:null,defaultRef:wn(o),bandPosition:r})};const l=t[s];return l?{offsetType:"visual",offset:l}:{}}function br(e,t,{defaultPos:n,vgChannel:i}){const{encoding:r,markDef:s,config:o,stack:a}=t,l=r[e],u=r[Ju(e)],c=t.scaleName(e),f=t.getScaleComponent(e),{offset:d,offsetType:h}=Qv({channel:e,markDef:s,encoding:r,model:t,bandPosition:.5}),p=Zj({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),g=!l&&Ji(e)&&(r.latitude||r.longitude)?{field:t.getName(e)}:function D7e(e){const{channel:t,channelDef:n,scaleName:i,stack:r,offset:s,markDef:o}=e;if(We(n)&&r&&t===r.fieldChannel){if(he(n)){let a=n.bandPosition;if(void 0===a&&"text"===o.type&&("radius"===t||"theta"===t)&&(a=.5),void 0!==a)return HS({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",bandPosition:a,offset:s})}return Fh(n,i,{suffix:"end"},{offset:s})}return dj(e)}({channel:e,channelDef:l,channel2Def:u,markDef:s,config:o,scaleName:c,scale:f,stack:a,offset:d,defaultRef:p,bandPosition:"encoding"===h?0:void 0});return g?{[i||e]:g}:void 0}function Zj({model:e,defaultPos:t,channel:n,scaleName:i,scale:r}){const{markDef:s,config:o}=e;return()=>{const a=Oh(n),l=Lf(n),u=Gt(n,s,o,{vgChannel:l});if(void 0!==u)return zv(n,u);switch(t){case"zeroOrMin":case"zeroOrMax":if(i){if(!bt(["log","time","utc"],r.get("type"))&&r.domainDefinitelyIncludesZero())return{scale:i,value:0}}if("zeroOrMin"===t)return"y"===a?{field:{group:"height"}}:{value:0};switch(a){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[ws(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const C7e={left:"x",center:"xc",right:"x2"},E7e={top:"y",middle:"yc",bottom:"y2"};function Dse(e,t,n,i="middle"){if("radius"===e||"theta"===e)return Lf(e);const r="x"===e?"align":"baseline",s=Gt(r,t,n);let o;return Ne(s)?(le(function F6e(e){return`The ${e} for range marks cannot be an expression`}(r)),o=void 0):o=s,"x"===e?C7e[o||("top"===i?"left":"center")]:E7e[o||i]}function dx(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?Cse(e,t,{defaultPos:n,defaultPos2:i}):br(e,t,{defaultPos:n})}function Cse(e,t,{defaultPos:n,defaultPos2:i}){const{markDef:r,config:s}=t,o=Ju(e),a=ws(e),l=function S7e(e,t,n){const{encoding:i,mark:r,markDef:s,stack:o,config:a}=e,l=Oh(n),u=ws(n),c=Lf(n),f=i[l],d=e.scaleName(l),h=e.getScaleComponent(l),{offset:p}=Qv(n in i||n in s?{channel:n,markDef:s,encoding:i,model:e}:{channel:l,markDef:s,encoding:i,model:e});if(!f&&("x2"===n||"y2"===n)&&(i.latitude||i.longitude)){const m=ws(n),_=e.markDef[m];return null!=_?{[m]:{value:_}}:{[c]:{field:e.getName(n)}}}const g=function x7e({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:l,defaultRef:u}){return We(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?Fh(t,s,{suffix:"start"},{offset:l}):dj({channel:e,channelDef:n,scaleName:s,scale:o,stack:a,markDef:i,config:r,offset:l,defaultRef:u})}({channel:n,channelDef:f,channel2Def:i[n],markDef:s,config:a,scaleName:d,scale:h,stack:o,offset:p,defaultRef:void 0});return void 0!==g?{[c]:g}:hx(n,s)||hx(n,{[n]:IS(n,s,a.style),[u]:IS(u,s,a.style)})||hx(n,a[r])||hx(n,a.mark)||{[c]:Zj({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}(t,i,o),u=l[a]?Dse(e,r,s):Lf(e);return Object.assign(Object.assign({},br(e,t,{defaultPos:n,vgChannel:u})),l)}function hx(e,t){const n=ws(e),i=Lf(e);if(void 0!==t[i])return{[i]:zv(e,t[i])};if(void 0!==t[e])return{[i]:zv(e,t[e])};if(t[n]){const r=t[n];if(!Fm(r))return{[n]:zv(e,r)};le(function T6e(e){return`Position range does not support relative band size for ${e}.`}(n))}}function Kf(e,t){var n,i;const{config:r,encoding:s,markDef:o}=e,a=o.type,l=Ju(t),u=ws(t),c=s[t],f=s[l],d=e.getScaleComponent(t),h=d?d.get("type"):void 0,p=o.orient,g=null!==(i=null!==(n=s[u])&&void 0!==n?n:s.size)&&void 0!==i?i:Gt("size",o,r,{vgChannel:u}),m="bar"===a&&("x"===t?"vertical"===p:"horizontal"===p);return!he(c)||!(mn(c.bin)||qr(c.bin)||c.timeUnit&&!f)||g&&!Fm(g)||ji(h)?(We(c)&&ji(h)||m)&&!f?function T7e(e,t,n){const{markDef:i,encoding:r,config:s,stack:o}=n,a=i.orient,l=n.scaleName(t),u=n.getScaleComponent(t),c=ws(t),f=Ju(t),d=function P4e(e){switch(e){case Pn:return"xOffset";case Li:return"yOffset";case Ma:return"x2Offset";case Rl:return"y2Offset";case Na:return"thetaOffset";case Fl:return"radiusOffset";case qu:return"theta2Offset";case Wu:return"radius2Offset"}}(t),h=n.scaleName(d),p="horizontal"===a&&"y"===t||"vertical"===a&&"x"===t;let g;(r.size||i.size)&&(p?g=Bi("size",n,{vgChannel:c,defaultRef:wn(i.size)}):le(function U6e(e){return`Cannot apply size to non-oriented mark "${e}".`}(i.type)));const m=nre({channel:t,fieldDef:e,markDef:i,config:s,scaleType:null==u?void 0:u.get("type"),useVlSizeChannel:p});g=g||{[c]:A7e(c,h||l,u,s,m)};const y=Dse(t,i,s,"band"===(null==u?void 0:u.get("type"))&&"band"in g[c]?"top":"middle"),v="xc"===y||"yc"===y,{offset:b,offsetType:D}=Qv({channel:t,markDef:i,encoding:r,model:n,bandPosition:v?.5:0}),C=dj({channel:t,channelDef:e,markDef:i,config:s,scaleName:l,scale:u,stack:o,offset:b,defaultRef:Zj({model:n,defaultPos:"mid",channel:t,scaleName:l,scale:u}),bandPosition:v?"encoding"===D?0:.5:Ne(m)?{signal:`(1-${m})/2`}:Fm(m)?(1-m.band)/2:0});if(c)return Object.assign({[y]:C},g);{const w=Lf(f),E=g[c],O=b?Object.assign(Object.assign({},E),{offset:b}):E;return{[y]:C,[w]:Z(C)?[C[0],Object.assign(Object.assign({},C[1]),{offset:O})]:Object.assign(Object.assign({},C),{offset:O})}}}(c,t,e):Cse(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"}):function O7e({fieldDef:e,fieldDef2:t,channel:n,model:i}){var r,s,o;const{config:a,markDef:l,encoding:u}=i,c=i.getScaleComponent(n),f=i.scaleName(n),d=c?c.get("type"):void 0,h=c.get("reverse"),p=nre({channel:n,fieldDef:e,markDef:l,config:a,scaleType:d}),g=null===(r=i.component.axes[n])||void 0===r?void 0:r[0],m=null!==(s=null==g?void 0:g.get("translate"))&&void 0!==s?s:.5,_=Ji(n)&&null!==(o=Gt("binSpacing",l,a))&&void 0!==o?o:0,y=Ju(n),v=Lf(n),b=Lf(y),{offset:D}=Qv({channel:n,markDef:l,encoding:u,model:i,bandPosition:0}),C=Ne(p)?{signal:`(1-${p.signal})/2`}:Fm(p)?(1-p.band)/2:.5;if(mn(e.bin)||e.timeUnit)return{[b]:Ese({fieldDef:e,scaleName:f,bandPosition:C,offset:Zv(y,_,h,m,D)}),[v]:Ese({fieldDef:e,scaleName:f,bandPosition:Ne(C)?{signal:`1-${C.signal}`}:1-C,offset:Zv(n,_,h,m,D)})};if(qr(e.bin)){const w=Fh(e,f,{},{offset:Zv(y,_,h,m,D)});if(he(t))return{[b]:w,[v]:Fh(t,f,{},{offset:Zv(n,_,h,m,D)})};if(Mh(e.bin)&&e.bin.step)return{[b]:w,[v]:{signal:`scale("${f}", ${pe(e,{expr:"datum"})} + ${e.bin.step})`,offset:Zv(n,_,h,m,D)}}}le(yie(y))}({fieldDef:c,fieldDef2:f,channel:t,model:e})}function A7e(e,t,n,i,r){if(Fm(r)){if(!n)return{mult:r.band,field:{group:e}};{const o=n.get("type");if("band"===o)return{scale:t,band:r.band};1!==r.band&&(le(function B6e(e){return`Cannot use the relative band size with ${e} scale.`}(o)),r=void 0)}}else{if(Ne(r))return r;if(r)return{value:r}}if(n){const o=n.get("range");if(Vf(o)&&Xt(o.step))return{value:o.step-2}}return{value:ax(i.view,e)-2}}function Zv(e,t,n,i,r){if(Pne(e))return 0;const s="x"===e||"y2"===e?-t/2:t/2;if(Ne(n)||Ne(r)||Ne(i)){const o=Zu(n),a=Zu(r),l=Zu(i);return{signal:(l?`${l} + `:"")+(o?`(${o} ? -1 : 1) * `:"")+(a?`(${a} + ${s})`:s)}}return r=r||0,i+(n?-r-s:+r+s)}function Ese({fieldDef:e,scaleName:t,bandPosition:n,offset:i}){return HS({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:i})}const M7e=new Set(["aria","width","height"]);function $o(e,t){const{fill:n,stroke:i}="include"===t.color?wse(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function N7e(e,t){return t6e.reduce((n,i)=>(!M7e.has(i)&&void 0!==e[i]&&"ignore"!==t[i]&&(n[i]=wn(e[i])),n),{})}(e.markDef,t)),Sse(e,"fill",n)),Sse(e,"stroke",i)),Bi("opacity",e)),Bi("fillOpacity",e)),Bi("strokeOpacity",e)),Bi("strokeWidth",e)),Bi("strokeDash",e)),function w7e(e){const{encoding:t,mark:n}=e,i=t.order;return!Uf(n)&&Fa(i)?Um(e,i,"zindex",r=>wn(r.value)):{}}(e)),yse(e)),Qj(e,"href")),function y7e(e){const{markDef:t,config:n}=e,i=Gt("aria",t,n);return!1===i?{}:Object.assign(Object.assign(Object.assign({},i?{aria:i}:{}),function v7e(e){const{mark:t,markDef:n,config:i}=e;if(!1===i.aria)return{};const r=Gt("ariaRoleDescription",n,i);return null!=r?{ariaRoleDescription:{value:r}}:t in n6e?{}:{ariaRoleDescription:{value:t}}}(e)),function b7e(e){const{encoding:t,markDef:n,config:i,stack:r}=e,s=t.description;if(s)return Um(e,s,"description",l=>fx(l,e.config));const o=Gt("description",n,i);if(null!=o)return{description:wn(o)};if(!1===i.aria)return{};const a=vse(t,r,i);return Zt(a)?void 0:{description:{signal:Nf(a).map(([l,u],c)=>`"${c>0?"; ":""}${l}: " + (${u})`).join(" + ")}}}(e))}(e))}function Sse(e,t,n){const{config:i,mark:r,markDef:s}=e;if("hide"===Gt("invalid",s,i)&&n&&!Uf(r)){const a=function k7e(e,{invalid:t=!1,channels:n}){const i=n.reduce((s,o)=>{const a=e.getScaleComponent(o);if(a){const l=a.get("type"),u=e.vgField(o,{expr:"datum"});u&&to(l)&&(s[u]=!0)}return s},{}),r=ie(i);if(r.length>0){const s=t?"||":"&&";return r.map(o=>hj(o,t)).join(` ${s} `)}}(e,{invalid:!0,channels:NS});if(a)return{[t]:[{test:a,value:null},...ve(n)]}}return n?{[t]:n}:{}}function eB(e){const{config:t,markDef:n}=e;if(Gt("invalid",n,t)){const r=function I7e(e,{invalid:t=!1,channels:n}){const i=n.reduce((s,o)=>{const a=e.getScaleComponent(o);if(a){const l=a.get("type"),u=e.vgField(o,{expr:"datum"});u&&to(l)&&(s[u]=!0)}return s},{}),r=ie(i);if(r.length>0){const s=t?"||":"&&";return r.map(o=>hj(o,t)).join(` ${s} `)}}(e,{channels:$l});if(r)return{defined:{signal:r}}}return{}}function xse(e,t){if(void 0!==t)return{[e]:wn(t)}}const tB="voronoi",Ase={defined:e=>"point"===e.type&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(tB)},marks:(e,t,n)=>{const{x:i,y:r}=t.project.hasChannel,s=e.mark;if(Uf(s))return le(function a6e(e){return`The "nearest" transform is not supported for ${e} marks.`}(s)),n;const o={name:e.getName(tB),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},yse(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:i||!r?"datum.datum.x || 0":"0"},y:{expr:r||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let a=0,l=!1;return n.forEach((u,c)=>{var f;const d=null!==(f=u.name)&&void 0!==f?f:"";d===e.component.mark[0].name?a=c:d.indexOf(tB)>=0&&(l=!0)}),l||n.splice(a+1,0,o),n}},Tse={defined:e=>"point"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind&&!Rj(e.bind),parse:(e,t,n)=>jse(t,n),topLevelSignals:(e,t,n)=>{const i=t.name,r=t.project,s=t.bind,o=t.init&&t.init[0],a=Ase.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return r.items.forEach((l,u)=>{var c,f;const d=An(`${i}_${l.field}`);n.filter(p=>p.name===d).length||n.unshift(Object.assign(Object.assign({name:d},o?{init:Vm(o[u])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${fe(l.field)}] : null`}]:[],bind:null!==(f=null!==(c=s[l.field])&&void 0!==c?c:s[l.channel])&&void 0!==f?f:s}))}),n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.filter(u=>u.name===i+Jf)[0],o=i+Xv,a=r.items.map(u=>An(`${i}_${u.field}`)),l=a.map(u=>`${u} !== null`).join(" && ");return a.length&&(s.update=`${l} ? {fields: ${o}, values: [${a.join(", ")}]} : null`),delete s.value,delete s.on,n}},px="_toggle",Ose={defined:e=>"point"===e.type&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+px,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+Jf,i=t.name+px;return`${i} ? null : ${n}, `+("global"===t.resolve?`${i} ? null : true, `:`${i} ? null : {unit: ${zm(e)}}, `)+`${i} ? ${n} : null`}},R7e={defined:e=>void 0!==e.clear&&!1!==e.clear,parse:(e,t)=>{t.clear&&(t.clear=_e(t.clear)?Of(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(Tse.defined(t))for(const i of t.project.items){const r=n.findIndex(s=>s.name===An(`${t.name}_${i.field}`));-1!==r&&n[r].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function i(r,s){-1!==r&&n[r].on&&n[r].on.push({events:t.clear,update:s})}if("interval"===t.type)for(const r of t.project.items){const s=n.findIndex(o=>o.name===r.signals.visual);i(s,"[0, 0]"),-1===s&&i(n.findIndex(a=>a.name===r.signals.data),"null")}else{let r=n.findIndex(s=>s.name===t.name+Jf);i(r,"null"),Ose.defined(t)&&(r=n.findIndex(s=>s.name===t.name+px),i(r,"false"))}return n}},Mse={defined:e=>{const t="global"===e.resolve&&e.bind&&Rj(e.bind),n=1===e.project.items.length&&e.project.items[0].field!==Kv;return t&&!n&&le("Legend bindings are only supported for selections over an individual field or encoding channel."),t&&n},parse:(e,t,n)=>{var i;const r=Je(n);if(r.select=_e(r.select)?{type:r.select,toggle:t.toggle}:Object.assign(Object.assign({},r.select),{toggle:t.toggle}),jse(t,r),Ce(n.select)&&(n.select.on||n.select.clear)){const a='event.item && indexof(event.item.mark.role, "legend") < 0';for(const l of t.events)l.filter=ve(null!==(i=l.filter)&&void 0!==i?i:[]),l.filter.includes(a)||l.filter.push(a)}const s=Fj(t.bind)?t.bind.legend:"click",o=_e(s)?Of(s,"view"):ve(s);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const i=t.name,r=Fj(t.bind)&&t.bind.legend,s=o=>a=>{const l=Je(a);return l.markname=o,l};for(const o of t.project.items){if(!o.hasLegend)continue;const a=`${An(o.field)}_legend`,l=`${i}_${a}`;if(0===n.filter(c=>c.name===l).length){const c=r.merge.map(s(`${a}_symbols`)).concat(r.merge.map(s(`${a}_labels`))).concat(r.merge.map(s(`${a}_entries`)));n.unshift(Object.assign(Object.assign({name:l},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:`!event.item || !datum ? null : ${l}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.find(d=>d.name===i+Jf),o=i+Xv,a=r.items.filter(d=>d.hasLegend).map(d=>An(`${i}_${An(d.field)}_legend`)),u=`${a.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${o}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?s.on.push({events:a.map(d=>({signal:d})),update:u}):a.length>0&&(s.update=u,delete s.value,delete s.on);const c=n.find(d=>d.name===i+px),f=Fj(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}},Nse="_translate_anchor",kse="_translate_delta",L7e={defined:e=>"interval"===e.type&&e.translate,signals:(e,t,n)=>{const i=t.name,r=Yf.defined(t),s=i+Nse,{x:o,y:a}=t.project.hasChannel;let l=Of(t.translate,"scope");return r||(l=l.map(u=>(u.between[0].markname=i+Hm,u))),n.push({name:s,value:{},on:[{events:l.map(u=>u.between[0]),update:"{x: x(unit), y: y(unit)"+(void 0!==o?`, extent_x: ${r?Kj(e,Pn):`slice(${o.signals.visual})`}`:"")+(void 0!==a?`, extent_y: ${r?Kj(e,Li):`slice(${a.signals.visual})`}`:"")+"}"}]},{name:i+kse,value:{},on:[{events:l,update:`{x: ${s}.x - x(unit), y: ${s}.y - y(unit)}`}]}),void 0!==o&&Ise(e,t,o,"width",n),void 0!==a&&Ise(e,t,a,"height",n),n}};function Ise(e,t,n,i,r){var s,o;const a=t.name,l=a+Nse,u=a+kse,c=n.channel,f=Yf.defined(t),d=r.filter(w=>w.name===n.signals[f?"data":"visual"])[0],h=e.getSizeSignalRef(i).signal,p=e.getScaleComponent(c),g=p.get("type"),m=p.get("reverse"),y=`${l}.extent_${c}`,C=`${f?"log"===g?"panLog":"symlog"===g?"panSymlog":"pow"===g?"panPow":"panLinear":"panLinear"}(${y}, ${f?c===Pn?m?"":"-":m?"-":"":""}${u}.${c} / ${f?`${h}`:`span(${y})`}${f?"pow"===g?`, ${null!==(s=p.get("exponent"))&&void 0!==s?s:1}`:"symlog"===g?`, ${null!==(o=p.get("constant"))&&void 0!==o?o:1}`:"":""})`;d.on.push({events:{signal:u},update:f?C:`clampRange(${C}, 0, ${h})`})}const Rse="_zoom_anchor",Fse="_zoom_delta",j7e={defined:e=>"interval"===e.type&&e.zoom,signals:(e,t,n)=>{const i=t.name,r=Yf.defined(t),s=i+Fse,{x:o,y:a}=t.project.hasChannel,l=fe(e.scaleName(Pn)),u=fe(e.scaleName(Li));let c=Of(t.zoom,"scope");return r||(c=c.map(f=>(f.markname=i+Hm,f))),n.push({name:i+Rse,on:[{events:c,update:r?"{"+[l?`x: invert(${l}, x(unit))`:"",u?`y: invert(${u}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:s,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==o&&Pse(e,t,o,"width",n),void 0!==a&&Pse(e,t,a,"height",n),n}};function Pse(e,t,n,i,r){var s,o;const a=t.name,l=n.channel,u=Yf.defined(t),c=r.filter(b=>b.name===n.signals[u?"data":"visual"])[0],f=e.getSizeSignalRef(i).signal,d=e.getScaleComponent(l),h=d.get("type"),p=u?Kj(e,l):c.name,g=a+Fse,v=`${u?"log"===h?"zoomLog":"symlog"===h?"zoomSymlog":"pow"===h?"zoomPow":"zoomLinear":"zoomLinear"}(${p}, ${a}${Rse}.${l}, ${g}${u?"pow"===h?`, ${null!==(s=d.get("exponent"))&&void 0!==s?s:1}`:"symlog"===h?`, ${null!==(o=d.get("constant"))&&void 0!==o?o:1}`:"":""})`;c.on.push({events:{signal:g},update:u?v:`clampRange(${v}, 0, ${f})`})}const Bh="_store",Jf="_tuple",B7e="_modify",Lse="vlSelectionResolve",gx=[_7e,g7e,h7e,Ose,Tse,Yf,Mse,R7e,L7e,j7e,Ase];function zm(e,{escape:t}={escape:!0}){let n=t?fe(e.name):e.name;const i=function $7e(e){let t=e.parent;for(;t&&!ja(t);)t=t.parent;return t}(e);if(i){const{facet:r}=i;for(const s of jo)r[s]&&(n+=` + '__facet_${s}_' + (facet[${fe(i.vgField(s))}])`)}return n}function nB(e){var t;return yr(null!==(t=e.component.selection)&&void 0!==t?t:{}).reduce((n,i)=>n||i.project.items.some(r=>r.field===Kv),!1)}function jse(e,t){(_e(t.select)||!t.select.on)&&delete e.events,(_e(t.select)||!t.select.clear)&&delete e.clear,(_e(t.select)||!t.select.toggle)&&delete e.toggle}function iB(e){const t=[];return"Identifier"===e.type?[e.name]:"Literal"===e.type?[e.value]:("MemberExpression"===e.type&&(t.push(...iB(e.object)),t.push(...iB(e.property))),t)}function Bse(e){return"MemberExpression"===e.object.type?Bse(e.object):"datum"===e.object.name}function $se(e){const t=mL(e),n=new Set;return t.visit(i=>{"MemberExpression"===i.type&&Bse(i)&&n.add(iB(i).slice(1).join("."))}),n}class Gm extends en{constructor(t,n,i){super(t),this.model=n,this.filter=i,this.expr=mx(this.model,this.filter,this),this._dependentFields=$se(this.expr)}clone(){return new Gm(null,this.model,Je(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function Vse(e,t,n,i="datum"){const r=_e(t)?t:t.param,s=An(r),o=fe(s+Bh);let a;try{a=e.getSelectionComponent(s,r)}catch(c){return`!!${s}`}if(a.project.timeUnit){const c=null!=n?n:e.component.data.raw,f=a.project.timeUnit.clone();c.parent?f.insertAsParentOf(c):c.parent=f}const l=`vlSelectionTest(${o}, ${i}${"global"===a.resolve?")":`, ${fe(a.resolve)})`}`,u=`length(data(${o}))`;return!1===t.empty?`${u} && ${l}`:`!${u} || ${l}`}function Hse(e,t,n){const i=An(t),r=n.encoding;let o,s=n.field;try{o=e.getSelectionComponent(i,t)}catch(a){return i}if(r||s){if(r&&!s){const a=o.project.items.filter(l=>l.channel===r);!a.length||a.length>1?(s=o.project.items[0].field,le((a.length?"Multiple ":"No ")+`matching ${fe(r)} encoding found for selection ${fe(n.param)}. Using "field": ${fe(s)}.`)):s=a[0].field}}else s=o.project.items[0].field,o.project.items.length>1&&le(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${fe(s)}.`);return`${o.name}[${fe(Po(s))}]`}function mx(e,t,n){return Rv(t,i=>_e(i)?i:function xVe(e){return null==e?void 0:e.param}(i)?Vse(e,i,n):Aie(i))}var _x=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function rB(e,t,n,i){var r,s,o,a,l;null!==(r=e.encode)&&void 0!==r||(e.encode={}),null!==(s=(a=e.encode)[t])&&void 0!==s||(a[t]={}),null!==(o=(l=e.encode[t]).update)&&void 0!==o||(l.update={}),e.encode[t].update[n]=i}function e1(e,t,n,i={header:!1}){var r,s;const o=e.combine(),{disable:a,orient:l,scale:u,labelExpr:c,title:f,zindex:d}=o,h=_x(o,["disable","orient","scale","labelExpr","title","zindex"]);if(!a){for(const p in h){const g=SHe[p],m=h[p];if(g&&g!==t&&"both"!==g)delete h[p];else if(Yv(m)){const{condition:_}=m,y=_x(m,["condition"]),v=ve(_),b=fre[p];if(b){const{vgProp:D,part:C}=b;rB(h,C,D,[...v.map(E=>{const{test:O}=E,M=_x(E,["test"]);return Object.assign({test:mx(null,O)},M)}),y]),delete h[p]}else if(null===b){const D={signal:v.map(C=>{const{test:w}=C,E=_x(C,["test"]);return`${mx(null,w)} ? ${Xne(E)} : `}).join("")+Xne(y)};h[p]=D}}else if(Ne(m)){const _=fre[p];if(_){const{vgProp:y,part:v}=_;rB(h,v,y,m),delete h[p]}}bt(["labelAlign","labelBaseline"],p)&&null===h[p]&&delete h[p]}if("grid"===t){if(!h.grid)return;if(h.encode){const{grid:p}=h.encode;h.encode=Object.assign({},p?{grid:p}:{}),Zt(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:u,orient:l},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:fi(d,0)})}{if(!i.header&&e.mainExtracted)return;if(void 0!==c){let g=c;(null===(s=null===(r=h.encode)||void 0===r?void 0:r.labels)||void 0===s?void 0:s.update)&&Ne(h.encode.labels.update.text)&&(g=xh(c,"datum.label",h.encode.labels.update.text.signal)),rB(h,"labels","text",{signal:g})}if(null===h.labelAlign&&delete h.labelAlign,h.encode){for(const g of dre)e.hasAxisPart(g)||delete h.encode[g];Zt(h.encode)&&delete h.encode}const p=function U7e(e,t){if(e)return Z(e)&&!$f(e)?e.map(n=>Dj(n,t)).join(", "):e}(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:u,orient:l,grid:!1},p?{title:p}:{}),h),!1===n.aria?{aria:!1}:{}),{zindex:fi(d,0)})}}}function Use(e){const{axes:t}=e.component,n=[];for(const i of $l)if(t[i])for(const r of t[i])if(!r.get("disable")&&!r.get("gridScale")){const s="x"===i?"height":"width",o=e.getSizeSignalRef(s).signal;s!==o&&n.push({name:s,update:o})}return n}function zse(e,t,n,i){return Object.assign.apply(null,[{},...e.map(r=>{if("axisOrient"===r){const s="x"===n?"bottom":"left",o=t["x"===n?"axisBottom":"axisLeft"]||{},a=t["x"===n?"axisTop":"axisRight"]||{},l=new Set([...ie(o),...ie(a)]),u={};for(const c of l.values())u[c]={signal:`${i.signal} === "${s}" ? ${Zu(o[c])} : ${Zu(a[c])}`};return u}return t[r]})])}function W7e(e,t){var n;const i=[{}];for(const r of e){let s=null===(n=t[r])||void 0===n?void 0:n.style;if(s){s=ve(s);for(const o of s)i.push(t.style[o])}}return Object.assign.apply(null,i)}function sB(e,t,n,i={}){var r;const s=Zne(e,n,t);if(void 0!==s)return{configFrom:"style",configValue:s};for(const o of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(void 0!==(null===(r=i[o])||void 0===r?void 0:r[e]))return{configFrom:o,configValue:i[o][e]};return{}}const Gse={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:i,formatType:r}=n;return Wie(e,e.type,i,r,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return qie(i,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var i;return null!==(i=t.grid)&&void 0!==i?i:function q7e(e,t){return!ji(e)&&he(t)&&!mn(null==t?void 0:t.bin)&&!qr(null==t?void 0:t.bin)}(n,e)},gridScale:({model:e,channel:t})=>function Y7e(e,t){const n="x"===t?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||qse(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||Wse(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var i;return null!==(i=e.labelFlush)&&void 0!==i?i:function J7e(e,t){if("x"===t&&bt(["quantitative","temporal"],e))return!0}(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var i;return null!==(i=e.labelOverlap)&&void 0!==i?i:function X7e(e,t,n,i){if(n&&!Ce(i)||"nominal"!==e&&"ordinal"!==e)return"log"!==t&&"symlog"!==t||"greedy"}(t.type,n,he(t)&&!!t.timeUnit,he(t)?t.sort:void 0)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{var s;const o="x"===e?"width":"y"===e?"height":void 0,a=o?t.getSizeSignalRef(o):void 0;return null!==(s=n.tickCount)&&void 0!==s?s:function Z7e({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){var r;if(!i&&!ji(t)&&"log"!==t){if(he(e)){if(mn(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&bt(["month","hours","day","quarter"],null===(r=Yr(e.timeUnit))||void 0===r?void 0:r.unit))return}return{signal:`ceil(${n.signal}/40)`}}}({fieldOrDatumDef:i,scaleType:r,size:a,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(void 0!==e.title)return e.title;const i=Yse(t,n);if(void 0!==i)return i;const r=t.typedFieldDef(n),o=t.fieldDef("x"===n?"x2":"y2");return tie(r?[ere(r)]:[],he(o)?[ere(o)]:[])},values:({axis:e,fieldOrDatumDef:t})=>function e9e(e,t){const n=e.values;return Z(n)?cre(t,n):Ne(n)?n:void 0}(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var i;return null!==(i=e.zindex)&&void 0!==i?i:function t9e(e,t){return"rect"===e&&JS(t)?1:0}(n,t)}};function oB(e){return`(((${e.signal} % 360) + 360) % 360)`}function Wse(e,t,n,i){if(void 0!==e){if("x"===n){if(Ne(e)){const r=oB(e);return{signal:`(45 < ${r} && ${r} < 135) || (225 < ${r} && ${r} < 315) ? "middle" :(${r} <= 45 || 315 <= ${r}) === ${Ne(t)?`(${t.signal} === "top")`:"top"===t} ? "bottom" : "top"`}}return 45<e&&e<135||225<e&&e<315?"middle":Ne(t)?{signal:`${t.signal} ${e<=45||315<=e?"===":"!=="} "top" ? "bottom" : "top"`}:(e<=45||315<=e)==("top"===t)?"bottom":"top"}if(Ne(e)){const r=oB(e);return{signal:`${r} <= 45 || 315 <= ${r} || (135 <= ${r} && ${r} <= 225) ? ${i?'"middle"':"null"} : (45 <= ${r} && ${r} <= 135) === ${Ne(t)?`(${t.signal} === "left")`:"left"===t} ? "top" : "bottom"`}}return e<=45||315<=e||135<=e&&e<=225?i?"middle":null:Ne(t)?{signal:`${t.signal} ${45<=e&&e<=135?"===":"!=="} "left" ? "top" : "bottom"`}:(45<=e&&e<=135)==("left"===t)?"top":"bottom"}}function qse(e,t,n){if(void 0===e)return;const i="x"===n,r=i?0:90,s=i?"bottom":"left";if(Ne(e)){const o=oB(e);return{signal:`(${r?`(${o} + 90)`:o} % 180 === 0) ? ${i?null:'"center"'} :(${r} < ${o} && ${o} < ${180+r}) === ${Ne(t)?`(${t.signal} === "${s}")`:t===s} ? "left" : "right"`}}return(e+r)%180==0?i?null:"center":Ne(t)?{signal:`${t.signal} ${r<e&&e<180+r?"===":"!=="} "${s}" ? "left" : "right"`}:(r<e&&e<180+r)==(t===s)?"left":"right"}function Yse(e,t){const n="x"===t?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),s=i?i.title:void 0,o=r?r.title:void 0;return s&&o?nie(s,o):s||o||(void 0!==s?s:void 0!==o?o:void 0)}class Wm extends en{constructor(t,n){super(t),this.transform=n,this._dependentFields=$se(this.transform.calculate)}clone(){return new Wm(null,Je(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((i,r)=>{if(Lh(i)&&Zie(i.sort)){const{field:s,timeUnit:o}=i,a=i.sort,l=a.map((u,c)=>`${Aie({field:s,timeUnit:o,equal:u})} ? ${c} : `).join("")+a.length;t=new Wm(t,{calculate:l,as:qm(i,r,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${vt(this.transform)}`}}function qm(e,t,n){return pe(e,Object.assign({prefix:t,suffix:"sort_index"},null!=n?n:{}))}function yx(e,t){return bt(["top","bottom"],t)?"column":bt(["left","right"],t)||"row"===e?"row":"column"}function Ym(e,t,n,i){return fi((t||{})[e],("row"===i?n.headerRow:"column"===i?n.headerColumn:n.headerFacet)[e],n.header[e])}function vx(e,t,n,i){const r={};for(const s of e){const o=Ym(s,t||{},n,i);void 0!==o&&(r[s]=o)}return r}const aB=["row","column"],lB=["header","footer"];function n9e(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:s,titleAngle:o,titleOrient:a}=vx(["titleAnchor","titleAngle","titleOrient"],r.header,i,t),l=yx(t,a),u=Pv(o);return{name:`${t}-title`,type:"group",role:`${l}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},"row"===t?{orient:"left"}:{}),{style:"guide-title"}),Jse(u,l)),Kse(l,u,s)),Xse(i,r,t,WHe,kre))}}function Kse(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const i=qse(t,"row"===e?"left":"top","row"===e?"y":"x");return i?{align:i}:{}}function Jse(e,t){const n=Wse(e,"row"===t?"left":"top","row"===t?"y":"x",!0);return n?{baseline:n}:{}}function i9e(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of lB)if(n[r])for(const s of n[r]){const o=s9e(e,t,r,n,s);null!=o&&i.push(o)}return i}function r9e(e,t){var n;const{sort:i}=e;return Ul(i)?{field:pe(i,{expr:"datum"}),order:null!==(n=i.order)&&void 0!==n?n:"ascending"}:Z(i)?{field:qm(e,t,{expr:"datum"}),order:"ascending"}:{field:pe(e,{expr:"datum"}),order:null!=i?i:"ascending"}}function uB(e,t,n){const{format:i,formatType:r,labelAngle:s,labelAnchor:o,labelOrient:a,labelExpr:l}=vx(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),u=gj({fieldOrDatumDef:e,format:i,formatType:r,expr:"parent",config:n}).signal,c=yx(t,a);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:l?xh(xh(l,"datum.label",u),"datum.value",pe(e,{expr:"parent"})):u}},"row"===t?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),Jse(s,c)),Kse(c,s,o)),Xse(n,e,t,qHe,Ire))}function s9e(e,t,n,i,r){if(r){let s=null;const{facetFieldDef:o}=i,a=e.config?e.config:void 0;if(o&&r.labels){const{labelOrient:f}=vx(["labelOrient"],o.header,a,t);("row"===t&&!bt(["top","bottom"],f)||"column"===t&&!bt(["left","right"],f))&&(s=uB(o,t,a))}const l=ja(e)&&!Gv(e.facet),u=r.axes,c=(null==u?void 0:u.length)>0;if(s||c){const f="row"===t?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},i.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:r9e(o,t)}:{}),c&&l?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),s?{title:s}:{}),r.sizeSignal?{encode:{update:{[f]:r.sizeSignal}}}:{}),c?{axes:u}:{})}}return null}const o9e={column:{start:0,end:1},row:{start:1,end:0}};function a9e(e,t){return o9e[t][e]}function Xse(e,t,n,i,r){const s={};for(const o of i){if(!r[o])continue;const a=Ym(o,null==t?void 0:t.header,e,n);void 0!==a&&(s[r[o]]=a)}return s}function cB(e){return[...bx(e,"width"),...bx(e,"height"),...bx(e,"childWidth"),...bx(e,"childHeight")]}function bx(e,t){const n="width"===t?"x":"y",i=e.component.layoutSize.get(t);if(!i||"merged"===i)return[];const r=e.getSizeSignalRef(t).signal;if("step"===i){const s=e.getScaleComponent(n);if(s){const o=s.get("type"),a=s.get("range");if(ji(o)&&Vf(a)){const l=e.scaleName(n);return ja(e.parent)&&"independent"===e.parent.component.resolve.scale[n]?[Qse(l,a)]:[Qse(l,a),{name:r,update:Zse(l,s,`domain('${l}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==i){const s=r.endsWith("width"),o=s?"containerSize()[0]":"containerSize()[1]",l=`isFinite(${o}) ? ${o} : ${Bj(e.config.view,s?"width":"height")}`;return[{name:r,init:l,on:[{update:l,events:"window:resize"}]}]}return[{name:r,value:i}]}function Qse(e,t){const n=`${e}_step`;return Ne(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function Zse(e,t,n){const i=t.get("type"),r=t.get("padding"),s=fi(t.get("paddingOuter"),r);let o=t.get("paddingInner");return o="band"===i?void 0!==o?o:r:1,`bandspace(${n}, ${Zu(o)}, ${Zu(s)}) * ${e}_step`}function eoe(e){return"childWidth"===e?"width":"childHeight"===e?"height":e}function toe(e,t){return ie(e).reduce((n,i)=>{const r=e[i];return Object.assign(Object.assign({},n),Um(t,r,i,s=>wn(s.value)))},{})}function noe(e,t){if(ja(t))return"theta"===e?"independent":"shared";if(Xm(t))return"shared";if(xB(t))return Ji(e)||"theta"===e||"radius"===e?"independent":"shared";throw new Error("invalid model type for resolve")}function fB(e,t){const n=e.scale[t],i=Ji(t)?"axis":"legend";return"independent"===n?("shared"===e[i][t]&&le(function Y6e(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}(t)),"independent"):e[i][t]||"shared"}const u9e=Object.assign(Object.assign({},Pre),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),ioe=ie(u9e);class c9e extends nc{}const roe={symbols:function f9e(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r,legendType:s}){var o,a,l,u,c,f,d,h;if("symbol"!==s)return;const{markDef:p,encoding:g,config:m,mark:_}=n,y=p.filled&&"trail"!==_;let v=Object.assign(Object.assign({},function r6e(e,t,n){for(const i of n){const r=Nh(i,t.markDef,t.config);void 0!==r&&(e[i]=wn(r))}return e}({},n,JVe)),wse(n,{filled:y}));const b=null!==(o=r.get("symbolOpacity"))&&void 0!==o?o:m.legend.symbolOpacity,D=null!==(a=r.get("symbolFillColor"))&&void 0!==a?a:m.legend.symbolFillColor,C=null!==(l=r.get("symbolStrokeColor"))&&void 0!==l?l:m.legend.symbolStrokeColor,w=void 0===b?null!==(u=soe(g.opacity))&&void 0!==u?u:p.opacity:void 0;if(v.fill)if("fill"===i||y&&i===vs)delete v.fill;else if(v.fill.field)D?delete v.fill:(v.fill=wn(null!==(c=m.legend.symbolBaseFillColor)&&void 0!==c?c:"black"),v.fillOpacity=wn(null!=w?w:1));else if(Z(v.fill)){const E=null!==(h=null!==(d=dB(null!==(f=g.fill)&&void 0!==f?f:g.color))&&void 0!==d?d:p.fill)&&void 0!==h?h:y&&p.color;E&&(v.fill=wn(E))}if(v.stroke)if("stroke"===i||!y&&i===vs)delete v.stroke;else if(v.stroke.field||C)delete v.stroke;else if(Z(v.stroke)){const E=fi(dB(g.stroke||g.color),p.stroke,y?p.color:void 0);E&&(v.stroke={value:E})}if(i!==Ku){const E=he(t)&&aoe(0,r,t);E?v.opacity=[Object.assign({test:E},wn(null!=w?w:1)),wn(m.legend.unselectedOpacity)]:w&&(v.opacity=wn(w))}return v=Object.assign(Object.assign({},v),e),Zt(v)?void 0:v},gradient:function d9e(e,{model:t,legendType:n,legendCmpt:i}){var r;if("gradient"!==n)return;const{config:s,markDef:o,encoding:a}=t;let l={};const c=void 0===(null!==(r=i.get("gradientOpacity"))&&void 0!==r?r:s.legend.gradientOpacity)?soe(a.opacity)||o.opacity:void 0;return c&&(l.opacity=wn(c)),l=Object.assign(Object.assign({},l),e),Zt(l)?void 0:l},labels:function h9e(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){const s=n.legend(i)||{},o=n.config,a=he(t)?aoe(0,r,t):void 0,l=a?[{test:a,value:1},{value:o.legend.unselectedOpacity}]:void 0,{format:u,formatType:c}=s,f=Ph(c)?mj({fieldOrDatumDef:t,field:"datum.value",format:u,formatType:c,config:o}):void 0,d=Object.assign(Object.assign(Object.assign({},l?{opacity:l}:{}),f?{text:f}:{}),e);return Zt(d)?void 0:d},entries:function p9e(e,{legendCmpt:t}){const n=t.get("selections");return(null==n?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}};function soe(e){return ooe(e,(t,n)=>Math.max(t,n.value))}function dB(e){return ooe(e,(t,n)=>fi(t,n.value))}function ooe(e,t){return function hHe(e){const t=e&&e.condition;return!!t&&(Z(t)||Fa(t))}(e)?ve(e.condition).reduce(t,e.value):Fa(e)?e.value:void 0}function aoe(e,t,n){const i=t.get("selections");if(!(null==i?void 0:i.length))return;const r=fe(n.field);return i.map(s=>`(!length(data(${fe(An(s)+Bh)})) || (${s}[${r}] && indexof(${s}[${r}], datum.value) >= 0))`).join(" || ")}const loe={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:i,formatType:r}=t;return Wie(e,e.type,i,r,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return qie(i,t,n)},gradientLength:e=>{var t,n;const{legend:i,legendConfig:r}=e;return null!==(n=null!==(t=i.gradientLength)&&void 0!==t?t:r.gradientLength)&&void 0!==n?n:function w9e({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){const{gradientHorizontalMaxLength:s,gradientHorizontalMinLength:o,gradientVerticalMaxLength:a,gradientVerticalMinLength:l}=e;if(Ia(r))return"horizontal"===n?"top"===i||"bottom"===i?uoe(t,"width",o,s):o:uoe(t,"height",l,a)}(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var i,r;return null!==(r=null!==(i=e.labelOverlap)&&void 0!==i?i:t.labelOverlap)&&void 0!==r?r:function D9e(e){if(bt(["quantile","threshold","log","symlog"],e))return"greedy"}(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>{var r;return null!==(r=e.symbolType)&&void 0!==r?r:function m9e(e,t,n,i){var r;if("shape"!==t){const s=null!==(r=dB(n))&&void 0!==r?r:i;if(s)return s}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(t.type,n,i.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>Pm(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(Mm(n)&&Ia(t)){if("gradient"===e)return}else if("symbol"===e)return;return e},values:({fieldOrDatumDef:e,legend:t})=>function g9e(e,t){const n=e.values;return Z(n)?cre(t,n):Ne(n)?n:void 0}(t,e)};function uoe(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`}}function coe(e){const t=di(e)?function C9e(e){const{encoding:t}=e,n={};for(const i of[vs,...Fre]){const r=Ci(t[i]);!r||!e.getScaleComponent(i)||i===bs&&he(r)&&r.type===Im||(n[i]=x9e(e,i))}return n}(e):function A9e(e){const{legends:t,resolve:n}=e.component;for(const i of e.children){coe(i);for(const r of ie(i.component.legends))n.legend[r]=fB(e.component.resolve,r),"shared"===n.legend[r]&&(t[r]=foe(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]))}for(const i of ie(t))for(const r of e.children)!r.component.legends[i]||"shared"===n.legend[i]&&delete r.component.legends[i];return t}(e);return e.component.legends=t,t}function S9e(e,t,n,i){switch(t){case"disable":return void 0!==n;case"values":return!!(null==n?void 0:n.values);case"title":if("title"===t&&e===(null==i?void 0:i.title))return!0}return e===(n||{})[t]}function x9e(e,t){var n,i,r;let s=e.legend(t);const{markDef:o,encoding:a,config:l}=e,u=l.legend,c=new c9e({},function E9e(e,t){const n=e.scaleName(t);if("trail"===e.mark){if("color"===t)return{stroke:n};if("size"===t)return{strokeWidth:n}}return"color"===t?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}(e,t));!function P7e(e,t,n){var i,r,s,o;const a=null===(i=e.fieldDef(t))||void 0===i?void 0:i.field;for(const l of yr(null!==(r=e.component.selection)&&void 0!==r?r:{})){const u=null!==(s=l.project.hasField[a])&&void 0!==s?s:l.project.hasChannel[t];if(u&&Mse.defined(l)){const c=null!==(o=n.get("selections"))&&void 0!==o?o:[];c.push(l.name),n.set("selections",c,!1),u.hasLegend=!0}}}(e,t,c);const f=void 0!==s?!s:u.disable;if(c.set("disable",f,void 0!==s),f)return c;s=s||{};const d=e.getScaleComponent(t).get("type"),h=Ci(a[t]),p=he(h)?null===(n=Yr(h.timeUnit))||void 0===n?void 0:n.unit:void 0,g=s.orient||l.legend.orient||"right",m=function _9e(e){const{legend:t}=e;return fi(t.type,function y9e({channel:e,timeUnit:t,scaleType:n}){if(Mm(e)){if(bt(["quarter","month","day"],t))return"symbol";if(Ia(n))return"gradient"}return"symbol"}(e))}({legend:s,channel:t,timeUnit:p,scaleType:d}),_=function v9e({legendConfig:e,legendType:t,orient:n,legend:i}){var r,s;return null!==(s=null!==(r=i.direction)&&void 0!==r?r:e[t?"gradientDirection":"symbolDirection"])&&void 0!==s?s:function b9e(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===t?"horizontal":void 0}}(n,t)}({legend:s,legendType:m,orient:g,legendConfig:u}),y={legend:s,channel:t,model:e,markDef:o,encoding:a,fieldOrDatumDef:h,legendConfig:u,config:l,scaleType:d,orient:g,legendType:m,direction:_};for(const w of ioe){if("gradient"===m&&w.startsWith("symbol")||"symbol"===m&&w.startsWith("gradient"))continue;const E=w in loe?loe[w](y):s[w];if(void 0!==E){const O=S9e(E,w,s,e.fieldDef(t));(O||void 0===l.legend[w])&&c.set(w,E,O)}}const v=null!==(i=null==s?void 0:s.encoding)&&void 0!==i?i:{},b=c.get("selections"),D={},C={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:c,legendType:m};for(const w of["labels","legend","title","symbols","gradient","entries"]){const E=toe(null!==(r=v[w])&&void 0!==r?r:{},e),O=w in roe?roe[w](E,C):E;void 0!==O&&!Zt(O)&&(D[w]=Object.assign(Object.assign(Object.assign({},(null==b?void 0:b.length)&&he(h)?{name:`${An(h.field)}_legend_${w}`}:{}),(null==b?void 0:b.length)?{interactive:!!b}:{}),{update:O}))}return Zt(D)||c.set("encode",D,!!(null==s?void 0:s.encoding)),c}function foe(e,t){var n,i,r,s;if(!e)return t.clone();const o=e.getWithExplicit("orient"),a=t.getWithExplicit("orient");if(o.explicit&&a.explicit&&o.value!==a.value)return;let l=!1;for(const u of ioe){const c=Wf(e.getWithExplicit(u),t.getWithExplicit(u),u,"legend",(f,d)=>{switch(u){case"symbolType":return T9e(f,d);case"title":return iie(f,d);case"type":return l=!0,no("symbol")}return cx(f,d,u,"legend")});e.setWithExplicit(u,c)}return l&&((null===(i=null===(n=e.implicit)||void 0===n?void 0:n.encode)||void 0===i?void 0:i.gradient)&&bS(e.implicit,["encode","gradient"]),(null===(s=null===(r=e.explicit)||void 0===r?void 0:r.encode)||void 0===s?void 0:s.gradient)&&bS(e.explicit,["encode","gradient"])),e}function T9e(e,t){return"circle"===t.value?t:e}function doe(e){const t=e.component.legends,n={};for(const r of ie(t)){const s=e.getScaleComponent(r),o=gn(s.get("domains"));if(n[o])for(const a of n[o])foe(a,t[r])||n[o].push(t[r]);else n[o]=[t[r].clone()]}return yr(n).flat().map(r=>function N9e(e,t){var n,i,r;const s=e.combine(),{disable:o,labelExpr:a}=s,u=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(s,["disable","labelExpr","selections"]);if(!o){if(!1===t.aria&&null==u.aria&&(u.aria=!1),null===(n=u.encode)||void 0===n?void 0:n.symbols){const c=u.encode.symbols.update;c.fill&&"transparent"!==c.fill.value&&!c.stroke&&!u.stroke&&(c.stroke={value:"transparent"});for(const f of Fre)u[f]&&delete c[f]}if(u.title||delete u.title,void 0!==a){let c=a;(null===(r=null===(i=u.encode)||void 0===i?void 0:i.labels)||void 0===r?void 0:r.update)&&Ne(u.encode.labels.update.text)&&(c=xh(a,"datum.label",u.encode.labels.update.text.signal)),function M9e(e,t,n,i){var r,s,o,a,l;null!==(r=e.encode)&&void 0!==r||(e.encode={}),null!==(s=(a=e.encode)[t])&&void 0!==s||(a[t]={}),null!==(o=(l=e.encode[t]).update)&&void 0!==o||(l.update={}),e.encode[t].update[n]=i}(u,"labels","text",{signal:c})}return u}}(r,e.config)).filter(r=>void 0!==r)}function hoe(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:i}=n;if(t.data){const r={signal:`[${t.size.map(o=>o.signal).join(", ")}]`},s=t.data.reduce((o,a)=>{const l=Ne(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return bt(o,l)||o.push(l),o},[]);if(s.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:i,size:r,fit:{signal:s.length>1?`[${s.join(", ")}]`:s[0]}},n)]}return[Object.assign(Object.assign({name:i},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const R9e=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class poe extends nc{constructor(t,n,i,r){super(Object.assign({},n),{name:t}),this.specifiedProjection=n,this.size=i,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function goe(e){e.component.projection=di(e)?function F9e(e){var t;if(e.hasProjection){const n=Ds(e.specifiedProjection),i=!(n&&(null!=n.scale||null!=n.translate)),r=i?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,s=i?function P9e(e){const t=[],{encoding:n}=e;for(const i of[[Ll,Pl],[Lo,ka]])(Ci(n[i[0]])||Ci(n[i[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(bs)&&e.typedFieldDef(bs).type===Im&&t.push({signal:e.getName(`geojson_${t.length}`)}),0===t.length&&t.push(e.requestDataName(cn.Main)),t}(e):void 0,o=new poe(e.projectionName(!0),Object.assign(Object.assign({},null!==(t=Ds(e.config.projection))&&void 0!==t?t:{}),null!=n?n:{}),r,s);return o.get("type")||o.set("type","equalEarth",!1),o}}(e):function j9e(e){if(0===e.children.length)return;let t;for(const i of e.children)goe(i);const n=A3(e.children,i=>{const r=i.component.projection;if(r){if(t){const s=function L9e(e,t){const n=A3(R9e,r=>!!(!Oe(e.explicit,r)&&!Oe(t.explicit,r)||Oe(e.explicit,r)&&Oe(t.explicit,r)&&kl(e.get(r),t.get(r))));if(kl(e.size,t.size)){if(n)return e;if(kl(e.explicit,{}))return t;if(kl(t.explicit,{}))return e}return null}(t,r);return s&&(t=s),!!s}return t=r,!0}return!0});if(t&&n){const i=e.projectionName(!0),r=new poe(i,t.specifiedProjection,t.size,Je(t.data));for(const s of e.children){const o=s.component.projection;o&&(o.isFit&&r.data.push(...s.component.projection.data),s.renameProjection(o.get("name"),i),o.merged=!0)}return r}}(e)}function moe(e,t){return`${Wne(e)}_${t}`}function hB(e,t,n){var i;const s=moe(null!==(i=ZS(n,void 0))&&void 0!==i?i:{},t);return e.getName(`${s}_bins`)}function _oe(e,t,n){let i,r;i=function H9e(e){return"as"in e}(e)?_e(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:[pe(e,{forAs:!0}),pe(e,{binSuffix:"end",forAs:!0})];const s=Object.assign({},ZS(t,void 0)),o=moe(s,e.field),{signal:a,extentSignal:l}=function V9e(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}(n,o);if(kS(s.extent)){const c=s.extent;r=Hse(n,c.param,c),delete s.extent}return{key:o,binComponent:Object.assign(Object.assign(Object.assign({bin:s,field:e.field,as:[i]},a?{signal:a}:{}),l?{extentSignal:l}:{}),r?{span:r}:{})}}class Jl extends en{constructor(t,n){super(t),this.bins=n}clone(){return new Jl(null,Je(this.bins))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s,o)=>{if(Bo(s)&&mn(s.bin)){const{key:a,binComponent:l}=_oe(s,s.bin,n);r[a]=Object.assign(Object.assign(Object.assign({},l),r[a]),function $9e(e,t,n,i){var r,s;if(qv(t,n)){const o=di(e)&&null!==(s=null!==(r=e.axis(n))&&void 0!==r?r:e.legend(n))&&void 0!==s?s:{},a=pe(t,{expr:"datum"}),l=pe(t,{expr:"datum",binSuffix:"end"});return{formulaAs:pe(t,{binSuffix:"range",forAs:!0}),formula:US(a,l,o.format,o.formatType,i)}}return{}}(n,s,o,n.config))}return r},{});return Zt(i)?null:new Jl(t,i)}static makeFromTransform(t,n,i){const{key:r,binComponent:s}=_oe(n,n.bin,i);return new Jl(t,{[r]:s})}merge(t,n){for(const i of ie(t.bins))i in this.bins?(n(t.bins[i].signal,this.bins[i].signal),this.bins[i].as=Il([...this.bins[i].as,...t.bins[i].as],vt)):this.bins[i]=t.bins[i];for(const i of t.children)t.removeChild(i),i.parent=this;t.remove()}producedFields(){return new Set(yr(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(yr(this.bins).map(t=>t.field))}hash(){return`Bin ${vt(this.bins)}`}assemble(){return yr(this.bins).flatMap(t=>{const n=[],[i,...r]=t.as,s=t.bin,{extent:o}=s,a=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(s,["extent"]),l=Object.assign(Object.assign(Object.assign({type:"bin",field:Po(t.field),as:i,signal:t.signal},kS(o)?{extent:null}:{extent:o}),t.span?{span:{signal:`span(${t.span})`}}:{}),a);!o&&t.extentSignal&&(n.push({type:"extent",field:Po(t.field),signal:t.extentSignal}),l.extent={signal:t.extentSignal}),n.push(l);for(const u of r)for(let c=0;c<2;c++)n.push({type:"formula",expr:pe({field:i[c]},{expr:"datum"}),as:u[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}class Pa extends en{constructor(t,n,i){super(t),this.dimensions=n,this.measures=i}clone(){return new Pa(null,new Set(this.dimensions),Je(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let i=!1;n.forEachFieldDef(o=>{o.aggregate&&(i=!0)});const r={},s=new Set;return i&&(n.forEachFieldDef((o,a)=>{var l,u,c,f;const{aggregate:d,field:h}=o;if(d)if("count"===d)null!==(l=r["*"])&&void 0!==l||(r["*"]={}),r["*"].count=new Set([pe(o,{forAs:!0})]);else{if(Xu(d)||Bf(d)){const p=Xu(d)?"argmin":"argmax",g=d[p];null!==(u=r[g])&&void 0!==u||(r[g]={}),r[g][p]=new Set([pe({op:p,field:g},{forAs:!0})])}else null!==(c=r[h])&&void 0!==c||(r[h]={}),r[h][d]=new Set([pe(o,{forAs:!0})]);jf(a)&&"unaggregated"===n.scaleDomain(a)&&(null!==(f=r[h])&&void 0!==f||(r[h]={}),r[h].min=new Set([pe({field:h,aggregate:"min"},{forAs:!0})]),r[h].max=new Set([pe({field:h,aggregate:"max"},{forAs:!0})]))}else!function U9e(e,t,n,i){var r;const s=di(i)?i.encoding[Ju(t)]:void 0;if(Bo(n)&&di(i)&&ire(n,s,i.markDef,i.config))e.add(pe(n,{})),e.add(pe(n,{suffix:"end"})),n.bin&&qv(n,t)&&e.add(pe(n,{binSuffix:"range"}));else if(function N4e(e){return e in I3}(t)){const o=function M4e(e){switch(e){case Pl:return"y";case ka:return"y2";case Ll:return"x";case Lo:return"x2"}}(t);e.add(i.getName(o))}else e.add(pe(n));return Lh(n)&&function $Ve(e){return Ce(e)&&"field"in e}(null===(r=n.scale)||void 0===r?void 0:r.range)&&e.add(n.scale.range.field),e}(s,a,o,n)}),s.size+ie(r).length!==0)?new Pa(t,s,r):null}static makeFromTransform(t,n){var i,r,s;const o=new Set,a={};for(const l of n.aggregate){const{op:u,field:c,as:f}=l;u&&("count"===u?(null!==(i=a["*"])&&void 0!==i||(a["*"]={}),a["*"].count=new Set([f||pe(l,{forAs:!0})])):(null!==(r=a[c])&&void 0!==r||(a[c]={}),a[c][u]=new Set([f||pe(l,{forAs:!0})])))}for(const l of null!==(s=n.groupby)&&void 0!==s?s:[])o.add(l);return o.size+ie(a).length===0?null:new Pa(t,o,a)}merge(t){return One(this.dimensions,t.dimensions)?(function z9e(e,t){var n;for(const i of ie(t)){const r=t[i];for(const s of ie(r))i in e?e[i][s]=new Set([...null!==(n=e[i][s])&&void 0!==n?n:[],...r[s]]):e[i]={[s]:r[s]}}}(this.measures,t.measures),!0):(function fVe(...e){Vl.debug(...e)}("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...ie(this.measures)])}producedFields(){const t=new Set;for(const n of ie(this.measures))for(const i of ie(this.measures[n])){const r=this.measures[n][i];0===r.size?t.add(`${i}_${n}`):r.forEach(t.add,t)}return t}hash(){return`Aggregate ${vt({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],i=[];for(const s of ie(this.measures))for(const o of ie(this.measures[s]))for(const a of this.measures[s][o])i.push(a),t.push(o),n.push("*"===s?null:Po(s));return{type:"aggregate",groupby:[...this.dimensions].map(Po),ops:t,fields:n,as:i}}}class Km extends en{constructor(t,n,i,r){super(t),this.model=n,this.name=i,this.data=r;for(const s of jo){const o=n.facet[s];if(o){const{bin:a,sort:l}=o;this[s]=Object.assign({name:n.getName(`${s}_domain`),fields:[pe(o),...mn(a)?[pe(o,{binSuffix:"end"})]:[]]},Ul(l)?{sortField:l}:Z(l)?{sortIndexField:qm(o,s)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of jo)this[n]&&(t+=` ${n.charAt(0)}:${vt(this[n])}`);return t}get fields(){var t;const n=[];for(const i of jo)(null===(t=this[i])||void 0===t?void 0:t.fields)&&n.push(...this[i].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of jo)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of $l){const i=this.childModel.component.scales[n];if(i&&!i.merged){const r=i.get("type"),s=i.get("range");if(ji(r)&&Vf(s)){const a=CB(Dx(this.childModel,n));a?t[n]=a:le(z3(n))}}}return t}assembleRowColumnHeaderData(t,n,i){const r={row:"y",column:"x",facet:void 0}[t],s=[],o=[],a=[];r&&i&&i[r]&&(n?(s.push(`distinct_${i[r]}`),o.push("max")):(s.push(i[r]),o.push("distinct")),a.push(`distinct_${i[r]}`));const{sortField:l,sortIndexField:u}=this[t];if(l){const{op:c=zS,field:f}=l;s.push(f),o.push(c),a.push(pe(l,{forAs:!0}))}else u&&(s.push(u),o.push("max"),a.push(u));return{name:this[t].name,source:null!=n?n:this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},s.length?{fields:s,ops:o,as:a}:{})]}}assembleFacetHeaderData(t){var n,i;const{columns:r}=this.model.layout,{layoutHeaders:s}=this.model.component,o=[],a={};for(const c of aB){for(const f of lB){const d=null!==(n=s[c]&&s[c][f])&&void 0!==n?n:[];for(const h of d)if((null===(i=h.axes)||void 0===i?void 0:i.length)>0){a[c]=!0;break}}if(a[c]){const f=`length(data("${this.facet.name}"))`;o.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:"row"===c?r?{signal:`ceil(${f} / ${r})`}:1:r?{signal:`min(${f}, ${r})`}:{signal:f}}]})}}const{row:l,column:u}=a;return(l||u)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,t)),o}assemble(){var t,n;const i=[];let r=null;const s=this.getChildIndependentFieldsWithStep(),{column:o,row:a,facet:l}=this;if(o&&a&&(s.x||s.y)){r=`cross_${this.column.name}_${this.row.name}`;const u=[].concat(null!==(t=s.x)&&void 0!==t?t:[],null!==(n=s.y)&&void 0!==n?n:[]),c=u.map(()=>"distinct");i.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:u,ops:c}]})}for(const u of[Gu,zu])this[u]&&i.push(this.assembleRowColumnHeaderData(u,r,s));if(l){const u=this.assembleFacetHeaderData(s);u&&i.push(...u)}return i}}function yoe(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function W9e(e){const t={};return vS(e.filter,n=>{var i;if(xie(n)){let r=null;X3(n)?r=eo(n.equal):Z3(n)?r=eo(n.lte):Q3(n)?r=eo(n.lt):ej(n)?r=eo(n.gt):tj(n)?r=eo(n.gte):nj(n)?r=n.range[0]:ij(n)&&(r=(null!==(i=n.oneOf)&&void 0!==i?i:n.in)[0]),r&&(kh(r)?t[n.field]="date":Xt(r)?t[n.field]="number":_e(r)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}class wr extends en{constructor(t,n){super(t),this._parse=n}clone(){return new wr(null,Je(this._parse))}hash(){return`Parse ${vt(this._parse)}`}static makeExplicit(t,n,i){var r;let s={};const o=n.data;return!qf(o)&&(null===(r=null==o?void 0:o.format)||void 0===r?void 0:r.parse)&&(s=o.format.parse),this.makeWithAncestors(t,s,{},i)}static makeWithAncestors(t,n,i,r){for(const a of ie(i)){const l=r.getWithExplicit(a);void 0!==l.value&&(l.explicit||l.value===i[a]||"derived"===l.value||"flatten"===i[a]?delete i[a]:le(cie(a,i[a],l.value)))}for(const a of ie(n)){const l=r.get(a);void 0!==l&&(l===n[a]?delete n[a]:le(cie(a,n[a],l)))}const s=new nc(n,i);r.copyAll(s);const o={};for(const a of ie(s.combine())){const l=s.get(a);null!==l&&(o[a]=l)}return 0===ie(o).length||r.parseNothing?null:new wr(t,o)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of ie(this._parse)){const i=this._parse[n];1===Tm(n)&&(t[n]=i)}return t}producedFields(){return new Set(ie(this._parse))}dependentFields(){return new Set(ie(this._parse))}assembleTransforms(t=!1){return ie(this._parse).filter(n=>!t||Tm(n)>1).map(n=>{const i=function G9e(e,t){const n=N3(e);return"number"===t?`toNumber(${n})`:"boolean"===t?`toBoolean(${n})`:"string"===t?`toString(${n})`:"date"===t?`toDate(${n})`:"flatten"===t?n:t.startsWith("date:")?`timeParse(${n},'${yoe(t.slice(5,t.length))}')`:t.startsWith("utc:")?`utcParse(${n},'${yoe(t.slice(4,t.length))}')`:(le(function _6e(e){return`Unrecognized parse "${e}".`}(t)),null)}(n,this._parse[n]);return i?{type:"formula",expr:i,as:k3(n)}:null}).filter(n=>null!==n)}}class Xf extends en{clone(){return new Xf(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Kv])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Kv}}}class t1 extends en{constructor(t,n){super(t),this.params=n}clone(){return new t1(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${vt(this.params)}`}assemble(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}class n1 extends en{constructor(t,n){super(t),this.params=n}clone(){return new n1(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([null!==(t=this.params.as)&&void 0!==t?t:"data"])}hash(){return`Hash ${vt(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}class $h extends en{constructor(t){let n;if(super(null),null!=t||(t={name:"source"}),qf(t)||(n=t.format?Object.assign({},Zs(t.format,["parse"])):{}),Jv(t))this._data={values:t.values};else if($m(t)){if(this._data={url:t.url},!n.type){let i=/(?:\.([^.]+))?$/.exec(t.url)[1];bt(["json","csv","tsv","dsv","topojson"],i)||(i="json"),n.type=i}}else pse(t)?this._data={values:[{type:"Sphere"}]}:(dse(t)||qf(t))&&(this._data={});this._generator=qf(t),t.name&&(this._name=t.name),n&&!Zt(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}var i1,voe=function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n};function pB(e){return e instanceof $h||e instanceof t1||e instanceof n1}class gB{constructor(){i1.set(this,void 0),voe(this,i1,!1,"f")}setModified(){voe(this,i1,!0,"f")}get modifiedFlag(){return function(e,t,n,i){if("function"==typeof t||!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}(this,i1)}}i1=new WeakMap;class Vh extends gB{getNodeDepths(t,n,i){i.set(t,n);for(const r of t.children)this.getNodeDepths(r,n+1,i);return i}optimize(t){const i=[...this.getNodeDepths(t,0,new Map).entries()].sort((r,s)=>s[1]-r[1]);for(const r of i)this.run(r[0]);return this.modifiedFlag}}class mB extends gB{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class J9e extends mB{mergeNodes(t,n){const i=n.shift();for(const r of n)t.removeChild(r),r.parent=i,r.remove()}run(t){const n=t.children.map(r=>r.hash()),i={};for(let r=0;r<n.length;r++)void 0===i[n[r]]?i[n[r]]=[t.children[r]]:i[n[r]].push(t.children[r]);for(const r of ie(i))i[r].length>1&&(this.setModified(),this.mergeNodes(t,i[r]))}}class X9e extends mB{constructor(t){super(),this.requiresSelectionId=t&&nB(t)}run(t){t instanceof Xf&&(this.requiresSelectionId&&(pB(t.parent)||t.parent instanceof Pa||t.parent instanceof wr)||(this.setModified(),t.remove()))}}class Q9e extends gB{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let i=new Set;t instanceof Kl&&(i=t.producedFields(),T3(i,n)&&(this.setModified(),t.removeFormulas(n),0===t.producedFields.length&&t.remove()));for(const r of t.children)this.run(r,new Set([...n,...i]))}}class Z9e extends mB{constructor(){super()}run(t){t instanceof Kr&&!t.isRequired()&&(this.setModified(),t.remove())}}class eze extends Vh{run(t){if(!(pB(t)||t.numChildren()>1))for(const n of t.children)if(n instanceof wr)if(t instanceof wr)this.setModified(),t.merge(n);else{if(M3(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}class tze extends Vh{run(t){const n=[...t.children],i=t.children.filter(r=>r instanceof wr);if(t.numChildren()>1&&i.length>=1){const r={},s=new Set;for(const o of i){const a=o.parse;for(const l of ie(a))l in r?r[l]!==a[l]&&s.add(l):r[l]=a[l]}for(const o of s)delete r[o];if(!Zt(r)){this.setModified();const o=new wr(t,r);for(const a of n){if(a instanceof wr)for(const l of ie(r))delete a.parse[l];t.removeChild(a),a.parent=o,a instanceof wr&&0===ie(a.parse).length&&a.remove()}}}}}class nze extends Vh{run(t){t instanceof Kr||t.numChildren()>0||t instanceof Km||t instanceof $h||(this.setModified(),t.remove())}}class ize extends Vh{run(t){const n=t.children.filter(r=>r instanceof Kl),i=n.pop();for(const r of n)this.setModified(),i.merge(r)}}class rze extends Vh{run(t){const n=t.children.filter(r=>r instanceof Pa),i={};for(const r of n){const s=vt(r.groupBy);s in i||(i[s]=[]),i[s].push(r)}for(const r of ie(i)){const s=i[r];if(s.length>1){const o=s.pop();for(const a of s)o.merge(a)&&(t.removeChild(a),a.parent=o,a.remove(),this.setModified())}}}}class sze extends Vh{constructor(t){super(),this.model=t}run(t){const n=!(pB(t)||t instanceof Gm||t instanceof wr||t instanceof Xf),i=[],r=[];for(const s of t.children)s instanceof Jl&&(n&&!M3(t.producedFields(),s.dependentFields())?i.push(s):r.push(s));if(i.length>0){const s=i.pop();for(const o of i)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof Jl?t.merge(s,this.model.renameSignal.bind(this.model)):s.swapWithParent()}if(r.length>1){const s=r.pop();for(const o of r)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified()}}}class oze extends Vh{run(t){const n=[...t.children];if(!Sh(n,o=>o instanceof Kr)||t.numChildren()<=1)return;const r=[];let s;for(const o of n)if(o instanceof Kr){let a=o;for(;1===a.numChildren();){const[l]=a.children;if(!(l instanceof Kr))break;a=l}r.push(...a.children),s?(t.removeChild(o),o.parent=s.parent,s.parent.removeChild(s),s.parent=a,this.setModified()):s=a}else r.push(o);if(r.length){this.setModified();for(const o of r)o.parent.removeChild(o),o.parent=s}}}class Hh extends en{constructor(t,n){super(t),this.transform=n}clone(){return new Hh(null,Je(this.transform))}addDimensions(t){this.transform.groupby=Il(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>void 0!==n).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return null!==(n=t.as)&&void 0!==n?n:pe(t)}hash(){return`JoinAggregateTransform ${vt(this.transform)}`}assemble(){const t=[],n=[],i=[];for(const s of this.transform.joinaggregate)n.push(s.op),i.push(this.getDefaultName(s)),t.push(void 0===s.field?null:s.field);const r=this.transform.groupby;return Object.assign({type:"joinaggregate",as:i,ops:n,fields:t},void 0!==r?{groupby:r}:{})}}class ic extends en{constructor(t,n){super(t),this._stack=n}clone(){return new ic(null,Je(this._stack))}static makeFromTransform(t,n){const{stack:i,groupby:r,as:s,offset:o="zero"}=n,a=[],l=[];if(void 0!==n.sort)for(const f of n.sort)a.push(f.field),l.push(fi(f.order,"ascending"));const u={field:a,order:l};let c;return c=function lze(e){return Z(e)&&e.every(t=>_e(t))&&e.length>1}(s)?s:_e(s)?[s,`${s}_end`]:[`${n.stack}_start`,`${n.stack}_end`],new ic(t,{dimensionFieldDefs:[],stackField:i,groupby:r,offset:o,sort:u,facetby:[],as:c})}static makeFromEncoding(t,n){const i=n.stack,{encoding:r}=n;if(!i)return null;const{groupbyChannels:s,fieldChannel:o,offset:a,impute:l}=i,u=s.map(h=>Wl(r[h])).filter(h=>!!h),c=function aze(e){return e.stack.stackBy.reduce((t,n)=>{const r=pe(n.fieldDef);return r&&t.push(r),t},[])}(n),f=n.encoding.order;let d;return d=Z(f)||he(f)?eie(f):c.reduce((h,p)=>(h.field.push(p),h.order.push("y"===o?"descending":"ascending"),h),{field:[],order:[]}),new ic(t,{dimensionFieldDefs:u,stackField:n.vgField(o),facetby:[],stackby:c,sort:d,offset:a,impute:l,as:[n.vgField(o,{suffix:"start",forAs:!0}),n.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${vt(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:t,impute:n,groupby:i}=this._stack;return t.length>0?t.map(r=>r.bin?n?[pe(r,{binSuffix:"mid"})]:[pe(r,{}),pe(r,{binSuffix:"end"})]:[pe(r)]).flat():null!=i?i:[]}assemble(){const t=[],{facetby:n,dimensionFieldDefs:i,stackField:r,stackby:s,sort:o,offset:a,impute:l,as:u}=this._stack;if(l)for(const c of i){const{bandPosition:f=.5,bin:d}=c;if(d){const h=pe(c,{expr:"datum"}),p=pe(c,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:`${f}*${h}+${1-f}*${p}`,as:pe(c,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:r,groupby:[...s,...n],key:pe(c,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:r,sort:o,as:u,offset:a}),t}}class Jm extends en{constructor(t,n){super(t),this.transform=n}clone(){return new Jm(null,Je(this.transform))}addDimensions(t){this.transform.groupby=Il(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const i=new Set;return(null!==(t=this.transform.groupby)&&void 0!==t?t:[]).forEach(i.add,i),(null!==(n=this.transform.sort)&&void 0!==n?n:[]).forEach(r=>i.add(r.field)),this.transform.window.map(r=>r.field).filter(r=>void 0!==r).forEach(i.add,i),i}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return null!==(n=t.as)&&void 0!==n?n:pe(t)}hash(){return`WindowTransform ${vt(this.transform)}`}assemble(){var t;const n=[],i=[],r=[],s=[];for(const d of this.transform.window)i.push(d.op),r.push(this.getDefaultName(d)),s.push(void 0===d.param?null:d.param),n.push(void 0===d.field?null:d.field);const o=this.transform.frame,a=this.transform.groupby;if(o&&null===o[0]&&null===o[1]&&i.every(d=>$3(d)))return Object.assign({type:"joinaggregate",as:r,ops:i,fields:n},void 0!==a?{groupby:a}:{});const l=[],u=[];if(void 0!==this.transform.sort)for(const d of this.transform.sort)l.push(d.field),u.push(null!==(t=d.order)&&void 0!==t?t:"ascending");const f=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:s,as:r,ops:i,fields:n,sort:{field:l,order:u}},void 0!==f?{ignorePeers:f}:{}),void 0!==a?{groupby:a}:{}),void 0!==o?{frame:o}:{})}}function _B(e){if(e instanceof Km)if(1!==e.numChildren()||e.children[0]instanceof Kr){const t=e.model.component.data.main;boe(t);const n=function uze(e){return function t(n){if(!(n instanceof Km)){const i=n.clone();if(i instanceof Kr){const r=yB+i.getSource();i.setSource(r),e.model.component.data.outputNodes[r]=i}else(i instanceof Pa||i instanceof ic||i instanceof Jm||i instanceof Hh)&&i.addDimensions(e.fields);for(const r of n.children.flatMap(t))r.parent=i;return[i]}return n.children.flatMap(t)}}(e),i=e.children.map(n).flat();for(const r of i)r.parent=t}else{const t=e.children[0];(t instanceof Pa||t instanceof ic||t instanceof Jm||t instanceof Hh)&&t.addDimensions(e.fields),t.swapWithParent(),_B(e)}else e.children.map(_B)}function boe(e){if(e instanceof Kr&&e.type===cn.Main&&1===e.numChildren()){const t=e.children[0];t instanceof Km||(t.swapWithParent(),boe(e))}}const yB="scale_";function vB(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!vB(t.children))return!1}return!0}function La(e,t){let n=!1;for(const i of t)n=e.optimize(i)||n;return n}function woe(e,t,n){let i=e.sources,r=!1;return r=La(new Z9e,i)||r,r=La(new X9e(t),i)||r,i=i.filter(s=>s.numChildren()>0),r=La(new nze,i)||r,i=i.filter(s=>s.numChildren()>0),n||(r=La(new eze,i)||r,r=La(new sze(t),i)||r,r=La(new Q9e,i)||r,r=La(new tze,i)||r,r=La(new rze,i)||r,r=La(new ize,i)||r,r=La(new J9e,i)||r,r=La(new oze,i)||r),e.sources=i,r}class Es{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Es(()=>t(n))}}function Doe(e){di(e)?function dze(e){const t=e.component.scales;for(const n of ie(t)){const i=gze(e,n);if(t[n].setWithExplicit("domains",i),_ze(e,n),e.component.data.isFaceted){let s=e;for(;!ja(s)&&s.parent;)s=s.parent;if("shared"===s.component.resolve.scale[n])for(const a of i.value)Qu(a)&&(a.data=yB+a.data.replace(yB,""))}}}(e):function hze(e){for(const n of e.children)Doe(n);const t=e.component.scales;for(const n of ie(t)){let i,r=null;for(const s of e.children){const o=s.component.scales[n];if(o){i=void 0===i?o.getWithExplicit("domains"):Wf(i,o.getWithExplicit("domains"),"domains","scale",DB);const a=o.get("selectionExtent");r&&a&&r.param!==a.param&&le("The same selection must be used to override scale domains in a layered view."),r=a}}t[n].setWithExplicit("domains",i),r&&t[n].set("selectionExtent",r,!0)}}(e)}function gze(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:i}=e,r=function pze(e,t,n,i){if("unaggregated"===e){const{valid:r,reason:s}=Coe(t,n);if(!r)return void le(s)}else if(void 0===e&&i.useUnaggregatedDomain){const{valid:r}=Coe(t,n);if(r)return"unaggregated"}return e}(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:r})),"x"===t&&Ci(i.x2)?Ci(i.x)?Wf(Qf(n,r,e,"x"),Qf(n,r,e,"x2"),"domain","scale",DB):Qf(n,r,e,"x2"):"y"===t&&Ci(i.y2)?Ci(i.y)?Wf(Qf(n,r,e,"y"),Qf(n,r,e,"y2"),"domain","scale",DB):Qf(n,r,e,"y2"):Qf(n,r,e,t)}function bB(e,t,n){var i;const r=null===(i=Yr(n))||void 0===i?void 0:i.unit;return"temporal"===t||r?function mze(e,t,n){return e.map(i=>({signal:`{data: ${ex(i,{timeUnit:n,type:t})}}`}))}(e,t,r):[e]}function Qf(e,t,n,i){const{encoding:r}=n,s=Ci(r[i]),{type:o}=s,a=s.timeUnit;if(function BVe(e){return e&&e.unionWith}(t)){const f=Qf(e,void 0,n,i),d=bB(t.unionWith,o,a);return Yl([...f.value,...d])}if(Ne(t))return Yl([t]);if(t&&"unaggregated"!==t&&!Rie(t))return Yl(bB(t,o,a));const l=n.stack;if(l&&i===l.fieldChannel){if("normalize"===l.offset)return no([[0,1]]);const f=n.requestDataName(cn.Main);return no([{data:f,field:n.vgField(i,{suffix:"start"})},{data:f,field:n.vgField(i,{suffix:"end"})}])}const u=jf(i)&&he(s)?function yze(e,t,n){if(!ji(n))return;const i=e.fieldDef(t),r=i.sort;if(Zie(r))return{op:"min",field:qm(i,t),order:"ascending"};const{stack:s}=e,o=s?new Set([...s.groupbyFields,...s.stackBy.map(a=>a.fieldDef.field)]):void 0;if(Ul(r))return wB(r,s&&!o.has(r.field));if(Qie(r)){const{encoding:a,order:l}=r,u=e.fieldDef(a),{aggregate:c,field:f}=u,d=s&&!o.has(f);if(Xu(c)||Bf(c))return wB({field:pe(u),order:l},d);if($3(c)||!c)return wB({op:c,field:f,order:l},d)}else{if("descending"===r)return{op:"min",field:e.vgField(t),order:"descending"};if(bt(["ascending",void 0],r))return!0}}(n,i,e):void 0;if(zl(s))return no(bB([s.datum],o,a));const c=s;if("unaggregated"===t){const f=n.requestDataName(cn.Main),{field:d}=s;return no([{data:f,field:pe({field:d,aggregate:"min"})},{data:f,field:pe({field:d,aggregate:"max"})}])}if(mn(c.bin)){if(ji(e))return no("bin-ordinal"===e?[]:[{data:Iv(u)?n.requestDataName(cn.Main):n.requestDataName(cn.Raw),field:n.vgField(i,qv(c,i)?{binSuffix:"range"}:{}),sort:!0!==u&&Ce(u)?u:{field:n.vgField(i,{}),op:"min"}}]);{const{bin:f}=c;if(mn(f)){const d=hB(n,c.field,f);return no([new Es(()=>{const h=n.getSignalName(d);return`[${h}.start, ${h}.stop]`})])}return no([{data:n.requestDataName(cn.Main),field:n.vgField(i,{})}])}}if(c.timeUnit&&bt(["time","utc"],e)&&ire(c,di(n)?n.encoding[Ju(i)]:void 0,n.markDef,n.config)){const f=n.requestDataName(cn.Main);return no([{data:f,field:n.vgField(i)},{data:f,field:n.vgField(i,{suffix:"end"})}])}return no(u?[{data:Iv(u)?n.requestDataName(cn.Main):n.requestDataName(cn.Raw),field:n.vgField(i),sort:u}]:[{data:n.requestDataName(cn.Main),field:n.vgField(i)}])}function wB(e,t){const{op:n,field:i,order:r}=e;return Object.assign(Object.assign({op:null!=n?n:t?"sum":zS},i?{field:Po(i)}:{}),r?{order:r}:{})}function _ze(e,t){var n;const i=e.component.scales[t],r=e.specifiedScales[t].domain,s=null===(n=e.fieldDef(t))||void 0===n?void 0:n.bin,o=Rie(r)&&r,a=Mh(s)&&kS(s.extent)&&s.extent;(o||a)&&i.set("selectionExtent",null!=o?o:a,!0)}function Coe(e,t){const{aggregate:n,type:i}=e;return n?_e(n)&&!X4e.has(n)?{valid:!1,reason:V6e(n)}:"quantitative"===i&&"log"===t?{valid:!1,reason:H6e(e)}:{valid:!0}:{valid:!1,reason:$6e(e)}}function DB(e,t,n,i){return e.explicit&&t.explicit&&le(function q6e(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${gn(n)} and ${gn(i)}). Using the union of the two domains.`}(n,i,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function CB(e){if(Qu(e)&&_e(e.field))return e.field;if(function Z4e(e){return!Z(e)&&"fields"in e&&!("data"in e)}(e)){let t;for(const n of e.fields)if(Qu(n)&&_e(n.field))if(t){if(t!==n.field)return le("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),t}else t=n.field;return le("Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect."),t}if(function e6e(e){return!Z(e)&&"fields"in e&&"data"in e}(e)){le("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");const t=e.fields[0];return _e(t)?t:void 0}}function Dx(e,t){return function vze(e){const t=Il(e.map(o=>Qu(o)?function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(o,["sort"]):o),vt),n=Il(e.map(o=>{if(Qu(o)){const a=o.sort;return void 0!==a&&!Iv(a)&&("op"in a&&"count"===a.op&&delete a.field,"ascending"===a.order&&delete a.order),a}}).filter(o=>void 0!==o),vt);if(0===t.length)return;if(1===t.length){const o=e[0];if(Qu(o)&&n.length>0){let a=n[0];return n.length>1?(le(mie),a=!0):Ce(a)&&"field"in a&&o.field===a.field&&(a=!a.order||{order:a.order}),Object.assign(Object.assign({},o),{sort:a})}return o}const i=Il(n.map(o=>Iv(o)||!("op"in o)||_e(o.op)&&o.op in q4e?o:(le(function K6e(e){return`Dropping sort property ${gn(e)} as unioned domains only support boolean or op "count", "min", and "max".`}(o)),!0)),vt);let r;1===i.length?r=i[0]:i.length>1&&(le(mie),r=!0);const s=Il(e.map(o=>Qu(o)?o.data:null),o=>o);return Object.assign(1===s.length&&null!==s[0]?{data:s[0],fields:t.map(a=>a.field)}:{fields:t},r?{sort:r}:{})}(e.component.scales[t].get("domains").map(r=>(Qu(r)&&(r.data=e.lookupDataSource(r.data)),r)))}function Eoe(e){return Xm(e)||xB(e)?e.children.reduce((t,n)=>t.concat(Eoe(n)),Soe(e)):Soe(e)}function Soe(e){return ie(e.component.scales).reduce((t,n)=>{const i=e.component.scales[n];if(i.merged)return t;const r=i.combine(),{name:s,type:o,selectionExtent:a,reverse:c}=r,f=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(r,["name","type","selectionExtent","domains","range","reverse"]),d=function wze(e,t,n,i){if(Ji(n)){if(Vf(e))return{step:{signal:`${t}_step`}}}else if(Ce(e)&&Qu(e))return Object.assign(Object.assign({},e),{data:i.lookupDataSource(e.data)});return e}(r.range,s,n,e),h=Dx(e,n),p=a?function c7e(e,t,n,i){const r=Hse(e,t.param,t);return{signal:to(n.get("type"))&&Z(i)&&i[0]>i[1]?`isValid(${r}) && reverse(${r})`:r}}(e,a,i,h):null;return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:s,type:o},h?{domain:h}:{}),p?{domainRaw:p}:{}),{range:d}),void 0!==c?{reverse:c}:{}),f)),t},[])}class xoe extends nc{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||Sh(this.get("domains"),t=>Z(t)&&2===t.length&&t[0]<=0&&t[1]>=0)}}const Dze=["range","scheme"];function Aoe(e,t){const n=e.fieldDef(t);if(null==n?void 0:n.bin){const{bin:i,field:r}=n,s=ws(t),o=e.getName(s);if(Ce(i)&&i.binned&&void 0!==i.step)return new Es(()=>{const a=e.scaleName(t),l=`(domain("${a}")[1] - domain("${a}")[0]) / ${i.step}`;return`${e.getSignalName(o)} / (${l})`});if(mn(i)){const a=hB(e,r,i);return new Es(()=>{const l=e.getSignalName(a),u=`(${l}.stop - ${l}.start) / ${l}.step`;return`${e.getSignalName(o)} / (${u})`})}}}function Eze(e,t){const n=t.specifiedScales[e],{size:i}=t,s=t.getScaleComponent(e).get("type");for(const f of Dze)if(void 0!==n[f]){const d=lj(s,f),h=Fie(e,f);if(d)if(h)le(h);else switch(f){case"range":{const p=n.range;if(Z(p)){if(Ji(e))return Yl(p.map(g=>{if("width"===g||"height"===g){const m=t.getName(g),_=t.getSignalName.bind(t);return Es.fromName(_,m)}return g}))}else if(Ce(p))return Yl({data:t.requestDataName(cn.Main),field:p.field,sort:{op:"min",field:t.vgField(e)}});return Yl(p)}case"scheme":return Yl(Sze(n[f]))}else le(pie(s,f,e))}const o=e===Pn||"xOffset"===e?"width":"height",a=i[o];if(ql(a))if(Ji(e))if(ji(s)){const f=Toe(a,t,e);if(f)return Yl({step:f})}else le(gie(o));else if(Nm(e)&&"band"===t.getScaleComponent(e===kf?"x":"y").get("type")){const p=Ooe(a,s);if(p)return Yl(p)}const{rangeMin:l,rangeMax:u}=n,c=function xze(e,t){const{size:n,config:i,mark:r,encoding:s}=t,o=t.getSignalName.bind(t),{type:a}=Ci(s[e]),u=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case Pn:case Li:{if(bt(["point","band"],u)){const p=Moe(e,n,i.view);if(ql(p))return{step:Toe(p,t,e)}}const d=ws(e),h=t.getName(d);return e===Li&&to(u)?[Es.fromName(o,h),0]:[0,Es.fromName(o,h)]}case kf:case Om:return function Aze(e,t,n){const i=e===kf?"x":"y",s=t.getScaleComponent(i).get("type"),o=t.scaleName(i);if("band"===s){const a=Moe(i,t.size,t.config.view);if(ql(a)){const l=Ooe(a,n);if(l)return l}return[0,{signal:`bandwidth('${o}')`}]}return Ane(`Cannot use ${e} scale if ${i} scale is not discrete.`)}(e,t,u);case Yu:{const h=Noe(r,t.component.scales[e].get("zero"),i),p=function Mze(e,t,n,i){const r={x:Aoe(n,"x"),y:Aoe(n,"y")};switch(e){case"bar":case"tick":{if(void 0!==i.scale.maxBandSize)return i.scale.maxBandSize;const s=Ioe(t,r,i.view);return Xt(s)?s-1:new Es(()=>`${s.signal} - 1`)}case"line":case"trail":case"rule":return i.scale.maxStrokeWidth;case"text":return i.scale.maxFontSize;case"point":case"square":case"circle":{if(i.scale.maxSize)return i.scale.maxSize;const s=Ioe(t,r,i.view);return Xt(s)?Math.pow(.95*s,2):new Es(()=>`pow(0.95 * ${s.signal}, 2)`)}}throw new Error(RS("size",e))}(r,n,t,i);return Rm(u)?function Oze(e,t,n){const i=()=>{const r=Zu(t),s=Zu(e),o=`(${r} - ${s}) / (${n} - 1)`;return`sequence(${s}, ${r} + ${o}, ${o})`};return Ne(t)?new Es(i):{signal:i()}}(h,p,function Tze(e,t,n,i){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return void 0!==n&&Z(n)?n.length+1:(le(function aVe(e){return`Domain for ${e} is required for threshold scale.`}(i)),3)}}(u,i,c,e)):[h,p]}case Na:return[0,2*Math.PI];case Ah:return[0,360];case Fl:return[0,new Es(()=>`min(${t.getSignalName("width")},${t.getSignalName("height")})/2`)];case Ff:return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case Pf:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case bs:return"symbol";case vs:case jl:case Bl:return"ordinal"===u?"nominal"===a?"category":"ordinal":void 0!==f?"diverging":"rect"===r||"geoshape"===r?"heatmap":"ramp";case Ku:case If:case Rf:return[i.scale.minOpacity,i.scale.maxOpacity]}}(e,t);return(void 0!==l||void 0!==u)&&lj(s,"rangeMin")&&Z(c)&&2===c.length?Yl([null!=l?l:c[0],null!=u?u:c[1]]):no(c)}function Sze(e){return function jVe(e){return!_e(e)&&!!e.name}(e)?Object.assign({scheme:e.name},Zs(e,["name"])):{scheme:e}}function Toe(e,t,n){var i,r,s,o,a;const{encoding:l}=t,u=t.getScaleComponent(n),c=Vne(n),f=l[c];if("offset"===jre({step:e,offsetIsDiscrete:We(f)&&Tie(f.type)})&&_re(l,c)){const h=t.getScaleComponent(c);let g=`domain('${t.scaleName(c)}').length`;"band"===h.get("type")&&(g=`bandspace(${g}, ${null!==(r=null!==(i=h.get("paddingInner"))&&void 0!==i?i:h.get("padding"))&&void 0!==r?r:0}, ${null!==(o=null!==(s=h.get("paddingOuter"))&&void 0!==s?s:h.get("padding"))&&void 0!==o?o:0})`);const m=null!==(a=u.get("paddingInner"))&&void 0!==a?a:u.get("padding");return{signal:`${e.step} * ${g} / (1-${i6e(m)})`}}return e.step}function Ooe(e,t){if("offset"===jre({step:e,offsetIsDiscrete:ji(t)}))return{step:e.step}}function Moe(e,t,n){const i=e===Pn?"width":"height";return t[i]||lx(n,i)}function Noe(e,t,n){if(t)return Ne(t)?{signal:`${t.signal} ? 0 : ${Noe(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(RS("size",e))}function Ioe(e,t,n){const i=ql(e.width)?e.width.step:ax(n,"width"),r=ql(e.height)?e.height.step:ax(n,"height");return t.x||t.y?new Es(()=>`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(", ")})`):Math.min(i,r)}function Roe(e,t){di(e)?function Nze(e,t){const n=e.component.scales,{config:i,encoding:r,markDef:s,specifiedScales:o}=e;for(const a of ie(n)){const l=o[a],u=n[a],c=e.getScaleComponent(a),f=Ci(r[a]),d=l[t],h=c.get("type"),p=c.get("padding"),g=c.get("paddingInner"),m=lj(h,t),_=Fie(a,t);if(void 0!==d&&(m?_&&le(_):le(pie(h,t,a))),m&&void 0===_)if(void 0!==d){const y=f.timeUnit,v=f.type;switch(t){case"domainMax":case"domainMin":kh(l[t])||"temporal"===v||y?u.set(t,{signal:ex(l[t],{type:v,timeUnit:y})},!0):u.set(t,l[t],!0);break;default:u.copyKeyFromObject(t,l)}}else{const y=t in Foe?Foe[t]({model:e,channel:a,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:g,domain:l.domain,domainMin:l.domainMin,domainMax:l.domainMax,markDef:s,config:i,hasNestedOffsetScale:Ej(r,a)}):i.scale[t];void 0!==y&&u.set(t,y,!1)}}}(e,t):Loe(e,t)}const Foe={bins:({model:e,fieldOrDatumDef:t})=>he(t)?function kze(e,t){const n=t.bin;if(mn(n)){const i=hB(e,t.field,n);return new Es(()=>e.getSignalName(i))}if(qr(n)&&Mh(n)&&void 0!==n.step)return{step:n.step}}(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>function Ize(e,t){if(bt([vs,jl,Bl],e)&&"nominal"!==t)return"hcl"}(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:i,domainMax:r,fieldOrDatumDef:s})=>function Rze(e,t,n,i,r,s){var o;if(!((null===(o=Wl(s))||void 0===o?void 0:o.bin)||Z(n)||null!=r||null!=i||bt(["time","utc"],e)))return!!Ji(t)||void 0}(e,t,n,i,r,s),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>function Fze(e,t,n,i,r,s){if(Ji(e)){if(Ia(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:o,orient:a}=r;if("bar"===o&&(!he(i)||!i.bin&&!i.timeUnit)&&("vertical"===a&&"x"===e||"horizontal"===a&&"y"===e))return s.continuousBandSize}if("point"===t)return n.pointPadding}}(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:i,config:r,hasNestedOffsetScale:s})=>function Pze(e,t,n,i,r,s=!1){if(void 0===e){if(Ji(t)){const{bandPaddingInner:o,barBandPaddingInner:a,rectBandPaddingInner:l,bandWithNestedOffsetPaddingInner:u}=r;return s?u:fi(o,"bar"===n?a:l)}if(Nm(t)&&"band"===i)return r.offsetBandPaddingInner}}(e,t,n.type,i,r.scale,s),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:i,config:r,hasNestedOffsetScale:s})=>function Lze(e,t,n,i,r,s=!1){if(void 0===e)if(Ji(t)){const{bandPaddingOuter:o,bandWithNestedOffsetPaddingOuter:a}=r;if(s)return a;if("band"===n)return fi(o,Ne(i)?{signal:`${i.signal}/2`}:i/2)}else if(Nm(t)){if("point"===n)return.5;if("band"===n)return r.offsetBandPaddingOuter}}(e,t,n,i,r.scale,s),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>function jze(e,t,n,i){return"x"===n&&void 0!==i.xReverse?to(e)&&"descending"===t?Ne(i.xReverse)?{signal:`!${i.xReverse.signal}`}:!i.xReverse:i.xReverse:!(!to(e)||"descending"!==t)||void 0}(t,he(e)?e.sort:void 0,n,i.scale),zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:i,scaleType:r})=>function Bze(e,t,n,i,r){if(n&&"unaggregated"!==n&&to(r)){if(Z(n)){const a=n[n.length-1];if(n[0]<=0&&a>=0)return!0}return!1}if("size"===e&&"quantitative"===t.type&&!Rm(r))return!0;if((!he(t)||!t.bin)&&bt([...$l,...B4e],e)){const{orient:o,type:a}=i;return!(bt(["bar","area","line","trail"],a)&&("horizontal"===o&&"y"===e||"vertical"===o&&"x"===e))}return!1}(e,t,n,i,r)};function Poe(e){di(e)?function Cze(e){const t=e.component.scales;for(const n of NS){const i=t[n];if(!i)continue;const r=Eze(n,e);i.setWithExplicit("range",r)}}(e):Loe(e,"range")}function Loe(e,t){const n=e.component.scales;for(const i of e.children)"range"===t?Poe(i):Roe(i,t);for(const i of ie(n)){let r;for(const s of e.children){const o=s.component.scales[i];o&&(r=Wf(r,o.getWithExplicit(t),t,"scale",fse((l,u)=>"range"===t&&l.step&&u.step?l.step-u.step:0)))}n[i].setWithExplicit(t,r)}}function $ze(e,t,n,i,r=!1){const s=function Vze(e,t,n,i){var r;switch(t.type){case"nominal":case"ordinal":if(Mm(e)||"discrete"===B3(e))return"shape"===e&&"ordinal"===t.type&&le(W3(e,"ordinal")),"ordinal";if(Ji(e)||Nm(e)){if(bt(["rect","bar","image","rule"],n.type)||i)return"band"}else if("arc"===n.type&&e in P3)return"band";return Fm(n[ws(e)])||bj(t)&&(null===(r=t.axis)||void 0===r?void 0:r.tickBand)?"band":"point";case"temporal":return Mm(e)?"time":"discrete"===B3(e)?(le(W3(e,"temporal")),"ordinal"):he(t)&&t.timeUnit&&Yr(t.timeUnit).utc?"utc":"time";case"quantitative":return Mm(e)?he(t)&&mn(t.bin)?"bin-ordinal":"linear":"discrete"===B3(e)?(le(W3(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(die(t.type))}(t,n,i,r),{type:o}=e;return jf(t)?void 0!==o?function zVe(e,t,n=!1){if(!jf(e))return!1;switch(e){case Pn:case Li:case kf:case Om:case Na:case Fl:return!(!Ia(t)&&"band"!==t)||"point"===t&&!n;case Yu:case Ff:case Ku:case If:case Rf:case Ah:return Ia(t)||Rm(t)||bt(["band","point","ordinal"],t);case vs:case jl:case Bl:return"band"!==t;case Pf:case bs:return"ordinal"===t||Rm(t)}}(t,o)?he(n)&&!function UVe(e,t){return bt([sj,oj],t)?void 0===e||ji(e):t===km?bt(["time","utc",void 0],e):t!==Rh||kie(e)||Rm(e)||void 0===e}(o,n.type)?(le(function G6e(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}(o,s)),s):o:(le(function z6e(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}(t,o,s)),s):s:null}function joe(e){e.component.scales=di(e)?function Uze(e){const{encoding:t,mark:n,markDef:i}=e,r={};for(const s of NS){const o=Ci(t[s]);if(o&&n===jie&&s===bs&&o.type===Im)continue;let a=o&&o.scale;if(!Nm(s)||Ej(t,Hne(s))){if(o&&null!==a&&!1!==a){null!=a||(a={});const u=$ze(a,s,o,i,Ej(t,s));r[s]=new xoe(e.scaleName(`${s}`,!0),{value:u,explicit:a.type===u})}}else a&&le(M6e(s))}return r}(e):function Gze(e){var t,n;const i=e.component.scales={},r={},s=e.component.resolve;for(const o of e.children){joe(o);for(const a of ie(o.component.scales))if(null!==(t=(n=s.scale)[a])&&void 0!==t||(n[a]=noe(a,e)),"shared"===s.scale[a]){const l=r[a],u=o.component.scales[a].getWithExplicit("type");l?IVe(l.value,u.value)?r[a]=Wf(l,u,"type","scale",zze):(s.scale[a]="independent",delete r[a]):r[a]=u}}for(const o of ie(r)){const a=e.scaleName(o,!0);i[o]=new xoe(a,r[o]);for(const u of e.children){const c=u.component.scales[o];c&&(u.renameScale(c.get("name"),a),c.merged=!0)}}return i}(e)}const zze=fse((e,t)=>Oie(e)-Oie(t));var EB=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};class SB{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return void 0!==this.nameMap[t]}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function di(e){return"unit"===(null==e?void 0:e.type)}function ja(e){return"facet"===(null==e?void 0:e.type)}function xB(e){return"concat"===(null==e?void 0:e.type)}function Xm(e){return"layer"===(null==e?void 0:e.type)}class AB{constructor(t,n,i,r,s,o,a){var l,u;this.type=n,this.parent=i,this.config=s,this.correctDataNames=c=>{var f,d,h;return(null===(f=c.from)||void 0===f?void 0:f.data)&&(c.from.data=this.lookupDataSource(c.from.data)),(null===(h=null===(d=c.from)||void 0===d?void 0:d.facet)||void 0===h?void 0:h.data)&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c},this.parent=i,this.config=s,this.view=Ds(a),this.name=null!==(l=t.name)&&void 0!==l?l:r,this.title=$f(t.title)?{text:t.title}:t.title?Ds(t.title):void 0,this.scaleNameMap=i?i.scaleNameMap:new SB,this.projectionNameMap=i?i.projectionNameMap:new SB,this.signalNameMap=i?i.signalNameMap:new SB,this.data=t.data,this.description=t.description,this.transforms=function qUe(e){return e.map(t=>zj(t)?{filter:xm(t.filter,OVe)}:t)}(null!==(u=t.transform)&&void 0!==u?u:[]),this.layout="layer"===n||"unit"===n?{}:function ZHe(e,t,n){var i,r;const s=n[t],o={},{spacing:a,columns:l}=s;void 0!==a&&(o.spacing=a),void 0!==l&&(GS(e)&&!Gv(e.facet)||Lj(e))&&(o.columns=l),ox(e)&&(o.columns=1);for(const u of QHe)if(void 0!==e[u])if("spacing"===u){const c=e[u];o[u]=Xt(c)?c:{row:null!==(i=c.row)&&void 0!==i?i:a,column:null!==(r=c.column)&&void 0!==r?r:a}}else o[u]=e[u];return o}(t,n,s),this.component={data:{sources:i?i.component.data.sources:[],outputNodes:i?i.component.data.outputNodes:{},outputNodeRefCounts:i?i.component.data.outputNodeRefCounts:{},isFaceted:GS(t)||(null==i?void 0:i.component.data.isFaceted)&&void 0===t.data},layoutSize:new nc,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?Je(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){!function Hze(e,{ignoreRange:t}={}){joe(e),Doe(e);for(const n of HVe)Roe(e,n);t||Poe(e)}(this)}parseProjection(){goe(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){coe(this)}assembleEncodeFromView(t){const i=EB(t,["style"]),r={};for(const s of ie(i)){const o=i[s];void 0!==o&&(r[s]=wn(o))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),t||(this.description&&(n.description=wn(this.description)),"unit"!==this.type&&"layer"!==this.type)?Zt(n)?void 0:n:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},null!=n?n:{})}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,i=EB(t,["spacing"]),{component:r,config:s}=this,o=function l9e(e,t){const n={};for(const i of jo){const r=e[i];if(null==r?void 0:r.facetFieldDef){const{titleAnchor:s,titleOrient:o}=vx(["titleAnchor","titleOrient"],r.facetFieldDef.header,t,i),a=yx(i,o),l=a9e(s,a);void 0!==l&&(n[a]=l)}}return Zt(n)?void 0:n}(r.layoutHeaders,s);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),i),o?{titleBand:o}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const i of jo)t[i].title&&n.push(n9e(this,i));for(const i of aB)n=n.concat(i9e(this,i));return n}assembleAxes(){return function z7e(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(r=>e1(r,"grid",t)),...i.map(r=>e1(r,"grid",t)),...n.map(r=>e1(r,"main",t)),...i.map(r=>e1(r,"main",t))].filter(r=>r)}(this.component.axes,this.config)}assembleLegends(){return doe(this)}assembleProjections(){return function k9e(e){return Xm(e)||xB(e)?function I9e(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),hoe(e))}(e):hoe(e)}(this)}assembleTitle(){var t,n,i;const r=null!==(t=this.title)&&void 0!==t?t:{},{encoding:s}=r,o=EB(r,["encoding"]),a=Object.assign(Object.assign(Object.assign({},Yne(this.config.title).nonMarkTitleProperties),o),s?{encode:{update:s}}:{});if(a.text)return bt(["unit","layer"],this.type)?bt(["middle",void 0],a.anchor)&&(null!==(n=a.frame)&&void 0!==n||(a.frame="group")):null!==(i=a.anchor)&&void 0!==i||(a.anchor="start"),Zt(a)?void 0:a}assembleGroup(t=[]){const n={};(t=t.concat(this.assembleSignals())).length>0&&(n.signals=t);const i=this.assembleLayout();i&&(n.layout=i),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||ja(this.parent)?Eoe(this):[];r.length>0&&(n.scales=r);const s=this.assembleAxes();s.length>0&&(n.axes=s);const o=this.assembleLegends();return o.length>0&&(n.legends=o),n}getName(t){return An((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(cn[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),i=this.component.data.outputNodeRefCounts;return i[n]=(i[n]||0)+1,n}getSizeSignalRef(t){if(ja(this.parent)){const i=MS(eoe(t)),r=this.component.scales[i];if(r&&!r.merged){const s=r.get("type"),o=r.get("range");if(ji(s)&&Vf(o)){const a=r.get("name"),u=CB(Dx(this,i));return u?{signal:Zse(a,r,pe({aggregate:"distinct",field:u},{expr:"datum"}))}:(le(z3(i)),null)}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){return n?this.getName(t):Bne(t)&&jf(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t))?this.scaleNameMap.get(this.getName(t)):void 0}projectionName(t){return t?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let i=this.component.selection[t];if(!i&&this.parent&&(i=this.parent.getSelectionComponent(t,n)),!i)throw new Error(function l6e(e){return`Cannot find a selection named "${e}".`}(n));return i}hasAxisOrientSignalRef(){var t,n;return(null===(t=this.component.axes.x)||void 0===t?void 0:t.some(i=>i.hasOrientSignalRef()))||(null===(n=this.component.axes.y)||void 0===n?void 0:n.some(i=>i.hasOrientSignalRef()))}}class Boe extends AB{vgField(t,n={}){const i=this.fieldDef(t);if(i)return pe(i,n)}reduceFieldDef(t,n){return function MHe(e,t,n,i){return e?ie(e).reduce((r,s)=>{const o=e[s];return Z(o)?o.reduce((a,l)=>t.call(i,a,l,s),r):t.call(i,r,o,s)},n):n}(this.getMapping(),(i,r,s)=>{const o=Wl(r);return o?t(i,o,s):i},n)}forEachFieldDef(t,n){xj(this.getMapping(),(i,r)=>{const s=Wl(i);s&&t(s,r)},n)}}class Cx extends en{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=Je(n);const o=null!==(i=this.transform.as)&&void 0!==i?i:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"value",null!==(s=o[1])&&void 0!==s?s:"density"]}clone(){return new Cx(null,Je(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${vt(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,i=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["density"]);return Object.assign({type:"kde",field:n},i)}}class r1 extends en{constructor(t,n){super(t),this.filter=n}clone(){return new r1(null,Object.assign({},this.filter))}static make(t,n){const{config:i,mark:r,markDef:s}=n;if("filter"!==Gt("invalid",s,i))return null;const a=n.reduceFieldDef((l,u,c)=>{const f=jf(c)&&n.getScaleComponent(c);return f&&to(f.get("type"))&&"count"!==u.aggregate&&!Uf(r)&&(l[u.field]=u),l},{});return ie(a).length?new r1(t,a):null}dependentFields(){return new Set(ie(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${vt(this.filter)}`}assemble(){const t=ie(this.filter).reduce((n,i)=>{const r=this.filter[i],s=pe(r,{expr:"datum"});return null!==r&&("temporal"===r.type?n.push(`(isDate(${s}) || (isValid(${s}) && isFinite(+${s})))`):"quantitative"===r.type&&(n.push(`isValid(${s})`),n.push(`isFinite(+${s})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class Ex extends en{constructor(t,n){super(t),this.transform=n,this.transform=Je(n);const{flatten:i,as:r=[]}=this.transform;this.transform.as=i.map((s,o)=>{var a;return null!==(a=r[o])&&void 0!==a?a:s})}clone(){return new Ex(this.parent,Je(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${vt(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class Sx extends en{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=Je(n);const o=null!==(i=this.transform.as)&&void 0!==i?i:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"key",null!==(s=o[1])&&void 0!==s?s:"value"]}clone(){return new Sx(null,Je(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${vt(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class Qm extends en{constructor(t,n,i,r){super(t),this.fields=n,this.geojson=i,this.signal=r}clone(){return new Qm(null,Je(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let i=0;for(const r of[[Ll,Pl],[Lo,ka]]){const s=r.map(o=>{const a=Ci(n.encoding[o]);return he(a)?a.field:zl(a)?{expr:`${a.datum}`}:Fa(a)?{expr:`${a.value}`}:void 0});(s[0]||s[1])&&(t=new Qm(t,s,null,n.getName("geojson_"+i++)))}if(n.channelHasField(bs)){const r=n.typedFieldDef(bs);r.type===Im&&(t=new Qm(t,null,r.field,n.getName("geojson_"+i++)))}return t}dependentFields(){var t;const n=(null!==(t=this.fields)&&void 0!==t?t:[]).filter(_e);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${vt(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})]}}class s1 extends en{constructor(t,n,i,r){super(t),this.projection=n,this.fields=i,this.as=r}clone(){return new s1(null,this.projection,Je(this.fields),Je(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const i of[[Ll,Pl],[Lo,ka]]){const r=i.map(o=>{const a=Ci(n.encoding[o]);return he(a)?a.field:zl(a)?{expr:`${a.datum}`}:Fa(a)?{expr:`${a.value}`}:void 0}),s=i[0]===Lo?"2":"";(r[0]||r[1])&&(t=new s1(t,n.projectionName(),r,[n.getName(`x${s}`),n.getName(`y${s}`)]))}return t}dependentFields(){return new Set(this.fields.filter(_e))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${vt(this.fields)} ${vt(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class Uh extends en{constructor(t,n){super(t),this.transform=n}clone(){return new Uh(null,Je(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:i,step:r}=t;return{signal:`sequence(${[n,i,...r?[r]:[]].join(",")})`}}static makeFromTransform(t,n){return new Uh(t,n)}static makeFromEncoding(t,n){const i=n.encoding,r=i.x,s=i.y;if(he(r)&&he(s)){const o=r.impute?r:s.impute?s:void 0;if(void 0===o)return;const a=r.impute?s:s.impute?r:void 0,{method:l,value:u,frame:c,keyvals:f}=o.impute,d=vre(n.mark,i);return new Uh(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:a.field},l?{method:l}:{}),void 0!==u?{value:u}:{}),c?{frame:c}:{}),void 0!==f?{keyvals:f}:{}),d.length?{groupby:d}:{}))}return null}hash(){return`Impute ${vt(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:i,method:r,groupby:s,value:o,frame:a=[null,null]}=this.transform,l=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},i?{keyvals:OUe(i)?this.processSequence(i):i}:{}),{method:"value"}),s?{groupby:s}:{}),{value:r&&"value"!==r?null:o});return r&&"value"!==r?[l,Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[r],fields:[t],frame:a,ignorePeers:!1},s?{groupby:s}:{}),{type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t}]:[l]}}class xx extends en{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=Je(n);const o=null!==(i=this.transform.as)&&void 0!==i?i:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:n.on,null!==(s=o[1])&&void 0!==s?s:n.loess]}clone(){return new xx(null,Je(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${vt(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:i}=t,r=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["loess","on"]);return Object.assign({type:"loess",x:i,y:n},r)}}class o1 extends en{constructor(t,n,i){super(t),this.transform=n,this.secondary=i}clone(){return new o1(null,Je(this.transform),this.secondary)}static make(t,n,i,r){const s=n.component.data.sources,{from:o}=i;let a=null;if(function MUe(e){return"data"in e}(o)){let l=Uoe(o.data,s);l||(l=new $h(o.data),s.push(l));const u=n.getName(`lookup_${r}`);a=new Kr(l,u,cn.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[u]=a}else if(function NUe(e){return"param"in e}(o)){const l=o.param;let u;i=Object.assign({as:l},i);try{u=n.getSelectionComponent(An(l),l)}catch(c){throw new Error(function f6e(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}(l))}if(a=u.materialized,!a)throw new Error(function d6e(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}(l))}return new o1(t,i,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?ve(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${vt({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:ve(this.transform.as)}:{});else{let n=this.transform.as;_e(n)||(le('If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.'),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}class Ax extends en{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=Je(n);const o=null!==(i=this.transform.as)&&void 0!==i?i:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"prob",null!==(s=o[1])&&void 0!==s?s:"value"]}clone(){return new Ax(null,Je(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${vt(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,i=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["quantile"]);return Object.assign({type:"quantile",field:n},i)}}class Tx extends en{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=Je(n);const o=null!==(i=this.transform.as)&&void 0!==i?i:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:n.on,null!==(s=o[1])&&void 0!==s?s:n.regression]}clone(){return new Tx(null,Je(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${vt(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:i}=t,r=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["regression","on"]);return Object.assign({type:"regression",x:i,y:n},r)}}class Ox extends en{constructor(t,n){super(t),this.transform=n}clone(){return new Ox(null,Je(this.transform))}addDimensions(t){var n;this.transform.groupby=Il((null!==(n=this.transform.groupby)&&void 0!==n?n:[]).concat(t),i=>i)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}hash(){return`PivotTransform ${vt(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:i,limit:r,op:s}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},void 0!==r?{limit:r}:{}),void 0!==s?{op:s}:{}),void 0!==i?{groupby:i}:{})}}class Mx extends en{constructor(t,n){super(t),this.transform=n}clone(){return new Mx(null,Je(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${vt(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function $oe(e){let t=0;return function n(i,r){var s;if(i instanceof $h&&!i.isGenerator&&!$m(i.data)&&(e.push(r),r={name:null,source:r.name,transform:[]}),i instanceof wr&&(i.parent instanceof $h&&!r.source?(r.format=Object.assign(Object.assign({},null!==(s=r.format)&&void 0!==s?s:{}),{parse:i.assembleFormatParse()}),r.transform.push(...i.assembleTransforms(!0))):r.transform.push(...i.assembleTransforms())),i instanceof Km)return r.name||(r.name="data_"+t++),!r.source||r.transform.length>0?(e.push(r),i.data=r.name):i.data=r.source,void e.push(...i.assemble());switch((i instanceof t1||i instanceof n1||i instanceof r1||i instanceof Gm||i instanceof Wm||i instanceof s1||i instanceof Pa||i instanceof o1||i instanceof Jm||i instanceof Hh||i instanceof Sx||i instanceof Ex||i instanceof Cx||i instanceof xx||i instanceof Ax||i instanceof Tx||i instanceof Xf||i instanceof Mx||i instanceof Ox)&&r.transform.push(i.assemble()),(i instanceof Jl||i instanceof Kl||i instanceof Uh||i instanceof ic||i instanceof Qm)&&r.transform.push(...i.assemble()),i instanceof Kr&&(r.source&&0===r.transform.length?i.setSource(r.source):i.parent instanceof Kr?i.setSource(r.name):(r.name||(r.name="data_"+t++),i.setSource(r.name),1===i.numChildren()&&(e.push(r),r={name:null,source:r.name,transform:[]}))),i.numChildren()){case 0:i instanceof Kr&&(!r.source||r.transform.length>0)&&e.push(r);break;case 1:n(i.children[0],r);break;default:{r.name||(r.name="data_"+t++);let o=r.name;!r.source||r.transform.length>0?e.push(r):o=r.source;for(const a of i.children)n(a,{name:null,source:o,transform:[]});break}}}}function Qze(e){return"top"===e||"left"===e||Ne(e)?"header":"footer"}function eGe(e,t){var n;const{facet:i,config:r,child:s,component:o}=e;if(e.channelHasField(t)){const a=i[t],l=Ym("title",null,r,t);let u=Pm(a,r,{allowDisabling:!0,includeDefault:void 0===l||!!l});s.component.layoutHeaders[t].title&&(u=Z(u)?u.join(", "):u,u+=` / ${s.component.layoutHeaders[t].title}`,s.component.layoutHeaders[t].title=null);const c=Ym("labelOrient",a.header,r,t),f=null!==a.header&&fi(null===(n=a.header)||void 0===n?void 0:n.labels,r.header.labels,!0),d=bt(["bottom","right"],c)?"footer":"header";o.layoutHeaders[t]={title:null!==a.header?u:null,facetFieldDef:a,[d]:"facet"===t?[]:[Voe(e,t,f)]}}}function Voe(e,t,n){const i="row"===t?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function Hoe(e,t){var n;const{child:i}=e;if(i.component.axes[t]){const{layoutHeaders:r,resolve:s}=e.component;if(s.axis[t]=fB(s,t),"shared"===s.axis[t]){const o="x"===t?"column":"row",a=r[o];for(const l of i.component.axes[t]){const u=Qze(l.get("orient"));null!==(n=a[u])&&void 0!==n||(a[u]=[Voe(e,o,!1)]);const c=e1(l,"main",e.config,{header:!0});c&&a[u][0].axes.push(c),l.mainExtracted=!0}}}}function TB(e){for(const t of e.children)t.parseLayoutSize()}function Nx(e,t){var n;const i=eoe(t),r=MS(i),s=e.component.resolve,o=e.component.layoutSize;let a;for(const l of e.children){const u=l.component.layoutSize.getWithExplicit(i),c=null!==(n=s.scale[r])&&void 0!==n?n:noe(r,e);if("independent"===c&&"step"===u.value){a=void 0;break}if(a){if("independent"===c&&a.value!==u.value){a=void 0;break}a=Wf(a,u,i,"")}else a=u}if(a){for(const l of e.children)e.renameSignal(l.getName(i),e.getName(t)),l.component.layoutSize.set(i,"merged",!1);o.setWithExplicit(t,a)}else o.setWithExplicit(t,{explicit:!1,value:void 0})}function rGe(e,t){const i=e.config,r=e.getScaleComponent("width"===t?"x":"y");if(r){const s=r.get("type"),o=r.get("range");if(ji(s)){const a=lx(i.view,t);return Vf(o)||ql(a)?"step":a}return Bj(i.view,t)}if(e.hasProjection||"arc"===e.mark)return Bj(i.view,t);{const s=lx(i.view,t);return ql(s)?s.step:s}}function OB(e,t,n){return pe(t,Object.assign({suffix:`by_${pe(e)}`},null!=n?n:{}))}class a1 extends Boe{constructor(t,n,i,r){super(t,"facet",n,i,r,t.resolve),this.child=RB(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!Gv(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=ie(t),i={};for(const r of n){if(![zu,Gu].includes(r)){le(RS(r,"facet"));break}const s=t[r];if(void 0===s.field){le(G3(s,r));break}i[r]=this.initFacetFieldDef(s,r)}return i}initFacetFieldDef(t,n){const i=Cj(t,n);return i.header?i.header=Ds(i.header):null===i.header&&(i.header=null),i}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=kx(this),this.child.parseData()}parseLayoutSize(){TB(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function Zze(e){for(const t of jo)eGe(e,t);Hoe(e,"x"),Hoe(e,"y")}(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,i;const r={};for(const s of jo)for(const o of lB){const a=this.component.layoutHeaders[s],l=a[o],{facetFieldDef:u}=a;if(u){const c=Ym("titleOrient",u.header,this.config,s);if(["right","bottom"].includes(c)){const f=yx(s,c);null!==(t=r.titleAnchor)&&void 0!==t||(r.titleAnchor={}),r.titleAnchor[f]="end"}}if(null==l?void 0:l[0]){const c="row"===s?"height":"width",f="header"===o?"headerBand":"footerBand";"facet"!==s&&!this.child.component.layoutSize.get(c)&&(null!==(n=r[f])&&void 0!==n||(r[f]={}),r[f][s]=.5),a.title&&(null!==(i=r.offset)&&void 0!==i||(r.offset={}),r.offset["row"===s?"rowTitle":"columnTitle"]=10)}}return r}assembleDefaultLayout(){const{column:t,row:n}=this.facet,i=t?this.columnDistinctSignal():n?1:void 0;let r="all";return(!n&&"independent"===this.component.resolve.scale.x||!t&&"independent"===this.component.resolve.scale.y)&&(r="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),i?{columns:i}:{}),{bounds:"full",align:r})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof a1))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof a1?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:pe(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],i=[];if(this.child instanceof a1){if(this.child.channelHasField("column")){const r=pe(this.child.facet.column);t.push(r),n.push("distinct"),i.push(`distinct_${r}`)}}else for(const r of $l){const s=this.child.component.scales[r];if(s&&!s.merged){const o=s.get("type"),a=s.get("range");if(ji(o)&&Vf(a)){const u=CB(Dx(this.child,r));u?(t.push(u),n.push("distinct"),i.push(`distinct_${u}`)):le(z3(r))}}}return{fields:t,ops:n,as:i}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:i,column:r}=this.facet,{fields:s,ops:o,as:a}=this.getCardinalityAggregateForChild(),l=[];for(const c of jo){const f=this.facet[c];if(f){l.push(pe(f));const{bin:d,sort:h}=f;if(mn(d)&&l.push(pe(f,{binSuffix:"end"})),Ul(h)){const{field:p,op:g=zS}=h,m=OB(f,h);i&&r?(s.push(m),o.push("max"),a.push(m)):(s.push(p),o.push(g),a.push(m))}else if(Z(h)){const p=qm(f,c);s.push(p),o.push("max"),a.push(p)}}}const u=!!i&&!!r;return Object.assign({name:t,data:n,groupby:l},u||s.length>0?{aggregate:Object.assign(Object.assign({},u?{cross:u}:{}),s.length?{fields:s,ops:o,as:a}:{})}:{})}facetSortFields(t){const{facet:n}=this,i=n[t];return i?Ul(i.sort)?[OB(i,i.sort,{expr:"datum"})]:Z(i.sort)?[qm(i,t,{expr:"datum"})]:[pe(i,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,i=n[t];if(i){const{sort:r}=i;return[(Ul(r)?r.order:!Z(r)&&r)||"ascending"]}return[]}assembleLabelTitle(){var t;const{facet:n,config:i}=this;if(n.facet)return uB(n.facet,"facet",i);const r={row:["top","bottom"],column:["left","right"]};for(const s of aB)if(n[s]){const o=Ym("labelOrient",null===(t=n[s])||void 0===t?void 0:t.header,i,s);if(r[s].includes(o))return uB(n[s],s,i)}}assembleMarks(){const{child:t}=this,i=function Jze(e){const t=[],n=$oe(t);for(const i of e.children)n(i,{source:e.name,name:null,transform:[]});return t}(this.component.data.facetRoot),r=t.assembleGroupEncodeEntry(!1),s=this.assembleLabelTitle()||t.assembleTitle(),o=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},s?{title:s}:{}),o?{style:o}:{}),{from:{facet:this.assembleFacet()},sort:{field:jo.map(l=>this.facetSortFields(l)).flat(),order:jo.map(l=>this.facetSortOrder(l)).flat()}}),i.length>0?{data:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup(o7e(this,[])))]}getMapping(){return this.facet}}function Uoe(e,t){var n,i,r,s;for(const o of t){const a=o.data;if(e.name&&o.hasName()&&e.name!==o.dataName)continue;const l=null===(n=e.format)||void 0===n?void 0:n.mesh,u=null===(i=a.format)||void 0===i?void 0:i.feature;if(l&&u)continue;const c=null===(r=e.format)||void 0===r?void 0:r.feature;if((c||u)&&c!==u)continue;const f=null===(s=a.format)||void 0===s?void 0:s.mesh;if(!l&&!f||l===f)if(Jv(e)&&Jv(a)){if(kl(e.values,a.values))return o}else if($m(e)&&$m(a)){if(e.url===a.url)return o}else if(dse(e)&&e.name===o.dataName)return o}return null}function kx(e){var t,n,i,r,s,o,a,l,u,c;let f=function oGe(e,t){if(e.data||!e.parent){if(null===e.data){const i=new $h({values:[]});return t.push(i),i}const n=Uoe(e.data,t);if(n)return qf(e.data)||(n.data.format=Tne({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const i=new $h(e.data);return t.push(i),i}}return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}(e,e.component.data.sources);const{outputNodes:d,outputNodeRefCounts:h}=e.component.data,p=e.data,m=p&&(qf(p)||$m(p)||Jv(p))||!e.parent?new i7e:e.parent.component.data.ancestorParse.clone();qf(p)?(hse(p)?f=new n1(f,p.sequence):qj(p)&&(f=new t1(f,p.graticule)),m.parseNothing=!0):null===(null===(t=null==p?void 0:p.format)||void 0===t?void 0:t.parse)&&(m.parseNothing=!0),f=null!==(n=wr.makeExplicit(f,e,m))&&void 0!==n?n:f,f=new Xf(f);const _=e.parent&&Xm(e.parent);(di(e)||ja(e))&&_&&(f=null!==(i=Jl.makeFromEncoding(f,e))&&void 0!==i?i:f),e.transforms.length>0&&(f=function aGe(e,t,n){var i,r;let s=0;for(const o of t.transforms){let a,l;if(VUe(o))l=e=new Wm(e,o),a="derived";else if(zj(o)){const u=W9e(o);l=e=null!==(i=wr.makeWithAncestors(e,{},u,n))&&void 0!==i?i:e,e=new Gm(e,t,o.filter)}else if(ise(o))l=e=Jl.makeFromTransform(e,o,t),a="number";else if(UUe(o))a="date",void 0===n.getWithExplicit(o.field).value&&(e=new wr(e,{[o.field]:a}),n.set(o.field,a,!1)),l=e=Kl.makeFromTransform(e,o);else if(zUe(o))l=e=Pa.makeFromTransform(e,o),a="number",nB(t)&&(e=new Xf(e));else if(nse(o))l=e=o1.make(e,t,o,s++),a="derived";else if(jUe(o))l=e=new Jm(e,o),a="number";else if(BUe(o))l=e=new Hh(e,o),a="number";else if(GUe(o))l=e=ic.makeFromTransform(e,o),a="derived";else if(WUe(o))l=e=new Sx(e,o),a="derived";else if($Ue(o))l=e=new Ex(e,o),a="derived";else if(kUe(o))l=e=new Ox(e,o),a="derived";else if(LUe(o))e=new Mx(e,o);else if(HUe(o))l=e=Uh.makeFromTransform(e,o),a="derived";else if(IUe(o))l=e=new Cx(e,o),a="derived";else if(RUe(o))l=e=new Ax(e,o),a="derived";else if(FUe(o))l=e=new Tx(e,o),a="derived";else{if(!PUe(o)){le(v6e(o));continue}l=e=new xx(e,o),a="derived"}if(l&&void 0!==a)for(const u of null!==(r=l.producedFields())&&void 0!==r?r:[])n.set(u,a,!1)}return e}(f,e,m));const y=function Y9e(e){const t={};if(di(e)&&e.component.selection)for(const n of ie(e.component.selection)){const i=e.component.selection[n];for(const r of i.project.items)!r.channel&&Tm(r.field)>1&&(t[r.field]="flatten")}return t}(e),v=function q9e(e){const t={};function n(i){jm(i)?t[i.field]="date":"quantitative"===i.type&&function K4e(e){return _e(e)&&bt(["min","max"],e)}(i.aggregate)?t[i.field]="number":Tm(i.field)>1?i.field in t||(t[i.field]="flatten"):Lh(i)&&Ul(i.sort)&&Tm(i.sort.field)>1&&(i.sort.field in t||(t[i.sort.field]="flatten"))}if((di(e)||ja(e))&&e.forEachFieldDef((i,r)=>{if(Bo(i))n(i);else{const s=Oh(r),o=e.fieldDef(s);n(Object.assign(Object.assign({},i),{type:o.type}))}}),di(e)){const{mark:i,markDef:r,encoding:s}=e;if(Uf(i)&&!e.encoding.order){const a=s["horizontal"===r.orient?"y":"x"];he(a)&&"quantitative"===a.type&&!(a.field in t)&&(t[a.field]="number")}}return t}(e);f=null!==(r=wr.makeWithAncestors(f,{},Object.assign(Object.assign({},y),v),m))&&void 0!==r?r:f,di(e)&&(f=Qm.parseAll(f,e),f=s1.parseAll(f,e)),(di(e)||ja(e))&&(_||(f=null!==(s=Jl.makeFromEncoding(f,e))&&void 0!==s?s:f),f=null!==(o=Kl.makeFromEncoding(f,e))&&void 0!==o?o:f,f=Wm.parseAllForSortIndex(f,e));const b=e.getDataName(cn.Raw),D=new Kr(f,b,cn.Raw,h);if(d[b]=D,f=D,di(e)){const O=Pa.makeFromEncoding(f,e);O&&(f=O,nB(e)&&(f=new Xf(f))),f=null!==(a=Uh.makeFromEncoding(f,e))&&void 0!==a?a:f,f=null!==(l=ic.makeFromEncoding(f,e))&&void 0!==l?l:f}di(e)&&(f=null!==(u=r1.make(f,e))&&void 0!==u?u:f);const C=e.getDataName(cn.Main),w=new Kr(f,C,cn.Main,h);d[C]=w,f=w,di(e)&&function H7e(e,t){var n;for(const[i,r]of Nf(null!==(n=e.component.selection)&&void 0!==n?n:{})){const s=e.getName(`lookup_${i}`);e.component.data.outputNodes[s]=r.materialized=new Kr(new Gm(t,e,{param:i}),s,cn.Lookup,e.component.data.outputNodeRefCounts)}}(e,w);let E=null;if(ja(e)){const O=e.getName("facet");f=null!==(c=function sGe(e,t){const{row:n,column:i}=t;if(n&&i){let r=null;for(const s of[n,i])if(Ul(s.sort)){const{field:o,op:a=zS}=s.sort;e=r=new Hh(e,{joinaggregate:[{op:a,field:o,as:OB(s,s.sort,{forAs:!0})}],groupby:[pe(s)]})}return r}return null}(f,e.facet))&&void 0!==c?c:f,E=new Km(f,e,O,w.getSource()),d[O]=E}return Object.assign(Object.assign({},e.component.data),{outputNodes:d,outputNodeRefCounts:h,raw:D,main:w,facetRoot:E,ancestorParse:m})}class lGe extends AB{constructor(t,n,i,r){var s,o,a,l;super(t,"concat",n,i,r,t.resolve),("shared"===(null===(o=null===(s=t.resolve)||void 0===s?void 0:s.axis)||void 0===o?void 0:o.x)||"shared"===(null===(l=null===(a=t.resolve)||void 0===a?void 0:a.axis)||void 0===l?void 0:l.y))&&le("Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415)."),this.children=this.getChildren(t).map((u,c)=>RB(u,this,this.getName(`concat_${c}`),void 0,r))}parseData(){this.component.data=kx(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of ie(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return ox(t)?t.vconcat:jj(t)?t.hconcat:t.concat}parseLayoutSize(){!function nGe(e){TB(e);const n=void 0===e.layout.columns?"height":"childHeight";Nx(e,1===e.layout.columns?"width":"childWidth"),Nx(e,n)}(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=cB(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),i=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),i?{style:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup())})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},null!=t?{columns:t}:{}),{bounds:"full",align:"each"})}}const cGe=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},hre),{labelExpr:1,encode:1}),zoe=ie(cGe);class MB extends nc{constructor(t={},n={},i=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=i}clone(){return new MB(Je(this.explicit),Je(this.implicit),this.mainExtracted)}hasAxisPart(t){return"axis"===t||("grid"===t||"title"===t?!!this.get(t):!function uGe(e){return!1===e||null===e}(this.get(t)))}hasOrientSignalRef(){return Ne(this.explicit.orient)}}const hGe={bottom:"top",top:"bottom",left:"right",right:"left"};function gGe(e,t){if(!e)return t.map(n=>n.clone());{if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const r=e[i],s=t[i];if(!!r!=!!s)return;if(r&&s){const o=r.getWithExplicit("orient"),a=s.getWithExplicit("orient");if(o.explicit&&a.explicit&&o.value!==a.value)return;e[i]=mGe(r,s)}}}return e}function mGe(e,t){for(const n of zoe){const i=Wf(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(r,s)=>{switch(n){case"title":return iie(r,s);case"gridScale":return{explicit:r.explicit,value:fi(r.value,s.value)}}return cx(r,s,n,"axis")});e.setWithExplicit(n,i)}return e}function _Ge(e,t,n,i,r){if("disable"===t)return void 0!==n;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(Ne(n.labelAngle)?n.labelAngle:Pv(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===Yse(i,r))return!0}return e===n[t]}const yGe=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function vGe(e,t){var n,i,r;let s=t.axis(e);const o=new MB,a=Ci(t.encoding[e]),{mark:l,config:u}=t,c=(null==s?void 0:s.orient)||(null===(n=u["x"===e?"axisX":"axisY"])||void 0===n?void 0:n.orient)||(null===(i=u.axis)||void 0===i?void 0:i.orient)||function Q7e(e){return"x"===e?"bottom":"left"}(e),f=t.getScaleComponent(e).get("type"),d=function G7e(e,t,n,i){const r="band"===t?["axisDiscrete","axisBand"]:"point"===t?["axisDiscrete","axisPoint"]:kie(t)?["axisQuantitative"]:"time"===t||"utc"===t?["axisTemporal"]:[],s="x"===e?"axisX":"axisY",o=Ne(n)?"axisOrient":`axis${Fv(n)}`,a=[...r,...r.map(u=>s+u.substr(4))],l=["axis",o,s];return{vlOnlyAxisConfig:zse(a,i,e,n),vgAxisConfig:zse(l,i,e,n),axisConfigStyle:W7e([...l,...a],i)}}(e,f,c,t.config),h=void 0!==s?!s:sB("disable",u.style,null==s?void 0:s.style,d).configValue;if(o.set("disable",h,void 0!==s),h)return o;s=s||{};const p=function K7e(e,t,n,i,r){const s=null==t?void 0:t.labelAngle;if(void 0!==s)return Ne(s)?s:Pv(s);{const{configValue:o}=sB("labelAngle",i,null==t?void 0:t.style,r);return void 0!==o?Pv(o):n!==Pn||!bt([oj,sj],e.type)||he(e)&&e.timeUnit?void 0:270}}(a,s,e,u.style,d),g={fieldOrDatumDef:a,axis:s,channel:e,model:t,scaleType:f,orient:c,labelAngle:p,mark:l,config:u};for(const y of zoe){const v=y in Gse?Gse[y](g):gre(y)?s[y]:void 0,b=void 0!==v,D=_Ge(v,y,s,t,e);if(b&&D)o.set(y,v,D);else{const{configValue:C,configFrom:w}=gre(y)&&"values"!==y?sB(y,u.style,s.style,d):{},E=void 0!==C;b&&!E?o.set(y,v,D):("vgAxisConfig"!==w||yGe.has(y)&&E||Yv(C)||Ne(C))&&o.set(y,C,!1)}}const m=null!==(r=s.encoding)&&void 0!==r?r:{},_=dre.reduce((y,v)=>{var b;if(!o.hasAxisPart(v))return y;const D=toe(null!==(b=m[v])&&void 0!==b?b:{},t),C="labels"===v?function fGe(e,t,n){var i;const{encoding:r,config:s}=e,o=null!==(i=Ci(r[t]))&&void 0!==i?i:Ci(r[Ju(t)]),a=e.axis(t)||{},{format:l,formatType:u}=a;return Ph(u)?Object.assign({text:mj({fieldOrDatumDef:o,field:"datum.value",format:l,formatType:u,config:s})},n):n}(t,e,D):D;return void 0!==C&&!Zt(C)&&(y[v]={update:C}),y},{});return Zt(_)||o.set("encode",_,!!s.encoding||void 0!==s.labelAngle),o}const xGe={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},$o(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),br("x",e,{defaultPos:"mid"})),br("y",e,{defaultPos:"mid"})),Kf(e,"radius")),Kf(e,"theta"))},AGe={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},$o(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),dx("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===e.markDef.orient})),dx("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===e.markDef.orient})),eB(e))},TGe={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},$o(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Kf(e,"x")),Kf(e,"y"))},OGe={vgMark:"shape",encodeEntry:e=>Object.assign({},$o(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&he(n)&&n.type===Im?{field:pe(n,{expr:"datum"})}:{})]}},MGe={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},$o(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),Kf(e,"x")),Kf(e,"y")),Qj(e,"url"))},NGe={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},$o(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),br("x",e,{defaultPos:"mid"})),br("y",e,{defaultPos:"mid"})),Bi("size",e,{vgChannel:"strokeWidth"})),eB(e))},kGe={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},$o(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),br("x",e,{defaultPos:"mid"})),br("y",e,{defaultPos:"mid"})),Bi("size",e)),eB(e))};function NB(e,t){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},$o(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),br("x",e,{defaultPos:"mid"})),br("y",e,{defaultPos:"mid"})),Bi("size",e)),Bi("angle",e)),function IGe(e,t,n){return n?{shape:{value:n}}:Bi("shape",e)}(e,0,t))}const RGe={vgMark:"symbol",encodeEntry:e=>NB(e)},FGe={vgMark:"symbol",encodeEntry:e=>NB(e,"circle")},PGe={vgMark:"symbol",encodeEntry:e=>NB(e,"square")},LGe={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},$o(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Kf(e,"x")),Kf(e,"y"))},jGe={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},$o(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),dx("x",e,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n})),dx("y",e,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n})),Bi("size",e,{vgChannel:"strokeWidth"})):{}}},BGe={vgMark:"text",encodeEntry:e=>{const{config:t}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},$o(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),br("x",e,{defaultPos:"mid"})),br("y",e,{defaultPos:"mid"})),Qj(e)),Bi("size",e,{vgChannel:"fontSize"})),Bi("angle",e)),xse("align",function $Ge(e,t,n){if(void 0===Gt("align",e,n))return"center"}(e.markDef,0,t))),xse("baseline",function VGe(e,t,n){if(void 0===Gt("baseline",e,n))return"middle"}(e.markDef,0,t))),br("radius",e,{defaultPos:null})),br("theta",e,{defaultPos:null}))}},HGe={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r="horizontal"===i?"width":"height",s="horizontal"===i?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},$o(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),br("x",e,{defaultPos:"mid",vgChannel:"xc"})),br("y",e,{defaultPos:"mid",vgChannel:"yc"})),Bi("size",e,{defaultValue:UGe(e),vgChannel:r})),{[s]:wn(Gt("thickness",n,t))})}};function UGe(e){var t;const{config:n,markDef:i}=e,{orient:r}=i,s="horizontal"===r?"width":"height",o=e.getScaleComponent("horizontal"===r?"x":"y"),a=null!==(t=Gt("size",i,n,{vgChannel:s}))&&void 0!==t?t:n.tick.bandSize;if(void 0!==a)return a;{const l=o?o.get("range"):void 0;return l&&Vf(l)&&Xt(l.step)?3*l.step/4:3*ax(n.view,s)/4}}const Ix={arc:xGe,area:AGe,bar:TGe,circle:FGe,geoshape:OGe,image:MGe,line:NGe,point:RGe,rect:LGe,rule:jGe,square:PGe,text:BGe,tick:HGe,trail:kGe};const Goe="faceted_path_",Woe="stack_group_";function kB(e,t={fromPrefix:""}){const{mark:n,markDef:i,encoding:r,config:s}=e,o=fi(i.clip,function YGe(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return!(!(null==t?void 0:t.get("selectionExtent"))&&!(null==n?void 0:n.get("selectionExtent")))||void 0}(e),function KGe(e){const t=e.component.projection;return!(!t||t.isFit)||void 0}(e)),a=Qne(i),l=r.key,u=function qGe(e){var t;const{encoding:n,stack:i,mark:r,markDef:s,config:o}=e,a=n.order;if(!(!Z(a)&&Fa(a)&&x3(a.value)||!a&&x3(Gt("order",s,o)))){if((Z(a)||he(a))&&!i)return eie(a,{expr:"datum"});if(Uf(r)){const l="horizontal"===s.orient?"y":"x",u=n[l];if(he(u)){const c=u.sort;return Z(c)?{field:pe(u,{prefix:l,suffix:"sort_index",expr:"datum"})}:Ul(c)?{field:pe({aggregate:Sj(e.encoding)?c.op:void 0,field:c.field},{expr:"datum"})}:Qie(c)?{field:pe(e.fieldDef(c.encoding),{expr:"datum"}),order:c.order}:null===c?void 0:{field:pe(u,{binSuffix:(null===(t=e.stack)||void 0===t?void 0:t.impute)?"mid":void 0,expr:"datum"})}}return}}}(e),c=function JGe(e){if(!e.component.selection)return null;const t=ie(e.component.selection).length;let n=t,i=e.parent;for(;i&&0===n;)n=ie(i.component.selection).length,i=i.parent;return n?{interactive:t>0||!!e.encoding.tooltip}:null}(e),f=Gt("aria",i,s),d=Ix[n].postEncodingTransform?Ix[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:Ix[n].vgMark},o?{clip:!0}:{}),a?{style:a}:{}),l?{key:l.field}:{}),u?{sort:u}:{}),c||{}),!1===f?{aria:f}:{}),{from:{data:t.fromPrefix+e.requestDataName(cn.Main)},encode:{update:Ix[n].encodeEntry(e)}}),d?{transform:d}:{})]}class qoe extends Boe{constructor(t,n,i,r={},s){var o;super(t,"unit",n,i,s,void 0,Bre(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const a=Ra(t.mark)?Object.assign({},t.mark):{type:t.mark},l=a.type;void 0===a.filled&&(a.filled=function EGe(e,t,{graticule:n}){if(n)return!1;const i=Nh("filled",e,t),r=e.type;return fi(i,r!==$S&&r!==BS&&r!==VS)}(a,s,{graticule:t.data&&qj(t.data)}));const u=this.encoding=function THe(e,t,n,i){const r={};for(const s of ie(e))Bne(s)||le(N6e(s));for(let s of L4e){if(!e[s])continue;const o=e[s];if(Nm(s)){const a=Hne(s),l=r[a];if(he(l)){if(MVe(l.type)&&he(o)){le(C6e(a));continue}}else s=a,le(E6e(a))}if("angle"===s&&"arc"===t&&!e.theta&&(le("Arc marks uses theta channel rather than angle, replacing angle with theta."),s=Na),AHe(e,s,t)){if(s===Yu&&"line"===t){const a=Wl(e[s]);if(null==a?void 0:a.aggregate){le("Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.");continue}}if(s===vs&&(n?"fill"in e:"stroke"in e))le(hie("encoding",{fill:"fill"in e,stroke:"stroke"in e}));else if(s===$v||s===Bv&&!Z(o)&&!Fa(o)||s===Th&&Z(o))o&&(r[s]=ve(o).reduce((a,l)=>(he(l)?a.push(Cj(l,s)):le(G3(l,s)),a),[]));else{if(s===Th&&null===o)r[s]=null;else if(!(he(o)||zl(o)||Fa(o)||WS(o)||Ne(o))){le(G3(o,s));continue}r[s]=ure(o,s,i)}}else le(RS(s,t))}return r}(t.encoding||{},l,a.filled,s);this.markDef=function wGe(e,t,n){const i=Ds(e),r=Gt("orient",i,n);if(i.orient=function SGe(e,t,n){switch(e){case $S:case cj:case fj:case Lie:case WVe:case GVe:return}const{x:i,y:r,x2:s,y2:o}=t;switch(e){case jS:if(he(i)&&(qr(i.bin)||he(r)&&r.aggregate&&!i.aggregate))return"vertical";if(he(r)&&(qr(r.bin)||he(i)&&i.aggregate&&!r.aggregate))return"horizontal";if(o||s){if(n)return n;if(!s&&(he(i)&&i.type===Rh&&!mn(i.bin)||KS(i)))return"horizontal";if(!o&&(he(r)&&r.type===Rh&&!mn(r.bin)||KS(r)))return"vertical"}case VS:if(s&&(!he(i)||!qr(i.bin))&&o&&(!he(r)||!qr(r.bin)))return;case LS:if(o)return he(r)&&qr(r.bin)?"horizontal":"vertical";if(s)return he(i)&&qr(i.bin)?"vertical":"horizontal";if(e===VS){if(i&&!r)return"vertical";if(r&&!i)return"horizontal"}case BS:case uj:{const a=Gl(i),l=Gl(r);if(n)return n;if(a&&!l)return"tick"!==e?"horizontal":"vertical";if(!a&&l)return"tick"!==e?"vertical":"horizontal";if(a&&l){const u=i,c=r,f=u.type===km,d=c.type===km;return f&&!d?"tick"!==e?"vertical":"horizontal":!f&&d?"tick"!==e?"horizontal":"vertical":!u.aggregate&&c.aggregate?"tick"!==e?"vertical":"horizontal":u.aggregate&&!c.aggregate&&"tick"!==e?"horizontal":"vertical"}return}}return"vertical"}(i.type,t,r),void 0!==r&&r!==i.orient&&le(function L6e(e,t){return`Specified orient "${e}" overridden with "${t}".`}(i.orient,r)),"bar"===i.type&&i.orient){const a=Gt("cornerRadiusEnd",i,n);if(void 0!==a){const l="horizontal"===i.orient&&t.x2||"vertical"===i.orient&&t.y2?["cornerRadius"]:ZVe[i.orient];for(const u of l)i[u]=a;void 0!==i.cornerRadiusEnd&&delete i.cornerRadiusEnd}}return void 0===Gt("opacity",i,n)&&(i.opacity=function CGe(e,t){if(bt([$S,uj,cj,fj],e)&&!Sj(t))return.7}(i.type,t)),void 0===Gt("cursor",i,n)&&(i.cursor=function DGe(e,t,n){return t.href||e.href||Gt("href",e,n)?"pointer":e.cursor}(i,t,n)),i}(a,u,s),this.size=function bGe({encoding:e,size:t}){for(const n of $l){const i=ws(n);ql(t[i])&&Gl(e[n])&&(delete t[i],le(gie(i)))}return t}({encoding:u,size:Bre(t)?Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):r}),this.stack=qre(l,u),this.specifiedScales=this.initScales(l,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegends(u),this.specifiedProjection=t.projection,this.selection=(null!==(o=t.params)&&void 0!==o?o:[]).filter(c=>Pj(c))}get hasProjection(){const{encoding:t}=this,n=this.mark===jie,i=t&&k4e.some(r=>We(t[r]));return n||i}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return NS.reduce((i,r)=>{var s;const o=Ci(n[r]);return o&&(i[r]=this.initScale(null!==(s=o.scale)&&void 0!==s?s:{})),i},{})}initScale(t){const{domain:n,range:i}=t,r=Ds(t);return Z(n)&&(r.domain=n.map(eo)),Z(i)&&(r.range=i.map(eo)),r}initAxes(t){return $l.reduce((n,i)=>{const r=t[i];if(We(r)||i===Pn&&We(t.x2)||i===Li&&We(t.y2)){const s=We(r)?r.axis:void 0;n[i]=s&&this.initAxis(Object.assign({},s))}return n},{})}initAxis(t){const n=ie(t),i={};for(const r of n){const s=t[r];i[r]=Yv(s)?Kne(s):eo(s)}return i}initLegends(t){return $4e.reduce((n,i)=>{const r=Ci(t[i]);if(r&&function H4e(e){switch(e){case vs:case jl:case Bl:case Yu:case bs:case Ku:case Ff:case Pf:return!0;case If:case Rf:case Ah:return!1}}(i)){const s=r.legend;n[i]=s&&Ds(s)}return n},{})}parseData(){this.component.data=kx(this)}parseLayoutSize(){!function iGe(e){const{size:t,component:n}=e;for(const i of $l){const r=ws(i);if(t[r]){const s=t[r];n.layoutSize.set(r,ql(s)?"step":s,!0)}else{const s=rGe(e,r);n.layoutSize.set(r,s,!1)}}}(this)}parseSelections(){this.component.selection=function V7e(e,t){var n;const i={},r=e.config.selection;if(!t||!t.length)return i;for(const s of t){const o=An(s.name),a=s.select,l=_e(a)?a:a.type,u=Ce(a)?Je(a):{type:l},c=r[l];for(const d in c)"fields"===d||"encodings"===d||("mark"===d&&(u[d]=Object.assign(Object.assign({},c[d]),u[d])),(void 0===u[d]||!0===u[d])&&(u[d]=null!==(n=c[d])&&void 0!==n?n:u[d]));const f=i[o]=Object.assign(Object.assign({},u),{name:o,type:l,init:s.value,bind:s.bind,events:_e(u.on)?Of(u.on,"scope"):ve(Je(u.on))});for(const d of gx)d.defined(f)&&d.parse&&d.parse(e,f,s)}return i}(this,this.selection)}parseMarkGroup(){this.component.mark=function zGe(e){if(bt([BS,LS,qVe],e.mark)){const t=vre(e.mark,e.encoding);if(t.length>0)return function GGe(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:Goe+e.requestDataName(cn.Main),data:e.requestDataName(cn.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:kB(e,{fromPrefix:Goe})}]}(e,t)}else if(e.mark===jS){const t=V3.some(n=>Gt(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return function WGe(e){var t;const[n]=kB(e,{fromPrefix:Woe}),i=e.scaleName(e.stack.fieldChannel),r=(c={})=>e.vgField(e.stack.fieldChannel,c),s=(c,f)=>`${c}(${[r({prefix:"min",suffix:"start",expr:f}),r({prefix:"max",suffix:"start",expr:f}),r({prefix:"min",suffix:"end",expr:f}),r({prefix:"max",suffix:"end",expr:f})].map(h=>`scale('${i}',${h})`).join(",")})`;let o,a;"x"===e.stack.fieldChannel?(o=Object.assign(Object.assign({},Am(n.encode.update,["y","yc","y2","height",...V3])),{x:{signal:s("min","datum")},x2:{signal:s("max","datum")},clip:{value:!0}}),a={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},n.encode.update=Object.assign(Object.assign({},Zs(n.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(o=Object.assign(Object.assign({},Am(n.encode.update,["x","xc","x2","width"])),{y:{signal:s("min","datum")},y2:{signal:s("max","datum")},clip:{value:!0}}),a={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},n.encode.update=Object.assign(Object.assign({},Zs(n.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const c of V3){const f=Nh(c,e.markDef,e.config);n.encode.update[c]?(o[c]=n.encode.update[c],delete n.encode.update[c]):f&&(o[c]=wn(f)),f&&(n.encode.update[c]={value:0})}const l=[];if((null===(t=e.stack.groupbyChannels)||void 0===t?void 0:t.length)>0)for(const c of e.stack.groupbyChannels){const f=e.fieldDef(c),d=pe(f);d&&l.push(d),((null==f?void 0:f.bin)||(null==f?void 0:f.timeUnit))&&l.push(pe(f,{binSuffix:"end"}))}return o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((c,f)=>{if(n.encode.update[f])return Object.assign(Object.assign({},c),{[f]:n.encode.update[f]});{const d=Nh(f,e.markDef,e.config);return void 0!==d?Object.assign(Object.assign({},c),{[f]:wn(d)}):c}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(cn.Main),name:Woe+e.requestDataName(cn.Main),groupby:l,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:a},marks:[n]}]}]}(e)}return kB(e)}(this)}parseAxesAndHeaders(){this.component.axes=function dGe(e){return $l.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[vGe(n,e)]),t),{})}(this)}assembleSelectionTopLevelSignals(t){return function a7e(e,t){var n;let i=!1;for(const r of yr(null!==(n=e.component.selection)&&void 0!==n?n:{})){const s=r.name,o=fe(s+Bh);if(0===t.filter(l=>l.name===s).length){const u="point"===r.type?", true, true)":")";t.push({name:r.name,update:`${Lse}(${o}, ${fe("global"===r.resolve?"union":r.resolve)}${u}`})}i=!0;for(const l of gx)l.defined(r)&&l.topLevelSignals&&(t=l.topLevelSignals(e,r,t))}return i&&0===t.filter(s=>"unit"===s.name).length&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),Yj(t)}(this,t)}assembleSignals(){return[...Use(this),...s7e(this,[])]}assembleSelectionData(t){return function l7e(e,t){var n;const i=[...t];for(const r of yr(null!==(n=e.component.selection)&&void 0!==n?n:{})){const s={name:r.name+Bh};if(r.init){const a=r.project.items.map(l=>r7e(l,["signals"]));s.values=r.init.map(l=>({unit:zm(e,{escape:!1}),fields:a,values:Vm(l,!1)}))}i.filter(a=>a.name===r.name+Bh).length||i.push(s)}return i}(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return cB(this)}assembleMarks(){var t;let n=null!==(t=this.component.mark)&&void 0!==t?t:[];return(!this.parent||!Xm(this.parent))&&(n=gse(this,n)),n.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};return void 0!==t?t:this.encoding.x||this.encoding.y?"cell":void 0}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return jh(this.encoding,t)}fieldDef(t){return Wl(this.encoding[t])}typedFieldDef(t){const n=this.fieldDef(t);return Bo(n)?n:null}}class IB extends AB{constructor(t,n,i,r,s){super(t,"layer",n,i,s,t.resolve,t.view);const o=Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((a,l)=>{if(ux(a))return new IB(a,this,this.getName(`layer_${l}`),o,s);if(ec(a))return new qoe(a,this,this.getName(`layer_${l}`),o,s);throw new Error(U3(a))})}parseData(){this.component.data=kx(this);for(const t of this.children)t.parseData()}parseLayoutSize(){!function tGe(e){TB(e),Nx(e,"width"),Nx(e,"height")}(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of ie(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){!function pGe(e){var t;const{axes:n,resolve:i}=e.component,r={top:0,bottom:0,right:0,left:0};for(const s of e.children){s.parseAxesAndHeaders();for(const o of ie(s.component.axes))i.axis[o]=fB(e.component.resolve,o),"shared"===i.axis[o]&&(n[o]=gGe(n[o],s.component.axes[o]),n[o]||(i.axis[o]="independent",delete n[o]))}for(const s of $l){for(const o of e.children)if(o.component.axes[s]){if("independent"===i.axis[s]){n[s]=(null!==(t=n[s])&&void 0!==t?t:[]).concat(o.component.axes[s]);for(const a of o.component.axes[s]){const{value:l,explicit:u}=a.getWithExplicit("orient");if(!Ne(l)){if(r[l]>0&&!u){const c=hGe[l];r[l]>r[c]&&a.set("orient",c,!1)}r[l]++}}}delete o.component.axes[s]}if("independent"===i.axis[s]&&n[s]&&n[s].length>1)for(const o of n[s])o.get("grid")&&!o.explicit.grid&&(o.implicit.grid=!1)}}(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),Use(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),cB(this))}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const i of this.children)for(const r of ve(i.assembleGroupStyle()))t.add(r);const n=Array.from(t);return n.length>1?n:1===n.length?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return function u7e(e,t){for(const n of e.children)di(n)&&(t=gse(n,t));return t}(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),doe(this))}}function RB(e,t,n,i,r){if(GS(e))return new a1(e,t,n,r);if(ux(e))return new IB(e,t,n,i,r);if(ec(e))return new qoe(e,t,n,i,r);if(function XHe(e){return ox(e)||jj(e)||Lj(e)}(e))return new lGe(e,t,n,r);throw new Error(U3(e))}function QGe(e,t={}){t.logger&&function cVe(e){Vl=e}(t.logger),t.fieldTitle&&lre(t.fieldTitle);try{const n=Gre(mg(t.config,e.config)),i=lse(e,n),r=RB(i,null,"",void 0,n);return r.parse(),function cze(e,t){vB(e.sources);let n=0,i=0;for(let r=0;r<5&&woe(e,t,!0);r++)n++;e.sources.map(_B);for(let r=0;r<5&&woe(e,t,!1);r++)i++;vB(e.sources),5===Math.max(n,i)&&le("Maximum optimization runs(5) reached.")}(r.component.data,r),{spec:eWe(r,ZGe(e,i.autosize,n,r),e.datasets,e.usermeta),normalized:i}}finally{t.logger&&function bie(){return Vl=vie,Vl}(),t.fieldTitle&&function bHe(){lre(ore)}()}}function ZGe(e,t,n,i){const r=i.component.layoutSize.get("width"),s=i.component.layoutSize.get("height");if(void 0===t?(t={type:"pad"},i.hasAxisOrientSignalRef()&&(t.resize=!0)):_e(t)&&(t={type:t}),r&&s&&function e7e(e){return"fit"===e||"fit-x"===e||"fit-y"===e}(t.type))if("step"===r&&"step"===s)le(oie()),t.type="pad";else if("step"===r||"step"===s){const o="step"===r?"width":"height";le(oie(MS(o))),t.type=function t7e(e){return e?`fit-${MS(e)}`:"fit"}("width"===o?"height":"width")}return Object.assign(Object.assign(Object.assign({},1===ie(t).length&&t.type?"pad"===t.type?{}:{autosize:t.type}:{autosize:t}),cse(n,!1)),cse(e,!0))}function eWe(e,t,n={},i){const r=e.config?function fUe(e){e=Je(e);for(const t of uUe)delete e[t];if(e.axis)for(const t in e.axis)Yv(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of GHe)delete e.legend[t];if(e.mark){for(const t of Vie)delete e.mark[t];e.mark.tooltip&&Ce(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(Lre(e.params)),delete e.params);for(const t of lUe){for(const i of Vie)delete e[t][i];const n=cUe[t];if(n)for(const i of n)delete e[t][i];hUe(e,t)}for(const t of function zHe(){return ie(kj)}())delete e[t];!function dUe(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=Yne(e.title);Zt(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),Zt(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),Zt(i)?delete e.title:e.title=i}(e);for(const t in e)Ce(e[t])&&Zt(e[t])&&delete e[t];return Zt(e)?void 0:e}(e.config):void 0,s=[].concat(e.assembleSelectionData([]),function Xze(e,t){var n,i;const r=[],s=$oe(r);let o=0;for(const l of e.sources){l.hasName()||(l.dataName="source_"+o++);const u=l.assemble();s(l,u)}for(const l of r)0===l.transform.length&&delete l.transform;let a=0;for(const[l,u]of r.entries())0===(null!==(n=u.transform)&&void 0!==n?n:[]).length&&!u.source&&r.splice(a++,0,r.splice(l,1)[0]);for(const l of r)for(const u of null!==(i=l.transform)&&void 0!==i?i:[])"lookup"===u.type&&(u.from=e.outputNodes[u.from].getSource());for(const l of r)l.name in t&&(l.values=t[l.name]);return r}(e.component.data,n)),o=e.assembleProjections(),a=e.assembleTitle(),l=e.assembleGroupStyle(),u=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter(h=>"width"!==h.name&&"height"!==h.name||void 0===h.value||(t[h.name]=+h.value,!1));const{params:f}=t,d=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["params"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),d),a?{title:a}:{}),l?{style:l}:{}),u?{encode:{update:u}}:{}),{data:s}),o.length>0?{projections:o}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...Lre(f)])),r?{config:r}:{}),i?{usermeta:i}:{})}const tWe="5.2.0",Yoe=function nWe(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}},Zm="#fff",wWe={background:"#333",title:{color:Zm,subtitleColor:Zm},style:{"guide-label":{fill:Zm},"guide-title":{fill:Zm}},axis:{domainColor:Zm,gridColor:"#888",tickColor:Zm}},zh="#4572a7",DWe={background:"#fff",arc:{fill:zh},area:{fill:zh},line:{stroke:zh,strokeWidth:2},path:{stroke:zh},rect:{fill:zh},shape:{stroke:zh},symbol:{fill:zh,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Gh="#30a2da",FB="#cbcbcb",SWe={arc:{fill:Gh},area:{fill:Gh},axis:{domainColor:FB,grid:!0,gridColor:FB,gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:FB,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:"#f0f0f0",group:{fill:"#f0f0f0"},legend:{labelColor:"#333",labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:"#333",titleFontSize:14,titlePadding:10},line:{stroke:Gh,strokeWidth:2},path:{stroke:Gh,strokeWidth:.5},rect:{fill:Gh},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Gh},bar:{binSpacing:2,fill:Gh,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Wh="#000",xWe={group:{fill:"#e5e5e5"},arc:{fill:Wh},area:{fill:Wh},line:{stroke:Wh},path:{stroke:Wh},rect:{fill:Wh},shape:{stroke:Wh},symbol:{fill:Wh,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},Xoe="Benton Gothic, sans-serif",qh="#82c6df",PB="Benton Gothic Bold, sans-serif",l1={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},MWe={background:"#ffffff",title:{anchor:"start",color:"#000000",font:PB,fontSize:22,fontWeight:"normal"},arc:{fill:qh},area:{fill:qh},line:{stroke:qh,strokeWidth:2},path:{stroke:qh},rect:{fill:qh},shape:{stroke:qh},symbol:{fill:qh,size:30},axis:{labelFont:Xoe,labelFontSize:11.5,labelFontWeight:"normal",titleFont:PB,titleFontSize:13,titleFontWeight:"normal"},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:Xoe,labelFontSize:11.5,symbolType:"square",titleFont:PB,titleFontSize:13,titleFontWeight:"normal"},range:{category:l1["category-6"],diverging:l1["fireandice-6"],heatmap:l1["fire-7"],ordinal:l1["fire-7"],ramp:l1["fire-7"]}},Yh="#ab5787",Rx="#979797",NWe={background:"#f9f9f9",arc:{fill:Yh},area:{fill:Yh},line:{stroke:Yh},path:{stroke:Yh},rect:{fill:Yh},shape:{stroke:Yh},symbol:{fill:Yh,size:30},axis:{domainColor:Rx,domainWidth:.5,gridWidth:.2,labelColor:Rx,tickColor:Rx,tickWidth:.2,titleColor:Rx},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Kh="#3e5c69",kWe={background:"#fff",arc:{fill:Kh},area:{fill:Kh},line:{stroke:Kh},path:{stroke:Kh},rect:{fill:Kh},shape:{stroke:Kh},symbol:{fill:Kh},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Vo="#1696d2",Fx="Lato",LB="Lato",u1={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},LWe={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:Fx},axisX:{domain:!0,domainColor:"#000000",domainWidth:1,grid:!1,labelFontSize:12,labelFont:LB,labelAngle:0,tickColor:"#000000",tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Fx},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:LB,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Fx,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:LB,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Fx,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:u1["six-groups-cat-1"],diverging:u1["diverging-colors"],heatmap:u1["diverging-colors"],ordinal:u1["six-groups-seq"],ramp:u1["shades-blue"]},area:{fill:Vo},rect:{fill:Vo},line:{color:Vo,stroke:Vo,strokeWidth:5},trail:{color:Vo,stroke:Vo,strokeWidth:0,size:1},path:{stroke:Vo,strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:Vo,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Vo,stroke:null}},arc:{fill:Vo},shape:{stroke:Vo},symbol:{fill:Vo,size:30}},Jh="#3366CC",Px="Arial, sans-serif",jWe={arc:{fill:Jh},area:{fill:Jh},path:{stroke:Jh},rect:{fill:Jh},shape:{stroke:Jh},symbol:{stroke:Jh},circle:{fill:Jh},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:Px,fontSize:12},"guide-title":{font:Px,fontSize:12},"group-title":{font:Px,fontSize:12}},title:{font:Px,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:"#ccc",tickColor:"#ccc",domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},BWe="2.10.0";function iae(e,t){return JSON.stringify(e,function lqe(e){const t=[];return function(n,i){if("object"!=typeof i||null===i)return i;const r=t.indexOf(this)+1;return t.length=r,t.length>e?"[Object]":t.indexOf(i)>=0?"[Circular]":(t.push(i),i)}}(t))}const rae="vg-tooltip-element",cqe={offsetX:10,offsetY:10,id:rae,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function fqe(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2,formatTooltip:function aqe(e,t,n){if(Z(e))return`[${e.map(i=>t(_e(i)?i:iae(i,n))).join(", ")}]`;if(Ce(e)){let i="";const r=e,{title:s,image:o}=r,a=function oqe(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(r,["title","image"]);s&&(i+=`<h2>${t(s)}</h2>`),o&&(i+=`<img src="${t(o)}">`);const l=Object.keys(a);if(l.length>0){i+="<table>";for(const u of l){let c=a[u];void 0!==c&&(Ce(c)&&(c=iae(c,n)),i+=`<tr><td class="key">${t(u)}:</td><td class="value">${t(c)}</td></tr>`)}i+="</table>"}return i||"{}"}return t(e)}};class sae{constructor(t){this.options=Object.assign(Object.assign({},cqe),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const i=document.createElement("style");i.setAttribute("id",this.options.styleId),i.innerHTML=function dqe(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return"#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black;\n}\n#vg-tooltip-element.visible {\n  visibility: visible;\n}\n#vg-tooltip-element h2 {\n  margin-top: 0;\n  margin-bottom: 10px;\n  font-size: 13px;\n}\n#vg-tooltip-element img {\n  max-width: 200px;\n  max-height: 200px;\n}\n#vg-tooltip-element table {\n  border-spacing: 0;\n}\n#vg-tooltip-element table tr {\n  border: none;\n}\n#vg-tooltip-element table tr td {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-top: 2px;\n  padding-bottom: 2px;\n}\n#vg-tooltip-element table tr td.key {\n  color: #808080;\n  max-width: 150px;\n  text-align: right;\n  padding-right: 4px;\n}\n#vg-tooltip-element table tr td.value {\n  display: block;\n  max-width: 300px;\n  max-height: 7em;\n  text-align: left;\n}\n#vg-tooltip-element.dark-theme {\n  background-color: rgba(32, 32, 32, 0.9);\n  border: 1px solid #f5f5f5;\n  color: white;\n}\n#vg-tooltip-element.dark-theme td.key {\n  color: #bfbfbf;\n}\n".toString().replace(rae,e)}(n);const r=document.head;r.childNodes.length>0?r.insertBefore(i,r.childNodes[0]):r.appendChild(i)}}tooltipHandler(t,n,i,r){var s;if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),(null!==(s=document.fullscreenElement)&&void 0!==s?s:document.body).appendChild(this.el)),null==r||""===r)return void this.el.classList.remove("visible",`${this.options.theme}-theme`);this.el.innerHTML=this.options.formatTooltip(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:o,y:a}=function hqe(e,t,n,i){let r=e.clientX+n;r+t.width>window.innerWidth&&(r=+e.clientX-n-t.width);let s=e.clientY+i;return s+t.height>window.innerHeight&&(s=+e.clientY-i-t.height),{x:r,y:s}}(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${a}px; left: ${o}px`)}}function pqe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oae(e,t,n,i,r,s,o){try{var a=e[s](o),l=a.value}catch(u){return void n(u)}a.done?t(l):Promise.resolve(l).then(i,r)}function Lx(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var s=e.apply(t,n);function o(l){oae(s,i,r,o,a,"next",l)}function a(l){oae(s,i,r,o,a,"throw",l)}o(void 0)})}}var Xl,aae=Object.prototype,Xh=aae.hasOwnProperty,jB="function"==typeof Symbol?Symbol:{},jx=jB.iterator||"@@iterator",gqe=jB.asyncIterator||"@@asyncIterator",Bx=jB.toStringTag||"@@toStringTag";function lae(e,t,n,i){var s=Object.create((t&&t.prototype instanceof $B?t:$B).prototype),o=new zB(i||[]);return s._invoke=function bqe(e,t,n){var i=uae;return function(s,o){if(i===cae)throw new Error("Generator is already running");if(i===$x){if("throw"===s)throw o;return pae()}for(n.method=s,n.arg=o;;){var a=n.delegate;if(a){var l=hae(a,n);if(l){if(l===Ba)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===uae)throw i=$x,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=cae;var u=BB(e,t,n);if("normal"===u.type){if(i=n.done?$x:mqe,u.arg===Ba)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=$x,n.method="throw",n.arg=u.arg)}}}(e,n,o),s}function BB(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(i){return{type:"throw",arg:i}}}var uae="suspendedStart",mqe="suspendedYield",cae="executing",$x="completed",Ba={};function $B(){}function Vx(){}function e0(){}var VB={};VB[jx]=function(){return this};var HB=Object.getPrototypeOf,Hx=HB&&HB(HB(GB([])));Hx&&Hx!==aae&&Xh.call(Hx,jx)&&(VB=Hx);var t0=e0.prototype=$B.prototype=Object.create(VB);function fae(e){["next","throw","return"].forEach(function(t){e[t]=function(n){return this._invoke(t,n)}})}function dae(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===Vx||"GeneratorFunction"===(t.displayName||t.name))}function Ux(e,t){function n(s,o,a,l){var u=BB(e[s],e,o);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==typeof f&&Xh.call(f,"__await")?t.resolve(f.__await).then(function(d){n("next",d,a,l)},function(d){n("throw",d,a,l)}):t.resolve(f).then(function(d){c.value=d,a(c)},function(d){return n("throw",d,a,l)})}l(u.arg)}var i;this._invoke=function r(s,o){function a(){return new t(function(l,u){n(s,o,l,u)})}return i=i?i.then(a,a):a()}}function hae(e,t){var n=e.iterator[t.method];if(n===Xl){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=Xl,hae(e,t),"throw"===t.method))return Ba;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return Ba}var i=BB(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,Ba;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=Xl),t.delegate=null,Ba):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,Ba)}function wqe(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function UB(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function zB(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(wqe,this),this.reset(!0)}function GB(e){if(e){var t=e[jx];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(Xh.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=Xl,r.done=!0,r};return i.next=i}}return{next:pae}}function pae(){return{value:Xl,done:!0}}Vx.prototype=t0.constructor=e0,e0.constructor=Vx,e0[Bx]=Vx.displayName="GeneratorFunction",fae(Ux.prototype),Ux.prototype[gqe]=function(){return this},fae(t0),t0[Bx]="Generator",t0[jx]=function(){return this},t0.toString=function(){return"[object Generator]"},zB.prototype={constructor:zB,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=Xl,this.done=!1,this.delegate=null,this.method="next",this.arg=Xl,this.tryEntries.forEach(UB),!t)for(var n in this)"t"===n.charAt(0)&&Xh.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=Xl)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(u,c){return o.type="throw",o.arg=t,n.next=u,c&&(n.method="next",n.arg=Xl),!!c}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var a=Xh.call(s,"catchLoc"),l=Xh.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,n){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&Xh.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=n&&n<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=n,s?(this.method="next",this.next=s.finallyLoc,Ba):this.complete(o)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),Ba},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),UB(i),Ba}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc===t){var r=i.completion;if("throw"===r.type){var s=r.arg;UB(i)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:GB(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=Xl),Ba}};var Ql={wrap:lae,isGeneratorFunction:dae,AsyncIterator:Ux,mark:function _qe(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,e0):(e.__proto__=e0,Bx in e||(e[Bx]="GeneratorFunction")),e.prototype=Object.create(t0),e},awrap:function yqe(e){return{__await:e}},async:function vqe(e,t,n,i,r){void 0===r&&(r=Promise);var s=new Ux(lae(e,t,n,i),r);return dae(t)?s:s.next().then(function(o){return o.done?o.value:s.next()})},keys:function Dqe(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function i(){for(;t.length;){var r=t.pop();if(r in e)return i.value=r,i.done=!1,i}return i.done=!0,i}},values:GB},Cqe=Rt;function Rt(e){var t=this;if(t instanceof Rt||(t=new Rt),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach(function(r){t.push(r)});else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);return t}function Eqe(e,t,n){var i=t===e.head?new Qh(n,null,t,e):new Qh(n,t,t.next,e);return null===i.next&&(e.tail=i),null===i.prev&&(e.head=i),e.length++,i}function Sqe(e,t){e.tail=new Qh(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function xqe(e,t){e.head=new Qh(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Qh(e,t,n,i){if(!(this instanceof Qh))return new Qh(e,t,n,i);this.list=i,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}Rt.Node=Qh,Rt.create=Rt,Rt.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},Rt.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},Rt.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},Rt.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)Sqe(this,arguments[e]);return this.length},Rt.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)xqe(this,arguments[e]);return this.length},Rt.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},Rt.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},Rt.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,i=0;null!==n;i++)e.call(t,n.value,i,this),n=n.next},Rt.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,i=this.length-1;null!==n;i--)e.call(t,n.value,i,this),n=n.prev},Rt.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},Rt.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},Rt.prototype.map=function(e,t){t=t||this;for(var n=new Rt,i=this.head;null!==i;)n.push(e.call(t,i.value,this)),i=i.next;return n},Rt.prototype.mapReverse=function(e,t){t=t||this;for(var n=new Rt,i=this.tail;null!==i;)n.push(e.call(t,i.value,this)),i=i.prev;return n},Rt.prototype.reduce=function(e,t){var n,i=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");i=this.head.next,n=this.head.value}for(var r=0;null!==i;r++)n=e(n,i.value,r),i=i.next;return n},Rt.prototype.reduceReverse=function(e,t){var n,i=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");i=this.tail.prev,n=this.tail.value}for(var r=this.length-1;null!==i;r--)n=e(n,i.value,r),i=i.prev;return n},Rt.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},Rt.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},Rt.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new Rt;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,r=this.head;null!==r&&i<e;i++)r=r.next;for(;null!==r&&i<t;i++,r=r.next)n.push(r.value);return n},Rt.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new Rt;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,r=this.tail;null!==r&&i>t;i--)r=r.prev;for(;null!==r&&i>e;i--,r=r.prev)n.push(r.value);return n},Rt.prototype.splice=function(e,t){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,i=this.head;null!==i&&n<e;n++)i=i.next;var r=[];for(n=0;i&&n<t;n++)r.push(i.value),i=this.removeNode(i);for(null===i&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev),n=0;n<(arguments.length<=2?0:arguments.length-2);n++)i=Eqe(this,i,n+2<2||arguments.length<=n+2?void 0:arguments[n+2]);return r},Rt.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var i=n.prev;n.prev=n.next,n.next=i}return this.head=t,this.tail=e,this};try{Rt.prototype[Symbol.iterator]=Ql.mark(function e(){var t;return Ql.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:t=this.head;case 1:if(!t){i.next=7;break}return i.next=4,t.value;case 4:t=t.next,i.next=1;break;case 7:case"end":return i.stop()}},e,this)})}catch(e){}var Aqe=Cqe,Zh=Symbol("max"),rc=Symbol("length"),n0=Symbol("lengthCalculator"),c1=Symbol("allowStale"),ep=Symbol("maxAge"),sc=Symbol("dispose"),gae=Symbol("noDisposeOnSet"),$i=Symbol("lruList"),$a=Symbol("cache"),mae=Symbol("updateAgeOnGet"),WB=()=>1,qB=(e,t,n)=>{var i=e[$a].get(t);if(i){var r=i.value;if(zx(e,r)){if(r0(e,i),!e[c1])return}else n&&(e[mae]&&(i.value.now=Date.now()),e[$i].unshiftNode(i));return r.value}},zx=(e,t)=>{if(!t||!t.maxAge&&!e[ep])return!1;var n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[ep]&&n>e[ep]},f1=e=>{if(e[rc]>e[Zh])for(var t=e[$i].tail;e[rc]>e[Zh]&&null!==t;){var n=t.prev;r0(e,t),t=n}},r0=(e,t)=>{if(t){var n=t.value;e[sc]&&e[sc](n.key,n.value),e[rc]-=n.length,e[$a].delete(n.key),e[$i].removeNode(t)}};class Oqe{constructor(t,n,i,r,s){this.key=t,this.value=n,this.length=i,this.now=r,this.maxAge=s||0}}var _ae=(e,t,n,i)=>{var r=n.value;zx(e,r)&&(r0(e,n),e[c1]||(r=void 0)),r&&t.call(i,r.value,r.key,e)},Nqe=["includePrerelease","loose","rtl"],YB=e=>e?"object"!=typeof e?{loose:!0}:Nqe.filter(t=>e[t]).reduce((t,n)=>(t[n]=!0,t),{}):{},Va={exports:{}},KB={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH:16},Lqe="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.error("SEMVER",...t)}:()=>{},Gx=Lqe;!function(e,t){var n=KB.MAX_SAFE_COMPONENT_LENGTH,i=Gx,r=(t=e.exports={}).re=[],s=t.src=[],o=t.t={},a=0,l=(u,c,f)=>{var d=a++;i(d,c),o[u]=d,s[d]=c,r[d]=new RegExp(c,f?"g":void 0)};l("NUMERICIDENTIFIER","0|[1-9]\\d*"),l("NUMERICIDENTIFIERLOOSE","[0-9]+"),l("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),l("MAINVERSION","(".concat(s[o.NUMERICIDENTIFIER],")\\.")+"(".concat(s[o.NUMERICIDENTIFIER],")\\.")+"(".concat(s[o.NUMERICIDENTIFIER],")")),l("MAINVERSIONLOOSE","(".concat(s[o.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(s[o.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(s[o.NUMERICIDENTIFIERLOOSE],")")),l("PRERELEASEIDENTIFIER","(?:".concat(s[o.NUMERICIDENTIFIER],"|").concat(s[o.NONNUMERICIDENTIFIER],")")),l("PRERELEASEIDENTIFIERLOOSE","(?:".concat(s[o.NUMERICIDENTIFIERLOOSE],"|").concat(s[o.NONNUMERICIDENTIFIER],")")),l("PRERELEASE","(?:-(".concat(s[o.PRERELEASEIDENTIFIER],"(?:\\.").concat(s[o.PRERELEASEIDENTIFIER],")*))")),l("PRERELEASELOOSE","(?:-?(".concat(s[o.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(s[o.PRERELEASEIDENTIFIERLOOSE],")*))")),l("BUILDIDENTIFIER","[0-9A-Za-z-]+"),l("BUILD","(?:\\+(".concat(s[o.BUILDIDENTIFIER],"(?:\\.").concat(s[o.BUILDIDENTIFIER],")*))")),l("FULLPLAIN","v?".concat(s[o.MAINVERSION]).concat(s[o.PRERELEASE],"?").concat(s[o.BUILD],"?")),l("FULL","^".concat(s[o.FULLPLAIN],"$")),l("LOOSEPLAIN","[v=\\s]*".concat(s[o.MAINVERSIONLOOSE]).concat(s[o.PRERELEASELOOSE],"?").concat(s[o.BUILD],"?")),l("LOOSE","^".concat(s[o.LOOSEPLAIN],"$")),l("GTLT","((?:<|>)?=?)"),l("XRANGEIDENTIFIERLOOSE","".concat(s[o.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),l("XRANGEIDENTIFIER","".concat(s[o.NUMERICIDENTIFIER],"|x|X|\\*")),l("XRANGEPLAIN","[v=\\s]*(".concat(s[o.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(s[o.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(s[o.XRANGEIDENTIFIER],")")+"(?:".concat(s[o.PRERELEASE],")?").concat(s[o.BUILD],"?")+")?)?"),l("XRANGEPLAINLOOSE","[v=\\s]*(".concat(s[o.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(s[o.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(s[o.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(s[o.PRERELEASELOOSE],")?").concat(s[o.BUILD],"?")+")?)?"),l("XRANGE","^".concat(s[o.GTLT],"\\s*").concat(s[o.XRANGEPLAIN],"$")),l("XRANGELOOSE","^".concat(s[o.GTLT],"\\s*").concat(s[o.XRANGEPLAINLOOSE],"$")),l("COERCE","".concat("(^|[^\\d])(\\d{1,").concat(n,"})")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:$|[^\\d])"),l("COERCERTL",s[o.COERCE],!0),l("LONETILDE","(?:~>?)"),l("TILDETRIM","(\\s*)".concat(s[o.LONETILDE],"\\s+"),!0),t.tildeTrimReplace="$1~",l("TILDE","^".concat(s[o.LONETILDE]).concat(s[o.XRANGEPLAIN],"$")),l("TILDELOOSE","^".concat(s[o.LONETILDE]).concat(s[o.XRANGEPLAINLOOSE],"$")),l("LONECARET","(?:\\^)"),l("CARETTRIM","(\\s*)".concat(s[o.LONECARET],"\\s+"),!0),t.caretTrimReplace="$1^",l("CARET","^".concat(s[o.LONECARET]).concat(s[o.XRANGEPLAIN],"$")),l("CARETLOOSE","^".concat(s[o.LONECARET]).concat(s[o.XRANGEPLAINLOOSE],"$")),l("COMPARATORLOOSE","^".concat(s[o.GTLT],"\\s*(").concat(s[o.LOOSEPLAIN],")$|^$")),l("COMPARATOR","^".concat(s[o.GTLT],"\\s*(").concat(s[o.FULLPLAIN],")$|^$")),l("COMPARATORTRIM","(\\s*)".concat(s[o.GTLT],"\\s*(").concat(s[o.LOOSEPLAIN],"|").concat(s[o.XRANGEPLAIN],")"),!0),t.comparatorTrimReplace="$1$2$3",l("HYPHENRANGE","^\\s*(".concat(s[o.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(s[o.XRANGEPLAIN],")")+"\\s*$"),l("HYPHENRANGELOOSE","^\\s*(".concat(s[o.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(s[o.XRANGEPLAINLOOSE],")")+"\\s*$"),l("STAR","(<|>)?=?\\s*\\*"),l("GTE0","^\\s*>=\\s*0.0.0\\s*$"),l("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")}(Va,Va.exports);var yae=/^[0-9]+$/,Wx=Gx,bae=KB.MAX_LENGTH,qx=KB.MAX_SAFE_INTEGER,wae=Va.exports.re,Dae=Va.exports.t,$qe=YB,d1=(e,t)=>{var n=yae.test(e),i=yae.test(t);return n&&i&&(e=+e,t=+t),e===t?0:n&&!i?-1:i&&!n?1:e<t?-1:1};class Ha{constructor(t,n){if(n=$qe(n),t instanceof Ha){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if("string"!=typeof t)throw new TypeError("Invalid Version: ".concat(t));if(t.length>bae)throw new TypeError("version is longer than ".concat(bae," characters"));Wx("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;var i=t.trim().match(n.loose?wae[Dae.LOOSE]:wae[Dae.FULL]);if(!i)throw new TypeError("Invalid Version: ".concat(t));if(this.raw=t,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>qx||this.major<0)throw new TypeError("Invalid major version");if(this.minor>qx||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>qx||this.patch<0)throw new TypeError("Invalid patch version");this.prerelease=i[4]?i[4].split(".").map(r=>{if(/^[0-9]+$/.test(r)){var s=+r;if(s>=0&&s<qx)return s}return r}):[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}toString(){return this.version}compare(t){if(Wx("SemVer.compare",this.version,this.options,t),!(t instanceof Ha)){if("string"==typeof t&&t===this.version)return 0;t=new Ha(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof Ha||(t=new Ha(t,this.options)),d1(this.major,t.major)||d1(this.minor,t.minor)||d1(this.patch,t.patch)}comparePre(t){if(t instanceof Ha||(t=new Ha(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var n=0;do{var i=this.prerelease[n],r=t.prerelease[n];if(Wx("prerelease compare",n,i,r),void 0===i&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===i)return-1;if(i!==r)return d1(i,r)}while(++n)}compareBuild(t){t instanceof Ha||(t=new Ha(t,this.options));var n=0;do{var i=this.build[n],r=t.build[n];if(Wx("prerelease compare",n,i,r),void 0===i&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===i)return-1;if(i!==r)return d1(i,r)}while(++n)}inc(t,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n),this.inc("pre",n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",n),this.inc("pre",n);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var i=this.prerelease.length;--i>=0;)"number"==typeof this.prerelease[i]&&(this.prerelease[i]++,i=-2);-1===i&&this.prerelease.push(0)}n&&(this.prerelease[0]===n?isNaN(this.prerelease[1])&&(this.prerelease=[n,0]):this.prerelease=[n,0]);break;default:throw new Error("invalid increment argument: ".concat(t))}return this.format(),this.raw=this.version,this}}var JB=Ha,Cae=JB,s0=(e,t,n)=>new Cae(e,n).compare(new Cae(t,n)),Hqe=s0,Gqe=s0,Yqe=s0,Xqe=s0,eYe=s0,iYe=s0,oYe=(e,t,n)=>0===Hqe(e,t,n),aYe=(e,t,n)=>0!==Gqe(e,t,n),lYe=(e,t,n)=>Yqe(e,t,n)>0,uYe=(e,t,n)=>Xqe(e,t,n)>=0,cYe=(e,t,n)=>eYe(e,t,n)<0,fYe=(e,t,n)=>iYe(e,t,n)<=0,h1=Symbol("SemVer ANY");class Yx{static get ANY(){return h1}constructor(t,n){if(n=gYe(n),t instanceof Yx){if(t.loose===!!n.loose)return t;t=t.value}QB("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.value=this.semver===h1?"":this.operator+this.semver.version,QB("comp",this)}parse(t){var i=t.match(this.options.loose?Eae[Sae.COMPARATORLOOSE]:Eae[Sae.COMPARATOR]);if(!i)throw new TypeError("Invalid comparator: ".concat(t));this.operator=void 0!==i[1]?i[1]:"","="===this.operator&&(this.operator=""),this.semver=i[2]?new xae(i[2],this.options.loose):h1}toString(){return this.value}test(t){if(QB("Comparator.test",t,this.options.loose),this.semver===h1||t===h1)return!0;if("string"==typeof t)try{t=new xae(t,this.options)}catch(n){return!1}return XB(t,this.operator,this.semver,this.options)}intersects(t,n){if(!(t instanceof Yx))throw new TypeError("a Comparator is required");if((!n||"object"!=typeof n)&&(n={loose:!!n,includePrerelease:!1}),""===this.operator)return""===this.value||new Aae(t.value,n).test(this.value);if(""===t.operator)return""===t.value||new Aae(this.value,n).test(t.semver);var i=!(">="!==this.operator&&">"!==this.operator||">="!==t.operator&&">"!==t.operator),r=!("<="!==this.operator&&"<"!==this.operator||"<="!==t.operator&&"<"!==t.operator),s=this.semver.version===t.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==t.operator&&"<="!==t.operator),a=XB(this.semver,"<",t.semver,n)&&(">="===this.operator||">"===this.operator)&&("<="===t.operator||"<"===t.operator),l=XB(this.semver,">",t.semver,n)&&("<="===this.operator||"<"===this.operator)&&(">="===t.operator||">"===t.operator);return i||r||s&&o||a||l}}var pYe=Yx,gYe=YB,Eae=Va.exports.re,Sae=Va.exports.t,XB=(e,t,n,i)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return oYe(e,n,i);case"!=":return aYe(e,n,i);case">":return lYe(e,n,i);case">=":return uYe(e,n,i);case"<":return cYe(e,n,i);case"<=":return fYe(e,n,i);default:throw new TypeError("Invalid operator: ".concat(t))}},QB=Gx,xae=JB,Aae=Mae;function Tae(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function mYe(e,t){if(e){if("string"==typeof e)return Oae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Oae(e,t)}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(u){throw u},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var u=n.next();return s=u.done,u},e:function(u){o=!0,a=u},f:function(){try{!s&&null!=n.return&&n.return()}finally{if(o)throw a}}}}function Oae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}class p1{constructor(t,n){if(n=yYe(n),t instanceof p1)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new p1(t.raw,n);if(t instanceof ZB)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(a=>this.parseRange(a.trim())).filter(a=>a.length),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(t));if(this.set.length>1){var i=this.set[0];if(this.set=this.set.filter(a=>!kae(a[0])),0===this.set.length)this.set=[i];else if(this.set.length>1){var s,r=Tae(this.set);try{for(r.s();!(s=r.n()).done;){var o=s.value;if(1===o.length&&CYe(o[0])){this.set=[o];break}}}catch(a){r.e(a)}finally{r.f()}}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){t=t.trim();var n=Object.keys(this.options).join(","),i="parseRange:".concat(n,":").concat(t),r=Nae.get(i);if(r)return r;var s=this.options.loose;t=t.replace(s?Dr[Xi.HYPHENRANGELOOSE]:Dr[Xi.HYPHENRANGE],IYe(this.options.includePrerelease)),ei("hyphen replace",t),t=t.replace(Dr[Xi.COMPARATORTRIM],bYe),ei("comparator trim",t,Dr[Xi.COMPARATORTRIM]),t=(t=(t=t.replace(Dr[Xi.TILDETRIM],wYe)).replace(Dr[Xi.CARETTRIM],DYe)).split(/\s+/).join(" ");var f,a=s?Dr[Xi.COMPARATORLOOSE]:Dr[Xi.COMPARATOR],l=t.split(" ").map(p=>EYe(p,this.options)).join(" ").split(/\s+/).map(p=>kYe(p,this.options)).filter(this.options.loose?p=>!!p.match(a):()=>!0).map(p=>new ZB(p,this.options)),u=new Map,c=Tae(l);try{for(c.s();!(f=c.n()).done;){var d=f.value;if(kae(d))return[d];u.set(d.value,d)}}catch(p){c.e(p)}finally{c.f()}u.size>1&&u.has("")&&u.delete("");var h=[...u.values()];return Nae.set(i,h),h}intersects(t,n){if(!(t instanceof p1))throw new TypeError("a Range is required");return this.set.some(i=>Iae(i,n)&&t.set.some(r=>Iae(r,n)&&i.every(s=>r.every(o=>s.intersects(o,n)))))}test(t){if(!t)return!1;if("string"==typeof t)try{t=new vYe(t,this.options)}catch(i){return!1}for(var n=0;n<this.set.length;n++)if(RYe(this.set[n],t,this.options))return!0;return!1}}var Mae=p1,Nae=new class Tqe{constructor(t){if("number"==typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!=typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[Zh]=t.max||1/0;var n=t.length||WB;if(this[n0]="function"!=typeof n?WB:n,this[c1]=t.stale||!1,t.maxAge&&"number"!=typeof t.maxAge)throw new TypeError("maxAge must be a number");this[ep]=t.maxAge||0,this[sc]=t.dispose,this[gae]=t.noDisposeOnSet||!1,this[mae]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!=typeof t||t<0)throw new TypeError("max must be a non-negative number");this[Zh]=t||1/0,f1(this)}get max(){return this[Zh]}set allowStale(t){this[c1]=!!t}get allowStale(){return this[c1]}set maxAge(t){if("number"!=typeof t)throw new TypeError("maxAge must be a non-negative number");this[ep]=t,f1(this)}get maxAge(){return this[ep]}set lengthCalculator(t){"function"!=typeof t&&(t=WB),t!==this[n0]&&(this[n0]=t,this[rc]=0,this[$i].forEach(n=>{n.length=this[n0](n.value,n.key),this[rc]+=n.length})),f1(this)}get lengthCalculator(){return this[n0]}get length(){return this[rc]}get itemCount(){return this[$i].length}rforEach(t,n){n=n||this;for(var i=this[$i].tail;null!==i;){var r=i.prev;_ae(this,t,i,n),i=r}}forEach(t,n){n=n||this;for(var i=this[$i].head;null!==i;){var r=i.next;_ae(this,t,i,n),i=r}}keys(){return this[$i].toArray().map(t=>t.key)}values(){return this[$i].toArray().map(t=>t.value)}reset(){this[sc]&&this[$i]&&this[$i].length&&this[$i].forEach(t=>this[sc](t.key,t.value)),this[$a]=new Map,this[$i]=new Aqe,this[rc]=0}dump(){return this[$i].map(t=>!zx(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[$i]}set(t,n,i){if((i=i||this[ep])&&"number"!=typeof i)throw new TypeError("maxAge must be a number");var r=i?Date.now():0,s=this[n0](n,t);if(this[$a].has(t)){if(s>this[Zh])return r0(this,this[$a].get(t)),!1;var a=this[$a].get(t).value;return this[sc]&&(this[gae]||this[sc](t,a.value)),a.now=r,a.maxAge=i,a.value=n,this[rc]+=s-a.length,a.length=s,this.get(t),f1(this),!0}var l=new Oqe(t,n,s,r,i);return l.length>this[Zh]?(this[sc]&&this[sc](t,n),!1):(this[rc]+=l.length,this[$i].unshift(l),this[$a].set(t,this[$i].head),f1(this),!0)}has(t){if(!this[$a].has(t))return!1;var n=this[$a].get(t).value;return!zx(this,n)}get(t){return qB(this,t,!0)}peek(t){return qB(this,t,!1)}pop(){var t=this[$i].tail;return t?(r0(this,t),t.value):null}del(t){r0(this,this[$a].get(t))}load(t){this.reset();for(var n=Date.now(),i=t.length-1;i>=0;i--){var r=t[i],s=r.e||0;if(0===s)this.set(r.k,r.v);else{var o=s-n;o>0&&this.set(r.k,r.v,o)}}}prune(){this[$a].forEach((t,n)=>qB(this,n,!1))}}({max:1e3}),yYe=YB,ZB=pYe,ei=Gx,vYe=JB,Dr=Va.exports.re,Xi=Va.exports.t,bYe=Va.exports.comparatorTrimReplace,wYe=Va.exports.tildeTrimReplace,DYe=Va.exports.caretTrimReplace,kae=e=>"<0.0.0-0"===e.value,CYe=e=>""===e.value,Iae=(e,t)=>{for(var n=!0,i=e.slice(),r=i.pop();n&&i.length;)n=i.every(s=>r.intersects(s,t)),r=i.pop();return n},EYe=(e,t)=>(ei("comp",e,t),e=AYe(e,t),ei("caret",e),e=SYe(e,t),ei("tildes",e),e=OYe(e,t),ei("xrange",e),e=NYe(e,t),ei("stars",e),e),Jr=e=>!e||"x"===e.toLowerCase()||"*"===e,SYe=(e,t)=>e.trim().split(/\s+/).map(n=>xYe(n,t)).join(" "),xYe=(e,t)=>e.replace(t.loose?Dr[Xi.TILDELOOSE]:Dr[Xi.TILDE],(i,r,s,o,a)=>{var l;return ei("tilde",e,i,r,s,o,a),Jr(r)?l="":Jr(s)?l=">=".concat(r,".0.0 <").concat(+r+1,".0.0-0"):Jr(o)?l=">=".concat(r,".").concat(s,".0 <").concat(r,".").concat(+s+1,".0-0"):a?(ei("replaceTilde pr",a),l=">=".concat(r,".").concat(s,".").concat(o,"-").concat(a," <").concat(r,".").concat(+s+1,".0-0")):l=">=".concat(r,".").concat(s,".").concat(o," <").concat(r,".").concat(+s+1,".0-0"),ei("tilde return",l),l}),AYe=(e,t)=>e.trim().split(/\s+/).map(n=>TYe(n,t)).join(" "),TYe=(e,t)=>{ei("caret",e,t);var i=t.includePrerelease?"-0":"";return e.replace(t.loose?Dr[Xi.CARETLOOSE]:Dr[Xi.CARET],(r,s,o,a,l)=>{var u;return ei("caret",e,r,s,o,a,l),Jr(s)?u="":Jr(o)?u=">=".concat(s,".0.0").concat(i," <").concat(+s+1,".0.0-0"):Jr(a)?u="0"===s?">=".concat(s,".").concat(o,".0").concat(i," <").concat(s,".").concat(+o+1,".0-0"):">=".concat(s,".").concat(o,".0").concat(i," <").concat(+s+1,".0.0-0"):l?(ei("replaceCaret pr",l),u="0"===s?"0"===o?">=".concat(s,".").concat(o,".").concat(a,"-").concat(l," <").concat(s,".").concat(o,".").concat(+a+1,"-0"):">=".concat(s,".").concat(o,".").concat(a,"-").concat(l," <").concat(s,".").concat(+o+1,".0-0"):">=".concat(s,".").concat(o,".").concat(a,"-").concat(l," <").concat(+s+1,".0.0-0")):(ei("no pr"),u="0"===s?"0"===o?">=".concat(s,".").concat(o,".").concat(a).concat(i," <").concat(s,".").concat(o,".").concat(+a+1,"-0"):">=".concat(s,".").concat(o,".").concat(a).concat(i," <").concat(s,".").concat(+o+1,".0-0"):">=".concat(s,".").concat(o,".").concat(a," <").concat(+s+1,".0.0-0")),ei("caret return",u),u})},OYe=(e,t)=>(ei("replaceXRanges",e,t),e.split(/\s+/).map(n=>MYe(n,t)).join(" ")),MYe=(e,t)=>(e=e.trim()).replace(t.loose?Dr[Xi.XRANGELOOSE]:Dr[Xi.XRANGE],(i,r,s,o,a,l)=>{ei("xRange",e,i,r,s,o,a,l);var u=Jr(s),c=u||Jr(o),f=c||Jr(a);return"="===r&&f&&(r=""),l=t.includePrerelease?"-0":"",u?i=">"===r||"<"===r?"<0.0.0-0":"*":r&&f?(c&&(o=0),a=0,">"===r?(r=">=",c?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):"<="===r&&(r="<",c?s=+s+1:o=+o+1),"<"===r&&(l="-0"),i="".concat(r+s,".").concat(o,".").concat(a).concat(l)):c?i=">=".concat(s,".0.0").concat(l," <").concat(+s+1,".0.0-0"):f&&(i=">=".concat(s,".").concat(o,".0").concat(l," <").concat(s,".").concat(+o+1,".0-0")),ei("xRange return",i),i}),NYe=(e,t)=>(ei("replaceStars",e,t),e.trim().replace(Dr[Xi.STAR],"")),kYe=(e,t)=>(ei("replaceGTE0",e,t),e.trim().replace(Dr[t.includePrerelease?Xi.GTE0PRE:Xi.GTE0],"")),IYe=e=>(t,n,i,r,s,o,a,l,u,c,f,d,h)=>(n=Jr(i)?"":Jr(r)?">=".concat(i,".0.0").concat(e?"-0":""):Jr(s)?">=".concat(i,".").concat(r,".0").concat(e?"-0":""):o?">=".concat(n):">=".concat(n).concat(e?"-0":""),l=Jr(u)?"":Jr(c)?"<".concat(+u+1,".0.0-0"):Jr(f)?"<".concat(u,".").concat(+c+1,".0-0"):d?"<=".concat(u,".").concat(c,".").concat(f,"-").concat(d):e?"<".concat(u,".").concat(c,".").concat(+f+1,"-0"):"<=".concat(l),"".concat(n," ").concat(l).trim()),RYe=(e,t,n)=>{for(var i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(var r=0;r<e.length;r++)if(ei(e[r].semver),e[r].semver!==ZB.ANY&&e[r].semver.prerelease.length>0){var s=e[r].semver;if(s.major===t.major&&s.minor===t.minor&&s.patch===t.patch)return!0}return!1}return!0},FYe=Mae,Rae=(e,t,n)=>{try{t=new FYe(t,n)}catch(i){return!1}return t.test(e)};function LYe(e,t,n){var i=e.open(t),a=new URL(t).origin,l=40;e.addEventListener("message",function u(f){f.source===i&&(l=0,e.removeEventListener("message",u,!1))},!1),setTimeout(function c(){l<=0||(i.postMessage(n,a),setTimeout(c,250),l-=1)},250)}var e5,jYe='.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box;\n}\n.vega-embed.has-actions {\n  padding-right: 38px;\n}\n.vega-embed details:not([open]) > :not(summary) {\n  display: none !important;\n}\n.vega-embed summary {\n  list-style: none;\n  position: absolute;\n  top: 0;\n  right: 0;\n  padding: 6px;\n  z-index: 1000;\n  background: white;\n  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n  color: #1b1e23;\n  border: 1px solid #aaa;\n  border-radius: 999px;\n  opacity: 0.2;\n  transition: opacity 0.4s ease-in;\n  cursor: pointer;\n  line-height: 0px;\n}\n.vega-embed summary::-webkit-details-marker {\n  display: none;\n}\n.vega-embed summary:active {\n  box-shadow: #aaa 0px 0px 0px 1px inset;\n}\n.vega-embed summary svg {\n  width: 14px;\n  height: 14px;\n}\n.vega-embed details[open] summary {\n  opacity: 0.7;\n}\n.vega-embed:hover summary, .vega-embed:focus-within summary {\n  opacity: 1 !important;\n  transition: opacity 0.2s ease;\n}\n.vega-embed .vega-actions {\n  position: absolute;\n  z-index: 1001;\n  top: 35px;\n  right: -9px;\n  display: flex;\n  flex-direction: column;\n  padding-bottom: 8px;\n  padding-top: 8px;\n  border-radius: 4px;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n  border: 1px solid #d9d9d9;\n  background: white;\n  animation-duration: 0.15s;\n  animation-name: scale-in;\n  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n  text-align: left;\n}\n.vega-embed .vega-actions a {\n  padding: 8px 16px;\n  font-family: sans-serif;\n  font-size: 14px;\n  font-weight: 600;\n  white-space: nowrap;\n  color: #434a56;\n  text-decoration: none;\n}\n.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {\n  background-color: #f7f7f9;\n  color: black;\n}\n.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n  content: "";\n  display: inline-block;\n  position: absolute;\n}\n.vega-embed .vega-actions::before {\n  left: auto;\n  right: 14px;\n  top: -16px;\n  border: 8px solid #0000;\n  border-bottom-color: #d9d9d9;\n}\n.vega-embed .vega-actions::after {\n  left: auto;\n  right: 15px;\n  top: -14px;\n  border: 7px solid #0000;\n  border-bottom-color: #fff;\n}\n.vega-embed .chart-wrapper.fit-x {\n  width: 100%;\n}\n.vega-embed .chart-wrapper.fit-y {\n  height: 100%;\n}\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px;\n}\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n';function Fae(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var r=0,s=n;r<s.length;r++){var o=s[r];BYe(e,o)}return e}function BYe(e,t){for(var n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];_g(e,r,t[r],!0)}}function Pae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function Zf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pae(Object(n),!0).forEach(function(i){pqe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pae(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});var ed=Ya,g1=Qi,Kx="undefined"!=typeof window?window:void 0;void 0===g1&&null!=Kx&&null!==(e5=Kx.vl)&&void 0!==e5&&e5.compile&&(g1=Kx.vl);var lKe={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},uKe={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},m1={vega:"Vega","vega-lite":"Vega-Lite"},Jx={vega:ed.version,"vega-lite":g1?g1.version:"not available"},cKe={vega:e=>e,"vega-lite":(e,t)=>g1.compile(e,{config:t}).spec},fKe='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',dKe="chart-wrapper";function hKe(e){return"function"==typeof e}function Lae(e,t,n,i){var r="<html><head>".concat(t,'</head><body><pre><code class="json">'),s="</code></pre>".concat(n,"</body></html>"),o=window.open("");o.document.write(r+e+s),o.document.title="".concat(m1[i]," JSON Source")}function pKe(e,t){if(e.$schema){var i,n=Yoe(e.$schema);t&&t!==n.library&&console.warn("The given visualization spec is written in ".concat(m1[n.library],", but mode argument sets ").concat(null!==(i=m1[t])&&void 0!==i?i:t,"."));var r=n.library;return Rae(Jx[r],"^".concat(n.version.slice(1)))||console.warn("The input spec uses ".concat(m1[r]," ").concat(n.version,", but the current version of ").concat(m1[r]," is v").concat(Jx[r],".")),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":null!=t?t:"vega"}function jae(e){return function gKe(e){return!(!e||!("load"in e))}(e)?e:ed.loader(e)}function mKe(e){var t,n,i=null!==(t=null===(n=e.usermeta)||void 0===n?void 0:n.embedOptions)&&void 0!==t?t:{};return _e(i.defaultStyle)&&(i.defaultStyle=!1),i}function o0(e,t){return t5.apply(this,arguments)}function t5(){return t5=Lx(Ql.mark(function e(t,n){var i,r,s,o,a,l,u,c,f,d,h,p=arguments;return Ql.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(s=p.length>2&&void 0!==p[2]?p[2]:{},!_e(n)){m.next=10;break}return a=jae(s.loader),m.t0=JSON,m.next=6,a.load(n);case 6:m.t1=m.sent,o=m.t0.parse.call(m.t0,m.t1),m.next=11;break;case 10:o=n;case 11:return l=mKe(o),u=l.loader,(!a||u)&&(a=jae(null!==(c=s.loader)&&void 0!==c?c:u)),m.next=16,Bae(l,a);case 16:return f=m.sent,m.next=19,Bae(s,a);case 19:return h=Zf(Zf({},Fae(d=m.sent,f)),{},{config:mg(null!==(i=d.config)&&void 0!==i?i:{},null!==(r=f.config)&&void 0!==r?r:{})}),m.next=23,yKe(t,o,h,a);case 23:return m.abrupt("return",m.sent);case 24:case"end":return m.stop()}},e)})),t5.apply(this,arguments)}function Bae(e,t){return n5.apply(this,arguments)}function n5(){return n5=Lx(Ql.mark(function e(t,n){var i,r,s;return Ql.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!_e(t.config)){a.next=8;break}return a.t1=JSON,a.next=4,n.load(t.config);case 4:a.t2=a.sent,a.t0=a.t1.parse.call(a.t1,a.t2),a.next=9;break;case 8:a.t0=null!==(i=t.config)&&void 0!==i?i:{};case 9:if(r=a.t0,!_e(t.patch)){a.next=18;break}return a.t4=JSON,a.next=14,n.load(t.patch);case 14:a.t5=a.sent,a.t3=a.t4.parse.call(a.t4,a.t5),a.next=19;break;case 18:a.t3=t.patch;case 19:return s=a.t3,a.abrupt("return",Zf(Zf(Zf({},t),s?{patch:s}:{}),r?{config:r}:{}));case 21:case"end":return a.stop()}},e)})),n5.apply(this,arguments)}function _Ke(e){var t,n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:null!==(t=document.head)&&void 0!==t?t:document.body}}function yKe(e,t){return i5.apply(this,arguments)}function i5(){return i5=Lx(Ql.mark(function e(t,n){var i,r,s,o,a,l,u,c,f,d,h,p,g,m,_,y,v,b,C,w,E,O,M,N,R,P,A,x,S,k,T,F,V,U,L,W,te,q,se,G,X,ee,z,de,ye,ke,De=arguments;return Ql.wrap(function(at){for(;;)switch(at.prev=at.next){case 0:if(ke=function(){V&&document.removeEventListener("click",V),S.finalize()},f=De.length>3?De[3]:void 0,d=(c=De.length>2&&void 0!==De[2]?De[2]:{}).theme?mg(Ka[c.theme],null!==(i=c.config)&&void 0!==i?i:{}):c.config,h=Fc(c.actions)?c.actions:Fae({},lKe,null!==(r=c.actions)&&void 0!==r?r:{}),p=Zf(Zf({},uKe),c.i18n),g=null!==(s=c.renderer)&&void 0!==s?s:"canvas",m=null!==(o=c.logLevel)&&void 0!==o?o:ed.Warn,_=null!==(a=c.downloadFileName)&&void 0!==a?a:"visualization",y="string"==typeof t?document.querySelector(t):t){at.next=12;break}throw new Error("".concat(t," does not exist"));case 12:return!1!==c.defaultStyle&&(v="vega-embed-style",b=_Ke(y),C=b.rootContainer,b.root.getElementById(v)||((w=document.createElement("style")).id=v,w.innerHTML=void 0===c.defaultStyle||!0===c.defaultStyle?jYe.toString():c.defaultStyle,C.appendChild(w))),E=pKe(n,c.mode),O=cKe[E](n,d),"vega-lite"===E&&O.$schema&&(M=Yoe(O.$schema),Rae(Jx.vega,"^".concat(M.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(M.version,", but current version is v").concat(Jx.vega,"."))),y.classList.add("vega-embed"),h&&y.classList.add("has-actions"),y.innerHTML="",N=y,h&&((R=document.createElement("div")).classList.add(dKe),y.appendChild(R),N=R),(P=c.patch)&&(O=P instanceof Function?P(O):jw(O,P,!0,!1).newDocument),c.formatLocale&&ed.formatLocale(c.formatLocale),c.timeFormatLocale&&ed.timeFormatLocale(c.timeFormatLocale),x=ed.parse(O,"vega-lite"===E?{}:d,{ast:A=c.ast}),(S=new(c.viewClass||ed.View)(x,Zf({loader:f,logLevel:m,renderer:g},A?{expr:null!==(l=null!==(u=ed.expressionInterpreter)&&void 0!==u?u:c.expr)&&void 0!==l?l:y4e}:{}))).addSignalListener("autosize",(Ft,et)=>{var ht=et.type;"fit-x"==ht?(N.classList.add("fit-x"),N.classList.remove("fit-y")):"fit-y"==ht?(N.classList.remove("fit-x"),N.classList.add("fit-y")):"fit"==ht?N.classList.add("fit-x","fit-y"):N.classList.remove("fit-x","fit-y")}),!1!==c.tooltip&&(k=hKe(c.tooltip)?c.tooltip:new sae(!0===c.tooltip?{}:c.tooltip).call,S.tooltip(k)),void 0===(T=c.hover)&&(T="vega"===E),T&&S.hover((F="boolean"==typeof T?{}:T).hoverSet,F.updateSet),c&&(null!=c.width&&S.width(c.width),null!=c.height&&S.height(c.height),null!=c.padding&&S.padding(c.padding)),at.next=36,S.initialize(N,c.bind).runAsync();case 36:if(!1!==h){if(U=y,!1!==c.defaultStyle&&((L=document.createElement("details")).title=p.CLICK_TO_VIEW_ACTIONS,y.append(L),U=L,(W=document.createElement("summary")).innerHTML=fKe,L.append(W),V=Ft=>{L.contains(Ft.target)||L.removeAttribute("open")},document.addEventListener("click",V)),te=document.createElement("div"),U.append(te),te.classList.add("vega-actions"),!0===h||!1!==h.export)for(q=function(){var et=G[se];if(!0===h||!0===h.export||h.export[et]){var ht=p["".concat(et.toUpperCase(),"_ACTION")],tn=document.createElement("a");tn.text=ht,tn.href="#",tn.target="_blank",tn.download="".concat(_,".").concat(et),tn.addEventListener("mousedown",function(){var uc=Lx(Ql.mark(function xi(ao){return Ql.wrap(function(Ss){for(;;)switch(Ss.prev=Ss.next){case 0:return ao.preventDefault(),Ss.next=3,S.toImageURL(et,c.scaleFactor);case 3:this.href=Ss.sent;case 5:case"end":return Ss.stop()}},xi,this)}));return function(xi){return uc.apply(this,arguments)}}()),te.append(tn)}},se=0,G=["svg","png"];se<G.length;se++)q();(!0===h||!1!==h.source)&&((X=document.createElement("a")).text=p.SOURCE_ACTION,X.href="#",X.addEventListener("click",function(Ft){var et,ht;Lae(qN()(n),null!==(et=c.sourceHeader)&&void 0!==et?et:"",null!==(ht=c.sourceFooter)&&void 0!==ht?ht:"",E),Ft.preventDefault()}),te.append(X)),"vega-lite"===E&&(!0===h||!1!==h.compiled)&&((ee=document.createElement("a")).text=p.COMPILED_ACTION,ee.href="#",ee.addEventListener("click",function(Ft){var et,ht;Lae(qN()(O),null!==(et=c.sourceHeader)&&void 0!==et?et:"",null!==(ht=c.sourceFooter)&&void 0!==ht?ht:"","vega"),Ft.preventDefault()}),te.append(ee)),(!0===h||!1!==h.editor)&&(de=null!==(z=c.editorUrl)&&void 0!==z?z:"https://vega.github.io/editor/",(ye=document.createElement("a")).text=p.EDITOR_ACTION,ye.href="#",ye.addEventListener("click",function(Ft){LYe(window,de,{config:d,mode:E,renderer:g,spec:qN()(n)}),Ft.preventDefault()}),te.append(ye))}return at.abrupt("return",{view:S,spec:n,vgSpec:O,finalize:ke,embedOptions:c});case 38:case"end":return at.stop()}},e)})),i5.apply(this,arguments)}let _1=(()=>{class e{constructor(){this.wikirateApiHost="https://wikirate.org"}drawPieChart(n,i,r,s,o,a,l,u){var c=JSON.parse(JSON.stringify(RDe));return c.description=n,c.data[0].values=r,c.width=s,c.height=o,c.scales[0].range=a,c.scales[0].domain=l,o0(i,c,u)}drawPieCustomChart(n,i,r,s,o,a,l,u,c,f){let d=JSON.parse(JSON.stringify(FDe)),h=d.data;return h.unshift({name:"answers",url:`${this.wikirateApiHost}/~${s}+answer/answer_list.json?limit=0&filter[year]=${o}`,transform:[{type:"lookup",from:"assessed",key:"company",fields:["company"],values:["value"],as:["assessed"]},{type:"filter",expr:"datum.assessed === 'Yes'"},{type:"formula",as:"value",expr:"test(/beyond tier 1/, datum.value)? 'beyond tier 1': 'direct'"}]}),h.unshift({name:"assessed",url:`${this.wikirateApiHost}/~${r[1]}+Answer.json?view=answer_list&limit=0&filter[year]=${o}`,transform:[{type:"lookup",from:"uk_assessed",key:"company",fields:["company"],values:["value"],as:["uk_assessed"]},{type:"formula",as:"value",expr:"datum.value == 'Yes' || datum.uk_assessed == 'Yes' ? 'Yes' : 'No'"}]}),h.unshift({name:"uk_assessed",url:`${this.wikirateApiHost}/~${r[0]}+Answer.json?view=answer_list&limit=0&filter[year]=${o}`}),d.data=h,d.description=n,d.width=a,d.height=l,d.scales[0].range=u,d.scales[0].domain=c,console.log(d),o0(i,d,f)}drawMinimumRequirementsBarChart(n,i,r,s,o,a,l,u){let c=JSON.parse(JSON.stringify(iz)),f=[];f.push({name:"assessed",url:`${this.wikirateApiHost}/~${o}+Answer.json?view=answer_list&limit=0&filter[year]=${l}`});let d=[];for(let h of a){d.push(h.short_label);let p="[";for(let g of h.filter_value)p+="'"+g+"',";p=p.substring(0,p.length-1)+"]",f.push({name:h.short_label,url:`${this.wikirateApiHost}/~${h.id}+answer/answer_list.json?limit=0&filter[year]=${l}`,transform:[{type:"lookup",from:"assessed",key:"company",fields:["company"],values:["value"],as:["assessed"]},{type:"filter",expr:"datum.assessed == 'Yes'"},{type:"formula",as:"accepted_value",expr:"indexof("+p+", datum.value) >= 0"},{type:"aggregate",groupby:["accepted_value"]},{type:"impute",key:"accepted_value",keyvals:[!0],field:"count",value:0},{type:"joinaggregate",fields:["count"],ops:["sum"]},{type:"filter",expr:"datum.accepted_value == true"}]})}f.push({name:"metrics",values:a}),f.push({name:"counts",source:d,transform:[{type:"window",ops:["row_number"],as:["seq"]},{type:"lookup",from:"metrics",key:"seq",fields:["seq"],values:["label","metric","color","filter_value"],as:["title","wikirate_page","color","filter_value"]},{type:"formula",expr:"datum.count/datum.sum_count",as:"percentage"},{type:"formula",expr:"format(datum.count / datum.sum_count, '.0%')",as:"percent_label"},{type:"formula",expr:"datum.count + ' out of ' + datum.sum_count + ' companies'",as:"count_label"},{type:"formula",expr:"{ value: datum.filter_value }",as:"filter"}]}),c.description=n,c.data=f,c.width=r,c.height=s,o0(i,c,u)}drawSubgroupsBarChart(n,i,r,s,o,a,l,u,c){let f=JSON.parse(JSON.stringify(LDe)),d=[];return d.push({name:"uk_assessed",url:`${this.wikirateApiHost}/~${s[0]}+Answer.json?view=answer_list&limit=0&filter[year]=${u}`}),d.push({name:"assessed",url:`${this.wikirateApiHost}/~${s[1]}+Answer.json?view=answer_list&limit=0&filter[year]=${u}`,transform:[{type:"lookup",from:"uk_assessed",key:"company",fields:["company"],values:["value"],as:["uk_assessed"]},{type:"formula",as:"value",expr:"datum.value == 'Yes' || datum.uk_assessed == 'Yes' ? 'Yes' : 'No'"}]}),d.push({name:"answers",url:`${this.wikirateApiHost}/~${o}+Answer.json?view=answer_list&limit=0&filter[year]=${u}`,transform:[{type:"lookup",from:"assessed",key:"company",fields:["company"],values:["value"],as:["assessed"]},{type:"filter",expr:"datum.value != '' && datum.assessed == 'Yes'"},{type:"formula",expr:"split(datum.value, ', ')",as:"value_array"}]}),d.push(a),d.push(l),d.push(f.data[4]),f.description=n,f.data=d,f.width=r,o0(i,f,c)}drawBarChart(n,i,r,s,o,a,l,u){let c=JSON.parse(JSON.stringify(iz)),f=[];f.push({name:"uk_assessed",url:`${this.wikirateApiHost}/~${o[0]}+Answer.json?view=answer_list&limit=0&filter[year]=${l}`}),f.push({name:"assessed",url:`${this.wikirateApiHost}/~${o[1]}+Answer.json?view=answer_list&limit=0&filter[year]=${l}`,transform:[{type:"lookup",from:"uk_assessed",key:"company",fields:["company"],values:["value"],as:["uk_assessed"]},{type:"formula",as:"value",expr:"datum.value == 'Yes' || datum.uk_assessed == 'Yes' ? 'Yes' : 'No'"}]});let d=[];for(let h of a){d.push(h.short_label);let p="[";for(let g of h.filter_value)p+="'"+g+"',";p=p.substring(0,p.length-1)+"]",f.push({name:h.short_label,url:`${this.wikirateApiHost}/~${h.id}+answer/answer_list.json?limit=0&filter[year]=${l}`,transform:[{type:"lookup",from:"assessed",key:"company",fields:["company"],values:["value"],as:["assessed"]},{type:"filter",expr:"datum.assessed == 'Yes'"},{type:"formula",as:"accepted_value",expr:"indexof("+p+", datum.value) >= 0"},{type:"aggregate",groupby:["accepted_value"]},{type:"impute",key:"accepted_value",keyvals:[!0],field:"count",value:0},{type:"joinaggregate",fields:["count"],ops:["sum"]},{type:"filter",expr:"datum.accepted_value == true"}]})}return f.push({name:"metrics",values:a}),f.push({name:"counts",source:d,transform:[{type:"window",ops:["row_number"],as:["seq"]},{type:"lookup",from:"metrics",key:"seq",fields:["seq"],values:["label","metric","color","filter_value"],as:["title","wikirate_page","color","filter_value"]},{type:"formula",expr:"datum.count/datum.sum_count",as:"percentage"},{type:"formula",expr:"format(datum.count / datum.sum_count, '.0%')",as:"percent_label"},{type:"formula",expr:"datum.count + ' out of ' + datum.sum_count + ' companies'",as:"count_label"},{type:"formula",expr:"{ value: datum.filter_value }",as:"filter"}]}),c.description=n,c.data=f,c.width=r,c.height=s,o0(i,c,u)}drawPieChartGroups(n,i,r,s,o,a,l,u,c,f){var d=JSON.parse(JSON.stringify(PDe));let h={},p="";for(let g in o)h["color_"+g]=o[g],p+="colors.color_"+g+", ";return p="["+p.substring(0,p.length-2)+"]",d.signals[0].value=h,d.description=n,d.data[0].values=a,d.data.unshift({name:"answers",url:`${this.wikirateApiHost}/~${s}+Answer.json?view=answer_list&limit=0&filter[year]=${i}`,transform:[{type:"lookup",from:"assessed",key:"company",fields:["company"],values:["value"],as:["assessed"]},{type:"filter",expr:"datum.assessed == 'Yes'"}]}),d.data.unshift({name:"assessed",url:`${this.wikirateApiHost}/~${r[1]}+Answer.json?view=answer_list&limit=0&filter[year]=${i}`,transform:[{type:"lookup",from:"uk_assessed",key:"company",fields:["company"],values:["value"],as:["uk_assessed"]},{type:"formula",as:"value",expr:"datum.value == 'Yes' || datum.uk_assessed == 'Yes' ? 'Yes' : 'No'"}]}),d.data.unshift({name:"uk_assessed",url:`${this.wikirateApiHost}/~${r[0]}+Answer.json?view=answer_list&limit=0&filter[year]=${i}`}),d.width=u,d.height=c,d.scales[0].range=o,d.scales[0].range.signal=p,o0(l,d,f)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})();function vKe(e,t){1&e&&(B(0,"div",17)(1,"div",18)(2,"div",19)(3,"span",20),Y(4,"Loading..."),$()()()())}let bKe=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartsService=i,this.year="",this.isLoading=!0}ngOnInit(){this.updateData()}updateData(){this.isLoading=!0,this.draw_minimum_requirements_pie_chart("Meet Minimun UK Requirements","div#uk-meet-min-requirements",this.dataProvider.metrics.uk_msa_statement_assessed,this.dataProvider.metrics.meet_uk_min_requirements),this.draw_minimum_requirements_pie_chart("Meet Minimun Australian Requirements","div#aus-meet-min-requirements",this.dataProvider.metrics.aus_msa_statement_assessed,this.dataProvider.metrics.meet_aus_min_requirements),this.chartsService.drawMinimumRequirementsBarChart("Which minimum uk requirements do these companies meet?","div#uk-requirements-bars",350,200,this.dataProvider.metrics.uk_msa_statement_assessed,kDe,this.year,{renderer:"svg",actions:{source:!1,editor:!1}}),this.chartsService.drawMinimumRequirementsBarChart("Which minimum aus requirements do these companies meet?","div#aus-requirements-bars",350,670,this.dataProvider.metrics.aus_msa_statement_assessed,IDe,this.year,{renderer:"svg",actions:{source:!1,editor:!1}})}draw_minimum_requirements_pie_chart(n,i,r,s){this.dataProvider.getAnswers(r,[new st("year",this.year),new st("value","Yes")]).subscribe(o=>{let a=o.length;this.dataProvider.getAnswers(s,[new st("year",this.year),new st("value","Yes")]).subscribe(l=>{let u=l.length;this.chartsService.drawPieChart(n,i,[{value:"Met",count:u,sum_count:a},{value:"Not Met",count:a-u,sum_count:a}],210,180,["#000028","#FF9300"],["Not Met","Met"],{renderer:"svg",actions:{source:!1,editor:!1}})},l=>console.log(l),()=>this.isLoading=!1)})}}return e.\u0275fac=function(n){return new(n||e)(H(Tc),H(_1))},e.\u0275cmp=Mn({type:e,selectors:[["minimum-requirements-section"]],decls:38,vars:8,consts:[[1,"section","mt-5","bg-neutral-grey","p-4"],[1,"row"],[1,"col-md-8"],[1,"title"],[1,"col-md-4"],["aria-label","Minimum requirements year filter",1,"msa-form-select","ms-md-auto","bg-neutral-grey",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row","mt-2","justify-items-center",3,"ngClass"],[1,"col-md-6","p-3"],[1,"row","text-center"],[1,"row","text-center","pt-4"],["id","uk-meet-min-requirements",1,"chart-wrapper"],["id","uk-requirements-bars",1,"chart-wrapper"],["id","aus-meet-min-requirements",1,"chart-wrapper"],["id","aus-requirements-bars",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(B(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),Y(4,"Meeting Minimum Requirements"),$()(),B(5,"div",4)(6,"select",5),Be("ngModelChange",function(s){return i.year=s})("change",function(){return i.updateData()}),B(7,"option",6),Y(8,"all years"),$(),B(9,"option",7),Y(10,"latest"),$(),B(11,"option",7),Y(12,"2021"),$(),B(13,"option",7),Y(14,"2020"),$(),B(15,"option",7),Y(16,"2019"),$()()()(),B(17,"div",1)(18,"p"),Y(19,"Are company statements compliant with the minimum requirements under the UK or Australian Modern Slavery Act?"),$()(),He(20,vKe,5,0,"div",8),B(21,"div",9)(22,"div",10)(23,"div",11)(24,"h4"),Y(25,"UK Act"),$()(),B(26,"div",12),$t(27,"div",13),$(),B(28,"div",12),$t(29,"div",14),$()(),B(30,"div",10)(31,"div",11)(32,"h4"),Y(33,"Australian Act"),$()(),B(34,"div",12),$t(35,"div",15),$(),B(36,"div",12),$t(37,"div",16),$()()()()),2&n&&(ne(6),ae("ngModel",i.year),ne(1),ae("ngValue",""),ne(2),ae("ngValue","latest"),ne(2),ae("ngValue",2021),ne(2),ae("ngValue",2020),ne(2),ae("ngValue",2019),ne(5),ae("ngIf",i.isLoading),ne(1),ae("ngClass",i.isLoading?"hide-element":"show-element"))},directives:[kc,cg,Td,dg,hg,bo,wd],styles:[""]}),e})();const wKe=JSON.parse('[{"seq":1,"id":1831852,"metric":"Business_Human_Rights_Resource_Centre+MSA_statement_signed","label":"Signed by Appropriate Person","short_label":"signed","color":0,"filter_value":["Signed by CEO","Signed by Director","Signed by Managing Director","Signed by Chairman"],"aus_color":"bg-deep-blue","uk_color":"bg-deep-blue"},{"seq":2,"id":1827915,"metric":"Business_Human_Rights_Resource_Centre+MSA_Statement_Approval","label":"Board Approval","short_label":"approved","color":0,"filter_value":["Approved by Board"],"aus_color":"bg-deep-blue","uk_color":"bg-deep-blue"},{"seq":3,"id":12552057,"metric":"Walk_Free+MSA_Statement_Publication","label":"Statement Publication","short_label":"statement_publication","color":0,"filter_value":["Yes"],"aus_color":"bg-deep-blue","uk_color":"bg-deep-blue"},{"seq":4,"id":8772491,"metric":"Walk_Free+MSA_Consultation_Process","label":"Consultation Process","short_label":"consultation_process","color":0,"filter_value":["Yes"],"aus_color":"bg-deep-blue","uk_color":"bg-orange"},{"seq":5,"id":5454264,"metric":"Walk_Free+MSA_registry_submission","label":"Organizational Structure and Operations","short_label":"organizational_structure","color":0,"filter_value":["Yes"],"aus_color":"bg-deep-blue","uk_color":"bg-orange"},{"seq":6,"id":1831908,"metric":"Walk_Free+MSA_supply_chain_disclosure","label":"Supply Chain Disclosure","short_label":"supply_chain_disclosure","color":0,"filter_value":["Geographical","Facility/Supplier"],"aus_color":"bg-deep-blue","uk_color":"bg-orange"},{"seq":7,"id":2722057,"metric":"Walk Free+MSA policy (revised)","label":"Supply Chain Policies","short_label":"policies","color":0,"filter_value":["Suppliers comply with laws and company\u2019s policies (direct / tier 1)","Suppliers comply with laws and company\u2019s policies (beyond tier 1)","Prohibit use of forced labour (direct / tier 1)","Prohibit use of forced labour (beyond tier 1)","Code of conduct or supplier code includes clauses on slavery and human trafficking (direct / tier 1)","Code of conduct or supplier code includes clauses on slavery and human trafficking (beyond tier 1)","Contracts include clauses on forced labour (direct / tier 1)","Contracts include clauses on forced labour (beyond tier 1)","Suppliers produce their own statement (direct / tier 1)","Suppliers produce their own statement (beyond tier 1)","Prohibit charging of recruitment fees to employee (direct / tier 1)","Prohibit charging of recruitment fees to employee (beyond tier 1)","Prohibit use of child labour (direct / tier 1)","Prohibit use of child labour (beyond tier 1)","Suppliers protect migrant workers (direct / tier 1)","Suppliers protect migrant workers (beyond tier 1)","Suppliers respect labour rights (wages / freedom of association etc) (direct / tier 1)","Suppliers respect labour rights (wages / freedom of association etc) (beyond tier 1)"],"aus_color":"bg-orange","uk_color":"bg-orange"},{"seq":8,"id":2722223,"metric":"Walk_Free+MSA_risk_assessment","label":"Risk Assessment","short_label":"risk_assessment","color":0,"filter_value":["Risk-based questionnaires","Use of risk management tool or software","Conducting desk research"],"aus_color":"bg-deep-blue","uk_color":"bg-orange"},{"seq":9,"id":1831932,"metric":"Walk_Free+MSA_Identification_of_risks","label":"Identification of Risks","short_label":"risk_identification","color":0,"filter_value":["Geographic","Resource","Workforce","Industry"],"aus_color":"bg-deep-blue","uk_color":"bg-orange"},{"seq":10,"id":2722169,"metric":"Walk_Free+MSA_risk_management","label":"Risk Management","short_label":"risk_management","color":0,"filter_value":["Audits of suppliers (self- reporting)","Audits of suppliers (independent)","On-site visits (self- reporting)","On-site visits (independent)"],"aus_color":"bg-deep-blue","uk_color":"bg-deep-blue"},{"seq":11,"id":2722458,"metric":"Walk_Free+MSA_whistleblowing_mechanism_revised","label":"Whistleblowing mechanism","short_label":"whistleblowing_mechanism","color":0,"filter_value":["Hotline, Email, Contact Form (direct employees)","Hotline, Email, Contact Form (supply chain workers)","Whistleblower protection (direct employees)","Whistleblower protection (supply chain workers)","Focal Point (direct employees)","Focal Point (supply chain workers)"],"aus_color":"bg-deep-blue","uk_color":"bg-orange"},{"seq":12,"id":1831964,"metric":"Walk Free+MSA incidents identified","label":"Incidents Identification","short_label":"incident_identification","color":0,"filter_value":["Yes"],"aus_color":"bg-orange","uk_color":"bg-orange"},{"seq":13,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"Incidents Remediation","short_label":"incident_remediation","color":0,"filter_value":["Worker remediation","Corrective action plan","Senior management","Cancel contracts"],"aus_color":"bg-deep-blue","uk_color":"bg-orange"},{"seq":14,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Modern Slavery Training","short_label":"training","color":0,"filter_value":["Employees (all)","Procurement / purchasing","Recruitment / HR","Leadership","Suppliers","Training provided - not specified to who"],"aus_color":"bg-orange","uk_color":"bg-orange"},{"seq":15,"id":1832024,"metric":"Walk_Free+MSA_Performance_Indicators","label":"Key Performance Indicators","short_label":"kpis","color":0,"filter_value":["Yes"],"aus_color":"bg-deep-blue","uk_color":"bg-orange"},{"seq":16,"id":1832012,"metric":"Walk_Free+MSA_Business_Performance_Indicators","label":"Business Performance Indicators","short_label":"business_kpis","color":0,"filter_value":["Yes"],"aus_color":"bg-orange","uk_color":"bg-orange"}]');function DKe(e,t){1&e&&(B(0,"div",25)(1,"div",26)(2,"div",27)(3,"span",28),Y(4,"Loading..."),$()()()())}function CKe(e,t){if(1&e){const n=function ta(){return re()}();B(0,"tr",29)(1,"td",30)(2,"a",31),Y(3),$()(),B(4,"td",32),Be("click",function(){const s=ks(n).$implicit;return Mt().openURL(s.url)}),Y(5),$(),B(6,"td",33),Be("click",function(){const s=ks(n).$implicit;return Mt().openURL(s.url)}),Y(7),$(),B(8,"td",33),Be("click",function(){const s=ks(n).$implicit;return Mt().openURL(s.url)}),Y(9),$()()}if(2&e){const n=t.$implicit;ne(2),Mb("href",n.url,_b),ne(1),Kp(n.name),ne(2),mo("",n.total,"%"),ne(1),RO("col-2 clickable text-center ",n.uk_color,""),ne(1),mo("",n.uk,"%"),ne(1),RO("col-2 clickable text-center ",n.aus_color,""),ne(1),mo("",n.aus,"%")}}const Xx=function(e){return{active:e}};let EKe=(()=>{class e{constructor(n){this.dataProvider=n,this.year="",this.beyond_compliance_table_data=[],this.active="name",this.isLoading=!0}ngOnInit(){this.updateData()}updateData(){this.active="name",this.beyond_compliance_table_data=[],this.isLoading=!0,this.dataProvider.getAnswers(this.dataProvider.metrics.uk_msa_statement_assessed,[new st("year",this.year),new st("value","Yes")]).subscribe(n=>{let i=n.map(r=>({company:r.company,year:r.year}));this.dataProvider.getAnswers(this.dataProvider.metrics.aus_msa_statement_assessed,[new st("year",this.year),new st("value","Yes")]).subscribe(r=>{let s=r.map(a=>({company:a.company,year:a.year})),o=[...new Set([...i,...s])];for(let a of wKe)this.dataProvider.getAnswers(a.id,[new st("year",this.year),new st("value",a.filter_value)]).subscribe(l=>{let u=0,c=0,f=0;for(let m of l){let _=void 0!==i.find(v=>v.company==m.company&&v.year==m.year),y=void 0!==s.find(v=>v.company==m.company&&v.year==m.year);_&&u++,y&&c++,(_||y)&&f++}let d=Math.round(100*u/i.length),h=Math.round(100*c/s.length),p=Math.round(100*f/o.length),g="";for(let m of a.filter_value)g+="filter[value][]="+m+"&";this.beyond_compliance_table_data.push({name:a.label,url:"https://wikirate.org/"+a.metric+"?filter[year]="+this.year+"&"+g.substring(0,g.length+1),uk:d,aus:h,total:p,aus_color:a.aus_color,uk_color:a.uk_color})},l=>console.log(l),()=>{this.sort("total"),this.isLoading=!1})})})}sort(n){this.beyond_compliance_table_data.sort((i,r)=>i[n]>r[n]?-1:0),this.active=n}openURL(n){window.open(n,"_blank")}}return e.\u0275fac=function(n){return new(n||e)(H(Tc))},e.\u0275cmp=Mn({type:e,selectors:[["going-beyond-compliance"]],decls:79,vars:21,consts:[[1,"section","mt-5","bg-neutral-orange","p-4"],[1,"row"],[1,"col-md-8"],[1,"title"],[1,"col-md-4"],["aria-label","Minimum requirements year filter",1,"msa-form-select","ms-md-auto","bg-neutral-orange",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],[1,"col-md-12"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row","p-4","row","justify-content-center",3,"ngClass"],[1,"col-md-11"],[1,"table","table-bordered","border-light"],[1,"bg-light-orange"],["scope","col",1,"clickable-header","text-end",3,"ngClass","click"],["scope","col",1,"text-center","clickable-header","active",3,"ngClass","click"],["scope","col",1,"text-center","clickable-header",3,"ngClass","click"],["class","text-white",4,"ngFor","ngForOf"],[1,"row","align-middle","p-3"],[1,"col-3"],[1,"msa-primary-info-md"],[1,"highlighted-number"],[1,"col-6"],[1,"col-3","text-center"],[1,"button","transparent-button","mt-md-0","mt-3"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"],[1,"text-white"],[1,"col-6","text-end","bg-neutral-blue"],["target","_blank",1,"metric",3,"href"],[1,"col-2","clickable","text-center","bg-deep-blue",3,"click"],[3,"click"]],template:function(n,i){1&n&&(B(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),Y(4,"Going Beyond Compliance"),$()(),B(5,"div",4)(6,"select",5),Be("ngModelChange",function(s){return i.year=s})("change",function(){return i.updateData()}),B(7,"option",6),Y(8,"all years"),$(),B(9,"option",6),Y(10,"latest"),$(),B(11,"option",7),Y(12,"2021"),$(),B(13,"option",7),Y(14,"2020"),$(),B(15,"option",7),Y(16,"2019"),$()()(),B(17,"div",1)(18,"div",8)(19,"p"),Y(20,"Beyond minimum requirements, the accompanying guidance of the MSAs outlines the measures and actions companies should take to ensure their operations and supply chains are free from exploitation."),$()()()(),He(21,DKe,5,0,"div",9),B(22,"div",10)(23,"div",11)(24,"table",12)(25,"thead")(26,"tr",13)(27,"th",14),Be("click",function(){return i.sort("name")}),Y(28,"Metric "),$(),B(29,"th",15),Be("click",function(){return i.sort("total")}),Y(30,"Total "),$(),B(31,"th",16),Be("click",function(){return i.sort("uk")}),Y(32,"UK "),$(),B(33,"th",16),Be("click",function(){return i.sort("aus")}),Y(34,"AUS "),$()()(),B(35,"tbody"),He(36,CKe,10,11,"tr",17),$()()()(),B(37,"div",1)(38,"div",2)(39,"h3",3),Y(40,"Disclosure Rate"),$(),B(41,"p"),Y(42,"Average number of measures and actions reported by companies in their modern slavery statements."),$()()(),B(43,"div",18)(44,"div",19)(45,"div",20)(46,"span",21),Y(47,"6"),$(),Y(48,"/16"),$()(),B(49,"div",22)(50,"div",20),Y(51,"Garment Industry"),$()(),B(52,"div",23)(53,"a",24),Y(54,"More"),$()()(),B(55,"div",18)(56,"div",19)(57,"div",20)(58,"span",21),Y(59,"3"),$(),Y(60,"/16"),$()(),B(61,"div",22)(62,"div",20),Y(63,"Finance Industry"),$()(),B(64,"div",23)(65,"a",24),Y(66,"More"),$()()(),B(67,"div",18)(68,"div",19)(69,"div",20)(70,"span",21),Y(71,"5"),$(),Y(72,"/16"),$()(),B(73,"div",22)(74,"div",20),Y(75,"Hospitality Industry"),$()(),B(76,"div",23)(77,"a",24),Y(78,"More"),$()()()()),2&n&&(ne(6),ae("ngModel",i.year),ne(1),ae("ngValue",""),ne(2),ae("ngValue","latest"),ne(2),ae("ngValue",2021),ne(2),ae("ngValue",2020),ne(2),ae("ngValue",2019),ne(6),ae("ngIf",i.isLoading),ne(1),ae("ngClass",i.isLoading?"hide-element":"show-element"),ne(5),ae("ngClass",Cc(13,Xx,"name"===i.active)),ne(2),ae("ngClass",Cc(15,Xx,"total"===i.active)),ne(2),ae("ngClass",Cc(17,Xx,"uk"===i.active)),ne(2),ae("ngClass",Cc(19,Xx,"aus"===i.active)),ne(3),ae("ngForOf",i.beyond_compliance_table_data))},directives:[kc,cg,Td,dg,hg,bo,wd,rg],styles:[".metric[_ngcontent-%COMP%]{font-size:1.2em}"]}),e})();const SKe=JSON.parse('[{"seq":1,"id":12616892,"metric":"Walk Free+MSA policy (grouped)","label":"Direct supply chain","short_label":"direct_supply_chain","color":0,"filter_value":["Direct Supply Chain","Both"]},{"seq":2,"id":12616892,"metric":"Walk Free+MSA policy (grouped)","label":"Beyond tier 1 supply chain","short_label":"beyond_t1","color":0,"filter_value":["Beyond Tier 1 Supply Chain","Both"]},{"seq":3,"id":12616892,"metric":"Walk Free+MSA policy (grouped)","label":"Both","short_label":"both","color":3,"filter_value":["Both"]},{"seq":4,"id":12616892,"metric":"Walk Free+MSA policy (grouped)","label":"None of the above","short_label":"none_of_the_above","color":1,"filter_value":["Neither","Unknown"]}]');function xKe(e,t){1&e&&(B(0,"div",6)(1,"div",7)(2,"div",8)(3,"span",9),Y(4,"Loading..."),$()()()())}let AKe=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartsService=i,this.isLoading=!0}ngOnInit(){}ngOnChanges(n){this.updateData()}updateData(){this.isLoading=!0,this.chartsService.drawBarChart("Modern Slavery Supply Chain Policies","div#modern-slavery-supply-chain-policies",350,250,[this.dataProvider.metrics.uk_msa_statement_assessed,this.dataProvider.metrics.aus_msa_statement_assessed],SKe,this.year,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>this.isLoading=!1)}}return e.\u0275fac=function(n){return new(n||e)(H(Tc),H(_1))},e.\u0275cmp=Mn({type:e,selectors:[["approach-to-policies"]],inputs:{year:"year"},features:[ni],decls:16,vars:2,consts:[["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row",3,"ngClass"],[1,"col-md-12"],[1,"row"],[1,"row","text-center","pt-2"],["id","modern-slavery-supply-chain-policies",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(He(0,xKe,5,0,"div",0),B(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5"),Y(5,"MODERN SLAVERY SUPPLY CHAIN POLICIES"),$(),B(6,"p"),Y(7,"Does the company's statement detail clear, organisational modern slavery policies that apply to their "),B(8,"b"),Y(9,"direct"),$(),Y(10," and/or "),B(11,"b"),Y(12,"beyond tier 1"),$(),Y(13," supply chain?"),$()(),B(14,"div",4),$t(15,"div",5),$()()()),2&n&&(ae("ngIf",i.isLoading),ne(1),ae("ngClass",i.isLoading?"hide-element":"show-element"))},directives:[bo,wd],styles:[""]}),e})();const TKe=JSON.parse('[{"seq":1,"id":6948985,"metric":"Walk Free+MSA risk assessment","label":"Risk-based questionnaires","short_label":"risk_based_questionnaires","color":0,"filter_value":["Risk-based questionnaires"]},{"seq":2,"id":6948985,"metric":"Walk Free+MSA risk assessment","label":"Use of risk management tool or software","short_label":"use_of_risk_mng_tool","color":0,"filter_value":["Use of risk management tool or software"]},{"seq":3,"id":6948985,"metric":"Walk Free+MSA risk assessment","label":"Conducting desk research","short_label":"desk_research","color":0,"filter_value":["Conducting research"]},{"seq":4,"id":6948985,"metric":"Walk Free+MSA risk assessment","label":"None of the above","short_label":"none_of_the_above","color":1,"filter_value":["None"]}]'),OKe=JSON.parse('[{"seq":1,"id":6949027,"metric":"Walk_Free+MSA_Identification_of_risks","label":"Geographic/Risk Region","short_label":"geographic","color":0,"filter_value":["Geographic"]},{"seq":2,"id":6949027,"metric":"Walk_Free+MSA_Identification_of_risks","label":"Industry Risk","short_label":"industry","color":0,"filter_value":["Industry"]},{"seq":3,"id":6949027,"metric":"Walk_Free+MSA_Identification_of_risks","label":"Resource Risk","short_label":"resource","color":0,"filter_value":["Resource"]},{"seq":4,"id":6949027,"metric":"Walk_Free+MSA_Identification_of_risks","label":"Workforce Risk","short_label":"workforce_risk","color":0,"filter_value":["Workforce"]},{"seq":5,"id":6949027,"metric":"Walk_Free+MSA_Identification_of_risks","label":"None of the above","short_label":"none_of_the_above","color":1,"filter_value":["None"]}]');function MKe(e,t){1&e&&(B(0,"div",10)(1,"div",11)(2,"div",12)(3,"span",13),Y(4,"Loading..."),$()()()())}let NKe=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartsService=i,this.isLoading=!0}ngOnChanges(n){this.updateData()}ngOnInit(){}updateData(){this.isLoading=!0,this.chartsService.drawBarChart("Risk Assessment","div#risk-assessment",350,200,[this.dataProvider.metrics.uk_msa_statement_assessed,this.dataProvider.metrics.aus_msa_statement_assessed],TKe,this.year,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.chartsService.drawBarChart("Risks identified by risk category","div#risk-identification",350,250,[this.dataProvider.metrics.uk_msa_statement_assessed,this.dataProvider.metrics.aus_msa_statement_assessed],OKe,this.year,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>this.chartsService.drawSubgroupsBarChart("Risks Management","div#risk-management",350,[this.dataProvider.metrics.uk_msa_statement_assessed,this.dataProvider.metrics.aus_msa_statement_assessed],6948944,{name:"subgroups",values:[{key:"(self- reporting)",label:"Self reporting",color:0,seq:1},{key:"(independent)",label:"Independent",color:1,seq:2}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},{name:"groups",values:[{title:"Audits of suppliers",term:"Audits of suppliers",seq:1},{title:"On-site visits",term:"On-site visits",seq:2},{title:"Neither",term:"Neither",seq:3}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},this.year,{renderer:"svg",actions:{source:!1,editor:!0}})).finally(()=>this.isLoading=!1)})}}return e.\u0275fac=function(n){return new(n||e)(H(Tc),H(_1))},e.\u0275cmp=Mn({type:e,selectors:[["approach-to-risks"]],inputs:{year:"year"},features:[ni],decls:27,vars:3,consts:[["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row",3,"ngClass"],[1,"col-md-6"],[1,"row"],[1,"row","text-center","pt-2"],["id","risk-assessment",1,"chart-wrapper"],["id","risk-identification",1,"chart-wrapper"],[1,"row","justify-content-md-center","mt-md-3",3,"ngClass"],[1,"row","text-md-center"],["id","risk-management",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(He(0,MKe,5,0,"div",0),B(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5"),Y(5,"RISK ASSESSMENT TOOLS"),$(),B(6,"p"),Y(7,"used to identify high risk factors in operations"),$()(),B(8,"div",4),$t(9,"div",5),$()(),B(10,"div",2)(11,"div",3)(12,"h5"),Y(13,"TYPES OF RISKS IDENTIFIED"),$(),B(14,"p"),Y(15,"as likely to occur within operations"),$()(),B(16,"div",4),$t(17,"div",6),$()()(),B(18,"div",7)(19,"div",2)(20,"div",8)(21,"h5"),Y(22,"RISK MANAGEMENT SYSTEM"),$(),B(23,"p"),Y(24,"used to keep an eye on (high risk) operations"),$()(),B(25,"div",4),$t(26,"div",9),$()()()),2&n&&(ae("ngIf",i.isLoading),ne(1),ae("ngClass",i.isLoading?"hide-element":"show-element"),ne(17),ae("ngClass",i.isLoading?"hide-element":"show-element"))},directives:[bo,wd],styles:[""]}),e})();const kKe=JSON.parse('[{"seq":1,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"Worker remediation","short_label":"worker_remediation","color":0,"filter_value":["Worker remediation"]},{"seq":2,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"Incidents remediation","short_label":"corrective_action_plan","color":0,"filter_value":["Corrective action plan"]},{"seq":3,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"Senior management","short_label":"senior_management","color":0,"filter_value":["Senior management"]},{"seq":4,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"Cancel contracts","short_label":"cancel_contracts","color":0,"filter_value":["Cancel contracts"]},{"seq":5,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"None of the Above","short_label":"none_of_the_above","color":1,"filter_value":["In Development","No"]}]'),IKe=JSON.parse('[{"seq":1,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Employees (all)","short_label":"employees","color":0,"filter_value":["Employees (all)"]},{"seq":2,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Procurement / purchasing","short_label":"procurement","color":0,"filter_value":["Procurement / purchasing"]},{"seq":3,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Recruitment / HR","short_label":"recruitment","color":0,"filter_value":["Recruitment / HR"]},{"seq":4,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Leadership","short_label":"leadership","color":0,"filter_value":["Leadership"]},{"seq":5,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Suppliers","short_label":"suppliers","color":0,"filter_value":["Suppliers"]},{"seq":6,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Training provided - not specified to who","short_label":"training_provided","color":0,"filter_value":["Training provided - not specified"]},{"seq":7,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Any of the above","short_label":"any_of_the_above","color":3,"filter_value":["Training provided - not specified","Suppliers","Leadership","Recruitment / HR","Procurement / purchasing","Employees (all)"]}]');function RKe(e,t){1&e&&(B(0,"div",10)(1,"div",11)(2,"div",12)(3,"span",13),Y(4,"Loading..."),$()()()())}let FKe=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartsService=i,this.isLoading=!0}ngOnInit(){}ngOnChanges(n){this.updateData()}updateData(){this.isLoading=!0,this.chartsService.drawSubgroupsBarChart("Whistleblowing or Grievance Mechanisms","div#whistleblowing-mechanisms",300,[this.dataProvider.metrics.uk_msa_statement_assessed,this.dataProvider.metrics.aus_msa_statement_assessed],2722458,{name:"subgroups",values:[{key:"(direct employees)",label:"Direct employees",color:0,seq:1},{key:"(supply chain workers)",label:"Supply chain workers",color:1,seq:2},{key:"",label:"Direct employees",color:2,seq:3}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},{name:"groups",values:[{title:"Whistleblower protection",term:"Whistleblower protection",seq:1},{title:"Hotline, Email, Contact Form",term:"Hotline",seq:2},{title:"Focal Point",term:"Focal Point",seq:3},{title:"None of the Above",term:"No",seq:3}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},this.year,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.chartsService.drawBarChart("Incidents Remediation","div#incident-remediation",350,250,[this.dataProvider.metrics.uk_msa_statement_assessed,this.dataProvider.metrics.aus_msa_statement_assessed],kKe,this.year,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.chartsService.drawBarChart("Modern Slavery Training","div#training",350,350,[this.dataProvider.metrics.uk_msa_statement_assessed,this.dataProvider.metrics.aus_msa_statement_assessed],IKe,this.year,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.isLoading=!1})})})}}return e.\u0275fac=function(n){return new(n||e)(H(Tc),H(_1))},e.\u0275cmp=Mn({type:e,selectors:[["approach-to-incidents"]],inputs:{year:"year"},features:[ni],decls:27,vars:3,consts:[["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row",3,"ngClass"],[1,"col-md-6"],[1,"row"],[1,"row","text-center","pt-2"],["id","training",1,"chart-wrapper"],["id","whistleblowing-mechanisms",1,"chart-wrapper"],[1,"row","justify-content-md-center",3,"ngClass"],[1,"row","text-md-center"],["id","incident-remediation",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(He(0,RKe,5,0,"div",0),B(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5"),Y(5,"MODERN SLAVERY TRAINING"),$(),B(6,"p"),Y(7,"provided to increase chances of staff identifying incidents and avoiding practices that increase chances of incidents occuring "),$()(),B(8,"div",4),$t(9,"div",5),$()(),B(10,"div",2)(11,"div",3)(12,"h5"),Y(13,"GRIEVANCE MECHANISMS"),$(),B(14,"p"),Y(15,"provided to increase likelihood of incidents being reported"),$()(),B(16,"div",4),$t(17,"div",6),$()()(),B(18,"div",7)(19,"div",2)(20,"div",8)(21,"h5"),Y(22,"REMEDIATION STRATEGY"),$(),B(23,"p"),Y(24,"deployed when specific incidents are identified"),$()(),B(25,"div",4),$t(26,"div",9),$()()()),2&n&&(ae("ngIf",i.isLoading),ne(1),ae("ngClass",i.isLoading?"hide-element":"show-element"),ne(17),ae("ngClass",i.isLoading?"hide-element":"show-element"))},directives:[bo,wd],styles:[""]}),e})();function PKe(e,t){1&e&&(B(0,"div",29)(1,"div",30)(2,"div",31)(3,"span",32),Y(4,"Loading..."),$()()()())}let LKe=(()=>{class e{constructor(n){this.dataProvider=n,this.year="",this.percentage_of_companies_identified_incidents=0,this.percentage_of_companies_report_policy_beyond_t1=0,this.percentage_of_companies_identified_risks=0,this.isLoading=!0}ngOnInit(){this.updateData()}updateData(){this.isLoading=!0,this.dataProvider.getAnswers(this.dataProvider.metrics.aus_msa_statement_assessed,[new st("year",this.year),new st("value","Yes")]).subscribe(n=>{let i=n.map(r=>r.company);this.dataProvider.getAnswers(this.dataProvider.metrics.uk_msa_statement_assessed,[new st("year",this.year),new st("value","Yes")]).subscribe(r=>{let s=[...new Set([...i,...r.map(o=>o.company)])];this.dataProvider.getAnswers(1831964,[new st("year",this.year),new st("value","Yes")]).subscribe(o=>{o=o.filter(a=>s.includes(a.company)),this.percentage_of_companies_identified_incidents=Math.round(100*o.length/s.length),this.dataProvider.getAnswers(6916242,[new st("year",this.year),new st("value","Yes")]).subscribe(a=>{a=a.filter(l=>s.includes(l.company)),this.percentage_of_companies_identified_risks=Math.round(100*a.length/s.length),this.dataProvider.getAnswers(6915846,[new st("year",this.year),new st("value","Yes")]).subscribe(l=>{l=l.filter(u=>s.includes(u.company)),this.percentage_of_companies_report_policy_beyond_t1=Math.round(100*l.length/s.length)})})},o=>{console.log(o)},()=>this.isLoading=!1)})})}}return e.\u0275fac=function(n){return new(n||e)(H(Tc))},e.\u0275cmp=Mn({type:e,selectors:[["further-findings"]],decls:80,vars:15,consts:[[1,"section","mt-5","bg-neutral-grey","p-4"],[1,"row"],[1,"col-md-8"],[1,"title"],[1,"col-md-4"],["aria-label","Minimum requirements year filter",1,"msa-form-select","ms-md-auto","bg-neutral-grey",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row","mt-3","mb-3",3,"ngClass"],[1,"col-md-4","pe-md-2"],[1,"msa-primary-info"],[1,"dive-deeper",3,"ngClass"],[1,"row","mt-3"],["id","approach_to_policies",1,"accordion"],[1,"accordion-item"],["id","approachToPoliciesTitle",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#approach-to-policies","aria-expanded","false","aria-controls","collapseThree",1,"accordion-button","collapsed"],["id","approach-to-policies","aria-labelledby","approachToPoliciesTitle","data-bs-parent","#approach_to_policies",1,"accordion-collapse","collapse"],[1,"accordion-body"],[3,"year"],["id","approach_to_risks_accordion",1,"accordion"],["id","headingThree",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#collapseThree","aria-expanded","false","aria-controls","collapseThree",1,"accordion-button","collapsed"],["id","collapseThree","aria-labelledby","headingThree","data-bs-parent","#approach_to_risks_accordion",1,"accordion-collapse","collapse"],["id","approach_to_incidents",1,"accordion"],["id","headingApproachToIncidents",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#collapseApproachToIncidents","aria-expanded","false","aria-controls","collapseApproachToIncidents",1,"accordion-button","collapsed"],["id","collapseApproachToIncidents","aria-labelledby","headingApproachToIncidents","data-bs-parent","#approach_to_incidents",1,"accordion-collapse","collapse"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(B(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),Y(4,"Further Findings"),$()(),B(5,"div",4)(6,"select",5),Be("ngModelChange",function(s){return i.year=s})("change",function(){return i.updateData()}),B(7,"option",6),Y(8,"all years"),$(),B(9,"option",7),Y(10,"latest"),$(),B(11,"option",7),Y(12,"2021"),$(),B(13,"option",7),Y(14,"2020"),$(),B(15,"option",7),Y(16,"2019"),$()()()(),He(17,PKe,5,0,"div",8),B(18,"div",9)(19,"div",10)(20,"div",1)(21,"div",11),Y(22),$()(),B(23,"div",1)(24,"p"),Y(25,"of companies report having a modern slavery "),B(26,"b"),Y(27,"policy that applies to stakeholder beyond the 1st tier"),$(),Y(28," of their supply chain"),$()()(),B(29,"div",4)(30,"div",1)(31,"div",11),Y(32),$()(),B(33,"div",1)(34,"p"),Y(35,"of companies have "),B(36,"b"),Y(37,"identified risks likely to occur"),$(),Y(38," within operations"),$()()(),B(39,"div",10)(40,"div",1)(41,"div",11),Y(42),$()(),B(43,"div",1)(44,"p"),Y(45,"of companies have "),B(46,"b"),Y(47,"identified a specific incident of modern slavery"),$(),Y(48," in their own and/or supply chain operations"),$()()()(),B(49,"div",12)(50,"div",13)(51,"div",14)(52,"div",15)(53,"h2",16)(54,"button",17)(55,"h4"),Y(56,"Approach to policies"),$()()(),B(57,"div",18)(58,"div",19),$t(59,"approach-to-policies",20),$()()()()(),B(60,"div",13)(61,"div",21)(62,"div",15)(63,"h2",22)(64,"button",23)(65,"h4"),Y(66,"Approach to risks"),$()()(),B(67,"div",24)(68,"div",19),$t(69,"approach-to-risks",20),$()()()()(),B(70,"div",13)(71,"div",25)(72,"div",15)(73,"h2",26)(74,"button",27)(75,"h4"),Y(76,"Approach to incidents"),$()()(),B(77,"div",28)(78,"div",19),$t(79,"approach-to-incidents",20),$()()()()()()()),2&n&&(ne(6),ae("ngModel",i.year),ne(1),ae("ngValue",""),ne(2),ae("ngValue","latest"),ne(2),ae("ngValue",2021),ne(2),ae("ngValue",2020),ne(2),ae("ngValue",2019),ne(2),ae("ngIf",i.isLoading),ne(1),ae("ngClass",i.isLoading?"hide-element":"show-element"),ne(4),mo("",i.percentage_of_companies_report_policy_beyond_t1,"%"),ne(10),mo("",i.percentage_of_companies_identified_risks,"%"),ne(10),mo("",i.percentage_of_companies_identified_incidents,"%"),ne(7),ae("ngClass",i.isLoading?"hide-element":"show-element"),ne(10),ae("year",i.year),ne(10),ae("year",i.year),ne(10),ae("year",i.year))},directives:[kc,cg,Td,dg,hg,bo,wd,AKe,NKe,FKe],styles:[""]}),e})();const jKe=[{path:"dashboard/:sector",component:(()=>{class e{constructor(n,i){this.route=n,this.sectorProvider=i,this.sector="all-sectors"}ngOnInit(){this.route.paramMap.subscribe(n=>{let i=n.get("sector");null!==i&&i!=this.sector&&(this.sector=i),this.sectorProvider.getSector().next(i)})}}return e.\u0275fac=function(n){return new(n||e)(H(Ed),H(dN))},e.\u0275cmp=Mn({type:e,selectors:[["dashboard"]],decls:7,vars:2,consts:[[1,"container"],[3,"sector"]],template:function(n,i){1&n&&(B(0,"div",0),$t(1,"introductory-section",1)(2,"key-findings-section",1)(3,"treemap")(4,"minimum-requirements-section")(5,"going-beyond-compliance")(6,"further-findings"),$()),2&n&&(ne(1),ae("sector",i.sector),ne(1),ae("sector",i.sector))},directives:[gwe,MDe,NDe,bKe,EKe,LKe],styles:[""]}),e})()},{path:"about",component:(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Mn({type:e,selectors:[["about"]],decls:26,vars:0,consts:[[1,"container"],[1,"section"],[1,"title","mt-5"],[1,"subtitle","mt-3"],[1,"section","row"],[1,"col-md-7","bg-neutral-orange","p-3"],[1,"content"],[1,"col-md-4","bg-neutral-grey","ms-md-3","p-3","mt-3","mt-md-0"]],template:function(n,i){1&n&&(B(0,"div",0)(1,"div",1)(2,"h1",2),Y(3," Who we are "),$(),B(4,"div",3),Y(5,"Modern slavery represents a tragic market failure, where some companies maintain competitive advantage and large profits through unethical and unsustainable business practices that rely on the exploitation of workers. "),$()(),B(6,"div",4)(7,"div",5)(8,"h3"),Y(9,"Coming Together"),$(),B(10,"div",6)(11,"p"),Y(12," In 2020, Walk Free, WikiRate, and the Business & Human Rights Resource Centre assessed the statements produced by 79 asset managers identified as having to report under the MSA. These statements were assessed against: "),$(),B(13,"ul")(14,"li"),Y(15,"minimum compliance requirements as set forth under Section 54,"),$(),B(16,"li"),Y(17,"metrics derived from the Home Office statutory reporting guidance accompanying the Act, and"),$(),B(18,"li"),Y(19,"metrics used to assess whether asset managers are considering modern slavery risks in their investment portfolios. "),$()()()(),B(20,"div",7)(21,"h3"),Y(22,"Another Title"),$(),B(23,"div",6)(24,"p"),Y(25," In 2020, Walk Free, WikiRate, and the Business & Human Rights Resource Centre assessed the statements produced by 79 asset managers identified as having to report under the MSA. These statements were assessed against: "),$()()()()())},styles:[""]}),e})()},{path:"**",redirectTo:"/dashboard/all-sectors",pathMatch:"full"}];let BKe=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({imports:[[F7.forRoot(jKe)],F7]}),e})();const $Ke=["addListener","removeListener"],VKe=["addEventListener","removeEventListener"],HKe=["on","off"];function Xr(e,t,n,i){if(qe(n)&&(i=n,n=void 0),i)return Xr(e,t,n).pipe(UM(i));const[r,s]=function GKe(e){return qe(e.addEventListener)&&qe(e.removeEventListener)}(e)?VKe.map(o=>a=>e[o](t,a,n)):function UKe(e){return qe(e.addListener)&&qe(e.removeListener)}(e)?$Ke.map($ae(e,t)):function zKe(e){return qe(e.on)&&qe(e.off)}(e)?HKe.map($ae(e,t)):[];if(!r&&LA(e))return ti(o=>Xr(o,t,n))(Zi(e));if(!r)throw new TypeError("Invalid event target");return new rn(o=>{const a=(...l)=>o.next(1<l.length?l:l[0]);return r(a),()=>s(a)})}function $ae(e,t){return n=>i=>e[n](t,i)}class WKe extends Yn{constructor(t,n){super()}schedule(t,n=0){return this}}const Qx={setInterval(e,t,...n){const{delegate:i}=Qx;return(null==i?void 0:i.setInterval)?i.setInterval(e,t,...n):setInterval(e,t,...n)},clearInterval(e){const{delegate:t}=Qx;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},Vae={now:()=>(Vae.delegate||Date).now(),delegate:void 0};class y1{constructor(t,n=y1.now){this.schedulerActionCtor=t,this.now=n}schedule(t,n=0,i){return new this.schedulerActionCtor(this,t).schedule(i,n)}}y1.now=Vae.now;const KKe=new class YKe extends y1{constructor(t,n=y1.now){super(t,n),this.actions=[],this._active=!1,this._scheduled=void 0}flush(t){const{actions:n}=this;if(this._active)return void n.push(t);let i;this._active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=n.shift());if(this._active=!1,i){for(;t=n.shift();)t.unsubscribe();throw i}}}(class qKe extends WKe{constructor(t,n){super(t,n),this.scheduler=t,this.work=n,this.pending=!1}schedule(t,n=0){if(this.closed)return this;this.state=t;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,n)),this.pending=!0,this.delay=n,this.id=this.id||this.requestAsyncId(r,this.id,n),this}requestAsyncId(t,n,i=0){return Qx.setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,n,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return n;Qx.clearInterval(n)}execute(t,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,n);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,n){let r,i=!1;try{this.work(t)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:t,scheduler:n}=this,{actions:i}=n;this.work=this.state=this.scheduler=null,this.pending=!1,Tt(i,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,super.unsubscribe()}}});const{isArray:XKe}=Array;function Uae(e){return 1===e.length&&XKe(e[0])?e[0]:e}function Zx(...e){const t=B1(e),n=Uae(e);return n.length?new rn(i=>{let r=n.map(()=>[]),s=n.map(()=>!1);i.add(()=>{r=s=null});for(let o=0;!i.closed&&o<n.length;o++)Zi(n[o]).subscribe(_n(i,a=>{if(r[o].push(a),r.every(l=>l.length)){const l=r.map(u=>u.shift());i.next(t?t(...l):l),r.some((u,c)=>!u.length&&s[c])&&i.complete()}},()=>{s[o]=!0,!r[o].length&&i.complete()}));return()=>{r=s=null}}):Wo}function Ei(e){return Kn((t,n)=>{Zi(e).subscribe(_n(n,()=>n.complete(),su)),!n.closed&&t.subscribe(n)})}function o5(...e){const t=B1(e);return Kn((n,i)=>{const r=e.length,s=new Array(r);let o=e.map(()=>!1),a=!1;for(let l=0;l<r;l++)Zi(e[l]).subscribe(_n(i,u=>{s[l]=u,!a&&!o[l]&&(o[l]=!0,(a=o.every(lu))&&(o=null))},su));n.subscribe(_n(i,l=>{if(a){const u=[l,...s];i.next(t?t(...u):u)}}))})}new rn(su),Math,Math,Math;const gXe=["*"],IXe=["dialog"];function np(e){return null!=e}function d0(e){return(e||document.body).getBoundingClientRect()}const ule={animation:!0,transitionTimerDelayMs:5},TQe=()=>{},{transitionTimerDelayMs:OQe}=ule,S1=new Map,Qr=(e,t,n,i)=>{let r=i.context||{};const s=S1.get(t);if(s)switch(i.runningTransition){case"continue":return Wo;case"stop":e.run(()=>s.transition$.complete()),r=Object.assign(s.context,r),S1.delete(t)}const o=n(t,i.animation,r)||TQe;if(!i.animation||"none"===window.getComputedStyle(t).transitionProperty)return e.run(()=>o()),Ge(void 0).pipe(function xQe(e){return t=>new rn(n=>t.subscribe({next:o=>e.run(()=>n.next(o)),error:o=>e.run(()=>n.error(o)),complete:()=>e.run(()=>n.complete())}))}(e));const a=new On,l=new On,u=a.pipe(function ZKe(...e){return t=>h_(t,Ge(...e))}(!0));S1.set(t,{transition$:a,complete:()=>{l.next(),l.complete()},context:r});const c=function AQe(e){const{transitionDelay:t,transitionDuration:n}=window.getComputedStyle(e);return 1e3*(parseFloat(t)+parseFloat(n))}(t);return e.runOutsideAngular(()=>{const f=Xr(t,"transitionend").pipe(Ei(u),ns(({target:h})=>h===t));(function zae(...e){return 1===(e=Uae(e)).length?Zi(e[0]):new rn(function QKe(e){return t=>{let n=[];for(let i=0;n&&!t.closed&&i<e.length;i++)n.push(Zi(e[i]).subscribe(_n(t,r=>{if(n){for(let s=0;s<n.length;s++)s!==i&&n[s].unsubscribe();n=null}t.next(r)})))}}(e))})(function r5(e=0,t,n=KKe){let i=-1;return null!=t&&(g$(t)?n=t:i=t),new rn(r=>{let s=function JKe(e){return e instanceof Date&&!isNaN(e)}(e)?+e-n.now():e;s<0&&(s=0);let o=0;return n.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}(c+OQe).pipe(Ei(u)),f,l).pipe(Ei(u)).subscribe(()=>{S1.delete(t),e.run(()=>{o(),a.next(),a.complete()})})}),a.asObservable()};let sA=(()=>{class e{constructor(){this.animation=ule.animation}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Te({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),gle=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({imports:[[Ps]]}),e})(),mle=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({imports:[[Ps]]}),e})(),yle=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({}),e})(),wle=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({imports:[[Ps]]}),e})(),Dle=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({}),e})();var Si=(()=>(function(e){e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.ArrowLeft=37]="ArrowLeft",e[e.ArrowUp=38]="ArrowUp",e[e.ArrowRight=39]="ArrowRight",e[e.ArrowDown=40]="ArrowDown"}(Si||(Si={})),Si))();"undefined"!=typeof navigator&&navigator.userAgent&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2||/Android/.test(navigator.userAgent));const Ele=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");function Sle(e){const t=Array.from(e.querySelectorAll(Ele)).filter(n=>-1!==n.tabIndex);return[t[0],t[t.length-1]]}new Date(1882,10,12),new Date(2174,10,25);let Ile=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({imports:[[Ps,nz]]}),e})(),E5=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275dir=me({type:e,selectors:[["",8,"navbar"]]}),e})(),Ple=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({}),e})();class op{constructor(t,n,i){this.nodes=t,this.viewRef=n,this.componentRef=i}}let DZe=(()=>{class e{constructor(n,i){this._el=n,this._zone=i}ngOnInit(){this._zone.onStable.asObservable().pipe(Hi(1)).subscribe(()=>{Qr(this._zone,this._el.nativeElement,(n,i)=>{i&&d0(n),n.classList.add("show")},{animation:this.animation,runningTransition:"continue"})})}hide(){return Qr(this._zone,this._el.nativeElement,({classList:n})=>n.remove("show"),{animation:this.animation,runningTransition:"stop"})}}return e.\u0275fac=function(n){return new(n||e)(H(dn),H(hn))},e.\u0275cmp=Mn({type:e,selectors:[["ngb-modal-backdrop"]],hostAttrs:[2,"z-index","1055"],hostVars:6,hostBindings:function(n,i){2&n&&(_d("modal-backdrop"+(i.backdropClass?" "+i.backdropClass:"")),Nn("show",!i.animation)("fade",i.animation))},inputs:{animation:"animation",backdropClass:"backdropClass"},decls:0,vars:0,template:function(n,i){},encapsulation:2}),e})();class Lle{close(t){}dismiss(t){}}class CZe{constructor(t,n,i,r){this._windowCmptRef=t,this._contentRef=n,this._backdropCmptRef=i,this._beforeDismiss=r,this._closed=new On,this._dismissed=new On,this._hidden=new On,t.instance.dismissEvent.subscribe(s=>{this.dismiss(s)}),this.result=new Promise((s,o)=>{this._resolve=s,this._reject=o}),this.result.then(null,()=>{})}get componentInstance(){if(this._contentRef&&this._contentRef.componentRef)return this._contentRef.componentRef.instance}get closed(){return this._closed.asObservable().pipe(Ei(this._hidden))}get dismissed(){return this._dismissed.asObservable().pipe(Ei(this._hidden))}get hidden(){return this._hidden.asObservable()}get shown(){return this._windowCmptRef.instance.shown.asObservable()}close(t){this._windowCmptRef&&(this._closed.next(t),this._resolve(t),this._removeModalElements())}_dismiss(t){this._dismissed.next(t),this._reject(t),this._removeModalElements()}dismiss(t){if(this._windowCmptRef)if(this._beforeDismiss){const n=this._beforeDismiss();!function EQe(e){return e&&e.then}(n)?!1!==n&&this._dismiss(t):n.then(i=>{!1!==i&&this._dismiss(t)},()=>{})}else this._dismiss(t)}_removeModalElements(){const t=this._windowCmptRef.instance.hide(),n=this._backdropCmptRef?this._backdropCmptRef.instance.hide():Ge(void 0);t.subscribe(()=>{const{nativeElement:i}=this._windowCmptRef.location;i.parentNode.removeChild(i),this._windowCmptRef.destroy(),this._contentRef&&this._contentRef.viewRef&&this._contentRef.viewRef.destroy(),this._windowCmptRef=null,this._contentRef=null}),n.subscribe(()=>{if(this._backdropCmptRef){const{nativeElement:i}=this._backdropCmptRef.location;i.parentNode.removeChild(i),this._backdropCmptRef.destroy(),this._backdropCmptRef=null}}),Zx(t,n).subscribe(()=>{this._hidden.next(),this._hidden.complete()})}}var O1=(()=>(function(e){e[e.BACKDROP_CLICK=0]="BACKDROP_CLICK",e[e.ESC=1]="ESC"}(O1||(O1={})),O1))();let EZe=(()=>{class e{constructor(n,i,r){this._document=n,this._elRef=i,this._zone=r,this._closed$=new On,this._elWithFocus=null,this.backdrop=!0,this.keyboard=!0,this.dismissEvent=new it,this.shown=new On,this.hidden=new On}dismiss(n){this.dismissEvent.emit(n)}ngOnInit(){this._elWithFocus=this._document.activeElement,this._zone.onStable.asObservable().pipe(Hi(1)).subscribe(()=>{this._show()})}ngOnDestroy(){this._disableEventHandling()}hide(){const{nativeElement:n}=this._elRef,i={animation:this.animation,runningTransition:"stop"},o=Zx(Qr(this._zone,n,()=>n.classList.remove("show"),i),Qr(this._zone,this._dialogEl.nativeElement,()=>{},i));return o.subscribe(()=>{this.hidden.next(),this.hidden.complete()}),this._disableEventHandling(),this._restoreFocus(),o}_show(){const n={animation:this.animation,runningTransition:"continue"};Zx(Qr(this._zone,this._elRef.nativeElement,(s,o)=>{o&&d0(s),s.classList.add("show")},n),Qr(this._zone,this._dialogEl.nativeElement,()=>{},n)).subscribe(()=>{this.shown.next(),this.shown.complete()}),this._enableEventHandling(),this._setFocus()}_enableEventHandling(){const{nativeElement:n}=this._elRef;this._zone.runOutsideAngular(()=>{Xr(n,"keydown").pipe(Ei(this._closed$),ns(r=>r.which===Si.Escape)).subscribe(r=>{this.keyboard?requestAnimationFrame(()=>{r.defaultPrevented||this._zone.run(()=>this.dismiss(O1.ESC))}):"static"===this.backdrop&&this._bumpBackdrop()});let i=!1;Xr(this._dialogEl.nativeElement,"mousedown").pipe(Ei(this._closed$),Mr(()=>i=!1),wu(()=>Xr(n,"mouseup").pipe(Ei(this._closed$),Hi(1))),ns(({target:r})=>n===r)).subscribe(()=>{i=!0}),Xr(n,"click").pipe(Ei(this._closed$)).subscribe(({target:r})=>{n===r&&("static"===this.backdrop?this._bumpBackdrop():!0===this.backdrop&&!i&&this._zone.run(()=>this.dismiss(O1.BACKDROP_CLICK))),i=!1})})}_disableEventHandling(){this._closed$.next()}_setFocus(){const{nativeElement:n}=this._elRef;if(!n.contains(document.activeElement)){const i=n.querySelector("[ngbAutofocus]"),r=Sle(n)[0];(i||r||n).focus()}}_restoreFocus(){const n=this._document.body,i=this._elWithFocus;let r;r=i&&i.focus&&n.contains(i)?i:n,this._zone.runOutsideAngular(()=>{setTimeout(()=>r.focus()),this._elWithFocus=null})}_bumpBackdrop(){"static"===this.backdrop&&Qr(this._zone,this._elRef.nativeElement,({classList:n})=>(n.add("modal-static"),()=>n.remove("modal-static")),{animation:this.animation,runningTransition:"continue"})}}return e.\u0275fac=function(n){return new(n||e)(H(si),H(dn),H(hn))},e.\u0275cmp=Mn({type:e,selectors:[["ngb-modal-window"]],viewQuery:function(n,i){if(1&n&&nM(IXe,7),2&n){let r;kn(r=function In(){return function z0e(e,t){return e[19].queries[t].queryList}(re(),$$())}())&&(i._dialogEl=r.first)}},hostAttrs:["role","dialog","tabindex","-1"],hostVars:7,hostBindings:function(n,i){2&n&&(an("aria-modal",!0)("aria-labelledby",i.ariaLabelledBy)("aria-describedby",i.ariaDescribedBy),_d("modal d-block"+(i.windowClass?" "+i.windowClass:"")),Nn("fade",i.animation))},inputs:{animation:"animation",ariaLabelledBy:"ariaLabelledBy",ariaDescribedBy:"ariaDescribedBy",backdrop:"backdrop",centered:"centered",keyboard:"keyboard",scrollable:"scrollable",size:"size",windowClass:"windowClass",modalDialogClass:"modalDialogClass"},outputs:{dismissEvent:"dismiss"},ngContentSelectors:gXe,decls:4,vars:2,consts:[["role","document"],["dialog",""],[1,"modal-content"]],template:function(n,i){1&n&&(function x6(e){const t=re()[16][6];if(!t.projection){const i=t.projection=O0(e?e.length:1,null),r=i.slice();let s=t.child;for(;null!==s;){const o=e?Cge(s,e):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}(),B(0,"div",0,1)(2,"div",2),function A6(e,t=0,n){const i=re(),r=wt(),s=kp(r,20+e,16,null,n||null);null===s.projection&&(s.projection=t),aT(),64!=(64&s.flags)&&function Ehe(e,t,n){Z8(t[11],0,t,n,U8(e,n,t),q8(n.parent||t[6],n,t))}(r,i,s)}(3),$()()),2&n&&_d("modal-dialog"+(i.size?" modal-"+i.size:"")+(i.centered?" modal-dialog-centered":"")+(i.scrollable?" modal-dialog-scrollable":"")+(i.modalDialogClass?" "+i.modalDialogClass:""))},styles:["ngb-modal-window .component-host-scrollable{display:flex;flex-direction:column;overflow:hidden}\n"],encapsulation:2}),e})(),SZe=(()=>{class e{constructor(n){this._document=n}hide(){const n=Math.abs(window.innerWidth-this._document.documentElement.clientWidth),i=this._document.body,r=i.style,{overflow:s,paddingRight:o}=r;if(n>0){const a=parseFloat(window.getComputedStyle(i).paddingRight);r.paddingRight=`${a+n}px`}return r.overflow="hidden",()=>{n>0&&(r.paddingRight=o),r.overflow=s}}}return e.\u0275fac=function(n){return new(n||e)(ge(si))},e.\u0275prov=Te({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),xZe=(()=>{class e{constructor(n,i,r,s,o,a){this._applicationRef=n,this._injector=i,this._document=r,this._scrollBar=s,this._rendererFactory=o,this._ngZone=a,this._activeWindowCmptHasChanged=new On,this._ariaHiddenValues=new Map,this._scrollBarRestoreFn=null,this._backdropAttributes=["animation","backdropClass"],this._modalRefs=[],this._windowAttributes=["animation","ariaLabelledBy","ariaDescribedBy","backdrop","centered","keyboard","scrollable","size","windowClass","modalDialogClass"],this._windowCmpts=[],this._activeInstances=new it,this._activeWindowCmptHasChanged.subscribe(()=>{if(this._windowCmpts.length){const l=this._windowCmpts[this._windowCmpts.length-1];((e,t,n,i=!1)=>{this._ngZone.runOutsideAngular(()=>{const r=Xr(t,"focusin").pipe(Ei(n),lt(s=>s.target));Xr(t,"keydown").pipe(Ei(n),ns(s=>s.which===Si.Tab),o5(r)).subscribe(([s,o])=>{const[a,l]=Sle(t);(o===a||o===t)&&s.shiftKey&&(l.focus(),s.preventDefault()),o===l&&!s.shiftKey&&(a.focus(),s.preventDefault())}),i&&Xr(t,"click").pipe(Ei(n),o5(r),lt(s=>s[1])).subscribe(s=>s.focus())})})(0,l.location.nativeElement,this._activeWindowCmptHasChanged),this._revertAriaHidden(),this._setAriaHidden(l.location.nativeElement)}})}_restoreScrollBar(){const n=this._scrollBarRestoreFn;n&&(this._scrollBarRestoreFn=null,n())}_hideScrollBar(){this._scrollBarRestoreFn||(this._scrollBarRestoreFn=this._scrollBar.hide())}open(n,i,r,s){const o=s.container instanceof HTMLElement?s.container:np(s.container)?this._document.querySelector(s.container):this._document.body,a=this._rendererFactory.createRenderer(null,null);if(!o)throw new Error(`The specified modal container "${s.container||"body"}" was not found in the DOM.`);this._hideScrollBar();const l=new Lle,u=this._getContentRef(n,s.injector||i,r,l,s);let c=!1!==s.backdrop?this._attachBackdrop(n,o):void 0,f=this._attachWindowComponent(n,o,u),d=new CZe(f,u,c,s.beforeDismiss);return this._registerModalRef(d),this._registerWindowCmpt(f),d.hidden.pipe(Hi(1)).subscribe(()=>Promise.resolve(!0).then(()=>{this._modalRefs.length||(a.removeClass(this._document.body,"modal-open"),this._restoreScrollBar(),this._revertAriaHidden())})),l.close=h=>{d.close(h)},l.dismiss=h=>{d.dismiss(h)},this._applyWindowOptions(f.instance,s),1===this._modalRefs.length&&a.addClass(this._document.body,"modal-open"),c&&c.instance&&(this._applyBackdropOptions(c.instance,s),c.changeDetectorRef.detectChanges()),f.changeDetectorRef.detectChanges(),d}get activeInstances(){return this._activeInstances}dismissAll(n){this._modalRefs.forEach(i=>i.dismiss(n))}hasOpenModals(){return this._modalRefs.length>0}_attachBackdrop(n,i){let s=n.resolveComponentFactory(DZe).create(this._injector);return this._applicationRef.attachView(s.hostView),i.appendChild(s.location.nativeElement),s}_attachWindowComponent(n,i,r){let o=n.resolveComponentFactory(EZe).create(this._injector,r.nodes);return this._applicationRef.attachView(o.hostView),i.appendChild(o.location.nativeElement),o}_applyWindowOptions(n,i){this._windowAttributes.forEach(r=>{np(i[r])&&(n[r]=i[r])})}_applyBackdropOptions(n,i){this._backdropAttributes.forEach(r=>{np(i[r])&&(n[r]=i[r])})}_getContentRef(n,i,r,s,o){return r?r instanceof Vn?this._createFromTemplateRef(r,s):function lle(e){return"string"==typeof e}(r)?this._createFromString(r):this._createFromComponent(n,i,r,s,o):new op([])}_createFromTemplateRef(n,i){const s=n.createEmbeddedView({$implicit:i,close(o){i.close(o)},dismiss(o){i.dismiss(o)}});return this._applicationRef.attachView(s),new op([s.rootNodes],s)}_createFromString(n){const i=this._document.createTextNode(`${n}`);return new op([[i]])}_createFromComponent(n,i,r,s,o){const a=n.resolveComponentFactory(r),l=gi.create({providers:[{provide:Lle,useValue:s}],parent:i}),u=a.create(l),c=u.location.nativeElement;return o.scrollable&&c.classList.add("component-host-scrollable"),this._applicationRef.attachView(u.hostView),new op([[c]],u.hostView,u)}_setAriaHidden(n){const i=n.parentElement;i&&n!==this._document.body&&(Array.from(i.children).forEach(r=>{r!==n&&"SCRIPT"!==r.nodeName&&(this._ariaHiddenValues.set(r,r.getAttribute("aria-hidden")),r.setAttribute("aria-hidden","true"))}),this._setAriaHidden(i))}_revertAriaHidden(){this._ariaHiddenValues.forEach((n,i)=>{n?i.setAttribute("aria-hidden",n):i.removeAttribute("aria-hidden")}),this._ariaHiddenValues.clear()}_registerModalRef(n){const i=()=>{const r=this._modalRefs.indexOf(n);r>-1&&(this._modalRefs.splice(r,1),this._activeInstances.emit(this._modalRefs))};this._modalRefs.push(n),this._activeInstances.emit(this._modalRefs),n.result.then(i,i)}_registerWindowCmpt(n){this._windowCmpts.push(n),this._activeWindowCmptHasChanged.next(),n.onDestroy(()=>{const i=this._windowCmpts.indexOf(n);i>-1&&(this._windowCmpts.splice(i,1),this._activeWindowCmptHasChanged.next())})}}return e.\u0275fac=function(n){return new(n||e)(ge(Ub),ge(gi),ge(si),ge(SZe),ge(eg),ge(hn))},e.\u0275prov=Te({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),AZe=(()=>{class e{constructor(n){this._ngbConfig=n,this.backdrop=!0,this.keyboard=!0}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(n){this._animation=n}}return e.\u0275fac=function(n){return new(n||e)(ge(sA))},e.\u0275prov=Te({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),TZe=(()=>{class e{constructor(n,i,r,s){this._moduleCFR=n,this._injector=i,this._modalStack=r,this._config=s}open(n,i={}){const r=Object.assign(Object.assign(Object.assign({},this._config),{animation:this._config.animation}),i);return this._modalStack.open(this._moduleCFR,this._injector,n,r)}get activeInstances(){return this._modalStack.activeInstances}dismissAll(n){this._modalStack.dismissAll(n)}hasOpenModals(){return this._modalStack.hasOpenModals()}}return e.\u0275fac=function(n){return new(n||e)(ge(Qp),ge(gi),ge(xZe),ge(AZe))},e.\u0275prov=Te({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),jle=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({providers:[TZe]}),e})(),Hle=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({imports:[[Ps]]}),e})(),Jle=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({imports:[[Ps]]}),e})(),Qle=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({imports:[[Ps]]}),e})(),Zle=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({imports:[[Ps]]}),e})(),eue=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({imports:[[Ps]]}),e})(),tue=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({imports:[[Ps]]}),e})(),nue=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({imports:[[Ps]]}),e})(),iue=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({}),e})();new Xe("live announcer delay",{providedIn:"root",factory:function VZe(){return 100}});let rue=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({imports:[[Ps]]}),e})();const HZe=[gle,mle,yle,wle,Dle,Ile,Ple,jle,Hle,Jle,Qle,Zle,eue,tue,nue,iue,rue];let UZe=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({imports:[HZe,gle,mle,yle,wle,Dle,Ile,Ple,jle,Hle,Jle,Qle,Zle,eue,tue,nue,iue,rue]}),e})(),zZe=(()=>{class e{constructor(n){this.sectorProvider=n,this.selectedSector="All Sectors",this.selectedSection="dashboard"}ngOnInit(){this.sectorProvider.getSector().subscribe(n=>{"all-sectors"===n&&n!==this.selectedSector?this.selectedSector="All Sectors":"garments-sector"===n&&n!==this.selectedSector?this.selectedSector="Garments":"asset-managers-sector"===n&&n!==this.selectedSector?this.selectedSector="Asset Managers":"hospitality-sector"===n&&n!==this.selectedSector&&(this.selectedSector="Hospitality")})}onSelectSector(n){this.selectedSector=n}onSelectSection(n){this.selectedSection=n}}return e.\u0275fac=function(n){return new(n||e)(H(dN))},e.\u0275cmp=Mn({type:e,selectors:[["header-component"]],decls:45,vars:1,consts:[[1,"bg-deep-blue"],[1,"container"],[1,"nav","navbar"],["routerLink","/dashboard",1,"navbar-brand","navbar-expand",3,"click"],["src","assets/logos/walk_free_header_logo.svg",1,"logo","ms-1","mt-1","mb-1"],[1,"navbar","me-auto"],["routerLink","/about",1,"nav-item","nav-link",3,"click"],[1,"nav-item","dropdown","col"],["type","button","id","share","data-bs-toggle","dropdown","aria-expanded","false",1,"nav-item","nav-link"],[1,"bi","bi-share-fill","ms-2"],["aria-labelledby","share",1,"dropdown-menu"],["target","_blank","href","https://www.facebook.com/sharer/sharer.php?u=",1,"dropdown-item"],[1,"bi","bi-facebook","ms-2","me-2"],["target","_blank","href","https://twitter.com/intent/tweet?url=",1,"dropdown-item"],[1,"bi","bi-twitter","ms-2","me-2"],["target","_blank","href","https://www.linkedin.com/shareArticle?mini=true&url=",1,"dropdown-item"],[1,"bi","bi-linkedin","ms-2","me-2"],["target","_blank","href","mailto:info@example.com?&subject=&cc=&bcc=&body=",1,"dropdown-item"],[1,"bi","bi-envelope-fill","ms-2","me-2"],[1,"filter-dropdown","dropdown"],["type","button","id","sector-filter","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-secondary","dropdown-toggle"],["aria-labelledby","sector-filter","data-popper-placement","bottom-start",1,"dropdown-menu"],["routerLink","dashboard/all-sectors",1,"dropdown-item",3,"click"],["routerLink","dashboard/garments-sector",1,"dropdown-item",3,"click"],["routerLink","dashboard/asset-managers-sector",1,"dropdown-item",3,"click"],["routerLink","dashboard/hospitality-sector",1,"dropdown-item",3,"click"]],template:function(n,i){1&n&&(B(0,"div",0)(1,"div",1)(2,"nav",2)(3,"a",3),Be("click",function(){return i.onSelectSection("dashboard")}),$t(4,"img",4),$(),B(5,"div",5)(6,"a",6),Be("click",function(){return i.onSelectSection("about")}),Y(7,"ABOUT"),$(),B(8,"div",7)(9,"a",8),Y(10," SHARE "),$t(11,"i",9),$(),B(12,"ul",10)(13,"li")(14,"a",11),$t(15,"i",12),Y(16,"facebook"),$()(),B(17,"li")(18,"a",13),$t(19,"i",14),Y(20,"twitter"),$()(),B(21,"li")(22,"a",15),$t(23,"i",16),Y(24,"linkedin"),$()(),B(25,"li")(26,"a",17),$t(27,"i",18),Y(28,"mail"),$()()()()(),B(29,"div",19)(30,"a",20),Y(31),$(),B(32,"ul",21)(33,"li")(34,"a",22),Be("click",function(){return i.onSelectSector("All Sectors")}),Y(35," All Sectors "),$()(),B(36,"li")(37,"a",23),Be("click",function(){return i.onSelectSector("Garments")}),Y(38," Garments "),$()(),B(39,"li")(40,"a",24),Be("click",function(){return i.onSelectSector("Asset Managers")}),Y(41," Asset Managers "),$()(),B(42,"li")(43,"a",25),Be("click",function(){return i.onSelectSector("Hospitality")}),Y(44," Hospitality "),$()()()()()()()),2&n&&(ne(31),Kp(i.selectedSector))},directives:[E5,Sw],styles:[""]}),e})(),GZe=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Mn({type:e,selectors:[["footer"]],decls:15,vars:0,consts:[[1,"bg-neutral-grey"],[1,"container","pt-5","pb-5"],[1,"row"],[1,"text-center"],[1,"row","justify-content-center"],[1,"col-3","text-center"],["href","https://walkfree.org/"],["src","assets/logos/walk_free_footer_logo.svg",1,"logo"],[1,"col-3","text-center","logo-center"],["href","https://wikirate.org"],["src","assets/logos/wikirate_logo.svg",1,"logo"],["href","https://www.business-humanrights.org/en/"],["src","assets/logos/bhrrc_logo.png",1,"logo","logo-right"]],template:function(n,i){1&n&&(B(0,"div",0)(1,"div",1)(2,"div",2)(3,"p",3),Y(4,"A collaboration between:"),$()(),B(5,"div",4)(6,"div",5)(7,"a",6),$t(8,"img",7),$()(),B(9,"div",8)(10,"a",9),$t(11,"img",10),$()(),B(12,"div",5)(13,"a",11),$t(14,"img",12),$()()()()())},styles:[""]}),e})(),WZe=(()=>{class e{constructor(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Mn({type:e,selectors:[["app-root"]],decls:3,vars:0,template:function(n,i){1&n&&$t(0,"header-component")(1,"router-outlet")(2,"footer")},directives:[zZe,rN,GZe],styles:[""]}),e})();class sue{}const lc="*";function oue(e,t=null){return{type:2,steps:e,options:t}}function aue(e){return{type:6,styles:e,offset:null}}function lue(e){Promise.resolve(null).then(e)}class M1{constructor(t=0,n=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+n}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){lue(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(i=>i()),n.length=0}}class uue{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let n=0,i=0,r=0;const s=this.players.length;0==s?lue(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++n==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const n=t*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,n/i.totalTime):1;i.setPosition(r)})}getPosition(){const t=this.players.reduce((n,i)=>null===n||i.totalTime>n.totalTime?i:n,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(i=>i()),n.length=0}}const _t=!1;function cue(e){return new Ee(3e3,_t)}function Oet(){return"undefined"!=typeof window&&void 0!==window.document}function O5(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function id(e){switch(e.length){case 0:return new M1;case 1:return e[0];default:return new uue(e)}}function fue(e,t,n,i,r={},s={}){const o=[],a=[];let l=-1,u=null;if(i.forEach(c=>{const f=c.offset,d=f==l,h=d&&u||{};Object.keys(c).forEach(p=>{let g=p,m=c[p];if("offset"!==p)switch(g=t.normalizePropertyName(g,o),m){case"!":m=r[p];break;case lc:m=s[p];break;default:m=t.normalizeStyleValue(p,g,m,o)}h[g]=m}),d||a.push(h),u=h,l=f}),o.length)throw function _et(e){return new Ee(3502,_t)}();return a}function M5(e,t,n,i){switch(t){case"start":e.onStart(()=>i(n&&N5(n,"start",e)));break;case"done":e.onDone(()=>i(n&&N5(n,"done",e)));break;case"destroy":e.onDestroy(()=>i(n&&N5(n,"destroy",e)))}}function N5(e,t,n){const i=n.totalTime,s=k5(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null==i?e.totalTime:i,!!n.disabled),o=e._data;return null!=o&&(s._data=o),s}function k5(e,t,n,i,r="",s=0,o){return{element:e,triggerName:t,fromState:n,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function so(e,t,n){let i;return e instanceof Map?(i=e.get(t),i||e.set(t,i=n)):(i=e[t],i||(i=e[t]=n)),i}function due(e){const t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}let I5=(e,t)=>!1,hue=(e,t,n)=>[],pue=null;function R5(e){const t=e.parentNode||e.host;return t===pue?null:t}(O5()||"undefined"!=typeof Element)&&(Oet()?(pue=(()=>document.documentElement)(),I5=(e,t)=>{for(;t;){if(t===e)return!0;t=R5(t)}return!1}):I5=(e,t)=>e.contains(t),hue=(e,t,n)=>{if(n)return Array.from(e.querySelectorAll(t));const i=e.querySelector(t);return i?[i]:[]});let ap=null,gue=!1;function mue(e){ap||(ap=function Net(){return"undefined"!=typeof document?document.body:null}()||{},gue=!!ap.style&&"WebkitAppearance"in ap.style);let t=!0;return ap.style&&!function Met(e){return"ebkit"==e.substring(1,6)}(e)&&(t=e in ap.style,!t&&gue&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in ap.style)),t}const _ue=I5,yue=hue;let vue=(()=>{class e{validateStyleProperty(n){return mue(n)}matchesElement(n,i){return!1}containsElement(n,i){return _ue(n,i)}getParentElement(n){return R5(n)}query(n,i,r){return yue(n,i,r)}computeStyle(n,i,r){return r||""}animate(n,i,r,s,o,a=[],l){return new M1(r,s)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})(),F5=(()=>{class e{}return e.NOOP=new vue,e})();const P5="ng-enter",pA="ng-leave",gA="ng-trigger",mA=".ng-trigger",wue="ng-animating",L5=".ng-animating";function lp(e){if("number"==typeof e)return e;const t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:j5(parseFloat(t[1]),t[2])}function j5(e,t){return"s"===t?1e3*e:e}function _A(e,t,n){return e.hasOwnProperty("duration")?e:function Ret(e,t,n){let r,s=0,o="";if("string"==typeof e){const a=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return t.push(cue()),{duration:0,delay:0,easing:""};r=j5(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(s=j5(parseFloat(l),a[4]));const u=a[5];u&&(o=u)}else r=e;if(!n){let a=!1,l=t.length;r<0&&(t.push(function YZe(){return new Ee(3100,_t)}()),a=!0),s<0&&(t.push(function KZe(){return new Ee(3101,_t)}()),a=!0),a&&t.splice(l,0,cue())}return{duration:r,delay:s,easing:o}}(e,t,n)}function p0(e,t={}){return Object.keys(e).forEach(n=>{t[n]=e[n]}),t}function rd(e,t,n={}){if(t)for(let i in e)n[i]=e[i];else p0(e,n);return n}function Cue(e,t,n){return n?t+":"+n+";":""}function Eue(e){let t="";for(let n=0;n<e.style.length;n++){const i=e.style.item(n);t+=Cue(0,i,e.style.getPropertyValue(i))}for(const n in e.style)e.style.hasOwnProperty(n)&&!n.startsWith("_")&&(t+=Cue(0,Let(n),e.style[n]));e.setAttribute("style",t)}function nu(e,t,n){e.style&&(Object.keys(t).forEach(i=>{const r=$5(i);n&&!n.hasOwnProperty(i)&&(n[i]=e.style[r]),e.style[r]=t[i]}),O5()&&Eue(e))}function up(e,t){e.style&&(Object.keys(t).forEach(n=>{const i=$5(n);e.style[i]=""}),O5()&&Eue(e))}function N1(e){return Array.isArray(e)?1==e.length?e[0]:oue(e):e}const B5=new RegExp("{{\\s*(.+?)\\s*}}","g");function Sue(e){let t=[];if("string"==typeof e){let n;for(;n=B5.exec(e);)t.push(n[1]);B5.lastIndex=0}return t}function yA(e,t,n){const i=e.toString(),r=i.replace(B5,(s,o)=>{let a=t[o];return t.hasOwnProperty(o)||(n.push(function XZe(e){return new Ee(3003,_t)}()),a=""),a.toString()});return r==i?e:r}function vA(e){const t=[];let n=e.next();for(;!n.done;)t.push(n.value),n=e.next();return t}const Pet=/-+([a-z0-9])/g;function $5(e){return e.replace(Pet,(...t)=>t[1].toUpperCase())}function Let(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function oo(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw function QZe(e){return new Ee(3004,_t)}()}}function xue(e,t){return window.getComputedStyle(e)[t]}function Uet(e,t){const n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(i=>function zet(e,t,n){if(":"==e[0]){const l=function Get(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(n,i)=>parseFloat(i)>parseFloat(n);case":decrement":return(n,i)=>parseFloat(i)<parseFloat(n);default:return t.push(function het(e){return new Ee(3016,_t)}()),"* => *"}}(e,n);if("function"==typeof l)return void t.push(l);e=l}const i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push(function det(e){return new Ee(3015,_t)}()),t;const r=i[1],s=i[2],o=i[3];t.push(Aue(r,o));"<"==s[0]&&!("*"==r&&"*"==o)&&t.push(Aue(o,r))}(i,n,t)):n.push(e),n}const CA=new Set(["true","1"]),EA=new Set(["false","0"]);function Aue(e,t){const n=CA.has(e)||EA.has(e),i=CA.has(t)||EA.has(t);return(r,s)=>{let o="*"==e||e==r,a="*"==t||t==s;return!o&&n&&"boolean"==typeof r&&(o=r?CA.has(e):EA.has(e)),!a&&i&&"boolean"==typeof s&&(a=s?CA.has(t):EA.has(t)),o&&a}}const Wet=new RegExp("s*:selfs*,?","g");function V5(e,t,n,i){return new qet(e).build(t,n,i)}class qet{constructor(t){this._driver=t}build(t,n,i){const r=new Jet(n);this._resetContextStyleTimingState(r);const s=oo(this,N1(t),r);return r.unsupportedCSSPropertiesFound.size&&r.unsupportedCSSPropertiesFound.keys(),s}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles={},t.collectedStyles[""]={},t.currentTime=0}visitTrigger(t,n){let i=n.queryCount=0,r=n.depCount=0;const s=[],o=[];return"@"==t.name.charAt(0)&&n.errors.push(function eet(){return new Ee(3006,_t)}()),t.definitions.forEach(a=>{if(this._resetContextStyleTimingState(n),0==a.type){const l=a,u=l.name;u.toString().split(/\s*,\s*/).forEach(c=>{l.name=c,s.push(this.visitState(l,n))}),l.name=u}else if(1==a.type){const l=this.visitTransition(a,n);i+=l.queryCount,r+=l.depCount,o.push(l)}else n.errors.push(function tet(){return new Ee(3007,_t)}())}),{type:7,name:t.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(t,n){const i=this.visitStyle(t.styles,n),r=t.options&&t.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};i.styles.forEach(a=>{if(SA(a)){const l=a;Object.keys(l).forEach(u=>{Sue(l[u]).forEach(c=>{o.hasOwnProperty(c)||s.add(c)})})}}),s.size&&(vA(s.values()),n.errors.push(function net(e,t){return new Ee(3008,_t)}()))}return{type:0,name:t.name,style:i,options:r?{params:r}:null}}visitTransition(t,n){n.queryCount=0,n.depCount=0;const i=oo(this,N1(t.animation),n);return{type:1,matchers:Uet(t.expr,n.errors),animation:i,queryCount:n.queryCount,depCount:n.depCount,options:cp(t.options)}}visitSequence(t,n){return{type:2,steps:t.steps.map(i=>oo(this,i,n)),options:cp(t.options)}}visitGroup(t,n){const i=n.currentTime;let r=0;const s=t.steps.map(o=>{n.currentTime=i;const a=oo(this,o,n);return r=Math.max(r,n.currentTime),a});return n.currentTime=r,{type:3,steps:s,options:cp(t.options)}}visitAnimate(t,n){const i=function Qet(e,t){if(e.hasOwnProperty("duration"))return e;if("number"==typeof e)return H5(_A(e,t).duration,0,"");const n=e;if(n.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=H5(0,0,"");return s.dynamic=!0,s.strValue=n,s}const r=_A(n,t);return H5(r.duration,r.delay,r.easing)}(t.timings,n.errors);n.currentAnimateTimings=i;let r,s=t.styles?t.styles:aue({});if(5==s.type)r=this.visitKeyframes(s,n);else{let o=t.styles,a=!1;if(!o){a=!0;const u={};i.easing&&(u.easing=i.easing),o=aue(u)}n.currentTime+=i.duration+i.delay;const l=this.visitStyle(o,n);l.isEmptyStep=a,r=l}return n.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(t,n){const i=this._makeStyleAst(t,n);return this._validateStyleAst(i,n),i}_makeStyleAst(t,n){const i=[];Array.isArray(t.styles)?t.styles.forEach(o=>{"string"==typeof o?o==lc?i.push(o):n.errors.push(function iet(e){return new Ee(3002,_t)}()):i.push(o)}):i.push(t.styles);let r=!1,s=null;return i.forEach(o=>{if(SA(o)){const a=o,l=a.easing;if(l&&(s=l,delete a.easing),!r)for(let u in a)if(a[u].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:i,easing:s,offset:t.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(t,n){const i=n.currentAnimateTimings;let r=n.currentTime,s=n.currentTime;i&&s>0&&(s-=i.duration+i.delay),t.styles.forEach(o=>{"string"!=typeof o&&Object.keys(o).forEach(a=>{if(!this._driver.validateStyleProperty(a))return delete o[a],void n.unsupportedCSSPropertiesFound.add(a);const l=n.collectedStyles[n.currentQuerySelector],u=l[a];let c=!0;u&&(s!=r&&s>=u.startTime&&r<=u.endTime&&(n.errors.push(function ret(e,t,n,i,r){return new Ee(3010,_t)}()),c=!1),s=u.startTime),c&&(l[a]={startTime:s,endTime:r}),n.options&&function Fet(e,t,n){const i=t.params||{},r=Sue(e);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||n.push(function JZe(e){return new Ee(3001,_t)}())})}(o[a],n.options,n.errors)})})}visitKeyframes(t,n){const i={type:5,styles:[],options:null};if(!n.currentAnimateTimings)return n.errors.push(function set(){return new Ee(3011,_t)}()),i;let s=0;const o=[];let a=!1,l=!1,u=0;const c=t.steps.map(_=>{const y=this._makeStyleAst(_,n);let v=null!=y.offset?y.offset:function Xet(e){if("string"==typeof e)return null;let t=null;if(Array.isArray(e))e.forEach(n=>{if(SA(n)&&n.hasOwnProperty("offset")){const i=n;t=parseFloat(i.offset),delete i.offset}});else if(SA(e)&&e.hasOwnProperty("offset")){const n=e;t=parseFloat(n.offset),delete n.offset}return t}(y.styles),b=0;return null!=v&&(s++,b=y.offset=v),l=l||b<0||b>1,a=a||b<u,u=b,o.push(b),y});l&&n.errors.push(function oet(){return new Ee(3012,_t)}()),a&&n.errors.push(function aet(){return new Ee(3200,_t)}());const f=t.steps.length;let d=0;s>0&&s<f?n.errors.push(function uet(){return new Ee(3202,_t)}()):0==s&&(d=1/(f-1));const h=f-1,p=n.currentTime,g=n.currentAnimateTimings,m=g.duration;return c.forEach((_,y)=>{const v=d>0?y==h?1:d*y:o[y],b=v*m;n.currentTime=p+g.delay+b,g.duration=b,this._validateStyleAst(_,n),_.offset=v,i.styles.push(_)}),i}visitReference(t,n){return{type:8,animation:oo(this,N1(t.animation),n),options:cp(t.options)}}visitAnimateChild(t,n){return n.depCount++,{type:9,options:cp(t.options)}}visitAnimateRef(t,n){return{type:10,animation:this.visitReference(t.animation,n),options:cp(t.options)}}visitQuery(t,n){const i=n.currentQuerySelector,r=t.options||{};n.queryCount++,n.currentQuery=t;const[s,o]=function Yet(e){const t=!!e.split(/\s*,\s*/).find(n=>":self"==n);return t&&(e=e.replace(Wet,"")),e=e.replace(/@\*/g,mA).replace(/@\w+/g,n=>mA+"-"+n.substr(1)).replace(/:animating/g,L5),[e,t]}(t.selector);n.currentQuerySelector=i.length?i+" "+s:s,so(n.collectedStyles,n.currentQuerySelector,{});const a=oo(this,N1(t.animation),n);return n.currentQuery=null,n.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:t.selector,options:cp(t.options)}}visitStagger(t,n){n.currentQuery||n.errors.push(function cet(){return new Ee(3013,_t)}());const i="full"===t.timings?{duration:0,delay:0,easing:"full"}:_A(t.timings,n.errors,!0);return{type:12,animation:oo(this,N1(t.animation),n),timings:i,options:null}}}class Jet{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function SA(e){return!Array.isArray(e)&&"object"==typeof e}function cp(e){return e?(e=p0(e)).params&&(e.params=function Ket(e){return e?p0(e):null}(e.params)):e={},e}function H5(e,t,n){return{duration:e,delay:t,easing:n}}function U5(e,t,n,i,r,s,o=null,a=!1){return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class xA{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,n){let i=this._map.get(t);i||this._map.set(t,i=[]),i.push(...n)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const ttt=new RegExp(":enter","g"),itt=new RegExp(":leave","g");function z5(e,t,n,i,r,s={},o={},a,l,u=[]){return(new rtt).buildKeyframes(e,t,n,i,r,s,o,a,l,u)}class rtt{buildKeyframes(t,n,i,r,s,o,a,l,u,c=[]){u=u||new xA;const f=new G5(t,n,u,r,s,c,[]);f.options=l,f.currentTimeline.setStyles([o],null,f.errors,l),oo(this,i,f);const d=f.timelines.filter(h=>h.containsAnimation());if(Object.keys(a).length){let h;for(let p=d.length-1;p>=0;p--){const g=d[p];if(g.element===n){h=g;break}}h&&!h.allowOnlyTimelineStyles()&&h.setStyles([a],null,f.errors,l)}return d.length?d.map(h=>h.buildKeyframes()):[U5(n,[],[],[],0,0,"",!1)]}visitTrigger(t,n){}visitState(t,n){}visitTransition(t,n){}visitAnimateChild(t,n){const i=n.subInstructions.get(n.element);if(i){const r=n.createSubContext(t.options),s=n.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&n.transformIntoNewTimeline(o)}n.previousNode=t}visitAnimateRef(t,n){const i=n.createSubContext(t.options);i.transformIntoNewTimeline(),this.visitReference(t.animation,i),n.transformIntoNewTimeline(i.currentTimeline.currentTime),n.previousNode=t}_visitSubInstructions(t,n,i){let s=n.currentTimeline.currentTime;const o=null!=i.duration?lp(i.duration):null,a=null!=i.delay?lp(i.delay):null;return 0!==o&&t.forEach(l=>{const u=n.appendInstructionToTimeline(l,o,a);s=Math.max(s,u.duration+u.delay)}),s}visitReference(t,n){n.updateOptions(t.options,!0),oo(this,t.animation,n),n.previousNode=t}visitSequence(t,n){const i=n.subContextCount;let r=n;const s=t.options;if(s&&(s.params||s.delay)&&(r=n.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=AA);const o=lp(s.delay);r.delayNextStep(o)}t.steps.length&&(t.steps.forEach(o=>oo(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),n.previousNode=t}visitGroup(t,n){const i=[];let r=n.currentTimeline.currentTime;const s=t.options&&t.options.delay?lp(t.options.delay):0;t.steps.forEach(o=>{const a=n.createSubContext(t.options);s&&a.delayNextStep(s),oo(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(o=>n.currentTimeline.mergeTimelineCollectedStyles(o)),n.transformIntoNewTimeline(r),n.previousNode=t}_visitTiming(t,n){if(t.dynamic){const i=t.strValue;return _A(n.params?yA(i,n.params,n.errors):i,n.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,n){const i=n.currentAnimateTimings=this._visitTiming(t.timings,n),r=n.currentTimeline;i.delay&&(n.incrementTime(i.delay),r.snapshotCurrentStyles());const s=t.style;5==s.type?this.visitKeyframes(s,n):(n.incrementTime(i.duration),this.visitStyle(s,n),r.applyStylesToKeyframe()),n.currentAnimateTimings=null,n.previousNode=t}visitStyle(t,n){const i=n.currentTimeline,r=n.currentAnimateTimings;!r&&i.getCurrentStyleProperties().length&&i.forwardFrame();const s=r&&r.easing||t.easing;t.isEmptyStep?i.applyEmptyStep(s):i.setStyles(t.styles,s,n.errors,n.options),n.previousNode=t}visitKeyframes(t,n){const i=n.currentAnimateTimings,r=n.currentTimeline.duration,s=i.duration,a=n.createSubContext().currentTimeline;a.easing=i.easing,t.styles.forEach(l=>{a.forwardTime((l.offset||0)*s),a.setStyles(l.styles,l.easing,n.errors,n.options),a.applyStylesToKeyframe()}),n.currentTimeline.mergeTimelineCollectedStyles(a),n.transformIntoNewTimeline(r+s),n.previousNode=t}visitQuery(t,n){const i=n.currentTimeline.currentTime,r=t.options||{},s=r.delay?lp(r.delay):0;s&&(6===n.previousNode.type||0==i&&n.currentTimeline.getCurrentStyleProperties().length)&&(n.currentTimeline.snapshotCurrentStyles(),n.previousNode=AA);let o=i;const a=n.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,n.errors);n.currentQueryTotal=a.length;let l=null;a.forEach((u,c)=>{n.currentQueryIndex=c;const f=n.createSubContext(t.options,u);s&&f.delayNextStep(s),u===n.element&&(l=f.currentTimeline),oo(this,t.animation,f),f.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,f.currentTimeline.currentTime)}),n.currentQueryIndex=0,n.currentQueryTotal=0,n.transformIntoNewTimeline(o),l&&(n.currentTimeline.mergeTimelineCollectedStyles(l),n.currentTimeline.snapshotCurrentStyles()),n.previousNode=t}visitStagger(t,n){const i=n.parentContext,r=n.currentTimeline,s=t.timings,o=Math.abs(s.duration),a=o*(n.currentQueryTotal-1);let l=o*n.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=i.currentStaggerTime}const c=n.currentTimeline;l&&c.delayNextStep(l);const f=c.currentTime;oo(this,t.animation,n),n.previousNode=t,i.currentStaggerTime=r.currentTime-f+(r.startTime-i.currentTimeline.startTime)}}const AA={};class G5{constructor(t,n,i,r,s,o,a,l){this._driver=t,this.element=n,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=AA,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new TA(this._driver,n,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,n){if(!t)return;const i=t;let r=this.options;null!=i.duration&&(r.duration=lp(i.duration)),null!=i.delay&&(r.delay=lp(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!n||!o.hasOwnProperty(a))&&(o[a]=yA(s[a],o,this.errors))})}}_copyOptions(){const t={};if(this.options){const n=this.options.params;if(n){const i=t.params={};Object.keys(n).forEach(r=>{i[r]=n[r]})}}return t}createSubContext(t=null,n,i){const r=n||this.element,s=new G5(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(t),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(t){return this.previousNode=AA,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,n,i){const r={duration:null!=n?n:t.duration,delay:this.currentTimeline.currentTime+(null!=i?i:0)+t.delay,easing:""},s=new stt(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,n,i,r,s,o){let a=[];if(r&&a.push(this.element),t.length>0){t=(t=t.replace(ttt,"."+this._enterClassName)).replace(itt,"."+this._leaveClassName);let u=this._driver.query(this.element,t,1!=i);0!==i&&(u=i<0?u.slice(u.length+i,u.length):u.slice(0,i)),a.push(...u)}return!s&&0==a.length&&o.push(function fet(e){return new Ee(3014,_t)}()),a}}class TA{constructor(t,n,i,r){this._driver=t,this.element=n,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const n=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||n?(this.forwardTime(this.currentTime+t),n&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,n){return this.applyStylesToKeyframe(),new TA(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,n){this._localTimelineStyles[t]=n,this._globalTimelineStyles[t]=n,this._styleSummary[t]={time:this.currentTime,value:n}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(n=>{this._backFill[n]=this._globalTimelineStyles[n]||lc,this._currentKeyframe[n]=lc}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,n,i,r){n&&(this._previousKeyframe.easing=n);const s=r&&r.params||{},o=function ott(e,t){const n={};let i;return e.forEach(r=>{"*"===r?(i=i||Object.keys(t),i.forEach(s=>{n[s]=lc})):rd(r,!1,n)}),n}(t,this._globalTimelineStyles);Object.keys(o).forEach(a=>{const l=yA(o[a],s,i);this._pendingStyles[a]=l,this._localTimelineStyles.hasOwnProperty(a)||(this._backFill[a]=this._globalTimelineStyles.hasOwnProperty(a)?this._globalTimelineStyles[a]:lc),this._updateStyle(a,l)})}applyStylesToKeyframe(){const t=this._pendingStyles,n=Object.keys(t);0!=n.length&&(this._pendingStyles={},n.forEach(i=>{this._currentKeyframe[i]=t[i]}),Object.keys(this._localTimelineStyles).forEach(i=>{this._currentKeyframe.hasOwnProperty(i)||(this._currentKeyframe[i]=this._localTimelineStyles[i])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const n=this._localTimelineStyles[t];this._pendingStyles[t]=n,this._updateStyle(t,n)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let n in this._currentKeyframe)t.push(n);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(n=>{const i=this._styleSummary[n],r=t._styleSummary[n];(!i||r.time>i.time)&&this._updateStyle(n,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,n=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const u=rd(a,!0);Object.keys(u).forEach(c=>{const f=u[c];"!"==f?t.add(c):f==lc&&n.add(c)}),i||(u.offset=l/this.duration),r.push(u)});const s=t.size?vA(t.values()):[],o=n.size?vA(n.values()):[];if(i){const a=r[0],l=p0(a);a.offset=0,l.offset=1,r=[a,l]}return U5(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class stt extends TA{constructor(t,n,i,r,s,o,a=!1){super(t,n,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:n,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&n){const s=[],o=i+n,a=n/o,l=rd(t[0],!1);l.offset=0,s.push(l);const u=rd(t[0],!1);u.offset=Mue(a),s.push(u);const c=t.length-1;for(let f=1;f<=c;f++){let d=rd(t[f],!1);d.offset=Mue((n+d.offset*i)/o),s.push(d)}i=o,n=0,r="",t=s}return U5(this.element,t,this.preStyleProps,this.postStyleProps,i,n,r,!0)}}function Mue(e,t=3){const n=Math.pow(10,t-1);return Math.round(e*n)/n}class W5{}class att extends W5{normalizePropertyName(t,n){return $5(t)}normalizeStyleValue(t,n,i,r){let s="";const o=i.toString().trim();if(ltt[n]&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function ZZe(e,t){return new Ee(3005,_t)}())}return o+s}}const ltt=(()=>function utt(e){const t={};return e.forEach(n=>t[n]=!0),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function Nue(e,t,n,i,r,s,o,a,l,u,c,f,d){return{type:0,element:e,triggerName:t,isRemovalTransition:r,fromState:n,fromStyles:s,toState:i,toStyles:o,timelines:a,queriedElements:l,preStyleProps:u,postStyleProps:c,totalTime:f,errors:d}}const q5={};class kue{constructor(t,n,i){this._triggerName=t,this.ast=n,this._stateStyles=i}match(t,n,i,r){return function ctt(e,t,n,i,r){return e.some(s=>s(t,n,i,r))}(this.ast.matchers,t,n,i,r)}buildStyles(t,n,i){const r=this._stateStyles["*"],s=this._stateStyles[t],o=r?r.buildStyles(n,i):{};return s?s.buildStyles(n,i):o}build(t,n,i,r,s,o,a,l,u,c){const f=[],d=this.ast.options&&this.ast.options.params||q5,p=this.buildStyles(i,a&&a.params||q5,f),g=l&&l.params||q5,m=this.buildStyles(r,g,f),_=new Set,y=new Map,v=new Map,b="void"===r,D={params:Object.assign(Object.assign({},d),g)},C=c?[]:z5(t,n,this.ast.animation,s,o,p,m,D,u,f);let w=0;if(C.forEach(O=>{w=Math.max(O.duration+O.delay,w)}),f.length)return Nue(n,this._triggerName,i,r,b,p,m,[],[],y,v,w,f);C.forEach(O=>{const M=O.element,N=so(y,M,{});O.preStyleProps.forEach(P=>N[P]=!0);const R=so(v,M,{});O.postStyleProps.forEach(P=>R[P]=!0),M!==n&&_.add(M)});const E=vA(_.values());return Nue(n,this._triggerName,i,r,b,p,m,C,E,y,v,w)}}class ftt{constructor(t,n,i){this.styles=t,this.defaultParams=n,this.normalizer=i}buildStyles(t,n){const i={},r=p0(this.defaultParams);return Object.keys(t).forEach(s=>{const o=t[s];null!=o&&(r[s]=o)}),this.styles.styles.forEach(s=>{if("string"!=typeof s){const o=s;Object.keys(o).forEach(a=>{let l=o[a];l.length>1&&(l=yA(l,r,n));const u=this.normalizer.normalizePropertyName(a,n);l=this.normalizer.normalizeStyleValue(a,u,l,n),i[u]=l})}}),i}}class htt{constructor(t,n,i){this.name=t,this.ast=n,this._normalizer=i,this.transitionFactories=[],this.states={},n.states.forEach(r=>{this.states[r.name]=new ftt(r.style,r.options&&r.options.params||{},i)}),Iue(this.states,"true","1"),Iue(this.states,"false","0"),n.transitions.forEach(r=>{this.transitionFactories.push(new kue(t,r,this.states))}),this.fallbackTransition=function ptt(e,t,n){return new kue(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,n,i,r){return this.transitionFactories.find(o=>o.match(t,n,i,r))||null}matchStyles(t,n,i){return this.fallbackTransition.buildStyles(t,n,i)}}function Iue(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}const gtt=new xA;class mtt{constructor(t,n,i){this.bodyNode=t,this._driver=n,this._normalizer=i,this._animations={},this._playersById={},this.players=[]}register(t,n){const i=[],s=V5(this._driver,n,i,[]);if(i.length)throw function yet(e){return new Ee(3503,_t)}();this._animations[t]=s}_buildPlayer(t,n,i){const r=t.element,s=fue(0,this._normalizer,0,t.keyframes,n,i);return this._driver.animate(r,s,t.duration,t.delay,t.easing,[],!0)}create(t,n,i={}){const r=[],s=this._animations[t];let o;const a=new Map;if(s?(o=z5(this._driver,n,s,P5,pA,{},{},i,gtt,r),o.forEach(c=>{const f=so(a,c.element,{});c.postStyleProps.forEach(d=>f[d]=null)})):(r.push(function vet(){return new Ee(3300,_t)}()),o=[]),r.length)throw function bet(e){return new Ee(3504,_t)}();a.forEach((c,f)=>{Object.keys(c).forEach(d=>{c[d]=this._driver.computeStyle(f,d,lc)})});const u=id(o.map(c=>{const f=a.get(c.element);return this._buildPlayer(c,{},f)}));return this._playersById[t]=u,u.onDestroy(()=>this.destroy(t)),this.players.push(u),u}destroy(t){const n=this._getPlayer(t);n.destroy(),delete this._playersById[t];const i=this.players.indexOf(n);i>=0&&this.players.splice(i,1)}_getPlayer(t){const n=this._playersById[t];if(!n)throw function wet(e){return new Ee(3301,_t)}();return n}listen(t,n,i,r){const s=k5(n,"","","");return M5(this._getPlayer(t),i,s,r),()=>{}}command(t,n,i,r){if("register"==i)return void this.register(t,r[0]);if("create"==i)return void this.create(t,n,r[0]||{});const s=this._getPlayer(t);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const Rue="ng-animate-queued",Y5="ng-animate-disabled",wtt=[],Fue={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Dtt={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Uo="__ng_removed";class K5{constructor(t,n=""){this.namespaceId=n;const i=t&&t.hasOwnProperty("value");if(this.value=function xtt(e){return null!=e?e:null}(i?t.value:t),i){const s=p0(t);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const n=t.params;if(n){const i=this.options.params;Object.keys(n).forEach(r=>{null==i[r]&&(i[r]=n[r])})}}}const k1="void",J5=new K5(k1);class Ctt{constructor(t,n,i){this.id=t,this.hostElement=n,this._engine=i,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,zo(n,this._hostClassName)}listen(t,n,i,r){if(!this._triggers.hasOwnProperty(n))throw function Det(e,t){return new Ee(3302,_t)}();if(null==i||0==i.length)throw function Cet(e){return new Ee(3303,_t)}();if(!function Att(e){return"start"==e||"done"==e}(i))throw function Eet(e,t){return new Ee(3400,_t)}();const s=so(this._elementListeners,t,[]),o={name:n,phase:i,callback:r};s.push(o);const a=so(this._engine.statesByElement,t,{});return a.hasOwnProperty(n)||(zo(t,gA),zo(t,gA+"-"+n),a[n]=J5),()=>{this._engine.afterFlush(()=>{const l=s.indexOf(o);l>=0&&s.splice(l,1),this._triggers[n]||delete a[n]})}}register(t,n){return!this._triggers[t]&&(this._triggers[t]=n,!0)}_getTrigger(t){const n=this._triggers[t];if(!n)throw function xet(e){return new Ee(3401,_t)}();return n}trigger(t,n,i,r=!0){const s=this._getTrigger(n),o=new X5(this.id,n,t);let a=this._engine.statesByElement.get(t);a||(zo(t,gA),zo(t,gA+"-"+n),this._engine.statesByElement.set(t,a={}));let l=a[n];const u=new K5(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&l&&u.absorbOptions(l.options),a[n]=u,l||(l=J5),u.value!==k1&&l.value===u.value){if(!function Mtt(e,t){const n=Object.keys(e),i=Object.keys(t);if(n.length!=i.length)return!1;for(let r=0;r<n.length;r++){const s=n[r];if(!t.hasOwnProperty(s)||e[s]!==t[s])return!1}return!0}(l.params,u.params)){const g=[],m=s.matchStyles(l.value,l.params,g),_=s.matchStyles(u.value,u.params,g);g.length?this._engine.reportError(g):this._engine.afterFlush(()=>{up(t,m),nu(t,_)})}return}const d=so(this._engine.playersByElement,t,[]);d.forEach(g=>{g.namespaceId==this.id&&g.triggerName==n&&g.queued&&g.destroy()});let h=s.matchTransition(l.value,u.value,t,u.params),p=!1;if(!h){if(!r)return;h=s.fallbackTransition,p=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:n,transition:h,fromState:l,toState:u,player:o,isFallbackTransition:p}),p||(zo(t,Rue),o.onStart(()=>{g0(t,Rue)})),o.onDone(()=>{let g=this.players.indexOf(o);g>=0&&this.players.splice(g,1);const m=this._engine.playersByElement.get(t);if(m){let _=m.indexOf(o);_>=0&&m.splice(_,1)}}),this.players.push(o),d.push(o),o}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((n,i)=>{delete n[t]}),this._elementListeners.forEach((n,i)=>{this._elementListeners.set(i,n.filter(r=>r.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const n=this._engine.playersByElement.get(t);n&&(n.forEach(i=>i.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,n){const i=this._engine.driver.query(t,mA,!0);i.forEach(r=>{if(r[Uo])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,n,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(t,n,i,r){const s=this._engine.statesByElement.get(t),o=new Map;if(s){const a=[];if(Object.keys(s).forEach(l=>{if(o.set(l,s[l].value),this._triggers[l]){const u=this.trigger(t,l,k1,r);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,t,!0,n,o),i&&id(a).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const n=this._elementListeners.get(t),i=this._engine.statesByElement.get(t);if(n&&i){const r=new Set;n.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const l=this._triggers[o].fallbackTransition,u=i[o]||J5,c=new K5(k1),f=new X5(this.id,o,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:o,transition:l,fromState:u,toState:c,player:f,isFallbackTransition:!0})})}}removeNode(t,n){const i=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,n),this.triggerLeaveAnimation(t,n,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(t):[];if(s&&s.length)r=!0;else{let o=t;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)i.markElementAsRemoved(this.id,t,!1,n);else{const s=t[Uo];(!s||s===Fue)&&(i.afterFlush(()=>this.clearElementCache(t)),i.destroyInnerAnimations(t),i._onRemovalComplete(t,n))}}insertNode(t,n){zo(t,this._hostClassName)}drainQueuedTransitions(t){const n=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==i.triggerName){const l=k5(s,i.triggerName,i.fromState.value,i.toState.value);l._data=t,M5(i.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):n.push(i)}),this._queue=[],n.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(t){this.players.forEach(n=>n.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let n=!1;return this._elementListeners.has(t)&&(n=!0),n=!!this._queue.find(i=>i.element===t)||n,n}}class Ett{constructor(t,n,i){this.bodyNode=t,this.driver=n,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}_onRemovalComplete(t,n){this.onRemovalComplete(t,n)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(n=>{n.players.forEach(i=>{i.queued&&t.push(i)})}),t}createNamespace(t,n){const i=new Ctt(t,n,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,n)?this._balanceNamespaceList(i,n):(this.newHostElements.set(n,i),this.collectEnterElement(n)),this._namespaceLookup[t]=i}_balanceNamespaceList(t,n){const i=this._namespaceList,r=this.namespacesByHostElement,s=i.length-1;if(s>=0){let o=!1;if(void 0!==this.driver.getParentElement){let a=this.driver.getParentElement(n);for(;a;){const l=r.get(a);if(l){const u=i.indexOf(l);i.splice(u+1,0,t),o=!0;break}a=this.driver.getParentElement(a)}}else for(let a=s;a>=0;a--)if(this.driver.containsElement(i[a].hostElement,n)){i.splice(a+1,0,t),o=!0;break}o||i.unshift(t)}else i.push(t);return r.set(n,t),t}register(t,n){let i=this._namespaceLookup[t];return i||(i=this.createNamespace(t,n)),i}registerTrigger(t,n,i){let r=this._namespaceLookup[t];r&&r.register(n,i)&&this.totalAnimations++}destroy(t,n){if(!t)return;const i=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[t];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(n))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const n=new Set,i=this.statesByElement.get(t);if(i){const r=Object.keys(i);for(let s=0;s<r.length;s++){const o=i[r[s]].namespaceId;if(o){const a=this._fetchNamespace(o);a&&n.add(a)}}}return n}trigger(t,n,i,r){if(OA(n)){const s=this._fetchNamespace(t);if(s)return s.trigger(n,i,r),!0}return!1}insertNode(t,n,i,r){if(!OA(n))return;const s=n[Uo];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(n);o>=0&&this.collectedLeaveElements.splice(o,1)}if(t){const o=this._fetchNamespace(t);o&&o.insertNode(n,i)}r&&this.collectEnterElement(n)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,n){n?this.disabledNodes.has(t)||(this.disabledNodes.add(t),zo(t,Y5)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),g0(t,Y5))}removeNode(t,n,i,r){if(OA(n)){const s=t?this._fetchNamespace(t):null;if(s?s.removeNode(n,r):this.markElementAsRemoved(t,n,!1,r),i){const o=this.namespacesByHostElement.get(n);o&&o.id!==t&&o.removeNode(n,r)}}else this._onRemovalComplete(n,r)}markElementAsRemoved(t,n,i,r,s){this.collectedLeaveElements.push(n),n[Uo]={namespaceId:t,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(t,n,i,r,s){return OA(n)?this._fetchNamespace(t).listen(n,i,r,s):()=>{}}_buildInstruction(t,n,i,r,s){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,i,r,t.fromState.options,t.toState.options,n,s)}destroyInnerAnimations(t){let n=this.driver.query(t,mA,!0);n.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(n=this.driver.query(t,L5,!0),n.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(t){const n=this.playersByElement.get(t);n&&n.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(t){const n=this.playersByQueriedElement.get(t);n&&n.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return id(this.players).onDone(()=>t());t()})}processLeaveNode(t){var n;const i=t[Uo];if(i&&i.setForRemoval){if(t[Uo]=Fue,i.namespaceId){this.destroyInnerAnimations(t);const r=this._fetchNamespace(i.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,i.setForRemoval)}(null===(n=t.classList)||void 0===n?void 0:n.contains(Y5))&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(t=-1){let n=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)zo(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{n=this._flushAnimations(i,t)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],n.length?id(n).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(t){throw function Aet(e){return new Ee(3402,_t)}()}_flushAnimations(t,n){const i=new xA,r=[],s=new Map,o=[],a=new Map,l=new Map,u=new Map,c=new Set;this.disabledNodes.forEach(S=>{c.add(S);const k=this.driver.query(S,".ng-animate-queued",!0);for(let T=0;T<k.length;T++)c.add(k[T])});const f=this.bodyNode,d=Array.from(this.statesByElement.keys()),h=jue(d,this.collectedEnterElements),p=new Map;let g=0;h.forEach((S,k)=>{const T=P5+g++;p.set(k,T),S.forEach(F=>zo(F,T))});const m=[],_=new Set,y=new Set;for(let S=0;S<this.collectedLeaveElements.length;S++){const k=this.collectedLeaveElements[S],T=k[Uo];T&&T.setForRemoval&&(m.push(k),_.add(k),T.hasAnimation?this.driver.query(k,".ng-star-inserted",!0).forEach(F=>_.add(F)):y.add(k))}const v=new Map,b=jue(d,Array.from(_));b.forEach((S,k)=>{const T=pA+g++;v.set(k,T),S.forEach(F=>zo(F,T))}),t.push(()=>{h.forEach((S,k)=>{const T=p.get(k);S.forEach(F=>g0(F,T))}),b.forEach((S,k)=>{const T=v.get(k);S.forEach(F=>g0(F,T))}),m.forEach(S=>{this.processLeaveNode(S)})});const D=[],C=[];for(let S=this._namespaceList.length-1;S>=0;S--)this._namespaceList[S].drainQueuedTransitions(n).forEach(T=>{const F=T.player,I=T.element;if(D.push(F),this.collectedEnterElements.length){const q=I[Uo];if(q&&q.setForMove){if(q.previousTriggersValues&&q.previousTriggersValues.has(T.triggerName)){const se=q.previousTriggersValues.get(T.triggerName),G=this.statesByElement.get(T.element);G&&G[T.triggerName]&&(G[T.triggerName].value=se)}return void F.destroy()}}const j=!f||!this.driver.containsElement(f,I),V=v.get(I),U=p.get(I),L=this._buildInstruction(T,i,U,V,j);if(L.errors&&L.errors.length)return void C.push(L);if(j)return F.onStart(()=>up(I,L.fromStyles)),F.onDestroy(()=>nu(I,L.toStyles)),void r.push(F);if(T.isFallbackTransition)return F.onStart(()=>up(I,L.fromStyles)),F.onDestroy(()=>nu(I,L.toStyles)),void r.push(F);const W=[];L.timelines.forEach(q=>{q.stretchStartingKeyframe=!0,this.disabledNodes.has(q.element)||W.push(q)}),L.timelines=W,i.append(I,L.timelines),o.push({instruction:L,player:F,element:I}),L.queriedElements.forEach(q=>so(a,q,[]).push(F)),L.preStyleProps.forEach((q,se)=>{const G=Object.keys(q);if(G.length){let X=l.get(se);X||l.set(se,X=new Set),G.forEach(ee=>X.add(ee))}}),L.postStyleProps.forEach((q,se)=>{const G=Object.keys(q);let X=u.get(se);X||u.set(se,X=new Set),G.forEach(ee=>X.add(ee))})});if(C.length){const S=[];C.forEach(k=>{S.push(function Tet(e,t){return new Ee(3505,_t)}())}),D.forEach(k=>k.destroy()),this.reportError(S)}const w=new Map,E=new Map;o.forEach(S=>{const k=S.element;i.has(k)&&(E.set(k,k),this._beforeAnimationBuild(S.player.namespaceId,S.instruction,w))}),r.forEach(S=>{const k=S.element;this._getPreviousPlayers(k,!1,S.namespaceId,S.triggerName,null).forEach(F=>{so(w,k,[]).push(F),F.destroy()})});const O=m.filter(S=>$ue(S,l,u)),M=new Map;Lue(M,this.driver,y,u,lc).forEach(S=>{$ue(S,l,u)&&O.push(S)});const R=new Map;h.forEach((S,k)=>{Lue(R,this.driver,new Set(S),l,"!")}),O.forEach(S=>{const k=M.get(S),T=R.get(S);M.set(S,Object.assign(Object.assign({},k),T))});const P=[],A=[],x={};o.forEach(S=>{const{element:k,player:T,instruction:F}=S;if(i.has(k)){if(c.has(k))return T.onDestroy(()=>nu(k,F.toStyles)),T.disabled=!0,T.overrideTotalTime(F.totalTime),void r.push(T);let I=x;if(E.size>1){let V=k;const U=[];for(;V=V.parentNode;){const L=E.get(V);if(L){I=L;break}U.push(V)}U.forEach(L=>E.set(L,I))}const j=this._buildAnimation(T.namespaceId,F,w,s,R,M);if(T.setRealPlayer(j),I===x)P.push(T);else{const V=this.playersByElement.get(I);V&&V.length&&(T.parentPlayer=id(V)),r.push(T)}}else up(k,F.fromStyles),T.onDestroy(()=>nu(k,F.toStyles)),A.push(T),c.has(k)&&r.push(T)}),A.forEach(S=>{const k=s.get(S.element);if(k&&k.length){const T=id(k);S.setRealPlayer(T)}}),r.forEach(S=>{S.parentPlayer?S.syncPlayerEvents(S.parentPlayer):S.destroy()});for(let S=0;S<m.length;S++){const k=m[S],T=k[Uo];if(g0(k,pA),T&&T.hasAnimation)continue;let F=[];if(a.size){let j=a.get(k);j&&j.length&&F.push(...j);let V=this.driver.query(k,L5,!0);for(let U=0;U<V.length;U++){let L=a.get(V[U]);L&&L.length&&F.push(...L)}}const I=F.filter(j=>!j.destroyed);I.length?Ttt(this,k,I):this.processLeaveNode(k)}return m.length=0,P.forEach(S=>{this.players.push(S),S.onDone(()=>{S.destroy();const k=this.players.indexOf(S);this.players.splice(k,1)}),S.play()}),P}elementContainsData(t,n){let i=!1;const r=n[Uo];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(n)&&(i=!0),this.playersByQueriedElement.has(n)&&(i=!0),this.statesByElement.has(n)&&(i=!0),this._fetchNamespace(t).elementContainsData(n)||i}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,n,i,r,s){let o=[];if(n){const a=this.playersByQueriedElement.get(t);a&&(o=a)}else{const a=this.playersByElement.get(t);if(a){const l=!s||s==k1;a.forEach(u=>{u.queued||!l&&u.triggerName!=r||o.push(u)})}}return(i||r)&&(o=o.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(t,n,i){const s=n.element,o=n.isRemovalTransition?void 0:t,a=n.isRemovalTransition?void 0:n.triggerName;for(const l of n.timelines){const u=l.element,c=u!==s,f=so(i,u,[]);this._getPreviousPlayers(u,c,o,a,n.toState).forEach(h=>{const p=h.getRealPlayer();p.beforeDestroy&&p.beforeDestroy(),h.destroy(),f.push(h)})}up(s,n.fromStyles)}_buildAnimation(t,n,i,r,s,o){const a=n.triggerName,l=n.element,u=[],c=new Set,f=new Set,d=n.timelines.map(p=>{const g=p.element;c.add(g);const m=g[Uo];if(m&&m.removedBeforeQueried)return new M1(p.duration,p.delay);const _=g!==l,y=function Ott(e){const t=[];return Bue(e,t),t}((i.get(g)||wtt).map(w=>w.getRealPlayer())).filter(w=>!!w.element&&w.element===g),v=s.get(g),b=o.get(g),D=fue(0,this._normalizer,0,p.keyframes,v,b),C=this._buildPlayer(p,D,y);if(p.subTimeline&&r&&f.add(g),_){const w=new X5(t,a,g);w.setRealPlayer(C),u.push(w)}return C});u.forEach(p=>{so(this.playersByQueriedElement,p.element,[]).push(p),p.onDone(()=>function Stt(e,t,n){let i;if(e instanceof Map){if(i=e.get(t),i){if(i.length){const r=i.indexOf(n);i.splice(r,1)}0==i.length&&e.delete(t)}}else if(i=e[t],i){if(i.length){const r=i.indexOf(n);i.splice(r,1)}0==i.length&&delete e[t]}return i}(this.playersByQueriedElement,p.element,p))}),c.forEach(p=>zo(p,wue));const h=id(d);return h.onDestroy(()=>{c.forEach(p=>g0(p,wue)),nu(l,n.toStyles)}),f.forEach(p=>{so(r,p,[]).push(h)}),h}_buildPlayer(t,n,i){return n.length>0?this.driver.animate(t.element,n,t.duration,t.delay,t.easing,i):new M1(t.duration,t.delay)}}class X5{constructor(t,n,i){this.namespaceId=t,this.triggerName=n,this.element=i,this._player=new M1,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(n=>{this._queuedCallbacks[n].forEach(i=>M5(t,n,void 0,i))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const n=this._player;n.triggerCallback&&t.onStart(()=>n.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,n){so(this._queuedCallbacks,t,[]).push(n)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const n=this._player;n.triggerCallback&&n.triggerCallback(t)}}function OA(e){return e&&1===e.nodeType}function Pue(e,t){const n=e.style.display;return e.style.display=null!=t?t:"none",n}function Lue(e,t,n,i,r){const s=[];n.forEach(l=>s.push(Pue(l)));const o=[];i.forEach((l,u)=>{const c={};l.forEach(f=>{const d=c[f]=t.computeStyle(u,f,r);(!d||0==d.length)&&(u[Uo]=Dtt,o.push(u))}),e.set(u,c)});let a=0;return n.forEach(l=>Pue(l,s[a++])),o}function jue(e,t){const n=new Map;if(e.forEach(a=>n.set(a,[])),0==t.length)return n;const r=new Set(t),s=new Map;function o(a){if(!a)return 1;let l=s.get(a);if(l)return l;const u=a.parentNode;return l=n.has(u)?u:r.has(u)?1:o(u),s.set(a,l),l}return t.forEach(a=>{const l=o(a);1!==l&&n.get(l).push(a)}),n}function zo(e,t){var n;null===(n=e.classList)||void 0===n||n.add(t)}function g0(e,t){var n;null===(n=e.classList)||void 0===n||n.remove(t)}function Ttt(e,t,n){id(n).onDone(()=>e.processLeaveNode(t))}function Bue(e,t){for(let n=0;n<e.length;n++){const i=e[n];i instanceof uue?Bue(i.players,t):t.push(i)}}function $ue(e,t,n){const i=n.get(e);if(!i)return!1;let r=t.get(e);return r?i.forEach(s=>r.add(s)):t.set(e,i),n.delete(e),!0}class MA{constructor(t,n,i){this.bodyNode=t,this._driver=n,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new Ett(t,n,i),this._timelineEngine=new mtt(t,n,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(t,n,i,r,s){const o=t+"-"+r;let a=this._triggerCache[o];if(!a){const l=[],c=V5(this._driver,s,l,[]);if(l.length)throw function met(e,t){return new Ee(3404,_t)}();a=function dtt(e,t,n){return new htt(e,t,n)}(r,c,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(n,r,a)}register(t,n){this._transitionEngine.register(t,n)}destroy(t,n){this._transitionEngine.destroy(t,n)}onInsert(t,n,i,r){this._transitionEngine.insertNode(t,n,i,r)}onRemove(t,n,i,r){this._transitionEngine.removeNode(t,n,r||!1,i)}disableAnimations(t,n){this._transitionEngine.markElementAsDisabled(t,n)}process(t,n,i,r){if("@"==i.charAt(0)){const[s,o]=due(i);this._timelineEngine.command(s,n,o,r)}else this._transitionEngine.trigger(t,n,i,r)}listen(t,n,i,r,s){if("@"==i.charAt(0)){const[o,a]=due(i);return this._timelineEngine.listen(o,n,a,s)}return this._transitionEngine.listen(t,n,i,r,s)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let ktt=(()=>{class e{constructor(n,i,r){this._element=n,this._startStyles=i,this._endStyles=r,this._state=0;let s=e.initialStylesByElement.get(n);s||e.initialStylesByElement.set(n,s={}),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&nu(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(nu(this._element,this._initialStyles),this._endStyles&&(nu(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(up(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(up(this._element,this._endStyles),this._endStyles=null),nu(this._element,this._initialStyles),this._state=3)}}return e.initialStylesByElement=new WeakMap,e})();function Q5(e){let t=null;const n=Object.keys(e);for(let i=0;i<n.length;i++){const r=n[i];Itt(r)&&(t=t||{},t[r]=e[r])}return t}function Itt(e){return"display"===e||"position"===e}class Vue{constructor(t,n,i,r){this.element=t,this.keyframes=n,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,n,i){return t.animate(n,i)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};if(this.hasStarted()){const n=this._finalKeyframe;Object.keys(n).forEach(i=>{"offset"!=i&&(t[i]=this._finished?n[i]:xue(this.element,i))})}this.currentSnapshot=t}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(i=>i()),n.length=0}}class Rtt{validateStyleProperty(t){return mue(t)}matchesElement(t,n){return!1}containsElement(t,n){return _ue(t,n)}getParentElement(t){return R5(t)}query(t,n,i){return yue(t,n,i)}computeStyle(t,n,i){return window.getComputedStyle(t)[n]}animate(t,n,i,r,s,o=[]){const l={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(l.easing=s);const u={},c=o.filter(d=>d instanceof Vue);(function jet(e,t){return 0===e||0===t})(i,r)&&c.forEach(d=>{let h=d.currentSnapshot;Object.keys(h).forEach(p=>u[p]=h[p])}),n=function Bet(e,t,n){const i=Object.keys(n);if(i.length&&t.length){let s=t[0],o=[];if(i.forEach(a=>{s.hasOwnProperty(a)||o.push(a),s[a]=n[a]}),o.length)for(var r=1;r<t.length;r++){let a=t[r];o.forEach(function(l){a[l]=xue(e,l)})}}return t}(t,n=n.map(d=>rd(d,!1)),u);const f=function Ntt(e,t){let n=null,i=null;return Array.isArray(t)&&t.length?(n=Q5(t[0]),t.length>1&&(i=Q5(t[t.length-1]))):t&&(n=Q5(t)),n||i?new ktt(e,n,i):null}(t,n);return new Vue(t,n,l,f)}}let Ftt=(()=>{class e extends sue{constructor(n,i){super(),this._nextAnimationId=0,this._renderer=n.createRenderer(i.body,{id:"0",encapsulation:Yo.None,styles:[],data:{animation:[]}})}build(n){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(n)?oue(n):n;return Hue(this._renderer,null,i,"register",[r]),new Ptt(i,this._renderer)}}return e.\u0275fac=function(n){return new(n||e)(ge(eg),ge(si))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})();class Ptt extends class qZe{}{constructor(t,n){super(),this._id=t,this._renderer=n}create(t,n){return new Ltt(this._id,t,n||{},this._renderer)}}class Ltt{constructor(t,n,i,r){this.id=t,this.element=n,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(t,n){return this._renderer.listen(this.element,`@@${this.id}:${t}`,n)}_command(t,...n){return Hue(this._renderer,this.element,this.id,t,n)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){var t,n;return null!==(n=null===(t=this._renderer.engine.players[+this.id])||void 0===t?void 0:t.getPosition())&&void 0!==n?n:0}}function Hue(e,t,n,i,r){return e.setProperty(t,`@@${n}:${i}`,r)}const Uue="@.disabled";let jtt=(()=>{class e{constructor(n,i,r){this.delegate=n,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(s,o)=>{const a=null==o?void 0:o.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(n,i){const s=this.delegate.createRenderer(n,i);if(!(n&&i&&i.data&&i.data.animation)){let c=this._rendererCache.get(s);return c||(c=new zue("",s,this.engine),this._rendererCache.set(s,c)),c}const o=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,n);const l=c=>{Array.isArray(c)?c.forEach(l):this.engine.registerTrigger(o,a,n,c.name,c)};return i.data.animation.forEach(l),new Btt(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(n,i,r){n>=0&&n<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return e.\u0275fac=function(n){return new(n||e)(ge(eg),ge(MA),ge(hn))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})();class zue{constructor(t,n,i){this.namespaceId=t,this.delegate=n,this.engine=i,this.destroyNode=this.delegate.destroyNode?r=>n.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,n){return this.delegate.createElement(t,n)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,n){this.delegate.appendChild(t,n),this.engine.onInsert(this.namespaceId,n,t,!1)}insertBefore(t,n,i,r=!0){this.delegate.insertBefore(t,n,i),this.engine.onInsert(this.namespaceId,n,t,r)}removeChild(t,n,i){this.engine.onRemove(this.namespaceId,n,this.delegate,i)}selectRootElement(t,n){return this.delegate.selectRootElement(t,n)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,n,i,r){this.delegate.setAttribute(t,n,i,r)}removeAttribute(t,n,i){this.delegate.removeAttribute(t,n,i)}addClass(t,n){this.delegate.addClass(t,n)}removeClass(t,n){this.delegate.removeClass(t,n)}setStyle(t,n,i,r){this.delegate.setStyle(t,n,i,r)}removeStyle(t,n,i){this.delegate.removeStyle(t,n,i)}setProperty(t,n,i){"@"==n.charAt(0)&&n==Uue?this.disableAnimations(t,!!i):this.delegate.setProperty(t,n,i)}setValue(t,n){this.delegate.setValue(t,n)}listen(t,n,i){return this.delegate.listen(t,n,i)}disableAnimations(t,n){this.engine.disableAnimations(t,n)}}class Btt extends zue{constructor(t,n,i,r){super(n,i,r),this.factory=t,this.namespaceId=n}setProperty(t,n,i){"@"==n.charAt(0)?"."==n.charAt(1)&&n==Uue?this.disableAnimations(t,i=void 0===i||!!i):this.engine.process(this.namespaceId,t,n.substr(1),i):this.delegate.setProperty(t,n,i)}listen(t,n,i){if("@"==n.charAt(0)){const r=function $tt(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(t);let s=n.substr(1),o="";return"@"!=s.charAt(0)&&([s,o]=function Vtt(e){const t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(t,n,i)}}let Htt=(()=>{class e extends MA{constructor(n,i,r){super(n.body,i,r)}ngOnDestroy(){this.flush()}}return e.\u0275fac=function(n){return new(n||e)(ge(si),ge(F5),ge(W5))},e.\u0275prov=Te({token:e,factory:e.\u0275fac}),e})();const Gue=new Xe("AnimationModuleType"),Wue=[{provide:sue,useClass:Ftt},{provide:W5,useFactory:function Utt(){return new att}},{provide:MA,useClass:Htt},{provide:eg,useFactory:function ztt(e,t,n){return new jtt(e,t,n)},deps:[aw,MA,hn]}],que=[{provide:F5,useFactory:()=>new Rtt},{provide:Gue,useValue:"BrowserAnimations"},...Wue],Gtt=[{provide:F5,useClass:vue},{provide:Gue,useValue:"NoopAnimations"},...Wue];let Wtt=(()=>{class e{static withConfig(n){return{ngModule:e,providers:n.disableAnimations?Gtt:que}}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e}),e.\u0275inj=Ot({providers:que,imports:[xU]}),e})(),qtt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Lt({type:e,bootstrap:[WZe]}),e.\u0275inj=Ot({providers:[dN,Tc,_1],imports:[[nz,Owe,xU,Wtt,UZe,BKe]]}),e})();(function A_e(){jH=!1})(),Bve().bootstrapModule(qtt).catch(e=>console.error(e))},559:Ln=>{"use strict";Ln.exports=function Dn(ue,Pt){if(ue===Pt)return!0;if(ue&&Pt&&"object"==typeof ue&&"object"==typeof Pt){if(ue.constructor!==Pt.constructor)return!1;var Yt,Kt,nn;if(Array.isArray(ue)){if((Yt=ue.length)!=Pt.length)return!1;for(Kt=Yt;0!=Kt--;)if(!Dn(ue[Kt],Pt[Kt]))return!1;return!0}if(ue.constructor===RegExp)return ue.source===Pt.source&&ue.flags===Pt.flags;if(ue.valueOf!==Object.prototype.valueOf)return ue.valueOf()===Pt.valueOf();if(ue.toString!==Object.prototype.toString)return ue.toString()===Pt.toString();if((Yt=(nn=Object.keys(ue)).length)!==Object.keys(Pt).length)return!1;for(Kt=Yt;0!=Kt--;)if(!Object.prototype.hasOwnProperty.call(Pt,nn[Kt]))return!1;for(Kt=Yt;0!=Kt--;){var ot=nn[Kt];if(!Dn(ue[ot],Pt[ot]))return!1}return!0}return ue!=ue&&Pt!=Pt}},245:Ln=>{"use strict";Ln.exports=function(Dn,ue){ue||(ue={}),"function"==typeof ue&&(ue={cmp:ue});var nn,Pt="boolean"==typeof ue.cycles&&ue.cycles,Yt=ue.cmp&&(nn=ue.cmp,function(ot){return function(Wn,At){return nn({key:Wn,value:ot[Wn]},{key:At,value:ot[At]})}}),Kt=[];return function nn(ot){if(ot&&ot.toJSON&&"function"==typeof ot.toJSON&&(ot=ot.toJSON()),void 0!==ot){if("number"==typeof ot)return isFinite(ot)?""+ot:"null";if("object"!=typeof ot)return JSON.stringify(ot);var Wn,At;if(Array.isArray(ot)){for(At="[",Wn=0;Wn<ot.length;Wn++)Wn&&(At+=","),At+=nn(ot[Wn])||"null";return At+"]"}if(null===ot)return"null";if(-1!==Kt.indexOf(ot)){if(Pt)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var xs=Kt.push(ot)-1,As=Object.keys(ot).sort(Yt&&Yt(ot));for(At="",Wn=0;Wn<As.length;Wn++){var St=As[Wn],pt=nn(ot[St]);!pt||(At&&(At+=","),At+=JSON.stringify(St)+":"+pt)}return Kt.splice(xs,1),"{"+At+"}"}}(Dn)}},478:Ln=>{var Dn=function(){"use strict";function ue(St,pt){return null!=pt&&St instanceof pt}var Pt,Yt,Kt;try{Pt=Map}catch(St){Pt=function(){}}try{Yt=Set}catch(St){Yt=function(){}}try{Kt=Promise}catch(St){Kt=function(){}}function nn(St,pt,Vi,lo,Go){"object"==typeof pt&&(Vi=pt.depth,lo=pt.prototype,Go=pt.includeNonEnumerable,pt=pt.circular);var Ya=[],Qi=[],Ka="undefined"!=typeof Buffer;return void 0===pt&&(pt=!0),void 0===Vi&&(Vi=1/0),function qe(Ue,qn){if(null===Ue)return null;if(0===qn)return Ue;var Tt,Yn;if("object"!=typeof Ue)return Ue;if(ue(Ue,Pt))Tt=new Pt;else if(ue(Ue,Yt))Tt=new Yt;else if(ue(Ue,Kt))Tt=new Kt(function(od,ad){Ue.then(function(ou){od(qe(ou,qn-1))},function(ou){ad(qe(ou,qn-1))})});else if(nn.__isArray(Ue))Tt=[];else if(nn.__isRegExp(Ue))Tt=new RegExp(Ue.source,As(Ue)),Ue.lastIndex&&(Tt.lastIndex=Ue.lastIndex);else if(nn.__isDate(Ue))Tt=new Date(Ue.getTime());else{if(Ka&&Buffer.isBuffer(Ue))return Tt=Buffer.allocUnsafe?Buffer.allocUnsafe(Ue.length):new Buffer(Ue.length),Ue.copy(Tt),Tt;ue(Ue,Error)?Tt=Object.create(Ue):void 0===lo?(Yn=Object.getPrototypeOf(Ue),Tt=Object.create(Yn)):(Tt=Object.create(lo),Yn=lo)}if(pt){var sd=Ya.indexOf(Ue);if(-1!=sd)return Qi[sd];Ya.push(Ue),Qi.push(Tt)}for(var Zr in ue(Ue,Pt)&&Ue.forEach(function(od,ad){var ou=qe(ad,qn-1),au=qe(od,qn-1);Tt.set(ou,au)}),ue(Ue,Yt)&&Ue.forEach(function(od){var ad=qe(od,qn-1);Tt.add(ad)}),Ue){var fp;Yn&&(fp=Object.getOwnPropertyDescriptor(Yn,Zr)),(!fp||null!=fp.set)&&(Tt[Zr]=qe(Ue[Zr],qn-1))}if(Object.getOwnPropertySymbols){var Ja=Object.getOwnPropertySymbols(Ue);for(Zr=0;Zr<Ja.length;Zr++){var iu=Ja[Zr];(ru=Object.getOwnPropertyDescriptor(Ue,iu))&&!ru.enumerable&&!Go||(Tt[iu]=qe(Ue[iu],qn-1),ru.enumerable||Object.defineProperty(Tt,iu,{enumerable:!1}))}}if(Go){var su=Object.getOwnPropertyNames(Ue);for(Zr=0;Zr<su.length;Zr++){var ru,dp=su[Zr];(ru=Object.getOwnPropertyDescriptor(Ue,dp))&&ru.enumerable||(Tt[dp]=qe(Ue[dp],qn-1),Object.defineProperty(Tt,dp,{enumerable:!1}))}}return Tt}(St,Vi)}function ot(St){return Object.prototype.toString.call(St)}function As(St){var pt="";return St.global&&(pt+="g"),St.ignoreCase&&(pt+="i"),St.multiline&&(pt+="m"),pt}return nn.clonePrototype=function(pt){if(null===pt)return null;var Vi=function(){};return Vi.prototype=pt,new Vi},nn.__objToStr=ot,nn.__isDate=function Wn(St){return"object"==typeof St&&"[object Date]"===ot(St)},nn.__isArray=function At(St){return"object"==typeof St&&"[object Array]"===ot(St)},nn.__isRegExp=function xs(St){return"object"==typeof St&&"[object RegExp]"===ot(St)},nn.__getRegExpFlags=As,nn}();Ln.exports&&(Ln.exports=Dn)},564:Ln=>{"use strict";var Dn=/("(?:[^\\"]|\\.)*")|[:,]/g;Ln.exports=function(Pt,Yt){var Kt,nn,ot;return Yt=Yt||{},Kt=JSON.stringify([1],void 0,void 0===Yt.indent?2:Yt.indent).slice(2,-3),nn=""===Kt?1/0:void 0===Yt.maxLength?80:Yt.maxLength,ot=Yt.replacer,function Wn(At,xs,As){var St,pt,Vi,lo,Go,Ya,Qi,Ka,qe,Ue,qn,Tt;if(At&&"function"==typeof At.toJSON&&(At=At.toJSON()),void 0===(qn=JSON.stringify(At,ot)))return qn;if(qn.length<=(Qi=nn-xs.length-As)&&(qe=qn.replace(Dn,function(Yn,sd){return sd||Yn+" "})).length<=Qi)return qe;if(null!=ot&&(At=JSON.parse(qn),ot=void 0),"object"==typeof At&&null!==At){if(Ka=xs+Kt,Vi=[],pt=0,Array.isArray(At))for(Ue="[",St="]",Qi=At.length;pt<Qi;pt++)Vi.push(Wn(At[pt],Ka,pt===Qi-1?0:1)||"null");else for(Ue="{",St="}",Qi=(Ya=Object.keys(At)).length;pt<Qi;pt++)lo=Ya[pt],Go=JSON.stringify(lo)+": ",void 0!==(Tt=Wn(At[lo],Ka,Go.length+(pt===Qi-1?0:1)))&&Vi.push(Go+Tt);if(Vi.length>0)return[Ue,Kt+Vi.join(",\n"+Ka),St].join("\n"+xs)}return qn}(Pt,"",0)}}},Ln=>{Ln(Ln.s=798)}]);