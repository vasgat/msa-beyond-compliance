var gnt=Object.defineProperty,mnt=Object.defineProperties,_nt=Object.getOwnPropertyDescriptors,cce=Object.getOwnPropertySymbols,ynt=Object.prototype.hasOwnProperty,vnt=Object.prototype.propertyIsEnumerable,dce=($n,En,de)=>En in $n?gnt($n,En,{enumerable:!0,configurable:!0,writable:!0,value:de}):$n[En]=de,fce=($n,En)=>{for(var de in En||(En={}))ynt.call(En,de)&&dce($n,de,En[de]);if(cce)for(var de of cce(En))vnt.call(En,de)&&dce($n,de,En[de]);return $n},hce=($n,En)=>mnt($n,_nt(En));(self.webpackChunkmsa_dashboard=self.webpackChunkmsa_dashboard||[]).push([[179],{825:($n,En,de)=>{"use strict";var Bt={};de.r(Bt),de.d(Bt,{JsonPatchError:()=>zn,_areEquals:()=>K_,applyOperation:()=>qf,applyPatch:()=>nD,applyReducer:()=>nAe,deepClone:()=>eAe,getValueByPointer:()=>tD,validate:()=>Bq,validator:()=>iD});var Jt={};de.r(Jt),de.d(Jt,{compare:()=>cAe,generate:()=>vN,observe:()=>uAe,unobserve:()=>lAe});var Xt={};de.r(Xt),de.d(Xt,{aggregate:()=>td,bin:()=>tI,collect:()=>nI,compare:()=>CY,countpattern:()=>iI,cross:()=>rI,density:()=>sI,dotbin:()=>aI,expression:()=>OY,extent:()=>lI,facet:()=>jD,field:()=>NY,filter:()=>cI,flatten:()=>dI,fold:()=>fI,formula:()=>hI,generate:()=>kY,impute:()=>pI,joinaggregate:()=>gI,kde:()=>mI,key:()=>IY,load:()=>RY,lookup:()=>yI,multiextent:()=>FY,multivalues:()=>PY,params:()=>LY,pivot:()=>vI,prefacet:()=>jY,project:()=>bI,proxy:()=>BY,quantile:()=>wI,relay:()=>$Y,sample:()=>DI,sequence:()=>CI,sieve:()=>VY,subflow:()=>uI,timeunit:()=>EI,tupleindex:()=>UY,values:()=>zY,window:()=>SI});var sn={};de.r(sn),de.d(sn,{interpolate:()=>ad,interpolateArray:()=>xNe,interpolateBasis:()=>TK,interpolateBasisClosed:()=>OK,interpolateCubehelix:()=>pke,interpolateCubehelixLong:()=>gke,interpolateDate:()=>FK,interpolateDiscrete:()=>XNe,interpolateHcl:()=>dke,interpolateHclLong:()=>fke,interpolateHsl:()=>ake,interpolateHslLong:()=>lke,interpolateHue:()=>QNe,interpolateLab:()=>cke,interpolateNumber:()=>Da,interpolateNumberArray:()=>VI,interpolateObject:()=>PK,interpolateRgb:()=>$I,interpolateRgbBasis:()=>ENe,interpolateRgbBasisClosed:()=>SNe,interpolateRound:()=>Ay,interpolateString:()=>LK,interpolateTransformCss:()=>tke,interpolateTransformSvg:()=>nke,interpolateZoom:()=>oke,piecewise:()=>ZI,quantize:()=>mke});var ct={};de.r(ct),de.d(ct,{bound:()=>TQ,identifier:()=>AF,mark:()=>NQ,overlap:()=>kQ,render:()=>jQ,viewlayout:()=>zQ});var Yn={};de.r(Yn),de.d(Yn,{axisticks:()=>GQ,datajoin:()=>WQ,encode:()=>YQ,legendentries:()=>KQ,linkpath:()=>MF,pie:()=>TF,scale:()=>tZ,sortitems:()=>rZ,stack:()=>NF});var Nt={};de.r(Nt),de.d(Nt,{contour:()=>uP,geojson:()=>fP,geopath:()=>hP,geopoint:()=>pP,geoshape:()=>gP,graticule:()=>mP,heatmap:()=>_P,isocontour:()=>oP,kde2d:()=>lP,projection:()=>bee});var Os={};de.r(Os),de.d(Os,{force:()=>CP});var Ns={};de.r(Ns),de.d(Ns,{nest:()=>kP,pack:()=>RP,partition:()=>PP,stratify:()=>LP,tree:()=>BP,treelinks:()=>$P,treemap:()=>HP});var Tt={};de.r(Tt),de.d(Tt,{label:()=>QP});var mt={};de.r(mt),de.d(mt,{loess:()=>ZP,regression:()=>t3});var qi={};de.r(qi),de.d(qi,{voronoi:()=>N3});var po={};de.r(po),de.d(po,{wordcloud:()=>I3});var Xo={};de.r(Xo),de.d(Xo,{crossfilter:()=>R3,resolvefilter:()=>F3});var el={};de.r(el),de.d(el,{Bounds:()=>di,CanvasHandler:()=>Yy,CanvasRenderer:()=>$C,DATE:()=>ds,DAY:()=>_r,DAYOFYEAR:()=>Dl,Dataflow:()=>Ug,Debug:()=>Uq,Error:()=>DN,EventStream:()=>TD,Gradient:()=>nX,GroupItem:()=>vC,HOURS:()=>Gs,Handler:()=>_d,Info:()=>Hq,Item:()=>yC,MILLISECONDS:()=>ba,MINUTES:()=>Ws,MONTH:()=>mr,Marks:()=>Ks,MultiPulse:()=>Ok,None:()=>Vq,Operator:()=>fn,Parameters:()=>MD,Pulse:()=>ed,QUARTER:()=>cs,RenderType:()=>vd,Renderer:()=>Nl,ResourceLoader:()=>kR,SECONDS:()=>ko,SVGHandler:()=>aF,SVGRenderer:()=>pF,SVGStringRenderer:()=>mF,Scenegraph:()=>nF,TIME_UNITS:()=>ek,Transform:()=>J,View:()=>eie,WEEK:()=>Di,Warn:()=>CN,YEAR:()=>Wi,accessor:()=>as,accessorFields:()=>fr,accessorName:()=>qn,array:()=>we,ascending:()=>lD,bandwidthNRD:()=>jk,bin:()=>rY,bootstrapCI:()=>sY,boundClip:()=>bQ,boundContext:()=>By,boundItem:()=>tF,boundMark:()=>FX,boundStroke:()=>zu,changeset:()=>Qf,clampRange:()=>tG,codegenExpression:()=>Jte,compare:()=>MN,constant:()=>gr,cumulativeLogNormal:()=>zk,cumulativeNormal:()=>RD,cumulativeUniform:()=>Yk,dayofyear:()=>BG,debounce:()=>TN,defaultLocale:()=>mk,definition:()=>JW,densityLogNormal:()=>Uk,densityNormal:()=>Bk,densityUniform:()=>Wk,domChild:()=>ps,domClear:()=>Aa,domCreate:()=>md,domFind:()=>iF,dotbin:()=>oY,error:()=>ee,expressionFunction:()=>fi,extend:()=>st,extent:()=>wl,extentIndex:()=>nG,falsy:()=>Hc,fastmap:()=>Ng,field:()=>ls,flush:()=>iG,font:()=>NC,fontFamily:()=>zy,fontSize:()=>Ol,format:()=>wD,formatLocale:()=>vD,formats:()=>Ek,hasOwnProperty:()=>ke,id:()=>J_,identity:()=>hr,inferType:()=>kW,inferTypes:()=>IW,ingest:()=>Vt,inherits:()=>fe,inrange:()=>kg,interpolate:()=>bR,interpolateColors:()=>hC,interpolateRange:()=>BJ,intersect:()=>mQ,intersectBoxLine:()=>rm,intersectPath:()=>BR,intersectPoint:()=>$R,intersectRule:()=>bX,isArray:()=>ne,isBoolean:()=>Uc,isDate:()=>zc,isFunction:()=>rt,isIterable:()=>rG,isNumber:()=>en,isObject:()=>Se,isRegExp:()=>sG,isString:()=>be,isTuple:()=>SD,key:()=>ON,lerp:()=>oG,lineHeight:()=>pd,loader:()=>DD,locale:()=>TW,logger:()=>EN,lruCache:()=>aG,markup:()=>hF,merge:()=>lG,mergeConfig:()=>Tg,multiLineOffset:()=>QR,one:()=>Mg,pad:()=>uG,panLinear:()=>Kq,panLog:()=>Jq,panPow:()=>Xq,panSymlog:()=>Qq,parse:()=>wHe,parseExpression:()=>z3,parseSelector:()=>Fd,path:()=>th,pathCurves:()=>xR,pathEqual:()=>wQ,pathParse:()=>tm,pathRectangle:()=>uX,pathRender:()=>Ry,pathSymbols:()=>lX,pathTrail:()=>cX,peek:()=>bt,point:()=>IC,projection:()=>sP,quantileLogNormal:()=>qk,quantileNormal:()=>FD,quantileUniform:()=>Kk,quantiles:()=>Pk,quantizeInterpolator:()=>$J,quarter:()=>Zq,quartiles:()=>Lk,random:()=>Io,randomInteger:()=>bOe,randomKDE:()=>Vk,randomLCG:()=>vOe,randomLogNormal:()=>lY,randomMixture:()=>uY,randomNormal:()=>$k,randomUniform:()=>cY,read:()=>LW,regressionExp:()=>fY,regressionLinear:()=>Jk,regressionLoess:()=>_Y,regressionLog:()=>dY,regressionPoly:()=>pY,regressionPow:()=>hY,regressionQuad:()=>Xk,renderModule:()=>zC,repeat:()=>X_,resetDefaultLocale:()=>hTe,resetSVGClipId:()=>fX,resetSVGDefIds:()=>vFe,responseType:()=>PW,runtimeContext:()=>Rne,sampleCurve:()=>LD,sampleLogNormal:()=>Hk,sampleNormal:()=>ID,sampleUniform:()=>Gk,scale:()=>Ft,sceneEqual:()=>yF,sceneFromJSON:()=>LX,scenePickVisit:()=>xC,sceneToJSON:()=>PX,sceneVisit:()=>Sa,sceneZOrder:()=>VR,scheme:()=>wR,serializeXML:()=>sQ,setRandom:()=>_Oe,span:()=>Q_,splitAccessPath:()=>bl,stringValue:()=>pe,textMetrics:()=>xa,timeBin:()=>rW,timeFloor:()=>GG,timeFormatLocale:()=>fy,timeInterval:()=>Bg,timeOffset:()=>KG,timeSequence:()=>QG,timeUnitSpecifier:()=>jG,timeUnits:()=>nk,toBoolean:()=>NN,toDate:()=>kN,toNumber:()=>pr,toSet:()=>va,toString:()=>IN,transform:()=>XW,transforms:()=>zg,truncate:()=>cG,truthy:()=>Oo,tupleid:()=>Pe,typeParsers:()=>wk,utcFloor:()=>WG,utcInterval:()=>$g,utcOffset:()=>JG,utcSequence:()=>ZG,utcdayofyear:()=>HG,utcquarter:()=>eG,utcweek:()=>UG,version:()=>DHe,visitArray:()=>qc,week:()=>$G,writeConfig:()=>Og,zero:()=>Vc,zoomLinear:()=>SN,zoomLog:()=>xN,zoomPow:()=>aD,zoomSymlog:()=>AN});var tr={};de.r(tr),de.d(tr,{accessPathDepth:()=>Vm,accessPathWithDatum:()=>rj,compile:()=>fJe,contains:()=>Dt,deepEqual:()=>Ul,deleteNestedProperty:()=>jS,duplicate:()=>nt,entries:()=>Ld,every:()=>ej,fieldIntersection:()=>ij,flatAccessWithDatum:()=>are,getFirstDefined:()=>hi,hasIntersection:()=>tj,hash:()=>wt,internalField:()=>cre,isBoolean:()=>Qv,isEmpty:()=>nn,isEqual:()=>$He,isInternalField:()=>dre,isNullOrFalse:()=>ZL,isNumeric:()=>BS,keys:()=>oe,logicalExpr:()=>Zv,mergeDeep:()=>sre,never:()=>rre,normalize:()=>Boe,normalizeAngle:()=>t1,omit:()=>oo,pick:()=>$m,prefixGenerator:()=>nj,removePathFromField:()=>sj,replaceAll:()=>Vh,replacePathInField:()=>Uo,resetIdCounter:()=>HHe,setEqual:()=>ore,some:()=>$h,stringify:()=>mn,titleCase:()=>e1,unique:()=>zl,uniqueId:()=>ure,vals:()=>Er,varName:()=>Fn,version:()=>gJe});var tl={};function Xe(e){return"function"==typeof e}function We(e){const n=e(i=>{Error.call(i),i.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}de.r(tl),de.d(tl,{dark:()=>FJe,excel:()=>PJe,fivethirtyeight:()=>BJe,ggplot2:()=>$Je,googlecharts:()=>QJe,latimes:()=>zJe,quartz:()=>qJe,urbaninstitute:()=>XJe,version:()=>ZJe,vox:()=>GJe});const Kn=We(e=>function(n){e(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function kt(e,t){if(e){const n=e.indexOf(t);0<=n&&e.splice(n,1)}}class Jn{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const s of n)s.remove(this);else n.remove(this);const{initialTeardown:i}=this;if(Xe(i))try{i()}catch(s){t=s instanceof Kn?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{bp(s)}catch(o){t=null!=t?t:[],o instanceof Kn?t=[...t,...o.errors]:t.push(o)}}if(t)throw new Kn(t)}}add(t){var n;if(t&&t!==this)if(this.closed)bp(t);else{if(t instanceof Jn){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}}_hasParent(t){const{_parentage:n}=this;return n===t||Array.isArray(n)&&n.includes(t)}_addParent(t){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t}_removeParent(t){const{_parentage:n}=this;n===t?this._parentage=null:Array.isArray(n)&&kt(n,t)}remove(t){const{_finalizers:n}=this;n&&kt(n,t),t instanceof Jn&&t._removeParent(this)}}Jn.EMPTY=(()=>{const e=new Jn;return e.closed=!0,e})();const ff=Jn.EMPTY;function rs(e){return e instanceof Jn||e&&"closed"in e&&Xe(e.remove)&&Xe(e.add)&&Xe(e.unsubscribe)}function bp(e){Xe(e)?e():e.unsubscribe()}const nl={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},du={setTimeout(e,t,...n){const{delegate:i}=du;return(null==i?void 0:i.setTimeout)?i.setTimeout(e,t,...n):setTimeout(e,t,...n)},clearTimeout(e){const{delegate:t}=du;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function fu(e){du.setTimeout(()=>{const{onUnhandledError:t}=nl;if(!t)throw e;t(e)})}function hu(){}const wp=pu("C",void 0,void 0);function pu(e,t,n){return{kind:e,value:t,error:n}}let gu=null;function H1(e){if(nl.useDeprecatedSynchronousErrorHandling){const t=!gu;if(t&&(gu={errorThrown:!1,error:null}),e(),t){const{errorThrown:n,error:i}=gu;if(gu=null,n)throw i}}else e()}class FA extends Jn{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,rs(t)&&t.add(this)):this.destination=yce}static create(t,n,i){return new U1(t,n,i)}next(t){this.isStopped?LA(function pf(e){return pu("N",e,void 0)}(t),this):this._next(t)}error(t){this.isStopped?LA(function hf(e){return pu("E",void 0,e)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?LA(wp,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const gce=Function.prototype.bind;function PA(e,t){return gce.call(e,t)}class mce{constructor(t){this.partialObserver=t}next(t){const{partialObserver:n}=this;if(n.next)try{n.next(t)}catch(i){z1(i)}}error(t){const{partialObserver:n}=this;if(n.error)try{n.error(t)}catch(i){z1(i)}else z1(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(n){z1(n)}}}class U1 extends FA{constructor(t,n,i){let r;if(super(),Xe(t)||!t)r={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=i?i:void 0};else{let s;this&&nl.useDeprecatedNextContext?(s=Object.create(t),s.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&PA(t.next,s),error:t.error&&PA(t.error,s),complete:t.complete&&PA(t.complete,s)}):r=t}this.destination=new mce(r)}}function z1(e){nl.useDeprecatedSynchronousErrorHandling?function pce(e){nl.useDeprecatedSynchronousErrorHandling&&gu&&(gu.errorThrown=!0,gu.error=e)}(e):fu(e)}function LA(e,t){const{onStoppedNotification:n}=nl;n&&du.setTimeout(()=>n(e,t))}const yce={closed:!0,next:hu,error:function _ce(e){throw e},complete:hu},jA="function"==typeof Symbol&&Symbol.observable||"@@observable";function mu(e){return e}let Qt=(()=>{class e{constructor(n){n&&(this._subscribe=n)}lift(n){const i=new e;return i.source=this,i.operator=n,i}subscribe(n,i,r){const s=function bce(e){return e&&e instanceof FA||function vce(e){return e&&Xe(e.next)&&Xe(e.error)&&Xe(e.complete)}(e)&&rs(e)}(n)?n:new U1(n,i,r);return H1(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(i){n.error(i)}}forEach(n,i){return new(i=i4(i))((r,s)=>{const o=new U1({next:a=>{try{n(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(n){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(n)}[jA](){return this}pipe(...n){return function n4(e){return 0===e.length?mu:1===e.length?e[0]:function(n){return e.reduce((i,r)=>r(i),n)}}(n)(this)}toPromise(n){return new(n=i4(n))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return e.create=t=>new e(t),e})();function i4(e){var t;return null!==(t=null!=e?e:nl.Promise)&&void 0!==t?t:Promise}const wce=We(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Pn=(()=>{class e extends Qt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const i=new r4(this,this);return i.operator=n,i}_throwIfClosed(){if(this.closed)throw new wce}next(n){H1(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(n)}})}error(n){H1(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:i}=this;for(;i.length;)i.shift().error(n)}})}complete(){H1(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:i,isStopped:r,observers:s}=this;return i||r?ff:(this.currentObservers=null,s.push(n),new Jn(()=>{this.currentObservers=null,kt(s,n)}))}_checkFinalizedStatuses(n){const{hasError:i,thrownError:r,isStopped:s}=this;i?n.error(r):s&&n.complete()}asObservable(){const n=new Qt;return n.source=this,n}}return e.create=(t,n)=>new r4(t,n),e})();class r4 extends Pn{constructor(t,n){super(),this.destination=t,this.source=n}next(t){var n,i;null===(i=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===i||i.call(n,t)}error(t){var n,i;null===(i=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===i||i.call(n,t)}complete(){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===n||n.call(t)}_subscribe(t){var n,i;return null!==(i=null===(n=this.source)||void 0===n?void 0:n.subscribe(t))&&void 0!==i?i:ff}}function s4(e){return Xe(null==e?void 0:e.lift)}function Xn(e){return t=>{if(s4(t))return t.lift(function(n){try{return e(n,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function yn(e,t,n,i,r){return new Dce(e,t,n,i,r)}class Dce extends FA{constructor(t,n,i,r,s,o){super(t),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(l){t.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){t.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function ot(e,t){return Xn((n,i)=>{let r=0;n.subscribe(yn(i,s=>{i.next(e.call(t,s,r++))}))})}function gf(e){return this instanceof gf?(this.v=e,this):new gf(e)}function Sce(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(f){i[f]&&(r[f]=function(h){return new Promise(function(p,g){s.push([f,h,p,g])>1||a(f,h)})})}function a(f,h){try{!function l(f){f.value instanceof gf?Promise.resolve(f.value.v).then(u,c):d(s[0][2],f)}(i[f](h))}catch(p){d(s[0][3],p)}}function u(f){a("next",f)}function c(f){a("throw",f)}function d(f,h){f(h),s.shift(),s.length&&a(s[0][0],s[0][1])}}function xce(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,t=e[Symbol.asyncIterator];return t?t.call(e):(e=function l4(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(s){n[s]=e[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}(a,l,(o=e[s](o)).done,o.value)})}}}const $A=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function u4(e){return Xe(null==e?void 0:e.then)}function c4(e){return Xe(e[jA])}function d4(e){return Symbol.asyncIterator&&Xe(null==e?void 0:e[Symbol.asyncIterator])}function f4(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const h4=function Mce(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function p4(e){return Xe(null==e?void 0:e[h4])}function g4(e){return Sce(this,arguments,function*(){const n=e.getReader();try{for(;;){const{value:i,done:r}=yield gf(n.read());if(r)return yield gf(void 0);yield yield gf(i)}}finally{n.releaseLock()}})}function m4(e){return Xe(null==e?void 0:e.getReader)}function nr(e){if(e instanceof Qt)return e;if(null!=e){if(c4(e))return function Tce(e){return new Qt(t=>{const n=e[jA]();if(Xe(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if($A(e))return function Oce(e){return new Qt(t=>{for(let n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(u4(e))return function Nce(e){return new Qt(t=>{e.then(n=>{t.closed||(t.next(n),t.complete())},n=>t.error(n)).then(null,fu)})}(e);if(d4(e))return _4(e);if(p4(e))return function kce(e){return new Qt(t=>{for(const n of e)if(t.next(n),t.closed)return;t.complete()})}(e);if(m4(e))return function Ice(e){return _4(g4(e))}(e)}throw f4(e)}function _4(e){return new Qt(t=>{(function Rce(e,t){var n,i,r,s;return function Cce(e,t,n,i){return new(n||(n=Promise))(function(s,o){function a(c){try{u(i.next(c))}catch(d){o(d)}}function l(c){try{u(i.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):function r(s){return s instanceof n?s:new n(function(o){o(s)})}(c.value).then(a,l)}u((i=i.apply(e,t||[])).next())})}(this,void 0,void 0,function*(){try{for(n=xce(e);!(i=yield n.next()).done;)if(t.next(i.value),t.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=n.return)&&(yield s.call(n))}finally{if(r)throw r.error}}t.complete()})})(e,t).catch(n=>t.error(n))})}function _u(e,t,n,i=0,r=!1){const s=t.schedule(function(){n(),r?e.add(this.schedule(null,i)):this.unsubscribe()},i);if(e.add(s),!r)return s}function Qn(e,t,n=1/0){return Xe(t)?Qn((i,r)=>ot((s,o)=>t(i,s,r,o))(nr(e(i,r))),n):("number"==typeof t&&(n=t),Xn((i,r)=>function Fce(e,t,n,i,r,s,o,a){const l=[];let u=0,c=0,d=!1;const f=()=>{d&&!l.length&&!u&&t.complete()},h=g=>u<i?p(g):l.push(g),p=g=>{s&&t.next(g),u++;let m=!1;nr(n(g,c++)).subscribe(yn(t,_=>{null==r||r(_),s?h(_):t.next(_)},()=>{m=!0},void 0,()=>{if(m)try{for(u--;l.length&&u<i;){const _=l.shift();o?_u(t,o,()=>p(_)):p(_)}f()}catch(_){t.error(_)}}))};return e.subscribe(yn(t,h,()=>{d=!0,f()})),()=>{null==a||a()}}(i,r,e,n)))}function D0(e=1/0){return Qn(mu,e)}const Qo=new Qt(e=>e.complete());function y4(e){return e&&Xe(e.schedule)}function VA(e){return e[e.length-1]}function q1(e){return Xe(VA(e))?e.pop():void 0}function C0(e){return y4(VA(e))?e.pop():void 0}function v4(e,t=0){return Xn((n,i)=>{n.subscribe(yn(i,r=>_u(i,e,()=>i.next(r),t),()=>_u(i,e,()=>i.complete(),t),r=>_u(i,e,()=>i.error(r),t)))})}function b4(e,t=0){return Xn((n,i)=>{i.add(e.schedule(()=>n.subscribe(i),t))})}function w4(e,t){if(!e)throw new Error("Iterable cannot be null");return new Qt(n=>{_u(n,t,()=>{const i=e[Symbol.asyncIterator]();_u(n,t,()=>{i.next().then(r=>{r.done?n.complete():n.next(r.value)})},0,!0)})})}function Ti(e,t){return t?function Uce(e,t){if(null!=e){if(c4(e))return function jce(e,t){return nr(e).pipe(b4(t),v4(t))}(e,t);if($A(e))return function $ce(e,t){return new Qt(n=>{let i=0;return t.schedule(function(){i===e.length?n.complete():(n.next(e[i++]),n.closed||this.schedule())})})}(e,t);if(u4(e))return function Bce(e,t){return nr(e).pipe(b4(t),v4(t))}(e,t);if(d4(e))return w4(e,t);if(p4(e))return function Vce(e,t){return new Qt(n=>{let i;return _u(n,t,()=>{i=e[h4](),_u(n,t,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void n.error(o)}s?n.complete():n.next(r)},0,!0)}),()=>Xe(null==i?void 0:i.return)&&i.return()})}(e,t);if(m4(e))return function Hce(e,t){return w4(g4(e),t)}(e,t)}throw f4(e)}(e,t):nr(e)}function D4(...e){const t=C0(e),n=function Lce(e,t){return"number"==typeof VA(e)?e.pop():t}(e,1/0),i=e;return i.length?1===i.length?nr(i[0]):D0(n)(Ti(i,t)):Qo}function gi(e){return e<=0?()=>Qo:Xn((t,n)=>{let i=0;t.subscribe(yn(n,r=>{++i<=e&&(n.next(r),e<=i&&n.complete())}))})}function C4(e={}){const{connector:t=(()=>new Pn),resetOnError:n=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=e;return s=>{let o=null,a=null,l=null,u=0,c=!1,d=!1;const f=()=>{null==a||a.unsubscribe(),a=null},h=()=>{f(),o=l=null,c=d=!1},p=()=>{const g=o;h(),null==g||g.unsubscribe()};return Xn((g,m)=>{u++,!d&&!c&&f();const _=l=null!=l?l:t();m.add(()=>{u--,0===u&&!d&&!c&&(a=HA(p,r))}),_.subscribe(m),o||(o=new U1({next:y=>_.next(y),error:y=>{d=!0,f(),a=HA(h,n,y),_.error(y)},complete:()=>{c=!0,f(),a=HA(h,i),_.complete()}}),Ti(g).subscribe(o))})(s)}}function HA(e,t,...n){return!0===t?(e(),null):!1===t?null:t(...n).pipe(gi(1)).subscribe(()=>e())}function on(e){for(let t in e)if(e[t]===on)return t;throw Error("Could not find renamed property on target object.")}function UA(e,t){for(const n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function Yt(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(Yt).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function zA(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const zce=on({__forward_ref__:on});function Ot(e){return e.__forward_ref__=Ot,e.toString=function(){return Yt(this())},e}function at(e){return E4(e)?e():e}function E4(e){return"function"==typeof e&&e.hasOwnProperty(zce)&&e.__forward_ref__===Ot}class xe extends Error{constructor(t,n){super(function qA(e,t){return`NG0${Math.abs(e)}${t?": "+t:""}`}(t,n)),this.code=t}}function Qe(e){return"string"==typeof e?e:null==e?"":String(e)}function Tr(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Qe(e)}function G1(e,t){const n=t?` in ${t}`:"";throw new xe(-201,`No provider for ${Tr(e)} found${n}`)}function Is(e,t){null==e&&function vn(e,t,n,i){throw new Error(`ASSERTION ERROR: ${e}`+(null==i?"":` [Expected=> ${n} ${i} ${t} <=Actual]`))}(t,e,null,"!=")}function Oe(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function It(e){return{providers:e.providers||[],imports:e.imports||[]}}function GA(e){return S4(e,W1)||S4(e,A4)}function S4(e,t){return e.hasOwnProperty(t)?e[t]:null}function x4(e){return e&&(e.hasOwnProperty(WA)||e.hasOwnProperty(Xce))?e[WA]:null}const W1=on({\u0275prov:on}),WA=on({\u0275inj:on}),A4=on({ngInjectableDef:on}),Xce=on({ngInjectorDef:on});var Ye=(()=>((Ye=Ye||{})[Ye.Default=0]="Default",Ye[Ye.Host=1]="Host",Ye[Ye.Self=2]="Self",Ye[Ye.SkipSelf=4]="SkipSelf",Ye[Ye.Optional=8]="Optional",Ye))();let YA;function yc(e){const t=YA;return YA=e,t}function M4(e,t,n){const i=GA(e);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:n&Ye.Optional?null:void 0!==t?t:void G1(Yt(e),"Injector")}function vc(e){return{toString:e}.toString()}var Zo=(()=>((Zo=Zo||{})[Zo.OnPush=0]="OnPush",Zo[Zo.Default=1]="Default",Zo))(),ea=(()=>{return(e=ea||(ea={}))[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",ea;var e})();const Zce="undefined"!=typeof globalThis&&globalThis,ede="undefined"!=typeof window&&window,tde="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Zt=Zce||"undefined"!=typeof global&&global||ede||tde,Dp={},an=[],Y1=on({\u0275cmp:on}),KA=on({\u0275dir:on}),JA=on({\u0275pipe:on}),T4=on({\u0275mod:on}),vu=on({\u0275fac:on}),E0=on({__NG_ELEMENT_ID__:on});let nde=0;function bn(e){return vc(()=>{const n={},i={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===Zo.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||an,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||ea.Emulated,id:"c",styles:e.styles||an,_:null,setInput:null,schemas:e.schemas||null,tView:null},r=e.directives,s=e.features,o=e.pipes;return i.id+=nde++,i.inputs=I4(e.inputs,n),i.outputs=I4(e.outputs),s&&s.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(O4):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(N4):null,i})}function O4(e){return rr(e)||function bc(e){return e[KA]||null}(e)}function N4(e){return function mf(e){return e[JA]||null}(e)}const k4={};function $t(e){return vc(()=>{const t={type:e.type,bootstrap:e.bootstrap||an,declarations:e.declarations||an,imports:e.imports||an,exports:e.exports||an,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(k4[e.id]=e.type),t})}function I4(e,t){if(null==e)return Dp;const n={};for(const i in e)if(e.hasOwnProperty(i)){let r=e[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),n[r]=i,t&&(t[r]=s)}return n}const ye=bn;function ir(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function rr(e){return e[Y1]||null}function go(e,t){const n=e[T4]||null;if(!n&&!0===t)throw new Error(`Type ${Yt(e)} does not have '\u0275mod' property.`);return n}function il(e){return Array.isArray(e)&&"object"==typeof e[1]}function na(e){return Array.isArray(e)&&!0===e[1]}function ZA(e){return 0!=(8&e.flags)}function Q1(e){return 2==(2&e.flags)}function Z1(e){return 1==(1&e.flags)}function ia(e){return null!==e.template}function lde(e){return 0!=(512&e[2])}function bf(e,t){return e.hasOwnProperty(vu)?e[vu]:null}class dde{constructor(t,n,i){this.previousValue=t,this.currentValue=n,this.firstChange=i}isFirstChange(){return this.firstChange}}function xn(){return F4}function F4(e){return e.type.prototype.ngOnChanges&&(e.setInput=hde),fde}function fde(){const e=L4(this),t=null==e?void 0:e.current;if(t){const n=e.previous;if(n===Dp)e.previous=t;else for(let i in t)n[i]=t[i];e.current=null,this.ngOnChanges(t)}}function hde(e,t,n,i){const r=L4(e)||function pde(e,t){return e[P4]=t}(e,{previous:Dp,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[n],l=o[a];s[a]=new dde(l&&l.currentValue,t,o===Dp),e[i]=t}xn.ngInherit=!0;const P4="__ngSimpleChanges__";function L4(e){return e[P4]||null}let rM;function Vn(e){return!!e.listen}const j4={createRenderer:(e,t)=>function sM(){return void 0!==rM?rM:"undefined"!=typeof document?document:void 0}()};function si(e){for(;Array.isArray(e);)e=e[0];return e}function eb(e,t){return si(t[e])}function yo(e,t){return si(t[e.index])}function oM(e,t){return e.data[t]}function Ap(e,t){return e[t]}function Fs(e,t){const n=t[e];return il(n)?n:n[0]}function B4(e){return 4==(4&e[2])}function aM(e){return 128==(128&e[2])}function wc(e,t){return null==t?null:e[t]}function $4(e){e[18]=0}function lM(e,t){e[5]+=t;let n=e,i=e[3];for(;null!==i&&(1===t&&1===n[5]||-1===t&&0===n[5]);)i[5]+=t,n=i,i=i[3]}const qe={lFrame:Y4(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function V4(){return qe.bindingsEnabled}function ae(){return qe.lFrame.lView}function Ct(){return qe.lFrame.tView}function or(e){return qe.lFrame.contextLView=e,e[8]}function mi(){let e=H4();for(;null!==e&&64===e.type;)e=e.parent;return e}function H4(){return qe.lFrame.currentTNode}function rl(e,t){const n=qe.lFrame;n.currentTNode=e,n.isParent=t}function uM(){return qe.lFrame.isParent}function cM(){qe.lFrame.isParent=!1}function tb(){return qe.isInCheckNoChangesMode}function nb(e){qe.isInCheckNoChangesMode=e}function Or(){const e=qe.lFrame;let t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function Mp(){return qe.lFrame.bindingIndex++}function wu(e){const t=qe.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function Nde(e,t){const n=qe.lFrame;n.bindingIndex=n.bindingRootIndex=e,dM(t)}function dM(e){qe.lFrame.currentDirectiveIndex=e}function q4(){return qe.lFrame.currentQueryIndex}function hM(e){qe.lFrame.currentQueryIndex=e}function Ide(e){const t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function G4(e,t,n){if(n&Ye.SkipSelf){let r=t,s=e;for(;!(r=r.parent,null!==r||n&Ye.Host||(r=Ide(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;t=r,e=s}const i=qe.lFrame=W4();return i.currentTNode=t,i.lView=e,!0}function ib(e){const t=W4(),n=e[1];qe.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function W4(){const e=qe.lFrame,t=null===e?null:e.child;return null===t?Y4(e):t}function Y4(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function K4(){const e=qe.lFrame;return qe.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const J4=K4;function rb(){const e=K4();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function Nr(){return qe.lFrame.selectedIndex}function Dc(e){qe.lFrame.selectedIndex=e}function Hn(){const e=qe.lFrame;return oM(e.tView,e.selectedIndex)}function sb(e,t){for(let n=t.directiveStart,i=t.directiveEnd;n<i;n++){const s=e.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:u,ngOnDestroy:c}=s;o&&(e.contentHooks||(e.contentHooks=[])).push(-n,o),a&&((e.contentHooks||(e.contentHooks=[])).push(n,a),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,a)),l&&(e.viewHooks||(e.viewHooks=[])).push(-n,l),u&&((e.viewHooks||(e.viewHooks=[])).push(n,u),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,u)),null!=c&&(e.destroyHooks||(e.destroyHooks=[])).push(n,c)}}function ob(e,t,n){X4(e,t,3,n)}function ab(e,t,n,i){(3&e[2])===n&&X4(e,t,n,i)}function pM(e,t){let n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function X4(e,t,n,i){const s=null!=i?i:-1,o=t.length-1;let a=0;for(let l=void 0!==i?65535&e[18]:0;l<o;l++)if("number"==typeof t[l+1]){if(a=t[l],null!=i&&a>=i)break}else t[l]<0&&(e[18]+=65536),(a<s||-1==s)&&(Hde(e,n,t,l),e[18]=(4294901760&e[18])+l+2),l++}function Hde(e,t,n,i){const r=n[i]<0,s=n[i+1],a=e[r?-n[i]:n[i]];if(r){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class T0{constructor(t,n,i){this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=i}}function lb(e,t,n){const i=Vn(e);let r=0;for(;r<n.length;){const s=n[r];if("number"==typeof s){if(0!==s)break;r++;const o=n[r++],a=n[r++],l=n[r++];i?e.setAttribute(t,a,l,o):t.setAttributeNS(o,a,l)}else{const o=s,a=n[++r];mM(o)?i&&e.setProperty(t,o,a):i?e.setAttribute(t,o,a):t.setAttribute(o,a),r++}}return r}function Q4(e){return 3===e||4===e||6===e}function mM(e){return 64===e.charCodeAt(0)}function ub(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else{let n=-1;for(let i=0;i<t.length;i++){const r=t[i];"number"==typeof r?n=r:0===n||Z4(e,n,r,null,-1===n||2===n?t[++i]:null)}}return e}function Z4(e,t,n,i,r){let s=0,o=e.length;if(-1===t)o=-1;else for(;s<e.length;){const a=e[s++];if("number"==typeof a){if(a===t){o=-1;break}if(a>t){o=s-1;break}}}for(;s<e.length;){const a=e[s];if("number"==typeof a)break;if(a===n){if(null===i)return void(null!==r&&(e[s+1]=r));if(i===e[s+1])return void(e[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(e.splice(o,0,t),s=o+1),e.splice(s++,0,n),null!==i&&e.splice(s++,0,i),null!==r&&e.splice(s++,0,r)}function e8(e){return-1!==e}function Tp(e){return 32767&e}function Op(e,t){let n=function Wde(e){return e>>16}(e),i=t;for(;n>0;)i=i[15],n--;return i}let _M=!0;function cb(e){const t=_M;return _M=e,t}let Yde=0;function N0(e,t){const n=vM(e,t);if(-1!==n)return n;const i=t[1];i.firstCreatePass&&(e.injectorIndex=t.length,yM(i.data,e),yM(t,null),yM(i.blueprint,null));const r=db(e,t),s=e.injectorIndex;if(e8(r)){const o=Tp(r),a=Op(r,t),l=a[1].data;for(let u=0;u<8;u++)t[s+u]=a[o+u]|l[o+u]}return t[s+8]=r,s}function yM(e,t){e.push(0,0,0,0,0,0,0,0,t)}function vM(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function db(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,i=null,r=t;for(;null!==r;){const s=r[1],o=s.type;if(i=2===o?s.declTNode:1===o?r[6]:null,null===i)return-1;if(n++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|n<<16}return-1}function fb(e,t,n){!function Kde(e,t,n){let i;"string"==typeof n?i=n.charCodeAt(0)||0:n.hasOwnProperty(E0)&&(i=n[E0]),null==i&&(i=n[E0]=Yde++);const r=255&i;t.data[e+(r>>5)]|=1<<r}(e,t,n)}function i8(e,t,n){if(n&Ye.Optional)return e;G1(t,"NodeInjector")}function r8(e,t,n,i){if(n&Ye.Optional&&void 0===i&&(i=null),0==(n&(Ye.Self|Ye.Host))){const r=e[9],s=yc(void 0);try{return r?r.get(t,i,n&Ye.Optional):M4(t,i,n&Ye.Optional)}finally{yc(s)}}return i8(i,t,n)}function s8(e,t,n,i=Ye.Default,r){if(null!==e){const s=function Zde(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(E0)?e[E0]:void 0;return"number"==typeof t?t>=0?255&t:Xde:t}(n);if("function"==typeof s){if(!G4(t,e,i))return i&Ye.Host?i8(r,n,i):r8(t,n,i,r);try{const o=s(i);if(null!=o||i&Ye.Optional)return o;G1(n)}finally{J4()}}else if("number"==typeof s){let o=null,a=vM(e,t),l=-1,u=i&Ye.Host?t[16][6]:null;for((-1===a||i&Ye.SkipSelf)&&(l=-1===a?db(e,t):t[a+8],-1!==l&&l8(i,!1)?(o=t[1],a=Tp(l),t=Op(l,t)):a=-1);-1!==a;){const c=t[1];if(a8(s,a,c.data)){const d=Qde(a,t,n,o,i,u);if(d!==o8)return d}l=t[a+8],-1!==l&&l8(i,t[1].data[a+8]===u)&&a8(s,a,t)?(o=c,a=Tp(l),t=Op(l,t)):a=-1}}}return r8(t,n,i,r)}const o8={};function Xde(){return new Np(mi(),ae())}function Qde(e,t,n,i,r,s){const o=t[1],a=o.data[e+8],c=hb(a,o,n,null==i?Q1(a)&&_M:i!=o&&0!=(3&a.type),r&Ye.Host&&s===a);return null!==c?k0(t,o,c,a):o8}function hb(e,t,n,i,r){const s=e.providerIndexes,o=t.data,a=1048575&s,l=e.directiveStart,c=s>>20,f=r?a+c:e.directiveEnd;for(let h=i?a:a+c;h<f;h++){const p=o[h];if(h<l&&n===p||h>=l&&p.type===n)return h}if(r){const h=o[l];if(h&&ia(h)&&h.type===n)return l}return null}function k0(e,t,n,i){let r=e[n];const s=t.data;if(function Ude(e){return e instanceof T0}(r)){const o=r;o.resolving&&function qce(e,t){const n=t?`. Dependency path: ${t.join(" > ")} > ${e}`:"";throw new xe(-200,`Circular dependency in DI detected for ${e}${n}`)}(Tr(s[n]));const a=cb(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?yc(o.injectImpl):null;G4(e,i,Ye.Default);try{r=e[n]=o.factory(void 0,s,e,i),t.firstCreatePass&&n>=i.directiveStart&&function Vde(e,t,n){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=t.type.prototype;if(i){const o=F4(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,o)}r&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,r),s&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s))}(n,s[n],t)}finally{null!==l&&yc(l),cb(a),o.resolving=!1,J4()}}return r}function a8(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function l8(e,t){return!(e&Ye.Self||e&Ye.Host&&t)}class Np{constructor(t,n){this._tNode=t,this._lView=n}get(t,n,i){return s8(this._tNode,this._lView,t,i,n)}}function ar(e){return vc(()=>{const t=e.prototype.constructor,n=t[vu]||bM(t),i=Object.prototype;let r=Object.getPrototypeOf(e.prototype).constructor;for(;r&&r!==i;){const s=r[vu]||bM(r);if(s&&s!==n)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function bM(e){return E4(e)?()=>{const t=bM(at(e));return t&&t()}:bf(e)}const Ip="__parameters__";function Fp(e,t,n){return vc(()=>{const i=function wM(e){return function(...n){if(e){const i=e(...n);for(const r in i)this[r]=i[r]}}}(t);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,u,c){const d=l.hasOwnProperty(Ip)?l[Ip]:Object.defineProperty(l,Ip,{value:[]})[Ip];for(;d.length<=c;)d.push(null);return(d[c]=d[c]||[]).push(o),l}}return n&&(r.prototype=Object.create(n.prototype)),r.prototype.ngMetadataName=e,r.annotationCls=r,r})}class it{constructor(t,n){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Oe({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}toString(){return`InjectionToken ${this._desc}`}}const tfe=new it("AnalyzeForEntryComponents");function vo(e,t){void 0===t&&(t=e);for(let n=0;n<e.length;n++){let i=e[n];Array.isArray(i)?(t===e&&(t=e.slice(0,n)),vo(i,t)):t!==e&&t.push(i)}return t}function sl(e,t){e.forEach(n=>Array.isArray(n)?sl(n,t):t(n))}function c8(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function pb(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function F0(e,t){const n=[];for(let i=0;i<e;i++)n.push(t);return n}function Ps(e,t,n){let i=Pp(e,t);return i>=0?e[1|i]=n:(i=~i,function rfe(e,t,n,i){let r=e.length;if(r==t)e.push(n,i);else if(1===r)e.push(i,e[0]),e[0]=n;else{for(r--,e.push(e[r-1],e[r]);r>t;)e[r]=e[r-2],r--;e[t]=n,e[t+1]=i}}(e,i,t,n)),i}function CM(e,t){const n=Pp(e,t);if(n>=0)return e[1|n]}function Pp(e,t){return function h8(e,t,n){let i=0,r=e.length>>n;for(;r!==i;){const s=i+(r-i>>1),o=e[s<<n];if(t===o)return s<<n;o>t?r=s:i=s+1}return~(r<<n)}(e,t,1)}const P0={},SM="__NG_DI_FLAG__",mb="ngTempTokenPath",dfe=/\n/gm,g8="__source",hfe=on({provide:String,useValue:on});let L0;function m8(e){const t=L0;return L0=e,t}function pfe(e,t=Ye.Default){if(void 0===L0)throw new xe(203,"");return null===L0?M4(e,void 0,t):L0.get(e,t&Ye.Optional?null:void 0,t)}function me(e,t=Ye.Default){return(function Qce(){return YA}()||pfe)(at(e),t)}const gfe=me;function xM(e){const t=[];for(let n=0;n<e.length;n++){const i=at(e[n]);if(Array.isArray(i)){if(0===i.length)throw new xe(900,"");let r,s=Ye.Default;for(let o=0;o<i.length;o++){const a=i[o],l=mfe(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}t.push(me(r,s))}else t.push(me(i))}return t}function j0(e,t){return e[SM]=t,e.prototype[SM]=t,e}function mfe(e){return e[SM]}const _b=j0(Fp("Inject",e=>({token:e})),-1),Ec=j0(Fp("Optional"),8),B0=j0(Fp("SkipSelf"),4);class S8{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function Sc(e){return e instanceof S8?e.changingThisBreaksApplicationSecurity:e}const jfe=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Bfe=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var oi=(()=>((oi=oi||{})[oi.NONE=0]="NONE",oi[oi.HTML=1]="HTML",oi[oi.STYLE=2]="STYLE",oi[oi.SCRIPT=3]="SCRIPT",oi[oi.URL=4]="URL",oi[oi.RESOURCE_URL=5]="RESOURCE_URL",oi))();function Bp(e){const t=function U0(){const e=ae();return e&&e[12]}();return t?t.sanitize(oi.URL,e)||"":function V0(e,t){const n=function Rfe(e){return e instanceof S8&&e.getTypeName()||null}(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===t}(e,"URL")?Sc(e):function wb(e){return(e=String(e)).match(jfe)||e.match(Bfe)?e:"unsafe:"+e}(Qe(e))}const F8="__ngContext__";function lr(e,t){e[F8]=t}function FM(e){const t=function z0(e){return e[F8]||null}(e);return t?Array.isArray(t)?t:t.lView:null}function LM(e){return e.ngOriginalError}function lhe(e,...t){e.error(...t)}class q0{constructor(){this._console=console}handleError(t){const n=this._findOriginalError(t),i=function ahe(e){return e&&e.ngErrorLogger||lhe}(t);i(this._console,"ERROR",t),n&&i(this._console,"ORIGINAL ERROR",n)}_findOriginalError(t){let n=t&&LM(t);for(;n&&LM(n);)n=LM(n);return n||null}}const yhe=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Zt))();function al(e){return e instanceof Function?e():e}var Ls=(()=>((Ls=Ls||{})[Ls.Important=1]="Important",Ls[Ls.DashCase=2]="DashCase",Ls))();function BM(e,t){return undefined(e,t)}function G0(e){const t=e[3];return na(t)?t[3]:t}function $M(e){return z8(e[13])}function VM(e){return z8(e[4])}function z8(e){for(;null!==e&&!na(e);)e=e[4];return e}function Vp(e,t,n,i,r){if(null!=i){let s,o=!1;na(i)?s=i:il(i)&&(o=!0,i=i[0]);const a=si(i);0===e&&null!==n?null==r?J8(t,n,a):Df(t,n,a,r||null,!0):1===e&&null!==n?Df(t,n,a,r||null,!0):2===e?function i$(e,t,n){const i=Cb(e,t);i&&function khe(e,t,n,i){Vn(e)?e.removeChild(t,n,i):t.removeChild(n)}(e,i,t,n)}(t,a,o):3===e&&t.destroyNode(a),null!=s&&function Fhe(e,t,n,i,r){const s=n[7];s!==si(n)&&Vp(t,e,i,s,r);for(let a=10;a<n.length;a++){const l=n[a];W0(l[1],l,e,t,i,s)}}(t,e,s,n,r)}}function UM(e,t,n){if(Vn(e))return e.createElement(t,n);{const i=null!==n?function yde(e){const t=e.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(n):null;return null===i?e.createElement(t):e.createElementNS(i,t)}}function G8(e,t){const n=e[9],i=n.indexOf(t),r=t[3];1024&t[2]&&(t[2]&=-1025,lM(r,-1)),n.splice(i,1)}function zM(e,t){if(e.length<=10)return;const n=10+t,i=e[n];if(i){const r=i[17];null!==r&&r!==e&&G8(r,i),t>0&&(e[n-1][4]=i[4]);const s=pb(e,10+t);!function Ehe(e,t){W0(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function W8(e,t){if(!(256&t[2])){const n=t[11];Vn(n)&&n.destroyNode&&W0(e,t,n,3,null,null),function Ahe(e){let t=e[13];if(!t)return qM(e[1],e);for(;t;){let n=null;if(il(t))n=t[13];else{const i=t[10];i&&(n=i)}if(!n){for(;t&&!t[4]&&t!==e;)il(t)&&qM(t[1],t),t=t[3];null===t&&(t=e),il(t)&&qM(t[1],t),n=t&&t[4]}t=n}}(t)}}function qM(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function Nhe(e,t){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let i=0;i<n.length;i+=2){const r=t[n[i]];if(!(r instanceof T0)){const s=n[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(e,t),function Ohe(e,t){const n=e.cleanup,i=t[7];let r=-1;if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const o=n[s+1],a="function"==typeof o?o(t):si(t[o]),l=i[r=n[s+2]],u=n[s+3];"boolean"==typeof u?a.removeEventListener(n[s],l,u):u>=0?i[r=u]():i[r=-u].unsubscribe(),s+=2}else{const o=i[r=n[s+1]];n[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();t[7]=null}}(e,t),1===t[1].type&&Vn(t[11])&&t[11].destroy();const n=t[17];if(null!==n&&na(t[3])){n!==t[3]&&G8(n,t);const i=t[19];null!==i&&i.detachView(e)}}}function Y8(e,t,n){return function K8(e,t,n){let i=t;for(;null!==i&&40&i.type;)i=(t=i).parent;if(null===i)return n[0];if(2&i.flags){const r=e.data[i.directiveStart].encapsulation;if(r===ea.None||r===ea.Emulated)return null}return yo(i,n)}(e,t.parent,n)}function Df(e,t,n,i,r){Vn(e)?e.insertBefore(t,n,i,r):t.insertBefore(n,i,r)}function J8(e,t,n){Vn(e)?e.appendChild(t,n):t.appendChild(n)}function X8(e,t,n,i,r){null!==i?Df(e,t,n,i,r):J8(e,t,n)}function Cb(e,t){return Vn(e)?e.parentNode(t):t.parentNode}function Q8(e,t,n){return e$(e,t,n)}let e$=function Z8(e,t,n){return 40&e.type?yo(e,n):null};function Eb(e,t,n,i){const r=Y8(e,i,t),s=t[11],a=Q8(i.parent||t[6],i,t);if(null!=r)if(Array.isArray(n))for(let l=0;l<n.length;l++)X8(s,r,n[l],a,!1);else X8(s,r,n,a,!1)}function Sb(e,t){if(null!==t){const n=t.type;if(3&n)return yo(t,e);if(4&n)return WM(-1,e[t.index]);if(8&n){const i=t.child;if(null!==i)return Sb(e,i);{const r=e[t.index];return na(r)?WM(-1,r):si(r)}}if(32&n)return BM(t,e)()||si(e[t.index]);{const i=n$(e,t);return null!==i?Array.isArray(i)?i[0]:Sb(G0(e[16]),i):Sb(e,t.next)}}return null}function n$(e,t){return null!==t?e[16][6].projection[t.projection]:null}function WM(e,t){const n=10+e+1;if(n<t.length){const i=t[n],r=i[1].firstChild;if(null!==r)return Sb(i,r)}return t[7]}function YM(e,t,n,i,r,s,o){for(;null!=n;){const a=i[n.index],l=n.type;if(o&&0===t&&(a&&lr(si(a),i),n.flags|=4),64!=(64&n.flags))if(8&l)YM(e,t,n.child,i,r,s,!1),Vp(t,e,r,a,s);else if(32&l){const u=BM(n,i);let c;for(;c=u();)Vp(t,e,r,c,s);Vp(t,e,r,a,s)}else 16&l?r$(e,t,i,n,r,s):Vp(t,e,r,a,s);n=o?n.projectionNext:n.next}}function W0(e,t,n,i,r,s){YM(n,i,e.firstChild,t,r,s,!1)}function r$(e,t,n,i,r,s){const o=n[16],l=o[6].projection[i.projection];if(Array.isArray(l))for(let u=0;u<l.length;u++)Vp(t,e,r,l[u],s);else YM(e,t,l,o[3],r,s,!0)}function s$(e,t,n){Vn(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function KM(e,t,n){Vn(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function o$(e,t,n){let i=e.length;for(;;){const r=e.indexOf(t,n);if(-1===r)return r;if(0===r||e.charCodeAt(r-1)<=32){const s=t.length;if(r+s===i||e.charCodeAt(r+s)<=32)return r}n=r+1}}const a$="ng-template";function Lhe(e,t,n){let i=0;for(;i<e.length;){let r=e[i++];if(n&&"class"===r){if(r=e[i],-1!==o$(r.toLowerCase(),t,0))return!0}else if(1===r){for(;i<e.length&&"string"==typeof(r=e[i++]);)if(r.toLowerCase()===t)return!0;return!1}}return!1}function l$(e){return 4===e.type&&e.value!==a$}function jhe(e,t,n){return t===(4!==e.type||n?e.value:a$)}function Bhe(e,t,n){let i=4;const r=e.attrs||[],s=function Hhe(e){for(let t=0;t<e.length;t++)if(Q4(e[t]))return t;return e.length}(r);let o=!1;for(let a=0;a<t.length;a++){const l=t[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!jhe(e,l,n)||""===l&&1===t.length){if(ra(i))return!1;o=!0}}else{const u=8&i?l:t[++a];if(8&i&&null!==e.attrs){if(!Lhe(e.attrs,u,n)){if(ra(i))return!1;o=!0}continue}const d=$he(8&i?"class":l,r,l$(e),n);if(-1===d){if(ra(i))return!1;o=!0;continue}if(""!==u){let f;f=d>s?"":r[d+1].toLowerCase();const h=8&i?f:null;if(h&&-1!==o$(h,u,0)||2&i&&u!==f){if(ra(i))return!1;o=!0}}}}else{if(!o&&!ra(i)&&!ra(l))return!1;if(o&&ra(l))continue;o=!1,i=l|1&i}}return ra(i)||o}function ra(e){return 0==(1&e)}function $he(e,t,n,i){if(null===t)return-1;let r=0;if(i||!n){let s=!1;for(;r<t.length;){const o=t[r];if(o===e)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=t[++r];for(;"string"==typeof a;)a=t[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function Uhe(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const i=e[n];if("number"==typeof i)return-1;if(i===t)return n;n++}return-1}(t,e)}function u$(e,t,n=!1){for(let i=0;i<t.length;i++)if(Bhe(e,t[i],n))return!0;return!1}function zhe(e,t){e:for(let n=0;n<t.length;n++){const i=t[n];if(e.length===i.length){for(let r=0;r<e.length;r++)if(e[r]!==i[r])continue e;return!0}}return!1}function c$(e,t){return e?":not("+t.trim()+")":t}function qhe(e){let t=e[0],n=1,i=2,r="",s=!1;for(;n<e.length;){let o=e[n];if("string"==typeof o)if(2&i){const a=e[++n];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!ra(o)&&(t+=c$(s,r),r=""),i=o,s=s||!ra(i);n++}return""!==r&&(t+=c$(s,r)),t}const Ze={};function W(e){d$(Ct(),ae(),Nr()+e,tb())}function d$(e,t,n,i){if(!i)if(3==(3&t[2])){const s=e.preOrderCheckHooks;null!==s&&ob(t,s,n)}else{const s=e.preOrderHooks;null!==s&&ab(t,s,0,n)}Dc(n)}function xb(e,t){return e<<17|t<<2}function sa(e){return e>>17&32767}function JM(e){return 2|e}function Du(e){return(131068&e)>>2}function XM(e,t){return-131069&e|t<<2}function QM(e){return 1|e}function D$(e,t){const n=e.contentQueries;if(null!==n)for(let i=0;i<n.length;i+=2){const r=n[i],s=n[i+1];if(-1!==s){const o=e.data[s];hM(r),o.contentQueries(2,t[s],s)}}}function Y0(e,t,n,i,r,s,o,a,l,u){const c=t.blueprint.slice();return c[0]=r,c[2]=140|i,$4(c),c[3]=c[15]=e,c[8]=n,c[10]=o||e&&e[10],c[11]=a||e&&e[11],c[12]=l||e&&e[12]||null,c[9]=u||e&&e[9]||null,c[6]=s,c[16]=2==t.type?e[16]:c,c}function Hp(e,t,n,i,r){let s=e.data[t];if(null===s)s=function aT(e,t,n,i,r){const s=H4(),o=uM(),l=e.data[t]=function upe(e,t,n,i,r,s){return{type:n,index:i,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,t,i,r);return null===e.firstChild&&(e.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(e,t,n,i,r),function Ode(){return qe.lFrame.inI18n}()&&(s.flags|=64);else if(64&s.type){s.type=n,s.value=i,s.attrs=r;const o=function M0(){const e=qe.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return rl(s,!0),s}function Up(e,t,n,i){if(0===n)return-1;const r=t.length;for(let s=0;s<n;s++)t.push(i),e.blueprint.push(i),e.data.push(null);return r}function K0(e,t,n){ib(t);try{const i=e.viewQuery;null!==i&&mT(1,i,n);const r=e.template;null!==r&&C$(e,t,r,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&D$(e,t),e.staticViewQueries&&mT(2,e.viewQuery,n);const s=e.components;null!==s&&function ope(e,t){for(let n=0;n<t.length;n++)Ape(e,t[n])}(t,s)}catch(i){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),i}finally{t[2]&=-5,rb()}}function zp(e,t,n,i){const r=t[2];if(256==(256&r))return;ib(t);const s=tb();try{$4(t),function U4(e){return qe.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&C$(e,t,n,2,i);const o=3==(3&r);if(!s)if(o){const u=e.preOrderCheckHooks;null!==u&&ob(t,u,null)}else{const u=e.preOrderHooks;null!==u&&ab(t,u,0,null),pM(t,0)}if(function Spe(e){for(let t=$M(e);null!==t;t=VM(t)){if(!t[2])continue;const n=t[9];for(let i=0;i<n.length;i++){const r=n[i],s=r[3];0==(1024&r[2])&&lM(s,1),r[2]|=1024}}}(t),function Epe(e){for(let t=$M(e);null!==t;t=VM(t))for(let n=10;n<t.length;n++){const i=t[n],r=i[1];aM(i)&&zp(r,i,r.template,i[8])}}(t),null!==e.contentQueries&&D$(e,t),!s)if(o){const u=e.contentCheckHooks;null!==u&&ob(t,u)}else{const u=e.contentHooks;null!==u&&ab(t,u,1),pM(t,1)}!function rpe(e,t){const n=e.hostBindingOpCodes;if(null!==n)try{for(let i=0;i<n.length;i++){const r=n[i];if(r<0)Dc(~r);else{const s=r,o=n[++i],a=n[++i];Nde(o,s),a(2,t[s])}}}finally{Dc(-1)}}(e,t);const a=e.components;null!==a&&function spe(e,t){for(let n=0;n<t.length;n++)xpe(e,t[n])}(t,a);const l=e.viewQuery;if(null!==l&&mT(2,l,i),!s)if(o){const u=e.viewCheckHooks;null!==u&&ob(t,u)}else{const u=e.viewHooks;null!==u&&ab(t,u,2),pM(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),s||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,lM(t[3],-1))}finally{rb()}}function ape(e,t,n,i){const r=t[10],s=!tb(),o=B4(t);try{s&&!o&&r.begin&&r.begin(),o&&K0(e,t,i),zp(e,t,n,i)}finally{s&&!o&&r.end&&r.end()}}function C$(e,t,n,i,r){const s=Nr(),o=2&i;try{Dc(-1),o&&t.length>20&&d$(e,t,20,tb()),n(i,r)}finally{Dc(s)}}function lT(e,t,n){!V4()||(function mpe(e,t,n,i){const r=n.directiveStart,s=n.directiveEnd;e.firstCreatePass||N0(n,t),lr(i,t);const o=n.initialInputs;for(let a=r;a<s;a++){const l=e.data[a],u=ia(l);u&&wpe(t,n,l);const c=k0(t,e,a,n);lr(c,t),null!==o&&Dpe(0,a-r,c,l,0,o),u&&(Fs(n.index,t)[8]=c)}}(e,t,n,yo(n,t)),128==(128&n.flags)&&function _pe(e,t,n){const i=n.directiveStart,r=n.directiveEnd,o=n.index,a=function kde(){return qe.lFrame.currentDirectiveIndex}();try{Dc(o);for(let l=i;l<r;l++){const u=e.data[l],c=t[l];dM(l),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&k$(u,c)}}finally{Dc(-1),dM(a)}}(e,t,n))}function uT(e,t,n=yo){const i=t.localNames;if(null!==i){let r=t.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?n(t,e):e[o];e[r++]=a}}}function S$(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Tb(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function Tb(e,t,n,i,r,s,o,a,l,u){const c=20+i,d=c+r,f=function lpe(e,t){const n=[];for(let i=0;i<t;i++)n.push(i<e?null:Ze);return n}(c,d),h="function"==typeof u?u():u;return f[1]={type:e,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:t,data:f.slice().fill(null,c),bindingStartIndex:c,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:h,incompleteFirstPass:!1}}function M$(e,t,n,i){const r=j$(t);null===n?r.push(i):(r.push(n),e.firstCreatePass&&B$(e).push(i,r.length-1))}function T$(e,t,n){for(let i in e)if(e.hasOwnProperty(i)){const r=e[i];(n=null===n?{}:n).hasOwnProperty(i)?n[i].push(t,r):n[i]=[t,r]}return n}function js(e,t,n,i,r,s,o,a){const l=yo(t,n);let c,u=t.inputs;!a&&null!=u&&(c=u[i])?(H$(e,n,c,i,r),Q1(t)&&function fpe(e,t){const n=Fs(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(i=function dpe(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(i),r=null!=o?o(r,t.value||"",i):r,Vn(s)?s.setProperty(l,i,r):mM(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function cT(e,t,n,i){let r=!1;if(V4()){const s=function ype(e,t,n){const i=e.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];u$(n,o.selectors,!1)&&(r||(r=[]),fb(N0(n,t),e,o.type),ia(o)?(I$(e,n),r.unshift(o)):r.push(o))}return r}(e,t,n),o=null===i?null:{"":-1};if(null!==s){r=!0,R$(n,e.data.length,s.length);for(let c=0;c<s.length;c++){const d=s[c];d.providersResolver&&d.providersResolver(d)}let a=!1,l=!1,u=Up(e,t,s.length,null);for(let c=0;c<s.length;c++){const d=s[c];n.mergedAttrs=ub(n.mergedAttrs,d.hostAttrs),F$(e,n,t,u,d),bpe(u,d,o),null!==d.contentQueries&&(n.flags|=8),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(n.flags|=128);const f=d.type.prototype;!a&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),a=!0),!l&&(f.ngOnChanges||f.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),l=!0),u++}!function cpe(e,t){const i=t.directiveEnd,r=e.data,s=t.attrs,o=[];let a=null,l=null;for(let u=t.directiveStart;u<i;u++){const c=r[u],d=c.inputs,f=null===s||l$(t)?null:Cpe(d,s);o.push(f),a=T$(d,u,a),l=T$(c.outputs,u,l)}null!==a&&(a.hasOwnProperty("class")&&(t.flags|=16),a.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=o,t.inputs=a,t.outputs=l}(e,n)}o&&function vpe(e,t,n){if(t){const i=e.localNames=[];for(let r=0;r<t.length;r+=2){const s=n[t[r+1]];if(null==s)throw new xe(-301,!1);i.push(t[r],s)}}}(n,i,o)}return n.mergedAttrs=ub(n.mergedAttrs,n.attrs),r}function N$(e,t,n,i,r,s){const o=s.hostBindings;if(o){let a=e.hostBindingOpCodes;null===a&&(a=e.hostBindingOpCodes=[]);const l=~t.index;(function gpe(e){let t=e.length;for(;t>0;){const n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(a)!=l&&a.push(l),a.push(i,r,o)}}function k$(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function I$(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function bpe(e,t,n){if(n){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)n[t.exportAs[i]]=e;ia(t)&&(n[""]=e)}}function R$(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function F$(e,t,n,i,r){e.data[i]=r;const s=r.factory||(r.factory=bf(r.type)),o=new T0(s,ia(r),null);e.blueprint[i]=o,n[i]=o,N$(e,t,0,i,Up(e,n,r.hostVars,Ze),r)}function wpe(e,t,n){const i=yo(t,e),r=S$(n),s=e[10],o=Ob(e,Y0(e,r,null,n.onPush?64:16,i,t,s,s.createRenderer(i,n),null,null));e[t.index]=o}function ll(e,t,n,i,r,s){const o=yo(e,t);!function dT(e,t,n,i,r,s,o){if(null==s)Vn(e)?e.removeAttribute(t,r,n):t.removeAttribute(r);else{const a=null==o?Qe(s):o(s,i||"",r);Vn(e)?e.setAttribute(t,r,a,n):n?t.setAttributeNS(n,r,a):t.setAttribute(r,a)}}(t[11],o,s,e.value,n,i,r)}function Dpe(e,t,n,i,r,s){const o=s[t];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const u=o[l++],c=o[l++],d=o[l++];null!==a?i.setInput(n,d,u,c):n[c]=d}}}function Cpe(e,t){let n=null,i=0;for(;i<t.length;){const r=t[i];if(0!==r)if(5!==r){if("number"==typeof r)break;e.hasOwnProperty(r)&&(null===n&&(n=[]),n.push(r,e[r],t[i+1])),i+=2}else i+=2;else i+=4}return n}function P$(e,t,n,i){return new Array(e,!0,!1,t,null,0,i,n,null,null)}function xpe(e,t){const n=Fs(t,e);if(aM(n)){const i=n[1];80&n[2]?zp(i,n,i.template,n[8]):n[5]>0&&fT(n)}}function fT(e){for(let i=$M(e);null!==i;i=VM(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const o=s[1];zp(o,s,o.template,s[8])}else s[5]>0&&fT(s)}const n=e[1].components;if(null!==n)for(let i=0;i<n.length;i++){const r=Fs(n[i],e);aM(r)&&r[5]>0&&fT(r)}}function Ape(e,t){const n=Fs(t,e),i=n[1];(function Mpe(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])})(i,n),K0(i,n,n[8])}function Ob(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function hT(e){for(;e;){e[2]|=64;const t=G0(e);if(lde(e)&&!t)return e;e=t}return null}function gT(e,t,n){const i=t[10];i.begin&&i.begin();try{zp(e,t,e.template,n)}catch(r){throw V$(t,r),r}finally{i.end&&i.end()}}function L$(e){!function pT(e){for(let t=0;t<e.components.length;t++){const n=e.components[t],i=FM(n),r=i[1];ape(r,i,r.template,n)}}(e[8])}function mT(e,t,n){hM(0),t(e,n)}const kpe=(()=>Promise.resolve(null))();function j$(e){return e[7]||(e[7]=[])}function B$(e){return e.cleanup||(e.cleanup=[])}function V$(e,t){const n=e[9],i=n?n.get(q0,null):null;i&&i.handleError(t)}function H$(e,t,n,i,r){for(let s=0;s<n.length;){const o=n[s++],a=n[s++],l=t[o],u=e.data[o];null!==u.setInput?u.setInput(l,r,i,a):l[a]=r}}function Cu(e,t,n){const i=eb(t,e);!function q8(e,t,n){Vn(e)?e.setValue(t,n):t.textContent=n}(e[11],i,n)}function Nb(e,t,n){let i=n?e.styles:null,r=n?e.classes:null,s=0;if(null!==t)for(let o=0;o<t.length;o++){const a=t[o];"number"==typeof a?s=a:1==s?r=zA(r,a):2==s&&(i=zA(i,a+": "+t[++o]+";"))}n?e.styles=i:e.stylesWithoutHost=i,n?e.classes=r:e.classesWithoutHost=r}const _T=new it("INJECTOR",-1);class U${get(t,n=P0){if(n===P0){const i=new Error(`NullInjectorError: No provider for ${Yt(t)}!`);throw i.name="NullInjectorError",i}return n}}const yT=new it("Set Injector scope."),J0={},Fpe={};let vT;function z$(){return void 0===vT&&(vT=new U$),vT}function q$(e,t=null,n=null,i){const r=G$(e,t,n,i);return r._resolveInjectorDefTypes(),r}function G$(e,t=null,n=null,i){return new Ppe(e,n,t||z$(),i)}class Ppe{constructor(t,n,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];n&&sl(n,a=>this.processProvider(a,t,n)),sl([t],a=>this.processInjectorType(a,[],s)),this.records.set(_T,qp(void 0,this));const o=this.records.get(yT);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof t?null:Yt(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,n=P0,i=Ye.Default){this.assertNotDestroyed();const r=m8(this),s=yc(void 0);try{if(!(i&Ye.SkipSelf)){let a=this.records.get(t);if(void 0===a){const l=function zpe(e){return"function"==typeof e||"object"==typeof e&&e instanceof it}(t)&&GA(t);a=l&&this.injectableDefInScope(l)?qp(bT(t),J0):null,this.records.set(t,a)}if(null!=a)return this.hydrate(t,a)}return(i&Ye.Self?z$():this.parent).get(t,n=i&Ye.Optional&&n===P0?null:n)}catch(o){if("NullInjectorError"===o.name){if((o[mb]=o[mb]||[]).unshift(Yt(t)),r)throw o;return function _fe(e,t,n,i){const r=e[mb];throw t[g8]&&r.unshift(t[g8]),e.message=function yfe(e,t,n,i=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;let r=Yt(t);if(Array.isArray(t))r=t.map(Yt).join(" -> ");else if("object"==typeof t){let s=[];for(let o in t)if(t.hasOwnProperty(o)){let a=t[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Yt(a)))}r=`{${s.join(", ")}}`}return`${n}${i?"("+i+")":""}[${r}]: ${e.replace(dfe,"\n  ")}`}("\n"+e.message,r,n,i),e.ngTokenPath=r,e[mb]=null,e}(o,t,"R3InjectorError",this.source)}throw o}finally{yc(s),m8(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((i,r)=>t.push(Yt(r))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new xe(205,!1)}processInjectorType(t,n,i){if(!(t=at(t)))return!1;let r=x4(t);const s=null==r&&t.ngModule||void 0,o=void 0===s?t:s,a=-1!==i.indexOf(o);if(void 0!==s&&(r=x4(s)),null==r)return!1;if(null!=r.imports&&!a){let c;i.push(o);try{sl(r.imports,d=>{this.processInjectorType(d,n,i)&&(void 0===c&&(c=[]),c.push(d))})}finally{}if(void 0!==c)for(let d=0;d<c.length;d++){const{ngModule:f,providers:h}=c[d];sl(h,p=>this.processProvider(p,f,h||an))}}this.injectorDefTypes.add(o);const l=bf(o)||(()=>new o);this.records.set(o,qp(l,J0));const u=r.providers;if(null!=u&&!a){const c=t;sl(u,d=>this.processProvider(d,c,u))}return void 0!==s&&void 0!==t.providers}processProvider(t,n,i){let r=Gp(t=at(t))?t:at(t&&t.provide);const s=function jpe(e,t,n){return Y$(e)?qp(void 0,e.useValue):qp(W$(e),J0)}(t);if(Gp(t)||!0!==t.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=qp(void 0,J0,!0),o.factory=()=>xM(o.multi),this.records.set(r,o)),r=t,o.multi.push(t)}this.records.set(r,s)}hydrate(t,n){return n.value===J0&&(n.value=Fpe,n.value=n.factory()),"object"==typeof n.value&&n.value&&function Upe(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(n.value)&&this.onDestroy.add(n.value),n.value}injectableDefInScope(t){if(!t.providedIn)return!1;const n=at(t.providedIn);return"string"==typeof n?"any"===n||n===this.scope:this.injectorDefTypes.has(n)}}function bT(e){const t=GA(e),n=null!==t?t.factory:bf(e);if(null!==n)return n;if(e instanceof it)throw new xe(204,!1);if(e instanceof Function)return function Lpe(e){const t=e.length;if(t>0)throw F0(t,"?"),new xe(204,!1);const n=function Kce(e){const t=e&&(e[W1]||e[A4]);if(t){const n=function Jce(e){if(e.hasOwnProperty("name"))return e.name;const t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),t}return null}(e);return null!==n?()=>n.factory(e):()=>new e}(e);throw new xe(204,!1)}function W$(e,t,n){let i;if(Gp(e)){const r=at(e);return bf(r)||bT(r)}if(Y$(e))i=()=>at(e.useValue);else if(function $pe(e){return!(!e||!e.useFactory)}(e))i=()=>e.useFactory(...xM(e.deps||[]));else if(function Bpe(e){return!(!e||!e.useExisting)}(e))i=()=>me(at(e.useExisting));else{const r=at(e&&(e.useClass||e.provide));if(!function Hpe(e){return!!e.deps}(e))return bf(r)||bT(r);i=()=>new r(...xM(e.deps))}return i}function qp(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function Y$(e){return null!==e&&"object"==typeof e&&hfe in e}function Gp(e){return"function"==typeof e}let ai=(()=>{class e{static create(n,i){var r;if(Array.isArray(n))return q$({name:""},i,n,"");{const s=null!==(r=n.name)&&void 0!==r?r:"";return q$({name:s},n.parent,n.providers,s)}}}return e.THROW_IF_NOT_FOUND=P0,e.NULL=new U$,e.\u0275prov=Oe({token:e,providedIn:"any",factory:()=>me(_T)}),e.__NG_ELEMENT_ID__=-1,e})();function Qpe(e,t){sb(FM(e)[1],mi())}function Ht(e){let t=function o6(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0;const i=[e];for(;t;){let r;if(ia(e))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new xe(903,"");r=t.\u0275dir}if(r){if(n){i.push(r);const o=e;o.inputs=CT(e.inputs),o.declaredInputs=CT(e.declaredInputs),o.outputs=CT(e.outputs);const a=r.hostBindings;a&&nge(e,a);const l=r.viewQuery,u=r.contentQueries;if(l&&ege(e,l),u&&tge(e,u),UA(e.inputs,r.inputs),UA(e.declaredInputs,r.declaredInputs),UA(e.outputs,r.outputs),ia(r)&&r.data.animation){const c=e.data;c.animation=(c.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(e),a===Ht&&(n=!1)}}t=Object.getPrototypeOf(t)}!function Zpe(e){let t=0,n=null;for(let i=e.length-1;i>=0;i--){const r=e[i];r.hostVars=t+=r.hostVars,r.hostAttrs=ub(r.hostAttrs,n=ub(n,r.hostAttrs))}}(i)}function CT(e){return e===Dp?{}:e===an?[]:e}function ege(e,t){const n=e.viewQuery;e.viewQuery=n?(i,r)=>{t(i,r),n(i,r)}:t}function tge(e,t){const n=e.contentQueries;e.contentQueries=n?(i,r,s)=>{t(i,r,s),n(i,r,s)}:t}function nge(e,t){const n=e.hostBindings;e.hostBindings=n?(i,r)=>{t(i,r),n(i,r)}:t}let kb=null;function Wp(){if(!kb){const e=Zt.Symbol;if(e&&e.iterator)kb=e.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let n=0;n<t.length;++n){const i=t[n];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(kb=i)}}}return kb}function X0(e){return!!ET(e)&&(Array.isArray(e)||!(e instanceof Map)&&Wp()in e)}function ET(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function ur(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function ln(e,t,n,i){const r=ae();return ur(r,Mp(),t)&&(Ct(),ll(Hn(),r,e,t,n,i)),ln}function Kp(e,t,n,i){return ur(e,Mp(),n)?t+Qe(n)+i:Ze}function je(e,t,n,i,r,s,o,a){const l=ae(),u=Ct(),c=e+20,d=u.firstCreatePass?function uge(e,t,n,i,r,s,o,a,l){const u=t.consts,c=Hp(t,e,4,o||null,wc(u,a));cT(t,n,c,wc(u,l)),sb(t,c);const d=c.tViews=Tb(2,c,i,r,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,u);return null!==t.queries&&(t.queries.template(t,c),d.queries=t.queries.embeddedTView(c)),c}(c,u,l,t,n,i,r,s,o):u.data[c];rl(d,!1);const f=l[11].createComment("");Eb(u,l,f,d),lr(f,l),Ob(l,l[c]=P$(f,l,f,d)),Z1(d)&&lT(u,l,d),null!=o&&uT(l,d,a)}function wo(e){return Ap(function Tde(){return qe.lFrame.contextLView}(),20+e)}function H(e,t=Ye.Default){const n=ae();return null===n?me(e,t):s8(mi(),n,at(e),t)}function TT(){throw new Error("invalid")}function X(e,t,n){const i=ae();return ur(i,Mp(),t)&&js(Ct(),Hn(),i,e,t,i[11],n,!1),X}function OT(e,t,n,i,r){const o=r?"class":"style";H$(e,n,t.inputs[o],o,i)}function k(e,t,n,i){const r=ae(),s=Ct(),o=20+e,a=r[11],l=r[o]=UM(a,t,function $de(){return qe.lFrame.currentNamespace}()),u=s.firstCreatePass?function Oge(e,t,n,i,r,s,o){const a=t.consts,u=Hp(t,e,2,r,wc(a,s));return cT(t,n,u,wc(a,o)),null!==u.attrs&&Nb(u,u.attrs,!1),null!==u.mergedAttrs&&Nb(u,u.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,u),u}(o,s,r,0,t,n,i):s.data[o];rl(u,!0);const c=u.mergedAttrs;null!==c&&lb(a,l,c);const d=u.classes;null!==d&&KM(a,l,d);const f=u.styles;return null!==f&&s$(a,l,f),64!=(64&u.flags)&&Eb(s,r,l,u),0===function Ede(){return qe.lFrame.elementDepthCount}()&&lr(l,r),function Sde(){qe.lFrame.elementDepthCount++}(),Z1(u)&&(lT(s,r,u),function E$(e,t,n){if(ZA(t)){const r=t.directiveEnd;for(let s=t.directiveStart;s<r;s++){const o=e.data[s];o.contentQueries&&o.contentQueries(1,n[s],s)}}}(s,u,r)),null!==i&&uT(r,u),k}function F(){let e=mi();uM()?cM():(e=e.parent,rl(e,!1));const t=e;!function xde(){qe.lFrame.elementDepthCount--}();const n=Ct();return n.firstCreatePass&&(sb(n,e),ZA(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function qde(e){return 0!=(16&e.flags)}(t)&&OT(n,t,ae(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function Gde(e){return 0!=(32&e.flags)}(t)&&OT(n,t,ae(),t.stylesWithoutHost,!1),F}function dt(e,t,n,i){return k(e,t,n,i),F(),dt}function Bs(){return ae()}function Z0(e){return!!e&&"function"==typeof e.then}const IT=function A6(e){return!!e&&"function"==typeof e.subscribe};function Fe(e,t,n,i){const r=ae(),s=Ct(),o=mi();return function T6(e,t,n,i,r,s,o,a){const l=Z1(i),c=e.firstCreatePass&&B$(e),d=t[8],f=j$(t);let h=!0;if(3&i.type||a){const m=yo(i,t),_=a?a(m):m,y=f.length,v=a?b=>a(si(b[i.index])):i.index;if(Vn(n)){let b=null;if(!a&&l&&(b=function kge(e,t,n,i){const r=e.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===n&&r[s+1]===i){const a=t[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(e,t,r,i.index)),null!==b)(b.__ngLastListenerFn__||b).__ngNextListenerFn__=s,b.__ngLastListenerFn__=s,h=!1;else{s=RT(i,t,d,s,!1);const D=n.listen(_,r,s);f.push(s,D),c&&c.push(r,v,y,y+1)}}else s=RT(i,t,d,s,!0),_.addEventListener(r,s,o),f.push(s),c&&c.push(r,v,y,o)}else s=RT(i,t,d,s,!1);const p=i.outputs;let g;if(h&&null!==p&&(g=p[r])){const m=g.length;if(m)for(let _=0;_<m;_+=2){const C=t[g[_]][g[_+1]].subscribe(s),w=f.length;f.push(s,C),c&&c.push(r,i.index,w,-(w+1))}}}(s,r,r[11],o,e,t,!!n,i),Fe}function O6(e,t,n,i){try{return!1!==n(i)}catch(r){return V$(e,r),!1}}function RT(e,t,n,i,r){return function s(o){if(o===Function)return i;const a=2&e.flags?Fs(e.index,t):t;0==(32&t[2])&&hT(a);let l=O6(t,0,i,o),u=s.__ngNextListenerFn__;for(;u;)l=O6(t,0,u,o)&&l,u=u.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function Et(e=1){return function Rde(e){return(qe.lFrame.contextLView=function Fde(e,t){for(;e>0;)t=t[15],e--;return t}(e,qe.lFrame.contextLView))[8]}(e)}function Ige(e,t){let n=null;const i=function Vhe(e){const t=e.attrs;if(null!=t){const n=t.indexOf(5);if(0==(1&n))return t[n+1]}return null}(e);for(let r=0;r<t.length;r++){const s=t[r];if("*"!==s){if(null===i?u$(e,s,!0):zhe(i,s))return r}else n=r}return n}function FT(e){const t=ae()[16][6];if(!t.projection){const i=t.projection=F0(e?e.length:1,null),r=i.slice();let s=t.child;for(;null!==s;){const o=e?Ige(s,e):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function PT(e,t=0,n){const i=ae(),r=Ct(),s=Hp(r,20+e,16,null,n||null);null===s.projection&&(s.projection=t),cM(),64!=(64&s.flags)&&function Rhe(e,t,n){r$(t[11],0,t,n,Y8(e,n,t),Q8(n.parent||t[6],n,t))}(r,i,s)}function Ef(e,t,n){return Fb(e,"",t,"",n),Ef}function Fb(e,t,n,i,r){const s=ae(),o=Kp(s,t,n,i);return o!==Ze&&js(Ct(),Hn(),s,e,o,s[11],r,!1),Fb}function B6(e,t,n,i,r){const s=e[n+1],o=null===t;let a=i?sa(s):Du(s),l=!1;for(;0!==a&&(!1===l||o);){const c=e[a+1];Pge(e[a],t)&&(l=!0,e[a+1]=i?QM(c):JM(c)),a=i?sa(c):Du(c)}l&&(e[n+1]=i?JM(s):QM(s))}function Pge(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&Pp(e,t)>=0}const yi={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function $6(e){return e.substring(yi.key,yi.keyEnd)}function V6(e,t){const n=yi.textEnd;return n===t?-1:(t=yi.keyEnd=function $ge(e,t,n){for(;t<n&&e.charCodeAt(t)>32;)t++;return t}(e,yi.key=t,n),rg(e,t,n))}function rg(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function An(e,t){return function aa(e,t,n,i){const r=ae(),s=Ct(),o=wu(2);s.firstUpdatePass&&W6(s,e,o,i),t!==Ze&&ur(r,o,t)&&K6(s,s.data[Nr()],r,r[11],e,r[o+1]=function Jge(e,t){return null==e||("string"==typeof t?e+=t:"object"==typeof e&&(e=Yt(Sc(e)))),e}(t,n),i,o)}(e,t,null,!0),An}function Mc(e){la(Ps,dl,e,!0)}function dl(e,t){for(let n=function jge(e){return function U6(e){yi.key=0,yi.keyEnd=0,yi.value=0,yi.valueEnd=0,yi.textEnd=e.length}(e),V6(e,rg(e,0,yi.textEnd))}(t);n>=0;n=V6(t,n))Ps(e,$6(t),!0)}function la(e,t,n,i){const r=Ct(),s=wu(2);r.firstUpdatePass&&W6(r,null,s,i);const o=ae();if(n!==Ze&&ur(o,s,n)){const a=r.data[Nr()];if(X6(a,i)&&!G6(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(n=zA(l,n||"")),OT(r,a,o,n,i)}else!function Kge(e,t,n,i,r,s,o,a){r===Ze&&(r=an);let l=0,u=0,c=0<r.length?r[0]:null,d=0<s.length?s[0]:null;for(;null!==c||null!==d;){const f=l<r.length?r[l+1]:void 0,h=u<s.length?s[u+1]:void 0;let g,p=null;c===d?(l+=2,u+=2,f!==h&&(p=d,g=h)):null===d||null!==c&&c<d?(l+=2,p=c):(u+=2,p=d,g=h),null!==p&&K6(e,t,n,i,p,g,o,a),c=l<r.length?r[l]:null,d=u<s.length?s[u]:null}}(r,a,o,o[11],o[s+1],o[s+1]=function Yge(e,t,n){if(null==n||""===n)return an;const i=[],r=Sc(n);if(Array.isArray(r))for(let s=0;s<r.length;s++)e(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&e(i,s,r[s]);else"string"==typeof r&&t(i,r);return i}(e,t,n),i,s)}}function G6(e,t){return t>=e.expandoStartIndex}function W6(e,t,n,i){const r=e.data;if(null===r[n+1]){const s=r[Nr()],o=G6(e,n);X6(s,i)&&null===t&&!o&&(t=!1),t=function zge(e,t,n,i){const r=function fM(e){const t=qe.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e);let s=i?t.residualClasses:t.residualStyles;if(null===r)0===(i?t.classBindings:t.styleBindings)&&(n=e_(n=jT(null,e,t,n,i),t.attrs,i),s=null);else{const o=t.directiveStylingLast;if(-1===o||e[o]!==r)if(n=jT(r,e,t,n,i),null===s){let l=function qge(e,t,n){const i=n?t.classBindings:t.styleBindings;if(0!==Du(i))return e[sa(i)]}(e,t,i);void 0!==l&&Array.isArray(l)&&(l=jT(null,e,t,l[1],i),l=e_(l,t.attrs,i),function Gge(e,t,n,i){e[sa(n?t.classBindings:t.styleBindings)]=i}(e,t,i,l))}else s=function Wge(e,t,n){let i;const r=t.directiveEnd;for(let s=1+t.directiveStylingLast;s<r;s++)i=e_(i,e[s].hostAttrs,n);return e_(i,t.attrs,n)}(e,t,i)}return void 0!==s&&(i?t.residualClasses=s:t.residualStyles=s),n}(r,s,t,i),function Rge(e,t,n,i,r,s){let o=s?t.classBindings:t.styleBindings,a=sa(o),l=Du(o);e[i]=n;let c,u=!1;if(Array.isArray(n)){const d=n;c=d[1],(null===c||Pp(d,c)>0)&&(u=!0)}else c=n;if(r)if(0!==l){const f=sa(e[a+1]);e[i+1]=xb(f,a),0!==f&&(e[f+1]=XM(e[f+1],i)),e[a+1]=function Yhe(e,t){return 131071&e|t<<17}(e[a+1],i)}else e[i+1]=xb(a,0),0!==a&&(e[a+1]=XM(e[a+1],i)),a=i;else e[i+1]=xb(l,0),0===a?a=i:e[l+1]=XM(e[l+1],i),l=i;u&&(e[i+1]=JM(e[i+1])),B6(e,c,i,!0),B6(e,c,i,!1),function Fge(e,t,n,i,r){const s=r?e.residualClasses:e.residualStyles;null!=s&&"string"==typeof t&&Pp(s,t)>=0&&(n[i+1]=QM(n[i+1]))}(t,c,e,i,s),o=xb(a,l),s?t.classBindings=o:t.styleBindings=o}(r,s,t,n,o,i)}}function jT(e,t,n,i,r){let s=null;const o=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<o&&(s=t[a],i=e_(i,s.hostAttrs,r),s!==e);)a++;return null!==e&&(n.directiveStylingLast=a),i}function e_(e,t,n){const i=n?1:2;let r=-1;if(null!==t)for(let s=0;s<t.length;s++){const o=t[s];"number"==typeof o?r=o:r===i&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),Ps(e,o,!!n||t[++s]))}return void 0===e?null:e}function K6(e,t,n,i,r,s,o,a){if(!(3&t.type))return;const l=e.data,u=l[a+1];Pb(function p$(e){return 1==(1&e)}(u)?J6(l,t,n,r,Du(u),o):void 0)||(Pb(s)||function h$(e){return 2==(2&e)}(u)&&(s=J6(l,null,n,r,a,o)),function Phe(e,t,n,i,r){const s=Vn(e);if(t)r?s?e.addClass(n,i):n.classList.add(i):s?e.removeClass(n,i):n.classList.remove(i);else{let o=-1===i.indexOf("-")?void 0:Ls.DashCase;if(null==r)s?e.removeStyle(n,i,o):n.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=Ls.Important),s?e.setStyle(n,i,r,o):n.style.setProperty(i,r,a?"important":"")}}}(i,o,eb(Nr(),n),r,s))}function J6(e,t,n,i,r,s){const o=null===t;let a;for(;r>0;){const l=e[r],u=Array.isArray(l),c=u?l[1]:l,d=null===c;let f=n[r+1];f===Ze&&(f=d?an:void 0);let h=d?CM(f,i):c===i?f:void 0;if(u&&!Pb(h)&&(h=CM(l,i)),Pb(h)&&(a=h,o))return a;const p=e[r+1];r=o?sa(p):Du(p)}if(null!==t){let l=s?t.residualClasses:t.residualStyles;null!=l&&(a=CM(l,i))}return a}function Pb(e){return void 0!==e}function X6(e,t){return 0!=(e.flags&(t?16:32))}function B(e,t=""){const n=ae(),i=Ct(),r=e+20,s=i.firstCreatePass?Hp(i,r,1,t,null):i.data[r],o=n[r]=function HM(e,t){return Vn(e)?e.createText(t):e.createTextNode(t)}(n[11],t);Eb(i,n,o,s),rl(s,!1)}function Ni(e){return ua("",e,""),Ni}function ua(e,t,n){const i=ae(),r=Kp(i,e,t,n);return r!==Ze&&Cu(i,Nr(),r),ua}function BT(e,t,n){la(Ps,dl,Kp(ae(),e,t,n),!0)}function Eu(e,t,n){const i=ae();return ur(i,Mp(),t)&&js(Ct(),Hn(),i,e,t,i[11],n,!0),Eu}const Lb="en-US";let yV=Lb;function UT(e,t,n,i,r){if(e=at(e),Array.isArray(e))for(let s=0;s<e.length;s++)UT(e[s],t,n,i,r);else{const s=Ct(),o=ae();let a=Gp(e)?e:at(e.provide),l=W$(e);const u=mi(),c=1048575&u.providerIndexes,d=u.directiveStart,f=u.providerIndexes>>20;if(Gp(e)||!e.multi){const h=new T0(l,r,H),p=qT(a,t,r?c:c+f,d);-1===p?(fb(N0(u,o),s,a),zT(s,e,t.length),t.push(a),u.directiveStart++,u.directiveEnd++,r&&(u.providerIndexes+=1048576),n.push(h),o.push(h)):(n[p]=h,o[p]=h)}else{const h=qT(a,t,c+f,d),p=qT(a,t,c,c+f),g=h>=0&&n[h],m=p>=0&&n[p];if(r&&!m||!r&&!g){fb(N0(u,o),s,a);const _=function f0e(e,t,n,i,r){const s=new T0(e,n,H);return s.multi=[],s.index=t,s.componentProviders=0,HV(s,r,i&&!n),s}(r?d0e:c0e,n.length,r,i,l);!r&&m&&(n[p].providerFactory=_),zT(s,e,t.length,0),t.push(a),u.directiveStart++,u.directiveEnd++,r&&(u.providerIndexes+=1048576),n.push(_),o.push(_)}else zT(s,e,h>-1?h:p,HV(n[r?p:h],l,!r&&i));!r&&i&&m&&n[p].componentProviders++}}}function zT(e,t,n,i){const r=Gp(t),s=function Vpe(e){return!!e.useClass}(t);if(r||s){const l=(s?at(t.useClass):t).prototype.ngOnDestroy;if(l){const u=e.destroyHooks||(e.destroyHooks=[]);if(!r&&t.multi){const c=u.indexOf(n);-1===c?u.push(n,[i,l]):u[c+1].push(i,l)}else u.push(n,l)}}}function HV(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function qT(e,t,n,i){for(let r=n;r<i;r++)if(t[r]===e)return r;return-1}function c0e(e,t,n,i){return GT(this.multi,[])}function d0e(e,t,n,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=k0(n,n[1],this.providerFactory.index,i);s=a.slice(0,o),GT(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],GT(r,s);return s}function GT(e,t){for(let n=0;n<e.length;n++)t.push((0,e[n])());return t}function un(e,t=[]){return n=>{n.providersResolver=(i,r)=>function u0e(e,t,n){const i=Ct();if(i.firstCreatePass){const r=ia(e);UT(n,i.data,i.blueprint,r,!0),UT(t,i.data,i.blueprint,r,!1)}}(i,r?r(e):e,t)}}class UV{}class g0e{resolveComponentFactory(t){throw function p0e(e){const t=Error(`No component factory found for ${Yt(e)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=e,t}(t)}}let ag=(()=>{class e{}return e.NULL=new g0e,e})();function m0e(){return lg(mi(),ae())}function lg(e,t){return new cn(yo(e,t))}let cn=(()=>{class e{constructor(n){this.nativeElement=n}}return e.__NG_ELEMENT_ID__=m0e,e})();function _0e(e){return e instanceof cn?e.nativeElement:e}class ug{}let $s=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>function v0e(){const e=ae(),n=Fs(mi().index,e);return function y0e(e){return e[11]}(il(n)?n:e)}(),e})(),b0e=(()=>{class e{}return e.\u0275prov=Oe({token:e,providedIn:"root",factory:()=>null}),e})();class s_{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const w0e=new s_("13.3.2"),WT={};function Hb(e,t,n,i,r=!1){for(;null!==n;){const s=t[n.index];if(null!==s&&i.push(si(s)),na(s))for(let a=10;a<s.length;a++){const l=s[a],u=l[1].firstChild;null!==u&&Hb(l[1],l,u,i)}const o=n.type;if(8&o)Hb(e,t,n.child,i);else if(32&o){const a=BM(n,t);let l;for(;l=a();)i.push(l)}else if(16&o){const a=n$(t,n);if(Array.isArray(a))i.push(...a);else{const l=G0(t[16]);Hb(l[1],l,a,i,!0)}}n=r?n.projectionNext:n.next}return i}class o_{constructor(t,n){this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,n=t[1];return Hb(n,t,n.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(na(t)){const n=t[8],i=n?n.indexOf(this):-1;i>-1&&(zM(t,i),pb(n,i))}this._attachedToViewContainer=!1}W8(this._lView[1],this._lView)}onDestroy(t){M$(this._lView[1],this._lView,null,t)}markForCheck(){hT(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){gT(this._lView[1],this._lView,this.context)}checkNoChanges(){!function Ope(e,t,n){nb(!0);try{gT(e,t,n)}finally{nb(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new xe(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function xhe(e,t){W0(e,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new xe(902,"");this._appRef=t}}class D0e extends o_{constructor(t){super(t),this._view=t}detectChanges(){L$(this._view)}checkNoChanges(){!function Npe(e){nb(!0);try{L$(e)}finally{nb(!1)}}(this._view)}get context(){return null}}class qV extends ag{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const n=rr(t);return new YT(n,this.ngModule)}}function GV(e){const t=[];for(let n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}class YT extends UV{constructor(t,n){super(),this.componentDef=t,this.ngModule=n,this.componentType=t.type,this.selector=function Ghe(e){return e.map(qhe).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!n}get inputs(){return GV(this.componentDef.inputs)}get outputs(){return GV(this.componentDef.outputs)}create(t,n,i,r){const s=(r=r||this.ngModule)?function E0e(e,t){return{get:(n,i,r)=>{const s=e.get(n,WT,r);return s!==WT||i===WT?s:t.get(n,i,r)}}}(t,r.injector):t,o=s.get(ug,j4),a=s.get(b0e,null),l=o.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",c=i?function A$(e,t,n){if(Vn(e))return e.selectRootElement(t,n===ea.ShadowDom);let i="string"==typeof t?e.querySelector(t):t;return i.textContent="",i}(l,i,this.componentDef.encapsulation):UM(o.createRenderer(null,this.componentDef),u,function C0e(e){const t=e.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(u)),d=this.componentDef.onPush?576:528,f=function s6(e,t){return{components:[],scheduler:e||yhe,clean:kpe,playerHandler:t||null,flags:0}}(),h=Tb(0,null,null,1,0,null,null,null,null,null),p=Y0(null,h,f,d,null,null,o,l,a,s);let g,m;ib(p);try{const _=function i6(e,t,n,i,r,s){const o=n[1];n[20]=e;const l=Hp(o,20,2,"#host",null),u=l.mergedAttrs=t.hostAttrs;null!==u&&(Nb(l,u,!0),null!==e&&(lb(r,e,u),null!==l.classes&&KM(r,e,l.classes),null!==l.styles&&s$(r,e,l.styles)));const c=i.createRenderer(e,t),d=Y0(n,S$(t),null,t.onPush?64:16,n[20],l,i,c,s||null,null);return o.firstCreatePass&&(fb(N0(l,n),o,t.type),I$(o,l),R$(l,n.length,1)),Ob(n,d),n[20]=d}(c,this.componentDef,p,o,l);if(c)if(i)lb(l,c,["ng-version",w0e.full]);else{const{attrs:y,classes:v}=function Whe(e){const t=[],n=[];let i=1,r=2;for(;i<e.length;){let s=e[i];if("string"==typeof s)2===r?""!==s&&t.push(s,e[++i]):8===r&&n.push(s);else{if(!ra(r))break;r=s}i++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]);y&&lb(l,c,y),v&&v.length>0&&KM(l,c,v.join(" "))}if(m=oM(h,20),void 0!==n){const y=m.projection=[];for(let v=0;v<this.ngContentSelectors.length;v++){const b=n[v];y.push(null!=b?Array.from(b):null)}}g=function r6(e,t,n,i,r){const s=n[1],o=function ppe(e,t,n){const i=mi();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),F$(e,i,t,Up(e,t,1,null),n));const r=k0(t,e,i.directiveStart,i);lr(r,t);const s=yo(i,t);return s&&lr(s,t),r}(s,n,t);if(i.components.push(o),e[8]=o,r&&r.forEach(l=>l(o,t)),t.contentQueries){const l=mi();t.contentQueries(1,o,l.directiveStart)}const a=mi();return!s.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(Dc(a.index),N$(n[1],a,0,a.directiveStart,a.directiveEnd,t),k$(t,o)),o}(_,this.componentDef,p,f,[Qpe]),K0(h,p,null)}finally{rb()}return new x0e(this.componentType,g,lg(m,p),p,m)}}class x0e extends class h0e{}{constructor(t,n,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=n,this.hostView=this.changeDetectorRef=new D0e(r),this.componentType=t}get injector(){return new Np(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}class Su{}class WV{}const cg=new Map;class JV extends Su{constructor(t,n){super(),this._parent=n,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new qV(this);const i=go(t);this._bootstrapComponents=al(i.bootstrap),this._r3Injector=G$(t,n,[{provide:Su,useValue:this},{provide:ag,useValue:this.componentFactoryResolver}],Yt(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,n=ai.THROW_IF_NOT_FOUND,i=Ye.Default){return t===ai||t===Su||t===_T?this:this._r3Injector.get(t,n,i)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class KT extends WV{constructor(t){super(),this.moduleType=t,null!==go(t)&&function M0e(e){const t=new Set;!function n(i){const r=go(i,!0),s=r.id;null!==s&&(function YV(e,t,n){if(t&&t!==n)throw new Error(`Duplicate module registered for ${e} - ${Yt(t)} vs ${Yt(t.name)}`)}(s,cg.get(s),i),cg.set(s,i));const o=al(r.imports);for(const a of o)t.has(a)||(t.add(a),n(a))}(e)}(t)}create(t){return new JV(this.moduleType,t)}}function Oc(e,t,n,i){return XV(ae(),Or(),e,t,n,i)}function XV(e,t,n,i,r,s){const o=t+n;return ur(e,o,r)?function ul(e,t,n){return e[t]=n}(e,o+1,s?i.call(s,r):i(r)):function l_(e,t){const n=e[t];return n===Ze?void 0:n}(e,o+1)}function ca(e,t){const n=Ct();let i;const r=e+20;n.firstCreatePass?(i=function P0e(e,t){if(t)for(let n=t.length-1;n>=0;n--){const i=t[n];if(e===i.name)return i}}(t,n.pipeRegistry),n.data[r]=i,i.onDestroy&&(n.destroyHooks||(n.destroyHooks=[])).push(r,i.onDestroy)):i=n.data[r];const s=i.factory||(i.factory=bf(i.type)),o=yc(H);try{const a=cb(!1),l=s();return cb(a),function cge(e,t,n,i){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=i}(n,ae(),r,l),l}finally{yc(o)}}function da(e,t,n){const i=e+20,r=ae(),s=Ap(r,i);return function u_(e,t){return e[1].data[t].pure}(r,i)?XV(r,Or(),t,s.transform,n,s):s.transform(n)}function XT(e){return t=>{setTimeout(e,void 0,t)}}const tt=class V0e extends Pn{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,n,i){var r,s,o;let a=t,l=n||(()=>null),u=i;if(t&&"object"==typeof t){const d=t;a=null===(r=d.next)||void 0===r?void 0:r.bind(d),l=null===(s=d.error)||void 0===s?void 0:s.bind(d),u=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}this.__isAsync&&(l=XT(l),a&&(a=XT(a)),u&&(u=XT(u)));const c=super.subscribe({next:a,error:l,complete:u});return t instanceof Jn&&t.add(c),c}};function H0e(){return this._results[Wp()]()}class QT{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const n=Wp(),i=QT.prototype;i[n]||(i[n]=H0e)}get changes(){return this._changes||(this._changes=new tt)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,n){return this._results.reduce(t,n)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,n){const i=this;i.dirty=!1;const r=vo(t);(this._changesDetected=!function nfe(e,t,n){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],s=t[i];if(n&&(r=n(r),s=n(s)),s!==r)return!1}return!0}(i._results,r,n))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Mn=(()=>{class e{}return e.__NG_ELEMENT_ID__=q0e,e})();const U0e=Mn,z0e=class extends U0e{constructor(t,n,i){super(),this._declarationLView=t,this._declarationTContainer=n,this.elementRef=i}createEmbeddedView(t){const n=this._declarationTContainer.tViews,i=Y0(this._declarationLView,n,t,16,null,n.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(n)),K0(n,i,t),new o_(i)}};function q0e(){return Ub(mi(),ae())}function Ub(e,t){return 4&e.type?new z0e(t,e,lg(e,t)):null}let Do=(()=>{class e{}return e.__NG_ELEMENT_ID__=G0e,e})();function G0e(){return r7(mi(),ae())}const W0e=Do,n7=class extends W0e{constructor(t,n,i){super(),this._lContainer=t,this._hostTNode=n,this._hostLView=i}get element(){return lg(this._hostTNode,this._hostLView)}get injector(){return new Np(this._hostTNode,this._hostLView)}get parentInjector(){const t=db(this._hostTNode,this._hostLView);if(e8(t)){const n=Op(t,this._hostLView),i=Tp(t);return new Np(n[1].data[i+8],n)}return new Np(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const n=i7(this._lContainer);return null!==n&&n[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,n,i){const r=t.createEmbeddedView(n||{});return this.insert(r,i),r}createComponent(t,n,i,r,s){const o=t&&!function R0(e){return"function"==typeof e}(t);let a;if(o)a=n;else{const d=n||{};a=d.index,i=d.injector,r=d.projectableNodes,s=d.ngModuleRef}const l=o?t:new YT(rr(t)),u=i||this.parentInjector;if(!s&&null==l.ngModule){const f=(o?u:this.parentInjector).get(Su,null);f&&(s=f)}const c=l.create(u,r,void 0,s);return this.insert(c.hostView,a),c}insert(t,n){const i=t._lView,r=i[1];if(function Cde(e){return na(e[3])}(i)){const c=this.indexOf(t);if(-1!==c)this.detach(c);else{const d=i[3],f=new n7(d,d[6],d[3]);f.detach(f.indexOf(t))}}const s=this._adjustIndex(n),o=this._lContainer;!function Mhe(e,t,n,i){const r=10+i,s=n.length;i>0&&(n[r-1][4]=t),i<s-10?(t[4]=n[r],c8(n,10+i,t)):(n.push(t),t[4]=null),t[3]=n;const o=t[17];null!==o&&n!==o&&function The(e,t){const n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(o,t);const a=t[19];null!==a&&a.insertView(e),t[2]|=128}(r,i,o,s);const a=WM(s,o),l=i[11],u=Cb(l,o[7]);return null!==u&&function She(e,t,n,i,r,s){i[0]=r,i[6]=t,W0(e,i,n,1,r,s)}(r,o[6],l,i,u,a),t.attachToViewContainerRef(),c8(ZT(o),s,t),t}move(t,n){return this.insert(t,n)}indexOf(t){const n=i7(this._lContainer);return null!==n?n.indexOf(t):-1}remove(t){const n=this._adjustIndex(t,-1),i=zM(this._lContainer,n);i&&(pb(ZT(this._lContainer),n),W8(i[1],i))}detach(t){const n=this._adjustIndex(t,-1),i=zM(this._lContainer,n);return i&&null!=pb(ZT(this._lContainer),n)?new o_(i):null}_adjustIndex(t,n=0){return null==t?this.length+n:t}};function i7(e){return e[8]}function ZT(e){return e[8]||(e[8]=[])}function r7(e,t){let n;const i=t[e.index];if(na(i))n=i;else{let r;if(8&e.type)r=si(i);else{const s=t[11];r=s.createComment("");const o=yo(e,t);Df(s,Cb(s,o),r,function Ihe(e,t){return Vn(e)?e.nextSibling(t):t.nextSibling}(s,o),!1)}t[e.index]=n=P$(i,t,r,e),Ob(t,n)}return new n7(n,e,t)}class eO{constructor(t){this.queryList=t,this.matches=null}clone(){return new eO(this.queryList)}setDirty(){this.queryList.setDirty()}}class tO{constructor(t=[]){this.queries=t}createEmbeddedView(t){const n=t.queries;if(null!==n){const i=null!==t.contentQueries?t.contentQueries[0]:n.length,r=[];for(let s=0;s<i;s++){const o=n.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new tO(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let n=0;n<this.queries.length;n++)null!==u7(t,n).matches&&this.queries[n].setDirty()}}class s7{constructor(t,n,i=null){this.predicate=t,this.flags=n,this.read=i}}class nO{constructor(t=[]){this.queries=t}elementStart(t,n){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(t,n)}elementEnd(t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(t)}embeddedTView(t){let n=null;for(let i=0;i<this.length;i++){const r=null!==n?n.length:0,s=this.getByIndex(i).embeddedTView(t,r);s&&(s.indexInDeclarationView=i,null!==n?n.push(s):n=[s])}return null!==n?new nO(n):null}template(t,n){for(let i=0;i<this.queries.length;i++)this.queries[i].template(t,n)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class iO{constructor(t,n=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(t,n){this.isApplyingToNode(n)&&this.matchTNode(t,n)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,n){this.elementStart(t,n)}embeddedTView(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new iO(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const n=this._declarationNodeIndex;let i=t.parent;for(;null!==i&&8&i.type&&i.index!==n;)i=i.parent;return n===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(t,n){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(t,n,J0e(n,s)),this.matchTNodeWithReadOption(t,n,hb(n,t,s,!1,!1))}else i===Mn?4&n.type&&this.matchTNodeWithReadOption(t,n,-1):this.matchTNodeWithReadOption(t,n,hb(n,t,i,!1,!1))}matchTNodeWithReadOption(t,n,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===cn||r===Do||r===Mn&&4&n.type)this.addMatch(n.index,-2);else{const s=hb(n,t,r,!1,!1);null!==s&&this.addMatch(n.index,s)}else this.addMatch(n.index,i)}}addMatch(t,n){null===this.matches?this.matches=[t,n]:this.matches.push(t,n)}}function J0e(e,t){const n=e.localNames;if(null!==n)for(let i=0;i<n.length;i+=2)if(n[i]===t)return n[i+1];return null}function Q0e(e,t,n,i){return-1===n?function X0e(e,t){return 11&e.type?lg(e,t):4&e.type?Ub(e,t):null}(t,e):-2===n?function Z0e(e,t,n){return n===cn?lg(t,e):n===Mn?Ub(t,e):n===Do?r7(t,e):void 0}(e,t,i):k0(e,e[1],n,t)}function o7(e,t,n,i){const r=t[19].queries[i];if(null===r.matches){const s=e.data,o=n.matches,a=[];for(let l=0;l<o.length;l+=2){const u=o[l];a.push(u<0?null:Q0e(t,s[u],o[l+1],n.metadata.read))}r.matches=a}return r.matches}function rO(e,t,n,i){const r=e.queries.getByIndex(n),s=r.matches;if(null!==s){const o=o7(e,t,r,n);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const u=s[a+1],c=t[-l];for(let d=10;d<c.length;d++){const f=c[d];f[17]===f[3]&&rO(f[1],f,u,i)}if(null!==c[9]){const d=c[9];for(let f=0;f<d.length;f++){const h=d[f];rO(h[1],h,u,i)}}}}}return i}function Tn(e){const t=ae(),n=Ct(),i=q4();hM(i+1);const r=u7(n,i);if(e.dirty&&B4(t)===(2==(2&r.metadata.flags))){if(null===r.matches)e.reset([]);else{const s=r.crossesNgTemplate?rO(n,t,i,[]):o7(n,t,r,i);e.reset(s,_0e),e.notifyOnChanges()}return!0}return!1}function zb(e,t,n){const i=Ct();i.firstCreatePass&&(function l7(e,t,n){null===e.queries&&(e.queries=new nO),e.queries.track(new iO(t,n))}(i,new s7(e,t,n),-1),2==(2&t)&&(i.staticViewQueries=!0)),function a7(e,t,n){const i=new QT(4==(4&n));M$(e,t,i,i.destroy),null===t[19]&&(t[19]=new tO),t[19].queries.push(new eO(i))}(i,ae(),t)}function On(){return function e_e(e,t){return e[19].queries[t].queryList}(ae(),q4())}function u7(e,t){return e.queries.getByIndex(t)}function Co(e,t){return Ub(e,t)}function Wb(...e){}const cO=new it("Application Initializer");let dO=(()=>{class e{constructor(n){this.appInits=n,this.resolve=Wb,this.reject=Wb,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const n=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(Z0(s))n.push(s);else if(IT(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});n.push(o)}}Promise.all(n).then(()=>{i()}).catch(r=>{this.reject(r)}),0===n.length&&i(),this.initialized=!0}}return e.\u0275fac=function(n){return new(n||e)(me(cO,8))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const d_=new it("AppId",{providedIn:"root",factory:function x7(){return`${fO()}${fO()}${fO()}`}});function fO(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const A7=new it("Platform Initializer"),f_=new it("Platform ID"),M7=new it("appBootstrapListener");let T7=(()=>{class e{log(n){console.log(n)}warn(n){console.warn(n)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();const Nc=new it("LocaleId",{providedIn:"root",factory:()=>gfe(Nc,Ye.Optional|Ye.SkipSelf)||function y_e(){return"undefined"!=typeof $localize&&$localize.locale||Lb}()});class b_e{constructor(t,n){this.ngModuleFactory=t,this.componentFactories=n}}let O7=(()=>{class e{compileModuleSync(n){return new KT(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const i=this.compileModuleSync(n),s=al(go(n).declarations).reduce((o,a)=>{const l=rr(a);return l&&o.push(new YT(l)),o},[]);return new b_e(i,s)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const D_e=(()=>Promise.resolve(0))();function hO(e){"undefined"==typeof Zone?D_e.then(()=>{e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}class dn{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new tt(!1),this.onMicrotaskEmpty=new tt(!1),this.onStable=new tt(!1),this.onError=new tt(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&n,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function C_e(){let e=Zt.requestAnimationFrame,t=Zt.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function x_e(e){const t=()=>{!function S_e(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Zt,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,gO(e),e.isCheckStableRunning=!0,pO(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),gO(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,i,r,s,o,a)=>{try{return N7(e),n.invokeTask(r,s,o,a)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||e.shouldCoalesceRunChangeDetection)&&t(),k7(e)}},onInvoke:(n,i,r,s,o,a,l)=>{try{return N7(e),n.invoke(r,s,o,a,l)}finally{e.shouldCoalesceRunChangeDetection&&t(),k7(e)}},onHasTask:(n,i,r,s)=>{n.hasTask(r,s),i===r&&("microTask"==s.change?(e._hasPendingMicrotasks=s.microTask,gO(e),pO(e)):"macroTask"==s.change&&(e.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,i,r,s)=>(n.handleError(r,s),e.runOutsideAngular(()=>e.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!dn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(dn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,n,i){return this._inner.run(t,n,i)}runTask(t,n,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,t,E_e,Wb,Wb);try{return s.runTask(o,n,i)}finally{s.cancelTask(o)}}runGuarded(t,n,i){return this._inner.runGuarded(t,n,i)}runOutsideAngular(t){return this._outer.run(t)}}const E_e={};function pO(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function gO(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function N7(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function k7(e){e._nesting--,pO(e)}class A_e{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new tt,this.onMicrotaskEmpty=new tt,this.onStable=new tt,this.onError=new tt}run(t,n,i){return t.apply(n,i)}runGuarded(t,n,i){return t.apply(n,i)}runOutsideAngular(t){return t()}runTask(t,n,i,r){return t.apply(n,i)}}let mO=(()=>{class e{constructor(n){this._ngZone=n,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{dn.assertNotInAngularZone(),hO(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())hO(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(n)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),n(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:n,timeoutId:s,updateCb:r})}whenStable(n,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(n,i,r){return[]}}return e.\u0275fac=function(n){return new(n||e)(me(dn))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})(),I7=(()=>{class e{constructor(){this._applications=new Map,_O.addToWindow(this)}registerApplication(n,i){this._applications.set(n,i)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,i=!0){return _O.findTestabilityInTree(this,n,i)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();class M_e{addToWindow(t){}findTestabilityInTree(t,n,i){return null}}let fa,_O=new M_e;const R7=new it("AllowMultipleToken");class F7{constructor(t,n){this.name=t,this.token=n}}function P7(e,t,n=[]){const i=`Platform: ${t}`,r=new it(i);return(s=[])=>{let o=L7();if(!o||o.injector.get(R7,!1))if(e)e(n.concat(s).concat({provide:r,useValue:!0}));else{const a=n.concat(s).concat({provide:r,useValue:!0},{provide:yT,useValue:"platform"});!function k_e(e){if(fa&&!fa.destroyed&&!fa.injector.get(R7,!1))throw new xe(400,"");fa=e.get(j7);const t=e.get(A7,null);t&&t.forEach(n=>n())}(ai.create({providers:a,name:i}))}return function I_e(e){const t=L7();if(!t)throw new xe(401,"");return t}()}}function L7(){return fa&&!fa.destroyed?fa:null}let j7=(()=>{class e{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,i){const a=function R_e(e,t){let n;return n="noop"===e?new A_e:("zone.js"===e?void 0:e)||new dn({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),n}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),l=[{provide:dn,useValue:a}];return a.run(()=>{const u=ai.create({providers:l,parent:this.injector,name:n.moduleType.name}),c=n.create(u),d=c.injector.get(q0,null);if(!d)throw new xe(402,"");return a.runOutsideAngular(()=>{const f=a.onError.subscribe({next:h=>{d.handleError(h)}});c.onDestroy(()=>{yO(this._modules,c),f.unsubscribe()})}),function F_e(e,t,n){try{const i=n();return Z0(i)?i.catch(r=>{throw t.runOutsideAngular(()=>e.handleError(r)),r}):i}catch(i){throw t.runOutsideAngular(()=>e.handleError(i)),i}}(d,a,()=>{const f=c.injector.get(dO);return f.runInitializers(),f.donePromise.then(()=>(function bme(e){Is(e,"Expected localeId to be defined"),"string"==typeof e&&(yV=e.toLowerCase().replace(/_/g,"-"))}(c.injector.get(Nc,Lb)||Lb),this._moduleDoBootstrap(c),c))})})}bootstrapModule(n,i=[]){const r=B7({},i);return function O_e(e,t,n){const i=new KT(n);return Promise.resolve(i)}(0,0,n).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(n){const i=n.injector.get(h_);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!n.instance.ngDoBootstrap)throw new xe(403,"");n.instance.ngDoBootstrap(i)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new xe(404,"");this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n()),this._destroyed=!0}get destroyed(){return this._destroyed}}return e.\u0275fac=function(n){return new(n||e)(me(ai))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();function B7(e,t){return Array.isArray(t)?t.reduce(B7,e):Object.assign(Object.assign({},e),t)}let h_=(()=>{class e{constructor(n,i,r,s,o){this._zone=n,this._injector=i,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new Qt(u=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{u.next(this._stable),u.complete()})}),l=new Qt(u=>{let c;this._zone.runOutsideAngular(()=>{c=this._zone.onStable.subscribe(()=>{dn.assertNotInAngularZone(),hO(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,u.next(!0))})})});const d=this._zone.onUnstable.subscribe(()=>{dn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{u.next(!1)}))});return()=>{c.unsubscribe(),d.unsubscribe()}});this.isStable=D4(a,l.pipe(C4()))}bootstrap(n,i){if(!this._initStatus.done)throw new xe(405,"");let r;r=n instanceof UV?n:this._componentFactoryResolver.resolveComponentFactory(n),this.componentTypes.push(r.componentType);const s=function N_e(e){return e.isBoundToModule}(r)?void 0:this._injector.get(Su),a=r.create(ai.NULL,[],i||r.selector,s),l=a.location.nativeElement,u=a.injector.get(mO,null),c=u&&a.injector.get(I7);return u&&c&&c.registerApplication(l,u),a.onDestroy(()=>{this.detachView(a.hostView),yO(this.components,a),c&&c.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new xe(101,"");try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(n))}finally{this._runningTick=!1}}attachView(n){const i=n;this._views.push(i),i.attachToAppRef(this)}detachView(n){const i=n;yO(this._views,i),i.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(M7,[]).concat(this._bootstrapListeners).forEach(r=>r(n))}ngOnDestroy(){this._views.slice().forEach(n=>n.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return e.\u0275fac=function(n){return new(n||e)(me(dn),me(ai),me(q0),me(ag),me(dO))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function yO(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}let V7=!0,Eo=(()=>{class e{}return e.__NG_ELEMENT_ID__=j_e,e})();function j_e(e){return function B_e(e,t,n){if(Q1(e)&&!n){const i=Fs(e.index,t);return new o_(i,i)}return 47&e.type?new o_(t[16],t):null}(mi(),ae(),16==(16&e))}class G7{constructor(){}supports(t){return X0(t)}create(t){return new q_e(t)}}const z_e=(e,t)=>t;class q_e{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||z_e}forEachItem(t){let n;for(n=this._itHead;null!==n;n=n._next)t(n)}forEachOperation(t){let n=this._itHead,i=this._removalsHead,r=0,s=null;for(;n||i;){const o=!i||n&&n.currentIndex<Y7(i,r,s)?n:i,a=Y7(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(n=n._next,null==o.previousIndex)r++;else{s||(s=[]);const u=a-r,c=l-r;if(u!=c){for(let f=0;f<u;f++){const h=f<s.length?s[f]:s[f]=0,p=h+f;c<=p&&p<u&&(s[f]=h+1)}s[o.previousIndex]=c-u}}a!==l&&t(o,a,l)}}forEachPreviousItem(t){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachMovedItem(t){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}forEachIdentityChange(t){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)t(n)}diff(t){if(null==t&&(t=[]),!X0(t))throw new xe(900,"");return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let r,s,o,n=this._itHead,i=!1;if(Array.isArray(t)){this.length=t.length;for(let a=0;a<this.length;a++)s=t[a],o=this._trackByFn(a,s),null!==n&&Object.is(n.trackById,o)?(i&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)):(n=this._mismatch(n,s,o,a),i=!0),n=n._next}else r=0,function lge(e,t){if(Array.isArray(e))for(let n=0;n<e.length;n++)t(e[n]);else{const n=e[Wp()]();let i;for(;!(i=n.next()).done;)t(i.value)}}(t,a=>{o=this._trackByFn(r,a),null!==n&&Object.is(n.trackById,o)?(i&&(n=this._verifyReinsertion(n,a,o,r)),Object.is(n.item,a)||this._addIdentityChange(n,a)):(n=this._mismatch(n,a,o,r),i=!0),n=n._next,r++}),this.length=r;return this._truncate(n),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,n,i,r){let s;return null===t?s=this._itTail:(s=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._reinsertAfter(t,s,r)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._moveAfter(t,s,r)):t=this._addAfter(new G_e(n,i),s,r),t}_verifyReinsertion(t,n,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?t=this._reinsertAfter(s,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const n=t._next;this._addToRemovals(this._unlink(t)),t=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,n,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,s=t._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(t,n,i),this._addToMoves(t,i),t}_moveAfter(t,n,i){return this._unlink(t),this._insertAfter(t,n,i),this._addToMoves(t,i),t}_addAfter(t,n,i){return this._insertAfter(t,n,i),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,n,i){const r=null===n?this._itHead:n._next;return t._next=r,t._prev=n,null===r?this._itTail=t:r._prev=t,null===n?this._itHead=t:n._next=t,null===this._linkedRecords&&(this._linkedRecords=new W7),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const n=t._prev,i=t._next;return null===n?this._itHead=i:n._next=i,null===i?this._itTail=n:i._prev=n,t}_addToMoves(t,n){return t.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new W7),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,n){return t.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class G_e{constructor(t,n){this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class W_e{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,n){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===n||n<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){const n=t._prevDup,i=t._nextDup;return null===n?this._head=i:n._nextDup=i,null===i?this._tail=n:i._prevDup=n,null===this._head}}class W7{constructor(){this.map=new Map}put(t){const n=t.trackById;let i=this.map.get(n);i||(i=new W_e,this.map.set(n,i)),i.add(t)}get(t,n){const r=this.map.get(t);return r?r.get(t,n):null}remove(t){const n=t.trackById;return this.map.get(n).remove(t)&&this.map.delete(n),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Y7(e,t,n){const i=e.previousIndex;if(null===i)return i;let r=0;return n&&i<n.length&&(r=n[i]),i+t+r}class K7{constructor(){}supports(t){return t instanceof Map||ET(t)}create(){return new Y_e}}class Y_e{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let n;for(n=this._mapHead;null!==n;n=n._next)t(n)}forEachPreviousItem(t){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)t(n)}forEachChangedItem(t){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}diff(t){if(t){if(!(t instanceof Map||ET(t)))throw new xe(900,"")}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(t,(i,r)=>{if(n&&n.key===r)this._maybeAddToChanges(n,i),this._appendAfter=n,n=n._next;else{const s=this._getOrCreateRecordForKey(r,i);n=this._insertBeforeOrAppend(n,s)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let i=n;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,n){if(t){const i=t._prev;return n._next=t,n._prev=i,t._prev=n,i&&(i._next=n),t===this._mapHead&&(this._mapHead=n),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(t,n){if(this._records.has(t)){const r=this._records.get(t);this._maybeAddToChanges(r,n);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new K_e(t);return this._records.set(t,i),i.currentValue=n,this._addToAdditions(i),i}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,n){Object.is(n,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=n,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,n){t instanceof Map?t.forEach(n):Object.keys(t).forEach(i=>n(t[i],i))}}class K_e{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function J7(){return new Jb([new G7])}let Jb=(()=>{class e{constructor(n){this.factories=n}static create(n,i){if(null!=i){const r=i.factories.slice();n=n.concat(r)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||J7()),deps:[[e,new B0,new Ec]]}}find(n){const i=this.factories.find(r=>r.supports(n));if(null!=i)return i;throw new xe(901,"")}}return e.\u0275prov=Oe({token:e,providedIn:"root",factory:J7}),e})();function X7(){return new p_([new K7])}let p_=(()=>{class e{constructor(n){this.factories=n}static create(n,i){if(i){const r=i.factories.slice();n=n.concat(r)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||X7()),deps:[[e,new B0,new Ec]]}}find(n){const i=this.factories.find(s=>s.supports(n));if(i)return i;throw new xe(901,"")}}return e.\u0275prov=Oe({token:e,providedIn:"root",factory:X7}),e})();const Q_e=P7(null,"core",[{provide:f_,useValue:"unknown"},{provide:j7,deps:[ai]},{provide:I7,deps:[]},{provide:T7,deps:[]}]);let Z_e=(()=>{class e{constructor(n){}}return e.\u0275fac=function(n){return new(n||e)(me(h_))},e.\u0275mod=$t({type:e}),e.\u0275inj=It({}),e})(),Xb=null;function fl(){return Xb}const ti=new it("DocumentToken");let Af=(()=>{class e{historyGo(n){throw new Error("Not implemented")}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Oe({token:e,factory:function(){return function iye(){return me(Q7)}()},providedIn:"platform"}),e})();const rye=new it("Location Initialized");let Q7=(()=>{class e extends Af{constructor(n){super(),this._doc=n,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return fl().getBaseHref(this._doc)}onPopState(n){const i=fl().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",n,!1),()=>i.removeEventListener("popstate",n)}onHashChange(n){const i=fl().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",n,!1),()=>i.removeEventListener("hashchange",n)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(n){this.location.pathname=n}pushState(n,i,r){Z7()?this._history.pushState(n,i,r):this.location.hash=r}replaceState(n,i,r){Z7()?this._history.replaceState(n,i,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return e.\u0275fac=function(n){return new(n||e)(me(ti))},e.\u0275prov=Oe({token:e,factory:function(){return function sye(){return new Q7(me(ti))}()},providedIn:"platform"}),e})();function Z7(){return!!window.history.pushState}function CO(e,t){if(0==e.length)return t;if(0==t.length)return e;let n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function eH(e){const t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function xu(e){return e&&"?"!==e[0]?"?"+e:e}let fg=(()=>{class e{historyGo(n){throw new Error("Not implemented")}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Oe({token:e,factory:function(){return function oye(e){const t=me(ti).location;return new tH(me(Af),t&&t.origin||"")}()},providedIn:"root"}),e})();const EO=new it("appBaseHref");let tH=(()=>{class e extends fg{constructor(n,i){if(super(),this._platformLocation=n,this._removeListenerFns=[],null==i&&(i=this._platformLocation.getBaseHrefFromDOM()),null==i)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=i}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return CO(this._baseHref,n)}path(n=!1){const i=this._platformLocation.pathname+xu(this._platformLocation.search),r=this._platformLocation.hash;return r&&n?`${i}${r}`:i}pushState(n,i,r,s){const o=this.prepareExternalUrl(r+xu(s));this._platformLocation.pushState(n,i,o)}replaceState(n,i,r,s){const o=this.prepareExternalUrl(r+xu(s));this._platformLocation.replaceState(n,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,n)}}return e.\u0275fac=function(n){return new(n||e)(me(Af),me(EO,8))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})(),aye=(()=>{class e extends fg{constructor(n,i){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(n){const i=CO(this._baseHref,n);return i.length>0?"#"+i:i}pushState(n,i,r,s){let o=this.prepareExternalUrl(r+xu(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(n,i,o)}replaceState(n,i,r,s){let o=this.prepareExternalUrl(r+xu(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(n,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,n)}}return e.\u0275fac=function(n){return new(n||e)(me(Af),me(EO,8))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})(),SO=(()=>{class e{constructor(n,i){this._subject=new tt,this._urlChangeListeners=[],this._platformStrategy=n;const r=this._platformStrategy.getBaseHref();this._platformLocation=i,this._baseHref=eH(nH(r)),this._platformStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}path(n=!1){return this.normalize(this._platformStrategy.path(n))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(n,i=""){return this.path()==this.normalize(n+xu(i))}normalize(n){return e.stripTrailingSlash(function uye(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,nH(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._platformStrategy.prepareExternalUrl(n)}go(n,i="",r=null){this._platformStrategy.pushState(r,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+xu(i)),r)}replaceState(n,i="",r=null){this._platformStrategy.replaceState(r,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+xu(i)),r)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(n=0){var i,r;null===(r=(i=this._platformStrategy).historyGo)||void 0===r||r.call(i,n)}onUrlChange(n){this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}))}_notifyUrlChangeListeners(n="",i){this._urlChangeListeners.forEach(r=>r(n,i))}subscribe(n,i,r){return this._subject.subscribe({next:n,error:i,complete:r})}}return e.normalizeQueryParams=xu,e.joinWithSlash=CO,e.stripTrailingSlash=eH,e.\u0275fac=function(n){return new(n||e)(me(fg),me(Af))},e.\u0275prov=Oe({token:e,factory:function(){return function lye(){return new SO(me(fg),me(Af))}()},providedIn:"root"}),e})();function nH(e){return e.replace(/\/index.html$/,"")}function dH(e,t){t=encodeURIComponent(t);for(const n of e.split(";")){const i=n.indexOf("="),[r,s]=-1==i?[n,""]:[n.slice(0,i),n.slice(i+1)];if(r.trim()===t)return decodeURIComponent(s)}return null}let hl=(()=>{class e{constructor(n,i,r,s){this._iterableDiffers=n,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(n){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof n?n.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(n){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof n?n.split(/\s+/):n,this._rawClass&&(X0(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const n=this._iterableDiffer.diff(this._rawClass);n&&this._applyIterableChanges(n)}else if(this._keyValueDiffer){const n=this._keyValueDiffer.diff(this._rawClass);n&&this._applyKeyValueChanges(n)}}_applyKeyValueChanges(n){n.forEachAddedItem(i=>this._toggleClass(i.key,i.currentValue)),n.forEachChangedItem(i=>this._toggleClass(i.key,i.currentValue)),n.forEachRemovedItem(i=>{i.previousValue&&this._toggleClass(i.key,!1)})}_applyIterableChanges(n){n.forEachAddedItem(i=>{if("string"!=typeof i.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Yt(i.item)}`);this._toggleClass(i.item,!0)}),n.forEachRemovedItem(i=>this._toggleClass(i.item,!1))}_applyClasses(n){n&&(Array.isArray(n)||n instanceof Set?n.forEach(i=>this._toggleClass(i,!0)):Object.keys(n).forEach(i=>this._toggleClass(i,!!n[i])))}_removeClasses(n){n&&(Array.isArray(n)||n instanceof Set?n.forEach(i=>this._toggleClass(i,!1)):Object.keys(n).forEach(i=>this._toggleClass(i,!1)))}_toggleClass(n,i){(n=n.trim())&&n.split(/\s+/g).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return e.\u0275fac=function(n){return new(n||e)(H(Jb),H(p_),H(cn),H($s))},e.\u0275dir=ye({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e})();class Wye{constructor(t,n,i,r){this.$implicit=t,this.ngForOf=n,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Mf=(()=>{class e{constructor(n,i,r){this._viewContainer=n,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const i=this._viewContainer;n.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new Wye(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),fH(a,r)}});for(let r=0,s=i.length;r<s;r++){const a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}n.forEachIdentityChange(r=>{fH(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(n,i){return!0}}return e.\u0275fac=function(n){return new(n||e)(H(Do),H(Mn),H(Jb))},e.\u0275dir=ye({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e})();function fH(e,t){e.context.$implicit=t.item}let Fr=(()=>{class e{constructor(n,i){this._viewContainer=n,this._context=new Yye,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){hH("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){hH("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,i){return!0}}return e.\u0275fac=function(n){return new(n||e)(H(Do),H(Mn))},e.\u0275dir=ye({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e})();class Yye{constructor(){this.$implicit=null,this.ngIf=null}}function hH(e,t){if(t&&!t.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${Yt(t)}'.`)}let hg=(()=>{class e{constructor(n){this._viewContainerRef=n,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(n){if(n.ngTemplateOutlet){const i=this._viewContainerRef;this._viewRef&&i.remove(i.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?i.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&n.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return e.\u0275fac=function(n){return new(n||e)(H(Do))},e.\u0275dir=ye({type:e,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[xn]}),e})(),Vs=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({}),e})();let Eve=(()=>{class e{}return e.\u0275prov=Oe({token:e,providedIn:"root",factory:()=>new Sve(me(ti),window)}),e})();class Sve{constructor(t,n){this.document=t,this.window=n,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const n=function xve(e,t){const n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow)){const i=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(t)||s.querySelector(`[name="${t}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,t);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const n=this.window.history;n&&n.scrollRestoration&&(n.scrollRestoration=t)}}scrollToElement(t){const n=t.getBoundingClientRect(),i=n.left+this.window.pageXOffset,r=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=_H(this.window.history)||_H(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch(t){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(t){return!1}}}function _H(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}class yH{}class BO extends class Ave extends class nye{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function tye(e){Xb||(Xb=e)}(new BO)}onAndCancel(t,n,i){return t.addEventListener(n,i,!1),()=>{t.removeEventListener(n,i,!1)}}dispatchEvent(t,n){t.dispatchEvent(n)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,n){return(n=n||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,n){return"window"===n?window:"document"===n?t:"body"===n?t.body:null}getBaseHref(t){const n=function Mve(){return __=__||document.querySelector("base"),__?__.getAttribute("href"):null}();return null==n?null:function Tve(e){aw=aw||document.createElement("a"),aw.setAttribute("href",e);const t=aw.pathname;return"/"===t.charAt(0)?t:`/${t}`}(n)}resetBaseElement(){__=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return dH(document.cookie,t)}}let aw,__=null;const vH=new it("TRANSITION_ID"),Nve=[{provide:cO,useFactory:function Ove(e,t,n){return()=>{n.get(dO).donePromise.then(()=>{const i=fl(),r=t.querySelectorAll(`style[ng-transition="${e}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[vH,ti,ai],multi:!0}];class $O{static init(){!function T_e(e){_O=e}(new $O)}addToWindow(t){Zt.getAngularTestability=(i,r=!0)=>{const s=t.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},Zt.getAllAngularTestabilities=()=>t.getAllTestabilities(),Zt.getAllAngularRootElements=()=>t.getAllRootElements(),Zt.frameworkStabilizers||(Zt.frameworkStabilizers=[]),Zt.frameworkStabilizers.push(i=>{const r=Zt.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(t,n,i){if(null==n)return null;const r=t.getTestability(n);return null!=r?r:i?fl().isShadowRoot(n)?this.findTestabilityInTree(t,n.host,!0):this.findTestabilityInTree(t,n.parentElement,!0):null}}let kve=(()=>{class e{build(){return new XMLHttpRequest}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();const lw=new it("EventManagerPlugins");let uw=(()=>{class e{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(r=>r.manager=this),this._plugins=n.slice().reverse()}addEventListener(n,i,r){return this._findPluginFor(i).addEventListener(n,i,r)}addGlobalEventListener(n,i,r){return this._findPluginFor(i).addGlobalEventListener(n,i,r)}getZone(){return this._zone}_findPluginFor(n){const i=this._eventNameToPlugin.get(n);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(n))return this._eventNameToPlugin.set(n,o),o}throw new Error(`No event manager plugin found for event ${n}`)}}return e.\u0275fac=function(n){return new(n||e)(me(lw),me(dn))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();class bH{constructor(t){this._doc=t}addGlobalEventListener(t,n,i){const r=fl().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${n}`);return this.addEventListener(r,n,i)}}let wH=(()=>{class e{constructor(){this._stylesSet=new Set}addStyles(n){const i=new Set;n.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(n){}getAllStyles(){return Array.from(this._stylesSet)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})(),y_=(()=>{class e extends wH{constructor(n){super(),this._doc=n,this._hostNodes=new Map,this._hostNodes.set(n.head,[])}_addStylesToHost(n,i,r){n.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(n){const i=[];this._addStylesToHost(this._stylesSet,n,i),this._hostNodes.set(n,i)}removeHost(n){const i=this._hostNodes.get(n);i&&i.forEach(DH),this._hostNodes.delete(n)}onStylesAdded(n){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(n,r,i)})}ngOnDestroy(){this._hostNodes.forEach(n=>n.forEach(DH))}}return e.\u0275fac=function(n){return new(n||e)(me(ti))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();function DH(e){fl().remove(e)}const VO={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},HO=/%COMP%/g;function cw(e,t,n){for(let i=0;i<t.length;i++){let r=t[i];Array.isArray(r)?cw(e,r,n):(r=r.replace(HO,e),n.push(r))}return n}function SH(e){return t=>{if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}let dw=(()=>{class e{constructor(n,i,r){this.eventManager=n,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new UO(n)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;switch(i.encapsulation){case ea.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new jve(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(n),r}case 1:case ea.ShadowDom:return new Bve(this.eventManager,this.sharedStylesHost,n,i);default:if(!this.rendererByCompId.has(i.id)){const r=cw(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return e.\u0275fac=function(n){return new(n||e)(me(uw),me(y_),me(d_))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();class UO{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,n){return n?document.createElementNS(VO[n]||n,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,n){t.appendChild(n)}insertBefore(t,n,i){t&&t.insertBefore(n,i)}removeChild(t,n){t&&t.removeChild(n)}selectRootElement(t,n){let i="string"==typeof t?document.querySelector(t):t;if(!i)throw new Error(`The selector "${t}" did not match any elements`);return n||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,n,i,r){if(r){n=r+":"+n;const s=VO[r];s?t.setAttributeNS(s,n,i):t.setAttribute(n,i)}else t.setAttribute(n,i)}removeAttribute(t,n,i){if(i){const r=VO[i];r?t.removeAttributeNS(r,n):t.removeAttribute(`${i}:${n}`)}else t.removeAttribute(n)}addClass(t,n){t.classList.add(n)}removeClass(t,n){t.classList.remove(n)}setStyle(t,n,i,r){r&(Ls.DashCase|Ls.Important)?t.style.setProperty(n,i,r&Ls.Important?"important":""):t.style[n]=i}removeStyle(t,n,i){i&Ls.DashCase?t.style.removeProperty(n):t.style[n]=""}setProperty(t,n,i){t[n]=i}setValue(t,n){t.nodeValue=n}listen(t,n,i){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,n,SH(i)):this.eventManager.addEventListener(t,n,SH(i))}}class jve extends UO{constructor(t,n,i,r){super(t),this.component=i;const s=cw(r+"-"+i.id,i.styles,[]);n.addStyles(s),this.contentAttr=function Fve(e){return"_ngcontent-%COMP%".replace(HO,e)}(r+"-"+i.id),this.hostAttr=function Pve(e){return"_nghost-%COMP%".replace(HO,e)}(r+"-"+i.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,n){const i=super.createElement(t,n);return super.setAttribute(i,this.contentAttr,""),i}}class Bve extends UO{constructor(t,n,i,r){super(t),this.sharedStylesHost=n,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=cw(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,n){return super.appendChild(this.nodeOrShadowRoot(t),n)}insertBefore(t,n,i){return super.insertBefore(this.nodeOrShadowRoot(t),n,i)}removeChild(t,n){return super.removeChild(this.nodeOrShadowRoot(t),n)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let $ve=(()=>{class e extends bH{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,r){return n.addEventListener(i,r,!1),()=>this.removeEventListener(n,i,r)}removeEventListener(n,i,r){return n.removeEventListener(i,r)}}return e.\u0275fac=function(n){return new(n||e)(me(ti))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();const AH=["alt","control","meta","shift"],Hve={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},MH={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Uve={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let zve=(()=>{class e extends bH{constructor(n){super(n)}supports(n){return null!=e.parseEventName(n)}addEventListener(n,i,r){const s=e.parseEventName(i),o=e.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>fl().onAndCancel(n,s.domEventName,o))}static parseEventName(n){const i=n.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=e._normalizeKey(i.pop());let o="";if(AH.forEach(l=>{const u=i.indexOf(l);u>-1&&(i.splice(u,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(n){let i="",r=function qve(e){let t=e.key;if(null==t){if(t=e.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&MH.hasOwnProperty(t)&&(t=MH[t]))}return Hve[t]||t}(n);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),AH.forEach(s=>{s!=r&&Uve[s](n)&&(i+=s+".")}),i+=r,i}static eventCallback(n,i,r){return s=>{e.getEventFullKey(s)===n&&r.runGuarded(()=>i(s))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return e.\u0275fac=function(n){return new(n||e)(me(ti))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();const Kve=P7(Q_e,"browser",[{provide:f_,useValue:"browser"},{provide:A7,useValue:function Gve(){BO.makeCurrent(),$O.init()},multi:!0},{provide:ti,useFactory:function Yve(){return function vde(e){rM=e}(document),document},deps:[]}]),Jve=[{provide:yT,useValue:"root"},{provide:q0,useFactory:function Wve(){return new q0},deps:[]},{provide:lw,useClass:$ve,multi:!0,deps:[ti,dn,f_]},{provide:lw,useClass:zve,multi:!0,deps:[ti]},{provide:dw,useClass:dw,deps:[uw,y_,d_]},{provide:ug,useExisting:dw},{provide:wH,useExisting:y_},{provide:y_,useClass:y_,deps:[ti]},{provide:mO,useClass:mO,deps:[dn]},{provide:uw,useClass:uw,deps:[lw,dn]},{provide:yH,useClass:kve,deps:[]}];let TH=(()=>{class e{constructor(n){if(n)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(n){return{ngModule:e,providers:[{provide:d_,useValue:n.appId},{provide:vH,useExisting:d_},Nve]}}}return e.\u0275fac=function(n){return new(n||e)(me(e,12))},e.\u0275mod=$t({type:e}),e.\u0275inj=It({providers:Jve,imports:[Vs,Z_e]}),e})();function Ge(...e){return Ti(e,C0(e))}"undefined"!=typeof window&&window;class ki extends Pn{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const n=super._subscribe(t);return!n.closed&&t.next(this._value),n}getValue(){const{hasError:t,thrownError:n,_value:i}=this;if(t)throw n;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}}const{isArray:a1e}=Array,{getPrototypeOf:l1e,prototype:u1e,keys:c1e}=Object;function kH(e){if(1===e.length){const t=e[0];if(a1e(t))return{args:t,keys:null};if(function d1e(e){return e&&"object"==typeof e&&l1e(e)===u1e}(t)){const n=c1e(t);return{args:n.map(i=>t[i]),keys:n}}}return{args:e,keys:null}}const{isArray:f1e}=Array;function qO(e){return ot(t=>function h1e(e,t){return f1e(t)?e(...t):e(t)}(e,t))}function IH(e,t){return e.reduce((n,i,r)=>(n[i]=t[r],n),{})}function RH(e,t,n){e?_u(n,e,t):t()}function fw(e,t){const n=Xe(e)?e:()=>e,i=r=>r.error(n());return new Qt(t?r=>t.schedule(i,0,r):i)}const hw=We(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function v_(...e){return function g1e(){return D0(1)}()(Ti(e,C0(e)))}function FH(e){return new Qt(t=>{nr(e()).subscribe(t)})}function PH(){return Xn((e,t)=>{let n=null;e._refCount++;const i=yn(t,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(n=null);const r=e._connection,s=n;n=null,r&&(!s||r===s)&&r.unsubscribe(),t.unsubscribe()});e.subscribe(i),i.closed||(n=e.connect())})}class m1e extends Qt{constructor(t,n){super(),this.source=t,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,s4(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,null==t||t.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new Jn;const n=this.getSubject();t.add(this.source.subscribe(yn(n,void 0,()=>{this._teardown(),n.complete()},i=>{this._teardown(),n.error(i)},()=>this._teardown()))),t.closed&&(this._connection=null,t=Jn.EMPTY)}return t}refCount(){return PH()(this)}}function Mu(e,t){return Xn((n,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();n.subscribe(yn(i,l=>{null==r||r.unsubscribe();let u=0;const c=s++;nr(e(l,c)).subscribe(r=yn(i,d=>i.next(t?t(l,d,c,u++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function _1e(e,t,n,i,r){return(s,o)=>{let a=n,l=t,u=0;s.subscribe(yn(o,c=>{const d=u++;l=a?e(l,c,d):(a=!0,c),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}function LH(e,t){return Xn(_1e(e,t,arguments.length>=2,!0))}function Ii(e,t){return Xn((n,i)=>{let r=0;n.subscribe(yn(i,s=>e.call(t,s,r++)&&i.next(s)))})}function Ic(e){return Xn((t,n)=>{let s,i=null,r=!1;i=t.subscribe(yn(n,void 0,void 0,o=>{s=nr(e(o,Ic(e)(t))),i?(i.unsubscribe(),i=null,s.subscribe(n)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(n))})}function pg(e,t){return Xe(t)?Qn(e,t,1):Qn(e,1)}function WO(e){return e<=0?()=>Qo:Xn((t,n)=>{let i=[];t.subscribe(yn(n,r=>{i.push(r),e<i.length&&i.shift()},()=>{for(const r of i)n.next(r);n.complete()},void 0,()=>{i=null}))})}function jH(e=y1e){return Xn((t,n)=>{let i=!1;t.subscribe(yn(n,r=>{i=!0,n.next(r)},()=>i?n.complete():n.error(e())))})}function y1e(){return new hw}function BH(e){return Xn((t,n)=>{let i=!1;t.subscribe(yn(n,r=>{i=!0,n.next(r)},()=>{i||n.next(e),n.complete()}))})}function gg(e,t){const n=arguments.length>=2;return i=>i.pipe(e?Ii((r,s)=>e(r,s,i)):mu,gi(1),n?BH(t):jH(()=>new hw))}function cr(e,t,n){const i=Xe(e)||t||n?{next:e,error:t,complete:n}:e;return i?Xn((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(yn(s,l=>{var u;null===(u=i.next)||void 0===u||u.call(i,l),s.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),s.complete()},l=>{var u;a=!1,null===(u=i.error)||void 0===u||u.call(i,l),s.error(l)},()=>{var l,u;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(u=i.finalize)||void 0===u||u.call(i)}))}):mu}class Tu{constructor(t,n){this.id=t,this.url=n}}class YO extends Tu{constructor(t,n,i="imperative",r=null){super(t,n),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class b_ extends Tu{constructor(t,n,i){super(t,n),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class $H extends Tu{constructor(t,n,i){super(t,n),this.reason=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class w1e extends Tu{constructor(t,n,i){super(t,n),this.error=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class D1e extends Tu{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class C1e extends Tu{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class E1e extends Tu{constructor(t,n,i,r,s){super(t,n),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class S1e extends Tu{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class x1e extends Tu{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class VH{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class HH{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class A1e{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class M1e{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class T1e{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class O1e{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class UH{constructor(t,n,i){this.routerEvent=t,this.position=n,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const gt="primary";class N1e{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n[0]:n}return null}getAll(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function mg(e){return new N1e(e)}const zH="ngNavigationCancelingError";function KO(e){const t=Error("NavigationCancelingError: "+e);return t[zH]=!0,t}function I1e(e,t,n){const i=n.path.split("/");if(i.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||i.length<e.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=e[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:e.slice(0,i.length),posParams:r}}function pl(e,t){const n=e?Object.keys(e):void 0,i=t?Object.keys(t):void 0;if(!n||!i||n.length!=i.length)return!1;let r;for(let s=0;s<n.length;s++)if(r=n[s],!qH(e[r],t[r]))return!1;return!0}function qH(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;const n=[...e].sort(),i=[...t].sort();return n.every((r,s)=>i[s]===r)}return e===t}function GH(e){return Array.prototype.concat.apply([],e)}function WH(e){return e.length>0?e[e.length-1]:null}function Gi(e,t){for(const n in e)e.hasOwnProperty(n)&&t(e[n],n)}function gl(e){return IT(e)?e:Z0(e)?Ti(Promise.resolve(e)):Ge(e)}const P1e={exact:function JH(e,t,n){if(!Of(e.segments,t.segments)||!gw(e.segments,t.segments,n)||e.numberOfChildren!==t.numberOfChildren)return!1;for(const i in t.children)if(!e.children[i]||!JH(e.children[i],t.children[i],n))return!1;return!0},subset:XH},YH={exact:function L1e(e,t){return pl(e,t)},subset:function j1e(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(n=>qH(e[n],t[n]))},ignored:()=>!0};function KH(e,t,n){return P1e[n.paths](e.root,t.root,n.matrixParams)&&YH[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function XH(e,t,n){return QH(e,t,t.segments,n)}function QH(e,t,n,i){if(e.segments.length>n.length){const r=e.segments.slice(0,n.length);return!(!Of(r,n)||t.hasChildren()||!gw(r,n,i))}if(e.segments.length===n.length){if(!Of(e.segments,n)||!gw(e.segments,n,i))return!1;for(const r in t.children)if(!e.children[r]||!XH(e.children[r],t.children[r],i))return!1;return!0}{const r=n.slice(0,e.segments.length),s=n.slice(e.segments.length);return!!(Of(e.segments,r)&&gw(e.segments,r,i)&&e.children[gt])&&QH(e.children[gt],t,s,i)}}function gw(e,t,n){return t.every((i,r)=>YH[n](e[r].parameters,i.parameters))}class Tf{constructor(t,n,i){this.root=t,this.queryParams=n,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=mg(this.queryParams)),this._queryParamMap}toString(){return V1e.serialize(this)}}class yt{constructor(t,n){this.segments=t,this.children=n,this.parent=null,Gi(n,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return mw(this)}}class w_{constructor(t,n){this.path=t,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=mg(this.parameters)),this._parameterMap}toString(){return i9(this)}}function Of(e,t){return e.length===t.length&&e.every((n,i)=>n.path===t[i].path)}class ZH{}class e9{parse(t){const n=new J1e(t);return new Tf(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(t){const n=`/${D_(t.root,!0)}`,i=function z1e(e){const t=Object.keys(e).map(n=>{const i=e[n];return Array.isArray(i)?i.map(r=>`${_w(n)}=${_w(r)}`).join("&"):`${_w(n)}=${_w(i)}`}).filter(n=>!!n);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${n}${i}${"string"==typeof t.fragment?`#${function H1e(e){return encodeURI(e)}(t.fragment)}`:""}`}}const V1e=new e9;function mw(e){return e.segments.map(t=>i9(t)).join("/")}function D_(e,t){if(!e.hasChildren())return mw(e);if(t){const n=e.children[gt]?D_(e.children[gt],!1):"",i=[];return Gi(e.children,(r,s)=>{s!==gt&&i.push(`${s}:${D_(r,!1)}`)}),i.length>0?`${n}(${i.join("//")})`:n}{const n=function $1e(e,t){let n=[];return Gi(e.children,(i,r)=>{r===gt&&(n=n.concat(t(i,r)))}),Gi(e.children,(i,r)=>{r!==gt&&(n=n.concat(t(i,r)))}),n}(e,(i,r)=>r===gt?[D_(e.children[gt],!1)]:[`${r}:${D_(i,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[gt]?`${mw(e)}/${n[0]}`:`${mw(e)}/(${n.join("//")})`}}function t9(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function _w(e){return t9(e).replace(/%3B/gi,";")}function JO(e){return t9(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function yw(e){return decodeURIComponent(e)}function n9(e){return yw(e.replace(/\+/g,"%20"))}function i9(e){return`${JO(e.path)}${function U1e(e){return Object.keys(e).map(t=>`;${JO(t)}=${JO(e[t])}`).join("")}(e.parameters)}`}const q1e=/^[^\/()?;=#]+/;function vw(e){const t=e.match(q1e);return t?t[0]:""}const G1e=/^[^=?&#]+/,Y1e=/^[^&#]+/;class J1e{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new yt([],{}):new yt([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(t.length>0||Object.keys(n).length>0)&&(i[gt]=new yt(t,n)),i}parseSegment(){const t=vw(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new w_(yw(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const n=vw(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){const r=vw(this.remaining);r&&(i=r,this.capture(i))}t[yw(n)]=yw(i)}parseQueryParam(t){const n=function W1e(e){const t=e.match(G1e);return t?t[0]:""}(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){const o=function K1e(e){const t=e.match(Y1e);return t?t[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=n9(n),s=n9(i);if(t.hasOwnProperty(r)){let o=t[r];Array.isArray(o)||(o=[o],t[r]=o),o.push(s)}else t[r]=s}parseParens(t){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=vw(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let s;i.indexOf(":")>-1?(s=i.substr(0,i.indexOf(":")),this.capture(s),this.capture(":")):t&&(s=gt);const o=this.parseChildren();n[s]=1===Object.keys(o).length?o[gt]:new yt([],o),this.consumeOptional("//")}return n}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class r9{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const n=this.pathFromRoot(t);return n.length>1?n[n.length-2]:null}children(t){const n=XO(t,this._root);return n?n.children.map(i=>i.value):[]}firstChild(t){const n=XO(t,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(t){const n=QO(t,this._root);return n.length<2?[]:n[n.length-2].children.map(r=>r.value).filter(r=>r!==t)}pathFromRoot(t){return QO(t,this._root).map(n=>n.value)}}function XO(e,t){if(e===t.value)return t;for(const n of t.children){const i=XO(e,n);if(i)return i}return null}function QO(e,t){if(e===t.value)return[t];for(const n of t.children){const i=QO(e,n);if(i.length)return i.unshift(t),i}return[]}class Ou{constructor(t,n){this.value=t,this.children=n}toString(){return`TreeNode(${this.value})`}}function _g(e){const t={};return e&&e.children.forEach(n=>t[n.value.outlet]=n),t}class s9 extends r9{constructor(t,n){super(t),this.snapshot=n,ZO(this,t)}toString(){return this.snapshot.toString()}}function o9(e,t){const n=function X1e(e,t){const o=new bw([],{},{},"",{},gt,t,null,e.root,-1,{});return new l9("",new Ou(o,[]))}(e,t),i=new ki([new w_("",{})]),r=new ki({}),s=new ki({}),o=new ki({}),a=new ki(""),l=new Nf(i,r,o,a,s,gt,t,n.root);return l.snapshot=n.root,new s9(new Ou(l,[]),n)}class Nf{constructor(t,n,i,r,s,o,a,l){this.url=t,this.params=n,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(ot(t=>mg(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(ot(t=>mg(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function a9(e,t="emptyOnly"){const n=e.pathFromRoot;let i=0;if("always"!==t)for(i=n.length-1;i>=1;){const r=n[i],s=n[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function Q1e(e){return e.reduce((t,n)=>({params:Object.assign(Object.assign({},t.params),n.params),data:Object.assign(Object.assign({},t.data),n.data),resolve:Object.assign(Object.assign({},t.resolve),n._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(i))}class bw{constructor(t,n,i,r,s,o,a,l,u,c,d){this.url=t,this.params=n,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=u,this._lastPathIndex=c,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=mg(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=mg(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class l9 extends r9{constructor(t,n){super(n),this.url=t,ZO(this,n)}toString(){return u9(this._root)}}function ZO(e,t){t.value._routerState=e,t.children.forEach(n=>ZO(e,n))}function u9(e){const t=e.children.length>0?` { ${e.children.map(u9).join(", ")} } `:"";return`${e.value}${t}`}function e2(e){if(e.snapshot){const t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,pl(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),pl(t.params,n.params)||e.params.next(n.params),function R1e(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!pl(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),pl(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function t2(e,t){const n=pl(e.params,t.params)&&function B1e(e,t){return Of(e,t)&&e.every((n,i)=>pl(n.parameters,t[i].parameters))}(e.url,t.url);return n&&!(!e.parent!=!t.parent)&&(!e.parent||t2(e.parent,t.parent))}function C_(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){const i=n.value;i._futureSnapshot=t.value;const r=function ebe(e,t,n){return t.children.map(i=>{for(const r of n.children)if(e.shouldReuseRoute(i.value,r.value.snapshot))return C_(e,i,r);return C_(e,i)})}(e,t,n);return new Ou(i,r)}{if(e.shouldAttach(t.value)){const s=e.retrieve(t.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=t.value,o.children=t.children.map(a=>C_(e,a)),o}}const i=function tbe(e){return new Nf(new ki(e.url),new ki(e.params),new ki(e.queryParams),new ki(e.fragment),new ki(e.data),e.outlet,e.component,e)}(t.value),r=t.children.map(s=>C_(e,s));return new Ou(i,r)}}function ww(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function E_(e){return"object"==typeof e&&null!=e&&e.outlets}function n2(e,t,n,i,r){let s={};if(i&&Gi(i,(a,l)=>{s[l]=Array.isArray(a)?a.map(u=>`${u}`):`${a}`}),e===t)return new Tf(n,s,r);const o=c9(e,t,n);return new Tf(o,s,r)}function c9(e,t,n){const i={};return Gi(e.children,(r,s)=>{i[s]=r===t?n:c9(r,t,n)}),new yt(e.segments,i)}class d9{constructor(t,n,i){if(this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=i,t&&i.length>0&&ww(i[0]))throw new Error("Root segment cannot have matrix parameters");const r=i.find(E_);if(r&&r!==WH(i))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class r2{constructor(t,n,i){this.segmentGroup=t,this.processChildren=n,this.index=i}}function f9(e,t,n){if(e||(e=new yt([],{})),0===e.segments.length&&e.hasChildren())return Dw(e,t,n);const i=function abe(e,t,n){let i=0,r=t;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<e.segments.length;){if(i>=n.length)return s;const o=e.segments[r],a=n[i];if(E_(a))break;const l=`${a}`,u=i<n.length-1?n[i+1]:null;if(r>0&&void 0===l)break;if(l&&u&&"object"==typeof u&&void 0===u.outlets){if(!p9(l,u,o))return s;i+=2}else{if(!p9(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(e,t,n),r=n.slice(i.commandIndex);if(i.match&&i.pathIndex<e.segments.length){const s=new yt(e.segments.slice(0,i.pathIndex),{});return s.children[gt]=new yt(e.segments.slice(i.pathIndex),e.children),Dw(s,0,r)}return i.match&&0===r.length?new yt(e.segments,{}):i.match&&!e.hasChildren()?s2(e,t,n):i.match?Dw(e,0,r):s2(e,t,n)}function Dw(e,t,n){if(0===n.length)return new yt(e.segments,{});{const i=function obe(e){return E_(e[0])?e[0].outlets:{[gt]:e}}(n),r={};return Gi(i,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=f9(e.children[o],t,s))}),Gi(e.children,(s,o)=>{void 0===i[o]&&(r[o]=s)}),new yt(e.segments,r)}}function s2(e,t,n){const i=e.segments.slice(0,t);let r=0;for(;r<n.length;){const s=n[r];if(E_(s)){const l=lbe(s.outlets);return new yt(i,l)}if(0===r&&ww(n[0])){i.push(new w_(e.segments[t].path,h9(n[0]))),r++;continue}const o=E_(s)?s.outlets[gt]:`${s}`,a=r<n.length-1?n[r+1]:null;o&&a&&ww(a)?(i.push(new w_(o,h9(a))),r+=2):(i.push(new w_(o,{})),r++)}return new yt(i,{})}function lbe(e){const t={};return Gi(e,(n,i)=>{"string"==typeof n&&(n=[n]),null!==n&&(t[i]=s2(new yt([],{}),0,n))}),t}function h9(e){const t={};return Gi(e,(n,i)=>t[i]=`${n}`),t}function p9(e,t,n){return e==n.path&&pl(t,n.parameters)}class cbe{constructor(t,n,i,r){this.routeReuseStrategy=t,this.futureState=n,this.currState=i,this.forwardEvent=r}activate(t){const n=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,i,t),e2(this.futureState.root),this.activateChildRoutes(n,i,t)}deactivateChildRoutes(t,n,i){const r=_g(n);t.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Gi(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(t,n,i){const r=t.value,s=n?n.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(t,n,o.children)}else this.deactivateChildRoutes(t,n,i);else s&&this.deactivateRouteAndItsChildren(n,i)}deactivateRouteAndItsChildren(t,n){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,n):this.deactivateRouteAndOutlet(t,n)}detachAndStoreRouteSubtree(t,n){const i=n.getContext(t.value.outlet),r=i&&t.value.component?i.children:n,s=_g(t);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:o,route:t,contexts:a})}}deactivateRouteAndOutlet(t,n){const i=n.getContext(t.value.outlet),r=i&&t.value.component?i.children:n,s=_g(t);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(t,n,i){const r=_g(n);t.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new O1e(s.value.snapshot))}),t.children.length&&this.forwardEvent(new M1e(t.value.snapshot))}activateRoutes(t,n,i){const r=t.value,s=n?n.value:null;if(e2(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(t,n,o.children)}else this.activateChildRoutes(t,n,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),e2(a.route.value),this.activateChildRoutes(t,null,o.children)}else{const a=function dbe(e){for(let t=e.parent;t;t=t.parent){const n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),l=a?a.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=l,o.outlet&&o.outlet.activateWith(r,l),this.activateChildRoutes(t,null,o.children)}}else this.activateChildRoutes(t,null,i)}}class o2{constructor(t,n){this.routes=t,this.module=n}}function Rc(e){return"function"==typeof e}function kf(e){return e instanceof Tf}const S_=Symbol("INITIAL_VALUE");function x_(){return Mu(e=>function GO(...e){const t=C0(e),n=q1(e),{args:i,keys:r}=kH(e);if(0===i.length)return Ti([],t);const s=new Qt(function p1e(e,t,n=mu){return i=>{RH(t,()=>{const{length:r}=e,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)RH(t,()=>{const u=Ti(e[l],t);let c=!1;u.subscribe(yn(i,d=>{s[l]=d,c||(c=!0,a--),a||i.next(n(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,t,r?o=>IH(r,o):mu));return n?s.pipe(qO(n)):s}(e.map(t=>t.pipe(gi(1),function pw(...e){const t=C0(e);return Xn((n,i)=>{(t?v_(e,n,t):v_(e,n)).subscribe(i)})}(S_)))).pipe(LH((t,n)=>{let i=!1;return n.reduce((r,s,o)=>r!==S_?r:(s===S_&&(i=!0),i||!1!==s&&o!==n.length-1&&!kf(s)?r:s),t)},S_),Ii(t=>t!==S_),ot(t=>kf(t)?t:!0===t),gi(1)))}class _be{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new A_,this.attachRef=null}}class A_{constructor(){this.contexts=new Map}onChildOutletCreated(t,n){const i=this.getOrCreateContext(t);i.outlet=n,this.contexts.set(t,i)}onChildOutletDestroyed(t){const n=this.getContext(t);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let n=this.getContext(t);return n||(n=new _be,this.contexts.set(t,n)),n}getContext(t){return this.contexts.get(t)||null}}let a2=(()=>{class e{constructor(n,i,r,s,o){this.parentContexts=n,this.location=i,this.resolver=r,this.changeDetector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new tt,this.deactivateEvents=new tt,this.attachEvents=new tt,this.detachEvents=new tt,this.name=s||gt,n.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const n=this.parentContexts.getContext(this.name);n&&n.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=n;const o=(i=i||this.resolver).resolveComponentFactory(n._futureSnapshot.routeConfig.component),a=this.parentContexts.getOrCreateContext(this.name).children,l=new ybe(n,a,this.location.injector);this.activated=this.location.createComponent(o,this.location.length,l),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return e.\u0275fac=function(n){return new(n||e)(H(A_),H(Do),H(ag),function wf(e){return function Jde(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;const n=e.attrs;if(n){const i=n.length;let r=0;for(;r<i;){const s=n[r];if(Q4(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof n[r];)r++;else{if(s===t)return n[r+1];r+=2}}}return null}(mi(),e)}("name"),H(Eo))},e.\u0275dir=ye({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),e})();class ybe{constructor(t,n,i){this.route=t,this.childContexts=n,this.parent=i}get(t,n){return t===Nf?this.route:t===A_?this.childContexts:this.parent.get(t,n)}}let g9=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=bn({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(n,i){1&n&&dt(0,"router-outlet")},directives:[a2],encapsulation:2}),e})();function m9(e,t=""){for(let n=0;n<e.length;n++){const i=e[n];vbe(i,bbe(t,i))}}function vbe(e,t){e.children&&m9(e.children,t)}function bbe(e,t){return t?e||t.path?e&&!t.path?`${e}/`:!e&&t.path?t.path:`${e}/${t.path}`:"":e}function l2(e){const t=e.children&&e.children.map(l2),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==gt&&(n.component=g9),n}function Ao(e){return e.outlet||gt}function _9(e,t){const n=e.filter(i=>Ao(i)===t);return n.push(...e.filter(i=>Ao(i)!==t)),n}const y9={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Cw(e,t,n){var i;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?Object.assign({},y9):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};const s=(t.matcher||I1e)(n,e,t);if(!s)return Object.assign({},y9);const o={};Gi(s.posParams,(l,u)=>{o[u]=l.path});const a=s.consumed.length>0?Object.assign(Object.assign({},o),s.consumed[s.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:s.consumed,remainingSegments:n.slice(s.consumed.length),parameters:a,positionalParamSegments:null!==(i=s.posParams)&&void 0!==i?i:{}}}function Ew(e,t,n,i,r="corrected"){if(n.length>0&&function Cbe(e,t,n){return n.some(i=>Sw(e,t,i)&&Ao(i)!==gt)}(e,n,i)){const o=new yt(t,function Dbe(e,t,n,i){const r={};r[gt]=i,i._sourceSegment=e,i._segmentIndexShift=t.length;for(const s of n)if(""===s.path&&Ao(s)!==gt){const o=new yt([],{});o._sourceSegment=e,o._segmentIndexShift=t.length,r[Ao(s)]=o}return r}(e,t,i,new yt(n,e.children)));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:[]}}if(0===n.length&&function Ebe(e,t,n){return n.some(i=>Sw(e,t,i))}(e,n,i)){const o=new yt(e.segments,function wbe(e,t,n,i,r,s){const o={};for(const a of i)if(Sw(e,n,a)&&!r[Ao(a)]){const l=new yt([],{});l._sourceSegment=e,l._segmentIndexShift="legacy"===s?e.segments.length:t.length,o[Ao(a)]=l}return Object.assign(Object.assign({},r),o)}(e,t,n,i,e.children,r));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:n}}const s=new yt(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function Sw(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function v9(e,t,n,i){return!!(Ao(e)===i||i!==gt&&Sw(t,n,e))&&("**"===e.path||Cw(t,e,n).matched)}function b9(e,t,n){return 0===t.length&&!e.children[n]}class xw{constructor(t){this.segmentGroup=t||null}}class w9{constructor(t){this.urlTree=t}}function M_(e){return fw(new xw(e))}function D9(e){return fw(new w9(e))}class Mbe{constructor(t,n,i,r,s){this.configLoader=n,this.urlSerializer=i,this.urlTree=r,this.config=s,this.allowRedirects=!0,this.ngModule=t.get(Su)}apply(){const t=Ew(this.urlTree.root,[],[],this.config).segmentGroup,n=new yt(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,n,gt).pipe(ot(s=>this.createUrlTree(u2(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Ic(s=>{if(s instanceof w9)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof xw?this.noMatchError(s):s}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,gt).pipe(ot(r=>this.createUrlTree(u2(r),t.queryParams,t.fragment))).pipe(Ic(r=>{throw r instanceof xw?this.noMatchError(r):r}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,n,i){const r=t.segments.length>0?new yt([],{[gt]:t}):t;return new Tf(r,n,i)}expandSegmentGroup(t,n,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(t,n,i).pipe(ot(s=>new yt([],s))):this.expandSegment(t,i,n,i.segments,r,!0)}expandChildren(t,n,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return Ti(r).pipe(pg(s=>{const o=i.children[s],a=_9(n,s);return this.expandSegmentGroup(t,a,o,s).pipe(ot(l=>({segment:l,outlet:s})))}),LH((s,o)=>(s[o.outlet]=o.segment,s),{}),function v1e(e,t){const n=arguments.length>=2;return i=>i.pipe(e?Ii((r,s)=>e(r,s,i)):mu,WO(1),n?BH(t):jH(()=>new hw))}())}expandSegment(t,n,i,r,s,o){return Ti(i).pipe(pg(a=>this.expandSegmentAgainstRoute(t,n,i,a,r,s,o).pipe(Ic(u=>{if(u instanceof xw)return Ge(null);throw u}))),gg(a=>!!a),Ic((a,l)=>{if(a instanceof hw||"EmptyError"===a.name)return b9(n,r,s)?Ge(new yt([],{})):M_(n);throw a}))}expandSegmentAgainstRoute(t,n,i,r,s,o,a){return v9(r,n,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,n,r,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,n,i,r,s,o):M_(n):M_(n)}expandSegmentAgainstRouteUsingRedirect(t,n,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,n,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,i,r){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?D9(s):this.lineralizeSegments(i,s).pipe(Qn(o=>{const a=new yt(o,{});return this.expandSegment(t,a,n,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,n,i,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:u,positionalParamSegments:c}=Cw(n,r,s);if(!a)return M_(n);const d=this.applyRedirectCommands(l,r.redirectTo,c);return r.redirectTo.startsWith("/")?D9(d):this.lineralizeSegments(r,d).pipe(Qn(f=>this.expandSegment(t,n,i,f.concat(u),o,!1)))}matchSegmentAgainstRoute(t,n,i,r,s){if("**"===i.path)return i.loadChildren?(i._loadedConfig?Ge(i._loadedConfig):this.configLoader.load(t.injector,i)).pipe(ot(d=>(i._loadedConfig=d,new yt(r,{})))):Ge(new yt(r,{}));const{matched:o,consumedSegments:a,remainingSegments:l}=Cw(n,i,r);return o?this.getChildConfig(t,i,r).pipe(Qn(c=>{const d=c.module,f=c.routes,{segmentGroup:h,slicedSegments:p}=Ew(n,a,l,f),g=new yt(h.segments,h.children);if(0===p.length&&g.hasChildren())return this.expandChildren(d,f,g).pipe(ot(v=>new yt(a,v)));if(0===f.length&&0===p.length)return Ge(new yt(a,{}));const m=Ao(i)===s;return this.expandSegment(d,g,f,p,m?gt:s,!0).pipe(ot(y=>new yt(a.concat(y.segments),y.children)))})):M_(n)}getChildConfig(t,n,i){return n.children?Ge(new o2(n.children,t)):n.loadChildren?void 0!==n._loadedConfig?Ge(n._loadedConfig):this.runCanLoadGuards(t.injector,n,i).pipe(Qn(r=>r?this.configLoader.load(t.injector,n).pipe(ot(s=>(n._loadedConfig=s,s))):function xbe(e){return fw(KO(`Cannot load children because the guard of the route "path: '${e.path}'" returned false`))}(n))):Ge(new o2([],t))}runCanLoadGuards(t,n,i){const r=n.canLoad;return r&&0!==r.length?Ge(r.map(o=>{const a=t.get(o);let l;if(function hbe(e){return e&&Rc(e.canLoad)}(a))l=a.canLoad(n,i);else{if(!Rc(a))throw new Error("Invalid CanLoad guard");l=a(n,i)}return gl(l)})).pipe(x_(),cr(o=>{if(!kf(o))return;const a=KO(`Redirecting to "${this.urlSerializer.serialize(o)}"`);throw a.url=o,a}),ot(o=>!0===o)):Ge(!0)}lineralizeSegments(t,n){let i=[],r=n.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return Ge(i);if(r.numberOfChildren>1||!r.children[gt])return fw(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t.redirectTo}'`));r=r.children[gt]}}applyRedirectCommands(t,n,i){return this.applyRedirectCreatreUrlTree(n,this.urlSerializer.parse(n),t,i)}applyRedirectCreatreUrlTree(t,n,i,r){const s=this.createSegmentGroup(t,n.root,i,r);return new Tf(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(t,n){const i={};return Gi(t,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const a=r.substring(1);i[s]=n[a]}else i[s]=r}),i}createSegmentGroup(t,n,i,r){const s=this.createSegments(t,n.segments,i,r);let o={};return Gi(n.children,(a,l)=>{o[l]=this.createSegmentGroup(t,a,i,r)}),new yt(s,o)}createSegments(t,n,i,r){return n.map(s=>s.path.startsWith(":")?this.findPosParam(t,s,r):this.findOrReturn(s,i))}findPosParam(t,n,i){const r=i[n.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${t}'. Cannot find '${n.path}'.`);return r}findOrReturn(t,n){let i=0;for(const r of n){if(r.path===t.path)return n.splice(i),r;i++}return t}}function u2(e){const t={};for(const i of Object.keys(e.children)){const s=u2(e.children[i]);(s.segments.length>0||s.hasChildren())&&(t[i]=s)}return function Tbe(e){if(1===e.numberOfChildren&&e.children[gt]){const t=e.children[gt];return new yt(e.segments.concat(t.segments),t.children)}return e}(new yt(e.segments,t))}class C9{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Aw{constructor(t,n){this.component=t,this.route=n}}function Nbe(e,t,n){const i=e._root;return T_(i,t?t._root:null,n,[i.value])}function Mw(e,t,n){const i=function Ibe(e){if(!e)return null;for(let t=e.parent;t;t=t.parent){const n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(i?i.module.injector:n).get(e)}function T_(e,t,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=_g(t);return e.children.forEach(o=>{(function Rbe(e,t,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=e.value,o=t?t.value:null,a=n?n.getContext(e.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function Fbe(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!Of(e.url,t.url);case"pathParamsOrQueryParamsChange":return!Of(e.url,t.url)||!pl(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!t2(e,t)||!pl(e.queryParams,t.queryParams);default:return!t2(e,t)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new C9(i)):(s.data=o.data,s._resolvedData=o._resolvedData),T_(e,t,s.component?a?a.children:null:n,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Aw(a.outlet.component,o))}else o&&O_(t,a,r),r.canActivateChecks.push(new C9(i)),T_(e,null,s.component?a?a.children:null:n,i,r)})(o,s[o.value.outlet],n,i.concat([o.value]),r),delete s[o.value.outlet]}),Gi(s,(o,a)=>O_(o,n.getContext(a),r)),r}function O_(e,t,n){const i=_g(e),r=e.value;Gi(i,(s,o)=>{O_(s,r.component?t?t.children.getContext(o):null:t,n)}),n.canDeactivateChecks.push(new Aw(r.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,r))}class zbe{}function E9(e){return new Qt(t=>t.error(e))}class Gbe{constructor(t,n,i,r,s,o){this.rootComponentType=t,this.config=n,this.urlTree=i,this.url=r,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=o}recognize(){const t=Ew(this.urlTree.root,[],[],this.config.filter(o=>void 0===o.redirectTo),this.relativeLinkResolution).segmentGroup,n=this.processSegmentGroup(this.config,t,gt);if(null===n)return null;const i=new bw([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},gt,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Ou(i,n),s=new l9(this.url,r);return this.inheritParamsAndData(s._root),s}inheritParamsAndData(t){const n=t.value,i=a9(n,this.paramsInheritanceStrategy);n.params=Object.freeze(i.params),n.data=Object.freeze(i.data),t.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(t,n,i){return 0===n.segments.length&&n.hasChildren()?this.processChildren(t,n):this.processSegment(t,n,n.segments,i)}processChildren(t,n){const i=[];for(const s of Object.keys(n.children)){const o=n.children[s],a=_9(t,s),l=this.processSegmentGroup(a,o,s);if(null===l)return null;i.push(...l)}const r=S9(i);return function Wbe(e){e.sort((t,n)=>t.value.outlet===gt?-1:n.value.outlet===gt?1:t.value.outlet.localeCompare(n.value.outlet))}(r),r}processSegment(t,n,i,r){for(const s of t){const o=this.processSegmentAgainstRoute(s,n,i,r);if(null!==o)return o}return b9(n,i,r)?[]:null}processSegmentAgainstRoute(t,n,i,r){if(t.redirectTo||!v9(t,n,i,r))return null;let s,o=[],a=[];if("**"===t.path){const h=i.length>0?WH(i).parameters:{};s=new bw(i,h,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,M9(t),Ao(t),t.component,t,x9(n),A9(n)+i.length,T9(t))}else{const h=Cw(n,t,i);if(!h.matched)return null;o=h.consumedSegments,a=h.remainingSegments,s=new bw(o,h.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,M9(t),Ao(t),t.component,t,x9(n),A9(n)+o.length,T9(t))}const l=function Ybe(e){return e.children?e.children:e.loadChildren?e._loadedConfig.routes:[]}(t),{segmentGroup:u,slicedSegments:c}=Ew(n,o,a,l.filter(h=>void 0===h.redirectTo),this.relativeLinkResolution);if(0===c.length&&u.hasChildren()){const h=this.processChildren(l,u);return null===h?null:[new Ou(s,h)]}if(0===l.length&&0===c.length)return[new Ou(s,[])];const d=Ao(t)===r,f=this.processSegment(l,u,c,d?gt:r);return null===f?null:[new Ou(s,f)]}}function Kbe(e){const t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function S9(e){const t=[],n=new Set;for(const i of e){if(!Kbe(i)){t.push(i);continue}const r=t.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),n.add(r)):t.push(i)}for(const i of n){const r=S9(i.children);t.push(new Ou(i.value,r))}return t.filter(i=>!n.has(i))}function x9(e){let t=e;for(;t._sourceSegment;)t=t._sourceSegment;return t}function A9(e){let t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;for(;t._sourceSegment;)t=t._sourceSegment,n+=t._segmentIndexShift?t._segmentIndexShift:0;return n-1}function M9(e){return e.data||{}}function T9(e){return e.resolve||{}}function O9(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}function c2(e){return Mu(t=>{const n=e(t);return n?Ti(n).pipe(ot(()=>t)):Ge(t)})}class iwe extends class nwe{shouldDetach(t){return!1}store(t,n){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,n){return t.routeConfig===n.routeConfig}}{}const d2=new it("ROUTES");class N9{constructor(t,n,i,r){this.injector=t,this.compiler=n,this.onLoadStartListener=i,this.onLoadEndListener=r}load(t,n){if(n._loader$)return n._loader$;this.onLoadStartListener&&this.onLoadStartListener(n);const r=this.loadModuleFactory(n.loadChildren).pipe(ot(s=>{this.onLoadEndListener&&this.onLoadEndListener(n);const o=s.create(t);return new o2(GH(o.injector.get(d2,void 0,Ye.Self|Ye.Optional)).map(l2),o)}),Ic(s=>{throw n._loader$=void 0,s}));return n._loader$=new m1e(r,()=>new Pn).pipe(PH()),n._loader$}loadModuleFactory(t){return gl(t()).pipe(Qn(n=>n instanceof WV?Ge(n):Ti(this.compiler.compileModuleAsync(n))))}}class swe{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,n){return t}}function owe(e){throw e}function awe(e,t,n){return t.parse("/")}function k9(e,t){return Ge(null)}const lwe={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},uwe={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Hs=(()=>{class e{constructor(n,i,r,s,o,a,l){this.rootComponentType=n,this.urlSerializer=i,this.rootContexts=r,this.location=s,this.config=l,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Pn,this.errorHandler=owe,this.malformedUriErrorHandler=awe,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:k9,afterPreactivation:k9},this.urlHandlingStrategy=new swe,this.routeReuseStrategy=new iwe,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=o.get(Su),this.console=o.get(T7);const d=o.get(dn);this.isNgZoneEnabled=d instanceof dn&&dn.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=function F1e(){return new Tf(new yt([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new N9(o,a,f=>this.triggerEvent(new VH(f)),f=>this.triggerEvent(new HH(f))),this.routerState=o9(this.currentUrlTree,this.rootComponentType),this.transitions=new ki({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var n;return null===(n=this.location.getState())||void 0===n?void 0:n.\u0275routerPageId}setupNavigations(n){const i=this.events;return n.pipe(Ii(r=>0!==r.id),ot(r=>Object.assign(Object.assign({},r),{extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),Mu(r=>{let s=!1,o=!1;return Ge(r).pipe(cr(a=>{this.currentNavigation={id:a.id,initialUrl:a.currentRawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Mu(a=>{const l=this.browserUrlTree.toString(),u=!this.navigated||a.extractedUrl.toString()!==l||l!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||u)&&this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return I9(a.source)&&(this.browserUrlTree=a.extractedUrl),Ge(a).pipe(Mu(d=>{const f=this.transitions.getValue();return i.next(new YO(d.id,this.serializeUrl(d.extractedUrl),d.source,d.restoredState)),f!==this.transitions.getValue()?Qo:Promise.resolve(d)}),function Obe(e,t,n,i){return Mu(r=>function Abe(e,t,n,i,r){return new Mbe(e,t,n,i,r).apply()}(e,t,n,r.extractedUrl,i).pipe(ot(s=>Object.assign(Object.assign({},r),{urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),cr(d=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:d.urlAfterRedirects})}),function Jbe(e,t,n,i,r){return Qn(s=>function qbe(e,t,n,i,r="emptyOnly",s="legacy"){try{const o=new Gbe(e,t,n,i,r,s).recognize();return null===o?E9(new zbe):Ge(o)}catch(o){return E9(o)}}(e,t,s.urlAfterRedirects,n(s.urlAfterRedirects),i,r).pipe(ot(o=>Object.assign(Object.assign({},s),{targetSnapshot:o}))))}(this.rootComponentType,this.config,d=>this.serializeUrl(d),this.paramsInheritanceStrategy,this.relativeLinkResolution),cr(d=>{if("eager"===this.urlUpdateStrategy){if(!d.extras.skipLocationChange){const h=this.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl);this.setBrowserUrl(h,d)}this.browserUrlTree=d.urlAfterRedirects}const f=new D1e(d.id,this.serializeUrl(d.extractedUrl),this.serializeUrl(d.urlAfterRedirects),d.targetSnapshot);i.next(f)}));if(u&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:f,extractedUrl:h,source:p,restoredState:g,extras:m}=a,_=new YO(f,this.serializeUrl(h),p,g);i.next(_);const y=o9(h,this.rootComponentType).snapshot;return Ge(Object.assign(Object.assign({},a),{targetSnapshot:y,urlAfterRedirects:h,extras:Object.assign(Object.assign({},m),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=a.rawUrl,a.resolve(null),Qo}),c2(a=>{const{targetSnapshot:l,id:u,extractedUrl:c,rawUrl:d,extras:{skipLocationChange:f,replaceUrl:h}}=a;return this.hooks.beforePreactivation(l,{navigationId:u,appliedUrlTree:c,rawUrlTree:d,skipLocationChange:!!f,replaceUrl:!!h})}),cr(a=>{const l=new C1e(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.triggerEvent(l)}),ot(a=>Object.assign(Object.assign({},a),{guards:Nbe(a.targetSnapshot,a.currentSnapshot,this.rootContexts)})),function Pbe(e,t){return Qn(n=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return 0===o.length&&0===s.length?Ge(Object.assign(Object.assign({},n),{guardsResult:!0})):function Lbe(e,t,n,i){return Ti(e).pipe(Qn(r=>function Ube(e,t,n,i,r){const s=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return s&&0!==s.length?Ge(s.map(a=>{const l=Mw(a,t,r);let u;if(function mbe(e){return e&&Rc(e.canDeactivate)}(l))u=gl(l.canDeactivate(e,t,n,i));else{if(!Rc(l))throw new Error("Invalid CanDeactivate guard");u=gl(l(e,t,n,i))}return u.pipe(gg())})).pipe(x_()):Ge(!0)}(r.component,r.route,n,t,i)),gg(r=>!0!==r,!0))}(o,i,r,e).pipe(Qn(a=>a&&function fbe(e){return"boolean"==typeof e}(a)?function jbe(e,t,n,i){return Ti(t).pipe(pg(r=>v_(function $be(e,t){return null!==e&&t&&t(new A1e(e)),Ge(!0)}(r.route.parent,i),function Bbe(e,t){return null!==e&&t&&t(new T1e(e)),Ge(!0)}(r.route,i),function Hbe(e,t,n){const i=t[t.length-1],s=t.slice(0,t.length-1).reverse().map(o=>function kbe(e){const t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(o)).filter(o=>null!==o).map(o=>FH(()=>Ge(o.guards.map(l=>{const u=Mw(l,o.node,n);let c;if(function gbe(e){return e&&Rc(e.canActivateChild)}(u))c=gl(u.canActivateChild(i,e));else{if(!Rc(u))throw new Error("Invalid CanActivateChild guard");c=gl(u(i,e))}return c.pipe(gg())})).pipe(x_())));return Ge(s).pipe(x_())}(e,r.path,n),function Vbe(e,t,n){const i=t.routeConfig?t.routeConfig.canActivate:null;if(!i||0===i.length)return Ge(!0);const r=i.map(s=>FH(()=>{const o=Mw(s,t,n);let a;if(function pbe(e){return e&&Rc(e.canActivate)}(o))a=gl(o.canActivate(t,e));else{if(!Rc(o))throw new Error("Invalid CanActivate guard");a=gl(o(t,e))}return a.pipe(gg())}));return Ge(r).pipe(x_())}(e,r.route,n))),gg(r=>!0!==r,!0))}(i,s,e,t):Ge(a)),ot(a=>Object.assign(Object.assign({},n),{guardsResult:a})))})}(this.ngModule.injector,a=>this.triggerEvent(a)),cr(a=>{if(kf(a.guardsResult)){const u=KO(`Redirecting to "${this.serializeUrl(a.guardsResult)}"`);throw u.url=a.guardsResult,u}const l=new E1e(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.triggerEvent(l)}),Ii(a=>!!a.guardsResult||(this.restoreHistory(a),this.cancelNavigationTransition(a,""),!1)),c2(a=>{if(a.guards.canActivateChecks.length)return Ge(a).pipe(cr(l=>{const u=new S1e(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(u)}),Mu(l=>{let u=!1;return Ge(l).pipe(function Xbe(e,t){return Qn(n=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=n;if(!r.length)return Ge(n);let s=0;return Ti(r).pipe(pg(o=>function Qbe(e,t,n,i){return function Zbe(e,t,n,i){const r=O9(e);if(0===r.length)return Ge({});const s={};return Ti(r).pipe(Qn(o=>function ewe(e,t,n,i){const r=Mw(e,t,i);return gl(r.resolve?r.resolve(t,n):r(t,n))}(e[o],t,n,i).pipe(cr(a=>{s[o]=a}))),WO(1),Qn(()=>O9(s).length===r.length?Ge(s):Qo))}(e._resolve,e,t,i).pipe(ot(s=>(e._resolvedData=s,e.data=Object.assign(Object.assign({},e.data),a9(e,n).resolve),null)))}(o.route,i,e,t)),cr(()=>s++),WO(1),Qn(o=>s===r.length?Ge(n):Qo))})}(this.paramsInheritanceStrategy,this.ngModule.injector),cr({next:()=>u=!0,complete:()=>{u||(this.restoreHistory(l),this.cancelNavigationTransition(l,"At least one route resolver didn't emit any value."))}}))}),cr(l=>{const u=new x1e(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(u)}))}),c2(a=>{const{targetSnapshot:l,id:u,extractedUrl:c,rawUrl:d,extras:{skipLocationChange:f,replaceUrl:h}}=a;return this.hooks.afterPreactivation(l,{navigationId:u,appliedUrlTree:c,rawUrlTree:d,skipLocationChange:!!f,replaceUrl:!!h})}),ot(a=>{const l=function Z1e(e,t,n){const i=C_(e,t._root,n?n._root:void 0);return new s9(i,t)}(this.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return Object.assign(Object.assign({},a),{targetRouterState:l})}),cr(a=>{this.currentUrlTree=a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a),this.browserUrlTree=a.urlAfterRedirects)}),((e,t,n)=>ot(i=>(new cbe(t,i.targetRouterState,i.currentRouterState,n).activate(e),i)))(this.rootContexts,this.routeReuseStrategy,a=>this.triggerEvent(a)),cr({next(){s=!0},complete(){s=!0}}),function b1e(e){return Xn((t,n)=>{try{t.subscribe(n)}finally{n.add(e)}})}(()=>{var a;s||o||this.cancelNavigationTransition(r,`Navigation ID ${r.id} is not equal to the current navigation id ${this.navigationId}`),(null===(a=this.currentNavigation)||void 0===a?void 0:a.id)===r.id&&(this.currentNavigation=null)}),Ic(a=>{if(o=!0,function k1e(e){return e&&e[zH]}(a)){const l=kf(a.url);l||(this.navigated=!0,this.restoreHistory(r,!0));const u=new $H(r.id,this.serializeUrl(r.extractedUrl),a.message);i.next(u),l?setTimeout(()=>{const c=this.urlHandlingStrategy.merge(a.url,this.rawUrlTree),d={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||I9(r.source)};this.scheduleNavigation(c,"imperative",null,d,{resolve:r.resolve,reject:r.reject,promise:r.promise})},0):r.resolve(!1)}else{this.restoreHistory(r,!0);const l=new w1e(r.id,this.serializeUrl(r.extractedUrl),a);i.next(l);try{r.resolve(this.errorHandler(a))}catch(u){r.reject(u)}}return Qo}))}))}resetRootComponentType(n){this.rootComponentType=n,this.routerState.root.component=this.rootComponentType}setTransition(n){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),n))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const i="popstate"===n.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{var r;const s={replaceUrl:!0},o=(null===(r=n.state)||void 0===r?void 0:r.navigationId)?n.state:null;if(o){const l=Object.assign({},o);delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(n.url);this.scheduleNavigation(a,i,o,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(n){this.events.next(n)}resetConfig(n){m9(n),this.config=n.map(l2),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(n,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,u=r||this.routerState.root,c=l?this.currentUrlTree.fragment:o;let d=null;switch(a){case"merge":d=Object.assign(Object.assign({},this.currentUrlTree.queryParams),s);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}return null!==d&&(d=this.removeEmptyProps(d)),function nbe(e,t,n,i,r){if(0===n.length)return n2(t.root,t.root,t.root,i,r);const s=function ibe(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new d9(!0,0,e);let t=0,n=!1;const i=e.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Gi(s.outlets,(l,u)=>{a[u]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?n=!0:".."===a?t++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new d9(n,t,i)}(n);if(s.toRoot())return n2(t.root,t.root,new yt([],{}),i,r);const o=function rbe(e,t,n){if(e.isAbsolute)return new r2(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){const s=n.snapshot._urlSegment;return new r2(s,s===t.root,0)}const i=ww(e.commands[0])?0:1;return function sbe(e,t,n){let i=e,r=t,s=n;for(;s>r;){if(s-=r,i=i.parent,!i)throw new Error("Invalid number of '../'");r=i.segments.length}return new r2(i,!1,r-s)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,e.numberOfDoubleDots)}(s,t,e),a=o.processChildren?Dw(o.segmentGroup,o.index,s.commands):f9(o.segmentGroup,o.index,s.commands);return n2(t.root,o.segmentGroup,a,i,r)}(u,this.currentUrlTree,n,d,null!=c?c:null)}navigateByUrl(n,i={skipLocationChange:!1}){const r=kf(n)?n:this.parseUrl(n),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,i)}navigate(n,i={skipLocationChange:!1}){return function cwe(e){for(let t=0;t<e.length;t++){const n=e[t];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${t}`)}}(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let i;try{i=this.urlSerializer.parse(n)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,n)}return i}isActive(n,i){let r;if(r=!0===i?Object.assign({},lwe):!1===i?Object.assign({},uwe):i,kf(n))return KH(this.currentUrlTree,n,r);const s=this.parseUrl(n);return KH(this.currentUrlTree,s,r)}removeEmptyProps(n){return Object.keys(n).reduce((i,r)=>{const s=n[r];return null!=s&&(i[r]=s),i},{})}processNavigations(){this.navigations.subscribe(n=>{this.navigated=!0,this.lastSuccessfulId=n.id,this.currentPageId=n.targetPageId,this.events.next(new b_(n.id,this.serializeUrl(n.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,n.resolve(!0)},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)})}scheduleNavigation(n,i,r,s,o){var a,l;if(this.disposed)return Promise.resolve(!1);let u,c,d;o?(u=o.resolve,c=o.reject,d=o.promise):d=new Promise((p,g)=>{u=p,c=g});const f=++this.navigationId;let h;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),h=r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?null!==(a=this.browserPageId)&&void 0!==a?a:0:(null!==(l=this.browserPageId)&&void 0!==l?l:0)+1):h=0,this.setTransition({id:f,targetPageId:h,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:n,extras:s,resolve:u,reject:c,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(p=>Promise.reject(p))}setBrowserUrl(n,i){const r=this.urlSerializer.serialize(n),s=Object.assign(Object.assign({},i.extras.state),this.generateNgRouterState(i.id,i.targetPageId));this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(n,i=!1){var r,s;if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-n.targetPageId;"popstate"!==n.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(r=this.currentNavigation)||void 0===r?void 0:r.finalUrl)||0===o?this.currentUrlTree===(null===(s=this.currentNavigation)||void 0===s?void 0:s.finalUrl)&&0===o&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(o)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(n,i){const r=new $H(n.id,this.serializeUrl(n.extractedUrl),i);this.triggerEvent(r),n.resolve(!1)}generateNgRouterState(n,i){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}}return e.\u0275fac=function(n){TT()},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();function I9(e){return"imperative"!==e}let Tw=(()=>{class e{constructor(n,i,r){this.router=n,this.route=i,this.locationStrategy=r,this.commands=null,this.href=null,this.onChanges=new Pn,this.subscription=n.events.subscribe(s=>{s instanceof b_&&this.updateTargetUrlAndHref()})}set routerLink(n){this.commands=null!=n?Array.isArray(n)?n:[n]:null}ngOnChanges(n){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(n,i,r,s,o){if(0!==n||i||r||s||o||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const a={skipLocationChange:yg(this.skipLocationChange),replaceUrl:yg(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,a),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:yg(this.preserveFragment)})}}return e.\u0275fac=function(n){return new(n||e)(H(Hs),H(Nf),H(fg))},e.\u0275dir=ye({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(n,i){1&n&&Fe("click",function(s){return i.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&n&&ln("target",i.target)("href",i.href,Bp)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[xn]}),e})();function yg(e){return""===e||!!e}class R9{}class F9{preload(t,n){return Ge(null)}}let P9=(()=>{class e{constructor(n,i,r,s){this.router=n,this.injector=r,this.preloadingStrategy=s,this.loader=new N9(r,i,l=>n.triggerEvent(new VH(l)),l=>n.triggerEvent(new HH(l)))}setUpPreloading(){this.subscription=this.router.events.pipe(Ii(n=>n instanceof b_),pg(()=>this.preload())).subscribe(()=>{})}preload(){const n=this.injector.get(Su);return this.processRoutes(n,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,i){const r=[];for(const s of i)if(s.loadChildren&&!s.canLoad&&s._loadedConfig){const o=s._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else s.loadChildren&&!s.canLoad?r.push(this.preloadConfig(n,s)):s.children&&r.push(this.processRoutes(n,s.children));return Ti(r).pipe(D0(),ot(s=>{}))}preloadConfig(n,i){return this.preloadingStrategy.preload(i,()=>(i._loadedConfig?Ge(i._loadedConfig):this.loader.load(n.injector,i)).pipe(Qn(s=>(i._loadedConfig=s,this.processRoutes(s.module,s.routes)))))}}return e.\u0275fac=function(n){return new(n||e)(me(Hs),me(O7),me(ai),me(R9))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})(),h2=(()=>{class e{constructor(n,i,r={}){this.router=n,this.viewportScroller=i,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(n=>{n instanceof YO?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof b_&&(this.lastId=n.id,this.scheduleScrollEvent(n,this.router.parseUrl(n.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(n=>{n instanceof UH&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,i){this.router.triggerEvent(new UH(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return e.\u0275fac=function(n){TT()},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();const If=new it("ROUTER_CONFIGURATION"),L9=new it("ROUTER_FORROOT_GUARD"),pwe=[SO,{provide:ZH,useClass:e9},{provide:Hs,useFactory:function vwe(e,t,n,i,r,s,o={},a,l){const u=new Hs(null,e,t,n,i,r,GH(s));return a&&(u.urlHandlingStrategy=a),l&&(u.routeReuseStrategy=l),function bwe(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy),e.canceledNavigationResolution&&(t.canceledNavigationResolution=e.canceledNavigationResolution)}(o,u),o.enableTracing&&u.events.subscribe(c=>{var d,f;null===(d=console.group)||void 0===d||d.call(console,`Router Event: ${c.constructor.name}`),console.log(c.toString()),console.log(c),null===(f=console.groupEnd)||void 0===f||f.call(console)}),u},deps:[ZH,A_,SO,ai,O7,d2,If,[class rwe{},new Ec],[class twe{},new Ec]]},A_,{provide:Nf,useFactory:function wwe(e){return e.routerState.root},deps:[Hs]},P9,F9,class hwe{preload(t,n){return n().pipe(Ic(()=>Ge(null)))}},{provide:If,useValue:{enableTracing:!1}}];function gwe(){return new F7("Router",Hs)}let j9=(()=>{class e{constructor(n,i){}static forRoot(n,i){return{ngModule:e,providers:[pwe,B9(n),{provide:L9,useFactory:ywe,deps:[[Hs,new Ec,new B0]]},{provide:If,useValue:i||{}},{provide:fg,useFactory:_we,deps:[Af,[new _b(EO),new Ec],If]},{provide:h2,useFactory:mwe,deps:[Hs,Eve,If]},{provide:R9,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:F9},{provide:F7,multi:!0,useFactory:gwe},[p2,{provide:cO,multi:!0,useFactory:Dwe,deps:[p2]},{provide:$9,useFactory:Cwe,deps:[p2]},{provide:M7,multi:!0,useExisting:$9}]]}}static forChild(n){return{ngModule:e,providers:[B9(n)]}}}return e.\u0275fac=function(n){return new(n||e)(me(L9,8),me(Hs,8))},e.\u0275mod=$t({type:e}),e.\u0275inj=It({}),e})();function mwe(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new h2(e,t,n)}function _we(e,t,n={}){return n.useHash?new aye(e,t):new tH(e,t)}function ywe(e){return"guarded"}function B9(e){return[{provide:tfe,multi:!0,useValue:e},{provide:d2,multi:!0,useValue:e}]}let p2=(()=>{class e{constructor(n){this.injector=n,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Pn}appInitializer(){return this.injector.get(rye,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let i=null;const r=new Promise(a=>i=a),s=this.injector.get(Hs),o=this.injector.get(If);return"disabled"===o.initialNavigation?(s.setUpLocationChangeListener(),i(!0)):"enabled"===o.initialNavigation||"enabledBlocking"===o.initialNavigation?(s.hooks.afterPreactivation=()=>this.initNavigation?Ge(null):(this.initNavigation=!0,i(!0),this.resultOfPreactivationDone),s.initialNavigation()):i(!0),r})}bootstrapListener(n){const i=this.injector.get(If),r=this.injector.get(P9),s=this.injector.get(h2),o=this.injector.get(Hs),a=this.injector.get(h_);n===a.components[0]&&(("enabledNonBlocking"===i.initialNavigation||void 0===i.initialNavigation)&&o.initialNavigation(),r.setUpPreloading(),s.init(),o.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return e.\u0275fac=function(n){return new(n||e)(me(ai))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();function Dwe(e){return e.appInitializer.bind(e)}function Cwe(e){return e.bootstrapListener.bind(e)}const $9=new it("Router Initializer");let g2=(()=>{class e{constructor(){this.sector=new Pn,this.sector.next("all-sectors")}getSector(){return this.sector}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})(),Swe=(()=>{class e{constructor(){}ngOnInit(){}ngOnChanges(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=bn({type:e,selectors:[["introductory-section"]],inputs:{sector:"sector"},features:[xn],decls:10,vars:0,consts:[[1,"section","mt-5"],[1,"title"],[1,"subtitle","mt-4"],[1,"mt-4","mb-5"],[1,"button","orange-button"],[1,"button","transparent-button","mt-md-0","mt-3"]],template:function(n,i){1&n&&(k(0,"div",0)(1,"h1",1),B(2,"Beyond Compliance"),F(),k(3,"div",2),B(4," A review of statements produced by companies under the UK and Australian Modern Slavery Acts (MSAs). "),F(),k(5,"div",3)(6,"a",4),B(7,"Contribute Research"),F(),k(8,"a",5),B(9,"Download Dataset"),F()()())},styles:[""]}),e})();class re{constructor(t,n){this.name=t,this.value=n}}class m2{constructor(t,n){this.from=t,this.to=n}}class V9{}class H9{}class Nu{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(n=>{const i=n.indexOf(":");if(i>0){const r=n.slice(0,i),s=r.toLowerCase(),o=n.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(n=>{let i=t[n];const r=n.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(r,i),this.maybeSetNormalizedName(n,r))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const n=this.headers.get(t.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,n){return this.clone({name:t,value:n,op:"a"})}set(t,n){return this.clone({name:t,value:n,op:"s"})}delete(t,n){return this.clone({name:t,value:n,op:"d"})}maybeSetNormalizedName(t,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,t)}init(){this.lazyInit&&(this.lazyInit instanceof Nu?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(n=>{this.headers.set(n,t.headers.get(n)),this.normalizedNames.set(n,t.normalizedNames.get(n))})}clone(t){const n=new Nu;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof Nu?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}applyUpdate(t){const n=t.name.toLowerCase();switch(t.op){case"a":case"s":let i=t.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(t.name,n);const r=("a"===t.op?this.headers.get(n):void 0)||[];r.push(...i),this.headers.set(n,r);break;case"d":const s=t.value;if(s){let o=this.headers.get(n);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,o)}else this.headers.delete(n),this.normalizedNames.delete(n)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>t(this.normalizedNames.get(n),this.headers.get(n)))}}class xwe{encodeKey(t){return U9(t)}encodeValue(t){return U9(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const Mwe=/%(\d[a-f0-9])/gi,Twe={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function U9(e){return encodeURIComponent(e).replace(Mwe,(t,n)=>{var i;return null!==(i=Twe[n])&&void 0!==i?i:t})}function z9(e){return`${e}`}class ku{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new xwe,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Awe(e,t){const n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[t.decodeKey(r),""]:[t.decodeKey(r.slice(0,s)),t.decodeValue(r.slice(s+1))],l=n.get(o)||[];l.push(a),n.set(o,l)}),n}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(n=>{const i=t.fromObject[n];this.map.set(n,Array.isArray(i)?i:[i])})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const n=this.map.get(t);return n?n[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,n){return this.clone({param:t,value:n,op:"a"})}appendAll(t){const n=[];return Object.keys(t).forEach(i=>{const r=t[i];Array.isArray(r)?r.forEach(s=>{n.push({param:i,value:s,op:"a"})}):n.push({param:i,value:r,op:"a"})}),this.clone(n)}set(t,n){return this.clone({param:t,value:n,op:"s"})}delete(t,n){return this.clone({param:t,value:n,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const n=this.encoder.encodeKey(t);return this.map.get(t).map(i=>n+"="+this.encoder.encodeValue(i)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const n=new ku({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(t),n}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const n=("a"===t.op?this.map.get(t.param):void 0)||[];n.push(z9(t.value)),this.map.set(t.param,n);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let i=this.map.get(t.param)||[];const r=i.indexOf(z9(t.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(t.param,i):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class Owe{constructor(){this.map=new Map}set(t,n){return this.map.set(t,n),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function q9(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function G9(e){return"undefined"!=typeof Blob&&e instanceof Blob}function W9(e){return"undefined"!=typeof FormData&&e instanceof FormData}class N_{constructor(t,n,i,r){let s;if(this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function Nwe(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new Nu),this.context||(this.context=new Owe),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=n;else{const a=n.indexOf("?");this.urlWithParams=n+(-1===a?"?":a<n.length-1?"&":"")+o}}else this.params=new ku,this.urlWithParams=n}serializeBody(){return null===this.body?null:q9(this.body)||G9(this.body)||W9(this.body)||function kwe(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof ku?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||W9(this.body)?null:G9(this.body)?this.body.type||null:q9(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof ku?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){var n;const i=t.method||this.method,r=t.url||this.url,s=t.responseType||this.responseType,o=void 0!==t.body?t.body:this.body,a=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,l=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let u=t.headers||this.headers,c=t.params||this.params;const d=null!==(n=t.context)&&void 0!==n?n:this.context;return void 0!==t.setHeaders&&(u=Object.keys(t.setHeaders).reduce((f,h)=>f.set(h,t.setHeaders[h]),u)),t.setParams&&(c=Object.keys(t.setParams).reduce((f,h)=>f.set(h,t.setParams[h]),c)),new N_(i,r,o,{params:c,headers:u,context:d,reportProgress:l,responseType:s,withCredentials:a})}}var ci=(()=>((ci=ci||{})[ci.Sent=0]="Sent",ci[ci.UploadProgress=1]="UploadProgress",ci[ci.ResponseHeader=2]="ResponseHeader",ci[ci.DownloadProgress=3]="DownloadProgress",ci[ci.Response=4]="Response",ci[ci.User=5]="User",ci))();class _2{constructor(t,n=200,i="OK"){this.headers=t.headers||new Nu,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||i,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class y2 extends _2{constructor(t={}){super(t),this.type=ci.ResponseHeader}clone(t={}){return new y2({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Ow extends _2{constructor(t={}){super(t),this.type=ci.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new Ow({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Y9 extends _2{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function v2(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let K9=(()=>{class e{constructor(n){this.handler=n}request(n,i,r={}){let s;if(n instanceof N_)s=n;else{let l,u;l=r.headers instanceof Nu?r.headers:new Nu(r.headers),r.params&&(u=r.params instanceof ku?r.params:new ku({fromObject:r.params})),s=new N_(n,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:u,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=Ge(s).pipe(pg(l=>this.handler.handle(l)));if(n instanceof N_||"events"===r.observe)return o;const a=o.pipe(Ii(l=>l instanceof Ow));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(ot(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(ot(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(ot(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(ot(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(n,i={}){return this.request("DELETE",n,i)}get(n,i={}){return this.request("GET",n,i)}head(n,i={}){return this.request("HEAD",n,i)}jsonp(n,i){return this.request("JSONP",n,{params:(new ku).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,i={}){return this.request("OPTIONS",n,i)}patch(n,i,r={}){return this.request("PATCH",n,v2(r,i))}post(n,i,r={}){return this.request("POST",n,v2(r,i))}put(n,i,r={}){return this.request("PUT",n,v2(r,i))}}return e.\u0275fac=function(n){return new(n||e)(me(V9))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();class J9{constructor(t,n){this.next=t,this.interceptor=n}handle(t){return this.interceptor.intercept(t,this.next)}}const X9=new it("HTTP_INTERCEPTORS");let Iwe=(()=>{class e{intercept(n,i){return i.handle(n)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();const Rwe=/^\)\]\}',?\n/;let Q9=(()=>{class e{constructor(n){this.xhrFactory=n}handle(n){if("JSONP"===n.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Qt(i=>{const r=this.xhrFactory.build();if(r.open(n.method,n.urlWithParams),n.withCredentials&&(r.withCredentials=!0),n.headers.forEach((h,p)=>r.setRequestHeader(h,p.join(","))),n.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){const h=n.detectContentTypeHeader();null!==h&&r.setRequestHeader("Content-Type",h)}if(n.responseType){const h=n.responseType.toLowerCase();r.responseType="json"!==h?h:"text"}const s=n.serializeBody();let o=null;const a=()=>{if(null!==o)return o;const h=r.statusText||"OK",p=new Nu(r.getAllResponseHeaders()),g=function Fwe(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(r)||n.url;return o=new y2({headers:p,status:r.status,statusText:h,url:g}),o},l=()=>{let{headers:h,status:p,statusText:g,url:m}=a(),_=null;204!==p&&(_=void 0===r.response?r.responseText:r.response),0===p&&(p=_?200:0);let y=p>=200&&p<300;if("json"===n.responseType&&"string"==typeof _){const v=_;_=_.replace(Rwe,"");try{_=""!==_?JSON.parse(_):null}catch(b){_=v,y&&(y=!1,_={error:b,text:_})}}y?(i.next(new Ow({body:_,headers:h,status:p,statusText:g,url:m||void 0})),i.complete()):i.error(new Y9({error:_,headers:h,status:p,statusText:g,url:m||void 0}))},u=h=>{const{url:p}=a(),g=new Y9({error:h,status:r.status||0,statusText:r.statusText||"Unknown Error",url:p||void 0});i.error(g)};let c=!1;const d=h=>{c||(i.next(a()),c=!0);let p={type:ci.DownloadProgress,loaded:h.loaded};h.lengthComputable&&(p.total=h.total),"text"===n.responseType&&!!r.responseText&&(p.partialText=r.responseText),i.next(p)},f=h=>{let p={type:ci.UploadProgress,loaded:h.loaded};h.lengthComputable&&(p.total=h.total),i.next(p)};return r.addEventListener("load",l),r.addEventListener("error",u),r.addEventListener("timeout",u),r.addEventListener("abort",u),n.reportProgress&&(r.addEventListener("progress",d),null!==s&&r.upload&&r.upload.addEventListener("progress",f)),r.send(s),i.next({type:ci.Sent}),()=>{r.removeEventListener("error",u),r.removeEventListener("abort",u),r.removeEventListener("load",l),r.removeEventListener("timeout",u),n.reportProgress&&(r.removeEventListener("progress",d),null!==s&&r.upload&&r.upload.removeEventListener("progress",f)),r.readyState!==r.DONE&&r.abort()}})}}return e.\u0275fac=function(n){return new(n||e)(me(yH))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();const b2=new it("XSRF_COOKIE_NAME"),w2=new it("XSRF_HEADER_NAME");class Z9{}let Pwe=(()=>{class e{constructor(n,i,r){this.doc=n,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=dH(n,this.cookieName),this.lastCookieString=n),this.lastToken}}return e.\u0275fac=function(n){return new(n||e)(me(ti),me(f_),me(b2))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})(),D2=(()=>{class e{constructor(n,i){this.tokenService=n,this.headerName=i}intercept(n,i){const r=n.url.toLowerCase();if("GET"===n.method||"HEAD"===n.method||r.startsWith("http://")||r.startsWith("https://"))return i.handle(n);const s=this.tokenService.getToken();return null!==s&&!n.headers.has(this.headerName)&&(n=n.clone({headers:n.headers.set(this.headerName,s)})),i.handle(n)}}return e.\u0275fac=function(n){return new(n||e)(me(Z9),me(w2))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})(),Lwe=(()=>{class e{constructor(n,i){this.backend=n,this.injector=i,this.chain=null}handle(n){if(null===this.chain){const i=this.injector.get(X9,[]);this.chain=i.reduceRight((r,s)=>new J9(r,s),this.backend)}return this.chain.handle(n)}}return e.\u0275fac=function(n){return new(n||e)(me(H9),me(ai))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})(),jwe=(()=>{class e{static disable(){return{ngModule:e,providers:[{provide:D2,useClass:Iwe}]}}static withOptions(n={}){return{ngModule:e,providers:[n.cookieName?{provide:b2,useValue:n.cookieName}:[],n.headerName?{provide:w2,useValue:n.headerName}:[]]}}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({providers:[D2,{provide:X9,useExisting:D2,multi:!0},{provide:Z9,useClass:Pwe},{provide:b2,useValue:"XSRF-TOKEN"},{provide:w2,useValue:"X-XSRF-TOKEN"}]}),e})(),Bwe=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({providers:[K9,{provide:V9,useClass:Lwe},Q9,{provide:H9,useExisting:Q9}],imports:[[jwe.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e})(),ml=(()=>{class e{constructor(n){this.httpClient=n,this.wikirateApiHost="https://wikirate.org",this.metrics={msa_registry_submission:12536930,modern_slavery_statement:1827651,msa_statement_assessed:12621772,aus_msa_statement_assessed:12602630,uk_msa_statement_assessed:12602618,meet_uk_min_requirements:6901749,meet_aus_min_requirements:12601871,aus_beyond_compliance_disclosure_rate:12620676,uk_beyond_compliance_disclosure_rate:6899063,msa_beyond_compliance:12620974,msa_disclosure_rate:12602527,turnover_range:8218724}}getAnswers(n,i){let r=`${this.wikirateApiHost}/~${n}+Answer.json`,s=new ku;for(let o of i)if(Array.isArray(o.value))for(let a of o.value)s=s.append("filter["+o.name+"][]",a);else o.value instanceof m2?(s=s.append("filter["+o.name+"][from]",o.value.from),s=s.append("filter["+o.name+"][to]",o.value.to)):s=s.append("filter["+o.name+"]",o.value);return s=s.append("limit",0),s=s.append("view","answer_list"),this.httpClient.get(r,{params:s})}getCompanyGroup(n){return"garment-sector"===n?"MSA Garments":"hospitality-sector"===n?"MSA Hospitality":"financial-sector"===n?"MSA Financial":""}}return e.\u0275fac=function(n){return new(n||e)(me(K9))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();const $we=["addListener","removeListener"],Vwe=["addEventListener","removeEventListener"],Hwe=["on","off"];function Pr(e,t,n,i){if(Xe(n)&&(i=n,n=void 0),i)return Pr(e,t,n).pipe(qO(i));const[r,s]=function qwe(e){return Xe(e.addEventListener)&&Xe(e.removeEventListener)}(e)?Vwe.map(o=>a=>e[o](t,a,n)):function Uwe(e){return Xe(e.addListener)&&Xe(e.removeListener)}(e)?$we.map(eU(e,t)):function zwe(e){return Xe(e.on)&&Xe(e.off)}(e)?Hwe.map(eU(e,t)):[];if(!r&&$A(e))return Qn(o=>Pr(o,t,n))(nr(e));if(!r)throw new TypeError("Invalid event target");return new Qt(o=>{const a=(...l)=>o.next(1<l.length?l:l[0]);return r(a),()=>s(a)})}function eU(e,t){return n=>i=>e[n](t,i)}class Gwe extends Jn{constructor(t,n){super()}schedule(t,n=0){return this}}const Nw={setInterval(e,t,...n){const{delegate:i}=Nw;return(null==i?void 0:i.setInterval)?i.setInterval(e,t,...n):setInterval(e,t,...n)},clearInterval(e){const{delegate:t}=Nw;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},tU={now:()=>(tU.delegate||Date).now(),delegate:void 0};class k_{constructor(t,n=k_.now){this.schedulerActionCtor=t,this.now=n}schedule(t,n=0,i){return new this.schedulerActionCtor(this,t).schedule(i,n)}}k_.now=tU.now;const nU=new class Ywe extends k_{constructor(t,n=k_.now){super(t,n),this.actions=[],this._active=!1,this._scheduled=void 0}flush(t){const{actions:n}=this;if(this._active)return void n.push(t);let i;this._active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=n.shift());if(this._active=!1,i){for(;t=n.shift();)t.unsubscribe();throw i}}}(class Wwe extends Gwe{constructor(t,n){super(t,n),this.scheduler=t,this.work=n,this.pending=!1}schedule(t,n=0){if(this.closed)return this;this.state=t;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,n)),this.pending=!0,this.delay=n,this.id=this.id||this.requestAsyncId(r,this.id,n),this}requestAsyncId(t,n,i=0){return Nw.setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,n,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return n;Nw.clearInterval(n)}execute(t,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,n);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,n){let r,i=!1;try{this.work(t)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:t,scheduler:n}=this,{actions:i}=n;this.work=this.state=this.scheduler=null,this.pending=!1,kt(i,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,super.unsubscribe()}}}),Kwe=nU;function C2(e=0,t,n=Kwe){let i=-1;return null!=t&&(y4(t)?n=t:i=t),new Qt(r=>{let s=function Jwe(e){return e instanceof Date&&!isNaN(e)}(e)?+e-n.now():e;s<0&&(s=0);let o=0;return n.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}const{isArray:Xwe}=Array;function iU(e){return 1===e.length&&Xwe(e[0])?e[0]:e}function rU(...e){return 1===(e=iU(e)).length?nr(e[0]):new Qt(function Qwe(e){return t=>{let n=[];for(let i=0;n&&!t.closed&&i<e.length;i++)n.push(nr(e[i]).subscribe(yn(t,r=>{if(n){for(let s=0;s<n.length;s++)s!==i&&n[s].unsubscribe();n=null}t.next(r)})))}}(e))}function kw(...e){const t=q1(e),n=iU(e);return n.length?new Qt(i=>{let r=n.map(()=>[]),s=n.map(()=>!1);i.add(()=>{r=s=null});for(let o=0;!i.closed&&o<n.length;o++)nr(n[o]).subscribe(yn(i,a=>{if(r[o].push(a),r.every(l=>l.length)){const l=r.map(u=>u.shift());i.next(t?t(...l):l),r.some((u,c)=>!u.length&&s[c])&&i.complete()}},()=>{s[o]=!0,!r[o].length&&i.complete()}));return()=>{r=s=null}}):Qo}function bi(e){return Xn((t,n)=>{nr(e).subscribe(yn(n,()=>n.complete(),hu)),!n.closed&&t.subscribe(n)})}function S2(...e){const t=q1(e);return Xn((n,i)=>{const r=e.length,s=new Array(r);let o=e.map(()=>!1),a=!1;for(let l=0;l<r;l++)nr(e[l]).subscribe(yn(i,u=>{s[l]=u,!a&&!o[l]&&(o[l]=!0,(a=o.every(mu))&&(o=null))},hu));n.subscribe(yn(i,l=>{if(a){const u=[l,...s];i.next(t?t(...u):u)}}))})}function oU(e,t){return t?n=>v_(t.pipe(gi(1),function tDe(){return Xn((e,t)=>{e.subscribe(yn(t,hu))})}()),n.pipe(oU(e))):Qn((n,i)=>e(n,i).pipe(gi(1),function nDe(e){return ot(()=>e)}(n)))}function aU(e,t=nU){const n=C2(e,t);return oU(()=>n)}new Qt(hu);let lU=(()=>{class e{constructor(n,i){this._renderer=n,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(n,i){this._renderer.setProperty(this._elementRef.nativeElement,n,i)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}}return e.\u0275fac=function(n){return new(n||e)(H($s),H(cn))},e.\u0275dir=ye({type:e}),e})(),Rf=(()=>{class e extends lU{}return e.\u0275fac=function(){let t;return function(i){return(t||(t=ar(e)))(i||e)}}(),e.\u0275dir=ye({type:e,features:[Ht]}),e})();const Mo=new it("NgValueAccessor"),oDe={provide:Mo,useExisting:Ot(()=>x2),multi:!0},lDe=new it("CompositionEventMode");let x2=(()=>{class e extends lU{constructor(n,i,r){super(n,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function aDe(){const e=fl()?fl().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(n){this.setProperty("value",null==n?"":n)}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}}return e.\u0275fac=function(n){return new(n||e)(H($s),H(cn),H(lDe,8))},e.\u0275dir=ye({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,i){1&n&&Fe("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[un([oDe]),Ht]}),e})();const dr=new it("NgValidators"),Pc=new it("NgAsyncValidators");function vU(e){return null!=e}function bU(e){const t=Z0(e)?Ti(e):e;return IT(t),t}function wU(e){let t={};return e.forEach(n=>{t=null!=n?Object.assign(Object.assign({},t),n):t}),0===Object.keys(t).length?null:t}function DU(e,t){return t.map(n=>n(e))}function CU(e){return e.map(t=>function cDe(e){return!e.validate}(t)?t:n=>t.validate(n))}function A2(e){return null!=e?function EU(e){if(!e)return null;const t=e.filter(vU);return 0==t.length?null:function(n){return wU(DU(n,t))}}(CU(e)):null}function M2(e){return null!=e?function SU(e){if(!e)return null;const t=e.filter(vU);return 0==t.length?null:function(n){return function rDe(...e){const t=q1(e),{args:n,keys:i}=kH(e),r=new Qt(s=>{const{length:o}=n;if(!o)return void s.complete();const a=new Array(o);let l=o,u=o;for(let c=0;c<o;c++){let d=!1;nr(n[c]).subscribe(yn(s,f=>{d||(d=!0,u--),a[c]=f},()=>l--,void 0,()=>{(!l||!d)&&(u||s.next(i?IH(i,a):a),s.complete())}))}});return t?r.pipe(qO(t)):r}(DU(n,t).map(bU)).pipe(ot(wU))}}(CU(e)):null}function xU(e,t){return null===e?[t]:Array.isArray(e)?[...e,t]:[e,t]}function T2(e){return e?Array.isArray(e)?e:[e]:[]}function Rw(e,t){return Array.isArray(e)?e.includes(t):e===t}function TU(e,t){const n=T2(t);return T2(e).forEach(r=>{Rw(n,r)||n.push(r)}),n}function OU(e,t){return T2(t).filter(n=>!Rw(e,n))}class NU{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=A2(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=M2(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,n){return!!this.control&&this.control.hasError(t,n)}getError(t,n){return this.control?this.control.getError(t,n):null}}class Lc extends NU{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Lr extends NU{get formDirective(){return null}get path(){return null}}let Ff=(()=>{class e extends class kU{constructor(t){this._cd=t}is(t){var n,i,r;return"submitted"===t?!!(null===(n=this._cd)||void 0===n?void 0:n.submitted):!!(null===(r=null===(i=this._cd)||void 0===i?void 0:i.control)||void 0===r?void 0:r[t])}}{constructor(n){super(n)}}return e.\u0275fac=function(n){return new(n||e)(H(Lc,2))},e.\u0275dir=ye({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,i){2&n&&An("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))},features:[Ht]}),e})();function I_(e,t){(function k2(e,t){const n=function AU(e){return e._rawValidators}(e);null!==t.validator?e.setValidators(xU(n,t.validator)):"function"==typeof n&&e.setValidators([n]);const i=function MU(e){return e._rawAsyncValidators}(e);null!==t.asyncValidator?e.setAsyncValidators(xU(i,t.asyncValidator)):"function"==typeof i&&e.setAsyncValidators([i]);const r=()=>e.updateValueAndValidity();jw(t._rawValidators,r),jw(t._rawAsyncValidators,r)})(e,t),t.valueAccessor.writeValue(e.value),function vDe(e,t){t.valueAccessor.registerOnChange(n=>{e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&RU(e,t)})}(e,t),function wDe(e,t){const n=(i,r)=>{t.valueAccessor.writeValue(i),r&&t.viewToModelUpdate(i)};e.registerOnChange(n),t._registerOnDestroy(()=>{e._unregisterOnChange(n)})}(e,t),function bDe(e,t){t.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&RU(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function yDe(e,t){if(t.valueAccessor.setDisabledState){const n=i=>{t.valueAccessor.setDisabledState(i)};e.registerOnDisabledChange(n),t._registerOnDestroy(()=>{e._unregisterOnDisabledChange(n)})}}(e,t)}function jw(e,t){e.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(t)})}function RU(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function F2(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const R_="VALID",$w="INVALID",vg="PENDING",F_="DISABLED";function L2(e){return(Vw(e)?e.validators:e)||null}function jU(e){return Array.isArray(e)?A2(e):e||null}function j2(e,t){return(Vw(t)?t.asyncValidators:e)||null}function BU(e){return Array.isArray(e)?M2(e):e||null}function Vw(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}const B2=e=>e instanceof V2;function VU(e){return(e=>e instanceof zU)(e)?e.value:e.getRawValue()}function HU(e,t){const n=B2(e),i=e.controls;if(!(n?Object.keys(i):i).length)throw new xe(1e3,"");if(!i[t])throw new xe(1001,"")}function UU(e,t){B2(e),e._forEachChild((i,r)=>{if(void 0===t[r])throw new xe(1002,"")})}class $2{constructor(t,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=n,this._composedValidatorFn=jU(this._rawValidators),this._composedAsyncValidatorFn=BU(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===R_}get invalid(){return this.status===$w}get pending(){return this.status==vg}get disabled(){return this.status===F_}get enabled(){return this.status!==F_}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=jU(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=BU(t)}addValidators(t){this.setValidators(TU(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(TU(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(OU(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(OU(t,this._rawAsyncValidators))}hasValidator(t){return Rw(this._rawValidators,t)}hasAsyncValidator(t){return Rw(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=vg,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const n=this._parentMarkedDirty(t.onlySelf);this.status=F_,this.errors=null,this._forEachChild(i=>{i.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:n})),this._onDisabledChange.forEach(i=>i(!0))}enable(t={}){const n=this._parentMarkedDirty(t.onlySelf);this.status=R_,this._forEachChild(i=>{i.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:n})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===R_||this.status===vg)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?F_:R_}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=vg,this._hasOwnPendingAsyncValidator=!0;const n=bU(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,n={}){this.errors=t,this._updateControlsErrors(!1!==n.emitEvent)}get(t){return function SDe(e,t,n){if(null==t||(Array.isArray(t)||(t=t.split(n)),Array.isArray(t)&&0===t.length))return null;let i=e;return t.forEach(r=>{i=B2(i)?i.controls.hasOwnProperty(r)?i.controls[r]:null:(e=>e instanceof ADe)(i)&&i.at(r)||null}),i}(this,t,".")}getError(t,n){const i=n?this.get(n):this;return i&&i.errors?i.errors[t]:null}hasError(t,n){return!!this.getError(t,n)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new tt,this.statusChanges=new tt}_calculateStatus(){return this._allControlsDisabled()?F_:this.errors?$w:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(vg)?vg:this._anyControlsHaveStatus($w)?$w:R_}_anyControlsHaveStatus(t){return this._anyControls(n=>n.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Vw(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class zU extends $2{constructor(t=null,n,i){super(L2(n),j2(i,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Vw(n)&&n.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(t)?t.value:t)}setValue(t,n={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==n.emitViewToModelChange)),this.updateValueAndValidity(n)}patchValue(t,n={}){this.setValue(t,n)}reset(t=this.defaultValue,n={}){this._applyFormState(t),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){F2(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){F2(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class V2 extends $2{constructor(t,n,i){super(L2(n),j2(i,n)),this.controls=t,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,n){return this.controls[t]?this.controls[t]:(this.controls[t]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(t,n,i={}){this.registerControl(t,n),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(t,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(t,n,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],n&&this.registerControl(t,n),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,n={}){UU(this,t),Object.keys(t).forEach(i=>{HU(this,i),this.controls[i].setValue(t[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(t,n={}){null!=t&&(Object.keys(t).forEach(i=>{this.controls[i]&&this.controls[i].patchValue(t[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(t={},n={}){this._forEachChild((i,r)=>{i.reset(t[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(t,n,i)=>(t[i]=VU(n),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(n,i)=>!!i._syncPendingControls()||n);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(n=>{const i=this.controls[n];i&&t(i,n)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const n of Object.keys(this.controls)){const i=this.controls[n];if(this.contains(n)&&t(i))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,n,i)=>((n.enabled||this.disabled)&&(t[i]=n.value),t))}_reduceChildren(t,n){let i=t;return this._forEachChild((r,s)=>{i=n(i,r,s)}),i}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class ADe extends $2{constructor(t,n,i){super(L2(n),j2(i,n)),this.controls=t,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[t]}push(t,n={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}insert(t,n,i={}){this.controls.splice(t,0,n),this._registerControl(n),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(t,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity({emitEvent:n.emitEvent})}setControl(t,n,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),n&&(this.controls.splice(t,0,n),this._registerControl(n)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,n={}){UU(this,t),t.forEach((i,r)=>{HU(this,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(t,n={}){null!=t&&(t.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(t=[],n={}){this._forEachChild((i,r)=>{i.reset(t[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this.controls.map(t=>VU(t))}clear(t={}){this.controls.length<1||(this._forEachChild(n=>n._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_syncPendingControls(){let t=this.controls.reduce((n,i)=>!!i._syncPendingControls()||n,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((n,i)=>{t(n,i)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(n=>n.enabled&&t(n))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const ODe={provide:Lc,useExisting:Ot(()=>jc)},WU=(()=>Promise.resolve(null))();let jc=(()=>{class e extends Lc{constructor(n,i,r,s,o){super(),this._changeDetectorRef=o,this.control=new zU,this._registered=!1,this.update=new tt,this._parent=n,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function R2(e,t){if(!t)return null;let n,i,r;return Array.isArray(t),t.forEach(s=>{s.constructor===x2?n=s:function EDe(e){return Object.getPrototypeOf(e.constructor)===Rf}(s)?i=s:r=s}),r||i||n||null}(0,s)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){const i=n.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),function I2(e,t){if(!e.hasOwnProperty("model"))return!1;const n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){I_(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(n){WU.then(()=>{var i;this.control.setValue(n,{emitViewToModelChange:!1}),null===(i=this._changeDetectorRef)||void 0===i||i.markForCheck()})}_updateDisabled(n){const i=n.isDisabled.currentValue,r=""===i||i&&"false"!==i;WU.then(()=>{var s;r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),null===(s=this._changeDetectorRef)||void 0===s||s.markForCheck()})}_getPath(n){return this._parent?function Pw(e,t){return[...t.path,e]}(n,this._parent):[n]}}return e.\u0275fac=function(n){return new(n||e)(H(Lr,9),H(dr,10),H(Pc,10),H(Mo,10),H(Eo,8))},e.\u0275dir=ye({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[un([ODe]),Ht,xn]}),e})(),KU=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({}),e})();const VDe={provide:Mo,useExisting:Ot(()=>Iu),multi:!0};function nz(e,t){return null==e?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let Iu=(()=>{class e extends Rf{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){this.value=n;const r=nz(this._getOptionId(n),n);this.setProperty("value",r)}registerOnChange(n){this.onChange=i=>{this.value=this._getOptionValue(i),n(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(n){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i),n))return i;return null}_getOptionValue(n){const i=function HDe(e){return e.split(":")[0]}(n);return this._optionMap.has(i)?this._optionMap.get(i):n}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=ar(e)))(i||e)}}(),e.\u0275dir=ye({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,i){1&n&&Fe("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[un([VDe]),Ht]}),e})(),Pf=(()=>{class e{constructor(n,i,r){this._element=n,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(n){null!=this._select&&(this._select._optionMap.set(this.id,n),this._setElementValue(nz(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._setElementValue(n),this._select&&this._select.writeValue(this._select.value)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return e.\u0275fac=function(n){return new(n||e)(H(cn),H($s),H(Iu,9))},e.\u0275dir=ye({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();const UDe={provide:Mo,useExisting:Ot(()=>G2),multi:!0};function iz(e,t){return null==e?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let G2=(()=>{class e extends Rf{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){let i;if(this.value=n,Array.isArray(n)){const r=n.map(s=>this._getOptionId(s));i=(s,o)=>{s._setSelected(r.indexOf(o.toString())>-1)}}else i=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(n){this.onChange=i=>{const r=[],s=i.selectedOptions;if(void 0!==s){const o=s;for(let a=0;a<o.length;a++){const u=this._getOptionValue(o[a].value);r.push(u)}}else{const o=i.options;for(let a=0;a<o.length;a++){const l=o[a];if(l.selected){const u=this._getOptionValue(l.value);r.push(u)}}}this.value=r,n(r)}}_registerOption(n){const i=(this._idCounter++).toString();return this._optionMap.set(i,n),i}_getOptionId(n){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i)._value,n))return i;return null}_getOptionValue(n){const i=function zDe(e){return e.split(":")[0]}(n);return this._optionMap.has(i)?this._optionMap.get(i)._value:n}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=ar(e)))(i||e)}}(),e.\u0275dir=ye({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,i){1&n&&Fe("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[un([UDe]),Ht]}),e})(),Lf=(()=>{class e{constructor(n,i,r){this._element=n,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(n){null!=this._select&&(this._value=n,this._setElementValue(iz(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._select?(this._value=n,this._setElementValue(iz(this.id,n)),this._select.writeValue(this._select.value)):this._setElementValue(n)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}_setSelected(n){this._renderer.setProperty(this._element.nativeElement,"selected",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return e.\u0275fac=function(n){return new(n||e)(H(cn),H($s),H(G2,9))},e.\u0275dir=ye({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})(),eCe=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({imports:[[KU]]}),e})(),hz=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({imports:[eCe]}),e})();var tCe={left:"right",right:"left",bottom:"top",top:"bottom"};function Hw(e){return e.replace(/left|right|bottom|top/g,function(t){return tCe[t]})}function _l(e){return e.split("-")[0]}var nCe={start:"end",end:"start"};function pz(e){return e.replace(/start|end/g,function(t){return nCe[t]})}var Us="top",ga="bottom",ma="right",zs="left",Y2="auto",L_=[Us,ga,ma,zs],bg="start",j_="end",gz="viewport",B_="popper",mz=L_.reduce(function(e,t){return e.concat([t+"-"+bg,t+"-"+j_])},[]),_z=[].concat(L_,[Y2]).reduce(function(e,t){return e.concat([t,t+"-"+bg,t+"-"+j_])},[]),pCe=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function _a(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function wg(e){return e instanceof _a(e).Element||e instanceof Element}function To(e){return e instanceof _a(e).HTMLElement||e instanceof HTMLElement}function K2(e){return"undefined"!=typeof ShadowRoot&&(e instanceof _a(e).ShadowRoot||e instanceof ShadowRoot)}function Bc(e){return((wg(e)?e.ownerDocument:e.document)||window.document).documentElement}var Bf=Math.max,Uw=Math.min,Dg=Math.round;function Cg(e,t){void 0===t&&(t=!1);var n=e.getBoundingClientRect(),i=1,r=1;if(To(e)&&t){var s=e.offsetHeight,o=e.offsetWidth;o>0&&(i=Dg(n.width)/o||1),s>0&&(r=Dg(n.height)/s||1)}return{width:n.width/i,height:n.height/r,top:n.top/r,right:n.right/i,bottom:n.bottom/r,left:n.left/i,x:n.left/i,y:n.top/r}}function J2(e){var t=_a(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function X2(e){return Cg(Bc(e)).left+J2(e).scrollLeft}function Ru(e){return _a(e).getComputedStyle(e)}function yl(e){return e?(e.nodeName||"").toLowerCase():null}function zw(e){return"html"===yl(e)?e:e.assignedSlot||e.parentNode||(K2(e)?e.host:null)||Bc(e)}function Q2(e){var t=Ru(e);return/auto|scroll|overlay|hidden/.test(t.overflow+t.overflowY+t.overflowX)}function yz(e){return["html","body","#document"].indexOf(yl(e))>=0?e.ownerDocument.body:To(e)&&Q2(e)?e:yz(zw(e))}function $_(e,t){var n;void 0===t&&(t=[]);var i=yz(e),r=i===(null==(n=e.ownerDocument)?void 0:n.body),s=_a(i),o=r?[s].concat(s.visualViewport||[],Q2(i)?i:[]):i,a=t.concat(o);return r?a:a.concat($_(zw(o)))}function _Ce(e){return["table","td","th"].indexOf(yl(e))>=0}function vz(e){return To(e)&&"fixed"!==Ru(e).position?e.offsetParent:null}function V_(e){for(var t=_a(e),n=vz(e);n&&_Ce(n)&&"static"===Ru(n).position;)n=vz(n);return n&&("html"===yl(n)||"body"===yl(n)&&"static"===Ru(n).position)?t:n||function yCe(e){var t=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&To(e)&&"fixed"===Ru(e).position)return null;var r=zw(e);for(K2(r)&&(r=r.host);To(r)&&["html","body"].indexOf(yl(r))<0;){var s=Ru(r);if("none"!==s.transform||"none"!==s.perspective||"paint"===s.contain||-1!==["transform","perspective"].indexOf(s.willChange)||t&&"filter"===s.willChange||t&&s.filter&&"none"!==s.filter)return r;r=r.parentNode}return null}(e)||t}function bz(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&K2(n)){var i=t;do{if(i&&e.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function Z2(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function wz(e,t){return t===gz?Z2(function gCe(e){var t=_a(e),n=Bc(e),i=t.visualViewport,r=n.clientWidth,s=n.clientHeight,o=0,a=0;return i&&(r=i.width,s=i.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(o=i.offsetLeft,a=i.offsetTop)),{width:r,height:s,x:o+X2(e),y:a}}(e)):wg(t)?function vCe(e){var t=Cg(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}(t):Z2(function mCe(e){var t,n=Bc(e),i=J2(e),r=null==(t=e.ownerDocument)?void 0:t.body,s=Bf(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=Bf(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-i.scrollLeft+X2(e),l=-i.scrollTop;return"rtl"===Ru(r||n).direction&&(a+=Bf(n.clientWidth,r?r.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}(Bc(e)))}function Eg(e){return e.split("-")[1]}function eN(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Dz(e){var l,t=e.reference,n=e.element,i=e.placement,r=i?_l(i):null,s=i?Eg(i):null,o=t.x+t.width/2-n.width/2,a=t.y+t.height/2-n.height/2;switch(r){case Us:l={x:o,y:t.y-n.height};break;case ga:l={x:o,y:t.y+t.height};break;case ma:l={x:t.x+t.width,y:a};break;case zs:l={x:t.x-n.width,y:a};break;default:l={x:t.x,y:t.y}}var u=r?eN(r):null;if(null!=u){var c="y"===u?"height":"width";switch(s){case bg:l[u]=l[u]-(t[c]/2-n[c]/2);break;case j_:l[u]=l[u]+(t[c]/2-n[c]/2)}}return l}function Ez(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function Sz(e,t){return t.reduce(function(n,i){return n[i]=e,n},{})}function tN(e,t){void 0===t&&(t={});var i=t.placement,r=void 0===i?e.placement:i,s=t.boundary,o=void 0===s?"clippingParents":s,a=t.rootBoundary,l=void 0===a?gz:a,u=t.elementContext,c=void 0===u?B_:u,d=t.altBoundary,f=void 0!==d&&d,h=t.padding,p=void 0===h?0:h,g=Ez("number"!=typeof p?p:Sz(p,L_)),_=e.rects.popper,y=e.elements[f?c===B_?"reference":B_:c],v=function wCe(e,t,n){var i="clippingParents"===t?function bCe(e){var t=$_(zw(e)),i=["absolute","fixed"].indexOf(Ru(e).position)>=0&&To(e)?V_(e):e;return wg(i)?t.filter(function(r){return wg(r)&&bz(r,i)&&"body"!==yl(r)}):[]}(e):[].concat(t),r=[].concat(i,[n]),o=r.reduce(function(a,l){var u=wz(e,l);return a.top=Bf(u.top,a.top),a.right=Uw(u.right,a.right),a.bottom=Uw(u.bottom,a.bottom),a.left=Bf(u.left,a.left),a},wz(e,r[0]));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}(wg(y)?y:y.contextElement||Bc(e.elements.popper),o,l),b=Cg(e.elements.reference),D=Dz({reference:b,element:_,strategy:"absolute",placement:r}),C=Z2(Object.assign({},_,D)),w=c===B_?C:b,E={top:v.top-w.top+g.top,bottom:w.bottom-v.bottom+g.bottom,left:v.left-w.left+g.left,right:w.right-v.right+g.right},T=e.modifiersData.offset;if(c===B_&&T){var O=T[r];Object.keys(E).forEach(function(N){var P=[ma,ga].indexOf(N)>=0?1:-1,j=[Us,ga].indexOf(N)>=0?"y":"x";E[N]+=O[j]*P})}return E}const SCe={name:"flip",enabled:!0,phase:"main",fn:function ECe(e){var t=e.state,n=e.options,i=e.name;if(!t.modifiersData[i]._skip){for(var r=n.mainAxis,s=void 0===r||r,o=n.altAxis,a=void 0===o||o,l=n.fallbackPlacements,u=n.padding,c=n.boundary,d=n.rootBoundary,f=n.altBoundary,h=n.flipVariations,p=void 0===h||h,g=n.allowedAutoPlacements,m=t.options.placement,_=_l(m),v=l||(_!==m&&p?function CCe(e){if(_l(e)===Y2)return[];var t=Hw(e);return[pz(e),t,pz(t)]}(m):[Hw(m)]),b=[m].concat(v).reduce(function($,Y){return $.concat(_l(Y)===Y2?function DCe(e,t){void 0===t&&(t={});var r=t.boundary,s=t.rootBoundary,o=t.padding,a=t.flipVariations,l=t.allowedAutoPlacements,u=void 0===l?_z:l,c=Eg(t.placement),d=c?a?mz:mz.filter(function(p){return Eg(p)===c}):L_,f=d.filter(function(p){return u.indexOf(p)>=0});0===f.length&&(f=d);var h=f.reduce(function(p,g){return p[g]=tN(e,{placement:g,boundary:r,rootBoundary:s,padding:o})[_l(g)],p},{});return Object.keys(h).sort(function(p,g){return h[p]-h[g]})}(t,{placement:Y,boundary:c,rootBoundary:d,padding:u,flipVariations:p,allowedAutoPlacements:g}):Y)},[]),D=t.rects.reference,C=t.rects.popper,w=new Map,E=!0,T=b[0],O=0;O<b.length;O++){var N=b[O],P=_l(N),j=Eg(N)===bg,A=[Us,ga].indexOf(P)>=0,x=A?"width":"height",S=tN(t,{placement:N,boundary:c,rootBoundary:d,altBoundary:f,padding:u}),I=A?j?ma:zs:j?ga:Us;D[x]>C[x]&&(I=Hw(I));var M=Hw(I),L=[];if(s&&L.push(S[P]<=0),a&&L.push(S[I]<=0,S[M]<=0),L.every(function($){return $})){T=N,E=!1;break}w.set(N,L)}if(E)for(var V=function(Y){var ie=b.find(function(K){var le=w.get(K);if(le)return le.slice(0,Y).every(function(G){return G})});if(ie)return T=ie,"break"},U=p?3:1;U>0&&"break"!==V(U);U--);t.placement!==T&&(t.modifiersData[i]._skip=!0,t.placement=T,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function H_(e,t,n){return Bf(e,Uw(t,n))}function nN(e){var t=Cg(e),n=e.offsetWidth,i=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:i}}const TCe={name:"preventOverflow",enabled:!0,phase:"main",fn:function MCe(e){var t=e.state,n=e.options,i=e.name,r=n.mainAxis,s=void 0===r||r,o=n.altAxis,a=void 0!==o&&o,f=n.tether,h=void 0===f||f,p=n.tetherOffset,g=void 0===p?0:p,m=tN(t,{boundary:n.boundary,rootBoundary:n.rootBoundary,padding:n.padding,altBoundary:n.altBoundary}),_=_l(t.placement),y=Eg(t.placement),v=!y,b=eN(_),D=function xCe(e){return"x"===e?"y":"x"}(b),C=t.modifiersData.popperOffsets,w=t.rects.reference,E=t.rects.popper,T="function"==typeof g?g(Object.assign({},t.rects,{placement:t.placement})):g,O="number"==typeof T?{mainAxis:T,altAxis:T}:Object.assign({mainAxis:0,altAxis:0},T),N=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,P={x:0,y:0};if(C){if(s){var j,A="y"===b?Us:zs,x="y"===b?ga:ma,S="y"===b?"height":"width",I=C[b],M=I+m[A],L=I-m[x],R=h?-E[S]/2:0,V=y===bg?w[S]:E[S],U=y===bg?-E[S]:-w[S],z=t.elements.arrow,$=h&&z?nN(z):{width:0,height:0},Y=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},ie=Y[A],K=Y[x],le=H_(0,w[S],$[S]),G=v?w[S]/2-R-le-ie-O.mainAxis:V-le-ie-O.mainAxis,Q=v?-w[S]/2+R+le+K+O.mainAxis:U+le+K+O.mainAxis,te=t.elements.arrow&&V_(t.elements.arrow),he=null!=(j=null==N?void 0:N[b])?j:0,Ne=I+Q-he,Ce=H_(h?Uw(M,I+G-he-(te?"y"===b?te.clientTop||0:te.clientLeft||0:0)):M,I,h?Bf(L,Ne):L);C[b]=Ce,P[b]=Ce-I}if(a){var Te,et=C[D],Ve="y"===D?"height":"width",se=et+m["x"===b?Us:zs],jt=et-m["x"===b?ga:ma],Mi=-1!==[Us,zs].indexOf(_),ho=null!=(Te=null==N?void 0:N[D])?Te:0,Za=Mi?se:et-w[Ve]-E[Ve]-ho+O.altAxis,_c=Mi?et+w[Ve]+E[Ve]-ho-O.altAxis:jt,Ts=h&&Mi?function ACe(e,t,n){var i=H_(e,t,n);return i>n?n:i}(Za,et,_c):H_(h?Za:se,et,h?_c:jt);C[D]=Ts,P[D]=Ts-et}t.modifiersData[i]=P}},requiresIfExists:["offset"]},ICe={name:"arrow",enabled:!0,phase:"main",fn:function NCe(e){var t,n=e.state,i=e.name,r=e.options,s=n.elements.arrow,o=n.modifiersData.popperOffsets,a=_l(n.placement),l=eN(a),c=[zs,ma].indexOf(a)>=0?"height":"width";if(s&&o){var d=function(t,n){return Ez("number"!=typeof(t="function"==typeof t?t(Object.assign({},n.rects,{placement:n.placement})):t)?t:Sz(t,L_))}(r.padding,n),f=nN(s),h="y"===l?Us:zs,p="y"===l?ga:ma,g=n.rects.reference[c]+n.rects.reference[l]-o[l]-n.rects.popper[c],m=o[l]-n.rects.reference[l],_=V_(s),y=_?"y"===l?_.clientHeight||0:_.clientWidth||0:0,C=y/2-f[c]/2+(g/2-m/2),w=H_(d[h],C,y-f[c]-d[p]);n.modifiersData[i]=((t={})[l]=w,t.centerOffset=w-C,t)}},effect:function kCe(e){var t=e.state,i=e.options.element,r=void 0===i?"[data-popper-arrow]":i;null!=r&&("string"==typeof r&&!(r=t.elements.popper.querySelector(r))||!bz(t.elements.popper,r)||(t.elements.arrow=r))},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function LCe(e,t,n){void 0===n&&(n=!1);var i=To(t),r=To(t)&&function PCe(e){var t=e.getBoundingClientRect(),n=Dg(t.width)/e.offsetWidth||1,i=Dg(t.height)/e.offsetHeight||1;return 1!==n||1!==i}(t),s=Bc(t),o=Cg(e,r),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(i||!i&&!n)&&(("body"!==yl(t)||Q2(s))&&(a=function FCe(e){return e!==_a(e)&&To(e)?function RCe(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}(e):J2(e)}(t)),To(t)?((l=Cg(t,!0)).x+=t.clientLeft,l.y+=t.clientTop):s&&(l.x=X2(s))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function jCe(e){var t=new Map,n=new Set,i=[];function r(s){n.add(s.name),[].concat(s.requires||[],s.requiresIfExists||[]).forEach(function(a){if(!n.has(a)){var l=t.get(a);l&&r(l)}}),i.push(s)}return e.forEach(function(s){t.set(s.name,s)}),e.forEach(function(s){n.has(s.name)||r(s)}),i}function $Ce(e){var t;return function(){return t||(t=new Promise(function(n){Promise.resolve().then(function(){t=void 0,n(e())})})),t}}var xz={placement:"bottom",modifiers:[],strategy:"absolute"};function Az(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(i){return!(i&&"function"==typeof i.getBoundingClientRect)})}function HCe(e){void 0===e&&(e={});var n=e.defaultModifiers,i=void 0===n?[]:n,r=e.defaultOptions,s=void 0===r?xz:r;return function(a,l,u){void 0===u&&(u=s);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},xz,s),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},d=[],f=!1,h={state:c,setOptions:function(_){var y="function"==typeof _?_(c.options):_;g(),c.options=Object.assign({},s,c.options,y),c.scrollParents={reference:wg(a)?$_(a):a.contextElement?$_(a.contextElement):[],popper:$_(l)};var v=function BCe(e){var t=jCe(e);return pCe.reduce(function(n,i){return n.concat(t.filter(function(r){return r.phase===i}))},[])}(function VCe(e){var t=e.reduce(function(n,i){var r=n[i.name];return n[i.name]=r?Object.assign({},r,i,{options:Object.assign({},r.options,i.options),data:Object.assign({},r.data,i.data)}):i,n},{});return Object.keys(t).map(function(n){return t[n]})}([].concat(i,c.options.modifiers)));return c.orderedModifiers=v.filter(function(N){return N.enabled}),function p(){c.orderedModifiers.forEach(function(m){var y=m.options,b=m.effect;if("function"==typeof b){var D=b({state:c,name:m.name,instance:h,options:void 0===y?{}:y});d.push(D||function(){})}})}(),h.update()},forceUpdate:function(){if(!f){var _=c.elements,y=_.reference,v=_.popper;if(Az(y,v)){c.rects={reference:LCe(y,V_(v),"fixed"===c.options.strategy),popper:nN(v)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(N){return c.modifiersData[N.name]=Object.assign({},N.data)});for(var D=0;D<c.orderedModifiers.length;D++)if(!0!==c.reset){var C=c.orderedModifiers[D],w=C.fn,E=C.options;"function"==typeof w&&(c=w({state:c,options:void 0===E?{}:E,name:C.name,instance:h})||c)}else c.reset=!1,D=-1}}},update:$Ce(function(){return new Promise(function(m){h.forceUpdate(),m(c)})}),destroy:function(){g(),f=!0}};if(!Az(a,l))return h;function g(){d.forEach(function(m){return m()}),d=[]}return h.setOptions(u).then(function(m){!f&&u.onFirstUpdate&&u.onFirstUpdate(m)}),h}}var qw={passive:!0};const zCe={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function UCe(e){var t=e.state,n=e.instance,i=e.options,r=i.scroll,s=void 0===r||r,o=i.resize,a=void 0===o||o,l=_a(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&u.forEach(function(c){c.addEventListener("scroll",n.update,qw)}),a&&l.addEventListener("resize",n.update,qw),function(){s&&u.forEach(function(c){c.removeEventListener("scroll",n.update,qw)}),a&&l.removeEventListener("resize",n.update,qw)}},data:{}},GCe={name:"popperOffsets",enabled:!0,phase:"read",fn:function qCe(e){var t=e.state;t.modifiersData[e.name]=Dz({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}};var WCe={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Mz(e){var t,n=e.popper,i=e.popperRect,r=e.placement,s=e.variation,o=e.offsets,a=e.position,l=e.gpuAcceleration,u=e.adaptive,c=e.roundOffsets,d=e.isFixed,f=o.x,h=void 0===f?0:f,p=o.y,g=void 0===p?0:p,m="function"==typeof c?c({x:h,y:g}):{x:h,y:g};h=m.x,g=m.y;var _=o.hasOwnProperty("x"),y=o.hasOwnProperty("y"),v=zs,b=Us,D=window;if(u){var C=V_(n),w="clientHeight",E="clientWidth";C===_a(n)&&"static"!==Ru(C=Bc(n)).position&&"absolute"===a&&(w="scrollHeight",E="scrollWidth"),C=C,(r===Us||(r===zs||r===ma)&&s===j_)&&(b=ga,g-=(d&&C===D&&D.visualViewport?D.visualViewport.height:C[w])-i.height,g*=l?1:-1),r!==zs&&(r!==Us&&r!==ga||s!==j_)||(v=ma,h-=(d&&C===D&&D.visualViewport?D.visualViewport.width:C[E])-i.width,h*=l?1:-1)}var j,N=Object.assign({position:a},u&&WCe),P=!0===c?function YCe(e){var n=e.y,r=window.devicePixelRatio||1;return{x:Dg(e.x*r)/r||0,y:Dg(n*r)/r||0}}({x:h,y:g}):{x:h,y:g};return h=P.x,g=P.y,Object.assign({},N,l?((j={})[b]=y?"0":"",j[v]=_?"0":"",j.transform=(D.devicePixelRatio||1)<=1?"translate("+h+"px, "+g+"px)":"translate3d("+h+"px, "+g+"px, 0)",j):((t={})[b]=y?g+"px":"",t[v]=_?h+"px":"",t.transform="",t))}const JCe={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function KCe(e){var t=e.state,n=e.options,i=n.gpuAcceleration,r=void 0===i||i,s=n.adaptive,o=void 0===s||s,a=n.roundOffsets,l=void 0===a||a,c={placement:_l(t.placement),variation:Eg(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,Mz(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,Mz(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}};var ZCe=[zCe,GCe,JCe,{name:"applyStyles",enabled:!0,phase:"write",fn:function XCe(e){var t=e.state;Object.keys(t.elements).forEach(function(n){var i=t.styles[n]||{},r=t.attributes[n]||{},s=t.elements[n];!To(s)||!yl(s)||(Object.assign(s.style,i),Object.keys(r).forEach(function(o){var a=r[o];!1===a?s.removeAttribute(o):s.setAttribute(o,!0===a?"":a)}))})},effect:function QCe(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(i){var r=t.elements[i],s=t.attributes[i]||{},a=Object.keys(t.styles.hasOwnProperty(i)?t.styles[i]:n[i]).reduce(function(l,u){return l[u]="",l},{});!To(r)||!yl(r)||(Object.assign(r.style,a),Object.keys(s).forEach(function(l){r.removeAttribute(l)}))})}},requires:["computeStyles"]}],eEe=HCe({defaultModifiers:ZCe});const iEe={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function nEe(e){var t=e.state,i=e.name,r=e.options.offset,s=void 0===r?[0,0]:r,o=_z.reduce(function(c,d){return c[d]=function tEe(e,t,n){var i=_l(e),r=[zs,Us].indexOf(i)>=0?-1:1,s="function"==typeof n?n(Object.assign({},t,{placement:e})):n,o=s[0],a=s[1];return o=o||0,a=(a||0)*r,[zs,ma].indexOf(i)>=0?{x:a,y:o}:{x:o,y:a}}(d,t.rects,s),c},{}),a=o[t.placement],u=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=a.x,t.modifiersData.popperOffsets.y+=u),t.modifiersData[i]=o}},Tz=["*"],MEe=["dialog"];function oSe(e,t){1&e&&B(0),2&e&&Ni(Et(2).title)}function aSe(e,t){}function lSe(e,t){if(1&e&&(k(0,"h3",3),je(1,oSe,1,1,"ng-template",null,4,Co),je(3,aSe,0,0,"ng-template",5),F()),2&e){const n=wo(2),i=Et();W(3),X("ngTemplateOutlet",i.isTitleTemplate()?i.title:n)("ngTemplateOutletContext",i.context)}}function $f(e){return null!=e}function Sg(e){return(e||document.body).getBoundingClientRect()}const Nz={animation:!0,transitionTimerDelayMs:5},ESe=()=>{},{transitionTimerDelayMs:SSe}=Nz,U_=new Map,jr=(e,t,n,i)=>{let r=i.context||{};const s=U_.get(t);if(s)switch(i.runningTransition){case"continue":return Qo;case"stop":e.run(()=>s.transition$.complete()),r=Object.assign(s.context,r),U_.delete(t)}const o=n(t,i.animation,r)||ESe;if(!i.animation||"none"===window.getComputedStyle(t).transitionProperty)return e.run(()=>o()),Ge(void 0).pipe(function DSe(e){return t=>new Qt(n=>t.subscribe({next:o=>e.run(()=>n.next(o)),error:o=>e.run(()=>n.error(o)),complete:()=>e.run(()=>n.complete())}))}(e));const a=new Pn,l=new Pn,u=a.pipe(function Zwe(...e){return t=>v_(t,Ge(...e))}(!0));U_.set(t,{transition$:a,complete:()=>{l.next(),l.complete()},context:r});const c=function CSe(e){const{transitionDelay:t,transitionDuration:n}=window.getComputedStyle(e);return 1e3*(parseFloat(t)+parseFloat(n))}(t);return e.runOutsideAngular(()=>{const d=Pr(t,"transitionend").pipe(bi(u),Ii(({target:h})=>h===t));rU(C2(c+SSe).pipe(bi(u)),d,l).pipe(bi(u)).subscribe(()=>{U_.delete(t),e.run(()=>{o(),a.next(),a.complete()})})}),a.asObservable()};let z_=(()=>{class e{constructor(){this.animation=Nz.animation}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Lz=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({imports:[[Vs]]}),e})(),jz=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({imports:[[Vs]]}),e})(),$z=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({}),e})(),Uz=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({imports:[[Vs]]}),e})(),zz=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({}),e})();var wi=(()=>{return(e=wi||(wi={}))[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.ArrowLeft=37]="ArrowLeft",e[e.ArrowUp=38]="ArrowUp",e[e.ArrowRight=39]="ArrowRight",e[e.ArrowDown=40]="ArrowDown",wi;var e})();const Yw=(e,t)=>!!t&&t.some(n=>n.contains(e)),qz=(e,t)=>!t||null!=function wSe(e,t){return t&&void 0!==e.closest?e.closest(t):null}(e,t),zSe="undefined"!=typeof navigator&&!!navigator.userAgent&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2||/Android/.test(navigator.userAgent));const Wz=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");function Yz(e){const t=Array.from(e.querySelectorAll(Wz)).filter(n=>-1!==n.tabIndex);return[t[0],t[t.length-1]]}const WSe=/\s+/,YSe=/  +/gi,KSe=/^start/,JSe=/^end/,XSe=/-(top|left)$/,QSe=/-(bottom|right)$/,exe=/^left/,txe=/^right/,nxe=/^start/,ixe=/^end/;function Kz({placement:e,baseClass:t}){let n=Array.isArray(e)?e:e.split(WSe),r=n.findIndex(l=>"auto"===l);r>=0&&["top","bottom","start","end","top-start","top-end","bottom-start","bottom-end","start-top","start-bottom","end-top","end-bottom"].forEach(function(l){null==n.find(u=>-1!==u.search("^"+l))&&n.splice(r++,1,l)});const s=n.map(l=>function ZSe(e){return e.replace(KSe,"left").replace(JSe,"right").replace(XSe,"-start").replace(QSe,"-end")}(l));return{placement:s.shift(),modifiers:[{name:"bootstrapClasses",enabled:!!t,phase:"write",fn({state:l}){const u=new RegExp(t+"-[a-z]+","gi"),c=l.elements.popper,d=l.placement;let f=c.className;f=f.replace(u,""),f+=` ${function rxe(e,t){let[n,i]=t.split("-");const r=n.replace(exe,"start").replace(txe,"end");let s=[r];if(i){let o=i;("left"===n||"right"===n)&&(o=o.replace(nxe,"top").replace(ixe,"bottom")),s.push(`${r}-${o}`)}return e&&(s=s.map(o=>`${e}-${o}`)),s.join(" ")}(t,d)}`,f=f.trim().replace(YSe," "),c.className=f}},SCe,TCe,ICe,{enabled:!0,name:"flip",options:{fallbackPlacements:s}},{enabled:!0,name:"preventOverflow",phase:"main",fn:function(){}}]}}function Jz(e){return e}function Qz(e){return t=>(t.modifiers.push(iEe,{name:"offset",options:{offset:()=>e}}),t)}new Date(1882,10,12),new Date(2174,10,25);let rq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({imports:[[Vs,hz]]}),e})(),dN=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275dir=ye({type:e,selectors:[["",8,"navbar"]]}),e})(),aq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({}),e})();class zf{constructor(t,n,i){this.nodes=t,this.viewRef=n,this.componentRef=i}}class gxe{constructor(t,n,i,r,s,o){this._type=t,this._injector=n,this._viewContainerRef=i,this._renderer=r,this._ngZone=s,this._applicationRef=o,this._windowRef=null,this._contentRef=null}open(t,n,i=!1){this._windowRef||(this._contentRef=this._getContentRef(t,n),this._windowRef=this._viewContainerRef.createComponent(this._type,{index:this._viewContainerRef.length,injector:this._injector,projectableNodes:this._contentRef.nodes}));const{nativeElement:r}=this._windowRef.location,s=this._ngZone.onStable.pipe(gi(1),Qn(()=>jr(this._ngZone,r,({classList:o})=>o.add("show"),{animation:i,runningTransition:"continue"})));return{windowRef:this._windowRef,transition$:s}}close(t=!1){return this._windowRef?jr(this._ngZone,this._windowRef.location.nativeElement,({classList:n})=>n.remove("show"),{animation:t,runningTransition:"stop"}).pipe(cr(()=>{var n;this._windowRef&&(this._viewContainerRef.remove(this._viewContainerRef.indexOf(this._windowRef.hostView)),this._windowRef=null),(null===(n=this._contentRef)||void 0===n?void 0:n.viewRef)&&(this._applicationRef.detachView(this._contentRef.viewRef),this._contentRef.viewRef.destroy(),this._contentRef=null)})):Ge(void 0)}_getContentRef(t,n){if(t){if(t instanceof Mn){const i=t.createEmbeddedView(n);return this._applicationRef.attachView(i),new zf([i.rootNodes],i)}return new zf([[this._renderer.createText(`${t}`)]])}return new zf([])}}let mxe=(()=>{class e{constructor(n,i){this._el=n,this._zone=i}ngOnInit(){this._zone.onStable.asObservable().pipe(gi(1)).subscribe(()=>{jr(this._zone,this._el.nativeElement,(n,i)=>{i&&Sg(n),n.classList.add("show")},{animation:this.animation,runningTransition:"continue"})})}hide(){return jr(this._zone,this._el.nativeElement,({classList:n})=>n.remove("show"),{animation:this.animation,runningTransition:"stop"})}}return e.\u0275fac=function(n){return new(n||e)(H(cn),H(dn))},e.\u0275cmp=bn({type:e,selectors:[["ngb-modal-backdrop"]],hostAttrs:[2,"z-index","1055"],hostVars:6,hostBindings:function(n,i){2&n&&(Mc("modal-backdrop"+(i.backdropClass?" "+i.backdropClass:"")),An("show",!i.animation)("fade",i.animation))},inputs:{animation:"animation",backdropClass:"backdropClass"},decls:0,vars:0,template:function(n,i){},encapsulation:2}),e})();class lq{close(t){}dismiss(t){}}class _xe{constructor(t,n,i,r){this._windowCmptRef=t,this._contentRef=n,this._backdropCmptRef=i,this._beforeDismiss=r,this._closed=new Pn,this._dismissed=new Pn,this._hidden=new Pn,t.instance.dismissEvent.subscribe(s=>{this.dismiss(s)}),this.result=new Promise((s,o)=>{this._resolve=s,this._reject=o}),this.result.then(null,()=>{})}get componentInstance(){if(this._contentRef&&this._contentRef.componentRef)return this._contentRef.componentRef.instance}get closed(){return this._closed.asObservable().pipe(bi(this._hidden))}get dismissed(){return this._dismissed.asObservable().pipe(bi(this._hidden))}get hidden(){return this._hidden.asObservable()}get shown(){return this._windowCmptRef.instance.shown.asObservable()}close(t){this._windowCmptRef&&(this._closed.next(t),this._resolve(t),this._removeModalElements())}_dismiss(t){this._dismissed.next(t),this._reject(t),this._removeModalElements()}dismiss(t){if(this._windowCmptRef)if(this._beforeDismiss){const n=this._beforeDismiss();!function bSe(e){return e&&e.then}(n)?!1!==n&&this._dismiss(t):n.then(i=>{!1!==i&&this._dismiss(t)},()=>{})}else this._dismiss(t)}_removeModalElements(){const t=this._windowCmptRef.instance.hide(),n=this._backdropCmptRef?this._backdropCmptRef.instance.hide():Ge(void 0);t.subscribe(()=>{const{nativeElement:i}=this._windowCmptRef.location;i.parentNode.removeChild(i),this._windowCmptRef.destroy(),this._contentRef&&this._contentRef.viewRef&&this._contentRef.viewRef.destroy(),this._windowCmptRef=null,this._contentRef=null}),n.subscribe(()=>{if(this._backdropCmptRef){const{nativeElement:i}=this._backdropCmptRef.location;i.parentNode.removeChild(i),this._backdropCmptRef.destroy(),this._backdropCmptRef=null}}),kw(t,n).subscribe(()=>{this._hidden.next(),this._hidden.complete()})}}var Y_=(()=>{return(e=Y_||(Y_={}))[e.BACKDROP_CLICK=0]="BACKDROP_CLICK",e[e.ESC=1]="ESC",Y_;var e})();let yxe=(()=>{class e{constructor(n,i,r){this._document=n,this._elRef=i,this._zone=r,this._closed$=new Pn,this._elWithFocus=null,this.backdrop=!0,this.keyboard=!0,this.dismissEvent=new tt,this.shown=new Pn,this.hidden=new Pn}dismiss(n){this.dismissEvent.emit(n)}ngOnInit(){this._elWithFocus=this._document.activeElement,this._zone.onStable.asObservable().pipe(gi(1)).subscribe(()=>{this._show()})}ngOnDestroy(){this._disableEventHandling()}hide(){const{nativeElement:n}=this._elRef,i={animation:this.animation,runningTransition:"stop"},o=kw(jr(this._zone,n,()=>n.classList.remove("show"),i),jr(this._zone,this._dialogEl.nativeElement,()=>{},i));return o.subscribe(()=>{this.hidden.next(),this.hidden.complete()}),this._disableEventHandling(),this._restoreFocus(),o}_show(){const n={animation:this.animation,runningTransition:"continue"};kw(jr(this._zone,this._elRef.nativeElement,(s,o)=>{o&&Sg(s),s.classList.add("show")},n),jr(this._zone,this._dialogEl.nativeElement,()=>{},n)).subscribe(()=>{this.shown.next(),this.shown.complete()}),this._enableEventHandling(),this._setFocus()}_enableEventHandling(){const{nativeElement:n}=this._elRef;this._zone.runOutsideAngular(()=>{Pr(n,"keydown").pipe(bi(this._closed$),Ii(r=>r.which===wi.Escape)).subscribe(r=>{this.keyboard?requestAnimationFrame(()=>{r.defaultPrevented||this._zone.run(()=>this.dismiss(Y_.ESC))}):"static"===this.backdrop&&this._bumpBackdrop()});let i=!1;Pr(this._dialogEl.nativeElement,"mousedown").pipe(bi(this._closed$),cr(()=>i=!1),Mu(()=>Pr(n,"mouseup").pipe(bi(this._closed$),gi(1))),Ii(({target:r})=>n===r)).subscribe(()=>{i=!0}),Pr(n,"click").pipe(bi(this._closed$)).subscribe(({target:r})=>{n===r&&("static"===this.backdrop?this._bumpBackdrop():!0===this.backdrop&&!i&&this._zone.run(()=>this.dismiss(Y_.BACKDROP_CLICK))),i=!1})})}_disableEventHandling(){this._closed$.next()}_setFocus(){const{nativeElement:n}=this._elRef;if(!n.contains(document.activeElement)){const i=n.querySelector("[ngbAutofocus]"),r=Yz(n)[0];(i||r||n).focus()}}_restoreFocus(){const n=this._document.body,i=this._elWithFocus;let r;r=i&&i.focus&&n.contains(i)?i:n,this._zone.runOutsideAngular(()=>{setTimeout(()=>r.focus()),this._elWithFocus=null})}_bumpBackdrop(){"static"===this.backdrop&&jr(this._zone,this._elRef.nativeElement,({classList:n})=>(n.add("modal-static"),()=>n.remove("modal-static")),{animation:this.animation,runningTransition:"continue"})}}return e.\u0275fac=function(n){return new(n||e)(H(ti),H(cn),H(dn))},e.\u0275cmp=bn({type:e,selectors:[["ngb-modal-window"]],viewQuery:function(n,i){if(1&n&&zb(MEe,7),2&n){let r;Tn(r=On())&&(i._dialogEl=r.first)}},hostAttrs:["role","dialog","tabindex","-1"],hostVars:7,hostBindings:function(n,i){2&n&&(ln("aria-modal",!0)("aria-labelledby",i.ariaLabelledBy)("aria-describedby",i.ariaDescribedBy),Mc("modal d-block"+(i.windowClass?" "+i.windowClass:"")),An("fade",i.animation))},inputs:{animation:"animation",ariaLabelledBy:"ariaLabelledBy",ariaDescribedBy:"ariaDescribedBy",backdrop:"backdrop",centered:"centered",keyboard:"keyboard",scrollable:"scrollable",size:"size",windowClass:"windowClass",modalDialogClass:"modalDialogClass"},outputs:{dismissEvent:"dismiss"},ngContentSelectors:Tz,decls:4,vars:2,consts:[["role","document"],["dialog",""],[1,"modal-content"]],template:function(n,i){1&n&&(FT(),k(0,"div",0,1)(2,"div",2),PT(3),F()()),2&n&&Mc("modal-dialog"+(i.size?" modal-"+i.size:"")+(i.centered?" modal-dialog-centered":"")+(i.scrollable?" modal-dialog-scrollable":"")+(i.modalDialogClass?" "+i.modalDialogClass:""))},styles:["ngb-modal-window .component-host-scrollable{display:flex;flex-direction:column;overflow:hidden}\n"],encapsulation:2}),e})(),vxe=(()=>{class e{constructor(n){this._document=n}hide(){const n=Math.abs(window.innerWidth-this._document.documentElement.clientWidth),i=this._document.body,r=i.style,{overflow:s,paddingRight:o}=r;if(n>0){const a=parseFloat(window.getComputedStyle(i).paddingRight);r.paddingRight=`${a+n}px`}return r.overflow="hidden",()=>{n>0&&(r.paddingRight=o),r.overflow=s}}}return e.\u0275fac=function(n){return new(n||e)(me(ti))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),bxe=(()=>{class e{constructor(n,i,r,s,o,a){this._applicationRef=n,this._injector=i,this._document=r,this._scrollBar=s,this._rendererFactory=o,this._ngZone=a,this._activeWindowCmptHasChanged=new Pn,this._ariaHiddenValues=new Map,this._scrollBarRestoreFn=null,this._backdropAttributes=["animation","backdropClass"],this._modalRefs=[],this._windowAttributes=["animation","ariaLabelledBy","ariaDescribedBy","backdrop","centered","keyboard","scrollable","size","windowClass","modalDialogClass"],this._windowCmpts=[],this._activeInstances=new tt,this._activeWindowCmptHasChanged.subscribe(()=>{if(this._windowCmpts.length){const l=this._windowCmpts[this._windowCmpts.length-1];((e,t,n,i=!1)=>{this._ngZone.runOutsideAngular(()=>{const r=Pr(t,"focusin").pipe(bi(n),ot(s=>s.target));Pr(t,"keydown").pipe(bi(n),Ii(s=>s.which===wi.Tab),S2(r)).subscribe(([s,o])=>{const[a,l]=Yz(t);(o===a||o===t)&&s.shiftKey&&(l.focus(),s.preventDefault()),o===l&&!s.shiftKey&&(a.focus(),s.preventDefault())}),i&&Pr(t,"click").pipe(bi(n),S2(r),ot(s=>s[1])).subscribe(s=>s.focus())})})(0,l.location.nativeElement,this._activeWindowCmptHasChanged),this._revertAriaHidden(),this._setAriaHidden(l.location.nativeElement)}})}_restoreScrollBar(){const n=this._scrollBarRestoreFn;n&&(this._scrollBarRestoreFn=null,n())}_hideScrollBar(){this._scrollBarRestoreFn||(this._scrollBarRestoreFn=this._scrollBar.hide())}open(n,i,r,s){const o=s.container instanceof HTMLElement?s.container:$f(s.container)?this._document.querySelector(s.container):this._document.body,a=this._rendererFactory.createRenderer(null,null);if(!o)throw new Error(`The specified modal container "${s.container||"body"}" was not found in the DOM.`);this._hideScrollBar();const l=new lq,u=this._getContentRef(n,s.injector||i,r,l,s);let c=!1!==s.backdrop?this._attachBackdrop(n,o):void 0,d=this._attachWindowComponent(n,o,u),f=new _xe(d,u,c,s.beforeDismiss);return this._registerModalRef(f),this._registerWindowCmpt(d),f.hidden.pipe(gi(1)).subscribe(()=>Promise.resolve(!0).then(()=>{this._modalRefs.length||(a.removeClass(this._document.body,"modal-open"),this._restoreScrollBar(),this._revertAriaHidden())})),l.close=h=>{f.close(h)},l.dismiss=h=>{f.dismiss(h)},this._applyWindowOptions(d.instance,s),1===this._modalRefs.length&&a.addClass(this._document.body,"modal-open"),c&&c.instance&&(this._applyBackdropOptions(c.instance,s),c.changeDetectorRef.detectChanges()),d.changeDetectorRef.detectChanges(),f}get activeInstances(){return this._activeInstances}dismissAll(n){this._modalRefs.forEach(i=>i.dismiss(n))}hasOpenModals(){return this._modalRefs.length>0}_attachBackdrop(n,i){let s=n.resolveComponentFactory(mxe).create(this._injector);return this._applicationRef.attachView(s.hostView),i.appendChild(s.location.nativeElement),s}_attachWindowComponent(n,i,r){let o=n.resolveComponentFactory(yxe).create(this._injector,r.nodes);return this._applicationRef.attachView(o.hostView),i.appendChild(o.location.nativeElement),o}_applyWindowOptions(n,i){this._windowAttributes.forEach(r=>{$f(i[r])&&(n[r]=i[r])})}_applyBackdropOptions(n,i){this._backdropAttributes.forEach(r=>{$f(i[r])&&(n[r]=i[r])})}_getContentRef(n,i,r,s,o){return r?r instanceof Mn?this._createFromTemplateRef(r,s):function Oz(e){return"string"==typeof e}(r)?this._createFromString(r):this._createFromComponent(n,i,r,s,o):new zf([])}_createFromTemplateRef(n,i){const s=n.createEmbeddedView({$implicit:i,close(o){i.close(o)},dismiss(o){i.dismiss(o)}});return this._applicationRef.attachView(s),new zf([s.rootNodes],s)}_createFromString(n){const i=this._document.createTextNode(`${n}`);return new zf([[i]])}_createFromComponent(n,i,r,s,o){const a=n.resolveComponentFactory(r),l=ai.create({providers:[{provide:lq,useValue:s}],parent:i}),u=a.create(l),c=u.location.nativeElement;return o.scrollable&&c.classList.add("component-host-scrollable"),this._applicationRef.attachView(u.hostView),new zf([[c]],u.hostView,u)}_setAriaHidden(n){const i=n.parentElement;i&&n!==this._document.body&&(Array.from(i.children).forEach(r=>{r!==n&&"SCRIPT"!==r.nodeName&&(this._ariaHiddenValues.set(r,r.getAttribute("aria-hidden")),r.setAttribute("aria-hidden","true"))}),this._setAriaHidden(i))}_revertAriaHidden(){this._ariaHiddenValues.forEach((n,i)=>{n?i.setAttribute("aria-hidden",n):i.removeAttribute("aria-hidden")}),this._ariaHiddenValues.clear()}_registerModalRef(n){const i=()=>{const r=this._modalRefs.indexOf(n);r>-1&&(this._modalRefs.splice(r,1),this._activeInstances.emit(this._modalRefs))};this._modalRefs.push(n),this._activeInstances.emit(this._modalRefs),n.result.then(i,i)}_registerWindowCmpt(n){this._windowCmpts.push(n),this._activeWindowCmptHasChanged.next(),n.onDestroy(()=>{const i=this._windowCmpts.indexOf(n);i>-1&&(this._windowCmpts.splice(i,1),this._activeWindowCmptHasChanged.next())})}}return e.\u0275fac=function(n){return new(n||e)(me(h_),me(ai),me(ti),me(vxe),me(ug),me(dn))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),wxe=(()=>{class e{constructor(n){this._ngbConfig=n,this.backdrop=!0,this.keyboard=!0}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(n){this._animation=n}}return e.\u0275fac=function(n){return new(n||e)(me(z_))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),uq=(()=>{class e{constructor(n,i,r,s){this._moduleCFR=n,this._injector=i,this._modalStack=r,this._config=s}open(n,i={}){const r=Object.assign(Object.assign(Object.assign({},this._config),{animation:this._config.animation}),i);return this._modalStack.open(this._moduleCFR,this._injector,n,r)}get activeInstances(){return this._modalStack.activeInstances}dismissAll(n){this._modalStack.dismissAll(n)}hasOpenModals(){return this._modalStack.hasOpenModals()}}return e.\u0275fac=function(n){return new(n||e)(me(ag),me(ai),me(bxe),me(wxe))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),cq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({providers:[uq]}),e})(),pq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({imports:[[Vs]]}),e})(),Dq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({imports:[[Vs]]}),e})();class Axe{constructor(t,n){this.open=t,this.close=n,n||(this.close=t)}isManual(){return"manual"===this.open||"manual"===this.close}}const Mxe={hover:["mouseenter","mouseleave"],focus:["focusin","focusout"]},Cq=e=>e>0?aU(e):t=>t;let Ixe=(()=>{class e{constructor(n){this._ngbConfig=n,this.autoClose=!0,this.placement="auto",this.triggers="click",this.disablePopover=!1,this.openDelay=0,this.closeDelay=0}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(n){this._animation=n}}return e.\u0275fac=function(n){return new(n||e)(me(z_))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Rxe=0,Fxe=(()=>{class e{isTitleTemplate(){return this.title instanceof Mn}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=bn({type:e,selectors:[["ngb-popover-window"]],hostAttrs:["role","tooltip"],hostVars:5,hostBindings:function(n,i){2&n&&(Eu("id",i.id),Mc("popover"+(i.popoverClass?" "+i.popoverClass:"")),An("fade",i.animation))},inputs:{animation:"animation",title:"title",id:"id",popoverClass:"popoverClass",context:"context"},ngContentSelectors:Tz,decls:4,vars:1,consts:[["data-popper-arrow","",1,"popover-arrow"],["class","popover-header",4,"ngIf"],[1,"popover-body"],[1,"popover-header"],["simpleTitle",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(n,i){1&n&&(FT(),dt(0,"div",0),je(1,lSe,4,2,"h3",1),k(2,"div",2),PT(3),F()),2&n&&(W(1),X("ngIf",i.title))},directives:[Fr,hg],encapsulation:2,changeDetection:0}),e})(),Eq=(()=>{class e{constructor(n,i,r,s,o,a,l,u,c){this._elementRef=n,this._renderer=i,this._ngZone=a,this._document=l,this._changeDetector=u,this.shown=new tt,this.hidden=new tt,this._ngbPopoverWindowId="ngb-popover-"+Rxe++,this._windowRef=null,this._positioning=function Xz(){let e=null;return{createPopper(t){if(!e){let i=(t.updatePopperOptions||Jz)(Kz(t));e=eEe(t.hostElement,t.targetElement,i)}},update(){e&&e.update()},setOptions(t){if(e){let i=(t.updatePopperOptions||Jz)(Kz(t));e.setOptions(i)}},destroy(){e&&(e.destroy(),e=null)}}}(),this.animation=o.animation,this.autoClose=o.autoClose,this.placement=o.placement,this.triggers=o.triggers,this.container=o.container,this.disablePopover=o.disablePopover,this.popoverClass=o.popoverClass,this.openDelay=o.openDelay,this.closeDelay=o.closeDelay,this._popupService=new gxe(Fxe,r,s,i,this._ngZone,c),this._zoneSubscription=a.onStable.subscribe(()=>{this._positioning.update()})}_isDisabled(){return!(!this.disablePopover&&(this.ngbPopover||this.popoverTitle))}open(n){if(!this._windowRef&&!this._isDisabled()){const{windowRef:i,transition$:r}=this._popupService.open(this.ngbPopover,n,this.animation);this._windowRef=i,this._windowRef.instance.animation=this.animation,this._windowRef.instance.title=this.popoverTitle,this._windowRef.instance.context=n,this._windowRef.instance.popoverClass=this.popoverClass,this._windowRef.instance.id=this._ngbPopoverWindowId,this._renderer.setAttribute(this._elementRef.nativeElement,"aria-describedby",this._ngbPopoverWindowId),"body"===this.container&&this._document.querySelector(this.container).appendChild(this._windowRef.location.nativeElement),this._windowRef.changeDetectorRef.detectChanges(),this._windowRef.changeDetectorRef.markForCheck(),this._ngZone.onStable.pipe(gi(1)).subscribe(()=>{this._positioning.createPopper({hostElement:this._elementRef.nativeElement,targetElement:this._windowRef.location.nativeElement,placement:this.placement,appendToBody:"body"===this.container,baseClass:"bs-popover",updatePopperOptions:Qz([0,8])})}),function Gz(e,t,n,i,r,s,o,a){n&&e.runOutsideAngular((e=>zSe?()=>setTimeout(()=>e(),100):e)(()=>{const u=Pr(t,"keydown").pipe(bi(r),Ii(f=>f.which===wi.Escape),cr(f=>f.preventDefault())),c=Pr(t,"mousedown").pipe(ot(f=>{const h=f.target;return 2!==f.button&&!Yw(h,o)&&("inside"===n?Yw(h,s)&&qz(h,a):"outside"===n?!Yw(h,s):qz(h,a)||!Yw(h,s))}),bi(r)),d=Pr(t,"mouseup").pipe(S2(c),Ii(([f,h])=>h),aU(0),bi(r));rU([u.pipe(ot(f=>0)),d.pipe(ot(f=>1))]).subscribe(f=>e.run(()=>i(f)))}))}(this._ngZone,this._document,this.autoClose,()=>this.close(),this.hidden,[this._windowRef.location.nativeElement]),r.subscribe(()=>this.shown.emit())}}close(){this._windowRef&&(this._renderer.removeAttribute(this._elementRef.nativeElement,"aria-describedby"),this._popupService.close(this.animation).subscribe(()=>{this._windowRef=null,this._positioning.destroy(),this.hidden.emit(),this._changeDetector.markForCheck()}))}toggle(){this._windowRef?this.close():this.open()}isOpen(){return null!=this._windowRef}ngOnInit(){this._unregisterListenersFn=function kxe(e,t,n,i,r,s,o=0,a=0){const l=function Txe(e,t=Mxe){const n=(e||"").trim();if(0===n.length)return[];const i=n.split(/\s+/).map(s=>s.split(":")).map(s=>{let o=t[s[0]]||s;return new Axe(o[0],o[1])}),r=i.filter(s=>s.isManual());if(r.length>1)throw"Triggers parse error: only one manual trigger is allowed";if(1===r.length&&i.length>1)throw"Triggers parse error: manual trigger can't be mixed with other triggers";return i}(n);if(1===l.length&&l[0].isManual())return()=>{};const u=function Oxe(e,t,n,i){return new Qt(r=>{const s=[],o=()=>r.next(!0),a=()=>r.next(!1),l=()=>r.next(!i());return n.forEach(u=>{u.open===u.close?s.push(e.listen(t,u.open,l)):s.push(e.listen(t,u.open,o),e.listen(t,u.close,a))}),()=>{s.forEach(u=>u())}})}(e,t,l,i).pipe(function Nxe(e,t,n){return i=>{let r=null;const s=i.pipe(ot(l=>({open:l})),Ii(l=>{const u=n();return u===l.open||r&&r.open!==u?(r&&r.open!==l.open&&(r=null),!1):(r=l,!0)}),C4());return D4(s.pipe(Ii(l=>l.open),Cq(e)),s.pipe(Ii(l=>!l.open),Cq(t))).pipe(Ii(l=>l===r&&(r=null,l.open!==n())),ot(l=>l.open))}}(o,a,i)).subscribe(c=>c?r():s());return()=>u.unsubscribe()}(this._renderer,this._elementRef.nativeElement,this.triggers,this.isOpen.bind(this),this.open.bind(this),this.close.bind(this),+this.openDelay,+this.closeDelay)}ngOnChanges({ngbPopover:n,popoverTitle:i,disablePopover:r,popoverClass:s}){s&&this.isOpen()&&(this._windowRef.instance.popoverClass=s.currentValue),(n||i||r)&&this._isDisabled()&&this.close()}ngOnDestroy(){this.close(),this._unregisterListenersFn&&this._unregisterListenersFn(),this._zoneSubscription.unsubscribe()}}return e.\u0275fac=function(n){return new(n||e)(H(cn),H($s),H(ai),H(Do),H(Ixe),H(dn),H(ti),H(Eo),H(h_))},e.\u0275dir=ye({type:e,selectors:[["","ngbPopover",""]],inputs:{animation:"animation",autoClose:"autoClose",ngbPopover:"ngbPopover",popoverTitle:"popoverTitle",placement:"placement",triggers:"triggers",container:"container",disablePopover:"disablePopover",popoverClass:"popoverClass",openDelay:"openDelay",closeDelay:"closeDelay"},outputs:{shown:"shown",hidden:"hidden"},exportAs:["ngbPopover"],features:[xn]}),e})(),Sq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({imports:[[Vs]]}),e})(),xq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({imports:[[Vs]]}),e})(),Aq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({imports:[[Vs]]}),e})(),Mq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({imports:[[Vs]]}),e})(),Tq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({imports:[[Vs]]}),e})(),Oq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({}),e})();new it("live announcer delay",{providedIn:"root",factory:function jxe(){return 100}});let Nq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({imports:[[Vs]]}),e})();const Bxe=[Lz,jz,$z,Uz,zz,rq,aq,cq,pq,Dq,Sq,xq,Aq,Mq,Tq,Oq,Nq];let $xe=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({imports:[Bxe,Lz,jz,$z,Uz,zz,rq,aq,cq,pq,Dq,Sq,xq,Aq,Mq,Tq,Oq,Nq]}),e})(),kq=(()=>{class e{transform(n,i){if(void 0===n)return n;if("string"!=typeof n||Number.isNaN(Number(n))){if("string"==typeof n)return n}else n=Number(n);return Number.isNaN(n)?"-":n<1e3?n:n.toString().slice(0,n.toString().length-3)+","+n.toString().slice(-3)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275pipe=ir({name:"numFormat",type:e,pure:!0}),e})(),Iq=(()=>{class e{transform(n,i){if(void 0===n)return"-";if("string"!=typeof n||Number.isNaN(Number(n))){if("string"==typeof n)return n;if(Number.isNaN(n))return"-"}else n=Number(n)+"%";return n+"%"}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275pipe=ir({name:"percentageFormat",type:e,pure:!0}),e})();const Vxe=["content"];function Hxe(e,t){1&e&&(k(0,"div",32)(1,"div",33)(2,"div",34)(3,"span",35),B(4,"Loading..."),F()()()())}function Uxe(e,t){if(1&e&&(k(0,"div",36)(1,"div",37)(2,"div",1)(3,"div",38),B(4),ca(5,"numFormat"),F()(),k(6,"div",1)(7,"p"),B(8,"company statements found under MSA"),F()()(),k(9,"div",39)(10,"div",1)(11,"div",38),B(12),ca(13,"numFormat"),F()(),k(14,"div",1)(15,"p"),B(16,"MSA statements assessed by "),k(17,"span",40),B(18,"Researchers"),F()()()(),k(19,"div",37)(20,"div",1)(21,"div",38),B(22),ca(23,"percentageFormat"),F()(),k(24,"div",1)(25,"p"),B(26,"of the assessed statements meet all minimum requirements of the corresponding MSA legislation"),F()()(),k(27,"div",39)(28,"div",1)(29,"div",38),B(30),ca(31,"percentageFormat"),F()(),k(32,"div",1)(33,"p"),B(34,"of the assessed statements go beyond compliance and report additional guidelines"),F()()()()),2&e){const n=Et();W(4),Ni(da(5,4,n.numOfCompaniesUnderMSA)),W(8),Ni(da(13,6,n.numOfAssessedMSAStatements)),W(10),Ni(da(23,8,n.meetsMinRequirements)),W(8),ua(" ",da(31,10,n.go_beyond_compliance)," ")}}function zxe(e,t){if(1&e){const n=Bs();k(0,"div",25)(1,"h4",41),B(2,"The Australian Modern Slavery Act"),F(),k(3,"button",42),Fe("click",function(){return or(n).$implicit.dismiss("Cross click")}),F()(),k(4,"div",28)(5,"p"),B(6,"The Australian Modern Slavery Act was passed in 2018 and required companies to produce their first statement for financial year 2019. These needed to be submitted within 3 months after year's end (in 2020) but for this first year the government provided companies with an extension due to the impact of the covid pandemic. As a result, most companies submitted statements under the Australian Act from the financial year 2020 onward."),F()(),k(7,"div",29)(8,"button",43),Fe("click",function(){return or(n).$implicit.close("Close click")}),B(9,"Close"),F()()}}let qxe=(()=>{class e{constructor(n,i){this.dataProvider=n,this.modalService=i,this.year="",this.legislation="both",this.isLoading=!0}ngOnInit(){}ngOnChanges(){this.updateData(this.year)}updateData(n){let i=this.dataProvider.getCompanyGroup(this.sector);return this.isLoading=!0,this.numOfAssessedMSAStatements=0,"both"===this.legislation?(this.dataProvider.getAnswers(this.dataProvider.metrics.modern_slavery_statement,[new re("year",this.year),new re("company_group",i),new re("value",["Yes - UK Modern Slavery Act","Yes - Australian Modern Slavery Act"])]).subscribe(r=>{this.numOfCompaniesUnderMSA=r.length,this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new re("year",this.year),new re("value","Yes"),new re("company_group",i)]).subscribe(s=>{this.numOfAssessedMSAStatements=s.length,this.dataProvider.getAnswers(this.dataProvider.metrics.meet_aus_min_requirements,[new re("year",this.year),new re("value","Yes"),new re("company_group",i)]).subscribe(o=>{o=o.filter(a=>s.findIndex(l=>l.company==a.company&&l.year==a.year)>=0),this.meetsMinRequirements=o.length,this.dataProvider.getAnswers(this.dataProvider.metrics.meet_uk_min_requirements,[new re("year",this.year),new re("value","Yes"),new re("company_group",i)]).subscribe(a=>{a=a.filter(l=>s.findIndex(u=>u.company==l.company&&u.year==l.year)>=0&&o.findIndex(u=>u.company==l.company&&u.year==l.year)<0),this.meetsMinRequirements=Math.round(100*(this.meetsMinRequirements+a.length)/this.numOfAssessedMSAStatements),this.dataProvider.getAnswers(this.dataProvider.metrics.msa_beyond_compliance,[new re("year",this.year),new re("value","Yes"),new re("company_group",i)]).subscribe(l=>{l=l.filter(u=>s.findIndex(c=>c.company==u.company&&c.year==u.year)>=0),this.go_beyond_compliance=Math.round(100*l.length/this.numOfAssessedMSAStatements)},l=>console.log(l),()=>this.isLoading=!1)})})})}),n):"uk"===this.legislation?(this.dataProvider.getAnswers(this.dataProvider.metrics.modern_slavery_statement,[new re("year",this.year),new re("value",["Yes - UK Modern Slavery Act"]),new re("company_group",i)]).subscribe(r=>{this.numOfCompaniesUnderMSA=r.length,this.dataProvider.getAnswers(this.dataProvider.metrics.uk_msa_statement_assessed,[new re("year",this.year),new re("value","Yes"),new re("company_group",i)]).subscribe(s=>{this.numOfAssessedMSAStatements=s.length,this.dataProvider.getAnswers(this.dataProvider.metrics.meet_uk_min_requirements,[new re("year",this.year),new re("value","Yes"),new re("company_group",i)]).subscribe(o=>{o=o.filter(a=>s.findIndex(l=>l.company==a.company&&l.year==a.year)>=0),this.meetsMinRequirements=Math.round(o.length/this.numOfAssessedMSAStatements*100),this.dataProvider.getAnswers(this.dataProvider.metrics.uk_beyond_compliance_disclosure_rate,[new re("year",this.year),new re("value",new m2(1,"")),new re("company_group",i)]).subscribe(a=>{a=a.filter(l=>s.findIndex(u=>u.company==l.company&&u.year==l.year)>=0),this.go_beyond_compliance=Math.round(100*a.length/this.numOfAssessedMSAStatements)},a=>console.log(a),()=>this.isLoading=!1)})})}),n):(""!==this.year&&"latest"!==this.year&&Number(this.year)<2020&&(this.openMessage(),this.year=2020),this.dataProvider.getAnswers(this.dataProvider.metrics.modern_slavery_statement,[new re("year",this.year),new re("value",["Yes - Australian Modern Slavery Act"]),new re("company_group",i)]).subscribe(r=>{this.numOfCompaniesUnderMSA=r.length,this.dataProvider.getAnswers(this.dataProvider.metrics.aus_msa_statement_assessed,[new re("year",this.year),new re("value","Yes"),new re("company_group",i)]).subscribe(s=>{this.numOfAssessedMSAStatements=s.length,this.dataProvider.getAnswers(this.dataProvider.metrics.meet_aus_min_requirements,[new re("year",this.year),new re("value","Yes"),new re("company_group",i)]).subscribe(o=>{o=o.filter(a=>s.findIndex(l=>l.company==a.company&&l.year==a.year)>=0),this.meetsMinRequirements=Math.round(o.length/this.numOfAssessedMSAStatements*100),this.dataProvider.getAnswers(this.dataProvider.metrics.aus_beyond_compliance_disclosure_rate,[new re("year",this.year),new re("value",new m2(1,"")),new re("company_group",i)]).subscribe(a=>{a=a.filter(l=>s.findIndex(u=>u.company==l.company&&u.year==l.year)>=0),this.go_beyond_compliance=Math.round(100*a.length/this.numOfAssessedMSAStatements)},a=>console.log(a),()=>this.isLoading=!1)})})}),this.year)}openMessage(){this.modalService.open(this.content,{centered:!0})}}return e.\u0275fac=function(n){return new(n||e)(H(ml),H(uq))},e.\u0275cmp=bn({type:e,selectors:[["key-findings-section"]],viewQuery:function(n,i){if(1&n&&zb(Vxe,5),2&n){let r;Tn(r=On())&&(i.content=r.first)}},inputs:{sector:"sector"},features:[xn],decls:50,vars:7,consts:[[1,"section","mt-5","bg-neutral-grey","p-4"],[1,"row"],[1,"col-md-4"],[1,"title"],[1,"col-md-8","ms-md-auto"],[1,"row","ps-3","pe-3","pt-md-0","pt-2"],["aria-label","Default select example",1,"msa-form-select","bg-neutral-grey","ms-md-auto","me-3","mb-md-0","mb-1",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange"],["select",""],["value","","selected",""],["value","latest"],["value","2021"],["value","2020"],["value","2019"],["value","2018"],["value","2017"],["value","2016"],["value","2015"],["aria-label","Default select example",1,"msa-form-select","bg-neutral-grey",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],["class","row mt-3","style","height: 150px",4,"ngIf"],["class","row mt-3 mb-3",4,"ngIf"],["id","AUS-MSA","tabindex","-1","aria-labelledby","AUS-MSA-Label","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","AUS-MSA-Label",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary"],["content",""],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"],[1,"row","mt-3","mb-3"],[1,"col-md-6","pe-md-2"],[1,"msa-primary-info"],[1,"col-md-6"],["placement","top","ngbPopover","As the research effort is ongoing, this is a living project and the dashboard updates as and when new data is contributed to WikiRate.",1,"tooltip-item"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],["type","button",1,"btn","btn-light",3,"click"]],template:function(n,i){if(1&n){const r=Bs();k(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),B(4,"Key Findings"),F()(),k(5,"div",4)(6,"div",5)(7,"select",6,7),Fe("ngModelChange",function(o){return i.year=o})("ngModelChange",function(o){return or(r),wo(8).value=i.updateData(o)}),k(9,"option",8),B(10,"all years"),F(),k(11,"option",9),B(12,"latest"),F(),k(13,"option",10),B(14,"2021"),F(),k(15,"option",11),B(16,"2020"),F(),k(17,"option",12),B(18,"2019"),F(),k(19,"option",13),B(20,"2018"),F(),k(21,"option",14),B(22,"2017"),F(),k(23,"option",15),B(24,"2016"),F(),k(25,"option",16),B(26,"2015"),F()(),k(27,"select",17),Fe("ngModelChange",function(o){return i.legislation=o})("change",function(){return i.updateData(i.year)}),k(28,"option",18),B(29,"Legislation"),F(),k(30,"option",19),B(31,"UK MSA"),F(),k(32,"option",19),B(33,"AUS MSA"),F()()()()(),je(34,Hxe,5,0,"div",20),je(35,Uxe,35,12,"div",21),F(),k(36,"div",22)(37,"div",23)(38,"div",24)(39,"div",25)(40,"h5",26),B(41,"Australian Modern Slavery Act"),F(),dt(42,"button",27),F(),k(43,"div",28),B(44," The Australian Modern Slavery Act was passed in 2018 and required companies to produce their first statement for financial year 2019. These needed to be submitted within 3 months after year's end (in 2020) but for this first year the government provided companies with an extension due to the impact of the covid pandemic. As a result, most companies submitted statements under the Australian Act from the financial year 2020 onward. "),F(),k(45,"div",29)(46,"button",30),B(47,"OK"),F()()()()(),je(48,zxe,10,0,"ng-template",null,31,Co)}2&n&&(W(7),X("ngModel",i.year),W(20),X("ngModel",i.legislation),W(1),X("ngValue","both"),W(2),X("ngValue","uk"),W(2),X("ngValue","aus"),W(2),X("ngIf",i.isLoading),W(1),X("ngIf",!i.isLoading))},directives:[Iu,Ff,jc,Pf,Lf,Fr,Eq],pipes:[kq,Iq],styles:[""]}),e})();const Gxe=JSON.parse('{"$schema":"https://vega.github.io/schema/vega/v5.json","description":"Companies meeting minimum requirements","width":190,"height":180,"padding":10,"signals":[{"name":"hoverValue","value":null,"on":[{"events":"arc:mouseover, @legendLabel:mouseover, @legendSymbol:mouseover","update":"datum.value"},{"events":"arc:mouseout, @legendLabel:mouseout, @legendSymbol:mouseout","update":"null"}]},{"name":"hoverOpacity","update":"if(hoverValue, 0.5, 1)","value":1}],"data":[{"name":"counts","values":[{"value":"Met","count":100,"sum_count":147},{"value":"Not Met","count":143,"sum_count":147}],"transform":[{"type":"pie","field":"count","sort":false},{"type":"formula","as":"filter","expr":"{ value: [datum.value] }"},{"type":"window","ops":["sum"],"fields":["count"],"frame":[null,null]},{"type":"formula","as":"percentage","expr":"format(datum.count / datum.sum_count, \'.0%\')"},{"type":"collect","sort":{"field":"value"}},{"type":"formula","expr":"datum.count + \' out of \' + datum.sum_count + \' statements\'","as":"count_label"}]}],"marks":[{"type":"arc","from":{"data":"counts"},"encode":{"enter":{"fill":{"scale":"color","field":"value"},"x":{"value":100},"y":{"value":100},"tooltip":{"field":"count_label"}},"update":{"startAngle":{"field":"startAngle"},"endAngle":{"field":"endAngle"},"padAngle":{"value":0},"innerRadius":{"value":0},"outerRadius":{"value":120},"cornerRadius":{"value":0},"opacity":{"signal":"if(hoverValue == datum.value, 1, hoverOpacity)"}},"hover":{"opacity":{"value":1},"cursor":{"value":"pointer"}}}},{"type":"text","from":{"data":"counts"},"encode":{"enter":{"x":{"value":100},"y":{"value":100},"radius":{"value":50},"fontWeight":{"value":"bold"},"fontSize":{"value":15},"theta":{"signal":"(datum.startAngle + datum.endAngle)/2"},"fill":{"value":"white"},"align":{"value":"center"},"baseline":{"value":"middle"},"text":{"field":"percentage"}}}}],"legends":[{"fill":"color","type":"symbol","encode":{"labels":{"name":"legendLabel","interactive":true,"update":{"fontSize":{"value":9},"fontWeight":[{"test":"hoverValue == datum.label","value":"bold"},{"value":400}]}},"symbols":{"name":"legendSymbol","interactive":true}}}],"scales":[{"name":"color","type":"ordinal","range":["#000028","#FF9300"],"domain":["Not Met","Met"]}]}'),Wxe=JSON.parse('{"$schema":"https://vega.github.io/schema/vega/v5.json","description":"Modern Slavery Supply Chain Policies","width":250,"height":220,"padding":10,"signals":[{"name":"hoverValue","value":null,"on":[{"events":"arc:mouseover, @legendLabel:mouseover, @legendSymbol:mouseover","update":"datum.value"},{"events":"arc:mouseout, @legendLabel:mouseout, @legendSymbol:mouseout","update":"null"}]},{"name":"hoverOpacity","update":"if(hoverValue, 0.5, 1)","value":1}],"data":[{"name":"counts","source":"answers","transform":[{"type":"aggregate","groupby":["value"],"ops":["count"],"fields":["count"],"as":["count"]},{"type":"pie","field":"count","sort":false},{"type":"formula","as":"filter","expr":"{ value: [datum.value] }"},{"type":"window","ops":["sum"],"fields":["count"],"frame":[null,null]},{"type":"formula","as":"percentage","expr":"format(datum.count / datum.sum_count, \'.0%\')"},{"type":"collect","sort":{"field":"value"}},{"type":"formula","expr":"datum.count + \' out of \' + datum.sum_count + \' statements\'","as":"count_label"}]}],"marks":[{"type":"arc","from":{"data":"counts"},"encode":{"enter":{"fill":{"scale":"color","field":"value"},"x":{"value":100},"y":{"value":100},"tooltip":{"field":"count_label"}},"update":{"startAngle":{"field":"startAngle"},"endAngle":{"field":"endAngle"},"padAngle":{"value":0},"innerRadius":{"value":0},"outerRadius":{"value":120},"cornerRadius":{"value":0},"opacity":{"signal":"if(hoverValue == datum.value, 1, hoverOpacity)"}},"hover":{"opacity":{"value":1},"cursor":{"value":"pointer"}}}},{"type":"text","from":{"data":"counts"},"encode":{"enter":{"x":{"value":100},"y":{"value":100},"radius":{"value":50},"fontWeight":{"value":"bold"},"fontSize":{"value":15},"theta":{"signal":"(datum.startAngle + datum.endAngle)/2"},"fill":{"value":"white"},"align":{"value":"center"},"baseline":{"value":"middle"},"text":{"field":"percentage"}}}}],"legends":[{"fill":"color","type":"symbol","encode":{"labels":{"name":"legendLabel","interactive":true,"update":{"fontSize":{"value":13},"fontWeight":[{"test":"hoverValue == datum.label","value":"bold"},{"value":400}]}},"symbols":{"name":"legendSymbol","interactive":true}}}],"scales":[{"name":"color","type":"ordinal","range":["#000028","#FF9300"],"domain":["direct","beyond tier 1"]}]}'),Yxe=JSON.parse('{"$schema":"https://vega.github.io/schema/vega/v5.json","description":"Risk assessment tool and risks identified","width":250,"height":180,"signals":[{"name":"colors","value":{"orange":"#FF9300","purple":"#932191","orange_purple":"#ad3d6f","dark_orange":"#c7594b","deep_orange":"#e17327"}},{"name":"hoverValue","value":null,"on":[{"events":"arc:mouseover, @legendLabel:mouseover, @legendSymbol:mouseover","update":"datum.value"},{"events":"arc:mouseout, @legendLabel:mouseout, @legendSymbol:mouseout","update":"null"}]},{"name":"hoverOpacity","update":"if(hoverValue, 0.5, 1)","value":1}],"data":[{"name":"groups","values":[{"name":"Performs assessment and identifies risks"},{"name":"Performs assessment but does not identify risks"},{"name":"Does not perform assessment but identifies risks"},{"name":"Does not perform assessment or identify risks"}],"transform":[{"type":"window","ops":["row_number"],"as":["seq"]}]},{"name":"counts","source":"answers","transform":[{"type":"aggregate","groupby":["value"],"ops":["count"],"fields":["count"],"as":["count"]},{"type":"lookup","from":"groups","key":"name","fields":["value"],"values":["seq"]},{"type":"collect","sort":{"field":"seq"}},{"type":"pie","field":"count","sort":false},{"type":"formula","as":"filter","expr":"{ value: [datum.value] }"},{"type":"window","ops":["sum"],"fields":["count"],"frame":[null,null]},{"type":"formula","as":"percentage","expr":"format(datum.count / datum.sum_count, \'.0%\')"},{"type":"formula","expr":"datum.count + \' out of \' + datum.sum_count + \' statements\'","as":"count_label"},{"type":"formula","as":"filter","expr":"{ value: [datum.value] }"}]}],"marks":[{"type":"arc","from":{"data":"counts"},"encode":{"enter":{"fill":{"scale":"color","field":"value"},"x":{"value":125},"y":{"value":100},"tooltip":{"field":"count_label"}},"update":{"startAngle":{"field":"startAngle"},"endAngle":{"field":"endAngle"},"padAngle":{"value":0},"innerRadius":{"value":0},"outerRadius":{"value":100},"cornerRadius":{"value":0},"opacity":{"signal":"if(hoverValue == datum.value, 1, hoverOpacity)"}},"hover":{"opacity":{"value":1},"cursor":{"value":"pointer"}}}},{"type":"text","from":{"data":"counts"},"encode":{"enter":{"x":{"value":125},"y":{"value":100},"radius":{"value":50},"theta":{"signal":"(datum.startAngle + datum.endAngle)/2"},"fill":{"value":"white"},"fontWeight":{"value":"bold"},"fontSize":{"value":15},"align":{"value":"center"},"baseline":{"value":"middle"},"text":{"field":"percentage"}}}}],"legends":[{"fill":"color","type":"symbol","orient":"top","encode":{"labels":{"name":"legendLabel","interactive":true,"update":{"limit":{"value":0},"fontSize":{"value":12},"fontWeight":[{"test":"hoverValue == datum.label","value":"bold"},{"value":400}]}},"symbols":{"name":"legendSymbol","interactive":true}}}],"scales":[{"name":"color","type":"ordinal","range":{"signal":"[colors.orange, colors.deep_orange, colors.orange_purple, colors.purple]"},"domain":{"signal":"pluck(data(\'groups\'), \'name\')"}}]}'),Rq=JSON.parse('{"$schema":"https://vega.github.io/schema/vega/v5.json","description":"A nested bar chart example, with bars grouped by category.","width":350,"height":200,"signals":[{"name":"barHeight","value":"15"},{"name":"colors","value":{"orange":"#FF9300","red":"#FE0000","blue":"#4169e1","navy":"#000028","yellow":"#FFDC00"}},{"name":"barTitle","value":null,"on":[{"events":"rect:mouseover, text:mouseover","update":"datum.title"},{"events":"rect:mouseout, text:mouseout","update":"null"}]}],"data":[{"name":"assessed","url":"https://wikirate.org/~12602618+Answer.json?limit=0&filter[value]=Yes&filter[year]=latest&view=answer_list"},{"name":"signed","url":"https://wikirate.org/Business_Human_Rights_Resource_Centre+MSA_statement_signed_binary+answer/answer_list.json?limit=0&filter[status]=known&filter[year]=latest","transform":[{"type":"lookup","from":"assessed","key":"company","fields":["company"],"values":["value"],"as":["assessed"]},{"type":"filter","expr":"datum.assessed == \'Yes\'"},{"type":"aggregate","groupby":["value"]},{"type":"impute","key":"value","keyvals":["Yes"],"field":"count","value":0},{"type":"joinaggregate","fields":["count"],"ops":["sum"]},{"type":"filter","expr":"datum.value == \'Yes\'"}]},{"name":"approved","url":"https://wikirate.org/Business_Human_Rights_Resource_Centre+MSA_Statement_Approval+answer/answer_list.json?limit=0&filter[year]=latest","transform":[{"type":"lookup","from":"assessed","key":"company","fields":["company"],"values":["value"],"as":["assessed"]},{"type":"filter","expr":"datum.assessed == \'Yes\'"},{"type":"aggregate","groupby":["value"]},{"type":"impute","key":"value","keyvals":["Approved by Board"],"field":"count","value":0},{"type":"joinaggregate","fields":["count"],"ops":["sum"]},{"type":"filter","expr":"datum.value == \'Approved by Board\'"}]},{"name":"homepage","url":"https://wikirate.org/Business_Human_Rights_Resource_Centre+MSA_homepage_link_archived+answer/answer_list.json?limit=0&filter[year]=latest","transform":[{"type":"lookup","from":"assessed","key":"company","fields":["company"],"values":["value"],"as":["assessed"]},{"type":"filter","expr":"datum.assessed == \'Yes\'"},{"type":"aggregate","groupby":["value"]},{"type":"impute","key":"value","keyvals":["Yes"],"field":"count","value":0},{"type":"joinaggregate","fields":["count"],"ops":["sum"]},{"type":"filter","expr":"datum.value == \'Yes\'"}]},{"name":"all","url":"https://wikirate.org/Walk_Free+Meets_Minimum_UK_MSA_Requirements+answer/answer_list.json?limit=0&filter[company_group][]=MSA_Asset_Managers&filter[year]=latest","transform":[{"type":"aggregate","groupby":["value"]},{"type":"impute","key":"value","keyvals":["Yes"],"field":"count","value":0},{"type":"joinaggregate","fields":["count"],"ops":["sum"]},{"type":"filter","expr":"datum.value == \'Yes\'"}]},{"name":"metrics","values":[{"seq":1,"metric":"Business_Human_Rights_Resource_Centre+MSA_statement_signed","label":"Signed by Appropriate Person","short_label":"signed","color":0,"filter_value":["Signed by CEO","Signed by Director","Signed by Managing Director","Signed by Chairman"]},{"seq":2,"metric":"Business_Human_Rights_Resource_Centre+MSA_Statement_Approval","label":"Board Approval","short_label":"approved","color":0,"filter_value":["Approved by Board"]},{"seq":3,"metric":"Walk_Free+MSA_statement_homepage_link","label":"Homepage Link","short_label":"homepage","color":0,"filter_value":["Yes"]}]},{"name":"counts","source":["signed","approved","homepage"],"transform":[{"type":"window","ops":["row_number"],"as":["seq"]},{"type":"lookup","from":"metrics","key":"seq","fields":["seq"],"values":["label","metric","color","filter_value"],"as":["title","wikirate_page","color","filter_value"]},{"type":"formula","expr":"datum.count/datum.sum_count","as":"percentage"},{"type":"formula","expr":"format(datum.count / datum.sum_count, \'.0%\')","as":"percent_label"},{"type":"formula","expr":"datum.count + \' out of \' + datum.sum_count + \' statements\'","as":"count_label"},{"type":"formula","expr":"{ value: datum.filter_value }","as":"filter"}]}],"scales":[{"name":"xscale","domain":[0,1],"zero":true,"type":"linear","range":"width"},{"name":"yscale","range":"height","domain":{"data":"counts","field":"title"},"type":"band","padding":0.4},{"name":"color","type":"linear","domain":[0,3],"range":{"signal":"[colors.orange, colors.yellow, colors.navy, colors.blue]"}}],"marks":[{"type":"rect","from":{"data":"counts"},"encode":{"update":{"x":{"value":0},"x2":{"scale":"xscale","value":1},"y":{"scale":"yscale","field":"title"},"height":{"signal":"barHeight"},"fill":{"signal":"colors.navy"},"tooltip":{"field":"count_label"},"opacity":{"signal":"if(barTitle == datum.title, 0.5, 1)"}},"hover":{"cursor":{"value":"pointer"}}}},{"type":"rect","from":{"data":"counts"},"encode":{"update":{"x":{"value":0},"x2":{"scale":"xscale","field":"percentage"},"y":{"scale":"yscale","field":"title"},"height":{"signal":"barHeight"},"fill":{"scale":"color","field":"color"},"tooltip":{"field":"count_label"}},"hover":{"cursor":{"value":"pointer"}}}},{"type":"text","from":{"data":"counts"},"encode":{"update":{"fontSize":{"value":15},"font":{"value":"GothamNarrow"},"x":{"scale":"xscale","value":1},"y":{"scale":"yscale","field":"title","offset":-3},"baseline":{"value":"bottom"},"align":{"value":"right"},"text":{"field":"percent_label"},"fontWeight":{"value":"bold"},"fill":{"scale":"color","signal":"if(barTitle == datum.title, datum.color, 2)"}},"hover":{"cursor":{"value":"pointer"}}}},{"type":"text","from":{"data":"counts"},"encode":{"update":{"fontSize":{"value":15},"font":{"value":"GothamNarrow"},"x":{"value":0},"y":{"scale":"yscale","field":"title","offset":-3},"text":{"field":"title"},"baseline":{"value":"bottom"},"fontWeight":{"value":"bold"},"fill":{"signal":"colors.navy"}},"hover":{"cursor":{"value":"pointer"}}}}]}'),Kxe=JSON.parse('{"$schema":"https://vega.github.io/schema/vega/v5.json","description":"Risk Management","width":300,"padding":{"right":5},"signals":[{"name":"totalAnswers","update":"data(\'answers\').length"},{"name":"numGroups","update":"data(\'groups\').length"},{"name":"barHeight","value":15},{"name":"height","update":"numGroups * (barHeight + 15)+ 200"},{"name":"colors","value":{"orange":"#FF9300","red":"#FE0000","blue":"#0037F1","navy":"#000028","yellow":"#FFDC00","orange_purple":"#c7594b"}},{"name":"barOver","value":{},"on":[{"events":"rect:mouseover, text:mouseover","update":"datum"},{"events":"rect:mouseout, text:mouseout","update":"{}"}]}],"data":[{"name":"assessed","url":"https://wikirate.org/Walk_Free+UK_MSA_statement_assessed+Answer.json?filter%5Bnot_ids%5D=&filter%5Bcompany_name%5D=&view=answer_list&filter[value][]=Yes&limit=0&filter[year]=latest"},{"name":"answers","url":"https://wikirate.org/Walk_Free+MSA_risk_management_revised+answer/answer_list.json?limit=0&filter[year]=latest","transform":[{"type":"lookup","from":"assessed","key":"company","fields":["company"],"values":["value"],"as":["assessed"]},{"type":"filter","expr":"datum.value != \'\' && datum.assessed == \'Yes\'"},{"type":"formula","expr":"split(datum.value, \', \')","as":"value_array"}]},{"name":"subgroups","values":[{"key":"(self- reporting)","label":"Self reporting","color":0,"seq":1},{"key":"(independent)","label":"Independent","color":1,"seq":2}],"transform":[{"type":"window","ops":["row_number"],"as":["seq"]}]},{"name":"groups","values":[{"title":"Audits of suppliers","term":"Audits of suppliers","seq":1},{"title":"On-site visits","term":"On-site visits","seq":2}],"transform":[{"type":"window","ops":["row_number"],"as":["seq"]}]},{"name":"counts","source":"answers","transform":[{"type":"flatten","fields":["value_array"],"as":["value"]},{"type":"aggregate","ops":["count"],"groupby":["value"]},{"type":"formula","as":"term","expr":"replace(datum.value, / \\\\(.*/, \'\')"},{"type":"formula","as":"parens","expr":"replace(datum.value, /^[^\\\\(]*/, \'\')"},{"type":"formula","expr":"if(datum.count, datum.count, 0)","as":"count"},{"type":"lookup","from":"groups","key":"term","fields":["term"],"values":["seq"],"as":["group_seq"]},{"type":"filter","expr":"datum.group_seq != null"},{"type":"lookup","from":"subgroups","key":"key","fields":["parens"],"values":["seq","label","color"],"as":["subgroup_seq","subgroup_label","color"]},{"type":"collect","sort":{"field":["group_seq","subgroup_seq"]}},{"type":"formula","expr":"datum.count + \' out of \' + totalAnswers + \' statements\'","as":"count_label"},{"type":"formula","expr":"format(datum.count / totalAnswers, \'.0%\')","as":"percent_label"},{"type":"formula","expr":"datum.term + \' \' + datum.parens","as":"title"},{"type":"formula","as":"filter","expr":"{ value: [datum.value] }"}]}],"scales":[{"name":"xscale","domain":[0,{"signal":"totalAnswers"}],"zero":true,"type":"linear","range":"width"},{"name":"ygroupscale","range":"height","domain":{"data":"counts","field":"term"},"type":"band","padding":0.4},{"name":"color","type":"ordinal","domain":{"data":"counts","field":"subgroup_label"},"range":{"signal":"[colors.orange, colors.orange_purple, colors.yellow, colors.navy]"}},{"name":"textColor","type":"linear","domain":[0,3],"range":{"signal":"[colors.orange, colors.orange_purple, colors.yellow, colors.navy]"}}],"marks":[{"type":"group","from":{"facet":{"name":"faceted_counts","groupby":"term","data":"counts"}},"encode":{"enter":{"fill":{"value":"grey"},"y":{"scale":"ygroupscale","field":"term"}}},"scales":[{"name":"yscale","type":"band","range":"height","domain":{"data":"faceted_counts","field":"title"},"padding":0.1}],"signals":[{"name":"height","update":"bandwidth(\'ygroupscale\')"}],"marks":[{"type":"rect","from":{"data":"faceted_counts"},"encode":{"update":{"x":{"value":0},"x2":{"scale":"xscale","signal":"totalAnswers"},"y":{"scale":"yscale","field":"title"},"height":{"signal":"barHeight"},"fill":{"signal":"colors.navy"},"tooltip":{"field":"count_label"},"opacity":{"signal":"if(barOver.title == datum.title, 0.5, 1)"}},"hover":{"cursor":{"value":"pointer"}}}},{"type":"rect","from":{"data":"faceted_counts"},"encode":{"update":{"x":{"value":0},"x2":{"scale":"xscale","field":"count"},"y":{"scale":"yscale","field":"title"},"height":{"signal":"barHeight"},"fill":{"scale":"textColor","field":"color"},"tooltip":{"field":"percent_label"}},"hover":{"cursor":{"value":"pointer"}}}},{"name":"nocounts","type":"text","from":{"data":"faceted_counts"},"encode":{"update":{"x":{"value":5},"y":{"scale":"yscale","field":"title","offset":2},"baseline":{"value":"top"},"text":{"signal":"if(datum.count == 0, \'None\', \'\')"},"fill":{"value":"white"},"fontStyle":{"value":"italic"}}}},{"type":"text","from":{"data":"faceted_counts"},"encode":{"update":{"fontSize":{"value":15},"font":{"value":"GothamNarrow"},"x":{"scale":"xscale","signal":"totalAnswers","offset":4},"y":{"scale":"yscale","field":"title","offset":2},"baseline":{"value":"top"},"text":{"field":"percent_label"},"fontWeight":{"value":"bold"},"fill":{"scale":"textColor","signal":"if(barOver.title == datum.title, datum.color, 3)"}},"hover":{"cursor":{"value":"pointer"}}}}]},{"type":"text","from":{"data":"groups"},"encode":{"update":{"fontSize":{"value":15},"font":{"value":"GothamNarrow"},"x":{"value":0},"y":{"scale":"ygroupscale","field":"term","offset":-2},"text":{"field":"title"},"baseline":{"value":"bottom"},"fontWeight":{"value":"bold"},"fill":{"signal":"colors.navy"}}}}],"legends":[{"fill":"color","type":"symbol","orient":"none","direction":"horizontal","columnPadding":20,"rowPadding":20,"labelFontSize":{"value":25},"encode":{"legend":{"update":{"fontSize":{"value":13},"x":{"value":0},"y":{"offset":-10}}},"labels":{"update":{"fontSize":{"value":13}}}}}]}'),Jxe=JSON.parse('{"$schema":"https://vega.github.io/schema/vega/v5.json","description":"An example of treemap layout for hierarchical data.","width":960,"height":500,"padding":2.5,"autosize":"none","data":[{"name":"tree","values":[],"transform":[{"type":"stratify","key":"id","parentKey":"parent"},{"type":"treemap","field":"size","sort":{"field":"value"},"round":true,"method":"squarify","ratio":5,"size":[{"signal":"width"},{"signal":"height"}]}]},{"name":"nodes","source":"tree","transform":[{"type":"filter","expr":"datum.children"},{"type":"lookup","from":"tree","key":"id","fields":["id"],"values":["alt_name"],"as":["alt_name"]}]},{"name":"leaves","source":"tree","transform":[{"type":"filter","expr":"!datum.children"},{"type":"lookup","from":"tree","key":"id","fields":["parent"],"values":["name"],"as":["parent_name"]}]}],"scales":[{"name":"color","type":"ordinal","domain":{"data":"nodes","field":"alt_name"},"range":["#FF9300","#7f7f93","#ffc97f","#DDDDE3"]},{"name":"size","type":"ordinal","domain":[0,1,2,3],"range":[150,28,0,9]},{"name":"opacity","type":"ordinal","domain":[0,1,2,3],"range":[0.15,0.5,0.8,1]}],"marks":[{"type":"rect","from":{"data":"nodes"},"interactive":false,"encode":{"enter":{"fill":{"scale":"color","field":"name"}},"update":{"x":{"field":"x0"},"y":{"field":"y0"},"x2":{"field":"x1"},"y2":{"field":"y1"}}}},{"type":"rect","from":{"data":"leaves"},"encode":{"enter":{"stroke":{"value":"#fff"}},"update":{"x":{"field":"x0"},"y":{"field":"y0"},"x2":{"field":"x1"},"y2":{"field":"y1"},"fill":{"value":"transparent"},"tooltip":{"signal":"{\'title\': datum.name, \'Turnover Range\': datum.parent_name,\'No. of statements\': datum.size}"}},"hover":{"fill":{"value":"yellow"}}}},{"type":"text","from":{"data":"nodes"},"interactive":false,"encode":{"enter":{"font":{"value":"GothamNarrow"},"align":{"value":"center"},"baseline":{"value":"middle"},"fill":{"value":"#000"},"text":{"field":"name"},"fontSize":{"scale":"size","field":"depth"},"fillOpacity":{"scale":"opacity","field":"depth"}},"update":{"x":{"signal":"0.5 * (datum.x0 + datum.x1)"},"y":{"signal":"0.5 * (datum.y0 + datum.y1)"}}}}]}'),Xxe=JSON.parse('{"$schema":"https://vega.github.io/schema/vega/v5.json","description":"An example of treemap layout for hierarchical data.","width":960,"height":500,"padding":2.5,"autosize":"none","data":[{"name":"tree","values":[],"transform":[{"type":"stratify","key":"id","parentKey":"parent"},{"type":"treemap","field":"size","sort":{"field":"value"},"round":true,"method":"binary","ratio":1.6,"size":[{"signal":"width"},{"signal":"height"}]}]},{"name":"nodes","source":"tree","transform":[{"type":"filter","expr":"datum.children"}]},{"name":"leaves","source":"tree","transform":[{"type":"filter","expr":"!datum.children"}]}],"scales":[{"name":"color","type":"ordinal","domain":{"data":"nodes","field":"name"},"range":["#FF9300","#7f7f93","#ffc97f","#DDDDE3"]},{"name":"size","type":"ordinal","domain":[0,1,2,3],"range":[150,28,20,14]},{"name":"opacity","type":"ordinal","domain":[0,1,2,3],"range":[0.15,0.5,0.8,1]}],"marks":[{"type":"rect","from":{"data":"nodes"},"interactive":false,"encode":{"enter":{"fill":{"scale":"color","field":"name"}},"update":{"x":{"field":"x0"},"y":{"field":"y0"},"x2":{"field":"x1"},"y2":{"field":"y1"}}}},{"type":"rect","from":{"data":"leaves"},"encode":{"enter":{"stroke":{"value":"#fff"}},"update":{"x":{"field":"x0"},"y":{"field":"y0"},"x2":{"field":"x1"},"y2":{"field":"y1"},"fill":{"value":"transparent"},"tooltip":{"signal":"{\'title\': datum.name,\'No. of statements\': datum.size}"}},"hover":{"fill":{"value":"yellow"}}}},{"type":"text","from":{"data":"nodes"},"interactive":false,"encode":{"enter":{"font":{"value":"GothamNarrow"},"align":{"value":"center"},"baseline":{"value":"middle"},"fill":{"value":"#000"},"text":{"field":"name"},"fontSize":{"scale":"size","field":"depth"},"fillOpacity":{"scale":"opacity","field":"depth"}},"update":{"x":{"signal":"0.5 * (datum.x0 + datum.x1)"},"y":{"signal":"0.5 * (datum.y0 + datum.y1)"}}}}]}');var e,Qxe=(e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])})(t,n)},function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Zxe=Object.prototype.hasOwnProperty;function eD(e,t){return Zxe.call(e,t)}function gN(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var i=[];for(var r in e)eD(e,r)&&i.push(r);return i}function qs(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function mN(e){for(var i,t=0,n=e.length;t<n;){if(!((i=e.charCodeAt(t))>=48&&i<=57))return!1;t++}return!0}function Pu(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function Fq(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function _N(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(_N(e[t]))return!0}else if("object"==typeof e)for(var i=gN(e),r=i.length,s=0;s<r;s++)if(_N(e[i[s]]))return!0;return!1}function Lq(e,t){var n=[e];for(var i in t){var r="object"==typeof t[i]?JSON.stringify(t[i],null,2):t[i];void 0!==r&&n.push(i+": "+r)}return n.join("\n")}var jq=function(e){function t(n,i,r,s,o){var a=this.constructor,l=e.call(this,Lq(n,{name:i,index:r,operation:s,tree:o}))||this;return l.name=i,l.index=r,l.operation=s,l.tree=o,Object.setPrototypeOf(l,a.prototype),l.message=Lq(n,{name:i,index:r,operation:s,tree:o}),l}return Qxe(t,e),t}(Error),zn=jq,eAe=qs,Ag={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=tD(n,this.path);i&&(i=qs(i));var r=qf(n,{op:"remove",path:this.from}).removed;return qf(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=tD(n,this.from);return qf(n,{op:"add",path:this.path,value:qs(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:K_(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},tAe={add:function(e,t,n){return mN(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:Ag.move,copy:Ag.copy,test:Ag.test,_get:Ag._get};function tD(e,t){if(""==t)return e;var n={op:"_get",path:t};return qf(e,n),n.value}function qf(e,t,n,i,r,s){if(void 0===n&&(n=!1),void 0===i&&(i=!0),void 0===r&&(r=!0),void 0===s&&(s=0),n&&("function"==typeof n?n(t,0,e,t.path):iD(t,0)),""===t.path){var o={newDocument:e};if("add"===t.op)return o.newDocument=t.value,o;if("replace"===t.op)return o.newDocument=t.value,o.removed=e,o;if("move"===t.op||"copy"===t.op)return o.newDocument=tD(e,t.from),"move"===t.op&&(o.removed=e),o;if("test"===t.op){if(o.test=K_(e,t.value),!1===o.test)throw new zn("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o.newDocument=e,o}if("remove"===t.op)return o.removed=e,o.newDocument=null,o;if("_get"===t.op)return t.value=e,o;if(n)throw new zn("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,t,e);return o}i||(e=qs(e));var l=(t.path||"").split("/"),u=e,c=1,d=l.length,f=void 0,h=void 0,p=void 0;for(p="function"==typeof n?n:iD;;){if((h=l[c])&&-1!=h.indexOf("~")&&(h=Fq(h)),r&&("__proto__"==h||"prototype"==h&&c>0&&"constructor"==l[c-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===f&&(void 0===u[h]?f=l.slice(0,c).join("/"):c==d-1&&(f=t.path),void 0!==f&&p(t,0,e,f)),c++,Array.isArray(u)){if("-"===h)h=u.length;else{if(n&&!mN(h))throw new zn("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,t,e);mN(h)&&(h=~~h)}if(c>=d){if(n&&"add"===t.op&&h>u.length)throw new zn("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,t,e);if(!1===(o=tAe[t.op].call(t,u,h,e)).test)throw new zn("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}}else if(c>=d){if(!1===(o=Ag[t.op].call(t,u,h,e)).test)throw new zn("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}if(u=u[h],n&&c<d&&(!u||"object"!=typeof u))throw new zn("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,t,e)}}function nD(e,t,n,i,r){if(void 0===i&&(i=!0),void 0===r&&(r=!0),n&&!Array.isArray(t))throw new zn("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=qs(e));for(var s=new Array(t.length),o=0,a=t.length;o<a;o++)s[o]=qf(e,t[o],n,!0,r,o),e=s[o].newDocument;return s.newDocument=e,s}function nAe(e,t,n){var i=qf(e,t);if(!1===i.test)throw new zn("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function iD(e,t,n,i){if("object"!=typeof e||null===e||Array.isArray(e))throw new zn("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!Ag[e.op])throw new zn("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!=typeof e.path)throw new zn("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new zn('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new zn("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new zn("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&_N(e.value))throw new zn("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var r=e.path.split("/").length,s=i.split("/").length;if(r!==s+1&&r!==s)throw new zn("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==i)throw new zn("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var a=Bq([{op:"_get",path:e.from,value:void 0}],n);if(a&&"OPERATION_PATH_UNRESOLVABLE"===a.name)throw new zn("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function Bq(e,t,n){try{if(!Array.isArray(e))throw new zn("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)nD(qs(t),qs(e),n||!0);else{n=n||iD;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(r){if(r instanceof zn)return r;throw r}}function K_(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var r,s,o,n=Array.isArray(e),i=Array.isArray(t);if(n&&i){if((s=e.length)!=t.length)return!1;for(r=s;0!=r--;)if(!K_(e[r],t[r]))return!1;return!0}if(n!=i)return!1;var a=Object.keys(e);if((s=a.length)!==Object.keys(t).length)return!1;for(r=s;0!=r--;)if(!t.hasOwnProperty(a[r]))return!1;for(r=s;0!=r--;)if(!K_(e[o=a[r]],t[o]))return!1;return!0}return e!=e&&t!=t}var yN=new WeakMap,iAe=function e(t){this.observers=new Map,this.obj=t},rAe=function e(t,n){this.callback=t,this.observer=n};function lAe(e,t){t.unobserve()}function uAe(e,t){var i,r=function sAe(e){return yN.get(e)}(e);if(r){var s=function oAe(e,t){return e.observers.get(t)}(r,t);i=s&&s.observer}else r=new iAe(e),yN.set(e,r);if(i)return i;if(i={},r.value=qs(e),t){i.callback=t,i.next=null;var o=function(){vN(i)},a=function(){clearTimeout(i.next),i.next=setTimeout(o)};"undefined"!=typeof window&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return i.patches=[],i.object=e,i.unobserve=function(){vN(i),clearTimeout(i.next),function aAe(e,t){e.observers.delete(t.callback)}(r,i),"undefined"!=typeof window&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},r.observers.set(t,new rAe(t,i)),i}function vN(e,t){void 0===t&&(t=!1);var n=yN.get(e.object);bN(n.value,e.object,e.patches,"",t),e.patches.length&&nD(n.value,e.patches);var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function bN(e,t,n,i,r){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var s=gN(t),o=gN(e),l=!1,u=o.length-1;u>=0;u--){var d=e[c=o[u]];if(!eD(t,c)||void 0===t[c]&&void 0!==d&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:"test",path:i+"/"+Pu(c),value:qs(d)}),n.push({op:"remove",path:i+"/"+Pu(c)}),l=!0):(r&&n.push({op:"test",path:i,value:e}),n.push({op:"replace",path:i,value:t}));else{var f=t[c];"object"==typeof d&&null!=d&&"object"==typeof f&&null!=f&&Array.isArray(d)===Array.isArray(f)?bN(d,f,n,i+"/"+Pu(c),r):d!==f&&(r&&n.push({op:"test",path:i+"/"+Pu(c),value:qs(d)}),n.push({op:"replace",path:i+"/"+Pu(c),value:qs(f)}))}}if(l||s.length!=o.length)for(u=0;u<s.length;u++){var c;!eD(e,c=s[u])&&void 0!==t[c]&&n.push({op:"add",path:i+"/"+Pu(c),value:qs(t[c])})}}}function cAe(e,t,n){void 0===n&&(n=!1);var i=[];return bN(e,t,i,"",n),i}Object.assign({},Bt,Jt,{JsonPatchError:jq,deepClone:qs,escapePathComponent:Pu,unescapePathComponent:Fq});var dAe=de(564),wN=de.n(dAe);function as(e,t,n){return e.fields=t||[],e.fname=n,e}function qn(e){return null==e?null:e.fname}function fr(e){return null==e?null:e.fields}function $q(e){return 1===e.length?fAe(e[0]):hAe(e)}const fAe=e=>function(t){return t[e]},hAe=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function ee(e){throw Error(e)}function bl(e){const t=[],n=e.length;let o,a,l,i=null,r=0,s="";function u(){t.push(s+e.substring(o,a)),s="",o=a+1}for(e+="",o=a=0;a<n;++a)if(l=e[a],"\\"===l)s+=e.substring(o,a),s+=e.substring(++a,++a),o=a;else if(l===i)u(),i=null,r=-1;else{if(i)continue;o===r&&'"'===l||o===r&&"'"===l?(o=a+1,i=l):"."!==l||r?"["===l?(a>o&&u(),r=o=a+1):"]"===l&&(r||ee("Access path missing open bracket: "+e),r>0&&u(),r=0,o=a+1):a>o?u():o=a+1}return r&&ee("Access path missing closing bracket: "+e),i&&ee("Access path missing closing quote: "+e),a>o&&(a++,u()),t}function ls(e,t,n){const i=bl(e);return e=1===i.length?i[0]:e,as((n&&n.get||$q)(i),[e],t||e)}const J_=ls("id"),hr=as(e=>e,[],"identity"),Vc=as(()=>0,[],"zero"),Mg=as(()=>1,[],"one"),Oo=as(()=>!0,[],"true"),Hc=as(()=>!1,[],"false");function pAe(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const Vq=0,DN=1,CN=2,Hq=3,Uq=4;function EN(e,t,n=pAe){let i=e||Vq;return{level(r){return arguments.length?(i=+r,this):i},error(){return i>=DN&&n(t||"error","ERROR",arguments),this},warn(){return i>=CN&&n(t||"warn","WARN",arguments),this},info(){return i>=Hq&&n(t||"log","INFO",arguments),this},debug(){return i>=Uq&&n(t||"log","DEBUG",arguments),this}}}var ne=Array.isArray;function Se(e){return e===Object(e)}const zq=e=>"__proto__"!==e;function Tg(...e){return e.reduce((t,n)=>{for(const i in n)"signals"===i?t.signals=gAe(t.signals,n.signals):Og(t,i,n[i],"legend"===i?{layout:1}:"style"===i||null);return t},{})}function Og(e,t,n,i){if(!zq(t))return;let r,s;if(Se(n)&&!ne(n))for(r in s=Se(e[t])?e[t]:e[t]={},n)i&&(!0===i||i[r])?Og(s,r,n[r]):zq(r)&&(s[r]=n[r]);else e[t]=n}function gAe(e,t){if(null==e)return t;const n={},i=[];function r(s){n[s.name]||(n[s.name]=1,i.push(s))}return t.forEach(r),e.forEach(r),i}function bt(e){return e[e.length-1]}function pr(e){return null==e||""===e?null:+e}const qq=e=>t=>e*Math.exp(t),Gq=e=>t=>Math.log(e*t),Wq=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),Yq=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,rD=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function sD(e,t,n,i){const r=n(e[0]),s=n(bt(e)),o=(s-r)*t;return[i(r-o),i(s-o)]}function Kq(e,t){return sD(e,t,pr,hr)}function Jq(e,t){var n=Math.sign(e[0]);return sD(e,t,Gq(n),qq(n))}function Xq(e,t,n){return sD(e,t,rD(n),rD(1/n))}function Qq(e,t,n){return sD(e,t,Wq(n),Yq(n))}function oD(e,t,n,i,r){const s=i(e[0]),o=i(bt(e)),a=null!=t?i(t):(s+o)/2;return[r(a+(s-a)*n),r(a+(o-a)*n)]}function SN(e,t,n){return oD(e,t,n,pr,hr)}function xN(e,t,n){const i=Math.sign(e[0]);return oD(e,t,n,Gq(i),qq(i))}function aD(e,t,n,i){return oD(e,t,n,rD(i),rD(1/i))}function AN(e,t,n,i){return oD(e,t,n,Wq(i),Yq(i))}function Zq(e){return 1+~~(new Date(e).getMonth()/3)}function eG(e){return 1+~~(new Date(e).getUTCMonth()/3)}function we(e){return null!=e?ne(e)?e:[e]:[]}function tG(e,t,n){let s,i=e[0],r=e[1];return r<i&&(s=r,r=i,i=s),s=r-i,s>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-s),i+s]}function rt(e){return"function"==typeof e}function MN(e,t,n){n=n||{},t=we(t)||[];const i=[],r=[],s={},o=n.comparator||_Ae;return we(e).forEach((a,l)=>{null!=a&&(i.push("descending"===t[l]?-1:1),r.push(a=rt(a)?a:ls(a,null,n)),(fr(a)||[]).forEach(u=>s[u]=1))}),0===r.length?null:as(o(r,i),Object.keys(s))}const lD=(e,t)=>(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t==t?-1:t!=t&&e==e?1:0),_Ae=(e,t)=>1===e.length?yAe(e[0],t[0]):vAe(e,t,e.length),yAe=(e,t)=>function(n,i){return lD(e(n),e(i))*t},vAe=(e,t,n)=>(t.push(0),function(i,r){let s,o=0,a=-1;for(;0===o&&++a<n;)s=e[a],o=lD(s(i),s(r));return o*t[a]});function gr(e){return rt(e)?e:()=>e}function TN(e,t){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(t(i),n=null),e)}}function st(e){for(let t,n,i=1,r=arguments.length;i<r;++i)for(n in t=arguments[i],t)e[n]=t[n];return e}function wl(e,t){let i,r,s,o,n=0;if(e&&(i=e.length))if(null==t){for(r=e[n];n<i&&(null==r||r!=r);r=e[++n]);for(s=o=r;n<i;++n)r=e[n],null!=r&&(r<s&&(s=r),r>o&&(o=r))}else{for(r=t(e[n]);n<i&&(null==r||r!=r);r=t(e[++n]));for(s=o=r;n<i;++n)r=t(e[n]),null!=r&&(r<s&&(s=r),r>o&&(o=r))}return[s,o]}function nG(e,t){const n=e.length;let r,s,o,a,l,i=-1;if(null==t){for(;++i<n;)if(s=e[i],null!=s&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=l=i;++i<n;)s=e[i],null!=s&&(r>s&&(r=s,a=i),o<s&&(o=s,l=i))}else{for(;++i<n;)if(s=t(e[i],i,e),null!=s&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=l=i;++i<n;)s=t(e[i],i,e),null!=s&&(r>s&&(r=s,a=i),o<s&&(o=s,l=i))}return[a,l]}const bAe=Object.prototype.hasOwnProperty;function ke(e,t){return bAe.call(e,t)}const uD={};function Ng(e){let n,t={};function i(s){return ke(t,s)&&t[s]!==uD}const r={size:0,empty:0,object:t,has:i,get:s=>i(s)?t[s]:void 0,set(s,o){return i(s)||(++r.size,t[s]===uD&&--r.empty),t[s]=o,this},delete(s){return i(s)&&(--r.size,++r.empty,t[s]=uD),this},clear(){r.size=r.empty=0,r.object=t={}},test(s){return arguments.length?(n=s,r):n},clean(){const s={};let o=0;for(const a in t){const l=t[a];l!==uD&&(!n||!n(l))&&(s[a]=l,++o)}r.size=o,r.empty=0,r.object=t=s}};return e&&Object.keys(e).forEach(s=>{r.set(s,e[s])}),r}function iG(e,t,n,i,r,s){if(!n&&0!==n)return s;const o=+n;let u,a=e[0],l=bt(e);l<a&&(u=a,a=l,l=u),u=Math.abs(t-a);const c=Math.abs(l-t);return u<c&&u<=o?i:c<=o?r:s}function fe(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),st(i,n)}function kg(e,t,n,i){let o,r=t[0],s=t[t.length-1];return r>s&&(o=r,r=s,s=o),i=void 0===i||i,((n=void 0===n||n)?r<=e:r<e)&&(i?e<=s:e<s)}function Uc(e){return"boolean"==typeof e}function zc(e){return"[object Date]"===Object.prototype.toString.call(e)}function rG(e){return e&&rt(e[Symbol.iterator])}function en(e){return"number"==typeof e}function sG(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function be(e){return"string"==typeof e}function ON(e,t,n){e&&(e=t?we(e).map(a=>a.replace(/\\(.)/g,"$1")):we(e));const i=e&&e.length,r=n&&n.get||$q,s=a=>r(t?[a]:bl(a));let o;if(i)if(1===i){const a=s(e[0]);o=function(l){return""+a(l)}}else{const a=e.map(s);o=function(l){let u=""+a[0](l),c=0;for(;++c<i;)u+="|"+a[c](l);return u}}else o=function(){return""};return as(o,e,"key")}function oG(e,t){const n=e[0],i=bt(e),r=+t;return r?1===r?i:n+r*(i-n):n}function aG(e){let t,n,i;e=+e||1e4;const r=()=>{t={},n={},i=0},s=(o,a)=>(++i>e&&(n=t,t={},i=1),t[o]=a);return r(),{clear:r,has:o=>ke(t,o)||ke(n,o),get:o=>ke(t,o)?t[o]:ke(n,o)?s(o,n[o]):void 0,set:(o,a)=>ke(t,o)?t[o]=a:s(o,a)}}function lG(e,t,n,i){const r=t.length,s=n.length;if(!s)return t;if(!r)return n;const o=i||new t.constructor(r+s);let a=0,l=0,u=0;for(;a<r&&l<s;++u)o[u]=e(t[a],n[l])>0?n[l++]:t[a++];for(;a<r;++a,++u)o[u]=t[a];for(;l<s;++l,++u)o[u]=n[l];return o}function X_(e,t){let n="";for(;--t>=0;)n+=e;return n}function uG(e,t,n,i){const r=n||" ",s=e+"",o=t-s.length;return o<=0?s:"left"===i?X_(r,o)+s:"center"===i?X_(r,~~(o/2))+s+X_(r,Math.ceil(o/2)):s+X_(r,o)}function Q_(e){return e&&bt(e)-e[0]||0}function pe(e){return ne(e)?"["+e.map(pe)+"]":Se(e)||be(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function NN(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e||!e)}const DAe=e=>en(e)||zc(e)?e:Date.parse(e);function kN(e,t){return t=t||DAe,null==e||""===e?null:t(e)}function IN(e){return null==e||""===e?null:e+""}function va(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function cG(e,t,n,i){const r=null!=i?i:"\u2026",s=e+"",o=s.length,a=Math.max(0,t-r.length);return o<=t?s:"left"===n?r+s.slice(o-a):"center"===n?s.slice(0,Math.ceil(a/2))+r+s.slice(o-~~(a/2)):s.slice(0,a)+r}function qc(e,t,n){if(e)if(t){const i=e.length;for(let r=0;r<i;++r){const s=t(e[r]);s&&n(s,r,e)}}else e.forEach(n)}function dG(e,t,n,i,r,s,o){try{var a=e[s](o),l=a.value}catch(u){return void n(u)}a.done?t(l):Promise.resolve(l).then(i,r)}function Br(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var s=e.apply(t,n);function o(l){dG(s,i,r,o,a,"next",l)}function a(l){dG(s,i,r,o,a,"throw",l)}o(void 0)})}}var fG={},RN={};function hG(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function pG(e){var t=Object.create(null),n=[];return e.forEach(function(i){for(var r in i)r in t||n.push(t[r]=r)}),n}function us(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function xAe(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(d,f){var _,h=[],p=d.length,g=0,m=0,y=p<=0,v=!1;function b(){if(y)return RN;if(v)return v=!1,fG;var C,E,w=g;if(34===d.charCodeAt(w)){for(;g++<p&&34!==d.charCodeAt(g)||34===d.charCodeAt(++g););return(C=g)>=p?y=!0:10===(E=d.charCodeAt(g++))?v=!0:13===E&&(v=!0,10===d.charCodeAt(g)&&++g),d.slice(w+1,C-1).replace(/""/g,'"')}for(;g<p;){if(10===(E=d.charCodeAt(C=g++)))v=!0;else if(13===E)v=!0,10===d.charCodeAt(g)&&++g;else if(E!==n)continue;return d.slice(w,C)}return y=!0,d.slice(w,p)}for(10===d.charCodeAt(p-1)&&--p,13===d.charCodeAt(p-1)&&--p;(_=b())!==RN;){for(var D=[];_!==fG&&_!==RN;)D.push(_),_=b();f&&null==(D=f(D,m++))||h.push(D)}return h}function s(d,f){return d.map(function(h){return f.map(function(p){return c(h[p])}).join(e)})}function u(d){return d.map(c).join(e)}function c(d){return null==d?"":d instanceof Date?function SAe(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":function EAe(e){return e<0?"-"+us(-e,6):e>9999?"+"+us(e,6):us(e,4)}(e.getUTCFullYear())+"-"+us(e.getUTCMonth()+1,2)+"-"+us(e.getUTCDate(),2)+(r?"T"+us(t,2)+":"+us(n,2)+":"+us(i,2)+"."+us(r,3)+"Z":i?"T"+us(t,2)+":"+us(n,2)+":"+us(i,2)+"Z":n||t?"T"+us(t,2)+":"+us(n,2)+"Z":"")}(d):t.test(d+="")?'"'+d.replace(/"/g,'""')+'"':d}return{parse:function i(d,f){var h,p,g=r(d,function(m,_){if(h)return h(m,_-1);p=m,h=f?function CAe(e,t){var n=hG(e);return function(i,r){return t(n(i),r,e)}}(m,f):hG(m)});return g.columns=p||[],g},parseRows:r,format:function o(d,f){return null==f&&(f=pG(d)),[f.map(c).join(e)].concat(s(d,f)).join("\n")},formatBody:function a(d,f){return null==f&&(f=pG(d)),s(d,f).join("\n")},formatRows:function l(d){return d.map(u).join("\n")},formatRow:u,formatValue:c}}function MAe(e){return e}function OAe(e,t){return"string"==typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(n){return gG(e,n)})}:gG(e,t)}function gG(e,t){var n=t.id,i=t.bbox,r=null==t.properties?{}:t.properties,s=mG(e,t);return null==n&&null==i?{type:"Feature",properties:r,geometry:s}:null==i?{type:"Feature",id:n,properties:r,geometry:s}:{type:"Feature",id:n,bbox:i,properties:r,geometry:s}}function mG(e,t){var n=function TAe(e){if(null==e)return MAe;var t,n,i=e.scale[0],r=e.scale[1],s=e.translate[0],o=e.translate[1];return function(a,l){l||(t=n=0);var u=2,c=a.length,d=new Array(c);for(d[0]=(t+=a[0])*i+s,d[1]=(n+=a[1])*r+o;u<c;)d[u]=a[u],++u;return d}}(e.transform),i=e.arcs;function r(c,d){d.length&&d.pop();for(var f=i[c<0?~c:c],h=0,p=f.length;h<p;++h)d.push(n(f[h],h));c<0&&function AAe(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}(d,p)}function s(c){return n(c)}function o(c){for(var d=[],f=0,h=c.length;f<h;++f)r(c[f],d);return d.length<2&&d.push(d[0]),d}function a(c){for(var d=o(c);d.length<4;)d.push(d[0]);return d}function l(c){return c.map(a)}return function u(c){var f,d=c.type;switch(d){case"GeometryCollection":return{type:d,geometries:c.geometries.map(u)};case"Point":f=s(c.coordinates);break;case"MultiPoint":f=c.coordinates.map(s);break;case"LineString":f=o(c.arcs);break;case"MultiLineString":f=c.arcs.map(o);break;case"Polygon":f=l(c.arcs);break;case"MultiPolygon":f=c.arcs.map(l);break;default:return null}return{type:d,coordinates:f}}(t)}function NAe(e,t){var n={},i={},r={},s=[],o=-1;function l(u,c){for(var d in u){var f=u[d];delete c[f.start],delete f.start,delete f.end,f.forEach(function(h){n[h<0?~h:h]=1}),s.push(f)}}return t.forEach(function(u,c){var f,d=e.arcs[u<0?~u:u];d.length<3&&!d[1][0]&&!d[1][1]&&(f=t[++o],t[o]=u,t[c]=f)}),t.forEach(function(u){var h,p,c=function a(u){var f,c=e.arcs[u<0?~u:u],d=c[0];return e.transform?(f=[0,0],c.forEach(function(h){f[0]+=h[0],f[1]+=h[1]})):f=c[c.length-1],u<0?[f,d]:[d,f]}(u),d=c[0],f=c[1];if(h=r[d])if(delete r[h.end],h.push(u),h.end=f,p=i[f]){delete i[p.start];var g=p===h?h:h.concat(p);i[g.start=h.start]=r[g.end=p.end]=g}else i[h.start]=r[h.end]=h;else if(h=i[f])if(delete i[h.start],h.unshift(u),h.start=d,p=r[d]){delete r[p.end];var m=p===h?h:p.concat(h);i[m.start=p.start]=r[m.end=h.end]=m}else i[h.start]=r[h.end]=h;else i[(h=[u]).start=d]=r[h.end=f]=h}),l(r,i),l(i,r),t.forEach(function(u){n[u<0?~u:u]||s.push([u])}),s}function kAe(e){return mG(e,IAe.apply(this,arguments))}function IAe(e,t,n){var i,r,s;if(arguments.length>1)i=RAe(0,t,n);else for(r=0,i=new Array(s=e.arcs.length);r<s;++r)i[r]=r;return{type:"MultiLineString",arcs:NAe(e,i)}}function RAe(e,t,n){var s,i=[],r=[];function o(d){var f=d<0?~d:d;(r[f]||(r[f]=[])).push({i:d,g:s})}function a(d){d.forEach(o)}function l(d){d.forEach(a)}return function c(d){switch(s=d,d.type){case"GeometryCollection":d.geometries.forEach(c);break;case"LineString":a(d.arcs);break;case"MultiLineString":case"Polygon":l(d.arcs);break;case"MultiPolygon":!function u(d){d.forEach(l)}(d.arcs)}}(t),r.forEach(null==n?function(d){i.push(d[0].i)}:function(d){n(d[0].g,d[d.length-1].g)&&i.push(d[0].i)}),i}var LN=Math.sqrt(50),jN=Math.sqrt(10),BN=Math.sqrt(2);function $N(e,t,n){var i,s,o,a,r=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((i=t<e)&&(s=e,e=t,t=s),0===(a=_G(e,t,n))||!isFinite(a))return[];if(a>0){let l=Math.round(e/a),u=Math.round(t/a);for(l*a<e&&++l,u*a>t&&--u,o=new Array(s=u-l+1);++r<s;)o[r]=(l+r)*a}else{a=-a;let l=Math.round(e*a),u=Math.round(t*a);for(l/a<e&&++l,u/a>t&&--u,o=new Array(s=u-l+1);++r<s;)o[r]=(l+r)/a}return i&&o.reverse(),o}function _G(e,t,n){var i=(t-e)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),s=i/Math.pow(10,r);return r>=0?(s>=LN?10:s>=jN?5:s>=BN?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(s>=LN?10:s>=jN?5:s>=BN?2:1)}function Gc(e,t,n){var i=Math.abs(t-e)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),s=i/r;return s>=LN?r*=10:s>=jN?r*=5:s>=BN&&(r*=2),t<e?-r:r}var wG,FAe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Gf(e){if(!(t=FAe.exec(e)))throw new Error("invalid format: "+e);var t;return new VN({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function VN(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function cD(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function Ig(e){return(e=cD(Math.abs(e)))?e[1]:NaN}function yG(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Ig(t)/3)))-Ig(Math.abs(e)))}function vG(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ig(t)-Ig(e))+1}function bG(e){return Math.max(0,-Ig(Math.abs(e)))}function DG(e,t){var n=cD(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}Gf.prototype=VN.prototype,VN.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const CG={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function PAe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>DG(100*e,t),r:DG,s:function $Ae(e,t){var n=cD(e,t);if(!n)return e+"";var i=n[0],r=n[1],s=r-(wG=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+cD(e,Math.max(0,t+s-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function EG(e){return e}var dD,fD,HN,SG=Array.prototype.map,xG=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function AG(e){var t=void 0===e.grouping||void 0===e.thousands?EG:function LAe(e,t){return function(n,i){for(var r=n.length,s=[],o=0,a=e[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),s.push(n.substring(r-=a,r+a)),!((l+=a+1)>i));)a=e[o=(o+1)%e.length];return s.reverse().join(t)}}(SG.call(e.grouping,Number),e.thousands+""),n=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",r=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?EG:function jAe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}(SG.call(e.numerals,String)),o=void 0===e.percent?"%":e.percent+"",a=void 0===e.minus?"\u2212":e.minus+"",l=void 0===e.nan?"NaN":e.nan+"";function u(d){var f=(d=Gf(d)).fill,h=d.align,p=d.sign,g=d.symbol,m=d.zero,_=d.width,y=d.comma,v=d.precision,b=d.trim,D=d.type;"n"===D?(y=!0,D="g"):CG[D]||(void 0===v&&(v=12),b=!0,D="g"),(m||"0"===f&&"="===h)&&(m=!0,f="0",h="=");var C="$"===g?n:"#"===g&&/[boxX]/.test(D)?"0"+D.toLowerCase():"",w="$"===g?i:/[%p]/.test(D)?o:"",E=CG[D],T=/[defgprs%]/.test(D);function O(N){var A,x,S,P=C,j=w;if("c"===D)j=E(N)+j,N="";else{var I=(N=+N)<0||1/N<0;if(N=isNaN(N)?l:E(Math.abs(N),v),b&&(N=function BAe(e){e:for(var r,t=e.length,n=1,i=-1;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":0===i&&(i=n),r=n;break;default:if(!+e[n])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(r+1):e}(N)),I&&0==+N&&"+"!==p&&(I=!1),P=(I?"("===p?p:a:"-"===p||"("===p?"":p)+P,j=("s"===D?xG[8+wG/3]:"")+j+(I&&"("===p?")":""),T)for(A=-1,x=N.length;++A<x;)if(48>(S=N.charCodeAt(A))||S>57){j=(46===S?r+N.slice(A+1):N.slice(A))+j,N=N.slice(0,A);break}}y&&!m&&(N=t(N,1/0));var M=P.length+N.length+j.length,L=M<_?new Array(_-M+1).join(f):"";switch(y&&m&&(N=t(L+N,L.length?_-j.length:1/0),L=""),h){case"<":N=P+N+j+L;break;case"=":N=P+L+N+j;break;case"^":N=L.slice(0,M=L.length>>1)+P+N+j+L.slice(M);break;default:N=L+P+N+j}return s(N)}return v=void 0===v?6:/[gprs]/.test(D)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),O.toString=function(){return d+""},O}return{format:u,formatPrefix:function c(d,f){var h=u(((d=Gf(d)).type="f",d)),p=3*Math.max(-8,Math.min(8,Math.floor(Ig(f)/3))),g=Math.pow(10,-p),m=xG[8+p/3];return function(_){return h(g*_)+m}}}}!function VAe(e){dD=AG(e),fD=dD.format,HN=dD.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});var UN=new Date,zN=new Date;function Ri(e,t,n,i){function r(s){return e(s=0===arguments.length?new Date:new Date(+s)),s}return r.floor=function(s){return e(s=new Date(+s)),s},r.ceil=function(s){return e(s=new Date(s-1)),t(s,1),e(s),s},r.round=function(s){var o=r(s),a=r.ceil(s);return s-o<a-s?o:a},r.offset=function(s,o){return t(s=new Date(+s),null==o?1:Math.floor(o)),s},r.range=function(s,o,a){var u,l=[];if(s=r.ceil(s),a=null==a?1:Math.floor(a),!(s<o&&a>0))return l;do{l.push(u=new Date(+s)),t(s,a),e(s)}while(u<s&&s<o);return l},r.filter=function(s){return Ri(function(o){if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},function(o,a){if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!s(o););else for(;--a>=0;)for(;t(o,1),!s(o););})},n&&(r.count=function(s,o){return UN.setTime(+s),zN.setTime(+o),e(UN),e(zN),Math.floor(n(UN,zN))},r.every=function(s){return s=Math.floor(s),isFinite(s)&&s>0?s>1?r.filter(i?function(o){return i(o)%s==0}:function(o){return r.count(0,o)%s==0}):r:null}),r}const Lu=1e3,No=6e4,ju=60*No,Wf=24*ju,qN=7*Wf,MG=30*Wf,GN=365*Wf;var TG=Ri(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*No)/Wf,e=>e.getDate()-1);const Wc=TG;function Yf(e){return Ri(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+7*n)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*No)/qN})}var Rg=Yf(0),hD=Yf(1),Fg=(Yf(2),Yf(3),Yf(4)),OG=(Yf(5),Yf(6),Ri(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/Wf},function(e){return e.getUTCDate()-1}));const Yc=OG;function Kf(e){return Ri(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+7*n)},function(t,n){return(n-t)/qN})}var Pg=Kf(0),pD=Kf(1),Lg=(Kf(2),Kf(3),Kf(4)),WN=(Kf(5),Kf(6),Ri(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()}));WN.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Ri(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)}):null};const Kc=WN;var NG=Ri(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()});const gD=NG;var kG=Ri(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Lu-e.getMinutes()*No)},function(e,t){e.setTime(+e+t*ju)},function(e,t){return(t-e)/ju},function(e){return e.getHours()});const YN=kG;var IG=Ri(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Lu)},function(e,t){e.setTime(+e+t*No)},function(e,t){return(t-e)/No},function(e){return e.getMinutes()});const KN=IG;var RG=Ri(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*Lu)},function(e,t){return(t-e)/Lu},function(e){return e.getUTCSeconds()});const Jc=RG;var mD=Ri(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});mD.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?Ri(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):mD:null};const JN=mD;var XN=Ri(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});XN.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Ri(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null};const Xc=XN;var FG=Ri(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()});const _D=FG;var PG=Ri(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*ju)},function(e,t){return(t-e)/ju},function(e){return e.getUTCHours()});const QN=PG;var LG=Ri(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*No)},function(e,t){return(t-e)/No},function(e){return e.getUTCMinutes()});const ZN=LG;function Bu(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function JAe(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ey(e){let t,n,i;function r(a,l,u=0,c=a.length){if(u<c){if(0!==t(l,l))return c;do{const d=u+c>>>1;n(a[d],l)<0?u=d+1:c=d}while(u<c)}return u}return 2!==e.length?(t=Bu,n=(a,l)=>Bu(e(a),l),i=(a,l)=>e(a)-l):(t=e===Bu||e===JAe?e:XAe,n=e,i=e),{left:r,center:function o(a,l,u=0,c=a.length){const d=r(a,l,u,c-1);return d>u&&i(a[d-1],l)>-i(a[d],l)?d-1:d},right:function s(a,l,u=0,c=a.length){if(u<c){if(0!==t(l,l))return c;do{const d=u+c>>>1;n(a[d],l)<=0?u=d+1:c=d}while(u<c)}return u}}}function XAe(){return 0}const Wi="year",cs="quarter",mr="month",Di="week",ds="date",_r="day",Dl="dayofyear",Gs="hours",Ws="minutes",ko="seconds",ba="milliseconds",ek=[Wi,cs,mr,Di,ds,_r,Dl,Gs,Ws,ko,ba],tk=ek.reduce((e,t,n)=>(e[t]=1+n,e),{});function nk(e){const t=we(e).slice(),n={};return t.length||ee("Missing time unit."),t.forEach(r=>{ke(tk,r)?n[r]=1:ee("Invalid time unit: ".concat(r,"."))}),(n[Di]||n[_r]?1:0)+(n[cs]||n[mr]||n[ds]?1:0)+(n[Dl]?1:0)>1&&ee("Incompatible time units: ".concat(e)),t.sort((r,s)=>tk[r]-tk[s]),t}const QAe={[Wi]:"%Y ",[cs]:"Q%q ",[mr]:"%b ",[ds]:"%d ",[Di]:"W%U ",[_r]:"%a ",[Dl]:"%j ",[Gs]:"%H:00",[Ws]:"00:%M",[ko]:":%S",[ba]:".%L",["".concat(Wi,"-").concat(mr)]:"%Y-%m ",["".concat(Wi,"-").concat(mr,"-").concat(ds)]:"%Y-%m-%d ",["".concat(Gs,"-").concat(Ws)]:"%H:%M"};function jG(e,t){const n=st({},QAe,t),i=nk(e),r=i.length;let a,l,s="",o=0;for(o=0;o<r;)for(a=i.length;a>o;--a)if(l=i.slice(o,a).join("-"),null!=n[l]){s+=n[l],o=a;break}return s.trim()}const Jf=new Date;function ik(e){return Jf.setFullYear(e),Jf.setMonth(0),Jf.setDate(1),Jf.setHours(0,0,0,0),Jf}function BG(e){return VG(new Date(e))}function $G(e){return rk(new Date(e))}function VG(e){return Wc.count(ik(e.getFullYear())-1,e)}function rk(e){return Rg.count(ik(e.getFullYear())-1,e)}function sk(e){return ik(e).getDay()}function ZAe(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(-1,t,n,i,r,s,o);return a.setFullYear(e),a}return new Date(e,t,n,i,r,s,o)}function HG(e){return zG(new Date(e))}function UG(e){return ok(new Date(e))}function zG(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Yc.count(t-1,e)}function ok(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Pg.count(t-1,e)}function ak(e){return Jf.setTime(Date.UTC(e,0,1)),Jf.getUTCDay()}function eMe(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(Date.UTC(-1,t,n,i,r,s,o));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,i,r,s,o))}function qG(e,t,n,i,r){const s=t||1,o=bt(e),a=(_,y,v)=>function tMe(e,t,n,i){const r=n<=1?e:i?(s,o)=>i+n*Math.floor((e(s,o)-i)/n):(s,o)=>n*Math.floor(e(s,o)/n);return t?(s,o)=>t(r(s,o),o):r}(n[v=v||_],i[v],_===o&&s,y),l=new Date,u=va(e),c=u[Wi]?a(Wi):gr(2012),d=u[mr]?a(mr):u[cs]?a(cs):Vc,f=u[Di]&&u[_r]?a(_r,1,Di+_r):u[Di]?a(Di,1):u[_r]?a(_r,1):u[ds]?a(ds,1):u[Dl]?a(Dl,1):Mg,h=u[Gs]?a(Gs):Vc,p=u[Ws]?a(Ws):Vc,g=u[ko]?a(ko):Vc,m=u[ba]?a(ba):Vc;return function(_){l.setTime(+_);const y=c(l);return r(y,d(l),f(l,y),h(l),p(l),g(l),m(l))}}function jg(e,t,n){return t+7*e-(n+6)%7}const nMe={[Wi]:e=>e.getFullYear(),[cs]:e=>Math.floor(e.getMonth()/3),[mr]:e=>e.getMonth(),[ds]:e=>e.getDate(),[Gs]:e=>e.getHours(),[Ws]:e=>e.getMinutes(),[ko]:e=>e.getSeconds(),[ba]:e=>e.getMilliseconds(),[Dl]:e=>VG(e),[Di]:e=>rk(e),[Di+_r]:(e,t)=>jg(rk(e),e.getDay(),sk(t)),[_r]:(e,t)=>jg(1,e.getDay(),sk(t))},iMe={[cs]:e=>3*e,[Di]:(e,t)=>jg(e,0,sk(t))};function GG(e,t){return qG(e,t||1,nMe,iMe,ZAe)}const rMe={[Wi]:e=>e.getUTCFullYear(),[cs]:e=>Math.floor(e.getUTCMonth()/3),[mr]:e=>e.getUTCMonth(),[ds]:e=>e.getUTCDate(),[Gs]:e=>e.getUTCHours(),[Ws]:e=>e.getUTCMinutes(),[ko]:e=>e.getUTCSeconds(),[ba]:e=>e.getUTCMilliseconds(),[Dl]:e=>zG(e),[Di]:e=>ok(e),[_r]:(e,t)=>jg(1,e.getUTCDay(),ak(t)),[Di+_r]:(e,t)=>jg(ok(e),e.getUTCDay(),ak(t))},sMe={[cs]:e=>3*e,[Di]:(e,t)=>jg(e,0,ak(t))};function WG(e,t){return qG(e,t||1,rMe,sMe,eMe)}const oMe={[Wi]:Kc,[cs]:gD.every(3),[mr]:gD,[Di]:Rg,[ds]:Wc,[_r]:Wc,[Dl]:Wc,[Gs]:YN,[Ws]:KN,[ko]:Jc,[ba]:JN},aMe={[Wi]:Xc,[cs]:_D.every(3),[mr]:_D,[Di]:Pg,[ds]:Yc,[_r]:Yc,[Dl]:Yc,[Gs]:QN,[Ws]:ZN,[ko]:Jc,[ba]:JN};function Bg(e){return oMe[e]}function $g(e){return aMe[e]}function YG(e,t,n){return e?e.offset(t,n):void 0}function KG(e,t,n){return YG(Bg(e),t,n)}function JG(e,t,n){return YG($g(e),t,n)}function XG(e,t,n,i){return e?e.range(t,n,i):void 0}function QG(e,t,n,i){return XG(Bg(e),t,n,i)}function ZG(e,t,n,i){return XG($g(e),t,n,i)}const ny=6e4,iy=60*ny,yD=24*iy,eW=30*yD,lk=365*yD,tW=[Wi,mr,ds,Gs,Ws,ko,ba],ry=tW.slice(0,-1),sy=ry.slice(0,-1),oy=sy.slice(0,-1),uMe=oy.slice(0,-1),nW=[Wi,mr],iW=[Wi],ay=[[ry,1,1e3],[ry,5,5e3],[ry,15,15e3],[ry,30,3e4],[sy,1,ny],[sy,5,5*ny],[sy,15,15*ny],[sy,30,30*ny],[oy,1,iy],[oy,3,3*iy],[oy,6,6*iy],[oy,12,12*iy],[uMe,1,yD],[[Wi,Di],1,6048e5],[nW,1,eW],[nW,3,3*eW],[iW,1,lk]];function rW(e){const t=e.extent,n=e.maxbins||40,i=Math.abs(Q_(t))/n;let s,o,r=ey(a=>a[2]).right(ay,i);return r===ay.length?(s=iW,o=Gc(t[0]/lk,t[1]/lk,n)):r?(r=ay[i/ay[r-1][2]<ay[r][2]/i?r-1:r],s=r[0],o=r[1]):(s=tW,o=Math.max(Gc(t[0],t[1],n),1)),{units:s,step:o}}function uk(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function ck(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ly(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function sW(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,s=e.days,o=e.shortDays,a=e.months,l=e.shortMonths,u=uy(r),c=cy(r),d=uy(s),f=cy(s),h=uy(o),p=cy(o),g=uy(a),m=cy(a),_=uy(l),y=cy(l),v={a:function I(G){return o[G.getDay()]},A:function M(G){return s[G.getDay()]},b:function L(G){return l[G.getMonth()]},B:function R(G){return a[G.getMonth()]},c:null,d:dW,e:dW,f:IMe,g:UMe,G:qMe,H:OMe,I:NMe,j:kMe,L:fW,m:RMe,M:FMe,p:function V(G){return r[+(G.getHours()>=12)]},q:function U(G){return 1+~~(G.getMonth()/3)},Q:yW,s:vW,S:PMe,u:LMe,U:jMe,V:BMe,w:$Me,W:VMe,x:null,X:null,y:HMe,Y:zMe,Z:GMe,"%":_W},b={a:function z(G){return o[G.getUTCDay()]},A:function $(G){return s[G.getUTCDay()]},b:function Y(G){return l[G.getUTCMonth()]},B:function ie(G){return a[G.getUTCMonth()]},c:null,d:pW,e:pW,f:JMe,g:oTe,G:lTe,H:WMe,I:YMe,j:KMe,L:gW,m:XMe,M:QMe,p:function K(G){return r[+(G.getUTCHours()>=12)]},q:function le(G){return 1+~~(G.getUTCMonth()/3)},Q:yW,s:vW,S:ZMe,u:eTe,U:tTe,V:nTe,w:iTe,W:rTe,x:null,X:null,y:sTe,Y:aTe,Z:uTe,"%":_W},D={a:function O(G,Q,te){var q=h.exec(Q.slice(te));return q?(G.w=p.get(q[0].toLowerCase()),te+q[0].length):-1},A:function N(G,Q,te){var q=d.exec(Q.slice(te));return q?(G.w=f.get(q[0].toLowerCase()),te+q[0].length):-1},b:function P(G,Q,te){var q=_.exec(Q.slice(te));return q?(G.m=y.get(q[0].toLowerCase()),te+q[0].length):-1},B:function j(G,Q,te){var q=g.exec(Q.slice(te));return q?(G.m=m.get(q[0].toLowerCase()),te+q[0].length):-1},c:function A(G,Q,te){return E(G,t,Q,te)},d:uW,e:uW,f:xMe,g:lW,G:aW,H:cW,I:cW,j:DMe,L:SMe,m:wMe,M:CMe,p:function T(G,Q,te){var q=u.exec(Q.slice(te));return q?(G.p=c.get(q[0].toLowerCase()),te+q[0].length):-1},q:bMe,Q:MMe,s:TMe,S:EMe,u:gMe,U:mMe,V:_Me,w:pMe,W:yMe,x:function x(G,Q,te){return E(G,n,Q,te)},X:function S(G,Q,te){return E(G,i,Q,te)},y:lW,Y:aW,Z:vMe,"%":AMe};function C(G,Q){return function(te){var Ce,Te,Je,q=[],he=-1,ve=0,Ne=G.length;for(te instanceof Date||(te=new Date(+te));++he<Ne;)37===G.charCodeAt(he)&&(q.push(G.slice(ve,he)),null!=(Te=oW[Ce=G.charAt(++he)])?Ce=G.charAt(++he):Te="e"===Ce?" ":"0",(Je=Q[Ce])&&(Ce=Je(te,Te)),q.push(Ce),ve=he+1);return q.push(G.slice(ve,he)),q.join("")}}function w(G,Q){return function(te){var ve,Ne,q=ly(1900,void 0,1);if(E(q,G,te+="",0)!=te.length)return null;if("Q"in q)return new Date(q.Q);if("s"in q)return new Date(1e3*q.s+("L"in q?q.L:0));if(Q&&!("Z"in q)&&(q.Z=0),"p"in q&&(q.H=q.H%12+12*q.p),void 0===q.m&&(q.m="q"in q?q.q:0),"V"in q){if(q.V<1||q.V>53)return null;"w"in q||(q.w=1),"Z"in q?(Ne=(ve=ck(ly(q.y,0,1))).getUTCDay(),ve=Ne>4||0===Ne?pD.ceil(ve):pD(ve),ve=Yc.offset(ve,7*(q.V-1)),q.y=ve.getUTCFullYear(),q.m=ve.getUTCMonth(),q.d=ve.getUTCDate()+(q.w+6)%7):(Ne=(ve=uk(ly(q.y,0,1))).getDay(),ve=Ne>4||0===Ne?hD.ceil(ve):hD(ve),ve=Wc.offset(ve,7*(q.V-1)),q.y=ve.getFullYear(),q.m=ve.getMonth(),q.d=ve.getDate()+(q.w+6)%7)}else("W"in q||"U"in q)&&("w"in q||(q.w="u"in q?q.u%7:"W"in q?1:0),Ne="Z"in q?ck(ly(q.y,0,1)).getUTCDay():uk(ly(q.y,0,1)).getDay(),q.m=0,q.d="W"in q?(q.w+6)%7+7*q.W-(Ne+5)%7:q.w+7*q.U-(Ne+6)%7);return"Z"in q?(q.H+=q.Z/100|0,q.M+=q.Z%100,ck(q)):uk(q)}}function E(G,Q,te,q){for(var Ce,Te,he=0,ve=Q.length,Ne=te.length;he<ve;){if(q>=Ne)return-1;if(37===(Ce=Q.charCodeAt(he++))){if(Ce=Q.charAt(he++),!(Te=D[Ce in oW?Q.charAt(he++):Ce])||(q=Te(G,te,q))<0)return-1}else if(Ce!=te.charCodeAt(q++))return-1}return q}return v.x=C(n,v),v.X=C(i,v),v.c=C(t,v),b.x=C(n,b),b.X=C(i,b),b.c=C(t,b),{format:function(G){var Q=C(G+="",v);return Q.toString=function(){return G},Q},parse:function(G){var Q=w(G+="",!1);return Q.toString=function(){return G},Q},utcFormat:function(G){var Q=C(G+="",b);return Q.toString=function(){return G},Q},utcParse:function(G){var Q=w(G+="",!0);return Q.toString=function(){return G},Q}}}var Vg,dk,bW,fk,wW,oW={"-":"",_:" ",0:"0"},Fi=/^\s*\d+/,dMe=/^%/,fMe=/[\\^$*+?|[\]().{}]/g;function Rt(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(t)+r:r)}function hMe(e){return e.replace(fMe,"\\$&")}function uy(e){return new RegExp("^(?:"+e.map(hMe).join("|")+")","i")}function cy(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function pMe(e,t,n){var i=Fi.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function gMe(e,t,n){var i=Fi.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function mMe(e,t,n){var i=Fi.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function _Me(e,t,n){var i=Fi.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function yMe(e,t,n){var i=Fi.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function aW(e,t,n){var i=Fi.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function lW(e,t,n){var i=Fi.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function vMe(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function bMe(e,t,n){var i=Fi.exec(t.slice(n,n+1));return i?(e.q=3*i[0]-3,n+i[0].length):-1}function wMe(e,t,n){var i=Fi.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function uW(e,t,n){var i=Fi.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function DMe(e,t,n){var i=Fi.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function cW(e,t,n){var i=Fi.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function CMe(e,t,n){var i=Fi.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function EMe(e,t,n){var i=Fi.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function SMe(e,t,n){var i=Fi.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function xMe(e,t,n){var i=Fi.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function AMe(e,t,n){var i=dMe.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function MMe(e,t,n){var i=Fi.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function TMe(e,t,n){var i=Fi.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function dW(e,t){return Rt(e.getDate(),t,2)}function OMe(e,t){return Rt(e.getHours(),t,2)}function NMe(e,t){return Rt(e.getHours()%12||12,t,2)}function kMe(e,t){return Rt(1+Wc.count(Kc(e),e),t,3)}function fW(e,t){return Rt(e.getMilliseconds(),t,3)}function IMe(e,t){return fW(e,t)+"000"}function RMe(e,t){return Rt(e.getMonth()+1,t,2)}function FMe(e,t){return Rt(e.getMinutes(),t,2)}function PMe(e,t){return Rt(e.getSeconds(),t,2)}function LMe(e){var t=e.getDay();return 0===t?7:t}function jMe(e,t){return Rt(Rg.count(Kc(e)-1,e),t,2)}function hW(e){var t=e.getDay();return t>=4||0===t?Fg(e):Fg.ceil(e)}function BMe(e,t){return e=hW(e),Rt(Fg.count(Kc(e),e)+(4===Kc(e).getDay()),t,2)}function $Me(e){return e.getDay()}function VMe(e,t){return Rt(hD.count(Kc(e)-1,e),t,2)}function HMe(e,t){return Rt(e.getFullYear()%100,t,2)}function UMe(e,t){return Rt((e=hW(e)).getFullYear()%100,t,2)}function zMe(e,t){return Rt(e.getFullYear()%1e4,t,4)}function qMe(e,t){var n=e.getDay();return Rt((e=n>=4||0===n?Fg(e):Fg.ceil(e)).getFullYear()%1e4,t,4)}function GMe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Rt(t/60|0,"0",2)+Rt(t%60,"0",2)}function pW(e,t){return Rt(e.getUTCDate(),t,2)}function WMe(e,t){return Rt(e.getUTCHours(),t,2)}function YMe(e,t){return Rt(e.getUTCHours()%12||12,t,2)}function KMe(e,t){return Rt(1+Yc.count(Xc(e),e),t,3)}function gW(e,t){return Rt(e.getUTCMilliseconds(),t,3)}function JMe(e,t){return gW(e,t)+"000"}function XMe(e,t){return Rt(e.getUTCMonth()+1,t,2)}function QMe(e,t){return Rt(e.getUTCMinutes(),t,2)}function ZMe(e,t){return Rt(e.getUTCSeconds(),t,2)}function eTe(e){var t=e.getUTCDay();return 0===t?7:t}function tTe(e,t){return Rt(Pg.count(Xc(e)-1,e),t,2)}function mW(e){var t=e.getUTCDay();return t>=4||0===t?Lg(e):Lg.ceil(e)}function nTe(e,t){return e=mW(e),Rt(Lg.count(Xc(e),e)+(4===Xc(e).getUTCDay()),t,2)}function iTe(e){return e.getUTCDay()}function rTe(e,t){return Rt(pD.count(Xc(e)-1,e),t,2)}function sTe(e,t){return Rt(e.getUTCFullYear()%100,t,2)}function oTe(e,t){return Rt((e=mW(e)).getUTCFullYear()%100,t,2)}function aTe(e,t){return Rt(e.getUTCFullYear()%1e4,t,4)}function lTe(e,t){var n=e.getUTCDay();return Rt((e=n>=4||0===n?Lg(e):Lg.ceil(e)).getUTCFullYear()%1e4,t,4)}function uTe(){return"+0000"}function _W(){return"%"}function yW(e){return+e}function vW(e){return Math.floor(+e/1e3)}function dy(e){const t={};return n=>t[n]||(t[n]=e(n))}function DW(e){const t=dy(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(i){const r=Gf(i||",");if(null==r.precision){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1}return function dTe(e,t){return n=>{const i=e(n),r=i.indexOf(t);if(r<0)return i;let s=function fTe(e,t){let i,n=e.lastIndexOf("e");if(n>0)return n;for(n=e.length;--n>t;)if(i=e.charCodeAt(n),i>=48&&i<=57)return n+1}(i,r);const o=s<i.length?i.slice(s):"";for(;--s>r;)if("0"!==i[s]){++s;break}return i.slice(0,s)+o}}(t(r),t(".1f")(1)[1])}return t(r)},formatSpan(i,r,s,o){o=Gf(null==o?",f":o);const a=Gc(i,r,s),l=Math.max(Math.abs(i),Math.abs(r));let u;if(null==o.precision)switch(o.type){case"s":return isNaN(u=yG(a,l))||(o.precision=u),n(o,l);case"":case"e":case"g":case"p":case"r":isNaN(u=vG(a,l))||(o.precision=u-("e"===o.type));break;case"f":case"%":isNaN(u=bG(a))||(o.precision=u-2*("%"===o.type))}return t(o)}}}let hk,pk;function CW(){return hk=DW({format:fD,formatPrefix:HN})}function EW(e){return DW(AG(e))}function vD(e){return arguments.length?hk=EW(e):hk}function SW(e,t,n){Se(n=n||{})||ee("Invalid time multi-format specifier: ".concat(n));const i=t(ko),r=t(Ws),s=t(Gs),o=t(ds),a=t(Di),l=t(mr),u=t(cs),c=t(Wi),d=e(n[ba]||".%L"),f=e(n[ko]||":%S"),h=e(n[Ws]||"%I:%M"),p=e(n[Gs]||"%I %p"),g=e(n[ds]||n[_r]||"%a %d"),m=e(n[Di]||"%b %d"),_=e(n[mr]||"%B"),y=e(n[cs]||"%B"),v=e(n[Wi]||"%Y");return b=>(i(b)<b?d:r(b)<b?f:s(b)<b?h:o(b)<b?p:l(b)<b?a(b)<b?g:m:c(b)<b?u(b)<b?_:y:v)(b)}function xW(e){const t=dy(e.format),n=dy(e.utcFormat);return{timeFormat:i=>be(i)?t(i):SW(t,Bg,i),utcFormat:i=>be(i)?n(i):SW(n,$g,i),timeParse:dy(e.parse),utcParse:dy(e.utcParse)}}function AW(){return pk=xW({format:dk,parse:bW,utcFormat:fk,utcParse:wW})}function MW(e){return xW(sW(e))}function fy(e){return arguments.length?pk=MW(e):pk}!function cTe(e){Vg=sW(e),dk=Vg.format,bW=Vg.parse,fk=Vg.utcFormat,wW=Vg.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),CW(),AW();const gk=(e,t)=>st({},e,t);function TW(e,t){const n=e?EW(e):vD(),i=t?MW(t):fy();return gk(n,i)}function mk(e,t){const n=arguments.length;return n&&2!==n&&ee("defaultLocale expects either zero or two arguments."),n?gk(vD(e),fy(t)):gk(vD(),fy())}function hTe(){return CW(),AW(),mk()}const pTe=/^(data:|([A-Za-z]+:)?\/\/)/,gTe=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,mTe=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,OW="file://";function yTe(e,t){return _k.apply(this,arguments)}function _k(){return _k=Br(function*(e,t){const n=yield this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}),_k.apply(this,arguments)}function vTe(e,t){return yk.apply(this,arguments)}function yk(){return yk=Br(function*(e,t){t=st({},this.options,t);const n=this.fileAccess,i={href:null};let r,s,o;const a=gTe.test(e.replace(mTe,""));(null==e||"string"!=typeof e||!a)&&ee("Sanitize failure, invalid URI: "+pe(e));const l=pTe.test(e);return(o=t.baseURL)&&!l&&(!e.startsWith("/")&&!o.endsWith("/")&&(e="/"+e),e=o+e),s=(r=e.startsWith(OW))||"file"===t.mode||"http"!==t.mode&&!l&&n,r?e=e.slice(OW.length):e.startsWith("//")&&("file"===t.defaultProtocol?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!s}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),"image"===t.context&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}),yk.apply(this,arguments)}function bTe(e){return e?t=>new Promise((n,i)=>{e.readFile(t,(r,s)=>{r?i(r):n(s)})}):wTe}function wTe(){return vk.apply(this,arguments)}function vk(){return(vk=Br(function*(){ee("No file system access.")})).apply(this,arguments)}function DTe(e){return e?function(){var t=Br(function*(n,i){const r=st({},this.options.http,i),s=i&&i.response,o=yield e(n,r);return o.ok?rt(o[s])?o[s]():o.text():ee(o.status+""+o.statusText)});return function(n,i){return t.apply(this,arguments)}}():CTe}function CTe(){return bk.apply(this,arguments)}function bk(){return(bk=Br(function*(){ee("No HTTP fetch method available.")})).apply(this,arguments)}const ETe=e=>null!=e&&e==e,NW=e=>!(Number.isNaN(+e)||e instanceof Date),wk={boolean:NN,integer:pr,number:pr,date:kN,string:IN,unknown:hr},bD=[e=>"true"===e||"false"===e||!0===e||!1===e,e=>NW(e)&&Number.isInteger(+e),NW,e=>!Number.isNaN(Date.parse(e))],MTe=["boolean","integer","number","date"];function kW(e,t){if(!e||!e.length)return"unknown";const n=e.length,i=bD.length,r=bD.map((s,o)=>o+1);for(let a,l,s=0,o=0;s<n;++s)for(l=t?e[s][t]:e[s],a=0;a<i;++a)if(r[a]&&ETe(l)&&!bD[a](l)&&(r[a]=0,++o,o===bD.length))return"string";return MTe[r.reduce((s,o)=>0===s?o:s,0)-1]}function IW(e,t){return t.reduce((n,i)=>(n[i]=kW(e,i),n),{})}function RW(e){const t=function(n,i){const r={delimiter:e};return Dk(n,i?st(i,r):r)};return t.responseType="text",t}function Dk(e,t){return t.header&&(e=t.header.map(pe).join(t.delimiter)+"\n"+e),xAe(t.delimiter).parse(e+"")}function Ck(e,t){const n=t&&t.property?ls(t.property):hr;return Se(e)&&!function TTe(e){return!("function"!=typeof Buffer||!rt(Buffer.isBuffer))&&Buffer.isBuffer(e)}(e)?function OTe(e,t){return!ne(e)&&rG(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}(n(e),t):n(JSON.parse(e))}Dk.responseType="text",Ck.responseType="json";const NTe={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function FW(e,t){let n,i,r,s;return e=Ck(e,t),t&&t.feature?(n=OAe,r=t.feature):t&&t.mesh?(n=kAe,r=t.mesh,s=NTe[t.filter]):ee("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,s):ee("Invalid TopoJSON object: "+r),i&&i.features||[i]}FW.responseType="json";const wD={dsv:Dk,csv:RW(","),tsv:RW("\t"),json:Ck,topojson:FW};function Ek(e,t){return arguments.length>1?(wD[e]=t,this):ke(wD,e)?wD[e]:null}function PW(e){const t=Ek(e);return t&&t.responseType||"text"}function LW(e,t,n,i){const r=Ek((t=t||{}).type||"json");return r||ee("Unknown data format type: "+t.type),e=r(e,t),t.parse&&function kTe(e,t,n,i){if(!e.length)return;const r=fy();n=n||r.timeParse,i=i||r.utcParse;let o,a,l,u,c,d,s=e.columns||Object.keys(e[0]);"auto"===t&&(t=IW(e,s)),s=Object.keys(t);const f=s.map(h=>{const p=t[h];let g,m;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),m=g[1],("'"===m[0]&&"'"===m[m.length-1]||'"'===m[0]&&'"'===m[m.length-1])&&(m=m.slice(1,-1)),("utc"===g[0]?i:n)(m);if(!wk[p])throw Error("Illegal format pattern: "+h+":"+p);return wk[p]});for(l=0,c=e.length,d=s.length;l<c;++l)for(o=e[l],u=0;u<d;++u)a=s[u],o[a]=f[u](o[a])}(e,t.parse,n,i),ke(e,"columns")&&delete e.columns,e}const DD=function _Te(e,t){return n=>({options:n||{},sanitize:vTe,load:yTe,fileAccess:!!t,file:bTe(t),http:DTe(e)})}("undefined"!=typeof fetch&&fetch,null);function CD(e){const t=e||hr,n=[],i={};return n.add=r=>{const s=t(r);return i[s]||(i[s]=1,n.push(r)),n},n.remove=r=>{const s=t(r);if(i[s]){i[s]=0;const o=n.indexOf(r);o>=0&&n.splice(o,1)}return n},n}function ED(e,t){return Sk.apply(this,arguments)}function Sk(){return Sk=Br(function*(e,t){try{yield t(e)}catch(n){e.error(n)}}),Sk.apply(this,arguments)}const jW=Symbol("vega_id");let ITe=1;function SD(e){return!(!e||!Pe(e))}function Pe(e){return e[jW]}function BW(e,t){return e[jW]=t,e}function Vt(e){const t=e===Object(e)?e:{data:e};return Pe(t)?t:BW(t,ITe++)}function xk(e){return xD(e,Vt({}))}function xD(e,t){for(const n in e)t[n]=e[n];return t}function $W(e,t){return BW(t,Pe(e))}function Xf(e,t){return e?t?(n,i)=>e(n,i)||Pe(t(n))-Pe(t(i)):(n,i)=>e(n,i)||Pe(n)-Pe(i):null}function VW(e){return e&&e.constructor===Qf}function Qf(){const e=[],t=[],n=[],i=[],r=[];let s=null,o=!1;return{constructor:Qf,insert(a){const l=we(a),u=l.length;for(let c=0;c<u;++c)e.push(l[c]);return this},remove(a){const l=rt(a)?i:t,u=we(a),c=u.length;for(let d=0;d<c;++d)l.push(u[d]);return this},modify(a,l,u){const c={field:l,value:gr(u)};return rt(a)?(c.filter=a,r.push(c)):(c.tuple=a,n.push(c)),this},encode(a,l){return rt(a)?r.push({filter:a,field:l}):n.push({tuple:a,field:l}),this},clean(a){return s=a,this},reflow(){return o=!0,this},pulse(a,l){const u={},c={};let d,f,h,p,g,m;for(d=0,f=l.length;d<f;++d)u[Pe(l[d])]=1;for(d=0,f=t.length;d<f;++d)g=t[d],u[Pe(g)]=-1;for(d=0,f=i.length;d<f;++d)p=i[d],l.forEach(y=>{p(y)&&(u[Pe(y)]=-1)});for(d=0,f=e.length;d<f;++d)g=e[d],m=Pe(g),u[m]?u[m]=1:a.add.push(Vt(e[d]));for(d=0,f=l.length;d<f;++d)g=l[d],u[Pe(g)]<0&&a.rem.push(g);function _(y,v,b){b?y[v]=b(y):a.encode=v,o||(c[Pe(y)]=y)}for(d=0,f=n.length;d<f;++d)h=n[d],g=h.tuple,p=h.field,m=u[Pe(g)],m>0&&(_(g,p,h.value),a.modifies(p));for(d=0,f=r.length;d<f;++d)h=r[d],p=h.filter,l.forEach(y=>{p(y)&&u[Pe(y)]>0&&_(y,h.field,h.value)}),a.modifies(h.field);if(o)a.mod=t.length||i.length?l.filter(y=>u[Pe(y)]>0):l.slice();else for(m in c)a.mod.push(c[m]);return(s||null==s&&(t.length||i.length))&&a.clean(!0),a}}}const AD="_:mod:_";function MD(){Object.defineProperty(this,AD,{writable:!0,value:{}})}MD.prototype={set(e,t,n,i){const r=this,s=r[e],o=r[AD];return null!=t&&t>=0?(s[t]!==n||i)&&(s[t]=n,o[t+":"+e]=-1,o[e]=-1):(s!==n||i)&&(r[e]=n,o[e]=ne(n)?1+n.length:-1),r},modified(e,t){const n=this[AD];if(!arguments.length){for(const i in n)if(n[i])return!0;return!1}if(ne(e)){for(let i=0;i<e.length;++i)if(n[e[i]])return!0;return!1}return null!=t&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[AD]={},this}};let RTe=0;const PTe=new MD;function fn(e,t,n,i){this.id=++RTe,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,i)}function HW(e){return function(t){const n=this.flags;return 0===arguments.length?!!(n&e):(this.flags=t?n|e:n&~e,this)}}fn.prototype={targets(){return this._targets||(this._targets=CD(J_))},set(e){return this.value!==e?(this.value=e,1):0},skip:HW(1),modified:HW(2),parameters(e,t,n){t=!1!==t;const i=this._argval=this._argval||new MD,r=this._argops=this._argops||[],s=[];let o,a,l,u;const c=(d,f,h)=>{h instanceof fn?(h!==this&&(t&&h.targets().add(this),s.push(h)),r.push({op:h,name:d,index:f})):i.set(d,f,h)};for(o in e)if(a=e[o],"pulse"===o)we(a).forEach(d=>{d instanceof fn?d!==this&&(d.targets().add(this),s.push(d)):ee("Pulse parameters must be operator instances.")}),this.source=a;else if(ne(a))for(i.set(o,-1,Array(l=a.length)),u=0;u<l;++u)c(o,u,a[u]);else c(o,-1,a);return this.marshall().clear(),n&&(r.initonly=!0),s},marshall(e){const t=this._argval||PTe,n=this._argops;let i,r,s,o;if(n){const a=n.length;for(r=0;r<a;++r)i=n[r],s=i.op,o=s.modified()&&s.stamp===e,t.set(i.name,i.index,s.value,o);if(n.initonly){for(r=0;r<a;++r)i=n[r],i.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,i,r;if(e)for(t=0,n=e.length;t<n;++t)i=e[t],r=i.op,r._targets&&r._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),i=t.call(this,n,e);if(n.clear(),i!==this.value)this.value=i;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};let VTe=0;function TD(e,t,n){this.id=++VTe,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Qc(e,t,n){return new TD(e,t,n)}function Ak(){return Ak=Br(function*(e,t){const n=this;let r,i=0;try{r=yield n.loader().load(e,{context:"dataflow",response:PW(t&&t.type)});try{r=n.parse(r,t)}catch(s){i=-2,n.warn("Data ingestion failed",e,s)}}catch(s){i=-1,n.warn("Loading failed",e,s)}return{data:r,status:i}}),Ak.apply(this,arguments)}function Mk(){return Mk=Br(function*(e,t,n){const i=this,r=i._pending||WTe(i);r.requests+=1;const s=yield i.request(t,n);return i.pulse(e,i.changeset().remove(Oo).insert(s.data||[])),r.done(),s}),Mk.apply(this,arguments)}function WTe(e){let t;const n=new Promise(i=>t=i);return n.requests=0,n.done=()=>{0==--n.requests&&(e._pending=null,t(e))},e._pending=n}TD.prototype={_filter:Oo,_apply:hr,targets(){return this._targets||(this._targets=CD(J_))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,i=n?n.length:0;for(let r=0;r<i;++r)n[r].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=Qc(e);return this.targets().add(t),t},apply(e){const t=Qc(null,e);return this.targets().add(t),t},merge(){const e=Qc();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=Qc();return this.targets().add(Qc(null,null,TN(e,n=>{const i=n.dataflow;t.receive(n),i&&i.run&&i.run()}))),t},between(e,t){let n=!1;return e.targets().add(Qc(null,null,()=>n=!0)),t.targets().add(Qc(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=Oo,this._targets=null}};const YTe={skip:!0};function JTe(e,t,n,i,r,s){const o=st({},s,YTe);let a,l;rt(n)||(n=gr(n)),void 0===i?a=u=>e.touch(n(u)):rt(i)?(l=new fn(null,i,r,!1),a=u=>{l.evaluate(u);const c=n(u),d=l.value;VW(d)?e.pulse(c,d,s):e.update(c,d,o)}):a=u=>e.update(n(u),i,o),t.apply(a)}function XTe(e,t,n,i,r,s){if(void 0===i)t.targets().add(n);else{const o=s||{},a=new fn(null,function QTe(e,t){return t=rt(t)?t:gr(t),e?function(n,i){const r=t(n,i);return e.skip()||(e.skip(r!==this.value).value=r),r}:t}(n,i),r,!1);a.modified(o.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}const OD={};function ed(e,t,n){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Tk(e,t){const n=[];return qc(e,t,i=>n.push(i)),n}function WW(e,t){const n={};return e.visit(t,i=>{n[Pe(i)]=1}),i=>n[Pe(i)]?null:i}function ND(e,t){return e?(n,i)=>e(n,i)&&t(n,i):t}function Ok(e,t,n,i){const r=this,s=n.length;let o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=i||null,this.pulses=n;for(let a=0;a<s;++a){const l=n[a];if(l.stamp===t){if(l.fields){const u=r.fields||(r.fields={});for(const c in l.fields)u[c]=1}l.changed(r.ADD)&&(o|=r.ADD),l.changed(r.REM)&&(o|=r.REM),l.changed(r.MOD)&&(o|=r.MOD)}}this.changes=o}function Nk(){return Nk=Br(function*(e,t,n){const i=this,r=[];if(i._pulse)return YW(i);if(i._pending&&(yield i._pending),t&&(yield ED(i,t)),!i._touched.length)return i.debug("Dataflow invoked, but nothing to do."),i;const s=++i._clock;i._pulse=new ed(i,s,e),i._touched.forEach(c=>i._enqueue(c,!0)),i._touched=CD(J_);let a,l,u,o=0;try{for(;i._heap.size()>0;)a=i._heap.pop(),a.rank===a.qrank?(l=a.run(i._getPulse(a,e)),l.then?l=yield l:l.async&&(r.push(l.async),l=OD),l!==OD&&a._targets&&a._targets.forEach(c=>i._enqueue(c)),++o):i._enqueue(a,!0)}catch(c){i._heap.clear(),u=c}if(i._input={},i._pulse=null,i.debug(`Pulse ${s}: ${o} operators`),u&&(i._postrun=[],i.error(u)),i._postrun.length){const c=i._postrun.sort((d,f)=>f.priority-d.priority);i._postrun=[];for(let d=0;d<c.length;++d)yield ED(i,c[d].callback)}return n&&(yield ED(i,n)),r.length&&Promise.all(r).then(c=>i.runAsync(null,()=>{c.forEach(d=>{try{d(i)}catch(f){i.error(f)}})})),i}),Nk.apply(this,arguments)}function kk(){return kk=Br(function*(e,t,n){for(;this._running;)yield this._running;const i=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(i,i),this._running}),kk.apply(this,arguments)}function YW(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}ed.prototype={StopPropagation:OD,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(e){return new ed(this.dataflow).init(this,e)},clone(){const e=this.fork(7);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(23)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new ed(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(64&t)&&(n.fields=e.fields),1&t?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),2&t?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),4&t?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),32&t?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||7;return 1&t&&this.add.length||2&t&&this.rem.length||4&t&&this.mod.length},reflow(e){if(e)return this.fork(7).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(4,WW(this,1))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return ne(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return!(!t&&!this.mod.length||!n)&&(arguments.length?ne(e)?e.some(i=>n[i]):n[e]:!!n)},filter(e,t){const n=this;return 1&e&&(n.addF=ND(n.addF,t)),2&e&&(n.remF=ND(n.remF,t)),4&e&&(n.modF=ND(n.modF,t)),16&e&&(n.srcF=ND(n.srcF,t)),n},materialize(e){const t=this;return 1&(e=e||7)&&t.addF&&(t.add=Tk(t.add,t.addF),t.addF=null),2&e&&t.remF&&(t.rem=Tk(t.rem,t.remF),t.remF=null),4&e&&t.modF&&(t.mod=Tk(t.mod,t.modF),t.modF=null),16&e&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,i=t;if(16&e)return qc(n.source,n.srcF,i),n;1&e&&qc(n.add,n.addF,i),2&e&&qc(n.rem,n.remF,i),4&e&&qc(n.mod,n.modF,i);const r=n.source;if(8&e&&r){const s=n.add.length+n.mod.length;s===r.length||qc(r,s?WW(n,5):n.srcF,i)}return n}},fe(Ok,ed,{fork(e){const t=new ed(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?ne(e)?e.some(i=>n[i]):n[e]:0},filter(){ee("MultiPulse does not support filtering.")},materialize(){ee("MultiPulse does not support materialization.")},visit(e,t){const n=this,i=n.pulses,r=i.length;let s=0;if(e&n.SOURCE)for(;s<r;++s)i[s].visit(e,t);else for(;s<r;++s)i[s].stamp===n.stamp&&i[s].visit(e,t);return n}});const Ik={skip:!1,force:!1};function KW(e,t,n,i){let r,s;const o=e[n];for(;n>t&&(s=n-1>>1,r=e[s],i(o,r)<0);)e[n]=r,n=s;return e[n]=o}function Ug(){this.logger(EN()),this.logLevel(DN),this._clock=0,this._rank=0,this._locale=mk();try{this._loader=DD()}catch(e){}this._touched=CD(J_),this._input={},this._pulse=null,this._heap=function fOe(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),KW(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let i;return t.length?(i=t[0],t[0]=n,function hOe(e,t,n){const i=t,r=e.length,s=e[t];let a,o=1+(t<<1);for(;o<r;)a=o+1,a<r&&n(e[o],e[a])>=0&&(o=a),e[t]=e[o],o=1+((t=o)<<1);e[t]=s,KW(e,i,t,n)}(t,0,e)):i=n,i}}}((e,t)=>e.qrank-t.qrank),this._postrun=[]}function py(e){return function(){return this._log[e].apply(this,arguments)}}function J(e,t){fn.call(this,e,null,t)}Ug.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:py("error"),warn:py("warn"),info:py("info"),debug:py("debug"),logLevel:py("level"),cleanThreshold:1e4,add:function BTe(e,t,n,i){let s,r=1;return e instanceof fn?s=e:e&&e.prototype instanceof fn?s=new e:rt(e)?s=new fn(null,e):(r=0,s=new fn(e,t)),this.rank(s),r&&(i=n,n=t),n&&this.connect(s,s.parameters(n,i)),this.touch(s),s},connect:function $Te(e,t){const n=e.rank,i=t.length;for(let r=0;r<i;++r)if(n<t[r].rank)return void this.rerank(e)},rank:function ZTe(e){e.rank=++this._rank},rerank:function eOe(e){const t=[e];let n,i,r;for(;t.length;)if(this.rank(n=t.pop()),i=n._targets)for(r=i.length;--r>=0;)t.push(n=i[r]),n===e&&ee("Cycle detected in dataflow graph.")},pulse:function dOe(e,t,n){this.touch(e,n||Ik);const i=new ed(this,this._clock+(this._pulse?0:1)),r=e.pulse&&e.pulse.source||[];return i.target=e,this._input[e.id]=t.pulse(i,r),this},touch:function uOe(e,t){const n=t||Ik;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this},update:function cOe(e,t,n){const i=n||Ik;return(e.set(t)||i.force)&&this.touch(e,i),this},changeset:Qf,ingest:function zTe(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))},parse:function UTe(e,t){const n=this.locale();return LW(e,t,n.timeParse,n.utcParse)},preload:function GTe(e,t,n){return Mk.apply(this,arguments)},request:function qTe(e,t){return Ak.apply(this,arguments)},events:function HTe(e,t,n,i){const r=this,s=Qc(n,i),o=function(u){u.dataflow=r;try{s.receive(u)}catch(c){r.error(c)}finally{r.run()}};let a;a="string"==typeof e&&"undefined"!=typeof document?document.querySelectorAll(e):we(e);const l=a.length;for(let u=0;u<l;++u)a[u].addEventListener(t,o);return s},on:function KTe(e,t,n,i,r){return(e instanceof fn?XTe:JTe)(this,e,t,n,i,r),this},evaluate:function nOe(e,t,n){return Nk.apply(this,arguments)},run:function rOe(e,t,n){return this._pulse?YW(this):(this.evaluate(e,t,n),this)},runAsync:function iOe(e,t,n){return kk.apply(this,arguments)},runAfter:function sOe(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(i){this.error(i)}},_enqueue:function oOe(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))},_getPulse:function aOe(e,t){const n=e.source,i=this._clock;return n&&ne(n)?new Ok(this,i,n.map(r=>r.pulse),t):this._input[e.id]||function lOe(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==OD&&(e.source=t.source),e)}(this._pulse,n&&n.pulse)}},fe(J,fn,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const zg={};function JW(e){const t=XW(e);return t&&t.Definition||null}function XW(e){return e=e&&e.toLowerCase(),ke(zg,e)?zg[e]:null}function Zf(e,t){let n;if(void 0===t)for(const i of e)null!=i&&(n<i||void 0===n&&i>=i)&&(n=i);else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}function Rk(e,t){let n;if(void 0===t)for(const i of e)null!=i&&(n>i||void 0===n&&i>=i)&&(n=i);else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(n>r||void 0===n&&r>=r)&&(n=r)}return n}function kD(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}function ZW(e,t,n=0,i=e.length-1,r){for(r=void 0===r?kD:function QW(e=Bu){if(e===Bu)return kD;if("function"!=typeof e)throw new TypeError("compare is not a function");return(t,n)=>{const i=e(t,n);return i||0===i?i:(0===e(n,n))-(0===e(t,t))}}(r);i>n;){if(i-n>600){const l=i-n+1,u=t-n+1,c=Math.log(l),d=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*d*(l-d)/l)*(u-l/2<0?-1:1);ZW(e,t,Math.max(n,Math.floor(t-u*d/l+f)),Math.min(i,Math.floor(t+(l-u)*d/l+f)),r)}const s=e[t];let o=n,a=i;for(gy(e,n,t),r(e[i],s)>0&&gy(e,n,i);o<a;){for(gy(e,o,a),++o,--a;r(e[o],s)<0;)++o;for(;r(e[a],s)>0;)--a}0===r(e[n],s)?gy(e,n,a):(++a,gy(e,a,i)),a<=t&&(n=a+1),t<=a&&(i=a-1)}return e}function gy(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function eY(e){return null===e?NaN:+e}function Fk(e,t,n){if(e=Float64Array.from(function*pOe(e,t){if(void 0===t)for(let n of e)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)null!=(i=t(i,++n,e))&&(i=+i)>=i&&(yield i)}}(e,n)),i=e.length){if((t=+t)<=0||i<2)return Rk(e);if(t>=1)return Zf(e);var i,r=(i-1)*t,s=Math.floor(r),o=Zf(ZW(e,s).subarray(0,s+1));return o+(Rk(e.subarray(s+1))-o)*(r-s)}}function tY(e,t,n=eY){if(i=e.length){if((t=+t)<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,s=Math.floor(r),o=+n(e[s],s,e);return o+(+n(e[s+1],s+1,e)-o)*(r-s)}}function nY(e,t){return Fk(e,.5,t)}function*iY(e,t){if(null==t)for(let n of e)null!=n&&""!==n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)i=t(i,++n,e),null!=i&&""!==i&&(i=+i)>=i&&(yield i)}}function Pk(e,t,n){const i=Float64Array.from(iY(e,n));return i.sort(Bu),t.map(r=>tY(i,r))}function Lk(e,t){return Pk(e,[.25,.5,.75],t)}function jk(e,t){const n=e.length,i=function mOe(e,t){const n=function gOe(e,t){let i,n=0,r=0,s=0;if(void 0===t)for(let o of e)null!=o&&(o=+o)>=o&&(i=o-r,r+=i/++n,s+=i*(o-r));else{let o=-1;for(let a of e)null!=(a=t(a,++o,e))&&(a=+a)>=a&&(i=a-r,r+=i/++n,s+=i*(a-r))}if(n>1)return s/(n-1)}(e,t);return n&&Math.sqrt(n)}(e,t),r=Lk(e,t);return 1.06*(Math.min(i,(r[2]-r[0])/1.34)||i||Math.abs(r[0])||1)*Math.pow(n,-.2)}function rY(e){const t=e.maxbins||20,n=e.base||10,i=Math.log(n),r=e.divide||[5,2];let a,l,u,c,d,f,s=e.extent[0],o=e.extent[1];const h=e.span||o-s||Math.abs(s)||1;if(e.step)a=e.step;else if(e.steps){for(c=h/t,d=0,f=e.steps.length;d<f&&e.steps[d]<c;++d);a=e.steps[Math.max(0,d-1)]}else{for(l=Math.ceil(Math.log(t)/i),u=e.minstep||0,a=Math.max(u,Math.pow(n,Math.round(Math.log(h)/i)-l));Math.ceil(h/a)>t;)a*=n;for(d=0,f=r.length;d<f;++d)c=a/r[d],c>=u&&h/c<=t&&(a=c)}c=Math.log(a);const g=Math.pow(n,-(c>=0?0:1+~~(-c/i))-1);return(e.nice||void 0===e.nice)&&(c=Math.floor(s/a+g)*a,s=s<c?c-a:c,o=Math.ceil(o/a)*a),{start:s,stop:o===s?s+a:o,step:a}}var Io=Math.random;function _Oe(e){Io=e}function sY(e,t,n,i){if(!e.length)return[void 0,void 0];const r=Float64Array.from(iY(e,i)),s=r.length,o=t;let a,l,u,c;for(u=0,c=Array(o);u<o;++u){for(a=0,l=0;l<s;++l)a+=r[~~(Io()*s)];c[u]=a/s}return c.sort(Bu),[Fk(c,n/2),Fk(c,1-n/2)]}function oY(e,t,n,i){i=i||(f=>f);const r=e.length,s=new Float64Array(r);let d,o=0,a=1,l=i(e[0]),u=l,c=l+t;for(;a<r;++a){if(d=i(e[a]),d>=c){for(u=(l+u)/2;o<a;++o)s[o]=u;c=d+t,l=d}u=d}for(u=(l+u)/2;o<a;++o)s[o]=u;return n?function yOe(e,t){const n=e.length;let s,o,i=0,r=1;for(;e[i]===e[r];)++r;for(;r<n;){for(s=r+1;e[r]===e[s];)++s;if(e[r]-e[r-1]<t){for(o=r+(i+s-r-r>>1);o<r;)e[o++]=e[r];for(;o>r;)e[o--]=e[i]}i=r,r=s}return e}(s,t+t/4):s}function vOe(e){return function(){return(e=(1103515245*e+12345)%2147483647)/2147483647}}function bOe(e,t){let n,i,r;null==t&&(t=e,e=0);const s={min(o){return arguments.length?(n=o||0,r=i-n,s):n},max(o){return arguments.length?(i=o||0,r=i-n,s):i},sample:()=>n+Math.floor(r*Io()),pdf:o=>o===Math.floor(o)&&o>=n&&o<i?1/r:0,cdf(o){const a=Math.floor(o);return a<n?0:a>=i?1:(a-n+1)/r},icdf:o=>o>=0&&o<=1?n-1+Math.floor(o*r):NaN};return s.min(e).max(t)}const aY=Math.sqrt(2*Math.PI),wOe=Math.SQRT2;let my=NaN;function ID(e,t){e=e||0,t=null==t?1:t;let r,s,n=0,i=0;if(my==my)n=my,my=NaN;else{do{n=2*Io()-1,i=2*Io()-1,r=n*n+i*i}while(0===r||r>1);s=Math.sqrt(-2*Math.log(r)/r),n*=s,my=i*s}return e+n*t}function Bk(e,t,n){const i=(e-(t||0))/(n=null==n?1:n);return Math.exp(-.5*i*i)/(n*aY)}function RD(e,t,n){const i=(e-(t=t||0))/(n=null==n?1:n),r=Math.abs(i);let s;if(r>37)s=0;else{const o=Math.exp(-r*r/2);let a;r<7.07106781186547?(a=.0352624965998911*r+.700383064443688,a=a*r+6.37396220353165,a=a*r+33.912866078383,a=a*r+112.079291497871,a=a*r+221.213596169931,a=a*r+220.206867912376,s=o*a,a=.0883883476483184*r+1.75566716318264,a=a*r+16.064177579207,a=a*r+86.7807322029461,a=a*r+296.564248779674,a=a*r+637.333633378831,a=a*r+793.826512519948,a=a*r+440.413735824752,s/=a):(a=r+.65,a=r+4/a,a=r+3/a,a=r+2/a,a=r+1/a,s=o/a/2.506628274631)}return i>0?1-s:s}function FD(e,t,n){return e<0||e>1?NaN:(t||0)+(null==n?1:n)*wOe*function DOe(e){let n,t=-Math.log((1-e)*(1+e));return t<6.25?(t-=3.125,n=-364441206401782e-35,n=n*t-16850591381820166e-35,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=n*t-1333171662854621e-31,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=n*t-4054566272975207e-29,n=n*t-8151934197605472e-29,n=26335093153082323e-28+n*t,n=n*t-12975133253453532e-27,n=n*t-5415412054294628e-26,n=1.0512122733215323e-9+n*t,n=n*t-4.112633980346984e-9,n=n*t-2.9070369957882005e-8,n=4.2347877827932404e-7+n*t,n=n*t-13654692000834679e-22,n=n*t-13882523362786469e-21,n=.00018673420803405714+n*t,n=n*t-.000740702534166267,n=n*t-.006033670871430149,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=2.2137376921775787e-9,n=9.075656193888539e-8+n*t,n=n*t-2.7517406297064545e-7,n=1.8239629214389228e-8+n*t,n=15027403968909828e-22+n*t,n=n*t-4013867526981546e-21,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=n*t-47318229009055734e-21,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=n*t-.0003550375203628475,n=.0009532893797373805+n*t,n=n*t-.0016882755560235047,n=.002491442096107851+n*t,n=n*t-.003751208507569241,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=n*t-2.555641816996525e-10,n=1.5076572693500548e-9+n*t,n=n*t-3.789465440126737e-9,n=7.61570120807834e-9+n*t,n=n*t-1.496002662714924e-8,n=2.914795345090108e-8+n*t,n=n*t-6.771199775845234e-8,n=2.2900482228026655e-7+n*t,n=n*t-9.9298272942317e-7,n=4526062597223154e-21+n*t,n=n*t-1968177810553167e-20,n=7599527703001776e-20+n*t,n=n*t-.00021503011930044477,n=n*t-.00013871931833623122,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}(2*e-1)}function $k(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=null==s?1:s,r):i},sample:()=>ID(n,i),pdf:s=>Bk(s,n,i),cdf:s=>RD(s,n,i),icdf:s=>FD(s,n,i)};return r.mean(e).stdev(t)}function Vk(e,t){const n=$k();let i=0;const r={data(s){return arguments.length?(e=s,i=s?s.length:0,r.bandwidth(t)):e},bandwidth(s){return arguments.length?(!(t=s)&&e&&(t=jk(e)),r):t},sample:()=>e[~~(Io()*i)]+t*n.sample(),pdf(s){let o=0,a=0;for(;a<i;++a)o+=n.pdf((s-e[a])/t);return o/t/i},cdf(s){let o=0,a=0;for(;a<i;++a)o+=n.cdf((s-e[a])/t);return o/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(e)}function Hk(e,t){return e=e||0,t=null==t?1:t,Math.exp(e+ID()*t)}function Uk(e,t,n){if(e<=0)return 0;t=t||0,n=null==n?1:n;const i=(Math.log(e)-t)/n;return Math.exp(-.5*i*i)/(n*aY*e)}function zk(e,t,n){return RD(Math.log(e),t,n)}function qk(e,t,n){return Math.exp(FD(e,t,n))}function lY(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=null==s?1:s,r):i},sample:()=>Hk(n,i),pdf:s=>Uk(s,n,i),cdf:s=>zk(s,n,i),icdf:s=>qk(s,n,i)};return r.mean(e).stdev(t)}function uY(e,t){let i,n=0;const s={weights(o){return arguments.length?(i=function r(o){const a=[];let u,l=0;for(u=0;u<n;++u)l+=a[u]=null==o[u]?1:+o[u];for(u=0;u<n;++u)a[u]/=l;return a}(t=o||[]),s):t},distributions(o){return arguments.length?(o?(n=o.length,e=o):(n=0,e=[]),s.weights(t)):e},sample(){const o=Io();let a=e[n-1],l=i[0],u=0;for(;u<n-1;l+=i[++u])if(o<l){a=e[u];break}return a.sample()},pdf(o){let a=0,l=0;for(;l<n;++l)a+=i[l]*e[l].pdf(o);return a},cdf(o){let a=0,l=0;for(;l<n;++l)a+=i[l]*e[l].cdf(o);return a},icdf(){throw Error("Mixture icdf not supported.")}};return s.distributions(e).weights(t)}function Gk(e,t){return null==t&&(t=null==e?1:e,e=0),e+(t-e)*Io()}function Wk(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function Yk(e,t,n){return null==n&&(n=null==t?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function Kk(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function cY(e,t){let n,i;const r={min(s){return arguments.length?(n=s||0,r):n},max(s){return arguments.length?(i=null==s?1:s,r):i},sample:()=>Gk(n,i),pdf:s=>Wk(s,n,i),cdf:s=>Yk(s,n,i),icdf:s=>Kk(s,n,i)};return null==t&&(t=null==e?1:e,e=0),r.min(e).max(t)}function _y(e,t,n,i){const r=i-e*e,s=Math.abs(r)<1e-24?0:(n-e*t)/r;return[t-s*e,s]}function PD(e,t,n,i){e=e.filter(h=>{let p=t(h),g=n(h);return null!=p&&(p=+p)>=p&&null!=g&&(g=+g)>=g}),i&&e.sort((h,p)=>t(h)-t(p));const r=e.length,s=new Float64Array(r),o=new Float64Array(r);let c,d,f,a=0,l=0,u=0;for(f of e)s[a]=c=+t(f),o[a]=d=+n(f),++a,l+=(c-l)/a,u+=(d-u)/a;for(a=0;a<r;++a)s[a]-=l,o[a]-=u;return[s,o,l,u]}function yy(e,t,n,i){let s,o,r=-1;for(const a of e)s=t(a),o=n(a),null!=s&&(s=+s)>=s&&null!=o&&(o=+o)>=o&&i(s,o,++r)}function qg(e,t,n,i,r){let s=0,o=0;return yy(e,t,n,(a,l)=>{const u=l-r(a),c=l-i;s+=u*u,o+=c*c}),1-s/o}function Jk(e,t,n){let i=0,r=0,s=0,o=0,a=0;yy(e,t,n,(c,d)=>{++a,i+=(c-i)/a,r+=(d-r)/a,s+=(c*d-s)/a,o+=(c*c-o)/a});const l=_y(i,r,s,o),u=c=>l[0]+l[1]*c;return{coef:l,predict:u,rSquared:qg(e,t,n,r,u)}}function dY(e,t,n){let i=0,r=0,s=0,o=0,a=0;yy(e,t,n,(c,d)=>{++a,c=Math.log(c),i+=(c-i)/a,r+=(d-r)/a,s+=(c*d-s)/a,o+=(c*c-o)/a});const l=_y(i,r,s,o),u=c=>l[0]+l[1]*Math.log(c);return{coef:l,predict:u,rSquared:qg(e,t,n,r,u)}}function fY(e,t,n){const[i,r,s,o]=PD(e,t,n);let f,h,p,a=0,l=0,u=0,c=0,d=0;yy(e,t,n,(y,v)=>{f=i[d++],h=Math.log(v),p=f*v,a+=(v*h-a)/d,l+=(p-l)/d,u+=(p*h-u)/d,c+=(f*p-c)/d});const[g,m]=_y(l/o,a/o,u/o,c/o),_=y=>Math.exp(g+m*(y-s));return{coef:[Math.exp(g-m*s),m],predict:_,rSquared:qg(e,t,n,o,_)}}function hY(e,t,n){let i=0,r=0,s=0,o=0,a=0,l=0;yy(e,t,n,(d,f)=>{const h=Math.log(d),p=Math.log(f);++l,i+=(h-i)/l,r+=(p-r)/l,s+=(h*p-s)/l,o+=(h*h-o)/l,a+=(f-a)/l});const u=_y(i,r,s,o),c=d=>u[0]*Math.pow(d,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:c,rSquared:qg(e,t,n,a,c)}}function Xk(e,t,n){const[i,r,s,o]=PD(e,t,n),a=i.length;let h,p,g,m,l=0,u=0,c=0,d=0,f=0;for(h=0;h<a;)p=i[h],g=r[h++],m=p*p,l+=(m-l)/h,u+=(m*p-u)/h,c+=(m*m-c)/h,d+=(p*g-d)/h,f+=(m*g-f)/h;const _=c-l*l,y=l*_-u*u,v=(f*l-d*u)/y,b=(d*_-f*u)/y,D=-v*l,C=w=>v*(w-=s)*w+b*w+D+o;return{coef:[D-b*s+v*s*s+o,b-2*v*s,v],predict:C,rSquared:qg(e,t,n,o,C)}}function pY(e,t,n,i){if(1===i)return Jk(e,t,n);if(2===i)return Xk(e,t,n);const[r,s,o,a]=PD(e,t,n),l=r.length,u=[],c=[],d=i+1;let f,h,p,g,m;for(f=0;f<d;++f){for(p=0,g=0;p<l;++p)g+=Math.pow(r[p],f)*s[p];for(u.push(g),m=new Float64Array(d),h=0;h<d;++h){for(p=0,g=0;p<l;++p)g+=Math.pow(r[p],f+h);m[h]=g}c.push(m)}c.push(u);const _=function EOe(e){const t=e.length-1,n=[];let i,r,s,o,a;for(i=0;i<t;++i){for(o=i,r=i+1;r<t;++r)Math.abs(e[i][r])>Math.abs(e[i][o])&&(o=r);for(s=i;s<t+1;++s)a=e[s][i],e[s][i]=e[s][o],e[s][o]=a;for(r=i+1;r<t;++r)for(s=t;s>=i;s--)e[s][r]-=e[s][i]*e[i][r]/e[i][i]}for(r=t-1;r>=0;--r){for(a=0,s=r+1;s<t;++s)a+=e[s][r]*n[s];n[r]=(e[t][r]-a)/e[r][r]}return n}(c),y=v=>{let b=a+_[0]+_[1]*(v-=o)+_[2]*v*v;for(f=3;f<d;++f)b+=_[f]*Math.pow(v,f);return b};return{coef:COe(d,_,-o,a),predict:y,rSquared:qg(e,t,n,a,y)}}function COe(e,t,n,i){const r=Array(e);let s,o,a,l;for(s=0;s<e;++s)r[s]=0;for(s=e-1;s>=0;--s)for(a=t[s],l=1,r[s]+=a,o=1;o<=s;++o)l*=(s+1-o)/o,r[s-o]+=a*Math.pow(n,o)*l;return r[0]+=i,r}function _Y(e,t,n,i){const[r,s,o,a]=PD(e,t,n,!0),l=r.length,u=Math.max(2,~~(i*l)),c=new Float64Array(l),d=new Float64Array(l),f=new Float64Array(l).fill(1);for(let h=-1;++h<=2;){const p=[0,u-1];for(let m=0;m<l;++m){const _=r[m],y=p[0],v=p[1];let D=0,C=0,w=0,E=0,T=0;const O=1/Math.abs(r[_-r[y]>r[v]-_?y:v]-_||1);for(let j=y;j<=v;++j){const A=r[j],x=s[j],S=SOe(Math.abs(_-A)*O)*f[j],I=A*S;D+=S,C+=I,w+=x*S,E+=x*I,T+=A*I}const[N,P]=_y(C/D,w/D,E/D,T/D);c[m]=N+P*_,d[m]=Math.abs(s[m]-c[m]),xOe(r,m+1,p)}if(2===h)break;const g=nY(d);if(Math.abs(g)<1e-12)break;for(let _,y,m=0;m<l;++m)_=d[m]/(6*g),f[m]=_>=1?1e-12:(y=1-_*_)*y}return function AOe(e,t,n,i){const r=e.length,s=[];let u,o=0,a=0,l=[];for(;o<r;++o)u=e[o]+n,l[0]===u?l[1]+=(t[o]-l[1])/++a:(a=0,l[1]+=i,l=[u,t[o]],s.push(l));return l[1]+=i,s}(r,c,o,a)}function SOe(e){return(e=1-e*e*e)*e*e}function xOe(e,t,n){const i=e[t];let r=n[0],s=n[1]+1;if(!(s>=e.length))for(;t>r&&e[s]-i<=i-e[r];)n[0]=++r,n[1]=s,++s}const MOe=.5*Math.PI/180;function LD(e,t,n,i){n=n||25,i=Math.max(n,i||200);const r=g=>[g,e(g)],s=t[0],o=t[1],a=o-s,l=a/i,u=[r(s)],c=[];if(n===i){for(let g=1;g<i;++g)u.push(r(s+g/n*a));return u.push(r(o)),u}c.push(r(o));for(let g=n;--g>0;)c.push(r(s+g/n*a));let d=u[0],f=c[c.length-1];const h=1/a,p=function TOe(e,t){let n=e,i=e;const r=t.length;for(let s=0;s<r;++s){const o=t[s][1];o<n&&(n=o),o>i&&(i=o)}return 1/(i-n)}(d[1],c);for(;f;){const g=r((d[0]+f[0])/2);g[0]-d[0]>=l&&OOe(d,g,f,h,p)>MOe?c.push(g):(d=f,u.push(f),c.pop()),f=c[c.length-1]}return u}function OOe(e,t,n,i,r){const s=Math.atan2(r*(n[1]-e[1]),i*(n[0]-e[0])),o=Math.atan2(r*(t[1]-e[1]),i*(t[0]-e[0]));return Math.abs(s-o)}function Ys(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((t-e)/n)),s=new Array(r);++i<r;)s[i]=e+i*n;return s}function Qk(e){return e&&e.length?1===e.length?e[0]:function kOe(e){return t=>{const n=e.length;let i=1,r=String(e[0](t));for(;i<n;++i)r+="|"+e[i](t);return r}}(e):function(){return""}}function yY(e,t,n){return n||e+(t?"_"+t:"")}const Zk=()=>{},IOe={init:Zk,add:Zk,rem:Zk,idx:0},vy={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||void 0===e.min)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||void 0===e.max)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},by=Object.keys(vy);function vY(e,t){return vy[e](t)}function bY(e,t){return e.idx-t.idx}function POe(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function LOe(e,t){null!=e&&""!==e?e==e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t))):++this.missing}function jOe(e,t){null!=e&&""!==e?e==e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t))):--this.missing}function BOe(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function wY(e,t){const n=t||hr,i=function FOe(e){const t={};e.forEach(i=>t[i.name]=i);const n=i=>{!i.req||i.req.forEach(r=>{t[r]||n(t[r]=vy[r]())})};return e.forEach(n),Object.values(t).sort(bY)}(e),r=e.slice().sort(bY);function s(o){this._ops=i,this._out=r,this.cell=o,this.init()}return s.prototype.init=POe,s.prototype.add=LOe,s.prototype.rem=jOe,s.prototype.set=BOe,s.prototype.get=n,s.fields=e.map(o=>o.out),s}function eI(e){this._key=e?ls(e):Pe,this.reset()}by.forEach(e=>{vy[e]=function ROe(e,t){return n=>st({name:e,out:n||e},IOe,t)}(e,vy[e])});const Yi=eI.prototype;function td(e){J.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}function tI(e){J.call(this,null,e)}function DY(e,t,n){const i=e;let r=t||[],s=n||[],o={},a=0;return{add:l=>s.push(l),remove:l=>o[i(l)]=++a,size:()=>r.length,data:(l,u)=>(a&&(r=r.filter(c=>!o[i(c)]),o={},a=0),u&&l&&r.sort(l),s.length&&(r=l?lG(l,r,s.sort(l)):r.concat(s),s=[]),r)}}function nI(e){J.call(this,[],e)}function CY(e){fn.call(this,null,VOe,e)}function VOe(e){return this.value&&!e.modified()?this.value:MN(e.fields,e.orders)}function iI(e){J.call(this,null,e)}function rI(e){J.call(this,null,e)}Yi.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},Yi.add=function(e){this._add.push(e)},Yi.rem=function(e){this._rem.push(e)},Yi.values=function(){if(this._get=null,0===this._rem.length)return this._add;const e=this._add,t=this._rem,n=this._key,i=e.length,r=t.length,s=Array(i-r),o={};let a,l,u;for(a=0;a<r;++a)o[n(t[a])]=1;for(a=0,l=0;a<i;++a)o[n(u=e[a])]?o[n(u)]=0:s[l++]=u;return this._rem=[],this._add=s},Yi.distinct=function(e){const t=this.values(),n={};let s,i=t.length,r=0;for(;--i>=0;)s=e(t[i])+"",ke(n,s)||(n[s]=1,++r);return r},Yi.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=nG(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},Yi.argmin=function(e){return this.extent(e)[0]||{}},Yi.argmax=function(e){return this.extent(e)[1]||{}},Yi.min=function(e){const t=this.extent(e)[0];return null!=t?e(t):void 0},Yi.max=function(e){const t=this.extent(e)[1];return null!=t?e(t):void 0},Yi.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=Lk(this.values(),e),this._get=e),this._q},Yi.q1=function(e){return this.quartile(e)[0]},Yi.q2=function(e){return this.quartile(e)[1]},Yi.q3=function(e){return this.quartile(e)[2]},Yi.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=sY(this.values(),1e3,.05,e),this._get=e),this._ci},Yi.ci0=function(e){return this.ci(e)[0]},Yi.ci1=function(e){return this.ci(e)[1]},td.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:by},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},fe(td,J,{transform(e,t){const n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.modified();return n.stamp=i.stamp,n.value&&(r||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(n.value=n.value||n.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),i.modifies(n._outputs),n._drop=!1!==e.drop,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},cross(){const e=this,t=e.value,n=e._dnames,i=n.map(()=>({})),r=n.length;function s(a){let l,u,c,d;for(l in a)for(c=a[l].tuple,u=0;u<r;++u)i[u][d=c[n[u]]]=d}s(e._prev),s(t),function o(a,l,u){const c=n[u],d=i[u++];for(const f in d){const h=a?a+"|"+f:f;l[c]=d[f],u<r?o(h,l,u):t[h]||e.cell(h,l)}}("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],i={};function r(m){const _=we(fr(m)),y=_.length;let b,v=0;for(;v<y;++v)i[b=_[v]]||(i[b]=1,t.push(b))}this._dims=we(e.groupby),this._dnames=this._dims.map(m=>{const _=qn(m);return r(m),n.push(_),_}),this.cellkey=e.key?e.key:Qk(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const s=e.fields||[null],o=e.ops||["count"],a=e.as||[],l=s.length,u={};let c,d,f,h,p,g;for(l!==o.length&&ee("Unmatched number of fields and aggregate ops."),g=0;g<l;++g)c=s[g],d=o[g],null==c&&"count"!==d&&ee("Null aggregate field specified."),h=qn(c),p=yY(d,h,a[g]),n.push(p),"count"!==d?(f=u[h],f||(r(c),f=u[h]=[],f.field=c,this._measures.push(f)),"count"!==d&&(this._countOnly=!1),f.push(vY(d,p))):this._counts.push(p);return this._measures=this._measures.map(m=>wY(m,m.field)),{}},cellkey:Qk(),cell(e,t){let n=this.value[e];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const i=this._measures,r=i.length;n.agg=Array(r);for(let s=0;s<r;++s)n.agg[s]=new i[s](n)}return n.store&&(n.data=new eI),n},newtuple(e,t){const n=this._dnames,i=this._dims,r=i.length,s={};for(let o=0;o<r;++o)s[n[o]]=i[o](e);return t?$W(t.tuple,s):Vt(s)},clean(){const e=this.value;for(const t in e)0===e[t].num&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].add(i[r].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].rem(i[r].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let i=0,r=n.length;i<r;++i)t[n[i]]=e.num;if(!this._countOnly){const i=e.agg;for(let r=0,s=i.length;r<s;++r)i[r].set(t)}return t},changes(e){const t=this._adds,n=this._mods,i=this._prev,r=this._drop,s=e.add,o=e.rem,a=e.mod;let l,u,c,d;if(i)for(u in i)l=i[u],(!r||l.num)&&o.push(l.tuple);for(c=0,d=this._alen;c<d;++c)s.push(this.celltuple(t[c])),t[c]=null;for(c=0,d=this._mlen;c<d;++c)l=n[c],(0===l.num&&r?o:a).push(this.celltuple(l)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}}),tI.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},fe(tI,J,{transform(e,t){const n=!1!==e.interval,i=this._bins(e),r=i.start,s=i.step,o=e.as||["bin0","bin1"],a=o[0],l=o[1];let u;return u=e.modified()?(t=t.reflow(!0)).SOURCE:t.modified(fr(e.field))?t.ADD_MOD:t.ADD,t.visit(u,n?c=>{const d=i(c);c[a]=d,c[l]=null==d?null:r+s*(1+(d-r)/s)}:c=>c[a]=i(c)),t.modifies(n?o:a)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=rY(e),i=n.step;let o,a,r=n.start,s=r+Math.ceil((n.stop-r)/i)*i;null!=(o=e.anchor)&&(a=o-(r+i*Math.floor((o-r)/i)),r+=a,s+=a);const l=function(u){let c=pr(t(u));return null==c?null:c<r?-1/0:c>s?1/0:(c=Math.max(r,Math.min(c,s-i)),r+i*Math.floor(1e-14+(c-r)/i))};return l.start=r,l.stop=n.stop,l.step=i,this.value=as(l,fr(t),e.name||"bin_"+qn(t))}}),nI.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},fe(nI,J,{transform(e,t){const n=t.fork(t.ALL),i=DY(Pe,this.value,n.materialize(n.ADD).add),r=e.sort,s=t.changed()||r&&(e.modified("sort")||t.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(s),this.value=n.source=i.data(Xf(r),s),t.source&&t.source.root&&(this.value.root=t.source.root),n}}),fe(CY,fn),iI.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},fe(iI,J,{transform(e,t){const n=d=>f=>{for(var p,h=function HOe(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase()}return e.match(n)}(a(f),e.case,s)||[],g=0,m=h.length;g<m;++g)o.test(p=h[g])||d(p)},i=this._parameterCheck(e,t),r=this._counts,s=this._match,o=this._stop,a=e.field,l=e.as||["text","count"],u=n(d=>r[d]=1+(r[d]||0)),c=n(d=>r[d]-=1);return i?t.visit(t.SOURCE,u):(t.visit(t.ADD,u),t.visit(t.REM,c)),this._finish(t,l)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,i=this._tuples||(this._tuples={}),r=t[0],s=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS);let a,l,u;for(a in n)l=i[a],u=n[a]||0,!l&&u?(i[a]=l=Vt({}),l[r]=a,l[s]=u,o.add.push(l)):0===u?(l&&o.rem.push(l),n[a]=null,i[a]=null):l[s]!==u&&(l[s]=u,o.mod.push(l));return o.modifies(t)}}),rI.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},fe(rI,J,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.as||["a","b"],r=i[0],s=i[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let a=this.value;return o?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=function UOe(e,t,n,i){for(var l,u,r=[],s={},o=e.length,a=0;a<o;++a)for(s[t]=u=e[a],l=0;l<o;++l)s[n]=e[l],i(s)&&(r.push(Vt(s)),(s={})[t]=u);return r}(a,r,s,e.filter||Oo)):n.mod=a,n.source=this.value,n.modifies(i)}});const EY={kde:Vk,mixture:uY,normal:$k,lognormal:lY,uniform:cY},SY="function";function xY(e,t){const n=e[SY];ke(EY,n)||ee("Unknown distribution function: "+n);const i=EY[n]();for(const r in e)"field"===r?i.data((e.from||t()).map(e[r])):"distributions"===r?i[r](e[r].map(s=>xY(s,t))):typeof i[r]===SY&&i[r](e[r]);return i}function sI(e){J.call(this,null,e)}const AY=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}];function MY(e,t){return e?e.map((n,i)=>t[i]||qn(n)):null}function oI(e,t,n){const i=[],r=d=>d(l);let s,o,a,l,u,c;if(null==t)i.push(e.map(n));else for(s={},o=0,a=e.length;o<a;++o)l=e[o],u=t.map(r),c=s[u],c||(s[u]=c=[],c.dims=u,i.push(c)),c.push(n(l));return i}function aI(e){J.call(this,null,e)}function OY(e){fn.call(this,null,KOe,e),this.modified(!0)}function KOe(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:as(n=>t(n,e),fr(t),qn(t))}function lI(e){J.call(this,[void 0,void 0],e)}function uI(e,t){fn.call(this,e),this.parent=t,this.count=0}function jD(e){J.call(this,{},e),this._keys=Ng();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let i=0,r=t.active;i<r;++i)n(t[i],i,t)}}function NY(e){fn.call(this,null,JOe,e)}function JOe(e){return this.value&&!e.modified()?this.value:ne(e.name)?we(e.name).map(t=>ls(t)):ls(e.name,e.as)}function cI(e){J.call(this,Ng(),e)}function dI(e){J.call(this,[],e)}function fI(e){J.call(this,[],e)}function hI(e){J.call(this,null,e)}function kY(e){J.call(this,[],e)}sI.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:AY.concat({key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:AY},{name:"weights",type:"number",array:!0}]})},{name:"as",type:"string",array:!0,default:["value","density"]}]},fe(sI,J,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=xY(e.distribution,function WOe(e){return()=>e.materialize(e.SOURCE).source}(t)),r=e.steps||e.minsteps||25,s=e.steps||e.maxsteps||200;let o=e.method||"pdf";"pdf"!==o&&"cdf"!==o&&ee("Invalid density method: "+o),!e.extent&&!i.data&&ee("Missing density extent parameter."),o=i[o];const a=e.as||["value","density"],u=LD(o,e.extent||wl(i.data()),r,s).map(c=>{const d={};return d[a[0]]=c[0],d[a[1]]=c[1],Vt(d)});this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}}),aI.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]},fe(aI,J,{transform(e,t){if(this.value&&!e.modified()&&!t.changed())return t;const n=t.materialize(t.SOURCE).source,i=oI(t.source,e.groupby,hr),r=e.smooth||!1,s=e.field,o=e.step||((e,t)=>Q_(wl(e,t))/30)(n,s),a=Xf((p,g)=>s(p)-s(g)),l=e.as||"bin",u=i.length;let h,c=1/0,d=-1/0,f=0;for(;f<u;++f){const p=i[f].sort(a);h=-1;for(const g of oY(p,o,r,s))g<c&&(c=g),g>d&&(d=g),p[++h][l]=g}return this.value={start:c,stop:d,step:o},t.reflow(!0).modifies(l)}}),fe(OY,fn),lI.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},fe(lI,J,{transform(e,t){const n=this.value,i=e.field,r=t.changed()||t.modified(i.fields)||e.modified("field");let s=n[0],o=n[1];if((r||null==s)&&(s=1/0,o=-1/0),t.visit(r?t.SOURCE:t.ADD,a=>{const l=pr(i(a));null!=l&&(l<s&&(s=l),l>o&&(o=l))}),!Number.isFinite(s)||!Number.isFinite(o)){let a=qn(i);a&&(a=' for field "'.concat(a,'"')),t.dataflow.warn("Infinite extent".concat(a,": [").concat(s,", ").concat(o,"]")),s=o=void 0}this.value=[s,o]}}),fe(uI,fn,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}}),fe(jD,J,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,i){const r=this.value;let o,a,s=ke(r,e)&&r[e];return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=i||(a=this._group[e])&&a.tuple,o=n.dataflow,s=new uI(n.fork(n.NO_SOURCE),this),o.add(s).connect(t(o,e,a)),r[e]=s,this.activate(s)),s},clean(){const e=this.value;let t=0;for(const n in e)if(0===e[n].count){const i=e[n].detachSubflow;i&&i(),delete e[n],++t}if(t){const n=this._targets.filter(i=>i&&i.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,i=e?e.length:0;let r=0;for(;r<i;++r)t[r]=e[r];for(;r<n&&null!=t[r];++r)t[r]=null;t.active=i},transform(e,t){const n=t.dataflow,i=e.key,r=e.subflow,s=this._keys,o=e.modified("key"),a=l=>this.subflow(l,r,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,l=>{const u=Pe(l),c=s.get(u);void 0!==c&&(s.delete(u),a(c).rem(l))}),t.visit(t.ADD,l=>{const u=i(l);s.set(Pe(l),u),a(u).add(l)}),o||t.modified(i.fields)?t.visit(t.MOD,l=>{const u=Pe(l),c=s.get(u),d=i(l);c===d?a(d).mod(l):(s.set(u,d),a(c).rem(l),a(d).add(l))}):t.changed(t.MOD)&&t.visit(t.MOD,l=>{a(s.get(Pe(l))).mod(l)}),o&&t.visit(t.REFLOW,l=>{const u=Pe(l),c=s.get(u),d=i(l);c!==d&&(s.set(u,d),a(c).rem(l),a(d).add(l))}),t.clean()?n.runAfter(()=>{this.clean(),s.clean()}):s.empty>n.cleanThreshold&&n.runAfter(s.clean),t}}),fe(NY,fn),cI.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},fe(cI,J,{transform(e,t){const n=t.dataflow,i=this.value,r=t.fork(),s=r.add,o=r.rem,a=r.mod,l=e.expr;let u=!0;function c(d){const f=Pe(d),h=l(d,e),p=i.get(f);h&&p?(i.delete(f),s.push(d)):h||p?u&&h&&!p&&a.push(d):(i.set(f,1),o.push(d))}return t.visit(t.REM,d=>{const f=Pe(d);i.has(f)?i.delete(f):o.push(d)}),t.visit(t.ADD,d=>{l(d,e)?s.push(d):i.set(Pe(d),1)}),t.visit(t.MOD,c),e.modified()&&(u=!1,t.visit(t.REFLOW,c)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),r}}),dI.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},fe(dI,J,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=MY(i,e.as||[]),s=e.index||null,o=r.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{const l=i.map(p=>p(a)),u=l.reduce((p,g)=>Math.max(p,g.length),0);let d,f,h,c=0;for(;c<u;++c){for(f=xk(a),d=0;d<o;++d)f[r[d]]=null==(h=l[d][c])?null:h;s&&(f[s]=c),n.add.push(f)}}),this.value=n.source=n.add,s&&n.modifies(s),n.modifies(r)}}),fI.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},fe(fI,J,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=i.map(qn),s=e.as||["key","value"],o=s[0],a=s[1],l=i.length;return n.rem=this.value,t.visit(t.SOURCE,u=>{for(let d,c=0;c<l;++c)d=xk(u),d[o]=r[c],d[a]=i[c](u),n.add.push(d)}),this.value=n.source=n.add,n.modifies(s)}}),hI.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},fe(hI,J,{transform(e,t){const n=e.expr,i=e.as,r=e.modified(),s=e.initonly?t.ADD:r?t.SOURCE:t.modified(n.fields)||t.modified(i)?t.ADD_MOD:t.ADD;return r&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(i),t.visit(s,o=>o[i]=n(o,e))}}),fe(kY,J,{transform(e,t){const n=t.fork(t.ALL),i=e.generator;let o,a,l,r=this.value,s=e.size-r.length;if(s>0){for(o=[];--s>=0;)o.push(l=Vt(i(e))),r.push(l);n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else a=r.slice(0,-s),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,r=r.slice(-s);return n.source=this.value=r,n}});const BD={value:"value",median:nY,mean:function NOe(e,t){let n=0,i=0;if(void 0===t)for(let r of e)null!=r&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let s of e)null!=(s=t(s,++r,e))&&(s=+s)>=s&&(++n,i+=s)}if(n)return i/n},min:Rk,max:Zf},XOe=[];function pI(e){J.call(this,[],e)}function gI(e){td.call(this,e)}function mI(e){J.call(this,null,e)}function IY(e){fn.call(this,null,t2e,e)}function t2e(e){return this.value&&!e.modified()?this.value:ON(e.fields,e.flat)}function RY(e){J.call(this,[],e),this._pending=null}function _I(e,t,n){n.forEach(Vt);const i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i}function yI(e){J.call(this,{},e)}function FY(e){fn.call(this,null,i2e,e)}function i2e(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let s,o,i=1/0,r=-1/0;for(s=0;s<n;++s)o=t[s],o[0]<i&&(i=o[0]),o[1]>r&&(r=o[1]);return[i,r]}function PY(e){fn.call(this,null,r2e,e)}function r2e(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function LY(e){J.call(this,null,e)}function vI(e){td.call(this,e)}function jY(e){jD.call(this,e)}function bI(e){J.call(this,null,e)}function BY(e){J.call(this,null,e)}function wI(e){J.call(this,null,e)}function $Y(e){J.call(this,null,e)}function DI(e){J.call(this,[],e),this.count=0}function CI(e){J.call(this,null,e)}function VY(e){J.call(this,null,e),this.modified(!0)}function EI(e){J.call(this,null,e)}pI.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},fe(pI,J,{transform(e,t){var f,h,p,g,m,_,y,v,b,D,n=t.fork(t.ALL),i=function QOe(e){var n,t=e.method||BD.value;if(null!=BD[t])return t===BD.value?(n=void 0!==e.value?e.value:0,()=>n):BD[t];ee("Unrecognized imputation method: "+t)}(e),r=function ZOe(e){const t=e.field;return n=>n?t(n):NaN}(e),s=qn(e.field),o=qn(e.key),a=(e.groupby||[]).map(qn),l=function e2e(e,t,n,i){var u,c,d,f,h,p,g,m,r=_=>_(m),s=[],o=i?i.slice():[],a={},l={};for(o.forEach((_,y)=>a[_]=y+1),f=0,g=e.length;f<g;++f)p=n(m=e[f]),h=a[p]||(a[p]=o.push(p)),(d=l[c=(u=t?t.map(r):XOe)+""])||(d=l[c]=[],s.push(d),d.values=u),d[h-1]=m;return s.domain=o,s}(t.source,e.groupby,e.key,e.keyvals),u=[],c=this.value,d=l.domain.length;for(m=0,v=l.length;m<v;++m)for(p=(f=l[m]).values,h=NaN,y=0;y<d;++y)if(null==f[y]){for(g=l.domain[y],D={_impute:!0},_=0,b=p.length;_<b;++_)D[a[_]]=p[_];D[o]=g,D[s]=Number.isNaN(h)?h=i(f,r):h,u.push(Vt(D))}return u.length&&(n.add=n.materialize(n.ADD).add.concat(u)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=u,n}}),gI.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:by},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},fe(gI,td,{transform(e,t){const n=this,i=e.modified();let r;return n.value&&(i||t.modified(n._inputs,!0))?(r=n.value=i?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(r=n.value=n.value||this.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),n.changes(),t.visit(t.SOURCE,s=>{st(s,r[n.cellkey(s)].tuple)}),t.reflow(i).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n)this.celltuple(e[n]),e[n]=null;for(n=0,i=this._mlen;n<i;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}}),mI.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},fe(mI,J,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=oI(i,e.groupby,e.field),s=(e.groupby||[]).map(qn),o=e.bandwidth,a=e.cumulative?"cdf":"pdf",l=e.as||["value","density"],u=[];let c=e.extent,d=e.steps||e.minsteps||25,f=e.steps||e.maxsteps||200;"pdf"!==a&&"cdf"!==a&&ee("Invalid density method: "+a),"shared"===e.resolve&&(c||(c=wl(i,e.field)),d=f=e.steps||f),r.forEach(h=>{const p=Vk(h,o)[a],g=e.counts?h.length:1;LD(p,c||wl(h),d,f).forEach(_=>{const y={};for(let v=0;v<s.length;++v)y[s[v]]=h.dims[v];y[l[0]]=_[0],y[l[1]]=_[1]*g,u.push(Vt(y))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}}),fe(IY,fn),fe(RY,J,{transform(e,t){const n=t.dataflow;return this._pending?_I(this,t,this._pending):function n2e(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}(e)?t.StopPropagation:e.values?_I(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(r=>(this._pending=we(r.data),s=>s.touch(this)))}:n.request(e.url,e.format).then(i=>_I(this,t,we(i.data)))}}),yI.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},fe(yI,J,{transform(e,t){const n=e.fields,i=e.index,r=e.values,s=null==e.default?null:e.default,o=e.modified(),a=n.length;let d,f,h,l=o?t.SOURCE:t.ADD,u=t,c=e.as;return r?(f=r.length,a>1&&!c&&ee('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==a*f&&ee('The "as" parameter has too few output field names.'),c=c||r.map(qn),d=function(p){for(var _,y,g=0,m=0;g<a;++g)if(null==(y=i.get(n[g](p))))for(_=0;_<f;++_,++m)p[c[m]]=s;else for(_=0;_<f;++_,++m)p[c[m]]=r[_](y)}):(c||ee("Missing output field names."),d=function(p){for(var m,g=0;g<a;++g)m=i.get(n[g](p)),p[c[g]]=null==m?s:m}),o?u=t.reflow(!0):(h=n.some(p=>t.modified(p.fields)),l|=h?t.MOD:0),t.visit(l,d),u.modifies(c)}}),fe(FY,fn),fe(PY,fn),fe(LY,J,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),vI.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:by,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},fe(vI,td,{_transform:td.prototype.transform,transform(e,t){return this._transform(function s2e(e,t){const n=e.field,i=e.value,r=("count"===e.op?"__count__":e.op)||"sum",s=fr(n).concat(fr(i)),o=function a2e(e,t,n){const i={},r=[];return n.visit(n.SOURCE,s=>{const o=e(s);i[o]||(i[o]=1,r.push(o))}),r.sort(lD),t?r.slice(0,t):r}(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:o.map(()=>r),fields:o.map(a=>function o2e(e,t,n,i){return as(r=>t(r)===e?n(r):NaN,i,e+"")}(a,n,i,s)),as:o.map(a=>a+""),modified:e.modified.bind(e)}}(e,t),t)}}),fe(jY,jD,{transform(e,t){const n=e.subflow,i=e.field,r=s=>this.subflow(Pe(s),n,t,s);return(e.modified("field")||i&&t.modified(fr(i)))&&ee("PreFacet does not support field modification."),this.initTargets(),i?(t.visit(t.MOD,s=>{const o=r(s);i(s).forEach(a=>o.mod(a))}),t.visit(t.ADD,s=>{const o=r(s);i(s).forEach(a=>o.add(Vt(a)))}),t.visit(t.REM,s=>{const o=r(s);i(s).forEach(a=>o.rem(a))})):(t.visit(t.MOD,s=>r(s).mod(s)),t.visit(t.ADD,s=>r(s).add(s)),t.visit(t.REM,s=>r(s).rem(s))),t.clean()&&t.runAfter(()=>this.clean()),t}}),bI.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},fe(bI,J,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=MY(e.fields,e.as||[]),s=i?(a,l)=>function l2e(e,t,n,i){for(let r=0,s=n.length;r<s;++r)t[i[r]]=n[r](e);return t}(a,l,i,r):xD;let o;return this.value?o=this.value:(t=t.addAll(),o=this.value={}),t.visit(t.REM,a=>{const l=Pe(a);n.rem.push(o[l]),o[l]=null}),t.visit(t.ADD,a=>{const l=s(a,Vt({}));o[Pe(a)]=l,n.add.push(l)}),t.visit(t.MOD,a=>{n.mod.push(s(a,o[Pe(a)]))}),n}}),fe(BY,J,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}}),wI.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]},fe(wI,J,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const s=oI(t.materialize(t.SOURCE).source,e.groupby,e.field),o=(e.groupby||[]).map(qn),a=[],l=e.step||.01,u=e.probs||Ys(l/2,1-1e-14,l),c=u.length;return s.forEach(d=>{const f=Pk(d,u);for(let h=0;h<c;++h){const p={};for(let g=0;g<o.length;++g)p[o[g]]=d.dims[g];p[i[0]]=u[h],p[i[1]]=f[h],a.push(Vt(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}}),fe($Y,J,{transform(e,t){let n,i;return this.value?i=this.value:(n=t=t.addAll(),i=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,r=>{const s=Pe(r);n.rem.push(i[s]),i[s]=null}),t.visit(t.ADD,r=>{const s=xk(r);i[Pe(r)]=s,n.add.push(s)}),t.visit(t.MOD,r=>{const s=i[Pe(r)];for(const o in r)s[o]=r[o],n.modifies(o);n.mod.push(s)})),n}}),DI.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},fe(DI,J,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.modified("size"),r=e.size,s=this.value.reduce((c,d)=>(c[Pe(d)]=1,c),{});let o=this.value,a=this.count,l=0;function u(c){let d,f;o.length<r?o.push(c):(f=~~((a+1)*Io()),f<o.length&&f>=l&&(d=o[f],s[Pe(d)]&&n.rem.push(d),o[f]=c)),++a}if(t.rem.length&&(t.visit(t.REM,c=>{const d=Pe(c);s[d]&&(s[d]=-1,n.rem.push(c)),--a}),o=o.filter(c=>-1!==s[Pe(c)])),(t.rem.length||i)&&o.length<r&&t.source&&(l=a=o.length,t.visit(t.SOURCE,c=>{s[Pe(c)]||u(c)}),l=-1),i&&o.length>r){const c=o.length-r;for(let d=0;d<c;++d)s[Pe(o[d])]=-1,n.rem.push(o[d]);o=o.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{s[Pe(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,u),(t.add.length||l<0)&&(n.add=o.filter(c=>!s[Pe(c)])),this.count=a,this.value=n.source=o,n}}),CI.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},fe(CI,J,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),i=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Ys(e.start,e.stop,e.step||1).map(r=>{const s={};return s[i]=r,Vt(s)}),n.add=t.add.concat(this.value),n}}),fe(VY,J,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});const HY=["unit0","unit1"];function UY(e){J.call(this,Ng(),e)}function zY(e){J.call(this,null,e)}EI.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:ek,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:HY}]},fe(EI,J,{transform(e,t){const n=e.field,i=!1!==e.interval,r="utc"===e.timezone,s=this._floor(e,t),o=(r?$g:Bg)(s.unit).offset,a=e.as||HY,l=a[0],u=a[1],c=s.step;let d=s.start||1/0,f=s.stop||-1/0,h=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(fr(n)))&&(h=(t=t.reflow(!0)).SOURCE,d=1/0,f=-1/0),t.visit(h,p=>{const g=n(p);let m,_;null==g?(p[l]=null,i&&(p[u]=null)):(p[l]=m=_=s(g),i&&(p[u]=_=o(m,c)),m<d&&(d=m),_>f&&(f=_))}),s.start=d,s.stop=f,t.modifies(i?a:l)},_floor(e,t){const n="utc"===e.timezone,{units:i,step:r}=e.units?{units:e.units,step:e.step||1}:rW({extent:e.extent||wl(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),s=nk(i),o=this.value||{},a=(n?WG:GG)(s,r);return a.unit=bt(s),a.units=s,a.step=r,a.start=o.start,a.stop=o.stop,this.value=a}}),fe(UY,J,{transform(e,t){const n=t.dataflow,i=e.field,r=this.value,s=a=>r.set(i(a),a);let o=!0;return e.modified("field")||t.modified(i.fields)?(r.clear(),t.visit(t.SOURCE,s)):t.changed()?(t.visit(t.REM,a=>r.delete(i(a))),t.visit(t.ADD,s)):o=!1,this.modified(o),r.empty>n.cleanThreshold&&n.runAfter(r.clean),t.fork()}}),fe(zY,J,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(Xf(e.sort)):t.source).map(e.field))}});const wy={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?++e:e}}},percent_rank:function(){const e=wy.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,i=t.compare;let r=t.index;if(e<r){for(;r+1<n.length&&!i(n[r],n[r+1]);)++r;e=r}return(1+e)/n.length}}},ntile:function(e,t){(t=+t)>0||ee("ntile num must be greater than zero.");const n=wy.cume_dist(),i=n.next;return{init:n.init,next:r=>Math.ceil(t*i(r))}},lag:function(e,t){return t=+t||1,{next:n=>{const i=n.index-t;return i>=0?e(n.data[i]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const i=n.index+t,r=n.data;return i<r.length?e(r[i]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return(t=+t)>0||ee("nth_value nth must be greater than zero."),{next:n=>{const i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const i=e(n.data[n.index]);return null!=i?t=i:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:i=>{const r=i.data;return i.index<=n?t:(n=function d2e(e,t,n){for(let i=t.length;n<i;++n)if(null!=e(t[n]))return n;return-1}(e,r,i.index))<0?(n=r.length,t=null):t=e(r[n])}}}},f2e=Object.keys(wy);function qY(e){const t=we(e.ops),n=we(e.fields),i=we(e.params),r=we(e.as),s=this.outputs=[],o=this.windows=[],a={},l={},u=[],c=[];let d=!0;function f(h){we(fr(h)).forEach(p=>a[p]=1)}f(e.sort),t.forEach((h,p)=>{const g=n[p],m=qn(g),_=yY(h,m,r[p]);if(f(g),s.push(_),ke(wy,h))o.push(function c2e(e,t,n,i){const r=wy[e](t,n);return{init:r.init||Vc,update:function(s,o){o[i]=r.next(s)}}}(h,n[p],i[p],_));else{if(null==g&&"count"!==h&&ee("Null aggregate field specified."),"count"===h)return void u.push(_);d=!1;let y=l[m];y||(y=l[m]=[],y.field=g,c.push(y)),y.push(vY(h,_))}}),(u.length||c.length)&&(this.cell=function h2e(e,t,n){e=e.map(l=>wY(l,l.field));const i={num:0,agg:null,store:!1,count:t};if(!n)for(var r=e.length,s=i.agg=Array(r),o=0;o<r;++o)s[o]=new e[o](i);if(i.store)var a=i.data=new eI;return i.add=function(l){if(i.num+=1,!n){a&&a.add(l);for(let u=0;u<r;++u)s[u].add(s[u].get(l),l)}},i.rem=function(l){if(i.num-=1,!n){a&&a.rem(l);for(let u=0;u<r;++u)s[u].rem(s[u].get(l),l)}},i.set=function(l){let u,c;for(a&&a.values(),u=0,c=t.length;u<c;++u)l[t[u]]=i.num;if(!n)for(u=0,c=s.length;u<c;++u)s[u].set(l)},i.init=function(){i.num=0,a&&a.reset();for(let l=0;l<r;++l)s[l].init()},i}(c,u,d)),this.inputs=Object.keys(a)}const GY=qY.prototype;function SI(e){J.call(this,{},e),this._mlen=0,this._mods=[]}function p2e(e,t,n,i){const r=i.sort,s=r&&!i.ignorePeers,o=i.frame||[null,0],a=e.data(n),l=a.length,u=s?ey(r):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:r||gr(-1)};t.init();for(let d=0;d<l;++d)g2e(c,o,d,l),s&&m2e(c,u),t.update(c,a[d])}function g2e(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=null==t[0]?0:Math.max(0,n-Math.abs(t[0])),e.i1=null==t[1]?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n}function m2e(e,t){const n=e.i0,i=e.i1-1,r=e.compare,s=e.data,o=s.length-1;n>0&&!r(s[n],s[n-1])&&(e.i0=t.left(s,s[n])),i<o&&!r(s[i],s[i+1])&&(e.i1=t.right(s,s[i]))}function $D(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function VD(e){this._context=e}function nd(){}function WY(e){this._context=e}function YY(e){this._context=e}function KY(e,t){this._basis=new VD(e),this._beta=t}GY.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()},GY.update=function(e,t){const n=this.cell,i=this.windows,r=e.data,s=i&&i.length;let o;if(n){for(o=e.p0;o<e.i0;++o)n.rem(r[o]);for(o=e.p1;o<e.i1;++o)n.add(r[o]);n.set(t)}for(o=0;o<s;++o)i[o].update(e,t)},SI.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:f2e.concat(by)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},fe(SI,J,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),i=Xf(e.sort),r=Qk(e.groupby),s=a=>this.group(r(a));let o=this.state;(!o||n)&&(o=this.state=new qY(e)),n||t.modified(o.inputs)?(this.value={},t.visit(t.SOURCE,a=>s(a).add(a))):(t.visit(t.REM,a=>s(a).remove(a)),t.visit(t.ADD,a=>s(a).add(a)));for(let a=0,l=this._mlen;a<l;++a)p2e(this._mods[a],o,i,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(o.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=DY(Pe),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}}),VD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:$D(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:$D(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},WY.prototype={areaStart:nd,areaEnd:nd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:$D(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},YY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:$D(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},KY.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var l,i=e[0],r=t[0],s=e[n]-i,o=t[n]-r,a=-1;++a<=n;)this._basis.point(this._beta*e[a]+(1-this._beta)*(i+(l=a/n)*s),this._beta*t[a]+(1-this._beta)*(r+l*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const b2e=function e(t){function n(i){return 1===t?new VD(i):new KY(i,t)}return n.beta=function(i){return e(+i)},n}(.85);function HD(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function xI(e,t){this._context=e,this._k=(1-t)/6}xI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:HD(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:HD(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const w2e=function e(t){function n(i){return new xI(i,t)}return n.tension=function(i){return e(+i)},n}(0);function AI(e,t){this._context=e,this._k=(1-t)/6}AI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:HD(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const D2e=function e(t){function n(i){return new AI(i,t)}return n.tension=function(i){return e(+i)},n}(0);function MI(e,t){this._context=e,this._k=(1-t)/6}MI.prototype={areaStart:nd,areaEnd:nd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:HD(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const C2e=function e(t){function n(i){return new MI(i,t)}return n.tension=function(i){return e(+i)},n}(0),JY=Math.abs,yr=Math.atan2,Vu=Math.cos,E2e=Math.max,Gg=Math.min,fs=Math.sin,wn=Math.sqrt,vr=1e-12,id=Math.PI,UD=id/2,Dy=2*id;function S2e(e){return e>1?0:e<-1?id:Math.acos(e)}function XY(e){return e>=1?UD:e<=-1?-UD:Math.asin(e)}function TI(e,t,n){var i=e._x1,r=e._y1,s=e._x2,o=e._y2;if(e._l01_a>vr){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,r=(r*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>vr){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*u+e._x1*e._l23_2a-t*e._l12_2a)/c,o=(o*u+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(i,r,s,o,e._x2,e._y2)}function QY(e,t){this._context=e,this._alpha=t}QY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:TI(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const x2e=function e(t){function n(i){return t?new QY(i,t):new xI(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function ZY(e,t){this._context=e,this._alpha=t}ZY.prototype={areaStart:nd,areaEnd:nd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:TI(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const A2e=function e(t){function n(i){return t?new ZY(i,t):new MI(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function eK(e,t){this._context=e,this._alpha=t}eK.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:TI(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const M2e=function e(t){function n(i){return t?new eK(i,t):new AI(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function tK(e){this._context=e}function OI(e){return new tK(e)}function nK(e){this._context=e}function iK(e){return e<0?-1:1}function rK(e,t,n){var i=e._x1-e._x0,r=t-e._x1,s=(e._y1-e._y0)/(i||r<0&&-0),o=(n-e._y1)/(r||i<0&&-0),a=(s*r+o*i)/(i+r);return(iK(s)+iK(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function sK(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function NI(e,t,n){var i=e._x0,s=e._x1,o=e._y1,a=(s-i)/3;e._context.bezierCurveTo(i+a,e._y0+a*t,s-a,o-a*n,s,o)}function zD(e){this._context=e}function oK(e){this._context=new aK(e)}function aK(e){this._context=e}function lK(e){this._context=e}function uK(e){var t,i,n=e.length-1,r=new Array(n),s=new Array(n),o=new Array(n);for(r[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)r[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(r[n-1]=2,s[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)s[t]-=i=r[t]/s[t-1],o[t]-=i*o[t-1];for(r[n-1]=o[n-1]/s[n-1],t=n-2;t>=0;--t)r[t]=(o[t]-r[t+1])/s[t];for(s[n-1]=(e[n]+r[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-r[t+1];return[r,s]}function qD(e,t){this._context=e,this._t=t}tK.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},nK.prototype={areaStart:nd,areaEnd:nd,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},zD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:NI(this,this._t0,sK(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,NI(this,sK(this,n=rK(this,e,t)),n);break;default:NI(this,this._t0,n=rK(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(oK.prototype=Object.create(zD.prototype)).point=function(e,t){zD.prototype.point.call(this,t,e)},aK.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,s){this._context.bezierCurveTo(t,e,i,n,s,r)}},lK.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var i=uK(e),r=uK(t),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(i[0][s],r[0][s],i[1][s],r[1][s],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},qD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};const kI=Math.PI,II=2*kI,eh=1e-6,P2e=II-eh;function RI(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function cK(){return new RI}RI.prototype=cK.prototype={constructor:RI,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,i){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(e,t,n,i,r,s){this._+="C"+ +e+","+ +t+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+s)},arcTo:function(e,t,n,i,r){var s=this._x1,o=this._y1,a=(n=+n)-(e=+e),l=(i=+i)-(t=+t),u=s-e,c=o-t,d=u*u+c*c;if((r=+r)<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(d>eh)if(Math.abs(c*a-l*u)>eh&&r){var f=n-s,h=i-o,p=a*a+l*l,g=f*f+h*h,m=Math.sqrt(p),_=Math.sqrt(d),y=r*Math.tan((kI-Math.acos((p+d-g)/(2*m*_)))/2),v=y/_,b=y/m;Math.abs(v-1)>eh&&(this._+="L"+(e+v*u)+","+(t+v*c)),this._+="A"+r+","+r+",0,0,"+ +(c*f>u*h)+","+(this._x1=e+b*a)+","+(this._y1=t+b*l)}else this._+="L"+(this._x1=e)+","+(this._y1=t)},arc:function(e,t,n,i,r,s){e=+e,t=+t,s=!!s;var o=(n=+n)*Math.cos(i),a=n*Math.sin(i),l=e+o,u=t+a,c=1^s,d=s?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+u:(Math.abs(this._x1-l)>eh||Math.abs(this._y1-u)>eh)&&(this._+="L"+l+","+u),n&&(d<0&&(d=d%II+II),d>P2e?this._+="A"+n+","+n+",0,1,"+c+","+(e-o)+","+(t-a)+"A"+n+","+n+",0,1,"+c+","+(this._x1=l)+","+(this._y1=u):d>eh&&(this._+="A"+n+","+n+",0,"+ +(d>=kI)+","+c+","+(this._x1=e+n*Math.cos(r))+","+(this._y1=t+n*Math.sin(r))))},rect:function(e,t,n,i){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};const th=cK;function Ut(e){return function(){return e}}function L2e(e){return e.innerRadius}function j2e(e){return e.outerRadius}function B2e(e){return e.startAngle}function $2e(e){return e.endAngle}function V2e(e){return e&&e.padAngle}function H2e(e,t,n,i,r,s,o,a){var l=n-e,u=i-t,c=o-r,d=a-s,f=d*l-c*u;if(!(f*f<vr))return[e+(f=(c*(t-s)-d*(e-r))/f)*l,t+f*u]}function GD(e,t,n,i,r,s,o){var a=e-n,l=t-i,u=(o?s:-s)/wn(a*a+l*l),c=u*l,d=-u*a,f=e+c,h=t+d,p=n+c,g=i+d,m=(f+p)/2,_=(h+g)/2,y=p-f,v=g-h,b=y*y+v*v,D=r-s,C=f*g-p*h,w=(v<0?-1:1)*wn(E2e(0,D*D*b-C*C)),E=(C*v-y*w)/b,T=(-C*y-v*w)/b,O=(C*v+y*w)/b,N=(-C*y+v*w)/b,P=E-m,j=T-_,A=O-m,x=N-_;return P*P+j*j>A*A+x*x&&(E=O,T=N),{cx:E,cy:T,x01:-c,y01:-d,x11:E*(r/D-1),y11:T*(r/D-1)}}function dK(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function fK(e){return e[0]}function hK(e){return e[1]}function pK(e,t){var n=Ut(!0),i=null,r=OI,s=null;function o(a){var l,c,f,u=(a=dK(a)).length,d=!1;for(null==i&&(s=r(f=th())),l=0;l<=u;++l)!(l<u&&n(c=a[l],l,a))===d&&((d=!d)?s.lineStart():s.lineEnd()),d&&s.point(+e(c,l,a),+t(c,l,a));if(f)return s=null,f+""||null}return e="function"==typeof e?e:void 0===e?fK:Ut(e),t="function"==typeof t?t:void 0===t?hK:Ut(t),o.x=function(a){return arguments.length?(e="function"==typeof a?a:Ut(+a),o):e},o.y=function(a){return arguments.length?(t="function"==typeof a?a:Ut(+a),o):t},o.defined=function(a){return arguments.length?(n="function"==typeof a?a:Ut(!!a),o):n},o.curve=function(a){return arguments.length?(r=a,null!=i&&(s=r(i)),o):r},o.context=function(a){return arguments.length?(null==a?i=s=null:s=r(i=a),o):i},o}function gK(e,t,n){var i=null,r=Ut(!0),s=null,o=OI,a=null;function l(c){var d,f,h,g,_,p=(c=dK(c)).length,m=!1,y=new Array(p),v=new Array(p);for(null==s&&(a=o(_=th())),d=0;d<=p;++d){if(!(d<p&&r(g=c[d],d,c))===m)if(m=!m)f=d,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),h=d-1;h>=f;--h)a.point(y[h],v[h]);a.lineEnd(),a.areaEnd()}m&&(y[d]=+e(g,d,c),v[d]=+t(g,d,c),a.point(i?+i(g,d,c):y[d],n?+n(g,d,c):v[d]))}if(_)return a=null,_+""||null}function u(){return pK().defined(r).curve(o).context(s)}return e="function"==typeof e?e:void 0===e?fK:Ut(+e),t="function"==typeof t?t:Ut(void 0===t?0:+t),n="function"==typeof n?n:void 0===n?hK:Ut(+n),l.x=function(c){return arguments.length?(e="function"==typeof c?c:Ut(+c),i=null,l):e},l.x0=function(c){return arguments.length?(e="function"==typeof c?c:Ut(+c),l):e},l.x1=function(c){return arguments.length?(i=null==c?null:"function"==typeof c?c:Ut(+c),l):i},l.y=function(c){return arguments.length?(t="function"==typeof c?c:Ut(+c),n=null,l):t},l.y0=function(c){return arguments.length?(t="function"==typeof c?c:Ut(+c),l):t},l.y1=function(c){return arguments.length?(n=null==c?null:"function"==typeof c?c:Ut(+c),l):n},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(n)},l.lineX1=function(){return u().x(i).y(t)},l.defined=function(c){return arguments.length?(r="function"==typeof c?c:Ut(!!c),l):r},l.curve=function(c){return arguments.length?(o=c,null!=s&&(a=o(s)),l):o},l.context=function(c){return arguments.length?(null==c?s=a=null:a=o(s=c),l):s},l}wn(3);const FI={draw(e,t){const n=wn(t/id);e.moveTo(n,0),e.arc(0,0,n,0,Dy)}};wn(1/3),fs(id/10),fs(7*id/10);function rd(e,t){if("undefined"!=typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}fs(Dy/10),Vu(Dy/10),wn(3),wn(3),wn(3),wn(12);const yK=ey(Bu),WD=yK.right,dNe=yK.left,Cy=(ey(eY),WD);function Wg(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ey(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function sd(){}var Yg=1/.7,Kg="\\s*([+-]?\\d+)\\s*",Sy="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",El="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",fNe=/^#([0-9a-f]{3,8})$/,hNe=new RegExp(`^rgb\\(${Kg},${Kg},${Kg}\\)$`),pNe=new RegExp(`^rgb\\(${El},${El},${El}\\)$`),gNe=new RegExp(`^rgba\\(${Kg},${Kg},${Kg},${Sy}\\)$`),mNe=new RegExp(`^rgba\\(${El},${El},${El},${Sy}\\)$`),_Ne=new RegExp(`^hsl\\(${Sy},${El},${El}\\)$`),yNe=new RegExp(`^hsla\\(${Sy},${El},${El},${Sy}\\)$`),vK={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function bK(){return this.rgb().formatHex()}function wK(){return this.rgb().formatRgb()}function xy(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=fNe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?DK(t):3===n?new Pi(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?YD(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?YD(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=hNe.exec(e))?new Pi(t[1],t[2],t[3],1):(t=pNe.exec(e))?new Pi(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=gNe.exec(e))?YD(t[1],t[2],t[3],t[4]):(t=mNe.exec(e))?YD(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=_Ne.exec(e))?SK(t[1],t[2]/100,t[3]/100,1):(t=yNe.exec(e))?SK(t[1],t[2]/100,t[3]/100,t[4]):vK.hasOwnProperty(e)?DK(vK[e]):"transparent"===e?new Pi(NaN,NaN,NaN,0):null}function DK(e){return new Pi(e>>16&255,e>>8&255,255&e,1)}function YD(e,t,n,i){return i<=0&&(e=t=n=NaN),new Pi(e,t,n,i)}function jI(e){return e instanceof sd||(e=xy(e)),e?new Pi((e=e.rgb()).r,e.g,e.b,e.opacity):new Pi}function od(e,t,n,i){return 1===arguments.length?jI(e):new Pi(e,t,n,null==i?1:i)}function Pi(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}function CK(){return`#${rh(this.r)}${rh(this.g)}${rh(this.b)}`}function EK(){const e=KD(this.opacity);return`${1===e?"rgb(":"rgba("}${ih(this.r)}, ${ih(this.g)}, ${ih(this.b)}${1===e?")":`, ${e})`}`}function KD(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ih(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function rh(e){return((e=ih(e))<16?"0":"")+e.toString(16)}function SK(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new wa(e,t,n,i)}function xK(e){if(e instanceof wa)return new wa(e.h,e.s,e.l,e.opacity);if(e instanceof sd||(e=xy(e)),!e)return new wa;if(e instanceof wa)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),s=Math.max(t,n,i),o=NaN,a=s-r,l=(s+r)/2;return a?(o=t===s?(n-i)/a+6*(n<i):n===s?(i-t)/a+2:(t-n)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new wa(o,a,l,e.opacity)}function JD(e,t,n,i){return 1===arguments.length?xK(e):new wa(e,t,n,null==i?1:i)}function wa(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function AK(e){return(e=(e||0)%360)<0?e+360:e}function XD(e){return Math.max(0,Math.min(1,e||0))}function BI(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function MK(e,t,n,i,r){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*i+o*r)/6}function TK(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],s=e[i+1];return MK((n-i/t)*t,i>0?e[i-1]:2*r-s,r,s,i<t-1?e[i+2]:2*s-r)}}function OK(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t);return MK((n-i/t)*t,e[(i+t-1)%t],e[i%t],e[(i+1)%t],e[(i+2)%t])}}Wg(sd,xy,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:bK,formatHex:bK,formatHex8:function vNe(){return this.rgb().formatHex8()},formatHsl:function bNe(){return xK(this).formatHsl()},formatRgb:wK,toString:wK}),Wg(Pi,od,Ey(sd,{brighter(e){return e=null==e?Yg:Math.pow(Yg,e),new Pi(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new Pi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Pi(ih(this.r),ih(this.g),ih(this.b),KD(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:CK,formatHex:CK,formatHex8:function wNe(){return`#${rh(this.r)}${rh(this.g)}${rh(this.b)}${rh(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:EK,toString:EK})),Wg(wa,JD,Ey(sd,{brighter(e){return e=null==e?Yg:Math.pow(Yg,e),new wa(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new wa(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new Pi(BI(e>=240?e-240:e+120,r,i),BI(e,r,i),BI(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new wa(AK(this.h),XD(this.s),XD(this.l),KD(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=KD(this.opacity);return`${1===e?"hsl(":"hsla("}${AK(this.h)}, ${100*XD(this.s)}%, ${100*XD(this.l)}%${1===e?")":`, ${e})`}`}}));const QD=e=>()=>e;function NK(e,t){return function(n){return e+n*t}}function ZD(e,t){var n=t-e;return n?NK(e,n>180||n<-180?n-360*Math.round(n/360):n):QD(isNaN(e)?t:e)}function Li(e,t){var n=t-e;return n?NK(e,n):QD(isNaN(e)?t:e)}const $I=function e(t){var n=function CNe(e){return 1==(e=+e)?Li:function(t,n){return n-t?function DNe(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}(t,n,e):QD(isNaN(t)?n:t)}}(t);function i(r,s){var o=n((r=od(r)).r,(s=od(s)).r),a=n(r.g,s.g),l=n(r.b,s.b),u=Li(r.opacity,s.opacity);return function(c){return r.r=o(c),r.g=a(c),r.b=l(c),r.opacity=u(c),r+""}}return i.gamma=e,i}(1);function kK(e){return function(t){var o,a,n=t.length,i=new Array(n),r=new Array(n),s=new Array(n);for(o=0;o<n;++o)a=od(t[o]),i[o]=a.r||0,r[o]=a.g||0,s[o]=a.b||0;return i=e(i),r=e(r),s=e(s),a.opacity=1,function(l){return a.r=i(l),a.g=r(l),a.b=s(l),a+""}}}var ENe=kK(TK),SNe=kK(OK);function VI(e,t){t||(t=[]);var r,n=e?Math.min(t.length,e.length):0,i=t.slice();return function(s){for(r=0;r<n;++r)i[r]=e[r]*(1-s)+t[r]*s;return i}}function IK(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function xNe(e,t){return(IK(t)?VI:RK)(e,t)}function RK(e,t){var o,n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),s=new Array(n);for(o=0;o<i;++o)r[o]=ad(e[o],t[o]);for(;o<n;++o)s[o]=t[o];return function(a){for(o=0;o<i;++o)s[o]=r[o](a);return s}}function FK(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function Da(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function PK(e,t){var r,n={},i={};for(r in(null===e||"object"!=typeof e)&&(e={}),(null===t||"object"!=typeof t)&&(t={}),t)r in e?n[r]=ad(e[r],t[r]):i[r]=t[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var HI=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,UI=new RegExp(HI.source,"g");function LK(e,t){var i,r,s,n=HI.lastIndex=UI.lastIndex=0,o=-1,a=[],l=[];for(e+="",t+="";(i=HI.exec(e))&&(r=UI.exec(t));)(s=r.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,l.push({i:o,x:Da(i,r)})),n=UI.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?function MNe(e){return function(t){return e(t)+""}}(l[0].x):function ANe(e){return function(){return e}}(t):(t=l.length,function(u){for(var d,c=0;c<t;++c)a[(d=l[c]).i]=d.x(u);return a.join("")})}function ad(e,t){var i,n=typeof t;return null==t||"boolean"===n?QD(t):("number"===n?Da:"string"===n?(i=xy(t))?(t=i,$I):LK:t instanceof xy?$I:t instanceof Date?FK:IK(t)?VI:Array.isArray(t)?RK:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?PK:Da)(e,t)}function Ay(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function zI(e){return+e}var jK=[0,1];function hs(e){return e}function qI(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function TNe(e){return function(){return e}}(isNaN(t)?NaN:.5)}function NNe(e,t,n){var i=e[0],r=e[1],s=t[0],o=t[1];return r<i?(i=qI(r,i),s=n(o,s)):(i=qI(i,r),s=n(s,o)),function(a){return s(i(a))}}function kNe(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),s=new Array(i),o=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<i;)r[o]=qI(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(a){var l=Cy(e,a,1,i)-1;return s[l](r[l](a))}}function My(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function eC(){var i,r,s,a,l,u,e=jK,t=jK,n=ad,o=hs;function c(){var f=Math.min(e.length,t.length);return o!==hs&&(o=function ONe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}(e[0],e[f-1])),a=f>2?kNe:NNe,l=u=null,d}function d(f){return null==f||isNaN(f=+f)?s:(l||(l=a(e.map(i),t,n)))(i(o(f)))}return d.invert=function(f){return o(r((u||(u=a(t,e.map(i),Da)))(f)))},d.domain=function(f){return arguments.length?(e=Array.from(f,zI),c()):e.slice()},d.range=function(f){return arguments.length?(t=Array.from(f),c()):t.slice()},d.rangeRound=function(f){return t=Array.from(f),n=Ay,c()},d.clamp=function(f){return arguments.length?(o=!!f||hs,c()):o!==hs},d.interpolate=function(f){return arguments.length?(n=f,c()):n},d.unknown=function(f){return arguments.length?(s=f,d):s},function(f,h){return i=f,r=h,c()}}function BK(){return eC()(hs,hs)}function Sl(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function ld(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}function $K(e,t,n,i){var s,r=Gc(e,t,n);switch((i=Gf(null==i?",f":i)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null==i.precision&&!isNaN(s=yG(r,o))&&(i.precision=s),HN(i,o);case"":case"e":case"g":case"p":case"r":null==i.precision&&!isNaN(s=vG(r,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=s-("e"===i.type));break;case"f":case"%":null==i.precision&&!isNaN(s=bG(r))&&(i.precision=s-2*("%"===i.type))}return fD(i)}function sh(e){var t=e.domain;return e.ticks=function(n){var i=t();return $N(i[0],i[i.length-1],null==n?10:n)},e.tickFormat=function(n,i){var r=t();return $K(r[0],r[r.length-1],null==n?10:n,i)},e.nice=function(n){null==n&&(n=10);var l,u,i=t(),r=0,s=i.length-1,o=i[r],a=i[s],c=10;for(a<o&&(u=o,o=a,a=u,u=r,r=s,s=u);c-- >0;){if((u=_G(o,a,n))===l)return i[r]=o,i[s]=a,t(i);if(u>0)o=Math.floor(o/u)*u,a=Math.ceil(a/u)*u;else{if(!(u<0))break;o=Math.ceil(o*u)/u,a=Math.floor(a*u)/u}l=u}return e},e}function UK(e,t){var o,n=0,i=(e=e.slice()).length-1,r=e[n],s=e[i];return s<r&&(o=n,n=i,i=o,o=r,r=s,s=o),e[n]=t.floor(r),e[i]=t.ceil(s),e}function zK(e){return Math.log(e)}function qK(e){return Math.exp(e)}function INe(e){return-Math.log(-e)}function RNe(e){return-Math.exp(-e)}function FNe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function GK(e){return(t,n)=>-e(-t,n)}function GI(e){const t=e(zK,qK),n=t.domain;let r,s,i=10;function o(){return r=function LNe(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(i),s=function PNe(e){return 10===e?FNe:e===Math.E?Math.exp:t=>Math.pow(e,t)}(i),n()[0]<0?(r=GK(r),s=GK(s),e(INe,RNe)):e(zK,qK),t}return t.base=function(a){return arguments.length?(i=+a,o()):i},t.domain=function(a){return arguments.length?(n(a),o()):n()},t.ticks=a=>{const l=n();let u=l[0],c=l[l.length-1];const d=c<u;d&&([u,c]=[c,u]);let p,g,f=r(u),h=r(c);const m=null==a?10:+a;let _=[];if(!(i%1)&&h-f<m){if(f=Math.floor(f),h=Math.ceil(h),u>0){for(;f<=h;++f)for(p=1;p<i;++p)if(g=f<0?p/s(-f):p*s(f),!(g<u)){if(g>c)break;_.push(g)}}else for(;f<=h;++f)for(p=i-1;p>=1;--p)if(g=f>0?p/s(-f):p*s(f),!(g<u)){if(g>c)break;_.push(g)}2*_.length<m&&(_=$N(u,c,m))}else _=$N(f,h,Math.min(h-f,m)).map(s);return d?_.reverse():_},t.tickFormat=(a,l)=>{if(null==a&&(a=10),null==l&&(l=10===i?"s":","),"function"!=typeof l&&(!(i%1)&&null==(l=Gf(l)).precision&&(l.trim=!0),l=fD(l)),a===1/0)return l;const u=Math.max(1,i*a/t.ticks().length);return c=>{let d=c/s(Math.round(r(c)));return d*i<i-.5&&(d*=i),d<=u?l(c):""}},t.nice=()=>n(UK(n(),{floor:a=>s(Math.floor(r(a))),ceil:a=>s(Math.ceil(r(a)))})),t}function YK(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function jNe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function BNe(e){return e<0?-e*e:e*e}function WI(e){var t=e(hs,hs),n=1;function i(){return 1===n?e(hs,hs):.5===n?e(jNe,BNe):e(YK(n),YK(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,i()):n},sh(t)}function YI(){var e=WI(eC());return e.copy=function(){return My(e,YI()).exponent(e.exponent())},Sl.apply(e,arguments),e}function KK(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function JK(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function KI(e){var t=1,n=e(KK(t),JK(t));return n.constant=function(i){return arguments.length?e(KK(t=+i),JK(t)):t},sh(n)}function QK(e,t,n,i,r,s){const o=[[Jc,1,Lu],[Jc,5,5e3],[Jc,15,15e3],[Jc,30,3e4],[s,1,No],[s,5,5*No],[s,15,15*No],[s,30,30*No],[r,1,ju],[r,3,3*ju],[r,6,6*ju],[r,12,12*ju],[i,1,Wf],[i,2,2*Wf],[n,1,qN],[t,1,MG],[t,3,3*MG],[e,1,GN]];function l(u,c,d){const f=Math.abs(c-u)/d,h=ey(([,,m])=>m).right(o,f);if(h===o.length)return e.every(Gc(u/GN,c/GN,d));if(0===h)return JN.every(Math.max(Gc(u,c,d),1));const[p,g]=o[f/o[h-1][2]<o[h][2]/f?h-1:h];return p.every(g)}return[function a(u,c,d){const f=c<u;f&&([u,c]=[c,u]);const h=d&&"function"==typeof d.range?d:l(u,c,d),p=h?h.range(u,+c+1):[];return f?p.reverse():p},l]}const[VNe,HNe]=QK(Xc,_D,Pg,Yc,QN,ZN),[UNe,zNe]=QK(Kc,gD,Rg,Wc,YN,KN);function qNe(e){return new Date(e)}function GNe(e){return e instanceof Date?+e:+new Date(+e)}function JI(e,t,n,i,r,s,o,a,l,u){var c=BK(),d=c.invert,f=c.domain,h=u(".%L"),p=u(":%S"),g=u("%I:%M"),m=u("%I %p"),_=u("%a %d"),y=u("%b %d"),v=u("%B"),b=u("%Y");function D(C){return(l(C)<C?h:a(C)<C?p:o(C)<C?g:s(C)<C?m:i(C)<C?r(C)<C?_:y:n(C)<C?v:b)(C)}return c.invert=function(C){return new Date(d(C))},c.domain=function(C){return arguments.length?f(Array.from(C,GNe)):f().map(qNe)},c.ticks=function(C){var w=f();return e(w[0],w[w.length-1],null==C?10:C)},c.tickFormat=function(C,w){return null==w?D:u(w)},c.nice=function(C){var w=f();return(!C||"function"!=typeof C.range)&&(C=t(w[0],w[w.length-1],null==C?10:C)),C?f(UK(w,C)):c},c.copy=function(){return My(c,JI(e,t,n,i,r,s,o,a,l,u))},c}function tC(){var n,i,r,s,l,e=0,t=1,o=hs,a=!1;function u(d){return null==d||isNaN(d=+d)?l:o(0===r?.5:(d=(s(d)-n)*r,a?Math.max(0,Math.min(1,d)):d))}function c(d){return function(f){var h,p;return arguments.length?([h,p]=f,o=d(h,p),u):[o(0),o(1)]}}return u.domain=function(d){return arguments.length?([e,t]=d,n=s(e=+e),i=s(t=+t),r=n===i?0:1/(i-n),u):[e,t]},u.clamp=function(d){return arguments.length?(a=!!d,u):a},u.interpolator=function(d){return arguments.length?(o=d,u):o},u.range=c(ad),u.rangeRound=c(Ay),u.unknown=function(d){return arguments.length?(l=d,u):l},function(d){return s=d,n=d(e),i=d(t),r=n===i?0:1/(i-n),u}}function ud(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function XI(){var e=sh(tC()(hs));return e.copy=function(){return ud(e,XI())},ld.apply(e,arguments)}function QI(){var e=WI(tC());return e.copy=function(){return ud(e,QI()).exponent(e.exponent())},ld.apply(e,arguments)}function ZI(e,t){void 0===t&&(t=e,e=ad);for(var n=0,i=t.length-1,r=t[0],s=new Array(i<0?0:i);n<i;)s[n]=e(r,r=t[++n]);return function(o){var a=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return s[a](o-a)}}function nC(){var r,s,o,a,l,c,f,e=0,t=.5,n=1,i=1,u=hs,d=!1;function h(g){return isNaN(g=+g)?f:(g=.5+((g=+c(g))-s)*(i*g<i*s?a:l),u(d?Math.max(0,Math.min(1,g)):g))}function p(g){return function(m){var _,y,v;return arguments.length?([_,y,v]=m,u=ZI(g,[_,y,v]),h):[u(0),u(.5),u(1)]}}return h.domain=function(g){return arguments.length?([e,t,n]=g,r=c(e=+e),s=c(t=+t),o=c(n=+n),a=r===s?0:.5/(s-r),l=s===o?0:.5/(o-s),i=s<r?-1:1,h):[e,t,n]},h.clamp=function(g){return arguments.length?(d=!!g,h):d},h.interpolator=function(g){return arguments.length?(u=g,h):u},h.range=p(ad),h.rangeRound=p(Ay),h.unknown=function(g){return arguments.length?(f=g,h):f},function(g){return c=g,r=g(e),s=g(t),o=g(n),a=r===s?0:.5/(s-r),l=s===o?0:.5/(o-s),i=s<r?-1:1,h}}function eR(){var e=WI(nC());return e.copy=function(){return ud(e,eR()).exponent(e.exponent())},ld.apply(e,arguments)}class aJ extends Map{constructor(t,n=cJ){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),null!=t)for(const[i,r]of t)this.set(i,r)}get(t){return super.get(tR(this,t))}has(t){return super.has(tR(this,t))}set(t,n){return super.set(lJ(this,t),n)}delete(t){return super.delete(uJ(this,t))}}class iC extends Set{constructor(t,n=cJ){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),null!=t)for(const i of t)this.add(i)}has(t){return super.has(tR(this,t))}add(t){return super.add(lJ(this,t))}delete(t){return super.delete(uJ(this,t))}}function tR({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function lJ({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function uJ({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}function cJ(e){return null!==e&&"object"==typeof e?e.valueOf():e}const nR=Symbol("implicit");function iR(){var e=new aJ,t=[],n=[],i=nR;function r(s){let o=e.get(s);if(void 0===o){if(i!==nR)return i;e.set(s,o=t.push(s)-1)}return n[o%n.length]}return r.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new aJ;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return r},r.range=function(s){return arguments.length?(n=Array.from(s),r):n.slice()},r.unknown=function(s){return arguments.length?(i=s,r):i},r.copy=function(){return iR(t,n).unknown(i)},Sl.apply(r,arguments),r}function XNe(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function QNe(e,t){var n=ZD(+e,+t);return function(i){var r=n(i);return r-360*Math.floor(r/360)}}var rC,dJ=180/Math.PI,rR={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function fJ(e,t,n,i,r,s){var o,a,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*i)&&(n-=e*l,i-=t*l),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,l/=a),e*i<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(t,e)*dJ,skewX:Math.atan(l)*dJ,scaleX:o,scaleY:a}}function hJ(e,t,n,i){function r(u){return u.length?u.pop()+" ":""}return function(u,c){var d=[],f=[];return u=e(u),c=e(c),function s(u,c,d,f,h,p){if(u!==d||c!==f){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:Da(u,d)},{i:g-2,x:Da(c,f)})}else(d||f)&&h.push("translate("+d+t+f+n)}(u.translateX,u.translateY,c.translateX,c.translateY,d,f),function o(u,c,d,f){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),f.push({i:d.push(r(d)+"rotate(",null,i)-2,x:Da(u,c)})):c&&d.push(r(d)+"rotate("+c+i)}(u.rotate,c.rotate,d,f),function a(u,c,d,f){u!==c?f.push({i:d.push(r(d)+"skewX(",null,i)-2,x:Da(u,c)}):c&&d.push(r(d)+"skewX("+c+i)}(u.skewX,c.skewX,d,f),function l(u,c,d,f,h,p){if(u!==d||c!==f){var g=h.push(r(h)+"scale(",null,",",null,")");p.push({i:g-4,x:Da(u,d)},{i:g-2,x:Da(c,f)})}else(1!==d||1!==f)&&h.push(r(h)+"scale("+d+","+f+")")}(u.scaleX,u.scaleY,c.scaleX,c.scaleY,d,f),u=c=null,function(h){for(var m,p=-1,g=f.length;++p<g;)d[(m=f[p]).i]=m.x(h);return d.join("")}}}var tke=hJ(function ZNe(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?rR:fJ(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),nke=hJ(function eke(e){return null!=e&&(rC||(rC=document.createElementNS("http://www.w3.org/2000/svg","g")),rC.setAttribute("transform",e),e=rC.transform.baseVal.consolidate())?fJ((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):rR},", ",")",")");function pJ(e){return((e=Math.exp(e))+1/e)/2}const oke=function e(t,n,i){function r(s,o){var m,_,a=s[0],l=s[1],u=s[2],f=o[2],h=o[0]-a,p=o[1]-l,g=h*h+p*p;if(g<1e-12)_=Math.log(f/u)/t,m=function(w){return[a+w*h,l+w*p,u*Math.exp(t*w*_)]};else{var y=Math.sqrt(g),v=(f*f-u*u+i*g)/(2*u*n*y),b=(f*f-u*u-i*g)/(2*f*n*y),D=Math.log(Math.sqrt(v*v+1)-v),C=Math.log(Math.sqrt(b*b+1)-b);_=(C-D)/t,m=function(w){var E=w*_,T=pJ(D),O=u/(n*y)*(T*function ske(e){return((e=Math.exp(2*e))-1)/(e+1)}(t*E+D)-function rke(e){return((e=Math.exp(e))-1/e)/2}(D));return[a+O*h,l+O*p,u*T/pJ(t*E+D)]}}return m.duration=1e3*_*t/Math.SQRT2,m}return r.rho=function(s){var o=Math.max(.001,+s),a=o*o;return e(o,a,a*a)},r}(Math.SQRT2,2,4);function gJ(e){return function(t,n){var i=e((t=JD(t)).h,(n=JD(n)).h),r=Li(t.s,n.s),s=Li(t.l,n.l),o=Li(t.opacity,n.opacity);return function(a){return t.h=i(a),t.s=r(a),t.l=s(a),t.opacity=o(a),t+""}}}const ake=gJ(ZD);var lke=gJ(Li);const mJ=Math.PI/180,_J=180/Math.PI,wJ=4/29,Jg=6/29,DJ=3*Jg*Jg;function CJ(e){if(e instanceof Ca)return new Ca(e.l,e.a,e.b,e.opacity);if(e instanceof xl)return SJ(e);e instanceof Pi||(e=jI(e));var s,o,t=lR(e.r),n=lR(e.g),i=lR(e.b),r=sR((.2225045*t+.7168786*n+.0606169*i)/1);return t===n&&n===i?s=o=r:(s=sR((.4360747*t+.3850649*n+.1430804*i)/.96422),o=sR((.0139322*t+.0971045*n+.7141733*i)/.82521)),new Ca(116*r-16,500*(s-r),200*(r-o),e.opacity)}function oC(e,t,n,i){return 1===arguments.length?CJ(e):new Ca(e,t,n,null==i?1:i)}function Ca(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}function sR(e){return e>.008856451679035631?Math.pow(e,1/3):e/DJ+wJ}function oR(e){return e>Jg?e*e*e:DJ*(e-wJ)}function aR(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function lR(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function EJ(e){if(e instanceof xl)return new xl(e.h,e.c,e.l,e.opacity);if(e instanceof Ca||(e=CJ(e)),0===e.a&&0===e.b)return new xl(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*_J;return new xl(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function aC(e,t,n,i){return 1===arguments.length?EJ(e):new xl(e,t,n,null==i?1:i)}function xl(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function SJ(e){if(isNaN(e.h))return new Ca(e.l,0,0,e.opacity);var t=e.h*mJ;return new Ca(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}function cke(e,t){var n=Li((e=oC(e)).l,(t=oC(t)).l),i=Li(e.a,t.a),r=Li(e.b,t.b),s=Li(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=i(o),e.b=r(o),e.opacity=s(o),e+""}}function xJ(e){return function(t,n){var i=e((t=aC(t)).h,(n=aC(n)).h),r=Li(t.c,n.c),s=Li(t.l,n.l),o=Li(t.opacity,n.opacity);return function(a){return t.h=i(a),t.c=r(a),t.l=s(a),t.opacity=o(a),t+""}}}Wg(Ca,oC,Ey(sd,{brighter(e){return new Ca(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker(e){return new Ca(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new Pi(aR(3.1338561*(t=.96422*oR(t))-1.6168667*(e=1*oR(e))-.4906146*(n=.82521*oR(n))),aR(-.9787684*t+1.9161415*e+.033454*n),aR(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),Wg(xl,aC,Ey(sd,{brighter(e){return new xl(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker(e){return new xl(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb(){return SJ(this).rgb()}}));const dke=xJ(ZD);var fke=xJ(Li),uR=1.78277,cR=-.29227,lC=-.90649,Ty=1.97294,MJ=Ty*lC,TJ=Ty*uR,OJ=uR*cR- -.14861*lC;function hke(e){if(e instanceof oh)return new oh(e.h,e.s,e.l,e.opacity);e instanceof Pi||(e=jI(e));var n=e.g/255,i=e.b/255,r=(OJ*i+MJ*(e.r/255)-TJ*n)/(OJ+MJ-TJ),s=i-r,o=(Ty*(n-r)-cR*s)/lC,a=Math.sqrt(o*o+s*s)/(Ty*r*(1-r)),l=a?Math.atan2(o,s)*_J-120:NaN;return new oh(l<0?l+360:l,a,r,e.opacity)}function dR(e,t,n,i){return 1===arguments.length?hke(e):new oh(e,t,n,null==i?1:i)}function oh(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function NJ(e){return function t(n){function i(r,s){var o=e((r=dR(r)).h,(s=dR(s)).h),a=Li(r.s,s.s),l=Li(r.l,s.l),u=Li(r.opacity,s.opacity);return function(c){return r.h=o(c),r.s=a(c),r.l=l(Math.pow(c,n)),r.opacity=u(c),r+""}}return n=+n,i.gamma=t,i}(1)}Wg(oh,dR,Ey(sd,{brighter(e){return e=null==e?Yg:Math.pow(Yg,e),new oh(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new oh(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*mJ,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new Pi(255*(t+n*(-.14861*i+uR*r)),255*(t+n*(cR*i+lC*r)),255*(t+n*(Ty*i)),this.opacity)}}));const pke=NJ(ZD);var gke=NJ(Li);function mke(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}function fR(e,t,n){const i=e-t+2*n;return e?i>0?i:1:0}const Xg="linear",Hu="log",Oy="pow",Ny="sqrt",uC="symlog",ah="time",lh="utc",Al="sequential",Qg="diverging",Zg="quantile",cC="quantize",dC="threshold",hR="ordinal",pR="point",gR="bin-ordinal",Ci="continuous",ky="discrete",Iy="discretizing",Po="interpolating",mR="temporal";function _R(){const e=iR().unknown(void 0),t=e.domain,n=e.range;let r,s,i=[0,1],o=!1,a=0,l=0,u=.5;function c(){const d=t().length,f=i[1]<i[0],h=i[1-f],p=fR(d,a,l);let g=i[f-0];r=(h-g)/(p||1),o&&(r=Math.floor(r)),g+=(h-g-r*(d-a))*u,s=r*(1-a),o&&(g=Math.round(g),s=Math.round(s));const m=Ys(d).map(_=>g+r*_);return n(f?m.reverse():m)}return delete e.unknown,e.domain=function(d){return arguments.length?(t(d),c()):t()},e.range=function(d){return arguments.length?(i=[+d[0],+d[1]],c()):i.slice()},e.rangeRound=function(d){return i=[+d[0],+d[1]],o=!0,c()},e.bandwidth=function(){return s},e.step=function(){return r},e.round=function(d){return arguments.length?(o=!!d,c()):o},e.padding=function(d){return arguments.length?(l=Math.max(0,Math.min(1,d)),a=l,c()):a},e.paddingInner=function(d){return arguments.length?(a=Math.max(0,Math.min(1,d)),c()):a},e.paddingOuter=function(d){return arguments.length?(l=Math.max(0,Math.min(1,d)),c()):l},e.align=function(d){return arguments.length?(u=Math.max(0,Math.min(1,d)),c()):u},e.invertRange=function(d){if(null==d[0]||null==d[1])return;const f=i[1]<i[0],h=f?n().reverse():n(),p=h.length-1;let _,y,v,g=+d[0],m=+d[1];return g!=g||m!=m||(m<g&&(v=g,g=m,m=v),m<h[0]||g>i[1-f])?void 0:(_=Math.max(0,WD(h,g)-1),y=g===m?_:WD(h,m)-1,g-h[_]>s+1e-10&&++_,f&&(v=_,_=p-y,y=p-v),_>y?void 0:t().slice(_,y+1))},e.invert=function(d){const f=e.invertRange([d,d]);return f&&f[0]},e.copy=function(){return _R().domain(t()).range(i).round(o).paddingInner(a).paddingOuter(l).align(u)},c()}function IJ(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return IJ(t())},e}var wke=Array.prototype.map;function Dke(e){return wke.call(e,pr)}const Cke=Array.prototype.slice,fC={};function Eke(e,t,n){const i=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?function yke(e){return function(t){let r,n=t[0],i=t[1];return i<n&&(r=n,n=i,i=r),[e.invert(n),e.invert(i)]}}(s):s.invertExtent?function vke(e){return function(t){const n=e.range();let o,a,l,u,i=t[0],r=t[1],s=-1;for(r<i&&(a=i,i=r,r=a),l=0,u=n.length;l<u;++l)n[l]>=i&&n[l]<=r&&(s<0&&(s=l),o=l);if(!(s<0))return i=e.invertExtent(n[s]),r=e.invertExtent(n[o]),[void 0===i[0]?i[1]:i[0],void 0===r[1]?r[0]:r[1]]}}(s):void 0),s.type=e,s};return i.metadata=va(we(n)),i}function Ft(e,t,n){return arguments.length>1?(fC[e]=Eke(e,t,n),this):FJ(e)?fC[e]:void 0}function FJ(e){return ke(fC,e)}function uh(e,t){const n=fC[e];return n&&n.metadata[t]}function yR(e){return uh(e,Ci)}function em(e){return uh(e,ky)}function vR(e){return uh(e,Iy)}function PJ(e){return uh(e,Hu)}function LJ(e){return uh(e,Po)}function jJ(e){return uh(e,Zg)}Ft("identity",function HK(e){var t;function n(i){return null==i||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,zI),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return HK(e).unknown(t)},e=arguments.length?Array.from(e,zI):[0,1],sh(n)}),Ft(Xg,function VK(){var e=BK();return e.copy=function(){return My(e,VK())},Sl.apply(e,arguments),sh(e)},Ci),Ft(Hu,function WK(){const e=GI(eC()).domain([1,10]);return e.copy=()=>My(e,WK()).base(e.base()),Sl.apply(e,arguments),e},[Ci,Hu]),Ft(Oy,YI,Ci),Ft(Ny,function $Ne(){return YI.apply(null,arguments).exponent(.5)},Ci),Ft(uC,function XK(){var e=KI(eC());return e.copy=function(){return My(e,XK()).constant(e.constant())},Sl.apply(e,arguments)},Ci),Ft(ah,function WNe(){return Sl.apply(JI(UNe,zNe,Kc,gD,Rg,Wc,YN,KN,Jc,dk).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},[Ci,mR]),Ft(lh,function YNe(){return Sl.apply(JI(VNe,HNe,Xc,_D,Pg,Yc,QN,ZN,Jc,fk).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},[Ci,mR]),Ft(Al,XI,[Ci,Po]),Ft("".concat(Al,"-").concat(Xg),XI,[Ci,Po]),Ft("".concat(Al,"-").concat(Hu),function ZK(){var e=GI(tC()).domain([1,10]);return e.copy=function(){return ud(e,ZK()).base(e.base())},ld.apply(e,arguments)},[Ci,Po,Hu]),Ft("".concat(Al,"-").concat(Oy),QI,[Ci,Po]),Ft("".concat(Al,"-").concat(Ny),function KNe(){return QI.apply(null,arguments).exponent(.5)},[Ci,Po]),Ft("".concat(Al,"-").concat(uC),function eJ(){var e=KI(tC());return e.copy=function(){return ud(e,eJ()).constant(e.constant())},ld.apply(e,arguments)},[Ci,Po]),Ft("".concat(Qg,"-").concat(Xg),function tJ(){var e=sh(nC()(hs));return e.copy=function(){return ud(e,tJ())},ld.apply(e,arguments)},[Ci,Po]),Ft("".concat(Qg,"-").concat(Hu),function nJ(){var e=GI(nC()).domain([.1,1,10]);return e.copy=function(){return ud(e,nJ()).base(e.base())},ld.apply(e,arguments)},[Ci,Po,Hu]),Ft("".concat(Qg,"-").concat(Oy),eR,[Ci,Po]),Ft("".concat(Qg,"-").concat(Ny),function JNe(){return eR.apply(null,arguments).exponent(.5)},[Ci,Po]),Ft("".concat(Qg,"-").concat(uC),function iJ(){var e=KI(nC());return e.copy=function(){return ud(e,iJ()).constant(e.constant())},ld.apply(e,arguments)},[Ci,Po]),Ft(Zg,function rJ(){var i,e=[],t=[],n=[];function r(){var o=0,a=Math.max(1,t.length);for(n=new Array(a-1);++o<a;)n[o-1]=tY(e,o/a);return s}function s(o){return null==o||isNaN(o=+o)?i:t[Cy(n,o)]}return s.invertExtent=function(o){var a=t.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let a of o)null!=a&&!isNaN(a=+a)&&e.push(a);return e.sort(Bu),r()},s.range=function(o){return arguments.length?(t=Array.from(o),r()):t.slice()},s.unknown=function(o){return arguments.length?(i=o,s):i},s.quantiles=function(){return n.slice()},s.copy=function(){return rJ().domain(e).range(t).unknown(i)},Sl.apply(s,arguments)},[Iy,Zg]),Ft(cC,function sJ(){var s,e=0,t=1,n=1,i=[.5],r=[0,1];function o(l){return null!=l&&l<=l?r[Cy(i,l,0,n)]:s}function a(){var l=-1;for(i=new Array(n);++l<n;)i[l]=((l+1)*t-(l-n)*e)/(n+1);return o}return o.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,a()):[e,t]},o.range=function(l){return arguments.length?(n=(r=Array.from(l)).length-1,a()):r.slice()},o.invertExtent=function(l){var u=r.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,i[0]]:u>=n?[i[n-1],t]:[i[u-1],i[u]]},o.unknown=function(l){return arguments.length&&(s=l),o},o.thresholds=function(){return i.slice()},o.copy=function(){return sJ().domain([e,t]).range(r).unknown(s)},Sl.apply(sh(o),arguments)},Iy),Ft(dC,function oJ(){var n,e=[.5],t=[0,1],i=1;function r(s){return null!=s&&s<=s?t[Cy(e,s,0,i)]:n}return r.domain=function(s){return arguments.length?(e=Array.from(s),i=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(s){return arguments.length?(t=Array.from(s),i=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},r.unknown=function(s){return arguments.length?(n=s,r):n},r.copy=function(){return oJ().domain(e).range(t).unknown(n)},Sl.apply(r,arguments)},Iy),Ft(gR,function RJ(){let e=[],t=[];function n(i){return null==i||i!=i?void 0:t[(Cy(e,i)-1)%t.length]}return n.domain=function(i){return arguments.length?(e=Dke(i),n):e.slice()},n.range=function(i){return arguments.length?(t=Cke.call(i),n):t.slice()},n.tickFormat=function(i,r){return $K(e[0],bt(e),null==i?10:i,r)},n.copy=function(){return RJ().domain(n.domain()).range(n.range())},n},[ky,Iy]),Ft(hR,iR,ky),Ft("band",_R,ky),Ft(pR,function bke(){return IJ(_R().paddingInner(1))},ky);const xke=["clamp","base","constant","exponent"];function BJ(e,t){const n=t[0],i=bt(t)-n;return function(r){return e(n+r*i)}}function hC(e,t,n){return ZI(bR(t||"rgb",n),e)}function $J(e,t){const n=new Array(t),i=t+1;for(let r=0;r<t;)n[r]=e(++r/i);return n}function VJ(e,t,n){const i=n-t;let r,s,o;return i&&Number.isFinite(i)?(r=(s=e.type).indexOf("-"),s=r<0?s:s.slice(r+1),o=Ft(s)().domain([t,n]).range([0,1]),xke.forEach(a=>e[a]?o[a](e[a]()):0),o):gr(.5)}function bR(e,t){const n=sn[function Ake(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}function HJ(e){const t=e.length/6|0,n=new Array(t);for(let i=0;i<t;)n[i]="#"+e.slice(6*i,6*++i);return n}function UJ(e,t){for(const n in e)wR(n,t(e[n]))}const zJ={};function wR(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(zJ[e]=t,this):zJ[e]}UJ({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},HJ),UJ({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},e=>hC(HJ(e)));const pC="symbol",kke=e=>ne(e)?e.map(t=>String(t)):String(e),Ike=(e,t)=>e[1]-t[1],Rke=(e,t)=>t[1]-e[1];function DR(e,t,n){let i;return en(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),null!=n&&(t=Math.min(t,Math.floor(Q_(e.domain())/n||1)))),Se(t)&&(i=t.step,t=t.interval),be(t)&&(t=e.type===ah?Bg(t):e.type==lh?$g(t):ee("Only time and utc scales accept interval strings."),i&&(t=t.every(i))),t}function qJ(e,t,n){let i=e.range(),r=i[0],s=bt(i),o=Ike;if(r>s&&(i=s,s=r,r=i,o=Rke),r=Math.floor(r),s=Math.ceil(s),t=t.map(a=>[a,e(a)]).filter(a=>r<=a[1]&&a[1]<=s).sort(o).map(a=>a[0]),n>0&&t.length>1){const a=[t[0],bt(t)];for(;t.length>n&&t.length>=3;)t=t.filter((l,u)=>!(u%2));t.length<3&&(t=a)}return t}function CR(e,t){return e.bins?qJ(e,e.bins):e.ticks?e.ticks(t):e.domain()}function GJ(e,t,n,i,r,s){const o=t.type;let a=kke;if(o===ah||r===ah)a=e.timeFormat(i);else if(o===lh||r===lh)a=e.utcFormat(i);else if(PJ(o)){const l=e.formatFloat(i);if(s||t.bins)a=l;else{const u=WJ(t,n,!1);a=c=>u(c)?l(c):""}}else if(t.tickFormat){const l=t.domain();a=e.formatSpan(l[0],l[l.length-1],n,i)}else i&&(a=e.format(i));return a}function WJ(e,t,n){const i=CR(e,t),r=e.base(),s=Math.log(r),o=Math.max(1,r*t/i.length),a=l=>{let u=l/Math.pow(r,Math.round(Math.log(l)/s));return u*r<r-.5&&(u*=r),u<=o};return n?i.filter(a):a}const ER={[Zg]:"quantiles",[cC]:"thresholds",[dC]:"domain"},YJ={[Zg]:"quantiles",[cC]:"domain"};function KJ(e,t){return e.bins?function Lke(e){const t=e.slice(0,-1);return t.max=bt(e),t}(e.bins):e.type===Hu?WJ(e,t,!0):ER[e.type]?function Pke(e){const t=[-1/0].concat(e);return t.max=1/0,t}(e[ER[e.type]]()):CR(e,t)}function JJ(e,t,n,i,r,s,o){const a=YJ[t.type]&&s!==ah&&s!==lh?function Fke(e,t,n){const i=t[YJ[t.type]](),r=i.length;let o,s=r>1?i[1]-i[0]:i[0];for(o=1;o<r;++o)s=Math.min(s,i[o]-i[o-1]);return e.formatSpan(0,s,30,n)}(e,t,r):GJ(e,t,n,r,s,o);return i===pC&&(e=>ER[e.type]||e.bins)(t)?Bke(a):"discrete"===i?$ke(a):Vke(a)}const Bke=e=>(t,n,i)=>{const r=XJ(i[n+1],XJ(i.max,1/0)),s=QJ(t,e),o=QJ(r,e);return s&&o?s+" \u2013 "+o:o?"< "+o:"\u2265 "+s},XJ=(e,t)=>null!=e?e:t,$ke=e=>(t,n)=>n?e(t):null,Vke=e=>t=>e(t),QJ=(e,t)=>Number.isFinite(e)?t(e):null;function ZJ(e,t,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=function Uke(e,t,n,i){const r=i||t.type;return be(n)&&function Ske(e){return uh(e,mR)}(r)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||r!==ah?n||r!==lh?JJ(e,t,5,null,n,i,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X")}(e,t,n.format,n.formatType);if(vR(t.type)){const s=KJ(t).slice(1).map(r),o=s.length;return"".concat(o," boundar").concat(1===o?"y":"ies",": ").concat(s.join(", "))}if(em(t.type)){const s=t.domain(),o=s.length,a=o>i?s.slice(0,i-2).map(r).join(", ")+", ending with "+s.slice(-1).map(r):s.map(r).join(", ");return"".concat(o," value").concat(1===o?"":"s",": ").concat(a)}{const s=t.domain();return"values from ".concat(r(s[0])," to ").concat(r(bt(s)))}}let eX=0;function SR(e){return e&&e.gradient}function tX(e,t,n){const i=e.gradient;let r=e.id,s="radial"===i?"p_":"";return r||(r=e.id="gradient_"+eX++,"radial"===i?(e.x1=Ml(e.x1,.5),e.y1=Ml(e.y1,.5),e.r1=Ml(e.r1,0),e.x2=Ml(e.x2,.5),e.y2=Ml(e.y2,.5),e.r2=Ml(e.r2,.5),s="p_"):(e.x1=Ml(e.x1,0),e.y1=Ml(e.y1,0),e.x2=Ml(e.x2,1),e.y2=Ml(e.y2,0))),t[r]=e,"url("+(n||"")+"#"+s+r+")"}function Ml(e,t){return null!=e?e:t}function nX(e,t){var i,n=[];return i={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(r,s){return n.push({offset:r,color:s}),i}}}const iX={basis:{curve:function _2e(e){return new VD(e)}},"basis-closed":{curve:function y2e(e){return new WY(e)}},"basis-open":{curve:function v2e(e){return new YY(e)}},bundle:{curve:b2e,tension:"beta",value:.85},cardinal:{curve:w2e,tension:"tension",value:0},"cardinal-open":{curve:D2e,tension:"tension",value:0},"cardinal-closed":{curve:C2e,tension:"tension",value:0},"catmull-rom":{curve:x2e,tension:"alpha",value:.5},"catmull-rom-closed":{curve:A2e,tension:"alpha",value:.5},"catmull-rom-open":{curve:M2e,tension:"alpha",value:.5},linear:{curve:OI},"linear-closed":{curve:function T2e(e){return new nK(e)}},monotone:{horizontal:function N2e(e){return new oK(e)},vertical:function O2e(e){return new zD(e)}},natural:{curve:function k2e(e){return new lK(e)}},step:{curve:function I2e(e){return new qD(e,.5)}},"step-after":{curve:function F2e(e){return new qD(e,1)}},"step-before":{curve:function R2e(e){return new qD(e,0)}}};function xR(e,t,n){var i=ke(iX,e)&&iX[e],r=null;return i&&(r=i.curve||i[t||"vertical"],i.tension&&null!=n&&(r=r[i.tension](n))),r}const qke={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},Gke=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,Wke=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,Yke=/^((\s+,?\s*)|(,\s*))/,Kke=/^[01]/;function tm(e){const t=[];return(e.match(Gke)||[]).forEach(i=>{let r=i[0];const s=r.toLowerCase(),o=qke[s],a=function Jke(e,t,n){const i=[];for(let r=0;t&&r<n.length;)for(let s=0;s<t;++s){const o="a"!==e||3!==s&&4!==s?Wke:Kke,a=n.slice(r).match(o);if(null===a)throw Error("Invalid SVG path, incorrect parameter type");r+=a[0].length,i.push(+a[0]);const l=n.slice(r).match(Yke);null!==l&&(r+=l[0].length)}return i}(s,o,i.slice(1).trim()),l=a.length;if(l<o||l&&l%o!=0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([r,...a.slice(0,o)]),l!==o){"m"===s&&(r="M"===r?"L":"l");for(let u=o;u<l;u+=o)t.push([r,...a.slice(u,u+o)])}}),t}const cd=Math.PI/180,ch=Math.PI/2,Tl=2*Math.PI,nm=Math.sqrt(3)/2;var AR={},MR={},rX=[].join;function Zke(e){const t=rX.call(e);if(MR[t])return MR[t];var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7];const c=u*o,d=-l*a,f=l*o,h=u*a,p=Math.cos(r),g=Math.sin(r),m=Math.cos(s),_=Math.sin(s),y=.5*(s-r),v=Math.sin(.5*y),b=8/3*v*v/Math.sin(y),D=n+p-b*g,C=i+g+b*p,w=n+m,E=i+_,T=w+b*_,O=E-b*m;return MR[t]=[c*D+d*C,f*D+h*C,c*T+d*O,f*T+h*O,c*w+d*E,f*w+h*E]}const Lo=["l",0,0,0,0,0,0,0];function eIe(e,t,n){const i=Lo[0]=e[0];if("a"===i||"A"===i)Lo[1]=t*e[1],Lo[2]=n*e[2],Lo[3]=e[3],Lo[4]=e[4],Lo[5]=e[5],Lo[6]=t*e[6],Lo[7]=n*e[7];else if("h"===i||"H"===i)Lo[1]=t*e[1];else if("v"===i||"V"===i)Lo[1]=n*e[1];else for(var r=1,s=e.length;r<s;++r)Lo[r]=(r%2==1?t:n)*e[r];return Lo}function Ry(e,t,n,i,r,s){var o,f,h,p,g,a=null,l=0,u=0,c=0,d=0,m=0,_=0;null==n&&(n=0),null==i&&(i=0),null==r&&(r=1),null==s&&(s=r),e.beginPath&&e.beginPath();for(var y=0,v=t.length;y<v;++y){switch(o=t[y],(1!==r||1!==s)&&(o=eIe(o,r,s)),o[0]){case"l":e.lineTo((l+=o[1])+n,(u+=o[2])+i);break;case"L":e.lineTo((l=o[1])+n,(u=o[2])+i);break;case"h":e.lineTo((l+=o[1])+n,u+i);break;case"H":e.lineTo((l=o[1])+n,u+i);break;case"v":e.lineTo(l+n,(u+=o[1])+i);break;case"V":e.lineTo(l+n,(u=o[1])+i);break;case"m":m=l+=o[1],_=u+=o[2],e.moveTo(l+n,u+i);break;case"M":m=l=o[1],_=u=o[2],e.moveTo(l+n,u+i);break;case"c":e.bezierCurveTo(l+o[1]+n,u+o[2]+i,(c=l+o[3])+n,(d=u+o[4])+i,(f=l+o[5])+n,(h=u+o[6])+i),l=f,u=h;break;case"C":e.bezierCurveTo(o[1]+n,o[2]+i,(c=o[3])+n,(d=o[4])+i,(l=o[5])+n,(u=o[6])+i);break;case"s":e.bezierCurveTo((c=2*l-c)+n,(d=2*u-d)+i,l+o[1]+n,u+o[2]+i,(f=l+o[3])+n,(h=u+o[4])+i),c=l+o[1],d=u+o[2],l=f,u=h;break;case"S":e.bezierCurveTo((c=2*l-c)+n,(d=2*u-d)+i,o[1]+n,o[2]+i,(f=o[3])+n,(h=o[4])+i),l=f,u=h,c=o[1],d=o[2];break;case"q":e.quadraticCurveTo((c=l+o[1])+n,(d=u+o[2])+i,(f=l+o[3])+n,(h=u+o[4])+i),l=f,u=h;break;case"Q":e.quadraticCurveTo(o[1]+n,o[2]+i,(f=o[3])+n,(h=o[4])+i),l=f,u=h,c=o[1],d=o[2];break;case"t":f=l+o[1],h=u+o[2],null===a[0].match(/[QqTt]/)?(c=l,d=u):"t"===a[0]?(c=2*l-p,d=2*u-g):"q"===a[0]&&(c=2*l-c,d=2*u-d),p=c,g=d,e.quadraticCurveTo(c+n,d+i,f+n,h+i),c=(l=f)+o[1],d=(u=h)+o[2];break;case"T":e.quadraticCurveTo((c=2*l-c)+n,(d=2*u-d)+i,(f=o[1])+n,(h=o[2])+i),l=f,u=h;break;case"a":sX(e,l+n,u+i,[o[1],o[2],o[3],o[4],o[5],o[6]+l+n,o[7]+u+i]),l+=o[6],u+=o[7];break;case"A":sX(e,l+n,u+i,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+i]),l=o[6],u=o[7];break;case"z":case"Z":l=m,u=_,e.closePath()}a=o}}function sX(e,t,n,i){const r=function Qke(e,t,n,i,r,s,o,a,l){const u=rX.call(arguments);if(AR[u])return AR[u];const c=o*cd,d=Math.sin(c),f=Math.cos(c),h=f*(a-e)*.5+d*(l-t)*.5,p=f*(l-t)*.5-d*(a-e)*.5;let g=h*h/((n=Math.abs(n))*n)+p*p/((i=Math.abs(i))*i);g>1&&(g=Math.sqrt(g),n*=g,i*=g);const m=f/n,_=d/n,y=-d/i,v=f/i,b=m*a+_*l,D=y*a+v*l,C=m*e+_*t,w=y*e+v*t;let T=1/((C-b)*(C-b)+(w-D)*(w-D))-.25;T<0&&(T=0);let O=Math.sqrt(T);s==r&&(O=-O);const N=.5*(b+C)-O*(w-D),P=.5*(D+w)+O*(C-b),j=Math.atan2(D-P,b-N);let x=Math.atan2(w-P,C-N)-j;x<0&&1===s?x+=Tl:x>0&&0===s&&(x-=Tl);const S=Math.ceil(Math.abs(x/(ch+.001))),I=[];for(let M=0;M<S;++M)I[M]=[N,P,j+M*x/S,j+(M+1)*x/S,n,i,d,f];return AR[u]=I}(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n);for(let s=0;s<r.length;++s){const o=Zke(r[s]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const oX=.5773502691896257,aX={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Tl)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,s=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-s),e.lineTo(r,-s),e.lineTo(0,-n),e.lineTo(-r,-s),e.lineTo(-i,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=nm*n,r=i-n*oX,s=n/4;e.moveTo(0,-i-r),e.lineTo(-s,i-r),e.lineTo(s,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=nm*n,r=i-n*oX;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,i=nm*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,i=nm*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,i=nm*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,i=nm*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function lX(e){return ke(aX,e)?aX[e]:function tIe(e){if(!ke(TR,e)){const t=tm(e);TR[e]={draw:function(n,i){Ry(n,t,0,0,Math.sqrt(i)/2)}}}return TR[e]}(e)}var TR={};const dd=.448084975506;function nIe(e){return e.x}function iIe(e){return e.y}function rIe(e){return e.width}function sIe(e){return e.height}function Uu(e){return"function"==typeof e?e:()=>+e}function mC(e,t,n){return Math.max(t,Math.min(e,n))}function uX(){var e=nIe,t=iIe,n=rIe,i=sIe,r=Uu(0),s=r,o=r,a=r,l=null;function u(c,d,f){var h,p=null!=d?d:+e.call(this,c),g=null!=f?f:+t.call(this,c),m=+n.call(this,c),_=+i.call(this,c),y=Math.min(m,_)/2,v=mC(+r.call(this,c),0,y),b=mC(+s.call(this,c),0,y),D=mC(+o.call(this,c),0,y),C=mC(+a.call(this,c),0,y);if(l||(l=h=th()),v<=0&&b<=0&&D<=0&&C<=0)l.rect(p,g,m,_);else{var w=p+m,E=g+_;l.moveTo(p+v,g),l.lineTo(w-b,g),l.bezierCurveTo(w-dd*b,g,w,g+dd*b,w,g+b),l.lineTo(w,E-C),l.bezierCurveTo(w,E-dd*C,w-dd*C,E,w-C,E),l.lineTo(p+D,E),l.bezierCurveTo(p+dd*D,E,p,E-dd*D,p,E-D),l.lineTo(p,g+v),l.bezierCurveTo(p,g+dd*v,p+dd*v,g,p+v,g),l.closePath()}if(h)return l=null,h+""||null}return u.x=function(c){return arguments.length?(e=Uu(c),u):e},u.y=function(c){return arguments.length?(t=Uu(c),u):t},u.width=function(c){return arguments.length?(n=Uu(c),u):n},u.height=function(c){return arguments.length?(i=Uu(c),u):i},u.cornerRadius=function(c,d,f,h){return arguments.length?(r=Uu(c),s=null!=d?Uu(d):r,a=null!=f?Uu(f):r,o=null!=h?Uu(h):s,u):r},u.context=function(c){return arguments.length?(l=null==c?null:c,u):l},u}function cX(){var e,t,n,i,s,o,a,l,r=null;function u(d,f,h){const p=h/2;if(s){var g=a-f,m=d-o;if(g||m){var _=Math.sqrt(g*g+m*m),y=(g/=_)*l,v=(m/=_)*l,b=Math.atan2(m,g);r.moveTo(o-y,a-v),r.lineTo(d-g*p,f-m*p),r.arc(d,f,p,b-Math.PI,b),r.lineTo(o+y,a+v),r.arc(o,a,l,b,b+Math.PI)}else r.arc(d,f,p,0,Tl);r.closePath()}else s=1;o=d,a=f,l=p}function c(d){var f,p,m,h=d.length,g=!1;for(null==r&&(r=m=th()),f=0;f<=h;++f)!(f<h&&i(p=d[f],f,d))===g&&(g=!g)&&(s=0),g&&u(+e(p,f,d),+t(p,f,d),+n(p,f,d));if(m)return r=null,m+""||null}return c.x=function(d){return arguments.length?(e=d,c):e},c.y=function(d){return arguments.length?(t=d,c):t},c.size=function(d){return arguments.length?(n=d,c):n},c.defined=function(d){return arguments.length?(i=d,c):i},c.context=function(d){return arguments.length?(r=null==d?null:d,c):r},c}function Fy(e,t){return null!=e?e:t}const Py=e=>e.x||0,Ly=e=>e.y||0,_C=e=>!1!==e.defined,CIe=function U2e(){var e=L2e,t=j2e,n=Ut(0),i=null,r=B2e,s=$2e,o=V2e,a=null;function l(){var u,c,d=+e.apply(this,arguments),f=+t.apply(this,arguments),h=r.apply(this,arguments)-UD,p=s.apply(this,arguments)-UD,g=JY(p-h),m=p>h;if(a||(a=u=th()),f<d&&(c=f,f=d,d=c),f>vr)if(g>Dy-vr)a.moveTo(f*Vu(h),f*fs(h)),a.arc(0,0,f,h,p,!m),d>vr&&(a.moveTo(d*Vu(p),d*fs(p)),a.arc(0,0,d,p,h,m));else{var P,j,_=h,y=p,v=h,b=p,D=g,C=g,w=o.apply(this,arguments)/2,E=w>vr&&(i?+i.apply(this,arguments):wn(d*d+f*f)),T=Gg(JY(f-d)/2,+n.apply(this,arguments)),O=T,N=T;if(E>vr){var A=XY(E/d*fs(w)),x=XY(E/f*fs(w));(D-=2*A)>vr?(v+=A*=m?1:-1,b-=A):(D=0,v=b=(h+p)/2),(C-=2*x)>vr?(_+=x*=m?1:-1,y-=x):(C=0,_=y=(h+p)/2)}var S=f*Vu(_),I=f*fs(_),M=d*Vu(b),L=d*fs(b);if(T>vr){var $,R=f*Vu(y),V=f*fs(y),U=d*Vu(v),z=d*fs(v);if(g<id&&($=H2e(S,I,U,z,R,V,M,L))){var Y=S-$[0],ie=I-$[1],K=R-$[0],le=V-$[1],G=1/fs(S2e((Y*K+ie*le)/(wn(Y*Y+ie*ie)*wn(K*K+le*le)))/2),Q=wn($[0]*$[0]+$[1]*$[1]);O=Gg(T,(d-Q)/(G-1)),N=Gg(T,(f-Q)/(G+1))}}C>vr?N>vr?(P=GD(U,z,S,I,f,N,m),j=GD(R,V,M,L,f,N,m),a.moveTo(P.cx+P.x01,P.cy+P.y01),N<T?a.arc(P.cx,P.cy,N,yr(P.y01,P.x01),yr(j.y01,j.x01),!m):(a.arc(P.cx,P.cy,N,yr(P.y01,P.x01),yr(P.y11,P.x11),!m),a.arc(0,0,f,yr(P.cy+P.y11,P.cx+P.x11),yr(j.cy+j.y11,j.cx+j.x11),!m),a.arc(j.cx,j.cy,N,yr(j.y11,j.x11),yr(j.y01,j.x01),!m))):(a.moveTo(S,I),a.arc(0,0,f,_,y,!m)):a.moveTo(S,I),d>vr&&D>vr?O>vr?(P=GD(M,L,R,V,d,-O,m),j=GD(S,I,U,z,d,-O,m),a.lineTo(P.cx+P.x01,P.cy+P.y01),O<T?a.arc(P.cx,P.cy,O,yr(P.y01,P.x01),yr(j.y01,j.x01),!m):(a.arc(P.cx,P.cy,O,yr(P.y01,P.x01),yr(P.y11,P.x11),!m),a.arc(0,0,d,yr(P.cy+P.y11,P.cx+P.x11),yr(j.cy+j.y11,j.cx+j.x11),m),a.arc(j.cx,j.cy,O,yr(j.y11,j.x11),yr(j.y01,j.x01),!m))):a.arc(0,0,d,b,v,m):a.lineTo(M,L)}else a.moveTo(0,0);if(a.closePath(),u)return a=null,u+""||null}return l.centroid=function(){var u=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-id/2;return[Vu(c)*u,fs(c)*u]},l.innerRadius=function(u){return arguments.length?(e="function"==typeof u?u:Ut(+u),l):e},l.outerRadius=function(u){return arguments.length?(t="function"==typeof u?u:Ut(+u),l):t},l.cornerRadius=function(u){return arguments.length?(n="function"==typeof u?u:Ut(+u),l):n},l.padRadius=function(u){return arguments.length?(i=null==u?null:"function"==typeof u?u:Ut(+u),l):i},l.startAngle=function(u){return arguments.length?(r="function"==typeof u?u:Ut(+u),l):r},l.endAngle=function(u){return arguments.length?(s="function"==typeof u?u:Ut(+u),l):s},l.padAngle=function(u){return arguments.length?(o="function"==typeof u?u:Ut(+u),l):o},l.context=function(u){return arguments.length?(a=null==u?null:u,l):a},l}().startAngle(e=>e.startAngle||0).endAngle(e=>e.endAngle||0).padAngle(e=>e.padAngle||0).innerRadius(e=>e.innerRadius||0).outerRadius(e=>e.outerRadius||0).cornerRadius(e=>e.cornerRadius||0),EIe=gK().x(Py).y1(Ly).y0(e=>(e.y||0)+(e.height||0)).defined(_C),SIe=gK().y(Ly).x1(Py).x0(e=>(e.x||0)+(e.width||0)).defined(_C),xIe=pK().x(Py).y(Ly).defined(_C),AIe=uX().x(Py).y(Ly).width(e=>e.width||0).height(e=>e.height||0).cornerRadius(e=>Fy(e.cornerRadiusTopLeft,e.cornerRadius)||0,e=>Fy(e.cornerRadiusTopRight,e.cornerRadius)||0,e=>Fy(e.cornerRadiusBottomRight,e.cornerRadius)||0,e=>Fy(e.cornerRadiusBottomLeft,e.cornerRadius)||0),MIe=function uNe(e,t){let n=null;function i(){let r;if(n||(n=r=th()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return e="function"==typeof e?e:Ut(e||FI),t="function"==typeof t?t:Ut(void 0===t?64:+t),i.type=function(r){return arguments.length?(e="function"==typeof r?r:Ut(r),i):e},i.size=function(r){return arguments.length?(t="function"==typeof r?r:Ut(+r),i):t},i.context=function(r){return arguments.length?(n=null==r?null:r,i):n},i}().type(e=>lX(e.shape||"circle")).size(e=>Fy(e.size,64)),TIe=cX().x(Py).y(Ly).defined(_C).size(e=>e.size||1);function OR(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function im(e,t,n,i){return AIe.context(e)(t,n,i)}var dX=1;function fX(){dX=1}function NR(e,t,n){var i=t.clip,r=e._defs,s=t.clip_id||(t.clip_id="clip"+dX++),o=r.clipping[s]||(r.clipping[s]={id:s});return rt(i)?o.path=i(null):OR(n)?o.path=im(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+s+")"}function di(e){this.clear(),e&&this.union(e)}function yC(e){this.mark=e,this.bounds=this.bounds||new di}function vC(e){yC.call(this,e),this.items=this.items||[]}function kR(e){this._pending=0,this._loader=e||DD()}function hX(e){e._pending+=1}function jy(e){e._pending-=1}function zu(e,t,n){if(t.stroke&&0!==t.opacity&&0!==t.strokeOpacity){const i=null!=t.strokeWidth?+t.strokeWidth:1;e.expand(i+(n?function PIe(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}(t,i):0))}return e}di.prototype={clone(){return new di(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(e,t,n){var{x1:i,y1:r,x2:s,y2:o}=this,a=Math.cos(e),l=Math.sin(e),u=t-t*a+n*l,c=n-t*l-n*a;return[a*i-l*r+u,l*i+a*r+c,a*i-l*o+u,l*i+a*o+c,a*s-l*r+u,l*s+a*r+c,a*s-l*o+u,l*s+a*o+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},fe(vC,yC),kR.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return hX(t),t._loader.sanitize(e,{context:"href"}).then(n=>(jy(t),n)).catch(()=>(jy(t),null))},loadImage(e){const t=this,n="undefined"!=typeof Image?Image:null;return hX(t),t._loader.sanitize(e,{context:"image"}).then(i=>{const r=i.href;if(!r||!n)throw{url:r};const s=new n,o=ke(i,"crossOrigin")?i.crossOrigin:"anonymous";return null!=o&&(s.crossOrigin=o),s.onload=()=>jy(t),s.onerror=()=>jy(t),s.src=r,s}).catch(i=>(jy(t),{complete:!1,width:0,height:0,src:i&&i.url||""}))},ready(){const e=this;return new Promise(t=>{!function n(i){e.pending()?setTimeout(()=>{n(!0)},10):t(i)}(!1)})}};const LIe=Tl-1e-8;let bC,wC,DC,dh,IR,CC,RR,FR;const fd=(e,t)=>bC.add(e,t),EC=(e,t)=>fd(wC=e,DC=t),pX=e=>fd(e,bC.y1),gX=e=>fd(bC.x1,e),fh=(e,t)=>IR*e+RR*t,hh=(e,t)=>CC*e+FR*t,PR=(e,t)=>fd(fh(e,t),hh(e,t)),LR=(e,t)=>EC(fh(e,t),hh(e,t));function By(e,t){return bC=e,t?(dh=t*cd,IR=FR=Math.cos(dh),CC=Math.sin(dh),RR=-CC):(IR=FR=1,dh=CC=RR=0),jIe}const jIe={beginPath(){},closePath(){},moveTo:LR,lineTo:LR,rect(e,t,n,i){dh?(PR(e+n,t),PR(e+n,t+i),PR(e,t+i),LR(e,t)):(fd(e+n,t+i),EC(e,t))},quadraticCurveTo(e,t,n,i){const r=fh(e,t),s=hh(e,t),o=fh(n,i),a=hh(n,i);mX(wC,r,o,pX),mX(DC,s,a,gX),EC(o,a)},bezierCurveTo(e,t,n,i,r,s){const o=fh(e,t),a=hh(e,t),l=fh(n,i),u=hh(n,i),c=fh(r,s),d=hh(r,s);_X(wC,o,l,c,pX),_X(DC,a,u,d,gX),EC(c,d)},arc(e,t,n,i,r,s){if(i+=dh,r+=dh,wC=n*Math.cos(r)+e,DC=n*Math.sin(r)+t,Math.abs(r-i)>LIe)fd(e-n,t-n),fd(e+n,t+n);else{const o=u=>fd(n*Math.cos(u)+e,n*Math.sin(u)+t);let a,l;if(o(i),o(r),r!==i)if((i%=Tl)<0&&(i+=Tl),(r%=Tl)<0&&(r+=Tl),r<i&&(s=!s,a=i,i=r,r=a),s)for(r-=Tl,a=i-i%ch,l=0;l<4&&a>r;++l,a-=ch)o(a);else for(a=i-i%ch+ch,l=0;l<4&&a<r;++l,a+=ch)o(a)}}};function mX(e,t,n,i){const r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function _X(e,t,n,i,r){const s=i-e+3*t-3*n,o=e+n-2*t,a=e-t;let c,l=0,u=0;Math.abs(s)>1e-14?(c=o*o+a*s,c>=0&&(c=Math.sqrt(c),l=(-o+c)/s,u=(-o-c)/s)):l=.5*a/o,0<l&&l<1&&r(yX(l,e,t,n,i)),0<u&&u<1&&r(yX(u,e,t,n,i))}function yX(e,t,n,i,r){const s=1-e,o=s*s,a=e*e;return o*s*t+3*o*e*n+3*s*a*i+a*e*r}var hd=(hd=rd(1,1))?hd.getContext("2d"):null;const jR=new di;function BR(e){return function(t,n){if(!hd)return!0;e(hd,t),jR.clear().union(t.bounds).intersect(n).round();const{x1:i,y1:r,x2:s,y2:o}=jR;for(let a=r;a<=o;++a)for(let l=i;l<=s;++l)if(hd.isPointInPath(l,a))return!0;return!1}}function $R(e,t){return t.contains(e.x||0,e.y||0)}function vX(e,t){const n=e.x||0,i=e.y||0;return t.intersects(jR.set(n,i,n+(e.width||0),i+(e.height||0)))}function bX(e,t){const n=e.x||0,i=e.y||0;return rm(t,n,i,null!=e.x2?e.x2:n,null!=e.y2?e.y2:i)}function rm(e,t,n,i,r){const{x1:s,y1:o,x2:a,y2:l}=e,u=i-t,c=r-n;let h,p,g,m,d=0,f=1;for(m=0;m<4;++m){if(0===m&&(h=-u,p=-(s-t)),1===m&&(h=u,p=a-t),2===m&&(h=-c,p=-(o-n)),3===m&&(h=c,p=l-n),Math.abs(h)<1e-10&&p<0)return!1;if(g=p/h,h<0){if(g>f)return!1;g>d&&(d=g)}else if(h>0){if(g<d)return!1;g<f&&(f=g)}}return!0}function sm(e,t){e.globalCompositeOperation=t.blend||"source-over"}function Ea(e,t){return null==e?t:e}function wX(e,t){const n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}function DX(e,t,n){return SR(n)?function BIe(e,t,n){const i=n.width(),r=n.height();let s;if("radial"===t.gradient)s=e.createRadialGradient(n.x1+Ea(t.x1,.5)*i,n.y1+Ea(t.y1,.5)*r,Math.max(i,r)*Ea(t.r1,0),n.x1+Ea(t.x2,.5)*i,n.y1+Ea(t.y2,.5)*r,Math.max(i,r)*Ea(t.r2,.5));else{const o=Ea(t.x1,0),a=Ea(t.y1,0),l=Ea(t.x2,1),u=Ea(t.y2,0);if(o!==l&&a!==u&&i!==r){const c=rd(Math.ceil(i),Math.ceil(r)),d=c.getContext("2d");return d.scale(i,r),d.fillStyle=wX(d.createLinearGradient(o,a,l,u),t.stops),d.fillRect(0,0,i,r),e.createPattern(c,"no-repeat")}s=e.createLinearGradient(n.x1+o*i,n.y1+a*r,n.x1+l*i,n.y1+u*r)}return wX(s,t.stops)}(e,n,t.bounds):n}function SC(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=DX(e,t,t.fill),!0)}var $Ie=[];function om(e,t,n){var i=null!=(i=t.strokeWidth)?i:1;return!(i<=0)&&(n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=DX(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||$Ie),e.lineDashOffset=t.strokeDashOffset||0),!0)}function VIe(e,t){return e.zindex-t.zindex||e.index-t.index}function VR(e){if(!e.zdirty)return e.zitems;var i,r,s,t=e.items,n=[];for(r=0,s=t.length;r<s;++r)(i=t[r]).index=r,i.zindex&&n.push(i);return e.zdirty=!1,e.zitems=n.sort(VIe)}function Sa(e,t){var i,r,n=e.items;if(!n||!n.length)return;const s=VR(e);if(s&&s.length){for(i=0,r=n.length;i<r;++i)n[i].zindex||t(n[i]);n=s}for(i=0,r=n.length;i<r;++i)t(n[i])}function xC(e,t){var i,r,n=e.items;if(!n||!n.length)return null;const s=VR(e);for(s&&s.length&&(n=s),r=n.length;--r>=0;)if(i=t(n[r]))return i;if(n===s)for(r=(n=e.items).length;--r>=0;)if(!n[r].zindex&&(i=t(n[r])))return i;return null}function HR(e){return function(t,n,i){Sa(n,r=>{(!i||i.intersects(r.bounds))&&CX(e,t,r,r)})}}function HIe(e){return function(t,n,i){n.items.length&&(!i||i.intersects(n.bounds))&&CX(e,t,n.items[0],n.items)}}function CX(e,t,n,i){var r=null==n.opacity?1:n.opacity;0!==r&&(e(t,i)||(sm(t,n),n.fill&&SC(t,n,r)&&t.fill(),n.stroke&&om(t,n,r)&&t.stroke()))}function AC(e){return e=e||Oo,function(t,n,i,r,s,o){return i*=t.pixelRatio,r*=t.pixelRatio,xC(n,a=>{const l=a.bounds;if((!l||l.contains(s,o))&&l&&e(t,a,i,r,s,o))return a})}}function $y(e,t){return function(n,i,r,s){var u,c,o=Array.isArray(i)?i[0]:i,a=null==t?o.fill:t,l=o.stroke&&n.isPointInStroke;return l&&(c=o.strokeCap,n.lineWidth=null!=(u=o.strokeWidth)?u:1,n.lineCap=null!=c?c:"butt"),!e(n,i)&&(a&&n.isPointInPath(r,s)||l&&n.isPointInStroke(r,s))}}function UR(e){return AC($y(e))}function ph(e,t){return"translate("+e+","+t+")"}function zR(e){return"rotate("+e+")"}function EX(e){return ph(e.x||0,e.y||0)}function qR(e,t,n){function s(o,a){var l=a.x||0,u=a.y||0,c=a.angle||0;o.translate(l,u),c&&o.rotate(c*=cd),o.beginPath(),t(o,a),c&&o.rotate(-c),o.translate(-l,-u)}return{type:e,tag:"path",nested:!1,attr:function i(o,a){o("transform",function zIe(e){return ph(e.x||0,e.y||0)+(e.angle?" "+zR(e.angle):"")}(a)),o("d",t(null,a))},bound:function r(o,a){return t(By(o,a.angle),a),zu(o,a).translate(a.x||0,a.y||0)},draw:HR(s),pick:UR(s),isect:n||BR(s)}}var GIe=qR("arc",function OIe(e,t){return CIe.context(e)(t)});function GR(e,t,n){function s(l,u){l.beginPath(),t(l,u)}const o=$y(s);return{type:e,tag:"path",nested:!0,attr:function i(l,u){var c=u.mark.items;c.length&&l("d",t(null,c))},bound:function r(l,u){var c=u.items;return 0===c.length?l:(t(By(l),c),zu(l,c[0]))},draw:HIe(s),pick:function a(l,u,c,d,f,h){var p=u.items,g=u.bounds;return!p||!p.length||g&&!g.contains(f,h)?null:o(l,p,c*=l.pixelRatio,d*=l.pixelRatio)?p[0]:null},isect:$R,tip:n}}var JIe=GR("area",function NIe(e,t){const n=t[0];return("horizontal"===n.orient?SIe:EIe).curve(xR(n.interpolate||"linear",n.orient,n.tension)).context(e)(t)},function WIe(e,t){for(var o,a,n="horizontal"===e[0].orient?t[1]:t[0],i="horizontal"===e[0].orient?"y":"x",r=e.length,s=1/0;--r>=0;)!1!==e[r].defined&&(a=Math.abs(e[r][i]-n))<s&&(s=a,o=e[r]);return o});function SX(e,t){e.beginPath(),OR(t)?im(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function xX(e){const t=Ea(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function AX(e,t){const n=xX(t);e("d",im(null,t,n,n))}function Vy(e,t,n,i){const r=xX(t);e.beginPath(),im(e,t,(n||0)+r,(i||0)+r)}const iRe=$y(Vy),rRe=$y(Vy,!1),sRe=$y(Vy,!0);var uRe={type:"group",tag:"g",nested:!1,attr:function QIe(e,t){e("transform",EX(t))},bound:function nRe(e,t){if(!t.clip&&t.items){const n=t.items,i=n.length;for(let r=0;r<i;++r)e.union(n[r].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),zu(e,t),e.translate(t.x||0,t.y||0)},draw:function oRe(e,t,n){Sa(t,i=>{const r=i.x||0,s=i.y||0,o=i.strokeForeground,a=null==i.opacity?1:i.opacity;(i.stroke||i.fill)&&a&&(Vy(e,i,r,s),sm(e,i),i.fill&&SC(e,i,a)&&e.fill(),i.stroke&&!o&&om(e,i,a)&&e.stroke()),e.save(),e.translate(r,s),i.clip&&SX(e,i),n&&n.translate(-r,-s),Sa(i,l=>{this.draw(e,l,n)}),n&&n.translate(r,s),e.restore(),o&&i.stroke&&a&&(Vy(e,i,r,s),sm(e,i),om(e,i,a)&&e.stroke())})},pick:function aRe(e,t,n,i,r,s){if(t.bounds&&!t.bounds.contains(r,s)||!t.items)return null;const o=n*e.pixelRatio,a=i*e.pixelRatio;return xC(t,l=>{let u,c,d;const f=l.bounds;if(f&&!f.contains(r,s))return;c=l.x||0,d=l.y||0;const g=l.clip;if(g&&(r<c||r>c+(l.width||0)||s<d||s>d+(l.height||0)))return;if(e.save(),e.translate(c,d),c=r-c,d=s-d,g&&OR(l)&&!sRe(e,l,o,a))return e.restore(),null;const m=l.strokeForeground,_=!1!==t.interactive;return _&&m&&l.stroke&&rRe(e,l,o,a)?(e.restore(),l):(u=xC(l,y=>function lRe(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}(y,c,d)?this.pick(y,n,i,c,d):null),!u&&_&&(l.fill||!m&&l.stroke)&&iRe(e,l,o,a)&&(u=l),e.restore(),u||null)})},isect:vX,content:function tRe(e,t,n){e("clip-path",t.clip?NR(n,t,t):null)},background:function ZIe(e,t){e("class","background"),e("aria-hidden",!0),AX(e,t)},foreground:function eRe(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?AX(e,t):e("d","")}},Hy={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function WR(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(i=>{e.image=i,e.image.url=e.url})),n}function YR(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function KR(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function MC(e,t){return"center"===e?t/2:"right"===e?t:0}function TC(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var hRe={type:"image",tag:"image",nested:!1,attr:function cRe(e,t,n){const i=WR(t,n),r=YR(t,i),s=KR(t,i),o=(t.x||0)-MC(t.align,r),a=(t.y||0)-TC(t.baseline,s);e("href",!i.src&&i.toDataURL?i.toDataURL():i.src||"",Hy["xmlns:xlink"],"xlink:href"),e("transform",ph(o,a)),e("width",r),e("height",s),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")},bound:function dRe(e,t){const n=t.image,i=YR(t,n),r=KR(t,n),s=(t.x||0)-MC(t.align,i),o=(t.y||0)-TC(t.baseline,r);return e.set(s,o,s+i,o+r)},draw:function fRe(e,t,n){Sa(t,i=>{if(n&&!n.intersects(i.bounds))return;const r=WR(i,this);let s=YR(i,r),o=KR(i,r);if(0===s||0===o)return;let u,c,d,f,a=(i.x||0)-MC(i.align,s),l=(i.y||0)-TC(i.baseline,o);!1!==i.aspect&&(c=r.width/r.height,d=i.width/i.height,c==c&&d==d&&c!==d&&(d<c?(f=s/c,l+=(o-f)/2,o=f):(f=o*c,a+=(s-f)/2,s=f))),(r.complete||r.toDataURL)&&(sm(e,i),e.globalAlpha=null!=(u=i.opacity)?u:1,e.imageSmoothingEnabled=!1!==i.smooth,e.drawImage(r,a,l,s,o))})},pick:AC(),isect:Oo,get:WR,xOffset:MC,yOffset:TC},pRe=GR("line",function kIe(e,t){const n=t[0];return xIe.curve(xR(n.interpolate||"linear",n.orient,n.tension)).context(e)(t)},function YIe(e,t){for(var r,s,n=Math.pow(e[0].strokeWidth||1,2),i=e.length;--i>=0;)if(!1!==e[i].defined&&(r=e[i].x-t[0])*r+(s=e[i].y-t[1])*s<n)return e[i];return null});function OC(e,t){var n=t.path;if(null==n)return!0;var i=t.x||0,r=t.y||0,s=t.scaleX||1,o=t.scaleY||1,a=(t.angle||0)*cd,l=t.pathCache;(!l||l.path!==n)&&((t.pathCache=l=tm(n)).path=n),a&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(a),Ry(e,l,0,0,s,o),e.rotate(-a),e.translate(-i,-r)):Ry(e,l,i,r,s,o)}var _Re={type:"path",tag:"path",nested:!1,attr:function gRe(e,t){(1!==(t.scaleX||1)||1!==(t.scaleY||1))&&e("vector-effect","non-scaling-stroke"),e("transform",function qIe(e){return ph(e.x||0,e.y||0)+(e.angle?" "+zR(e.angle):"")+(e.scaleX||e.scaleY?" "+function UIe(e,t){return"scale("+e+","+t+")"}(e.scaleX||1,e.scaleY||1):"")}(t)),e("d",t.path)},bound:function mRe(e,t){return OC(By(e,t.angle),t)?e.set(0,0,0,0):zu(e,t,!0)},draw:HR(OC),pick:UR(OC),isect:BR(OC)};function MX(e,t){e.beginPath(),im(e,t)}var bRe={type:"rect",tag:"path",nested:!1,attr:function yRe(e,t){e("d",im(null,t))},bound:function vRe(e,t){var n,i;return zu(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)},draw:HR(MX),pick:UR(MX),isect:vX};function TX(e,t,n){var i,r,s,o;return!(!t.stroke||!om(e,t,n)||(i=t.x||0,r=t.y||0,s=null!=t.x2?t.x2:i,o=null!=t.y2?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(s,o),0))}var SRe={type:"rule",tag:"line",nested:!1,attr:function wRe(e,t){e("transform",EX(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function DRe(e,t){var n,i;return zu(e.set(n=t.x||0,i=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:i),t)},draw:function CRe(e,t,n){Sa(t,i=>{if(!n||n.intersects(i.bounds)){var r=null==i.opacity?1:i.opacity;r&&TX(e,i,r)&&(sm(e,i),e.stroke())}})},pick:AC(function ERe(e,t,n,i){return!!e.isPointInStroke&&TX(e,t,1)&&e.isPointInStroke(n,i)}),isect:bX},xRe=qR("shape",function IIe(e,t){return(t.mark.shape||t.shape).context(e)(t)}),ARe=qR("symbol",function RIe(e,t){return MIe.context(e)(t)},$R);const OX=aG();var xa={height:Ol,measureWidth:XR,estimateWidth:JR,width:JR,canvas:NX};function NX(e){xa.width=e&&hd?XR:JR}function JR(e,t){return kX(gd(e,t),Ol(e))}function kX(e,t){return~~(.8*e.length*t)}function XR(e,t){return Ol(e)<=0||!(t=gd(e,t))?0:IX(t,NC(e))}function IX(e,t){const n="(".concat(t,") ").concat(e);let i=OX.get(n);return void 0===i&&(hd.font=t,i=hd.measureText(e).width,OX.set(n,i)),i}function Ol(e){return null!=e.fontSize?+e.fontSize||0:11}function pd(e){return null!=e.lineHeight?e.lineHeight:Ol(e)+2}function Uy(e){return function MRe(e){return ne(e)?e.length>1?e:e[0]:e}(e.lineBreak&&e.text&&!ne(e.text)?e.text.split(e.lineBreak):e.text)}function QR(e){const t=Uy(e);return(ne(t)?t.length-1:0)*pd(e)}function gd(e,t){const n=null==t?"":(t+"").trim();return e.limit>0&&n.length?function ORe(e,t){var n=+e.limit,i=function TRe(e){if(xa.width===XR){const t=NC(e);return n=>IX(n,t)}{const t=Ol(e);return n=>kX(n,t)}}(e);if(i(t)<n)return t;var l,r=e.ellipsis||"\u2026",s="rtl"===e.dir,o=0,a=t.length;if(n-=i(r),s){for(;o<a;)i(t.slice(l=o+a>>>1))>n?o=l+1:a=l;return r+t.slice(o)}for(;o<a;)i(t.slice(0,l=1+(o+a>>>1)))<n?o=l:a=l-1;return t.slice(0,o)+r}(e,n):n}function zy(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function NC(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+Ol(e)+"px "+zy(e,t)}function ZR(e){var t=e.baseline,n=Ol(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:"line-top"===t?.29*n+.5*pd(e):"line-bottom"===t?.29*n-.5*pd(e):0)}NX(!0);const NRe={left:"start",center:"middle",right:"end"},qy=new di;function kC(e){var r,t=e.x||0,n=e.y||0,i=e.radius||0;return i&&(r=(e.theta||0)-ch,t+=i*Math.cos(r),n+=i*Math.sin(r)),qy.x1=t,qy.y1=n,qy}function eF(e,t,n){var d,i=xa.height(t),r=t.align,s=kC(t),o=s.x1,a=s.y1,l=t.dx||0,u=(t.dy||0)+ZR(t)-Math.round(.8*i),c=Uy(t);if(ne(c)?(i+=pd(t)*(c.length-1),d=c.reduce((f,h)=>Math.max(f,xa.width(t,h)),0)):d=xa.width(t,c),"center"===r?l-=d/2:"right"===r&&(l-=d),e.set(l+=o,u+=a,l+d,u+i),t.angle&&!n)e.rotate(t.angle*cd,o,a);else if(2===n)return e.rotatedPoints(t.angle*cd,o,a);return e}var PRe={type:"text",tag:"text",nested:!1,attr:function kRe(e,t){var l,n=t.dx||0,i=(t.dy||0)+ZR(t),r=kC(t),s=r.x1,o=r.y1,a=t.angle||0;e("text-anchor",NRe[t.align]||"start"),a?(l=ph(s,o)+" "+zR(a),(n||i)&&(l+=" "+ph(n,i))):l=ph(s+n,o+i),e("transform",l)},bound:eF,draw:function IRe(e,t,n){Sa(t,i=>{var s,o,a,l,u,c,d,r=null==i.opacity?1:i.opacity;if(!(n&&!n.intersects(i.bounds)||0===r||i.fontSize<=0||null==i.text||0===i.text.length)){if(e.font=NC(i),e.textAlign=i.align||"left",o=(s=kC(i)).x1,a=s.y1,i.angle&&(e.save(),e.translate(o,a),e.rotate(i.angle*cd),o=a=0),o+=i.dx||0,a+=(i.dy||0)+ZR(i),c=Uy(i),sm(e,i),ne(c))for(u=pd(i),l=0;l<c.length;++l)d=gd(i,c[l]),i.fill&&SC(e,i,r)&&e.fillText(d,o,a),i.stroke&&om(e,i,r)&&e.strokeText(d,o,a),a+=u;else d=gd(i,c),i.fill&&SC(e,i,r)&&e.fillText(d,o,a),i.stroke&&om(e,i,r)&&e.strokeText(d,o,a);i.angle&&e.restore()}})},pick:AC(function RRe(e,t,n,i,r,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=kC(t),a=o.x1,l=o.y1,u=eF(qy,t,1),c=-t.angle*cd,d=Math.cos(c),f=Math.sin(c);return u.contains(d*r-f*s+(a-d*a+f*l),f*r+d*s+(l-f*a-d*l))}),isect:function FRe(e,t){const n=eF(qy,e,2);return rm(t,n[0],n[1],n[2],n[3])||rm(t,n[0],n[1],n[4],n[5])||rm(t,n[4],n[5],n[6],n[7])||rm(t,n[2],n[3],n[6],n[7])}},LRe=GR("trail",function FIe(e,t){return TIe.context(e)(t)},function KIe(e,t){for(var i,r,n=e.length;--n>=0;)if(!1!==e[n].defined&&(i=e[n].x-t[0])*i+(r=e[n].y-t[1])*r<(i=e[n].size||1)*i)return e[n];return null}),Ks={arc:GIe,area:JIe,group:uRe,image:hRe,line:pRe,path:_Re,rect:bRe,rule:SRe,shape:xRe,symbol:ARe,text:PRe,trail:LRe};function tF(e,t,n){var i=Ks[e.mark.marktype];return i.nested&&(e=e.mark),(t||i.bound)(e.bounds||(e.bounds=new di),e,n)}var RX={mark:null};function FX(e,t,n){var a,l,u,c,i=Ks[e.marktype],r=i.bound,s=e.items,o=s&&s.length;if(i.nested)return o?u=s[0]:(RX.mark=e,u=RX),c=tF(u,r,n),t&&t.union(c)||c;if(t=t||e.bounds&&e.bounds.clear()||new di,o)for(a=0,l=s.length;a<l;++a)t.union(tF(s[a],r,n));return e.bounds=t}const jRe=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function PX(e,t){return JSON.stringify(e,jRe,t)}function LX(e){return jX("string"==typeof e?JSON.parse(e):e)}function jX(e){var i,r,s,t=e.marktype,n=e.items;if(n)for(r=0,s=n.length;r<s;++r)n[r][i=t?"mark":"group"]=e,n[r].zindex&&(n[r][i].zdirty=!0),"group"===(t||i)&&jX(n[r]);return t&&FX(e),e}function nF(e){arguments.length?this.root=LX(e):(this.root=BX({marktype:"group",name:"root",role:"frame"}),this.root.items=[new vC(this.root)])}function BX(e,t){const n={bounds:new di,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return null!=e.aria&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function md(e,t,n){return!e&&"undefined"!=typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function iF(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function ps(e,t,n,i){var s,r=e.childNodes[t];return(!r||r.tagName.toLowerCase()!==n.toLowerCase())&&(s=r||null,r=md(e.ownerDocument,n,i),e.insertBefore(r,s)),r}function Aa(e,t){for(var n=e.childNodes,i=n.length;i>t;)e.removeChild(n[--i]);return e}function $X(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function IC(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function _d(e,t){this._active=null,this._handlers={},this._loader=e||DD(),this._tooltip=t||$Re}function $Re(e,t,n,i){e.element().setAttribute("title",i||"")}function Nl(e){this._el=null,this._bgcolor=null,this._loader=new kR(e)}nF.prototype={toJSON(e){return PX(this.root,e||0)},mark(e,t,n){const i=BX(e,t=t||this.root.items[0]);return t.items[n]=i,i.zindex&&(i.group.zdirty=!0),i}},_d.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let i=e?e.length:0;--i>=0;)if(e[i].type===t&&(!n||e[i].handler===n))return i;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const i in t)n.push(...t[i]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(i=>{const r=new MouseEvent(e.type,e),s=md(null,"a");for(const o in i)s.setAttribute(o,i[o]);s.dispatchEvent(r)}).catch(()=>{})},handleTooltip(e,t,n){t&&null!=t.tooltip&&(t=function BRe(e,t,n,i){var s,o,r=e&&e.mark;if(r&&(s=Ks[r.marktype]).tip){for((o=IC(t,n))[0]-=i[0],o[1]-=i[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=s.tip(r.items,o)}return e}(t,e,this.canvas(),this._origin),this._tooltip.call(this._obj,this,e,t,n&&t&&t.tooltip||null))},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),i=this._origin,r=e.bounds,s=r.width(),o=r.height();let a=r.x1+i[0]+n.left,l=r.y1+i[1]+n.top;for(;e.mark&&(e=e.mark.group);)a+=e.x||0,l+=e.y||0;return{x:a,y:l,width:s,height:o,left:a,top:l,right:a+s,bottom:l+o}}},Nl.prototype={initialize(e,t,n,i,r){return this._el=e,this.resize(t,n,i,r)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,i){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=i||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,i=n._loader[e](t);if(!n._ready){const r=n._call;n._ready=n._loader.ready().then(s=>{s&&r(),n._ready=null})}return i},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const VX="dragenter",RC="dragleave",HX="dragover",rF="mousedown",FC="mousemove",Gy="mouseout",UX="mouseover",PC="click",zX="mousewheel",LC="touchstart",jC="touchmove",BC="touchend",sF=FC,Wy=Gy,oF=PC;function Yy(e,t){_d.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}function qX(e,t){(e=>e===LC||e===jC||e===BC?[LC,jC,BC]:[e])(t).forEach(n=>function KRe(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?i=>e[t](i):i=>e.fire(t,i)))}(e,n))}function GX(e,t,n){return function(i){const r=this._active,s=this.pickEvent(i);s===r||((!r||!r.exit)&&this.fire(n,i),this._active=s,this.fire(t,i)),this.fire(e,i)}}function WX(e){return function(t){this.fire(e,t),this._active=null}}fe(Yy,_d,{initialize(e,t,n){return this._canvas=e&&iF(e,"canvas"),[PC,rF,FC,Gy,RC].forEach(i=>qX(this,i)),_d.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",VX,RC,HX,rF,"mouseup",FC,Gy,UX,PC,"dblclick","wheel",zX,LC,jC,BC],DOMMouseScroll(e){this.fire(zX,e)},mousemove:GX(FC,UX,Gy),dragover:GX(HX,VX,RC),mouseout:WX(Gy),dragleave:WX(RC),mousedown(e){this._down=this._active,this.fire(rF,e)},click(e){this._down===this._active&&(this.fire(PC,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(LC,e,!0)},touchmove(e){this.fire(jC,e,!0)},touchend(e){this.fire(BC,e,!0),this._touch=null},fire(e,t,n){const i=n?this._touch:this._active,r=this._handlers[e];if(t.vegaType=e,e===oF&&i&&i.href?this.handleHref(t,i,i.href):(e===sF||e===Wy)&&this.handleTooltip(t,i,e!==Wy),r)for(let s=0,o=r.length;s<o;++s)r[s].handler.call(this._obj,t,i)},on(e,t){const n=this.eventName(e),i=this._handlers;return this._handlerIndex(i[n],e,t)<0&&(qX(this,e),(i[n]||(i[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&i.splice(r,1),this},pickEvent(e){const t=IC(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,i,r){const s=this.context();return Ks[e.marktype].pick.call(this,s,e,t,n,i,r)}});var XRe=function JRe(){return"undefined"!=typeof window&&window.devicePixelRatio||1}();function $C(e){Nl.call(this,e),this._options={},this._redraw=!1,this._dirty=new di,this._tempb=new di}const YX=Nl.prototype;function aF(e,t){_d.call(this,e,t);const n=this;n._hrefHandler=lF(n,(i,r)=>{r&&r.href&&n.handleHref(i,r,r.href)}),n._tooltipHandler=lF(n,(i,r)=>{n.handleTooltip(i,r,i.type!==Wy)})}fe($C,Nl,{initialize(e,t,n,i,r,s){return this._options=s||{},this._canvas=this._options.externalContext?null:rd(1,1),e&&this._canvas&&(Aa(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),YX.initialize.call(this,e,t,n,i,r)},resize(e,t,n,i){if(YX.resize.call(this,e,t,n,i),this._canvas)!function QRe(e,t,n,i,r,s){const o="undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,a=e.getContext("2d"),l=o?XRe:r;e.width=t*l,e.height=n*l;for(const u in s)a[u]=s[u];o&&1!==l&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=l,a.setTransform(l,0,0,l,l*i[0],l*i[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const r=this._options.externalContext;r||ee("CanvasRenderer is missing a valid canvas or context"),r.scale(this._scale,this._scale),r.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,i=this._width,r=this._height,s=this._dirty,o=((e,t,n)=>(new di).set(0,0,t,n).translate(-e[0],-e[1]))(n,i,r);t.save();const a=this._redraw||s.empty()?(this._redraw=!1,o.expand(1)):function eFe(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(t,o.intersect(s),n);return this.clear(-n[0],-n[1],i,r),this.draw(t,e,a),t.restore(),s.clear(),this},draw(e,t,n){const i=Ks[t.marktype];t.clip&&function XIe(e,t){var n=t.clip;e.save(),rt(n)?(e.beginPath(),n(e),e.clip()):SX(e,t.group)}(e,t),i.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,i){const r=this._options,s=this.context();"pdf"!==r.type&&!r.externalContext&&s.clearRect(e,t,n,i),null!=this._bgcolor&&(s.fillStyle=this._bgcolor,s.fillRect(e,t,n,i))}});const lF=(e,t)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,t.call(e._obj,n,i)};fe(aF,_d,{initialize(e,t,n){let i=this._svg;return i&&(i.removeEventListener(oF,this._hrefHandler),i.removeEventListener(sF,this._tooltipHandler),i.removeEventListener(Wy,this._tooltipHandler)),this._svg=i=e&&iF(e,"svg"),i&&(i.addEventListener(oF,this._hrefHandler),i.addEventListener(sF,this._tooltipHandler),i.addEventListener(Wy,this._tooltipHandler)),_d.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),i=this._handlers;if(this._handlerIndex(i[n],e,t)<0){const s={type:e,handler:t,listener:lF(this,t)};(i[n]||(i[n]=[])).push(s),this._svg&&this._svg.addEventListener(n,s.listener)}return this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&(this._svg&&this._svg.removeEventListener(n,i[r].listener),i.splice(r,1)),this}});const KX="aria-hidden",uF="aria-label",cF="role",dF="aria-roledescription",JX="graphics-object",fF="graphics-symbol",XX=(e,t,n)=>({[cF]:e,[dF]:t,[uF]:n||void 0}),tFe=va(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),QX={axis:{desc:"axis",caption:function rFe(e){const t=e.datum,n=e.orient,i=t.title?iQ(e):null,r=e.context,s=r.scales[t.scale].value,o=r.dataflow.locale(),a=s.type;return"".concat("left"===n||"right"===n?"Y":"X","-axis")+(i?" titled '".concat(i,"'"):"")+" for a ".concat(em(a)?"discrete":a," scale")+" with ".concat(ZJ(o,s,e))}},legend:{desc:"legend",caption:function sFe(e){const t=e.datum,n=t.title?iQ(e):null,i="".concat(t.type||""," legend").trim(),r=t.scales,s=Object.keys(r),o=e.context,a=o.scales[r[s[0]]].value,l=o.dataflow.locale();return function aFe(e){return e.length?e[0].toUpperCase()+e.slice(1):e}(i)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function oFe(e){return e=e.map(t=>t+("fill"===t||"stroke"===t?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+bt(e)}(s))+" with ".concat(ZJ(l,a,e))}},"title-text":{desc:"title",caption:e=>"Title text '".concat(nQ(e),"'")},"title-subtitle":{desc:"subtitle",caption:e=>"Subtitle text '".concat(nQ(e),"'")}},ZX={ariaRole:cF,ariaRoleDescription:dF,description:uF};function eQ(e,t){const n=!1===t.aria;if(e(KX,n||void 0),n||null==t.description)for(const i in ZX)e(ZX[i],void 0);else{const i=t.mark.marktype;e(uF,t.description),e(cF,t.ariaRole||("group"===i?JX:fF)),e(dF,t.ariaRoleDescription||"".concat(i," mark"))}}function tQ(e){return!1===e.aria?{[KX]:!0}:tFe[e.role]?null:QX[e.role]?function iFe(e,t){try{const n=e.items[0],i=t.caption||(()=>"");return XX(t.role||fF,t.desc,n.description||i(n))}catch(n){return null}}(e,QX[e.role]):function nFe(e){const t=e.marktype,n="group"===t||"text"===t||e.items.some(i=>null!=i.description&&!1!==i.aria);return XX(n?JX:fF,"".concat(t," mark container"),e.description)}(e)}function nQ(e){return we(e.text).join(" ")}function iQ(e){try{return we(bt(e.items).items[0].text).join(" ")}catch(t){return null}}const rQ=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function hF(){let e="",t="",n="";const i=[],r=()=>t=n="",o=(l,u)=>(null!=u&&(t+=" ".concat(l,'="').concat((e=>rQ(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))(u),'"')),a),a={open(l){(l=>{t&&(e+="".concat(t,">").concat(n),r()),i.push(l)})(l),t="<"+l;for(var u=arguments.length,c=new Array(u>1?u-1:0),d=1;d<u;d++)c[d-1]=arguments[d];for(const f of c)for(const h in f)o(h,f[h]);return a},close(){const l=i.pop();return e+=t?t+(n?">".concat(n,"</").concat(l,">"):"/>"):"</".concat(l,">"),r(),a},attr:o,text:l=>(n+=rQ(l),a),toString:()=>e};return a}const sQ=e=>oQ(hF(),e)+"";function oQ(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,i=n.length;for(let r=0;r<i;++r)e.attr(n[r].name,n[r].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const i of n)3===i.nodeType?e.text(i.nodeValue):oQ(e,i)}return e.close()}const VC={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},HC={blend:"mix-blend-mode"},aQ={fill:"none","stroke-miterlimit":10},lQ="http://www.w3.org/2000/xmlns/",Ei=Hy.xmlns;function pF(e){Nl.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const gF=Nl.prototype;function uQ(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function uFe(e,t,n){let i,r,s;if("radial"===t.gradient){let o=ps(e,n++,"pattern",Ei);yd(o,{id:"p_"+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o=ps(o,0,"rect",Ei),yd(o,{width:1,height:1,fill:"url(".concat(dQ(),"#").concat(t.id,")")}),yd(e=ps(e,n++,"radialGradient",Ei),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else yd(e=ps(e,n++,"linearGradient",Ei),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(i=0,r=t.stops.length;i<r;++i)s=ps(e,i,"stop",Ei),s.setAttribute("offset",t.stops[i].offset),s.setAttribute("stop-color",t.stops[i].color);return Aa(e,i),n}function cFe(e,t,n){let i;return(e=ps(e,n,"clipPath",Ei)).setAttribute("id",t.id),t.path?(i=ps(e,0,"path",Ei),i.setAttribute("d",t.path)):(i=ps(e,0,"rect",Ei),yd(i,{x:0,y:0,width:t.width,height:t.height})),Aa(e,1),n+1}function cQ(e,t,n,i,r){let o,s=e._svg;if(!s&&(o=t.ownerDocument,s=md(o,i,Ei),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},"g"===i))){const a=md(o,"path",Ei);s.appendChild(a),a.__data__=e;const l=md(o,"g",Ei);s.appendChild(l),l.__data__=e;const u=md(o,"path",Ei);s.appendChild(u),u.__data__=e,u.__values__={fill:"default"}}return(s.ownerSVGElement!==r||function fFe(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}fe(pF,Nl,{initialize(e,t,n,i,r){return this._defs={},this._clearDefs(),e&&(this._svg=ps(e,0,"svg",Ei),this._svg.setAttributeNS(lQ,"xmlns",Ei),this._svg.setAttributeNS(lQ,"xmlns:xlink",Hy["xmlns:xlink"]),this._svg.setAttribute("version",Hy.version),this._svg.setAttribute("class","marks"),Aa(e,1),this._root=ps(this._svg,0,"g",Ei),yd(this._root,aQ),Aa(this._svg,1)),this.background(this._bgcolor),gF.initialize.call(this,e,t,n,i,r)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),gF.background.apply(this,arguments)},resize(e,t,n,i){return gF.resize.call(this,e,t,n,i),this._svg&&(yd(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=ps(e,0,"rect",Ei),yd(n,{width:this._width,height:this._height,fill:t}));const i=sQ(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),i},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),Aa(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,i,r,s,o,a,l;for(o=0,a=e.length;o<a;++o)if(n=e[o],i=n.mark,i.marktype!==r&&(r=i.marktype,s=Ks[r]),i.zdirty&&i.dirty!==t&&(this._dirtyAll=!1,uQ(n,t),i.items.forEach(u=>{u.dirty=t})),!i.zdirty){if(n.exit){s.nested&&i.items.length?(l=i.items[0],l._svg&&this._update(s,l._svg,l)):n._svg&&(l=n._svg.parentNode,l&&l.removeChild(n._svg)),n._svg=null;continue}n=s.nested?i.items[0]:n,n._update!==t&&(n._svg&&n._svg.ownerSVGElement?this._update(s,n._svg,n):(this._dirtyAll=!1,uQ(n,t)),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const i=this._svg,r=Ks[t.marktype],s=!1===t.interactive?"none":null,o="g"===r.tag,a=cQ(t,e,n,"g",i);a.setAttribute("class",$X(t));const l=tQ(t);for(const f in l)$r(a,f,l[f]);o||$r(a,"pointer-events",s),$r(a,"clip-path",t.clip?NR(this,t,t.group):null);let u=null,c=0;const d=f=>{const h=this.isDirty(f),p=cQ(f,a,u,r.tag,i);h&&(this._update(r,p,f),o&&function dFe(e,t,n){t=t.lastChild.previousSibling;let i,r=0;Sa(n,s=>{i=e.mark(t,s,i),++r}),Aa(t,1+r)}(this,p,f)),u=p,++c};return r.nested?t.items.length&&d(t.items[0]):Sa(t,d),Aa(a,c),a},_update(e,t,n){qu=t,br=t.__values__,eQ(Jy,n),e.attr(Jy,n,this);const i=hFe[e.type];i&&i.call(this,e,t,n),qu&&this.style(qu,n)},style(e,t){if(null!=t){for(const n in VC){let i="font"===n?zy(t):t[n];if(i===br[n])continue;const r=VC[n];null==i?e.removeAttribute(r):(SR(i)&&(i=tX(i,this._defs.gradient,dQ())),e.setAttribute(r,i+"")),br[n]=i}for(const n in HC)UC(e,HC[n],t[n])}},defs(){const e=this._svg,t=this._defs;let n=t.el,i=0;for(const r in t.gradient)n||(t.el=n=ps(e,1,"defs",Ei)),i=uFe(n,t.gradient[r],i);for(const r in t.clipping)n||(t.el=n=ps(e,1,"defs",Ei)),i=cFe(n,t.clipping[r],i);n&&(0===i?(e.removeChild(n),t.el=null):Aa(n,i))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});let qu=null,br=null;const hFe={group(e,t,n){const i=qu=t.childNodes[2];br=i.__values__,e.foreground(Jy,n,this),br=t.__values__,qu=t.childNodes[1],e.content(Jy,n,this);const r=qu=t.childNodes[0];e.background(Jy,n,this);const s=!1===n.mark.interactive?"none":null;if(s!==br.events&&($r(i,"pointer-events",s),$r(r,"pointer-events",s),br.events=s),n.strokeForeground&&n.stroke){const o=n.fill;$r(i,"display",null),this.style(r,n),$r(r,"stroke",null),o&&(n.fill=null),br=i.__values__,this.style(i,n),o&&(n.fill=o),qu=null}else $r(i,"display","none")},image(e,t,n){!1===n.smooth?(UC(t,"image-rendering","optimizeSpeed"),UC(t,"image-rendering","pixelated")):UC(t,"image-rendering",null)},text(e,t,n){const i=Uy(n);let r,s,o,a;ne(i)?(s=i.map(l=>gd(n,l)),r=s.join("\n"),r!==br.text&&(Aa(t,0),o=t.ownerDocument,a=pd(n),s.forEach((l,u)=>{const c=md(o,"tspan",Ei);c.__data__=n,c.textContent=l,u&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),br.text=r)):(s=gd(n,i),s!==br.text&&(t.textContent=s,br.text=s)),$r(t,"font-family",zy(n)),$r(t,"font-size",Ol(n)+"px"),$r(t,"font-style",n.fontStyle),$r(t,"font-variant",n.fontVariant),$r(t,"font-weight",n.fontWeight)}};function Jy(e,t,n){t!==br[e]&&(n?function pFe(e,t,n,i){null!=n?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}(qu,e,t,n):$r(qu,e,t),br[e]=t)}function UC(e,t,n){n!==br[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),br[t]=n)}function yd(e,t){for(const n in t)$r(e,n,t[n])}function $r(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function dQ(){let e;return"undefined"==typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function mF(e){Nl.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}fe(mF,Nl,{svg(){return this._text},_render(e){const t=hF();t.open("svg",st({},Hy,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",aQ,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=Ks[t.marktype],i=n.tag,r=[eQ,n.attr];e.open("g",{class:$X(t),"clip-path":t.clip?NR(this,t,t.group):null},tQ(t),{"pointer-events":"g"!==i&&!1===t.interactive?"none":null});const s=o=>{const a=this.href(o);if(a&&e.open("a",a),e.open(i,this.attr(t,o,r,"g"!==i?i:null)),"text"===i){const l=Uy(o);if(ne(l)){const u={x:0,dy:pd(o)};for(let c=0;c<l.length;++c)e.open("tspan",c?u:null).text(gd(o,l[c])).close()}else e.text(gd(o,l))}else if("g"===i){const l=o.strokeForeground,u=o.fill,c=o.stroke;l&&c&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),Sa(o,d=>this.mark(e,d)),e.close(),l&&c?(u&&(o.fill=null),o.stroke=c,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),u&&(o.fill=u)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),a&&e.close()};return n.nested?t.items&&t.items.length&&s(t.items[0]):Sa(t,s),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(i=>{i["xlink:href"]=i.href,i.href=null,(this._hrefs||(this._hrefs={}))[t]=i})}return null},attr(e,t,n,i){const r={},s=(o,a,l,u)=>{r[u||o]=a};return Array.isArray(n)?n.forEach(o=>o(s,t,this)):n(s,t,this),i&&function gFe(e,t,n,i,r){let s;if(null==t||("bgrect"===i&&!1===n.interactive&&(e["pointer-events"]="none"),"bgfore"===i&&(!1===n.interactive&&(e["pointer-events"]="none"),e.display="none",null!==t.fill)))return e;"image"===i&&!1===t.smooth&&(s=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),"text"===i&&(e["font-family"]=zy(t),e["font-size"]=Ol(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const o in VC){let a=t[o];const l=VC[o];"transparent"===a&&("fill"===l||"stroke"===l)||null!=a&&(SR(a)&&(a=tX(a,r.gradient,"")),e[l]=a)}for(const o in HC){const a=t[o];null!=a&&(s=s||[],s.push("".concat(HC[o],": ").concat(a,";")))}s&&(e.style=s.join(" "))}(r,t,e,i,this._defs),r},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const r in t){const s=t[r],o=s.stops;"radial"===s.gradient?(e.open("pattern",{id:"p_"+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),e.close(),e.open("radialGradient",{id:r,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):e.open("linearGradient",{id:r,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let a=0;a<o.length;++a)e.open("stop",{offset:o[a].offset,"stop-color":o[a].color}).close();e.close()}for(const r in n){const s=n[r];e.open("clipPath",{id:r}),s.path?e.open("path",{d:s.path}).close():e.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),e.close()}e.close()}}});const vd={Canvas:"canvas",PNG:"png",SVG:"svg",None:"none"},am={};function zC(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(am[e]=t,this):am[e]}function mQ(e,t,n){const i=[],r=(new di).union(t),s=e.marktype;return s?_Q(e,r,n,i):"group"===s?yQ(e,r,n,i):ee("Intersect scene must be mark node or group item.")}function _Q(e,t,n,i){if(function mFe(e,t,n){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!n||n(e)))}(e,t,n)){const r=e.items,s=e.marktype,o=r.length;let a=0;if("group"===s)for(;a<o;++a)yQ(r[a],t,n,i);else for(const l=Ks[s].isect;a<o;++a){const u=r[a];vQ(u,t,l)&&i.push(u)}}return i}function yQ(e,t,n,i){n&&n(e.mark)&&vQ(e,t,Ks.group.isect)&&i.push(e);const r=e.items,s=r&&r.length;if(s){const o=e.x||0,a=e.y||0;t.translate(-o,-a);for(let l=0;l<s;++l)_Q(r[l],t,n,i);t.translate(o,a)}return i}function vQ(e,t,n){const i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}am.canvas=am.png={renderer:$C,headless:$C,handler:Yy},am.svg={renderer:pF,headless:mF,handler:aF},am.none={};const _F=new di;function bQ(e){const t=e.clip;if(rt(t))t(By(_F.clear()));else{if(!t)return;_F.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(_F)}function yF(e,t,n){return e===t||("path"===n?wQ(e,t):e instanceof Date&&t instanceof Date?+e==+t:en(e)&&en(t)?Math.abs(e-t)<=1e-9:e&&t&&(Se(e)||Se(t))?function yFe(e,t){var r,s,n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(n.sort(),i.sort(),s=n.length-1;s>=0;s--)if(n[s]!=i[s])return!1;for(s=n.length-1;s>=0;s--)if(!yF(e[r=n[s]],t[r],r))return!1;return typeof e==typeof t}(e,t):e==t)}function wQ(e,t){return yF(tm(e),tm(t))}function vFe(){fX(),function zke(){eX=0}()}const lm="top",Ma="left",Ta="right",bd="bottom",vF="start",bF="middle",Vr="end",qC="group",wF="axis",DF="title",CF="legend",DQ="row-header",CQ="row-footer",EQ="row-title",SQ="column-header",xQ="column-footer",AQ="column-title",EF="none",GC="all",SF="each",xF="flush",wd="column",Dd="row";function TQ(e){J.call(this,null,e)}function WC(e,t,n){return t(e.bounds.clear(),e,n)}fe(TQ,J,{transform(e,t){const n=t.dataflow,i=e.mark,r=i.marktype,s=Ks[r],o=s.bound;let l,a=i.bounds;if(s.nested)i.items.length&&n.dirty(i.items[0]),a=WC(i,o),i.items.forEach(u=>{u.bounds.clear().union(a)});else if(r===qC||e.modified())switch(t.visit(t.MOD,u=>n.dirty(u)),a.clear(),i.items.forEach(u=>a.union(WC(u,o))),i.role){case wF:case CF:case DF:t.reflow()}else l=t.changed(t.REM),t.visit(t.ADD,u=>{a.union(WC(u,o))}),t.visit(t.MOD,u=>{l=l||a.alignsWith(u.bounds),n.dirty(u),a.union(WC(u,o))}),l&&(a.clear(),i.items.forEach(u=>a.union(u.bounds)));return bQ(i),t.modifies("bounds")}});const OQ=":vega_identifier:";function AF(e){J.call(this,0,e)}function NQ(e){J.call(this,null,e)}function kQ(e){J.call(this,null,e)}AF.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},fe(AF,J,{transform(e,t){const n=function IFe(e){return e._signals[OQ]||(e._signals[OQ]=e.add(0))}(t.dataflow),i=e.as;let r=n.value;return t.visit(t.ADD,s=>s[i]=s[i]||++r),n.set(this.value=r),t}}),fe(NQ,J,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,function RFe(e){const t=e.groups,n=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const i=n.marktype===qC?vC:yC;return t.visit(t.ADD,r=>i.call(r,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});const IQ={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((i,r)=>r&&RQ(n.bounds,i.bounds,t)?i.opacity=0:(n=i,1))}},RQ=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),FQ=(e,t)=>{for(var s,n=1,i=e.length,r=e[0].bounds;n<i;r=s,++n)if(RQ(r,s=e[n].bounds,t))return!0},FFe=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},PQ=e=>(e.forEach(t=>t.opacity=1),e),LQ=(e,t)=>e.reflow(t.modified()).modifies("opacity");function jQ(e){J.call(this,null,e)}fe(kQ,J,{transform(e,t){const n=IQ[e.method]||IQ.parity,i=e.separation||0;let s,o,r=t.materialize(t.SOURCE).source;if(!r||!r.length)return;if(!e.method)return e.modified("method")&&(PQ(r),t=LQ(t,e)),t;if(r=r.filter(FFe),!r.length)return;if(e.sort&&(r=r.slice().sort(e.sort)),s=PQ(r),t=LQ(t,e),s.length>=3&&FQ(s,i)){do{s=n(s,i)}while(s.length>=3&&FQ(s,i));s.length<3&&!bt(r).opacity&&(s.length>1&&(bt(s).opacity=0),bt(r).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(o=((e,t,n)=>{var i=e.range(),r=new di;return t===lm||t===bd?r.set(i[0],-1/0,i[1],1/0):r.set(-1/0,i[0],1/0,i[1]),r.expand(n||1),s=>r.encloses(s.bounds)})(e.boundScale,e.boundOrient,+e.boundTolerance),r.forEach(l=>{o(l)||(l.opacity=0)}));const a=s[0].mark.bounds.clear();return r.forEach(l=>{l.opacity&&a.union(l.bounds)}),t}}),fe(jQ,J,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,i=>n.dirty(i)),t.fields&&t.fields.zindex){const i=t.source&&t.source[0];i&&(i.mark.zdirty=!0)}}});const wr=new di;function um(e,t,n){return e[t]===n?0:(e[t]=n,1)}function LFe(e){var t=e.items[0].orient;return t===Ma||t===Ta}function BFe(e,t,n,i){var b,D,r=t.items[0],s=r.datum,o=null!=r.translate?r.translate:.5,a=r.orient,l=function jFe(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}(s),u=r.range,c=r.offset,d=r.position,f=r.minExtent,h=r.maxExtent,p=s.title&&r.items[l[2]].items[0],g=r.titlePadding,m=r.bounds,_=p&&QR(p),y=0,v=0;switch(wr.clear().union(m),m.clear(),(b=l[0])>-1&&m.union(r.items[b].bounds),(b=l[1])>-1&&m.union(r.items[b].bounds),a){case lm:y=d||0,v=-c,D=Math.max(f,Math.min(h,-m.y1)),m.add(0,-D).add(u,0),p&&YC(e,p,D,g,_,0,-1,m);break;case Ma:y=-c,v=d||0,D=Math.max(f,Math.min(h,-m.x1)),m.add(-D,0).add(0,u),p&&YC(e,p,D,g,_,1,-1,m);break;case Ta:y=n+c,v=d||0,D=Math.max(f,Math.min(h,m.x2)),m.add(0,0).add(D,u),p&&YC(e,p,D,g,_,1,1,m);break;case bd:y=d||0,v=i+c,D=Math.max(f,Math.min(h,m.y2)),m.add(0,0).add(u,D),p&&YC(e,p,D,g,0,0,1,m);break;default:y=r.x,v=r.y}return zu(m.translate(y,v),r),um(r,"x",y+o)|um(r,"y",v+o)&&(r.bounds=wr,e.dirty(r),r.bounds=m,e.dirty(r)),r.mark.bounds.clear().union(m)}function YC(e,t,n,i,r,s,o,a){const l=t.bounds;if(t.auto){const u=o*(n+r+i);let c=0,d=0;e.dirty(t),s?c=(t.x||0)-(t.x=u):d=(t.y||0)-(t.y=u),t.mark.bounds.clear().union(l.translate(-c,-d)),e.dirty(t)}a.union(l)}const BQ=(e,t)=>Math.floor(Math.min(e,t)),$Q=(e,t)=>Math.ceil(Math.max(e,t));function VFe(e){return(new di).set(0,0,e.width||0,e.height||0)}function HFe(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function kn(e,t,n){const i=Se(e)?e[t]:e;return null!=i?i:void 0!==n?n:0}function VQ(e){return e<0?Math.ceil(-e):0}function HQ(e,t,n){var C,w,E,T,O,N,P,j,A,x,S,i=!n.nodirty,r=n.bounds===xF?VFe:HFe,s=wr.set(0,0,0,0),o=kn(n.align,wd),a=kn(n.align,Dd),l=kn(n.padding,wd),u=kn(n.padding,Dd),c=n.columns||t.length,d=c<=0?1:Math.ceil(t.length/c),f=t.length,h=Array(f),p=Array(c),g=0,m=Array(f),_=Array(d),y=0,v=Array(f),b=Array(f),D=Array(f);for(w=0;w<c;++w)p[w]=0;for(w=0;w<d;++w)_[w]=0;for(w=0;w<f;++w)O=D[w]=r(N=t[w]),N.x=N.x||0,v[w]=0,N.y=N.y||0,b[w]=0,E=w%c,T=~~(w/c),g=Math.max(g,P=Math.ceil(O.x2)),y=Math.max(y,j=Math.ceil(O.y2)),p[E]=Math.max(p[E],P),_[T]=Math.max(_[T],j),h[w]=l+VQ(O.x1),m[w]=u+VQ(O.y1),i&&e.dirty(t[w]);for(w=0;w<f;++w)w%c==0&&(h[w]=0),w<c&&(m[w]=0);if(o===SF)for(E=1;E<c;++E){for(S=0,w=E;w<f;w+=c)S<h[w]&&(S=h[w]);for(w=E;w<f;w+=c)h[w]=S+p[E-1]}else if(o===GC){for(S=0,w=0;w<f;++w)w%c&&S<h[w]&&(S=h[w]);for(w=0;w<f;++w)w%c&&(h[w]=S+g)}else for(o=!1,E=1;E<c;++E)for(w=E;w<f;w+=c)h[w]+=p[E-1];if(a===SF)for(T=1;T<d;++T){for(S=0,C=(w=T*c)+c;w<C;++w)S<m[w]&&(S=m[w]);for(w=T*c;w<C;++w)m[w]=S+_[T-1]}else if(a===GC){for(S=0,w=c;w<f;++w)S<m[w]&&(S=m[w]);for(w=c;w<f;++w)m[w]=S+y}else for(a=!1,T=1;T<d;++T)for(C=(w=T*c)+c;w<C;++w)m[w]+=_[T-1];for(A=0,w=0;w<f;++w)v[w]+=(A=h[w]+(w%c?A:0))-t[w].x;for(E=0;E<c;++E)for(x=0,w=E;w<f;w+=c)b[w]+=(x+=m[w])-t[w].y;if(o&&kn(n.center,wd)&&d>1)for(w=0;w<f;++w)(A=(O=o===GC?g:p[w%c])-D[w].x2-t[w].x-v[w])>0&&(v[w]+=A/2);if(a&&kn(n.center,Dd)&&1!==c)for(w=0;w<f;++w)(x=(O=a===GC?y:_[~~(w/c)])-D[w].y2-t[w].y-b[w])>0&&(b[w]+=x/2);for(w=0;w<f;++w)s.union(D[w].translate(v[w],b[w]));switch(A=kn(n.anchor,"x"),x=kn(n.anchor,"y"),kn(n.anchor,wd)){case Vr:A-=s.width();break;case bF:A-=s.width()/2}switch(kn(n.anchor,Dd)){case Vr:x-=s.height();break;case bF:x-=s.height()/2}for(A=Math.round(A),x=Math.round(x),s.clear(),w=0;w<f;++w)t[w].mark.bounds.clear();for(w=0;w<f;++w)(N=t[w]).x+=v[w]+=A,N.y+=b[w]+=x,s.union(N.mark.bounds.union(N.bounds.translate(v[w],b[w]))),i&&e.dirty(N);return s}function zFe(e,t){return"x1"===t?e.x||0:"y1"===t?e.y||0:"x2"===t?(e.x||0)+(e.width||0):"y2"===t?(e.y||0)+(e.height||0):void 0}function qFe(e,t){return e.bounds[t]}function KC(e,t,n,i,r,s,o,a,l,u,c,d,f,h){var _,y,v,b,D,C,w,E,T,p=n.length,g=0,m=0;if(!p)return g;for(_=c;_<p;_+=d)n[_]&&(g=o(g,l(n[_],u)));if(!t.length)return g;for(t.length>r&&(e.warn("Grid headers exceed limit: "+r),t=t.slice(0,r)),g+=s,y=0,b=t.length;y<b;++y)e.dirty(t[y]),t[y].mark.bounds.clear();for(_=c,y=0,b=t.length;y<b;++y,_+=d){for(D=(C=t[y]).mark.bounds,v=_;v>=0&&null==(w=n[v]);v-=f);a?(E=null==h?w.x:Math.round(w.bounds.x1+h*w.bounds.width()),T=g):(E=g,T=null==h?w.y:Math.round(w.bounds.y1+h*w.bounds.height())),D.union(C.bounds.translate(E-(C.x||0),T-(C.y||0))),C.x=E,C.y=T,e.dirty(C),m=o(m,D[u])}return m}function UQ(e,t,n,i,r,s){if(t){e.dirty(t);var o=n,a=n;i?o=Math.round(r.x1+s*r.width()):a=Math.round(r.y1+s*r.height()),t.bounds.translate(o-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=a,e.dirty(t)}}function YFe(e,t,n,i,r,s,o){const a=function GFe(e,t){const n=e[t]||{};return(i,r)=>null!=n[i]?n[i]:null!=e[i]?e[i]:r}(n,t),l=function WFe(e,t){let n=-1/0;return e.forEach(i=>{null!=i.offset&&(n=Math.max(n,i.offset))}),n>-1/0?n:t}(e,a("offset",0)),u=a("anchor",vF),c=u===Vr?1:u===bF?.5:0,d={align:SF,bounds:a("bounds",xF),columns:"vertical"===a("direction")?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case Ma:d.anchor={x:Math.floor(i.x1)-l,column:Vr,y:c*(o||i.height()+2*i.y1),row:u};break;case Ta:d.anchor={x:Math.ceil(i.x2)+l,y:c*(o||i.height()+2*i.y1),row:u};break;case lm:d.anchor={y:Math.floor(r.y1)-l,row:Vr,x:c*(s||r.width()+2*r.x1),column:u};break;case bd:d.anchor={y:Math.ceil(r.y2)+l,x:c*(s||r.width()+2*r.x1),column:u};break;case"top-left":d.anchor={x:l,y:l};break;case"top-right":d.anchor={x:s-l,y:l,column:Vr};break;case"bottom-left":d.anchor={x:l,y:o-l,row:Vr};break;case"bottom-right":d.anchor={x:s-l,y:o-l,column:Vr,row:Vr}}return d}function KFe(e,t){var l,u,n=t.items[0],i=n.datum,r=n.orient,s=n.bounds,o=n.x,a=n.y;return n._bounds?n._bounds.clear().union(s):n._bounds=s.clone(),s.clear(),function XFe(e,t,n){var i=t.padding,r=i-n.x,s=i-n.y;if(t.datum.title){var o=t.items[1].items[0],a=o.anchor,l=t.titlePadding||0,u=i-o.x,c=i-o.y;switch(o.orient){case Ma:r+=Math.ceil(o.bounds.width())+l;break;case Ta:case bd:break;default:s+=o.bounds.height()+l}switch((r||s)&&Xy(e,n,r,s),o.orient){case Ma:c+=cm(t,n,o,a,1,1);break;case Ta:u+=cm(t,n,o,Vr,0,0)+l,c+=cm(t,n,o,a,1,1);break;case bd:u+=cm(t,n,o,a,0,0),c+=cm(t,n,o,Vr,-1,0,1)+l;break;default:u+=cm(t,n,o,a,0,0)}(u||c)&&Xy(e,o,u,c),(u=Math.round(o.bounds.x1-i))<0&&(Xy(e,n,-u,0),Xy(e,o,-u,0))}else(r||s)&&Xy(e,n,r,s)}(e,n,n.items[0].items[0]),s=function JFe(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}(n,s),l=2*n.padding,u=2*n.padding,s.empty()||(l=Math.ceil(s.width()+l),u=Math.ceil(s.height()+u)),"symbol"===i.type&&function QFe(e){const t=e.reduce((n,i)=>(n[i.column]=Math.max(i.bounds.x2-i.x,n[i.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}(n.items[0].items[0].items[0].items),r!==EF&&(n.x=o=0,n.y=a=0),n.width=l,n.height=u,zu(s.set(o,a,o+l,a+u),n),n.mark.bounds.clear().union(s),n}function cm(e,t,n,i,r,s,o){const l=n.datum.vgrad,c=("symbol"===e.datum.type||!s&&l||o?t:t.items[0]).bounds[r?"y2":"x2"]-e.padding,d=l&&s?c:0,f=l&&s?0:c,h=r<=0?0:QR(n);return Math.round(i===vF?d:i===Vr?f-h:.5*(c-h))}function Xy(e,t,n,i){t.x+=n,t.y+=i,t.bounds.translate(n,i),t.mark.bounds.translate(n,i),e.dirty(t)}function zQ(e){J.call(this,null,e)}function qQ(e,t){let n=0;if(void 0===t)for(let i of e)(i=+i)&&(n+=i);else{let i=-1;for(let r of e)(r=+t(r,++i,e))&&(n+=r)}return n}function GQ(e){J.call(this,null,e)}function WQ(e){J.call(this,null,e)}function iPe(){return Vt({})}function YQ(e){J.call(this,null,e)}function KQ(e){J.call(this,[],e)}fe(zQ,J,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(i=>{e.layout&&function UFe(e,t,n){var c,d,f,h,p,g,m,i=function $Fe(e){var r,s,t=e.items,n=t.length,i=0;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;i<n;++i)if(s=(r=t[i]).items,r.marktype===qC)switch(r.role){case wF:case CF:case DF:break;case DQ:o.rowheaders.push(...s);break;case CQ:o.rowfooters.push(...s);break;case SQ:o.colheaders.push(...s);break;case xQ:o.colfooters.push(...s);break;case EQ:o.rowtitle=s[0];break;case AQ:o.coltitle=s[0];break;default:o.marks.push(...s)}return o}(t),r=i.marks,s=n.bounds===xF?zFe:qFe,o=n.offset,a=n.columns||r.length,l=a<=0?1:Math.ceil(r.length/a),u=l*a;const _=HQ(e,r,n);_.empty()&&_.set(0,0,0,0),i.rowheaders&&(g=kn(n.headerBand,Dd,null),c=KC(e,i.rowheaders,r,0,l,-kn(o,"rowHeader"),BQ,0,s,"x1",0,a,1,g)),i.colheaders&&(g=kn(n.headerBand,wd,null),d=KC(e,i.colheaders,r,0,a,-kn(o,"columnHeader"),BQ,1,s,"y1",0,1,a,g)),i.rowfooters&&(g=kn(n.footerBand,Dd,null),f=KC(e,i.rowfooters,r,0,l,kn(o,"rowFooter"),$Q,0,s,"x2",a-1,a,1,g)),i.colfooters&&(g=kn(n.footerBand,wd,null),h=KC(e,i.colfooters,r,0,a,kn(o,"columnFooter"),$Q,1,s,"y2",u-a,1,a,g)),i.rowtitle&&(p=kn(n.titleAnchor,Dd),m=kn(o,"rowTitle"),m=p===Vr?f+m:c-m,g=kn(n.titleBand,Dd,.5),UQ(e,i.rowtitle,m,0,_,g)),i.coltitle&&(p=kn(n.titleAnchor,wd),m=kn(o,"columnTitle"),m=p===Vr?h+m:d-m,g=kn(n.titleBand,wd,.5),UQ(e,i.coltitle,m,1,_,g))}(n,i,e.layout),function tPe(e,t,n){var c,d,f,p,g,i=t.items,r=Math.max(0,t.width||0),s=Math.max(0,t.height||0),o=(new di).set(0,0,r,s),a=o.clone(),l=o.clone(),u=[];for(p=0,g=i.length;p<g;++p)switch(d=i[p],d.role){case wF:(LFe(d)?a:l).union(BFe(e,d,r,s));break;case DF:c=d;break;case CF:u.push(KFe(e,d));break;case"frame":case"scope":case DQ:case CQ:case EQ:case SQ:case xQ:case AQ:a.union(d.bounds),l.union(d.bounds);break;default:o.union(d.bounds)}if(u.length){const m={};u.forEach(_=>{(f=_.orient||Ta)!==EF&&(m[f]||(m[f]=[])).push(_)});for(const _ in m){const y=m[_];HQ(e,y,YFe(y,_,n.legends,a,l,r,s))}u.forEach(_=>{const y=_.bounds;if(y.equals(_._bounds)||(_.bounds=_._bounds,e.dirty(_),_.bounds=y,e.dirty(_)),n.autosize&&"fit"===n.autosize.type)switch(_.orient){case Ma:case Ta:o.add(y.x1,0).add(y.x2,0);break;case lm:case bd:o.add(0,y.y1).add(0,y.y2)}else o.union(y)})}o.union(a).union(l),c&&o.union(function ZFe(e,t,n,i,r){var v,s=t.items[0],a=s.orient,l=s.anchor,u=s.offset,c=s.padding,d=s.items[0].items[0],f=s.items[1]&&s.items[1].items[0],h=a===Ma||a===Ta?i:n,p=0,g=0,m=0,_=0,y=0;if(s.frame!==qC?a===Ma?(p=r.y2,h=r.y1):a===Ta?(p=r.y1,h=r.y2):(p=r.x1,h=r.x2):a===Ma&&(p=i,h=0),v=l===vF?p:l===Vr?h:(p+h)/2,f&&f.text){switch(a){case lm:case bd:y=d.bounds.height()+c;break;case Ma:_=d.bounds.width()+c;break;case Ta:_=-d.bounds.width()-c}wr.clear().union(f.bounds),wr.translate(_-(f.x||0),y-(f.y||0)),um(f,"x",_)|um(f,"y",y)&&(e.dirty(f),f.bounds.clear().union(wr),f.mark.bounds.clear().union(wr),e.dirty(f)),wr.clear().union(f.bounds)}else wr.clear();switch(wr.union(d.bounds),a){case lm:g=v,m=r.y1-wr.height()-u;break;case Ma:g=r.x1-wr.width()-u,m=v;break;case Ta:g=r.x2+wr.width()+u,m=v;break;case bd:g=v,m=r.y2+u;break;default:g=s.x,m=s.y}return um(s,"x",g)|um(s,"y",m)&&(wr.translate(g,m),e.dirty(s),s.bounds.clear().union(wr),t.bounds.clear().union(wr),e.dirty(s)),s.bounds}(e,c,r,s,o)),t.clip&&o.set(0,0,t.width||0,t.height||0),function nPe(e,t,n,i){const r=i.autosize||{},s=r.type;if(e._autosize<1||!s)return;let o=e._width,a=e._height,l=Math.max(0,t.width||0),u=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),d=Math.max(0,Math.ceil(-n.y1));const f=Math.max(0,Math.ceil(n.x2-l)),h=Math.max(0,Math.ceil(n.y2-c));if("padding"===r.contains){const p=e.padding();o-=p.left+p.right,a-=p.top+p.bottom}s===EF?(u=0,d=0,l=o,c=a):"fit"===s?(l=Math.max(0,o-u-f),c=Math.max(0,a-d-h)):"fit-x"===s?(l=Math.max(0,o-u-f),a=c+d+h):"fit-y"===s?(o=l+u+f,c=Math.max(0,a-d-h)):"pad"===s&&(o=l+u+f,a=c+d+h),e._resizeView(o,a,l,c,[u,d],r.resize)}(e,t,o,n)}(n,i,e)}),function ePe(e){return e&&"legend-entry"!==e.mark.role}(e.mark.group)?t.reflow():t}}),fe(GQ,J,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.scale,a=DR(s,null==e.count?e.values?e.values.length:10:e.count,e.minstep),l=e.format||GJ(n,s,a,e.formatSpecifier,e.formatType,!!e.values),u=e.values?qJ(s,e.values,a):CR(s,a);return r&&(i.rem=r),r=u.map((c,d)=>Vt({index:d/(u.length-1||1),value:c,label:l(c)})),e.extra&&r.length&&r.push(Vt({index:-1,extra:{value:r[0].value},label:""})),i.source=r,i.add=r,this.value=r,i}}),fe(WQ,J,{transform(e,t){var n=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||iPe,s=e.key||Pe,o=this.value;return ne(i.encode)&&(i.encode=null),o&&(e.modified("key")||t.modified(s))&&ee("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=function rPe(e){const t=Ng().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}(s)),t.visit(t.ADD,a=>{const l=s(a);let u=o.get(l);u?u.exit?(o.empty--,i.add.push(u)):i.mod.push(u):(u=r(a),o.set(l,u),i.add.push(u)),u.datum=a,u.exit=!1}),t.visit(t.MOD,a=>{const l=s(a),u=o.get(l);u&&(u.datum=a,i.mod.push(u))}),t.visit(t.REM,a=>{const l=s(a),u=o.get(l);a===u.datum&&!u.exit&&(i.rem.push(u),u.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&i.modifies("datum"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),i}}),fe(YQ,J,{transform(e,t){var n=t.fork(t.ADD_REM),i=e.mod||!1,r=e.encoders,s=t.encode;if(ne(s)){if(!n.changed()&&!s.every(d=>r[d]))return t.StopPropagation;s=s[0],n.encode=null}var o="enter"===s,a=r.update||Hc,l=r.enter||Hc,u=r.exit||Hc,c=(s&&!o?r[s]:a)||Hc;if(t.changed(t.ADD)&&(t.visit(t.ADD,d=>{l(d,e),a(d,e)}),n.modifies(l.output),n.modifies(a.output),c!==Hc&&c!==a&&(t.visit(t.ADD,d=>{c(d,e)}),n.modifies(c.output))),t.changed(t.REM)&&u!==Hc&&(t.visit(t.REM,d=>{u(d,e)}),n.modifies(u.output)),o||c!==Hc){const d=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(d,f=>{const h=l(f,e)||i;(c(f,e)||h)&&n.mod.push(f)}),n.mod.length&&n.modifies(l.output)):t.visit(d,f=>{(c(f,e)||i)&&n.mod.push(f)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}}),fe(KQ,J,{transform(e,t){if(null!=this.value&&!e.modified())return t.StopPropagation;var f,h,p,g,m,n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.type||pC,o=e.scale,a=+e.limit,l=DR(o,null==e.count?5:e.count,e.minstep),c=e.format||JJ(n,o,l,s,e.formatSpecifier,e.formatType,!!e.values||s===pC),d=e.values||KJ(o,l);return r&&(i.rem=r),s===pC?(a&&d.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),r=d.slice(0,a-1),m=!0):r=d,rt(p=e.size)?(!e.values&&0===o(r[0])&&(r=r.slice(1)),g=r.reduce((_,y)=>Math.max(_,p(y,e)),0)):p=gr(g=p||8),r=r.map((_,y)=>Vt({index:y,label:c(_,y,r),value:_,offset:g,size:p(_,e)})),m&&(m=d[r.length],r.push(Vt({index:r.length,label:"\u2026".concat(d.length-r.length," entries"),value:m,offset:g,size:p(m,e)})))):"gradient"===s?(f=o.domain(),h=VJ(o,f[0],bt(f)),d.length<3&&!e.values&&f[0]!==bt(f)&&(d=[f[0],bt(f)]),r=d.map((_,y)=>Vt({index:y,label:c(_,y,d),value:_,perc:h(_)}))):(p=d.length-1,h=function Hke(e){const t=e.domain(),n=t.length-1;let i=+t[0],r=+bt(t),s=r-i;if(e.type===dC){const o=n?s/n:.1;i-=o,r+=o,s=r-i}return o=>(o-i)/s}(o),r=d.map((_,y)=>Vt({index:y,label:c(_,y,d),value:_,perc:y?h(_):0,perc2:y===p?1:h(d[y+1])}))),i.source=r,i.add=r,this.value=r,i}});const sPe=e=>e.source.x,oPe=e=>e.source.y,aPe=e=>e.target.x,lPe=e=>e.target.y;function MF(e){J.call(this,{},e)}MF.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},fe(MF,J,{transform(e,t){var n=e.sourceX||sPe,i=e.sourceY||oPe,r=e.targetX||aPe,s=e.targetY||lPe,o=e.as||"path",l=e.shape||"line",u=ZQ.get(l+"-"+(e.orient||"vertical"))||ZQ.get(l);return u||ee("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[o]=u(n(c),i(c),r(c),s(c))}),t.reflow(e.modified()).modifies(o)}});const JQ=(e,t,n,i)=>"M"+e+","+t+"L"+n+","+i,XQ=(e,t,n,i)=>{var r=n-e,s=i-t,o=Math.sqrt(r*r+s*s)/2;return"M"+e+","+t+"A"+o+","+o+" "+180*Math.atan2(s,r)/Math.PI+" 0 1 "+n+","+i},QQ=(e,t,n,i)=>{const r=n-e,s=i-t,o=.2*(r+s),a=.2*(s-r);return"M"+e+","+t+"C"+(e+o)+","+(t+a)+" "+(n+a)+","+(i-o)+" "+n+","+i},ZQ=Ng({line:JQ,"line-radial":(e,t,n,i)=>JQ(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),arc:XQ,"arc-radial":(e,t,n,i)=>XQ(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),curve:QQ,"curve-radial":(e,t,n,i)=>QQ(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),"orthogonal-horizontal":(e,t,n,i)=>"M"+e+","+t+"V"+i+"H"+n,"orthogonal-vertical":(e,t,n,i)=>"M"+e+","+t+"H"+n+"V"+i,"orthogonal-radial":(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n);return"M"+t*r+","+t*s+"A"+t+","+t+" 0 0,"+((Math.abs(n-e)>Math.PI?n<=e:n>e)?1:0)+" "+t*o+","+t*a+"L"+i*o+","+i*a},"diagonal-horizontal":(e,t,n,i)=>{const r=(e+n)/2;return"M"+e+","+t+"C"+r+","+t+" "+r+","+i+" "+n+","+i},"diagonal-vertical":(e,t,n,i)=>{const r=(t+i)/2;return"M"+e+","+t+"C"+e+","+r+" "+n+","+r+" "+n+","+i},"diagonal-radial":(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),l=(t+i)/2;return"M"+t*r+","+t*s+"C"+l*r+","+l*s+" "+l*o+","+l*a+" "+i*o+","+i*a}});function TF(e){J.call(this,null,e)}function eZ(e){return yR(e)&&e!==Al}TF.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},fe(TF,J,{transform(e,t){var p,g,m,n=e.as||["startAngle","endAngle"],i=n[0],r=n[1],o=e.startAngle||0,a=null!=e.endAngle?e.endAngle:2*Math.PI,l=t.source,u=l.map(e.field||Mg),c=u.length,d=o,f=(a-o)/qQ(u),h=Ys(c);for(e.sort&&h.sort((_,y)=>u[_]-u[y]),p=0;p<c;++p)m=u[h[p]],(g=l[h[p]])[i]=d,g[r]=d+=m*f;return this.value=u,t.reflow(e.modified()).modifies(n)}});const hPe=va(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function tZ(e){J.call(this,null,e),this.modified(!0)}function nZ(e,t,n){return PJ(e)&&Math.abs(t.reduce((r,s)=>r+(s<0?-1:s>0?1:0),0))!==t.length&&n.warn("Log scale domain includes zero: "+pe(t)),t}function iZ(e,t,n){return rt(e)&&(t||n)?BJ(e,OF(t||[0,1],n)):e}function OF(e,t){return t?e.slice().reverse():e}function rZ(e){J.call(this,null,e)}fe(tZ,J,{transform(e,t){var n=t.dataflow,i=this.value,r=function pPe(e){var i,t=e.type,n="";return t===Al?Al+"-"+Xg:(function gPe(e){const t=e.type;return yR(t)&&t!==ah&&t!==lh&&(e.scheme||e.range&&e.range.length&&e.range.every(be))}(e)&&(n=2===(i=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(null!=e.domainMid):0)?Al+"-":3===i?Qg+"-":""),(n+t||Xg).toLowerCase())}(e);for(r in(!i||r!==i.type)&&(this.value=i=Ft(r)()),e)if(!hPe[r]){if("padding"===r&&eZ(i.type))continue;rt(i[r])?i[r](e[r]):n.warn("Unsupported scale property: "+r)}return function bPe(e,t,n){var i=e.type,r=t.round||!1,s=t.range;if(null!=t.rangeStep)s=function wPe(e,t,n){return"band"!==e&&e!==pR&&ee("Only band and point scales support rangeStep."),[0,t.rangeStep*fR(n,e===pR?1:(null!=t.paddingInner?t.paddingInner:t.padding)||0,(null!=t.paddingOuter?t.paddingOuter:t.padding)||0)]}(i,t,n);else if(t.scheme&&rt(s=function DPe(e,t,n){var s,i=t.schemeExtent;return ne(t.scheme)?s=hC(t.scheme,t.interpolate,t.interpolateGamma):(s=wR(t.scheme.toLowerCase()))||ee("Unrecognized scheme name: ".concat(t.scheme)),n=e===dC?n+1:e===gR?n-1:e===Zg||e===cC?+t.schemeCount||5:n,LJ(e)?iZ(s,i,t.reverse):rt(s)?$J(iZ(s,i),n):e===hR?s:s.slice(0,n)}(i,t,n))){if(e.interpolator)return e.interpolator(s);ee("Scale type ".concat(i," does not support interpolating color schemes."))}if(s&&LJ(i))return e.interpolator(hC(OF(s,t.reverse),t.interpolate,t.interpolateGamma));s&&t.interpolate&&e.interpolate?e.interpolate(bR(t.interpolate,t.interpolateGamma)):rt(e.round)?e.round(r):rt(e.rangeRound)&&e.interpolate(r?Ay:ad),s&&e.range(OF(s,t.reverse))}(i,e,function vPe(e,t,n){let i=t.bins;if(i&&!ne(i)){const r=e.domain(),s=r[0],o=bt(r),a=i.step;let l=null==i.start?s:i.start,u=null==i.stop?o:i.stop;a||ee("Scale bins parameter missing step property."),l<s&&(l=a*Math.ceil(s/a)),u>o&&(u=a*Math.floor(o/a)),i=Ys(l,u+a/2,a)}return i?e.bins=i:e.bins&&delete e.bins,e.type===gR&&(i?!t.domain&&!t.domainRaw&&(e.domain(i),n=i.length):e.bins=e.domain()),n}(i,e,function mPe(e,t,n){const i=function _Pe(e,t,n){return t?(e.domain(nZ(e.type,t,n)),t.length):-1}(e,t.domainRaw,n);if(i>-1)return i;var a,l,r=t.domain,s=e.type,o=t.zero||void 0===t.zero&&function fPe(e){const t=e.type;return!e.bins&&(t===Xg||t===Oy||t===Ny)}(e);if(!r)return 0;if(eZ(s)&&t.padding&&r[0]!==bt(r)&&(r=function yPe(e,t,n,i,r,s){var o=Math.abs(bt(n)-n[0]),a=o/(o-2*i),l=e===Hu?xN(t,null,a):e===Ny?aD(t,null,a,.5):e===Oy?aD(t,null,a,r||1):e===uC?AN(t,null,a,s||1):SN(t,null,a);return(t=t.slice())[0]=l[0],t[t.length-1]=l[1],t}(s,r,t.range,t.padding,t.exponent,t.constant)),(o||null!=t.domainMin||null!=t.domainMax||null!=t.domainMid)&&(a=(r=r.slice()).length-1||1,o&&(r[0]>0&&(r[0]=0),r[a]<0&&(r[a]=0)),null!=t.domainMin&&(r[0]=t.domainMin),null!=t.domainMax&&(r[a]=t.domainMax),null!=t.domainMid)){const u=(l=t.domainMid)>r[a]?a+1:l<r[0]?0:a;u!==a&&n.warn("Scale domainMid exceeds domain min or max.",l),r.splice(u,0,l)}return e.domain(nZ(s,r,n)),s===hR&&e.unknown(t.domainImplicit?nR:void 0),t.nice&&e.nice&&e.nice(!0!==t.nice&&DR(e,t.nice)||null),r.length}(i,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),fe(rZ,J,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(Xf(e.sort)),this.modified(n),t}});const aZ="normalize",lZ=["y0","y1"];function NF(e){J.call(this,null,e)}function CPe(e,t,n,i,r){for(var l,s=(t-e.sum)/2,o=e.length,a=0;a<o;++a)(l=e[a])[i]=s,l[r]=s+=Math.abs(n(l))}function EPe(e,t,n,i,r){for(var c,s=1/e.sum,o=0,a=e.length,l=0,u=0;l<a;++l)(c=e[l])[i]=o,c[r]=o=s*(u+=Math.abs(n(c)))}function SPe(e,t,n,i,r){for(var u,c,s=0,o=0,a=e.length,l=0;l<a;++l)(u=+n(c=e[l]))<0?(c[i]=o,c[r]=o+=u):(c[i]=s,c[r]=s+=u)}NF.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:"zero",values:["zero","center",aZ]},{name:"as",type:"string",array:!0,length:2,default:lZ}]},fe(NF,J,{transform(e,t){var l,u,c,d,n=e.as||lZ,i=n[0],r=n[1],s=Xf(e.sort),o=e.field||Mg,a="center"===e.offset?CPe:e.offset===aZ?EPe:SPe;for(l=function xPe(e,t,n,i){var o,a,l,u,c,d,f,h,p,r=[],s=g=>g(c);if(null==t)r.push(e.slice());else for(o={},a=0,l=e.length;a<l;++a)c=e[a],(f=o[d=t.map(s)])||(o[d]=f=[],r.push(f)),f.push(c);for(d=0,p=0,u=r.length;d<u;++d){for(a=0,h=0,l=(f=r[d]).length;a<l;++a)h+=Math.abs(i(f[a]));f.sum=h,h>p&&(p=h),n&&f.sort(n)}return r.max=p,r}(t.source,e.groupby,s,o),u=0,c=l.length,d=l.max;u<c;++u)a(l[u],d,o,i,r);return t.reflow(e.modified()).modifies(n)}});const Qy=e=>e;function JC(e,t){e&&cZ.hasOwnProperty(e.type)&&cZ[e.type](e,t)}var uZ={Feature:function(e,t){JC(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)JC(n[i].geometry,t)}},cZ={Sphere:function(e,t){t.sphere()},Point:function(e,t){t.point((e=e.coordinates)[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)t.point((e=n[i])[0],e[1],e[2])},LineString:function(e,t){kF(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)kF(n[i],t,0)},Polygon:function(e,t){dZ(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)dZ(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)JC(n[i],t)}};function kF(e,t,n){var s,i=-1,r=e.length-n;for(t.lineStart();++i<r;)t.point((s=e[i])[0],s[1],s[2]);t.lineEnd()}function dZ(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)kF(e[n],t,1);t.polygonEnd()}function Gu(e,t){e&&uZ.hasOwnProperty(e.type)?uZ[e.type](e,t):JC(e,t)}class Ki{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const s=n[r],o=t+s,a=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);a&&(n[i++]=a),t=o}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let i,r,s,n=this._n,o=0;if(n>0){for(o=t[--n];n>0&&(i=o,r=t[--n],o=i+r,s=r-(o-i),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(r=2*s,i=o+r,r==i-o&&(o=i))}return o}}var Be=1e-6,XC=1e-12,ft=Math.PI,Gn=ft/2,QC=ft/4,Hr=2*ft,ii=180/ft,ht=ft/180,St=Math.abs,dm=Math.atan,jo=Math.atan2,He=Math.cos,ZC=Math.ceil,fZ=Math.exp,IF=(Math,Math.hypot),eE=Math.log,RF=Math.pow,Ie=Math.sin,Bo=Math.sign||function(e){return e>0?1:e<0?-1:0},Ur=Math.sqrt,FF=Math.tan;function hZ(e){return e>1?0:e<-1?ft:Math.acos(e)}function gs(e){return e>1?Gn:e<-1?-Gn:Math.asin(e)}function Ji(){}var pZ,gZ,jF,BF,PF=new Ki,LF=new Ki,Cd={point:Ji,lineStart:Ji,lineEnd:Ji,polygonStart:function(){Cd.lineStart=APe,Cd.lineEnd=TPe},polygonEnd:function(){Cd.lineStart=Cd.lineEnd=Cd.point=Ji,PF.add(St(LF)),LF=new Ki},result:function(){var e=PF/2;return PF=new Ki,e}};function APe(){Cd.point=MPe}function MPe(e,t){Cd.point=mZ,pZ=jF=e,gZ=BF=t}function mZ(e,t){LF.add(BF*e-jF*t),jF=e,BF=t}function TPe(){mZ(pZ,gZ)}const _Z=Cd;var fm=1/0,tE=fm,Zy=-fm,nE=Zy,OPe={point:function NPe(e,t){e<fm&&(fm=e),e>Zy&&(Zy=e),t<tE&&(tE=t),t>nE&&(nE=t)},lineStart:Ji,lineEnd:Ji,polygonStart:Ji,polygonEnd:Ji,result:function(){var e=[[fm,tE],[Zy,nE]];return Zy=nE=-(tE=fm=1/0),e}};const iE=OPe;var yZ,vZ,kl,Il,$F=0,VF=0,ev=0,rE=0,sE=0,hm=0,HF=0,UF=0,tv=0,Oa={point:gh,lineStart:bZ,lineEnd:wZ,polygonStart:function(){Oa.lineStart=RPe,Oa.lineEnd=FPe},polygonEnd:function(){Oa.point=gh,Oa.lineStart=bZ,Oa.lineEnd=wZ},result:function(){var e=tv?[HF/tv,UF/tv]:hm?[rE/hm,sE/hm]:ev?[$F/ev,VF/ev]:[NaN,NaN];return $F=VF=ev=rE=sE=hm=HF=UF=tv=0,e}};function gh(e,t){$F+=e,VF+=t,++ev}function bZ(){Oa.point=kPe}function kPe(e,t){Oa.point=IPe,gh(kl=e,Il=t)}function IPe(e,t){var n=e-kl,i=t-Il,r=Ur(n*n+i*i);rE+=r*(kl+e)/2,sE+=r*(Il+t)/2,hm+=r,gh(kl=e,Il=t)}function wZ(){Oa.point=gh}function RPe(){Oa.point=PPe}function FPe(){DZ(yZ,vZ)}function PPe(e,t){Oa.point=DZ,gh(yZ=kl=e,vZ=Il=t)}function DZ(e,t){var n=e-kl,i=t-Il,r=Ur(n*n+i*i);rE+=r*(kl+e)/2,sE+=r*(Il+t)/2,hm+=r,HF+=(r=Il*e-kl*t)*(kl+e),UF+=r*(Il+t),tv+=3*r,gh(kl=e,Il=t)}const CZ=Oa;function EZ(e){this._context=e}EZ.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Hr)}},result:Ji};var qF,SZ,xZ,nv,iv,zF=new Ki,oE={point:Ji,lineStart:function(){oE.point=LPe},lineEnd:function(){qF&&AZ(SZ,xZ),oE.point=Ji},polygonStart:function(){qF=!0},polygonEnd:function(){qF=null},result:function(){var e=+zF;return zF=new Ki,e}};function LPe(e,t){oE.point=AZ,SZ=nv=e,xZ=iv=t}function AZ(e,t){zF.add(Ur((nv-=e)*nv+(iv-=t)*iv)),nv=e,iv=t}const MZ=oE;function TZ(){this._string=[]}function OZ(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function NZ(e,t){var i,r,n=4.5;function s(o){return o&&("function"==typeof n&&r.pointRadius(+n.apply(this,arguments)),Gu(o,i(r))),r.result()}return s.area=function(o){return Gu(o,i(_Z)),_Z.result()},s.measure=function(o){return Gu(o,i(MZ)),MZ.result()},s.bounds=function(o){return Gu(o,i(iE)),iE.result()},s.centroid=function(o){return Gu(o,i(CZ)),CZ.result()},s.projection=function(o){return arguments.length?(i=null==o?(e=null,Qy):(e=o).stream,s):e},s.context=function(o){return arguments.length?(r=null==o?(t=null,new TZ):new EZ(t=o),"function"!=typeof n&&r.pointRadius(n),s):t},s.pointRadius=function(o){return arguments.length?(n="function"==typeof o?o:(r.pointRadius(+o),+o),s):n},s.projection(e).context(t)}function kZ(){var t,e=[];return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:Ji,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function aE(e,t){return St(e[0]-t[0])<Be&&St(e[1]-t[1])<Be}function lE(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function IZ(e,t,n,i,r){var a,l,s=[],o=[];if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,y,m=p[0],_=p[g];if(aE(m,_)){if(!m[2]&&!_[2]){for(r.lineStart(),a=0;a<g;++a)r.point((m=p[a])[0],m[1]);return void r.lineEnd()}_[0]+=2*Be}s.push(y=new lE(m,p,null,!0)),o.push(y.o=new lE(m,null,y,!1)),s.push(y=new lE(_,p,null,!1)),o.push(y.o=new lE(_,null,y,!0))}}),s.length){for(o.sort(t),RZ(s),RZ(o),a=0,l=o.length;a<l;++a)o[a].e=n=!n;for(var c,d,u=s[0];;){for(var f=u,h=!0;f.v;)if((f=f.n)===u)return;c=f.z,r.lineStart();do{if(f.v=f.o.v=!0,f.e){if(h)for(a=0,l=c.length;a<l;++a)r.point((d=c[a])[0],d[1]);else i(f.x,f.n.x,1,r);f=f.n}else{if(h)for(a=(c=f.p.z).length-1;a>=0;--a)r.point((d=c[a])[0],d[1]);else i(f.x,f.p.x,-1,r);f=f.p}c=(f=f.o).z,h=!h}while(!f.v);r.lineEnd()}}}function RZ(e){if(t=e.length){for(var t,r,n=0,i=e[0];++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function uE(e){return[jo(e[1],e[0]),gs(e[2])]}function mh(e){var t=e[0],n=e[1],i=He(n);return[i*He(t),i*Ie(t),Ie(n)]}function cE(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function pm(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function GF(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function dE(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function fE(e){var t=Ur(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function WF(e){return St(e[0])<=ft?e[0]:Bo(e[0])*((St(e[0])+ft)%Hr-ft)}function FZ(e){return Array.from(function*BPe(e){for(const t of e)yield*t}(e))}function PZ(e,t,n,i){return function(r){var u,c,d,s=t(r),o=kZ(),a=t(o),l=!1,f={point:h,lineStart:g,lineEnd:m,polygonStart:function(){f.point=_,f.lineStart=y,f.lineEnd=v,c=[],u=[]},polygonEnd:function(){f.point=h,f.lineStart=g,f.lineEnd=m,c=FZ(c);var b=function jPe(e,t){var n=WF(t),i=t[1],r=Ie(i),s=[Ie(n),-He(n),0],o=0,a=0,l=new Ki;1===r?i=Gn+Be:-1===r&&(i=-Gn-Be);for(var u=0,c=e.length;u<c;++u)if(f=(d=e[u]).length)for(var d,f,h=d[f-1],p=WF(h),g=h[1]/2+QC,m=Ie(g),_=He(g),y=0;y<f;++y,p=b,m=C,_=w,h=v){var v=d[y],b=WF(v),D=v[1]/2+QC,C=Ie(D),w=He(D),E=b-p,T=E>=0?1:-1,O=T*E,N=O>ft,P=m*C;if(l.add(jo(P*T*Ie(O),_*w+P*He(O))),o+=N?E+T*Hr:E,N^p>=n^b>=n){var j=pm(mh(h),mh(v));fE(j);var A=pm(s,j);fE(A);var x=(N^E>=0?-1:1)*gs(A[2]);(i>x||i===x&&(j[0]||j[1]))&&(a+=N^E>=0?1:-1)}}return(o<-Be||o<Be&&l<-XC)^1&a}(u,i);c.length?(l||(r.polygonStart(),l=!0),IZ(c,VPe,b,n,r)):b&&(l||(r.polygonStart(),l=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),l&&(r.polygonEnd(),l=!1),c=u=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function h(b,D){e(b,D)&&r.point(b,D)}function p(b,D){s.point(b,D)}function g(){f.point=p,s.lineStart()}function m(){f.point=h,s.lineEnd()}function _(b,D){d.push([b,D]),a.point(b,D)}function y(){a.lineStart(),d=[]}function v(){_(d[0][0],d[0][1]),a.lineEnd();var C,E,T,O,b=a.clean(),D=o.result(),w=D.length;if(d.pop(),u.push(d),d=null,w){if(1&b){if((E=(T=D[0]).length-1)>0){for(l||(r.polygonStart(),l=!0),r.lineStart(),C=0;C<E;++C)r.point((O=T[C])[0],O[1]);r.lineEnd()}return}w>1&&2&b&&D.push(D.pop().concat(D.shift())),c.push(D.filter($Pe))}}return f}}function $Pe(e){return e.length>1}function VPe(e,t){return((e=e.x)[0]<0?e[1]-Gn-Be:Gn-e[1])-((t=t.x)[0]<0?t[1]-Gn-Be:Gn-t[1])}TZ.prototype={_radius:4.5,_circle:OZ(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._string.push("M",e,",",t),this._point=1;break;case 1:this._string.push("L",e,",",t);break;default:null==this._circle&&(this._circle=OZ(this._radius)),this._string.push("M",e,",",t,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}};const LZ=PZ(function(){return!0},function HPe(e){var r,t=NaN,n=NaN,i=NaN;return{lineStart:function(){e.lineStart(),r=1},point:function(s,o){var a=s>0?ft:-ft,l=St(s-t);St(l-ft)<Be?(e.point(t,n=(n+o)/2>0?Gn:-Gn),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(s,n),r=0):i!==a&&l>=ft&&(St(t-i)<Be&&(t-=i*Be),St(s-a)<Be&&(s-=a*Be),n=function UPe(e,t,n,i){var r,s,o=Ie(e-n);return St(o)>Be?dm((Ie(t)*(s=He(i))*Ie(n)-Ie(i)*(r=He(t))*Ie(e))/(r*s*o)):(t+i)/2}(t,n,s,o),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),r=0),e.point(t=s,n=o),i=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}},function zPe(e,t,n,i){var r;if(null==e)i.point(-ft,r=n*Gn),i.point(0,r),i.point(ft,r),i.point(ft,0),i.point(ft,-r),i.point(0,-r),i.point(-ft,-r),i.point(-ft,0),i.point(-ft,r);else if(St(e[0]-t[0])>Be){var s=e[0]<t[0]?ft:-ft;i.point(-s,r=n*s/2),i.point(0,r),i.point(s,r)}else i.point(t[0],t[1])},[-ft,-Gn]);function BZ(e,t){(t=mh(t))[0]-=e,fE(t);var n=hZ(-t[1]);return((-t[2]<0?-n:n)+Hr-Be)%Hr}function qPe(e){var t=He(e),n=6*ht,i=t>0,r=St(t)>Be;function o(c,d){return He(c)*He(d)>t}function l(c,d,f){var g=[1,0,0],m=pm(mh(c),mh(d)),_=cE(m,m),y=m[0],v=_-y*y;if(!v)return!f&&c;var b=t*_/v,D=-t*y/v,C=pm(g,m),w=dE(g,b);GF(w,dE(m,D));var T=C,O=cE(w,T),N=cE(T,T),P=O*O-N*(cE(w,w)-1);if(!(P<0)){var j=Ur(P),A=dE(T,(-O-j)/N);if(GF(A,w),A=uE(A),!f)return A;var L,x=c[0],S=d[0],I=c[1],M=d[1];S<x&&(L=x,x=S,S=L);var R=S-x,V=St(R-ft)<Be;if(!V&&M<I&&(L=I,I=M,M=L),V||R<Be?V?I+M>0^A[1]<(St(A[0]-x)<Be?I:M):I<=A[1]&&A[1]<=M:R>ft^(x<=A[0]&&A[0]<=S)){var z=dE(T,(-O+j)/N);return GF(z,w),[A,uE(z)]}}}function u(c,d){var f=i?e:ft-e,h=0;return c<-f?h|=1:c>f&&(h|=2),d<-f?h|=4:d>f&&(h|=8),h}return PZ(o,function a(c){var d,f,h,p,g;return{lineStart:function(){p=h=!1,g=1},point:function(m,_){var v,y=[m,_],b=o(m,_),D=i?b?0:u(m,_):b?u(m+(m<0?ft:-ft),_):0;if(!d&&(p=h=b)&&c.lineStart(),b!==h&&(!(v=l(d,y))||aE(d,v)||aE(y,v))&&(y[2]=1),b!==h)g=0,b?(c.lineStart(),v=l(y,d),c.point(v[0],v[1])):(v=l(d,y),c.point(v[0],v[1],2),c.lineEnd()),d=v;else if(r&&d&&i^b){var C;!(D&f)&&(C=l(y,d,!0))&&(g=0,i?(c.lineStart(),c.point(C[0][0],C[0][1]),c.point(C[1][0],C[1][1]),c.lineEnd()):(c.point(C[1][0],C[1][1]),c.lineEnd(),c.lineStart(),c.point(C[0][0],C[0][1],3)))}b&&(!d||!aE(d,y))&&c.point(y[0],y[1]),d=y,h=b,f=D},lineEnd:function(){h&&c.lineEnd(),d=null},clean:function(){return g|(p&&h)<<1}}},function s(c,d,f,h){!function jZ(e,t,n,i,r,s){if(n){var o=He(t),a=Ie(t),l=i*n;null==r?(r=t+i*Hr,s=t-l/2):(r=BZ(o,r),s=BZ(o,s),(i>0?r<s:r>s)&&(r+=i*Hr));for(var u,c=r;i>0?c>s:c<s;c-=l)u=uE([o,-a*He(c),-a*Ie(c)]),e.point(u[0],u[1])}}(h,e,n,f,c,d)},i?[0,-e]:[-ft,e-ft])}var rv=1e9,hE=-rv;function $Z(e,t,n,i){function r(u,c){return e<=u&&u<=n&&t<=c&&c<=i}function s(u,c,d,f){var h=0,p=0;if(null==u||(h=o(u,d))!==(p=o(c,d))||l(u,c)<0^d>0)do{f.point(0===h||3===h?e:n,h>1?i:t)}while((h=(h+d+4)%4)!==p);else f.point(c[0],c[1])}function o(u,c){return St(u[0]-e)<Be?c>0?0:3:St(u[0]-n)<Be?c>0?2:1:St(u[1]-t)<Be?c>0?1:0:c>0?3:2}function a(u,c){return l(u.x,c.x)}function l(u,c){var d=o(u,1),f=o(c,1);return d!==f?d-f:0===d?c[1]-u[1]:1===d?u[0]-c[0]:2===d?u[1]-c[1]:c[0]-u[0]}return function(u){var f,h,p,g,m,_,y,v,b,D,C,c=u,d=kZ(),w={point:E,lineStart:function P(){w.point=A,h&&h.push(p=[]),D=!0,b=!1,y=v=NaN},lineEnd:function j(){f&&(A(g,m),_&&b&&d.rejoin(),f.push(d.result())),w.point=E,b&&c.lineEnd()},polygonStart:function O(){c=d,f=[],h=[],C=!0},polygonEnd:function N(){var x=function T(){for(var x=0,S=0,I=h.length;S<I;++S)for(var U,z,M=h[S],L=1,R=M.length,V=M[0],$=V[0],Y=V[1];L<R;++L)U=$,z=Y,$=(V=M[L])[0],Y=V[1],z<=i?Y>i&&($-U)*(i-z)>(Y-z)*(e-U)&&++x:Y<=i&&($-U)*(i-z)<(Y-z)*(e-U)&&--x;return x}(),S=C&&x,I=(f=FZ(f)).length;(S||I)&&(u.polygonStart(),S&&(u.lineStart(),s(null,null,1,u),u.lineEnd()),I&&IZ(f,a,x,s,u),u.polygonEnd()),c=u,f=h=p=null}};function E(x,S){r(x,S)&&c.point(x,S)}function A(x,S){var I=r(x,S);if(h&&p.push([x,S]),D)g=x,m=S,_=I,D=!1,I&&(c.lineStart(),c.point(x,S));else if(I&&b)c.point(x,S);else{var M=[y=Math.max(hE,Math.min(rv,y)),v=Math.max(hE,Math.min(rv,v))],L=[x=Math.max(hE,Math.min(rv,x)),S=Math.max(hE,Math.min(rv,S))];!function GPe(e,t,n,i,r,s){var p,o=e[0],a=e[1],c=0,d=1,f=t[0]-o,h=t[1]-a;if(p=n-o,f||!(p>0)){if(p/=f,f<0){if(p<c)return;p<d&&(d=p)}else if(f>0){if(p>d)return;p>c&&(c=p)}if(p=r-o,f||!(p<0)){if(p/=f,f<0){if(p>d)return;p>c&&(c=p)}else if(f>0){if(p<c)return;p<d&&(d=p)}if(p=i-a,h||!(p>0)){if(p/=h,h<0){if(p<c)return;p<d&&(d=p)}else if(h>0){if(p>d)return;p>c&&(c=p)}if(p=s-a,h||!(p<0)){if(p/=h,h<0){if(p>d)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<d&&(d=p)}return c>0&&(e[0]=o+c*f,e[1]=a+c*h),d<1&&(t[0]=o+d*f,t[1]=a+d*h),!0}}}}}(M,L,e,t,n,i)?I&&(c.lineStart(),c.point(x,S),C=!1):(b||(c.lineStart(),c.point(M[0],M[1])),c.point(L[0],L[1]),I||c.lineEnd(),C=!1)}y=x,v=S,b=I}return w}}function YF(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return(i=t.invert(i,r))&&e.invert(i[0],i[1])}),n}function KF(e,t){return[St(e)>ft?e+Math.round(-e/Hr)*Hr:e,t]}function VZ(e,t,n){return(e%=Hr)?t||n?YF(UZ(e),zZ(t,n)):UZ(e):t||n?zZ(t,n):KF}function HZ(e){return function(t,n){return[(t+=e)>ft?t-Hr:t<-ft?t+Hr:t,n]}}function UZ(e){var t=HZ(e);return t.invert=HZ(-e),t}function zZ(e,t){var n=He(e),i=Ie(e),r=He(t),s=Ie(t);function o(a,l){var u=He(l),c=He(a)*u,d=Ie(a)*u,f=Ie(l),h=f*n+c*i;return[jo(d*r-h*s,c*n-f*i),gs(h*r+d*s)]}return o.invert=function(a,l){var u=He(l),c=He(a)*u,d=Ie(a)*u,f=Ie(l),h=f*r-d*s;return[jo(d*r+f*s,c*n+h*i),gs(h*n-c*i)]},o}function sv(e){return function(t){var n=new JF;for(var i in e)n[i]=e[i];return n.stream=t,n}}function JF(){}function XF(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=i&&e.clipExtent(null),Gu(n,e.stream(iE)),t(iE.result()),null!=i&&e.clipExtent(i),e}function pE(e,t,n){return XF(e,function(i){var r=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(r/(i[1][0]-i[0][0]),s/(i[1][1]-i[0][1])),a=+t[0][0]+(r-o*(i[1][0]+i[0][0]))/2,l=+t[0][1]+(s-o*(i[1][1]+i[0][1]))/2;e.scale(150*o).translate([a,l])},n)}function QF(e,t,n){return pE(e,[[0,0],t],n)}function ZF(e,t,n){return XF(e,function(i){var r=+t,s=r/(i[1][0]-i[0][0]),o=(r-s*(i[1][0]+i[0][0]))/2,a=-s*i[0][1];e.scale(150*s).translate([o,a])},n)}function eP(e,t,n){return XF(e,function(i){var r=+t,s=r/(i[1][1]-i[0][1]),o=-s*i[0][0],a=(r-s*(i[1][1]+i[0][1]))/2;e.scale(150*s).translate([o,a])},n)}KF.invert=KF,JF.prototype={constructor:JF,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var YPe=He(30*ht);function GZ(e,t){return+t?function JPe(e,t){function n(i,r,s,o,a,l,u,c,d,f,h,p,g,m){var _=u-i,y=c-r,v=_*_+y*y;if(v>4*t&&g--){var b=o+f,D=a+h,C=l+p,w=Ur(b*b+D*D+C*C),E=gs(C/=w),T=St(St(C)-1)<Be||St(s-d)<Be?(s+d)/2:jo(D,b),O=e(T,E),N=O[0],P=O[1],j=N-i,A=P-r,x=y*j-_*A;(x*x/v>t||St((_*j+y*A)/v-.5)>.3||o*f+a*h+l*p<YPe)&&(n(i,r,s,o,a,l,N,P,T,b/=w,D/=w,C,g,m),m.point(N,P),n(N,P,T,b,D,C,u,c,d,f,h,p,g,m))}}return function(i){var r,s,o,a,l,u,c,d,f,h,p,g,m={point:_,lineStart:y,lineEnd:b,polygonStart:function(){i.polygonStart(),m.lineStart=D},polygonEnd:function(){i.polygonEnd(),m.lineStart=y}};function _(E,T){E=e(E,T),i.point(E[0],E[1])}function y(){d=NaN,m.point=v,i.lineStart()}function v(E,T){var O=mh([E,T]),N=e(E,T);n(d,f,c,h,p,g,d=N[0],f=N[1],c=E,h=O[0],p=O[1],g=O[2],16,i),i.point(d,f)}function b(){m.point=_,i.lineEnd()}function D(){y(),m.point=C,m.lineEnd=w}function C(E,T){v(r=E,T),s=d,o=f,a=h,l=p,u=g,m.point=v}function w(){n(d,f,c,h,p,g,s,o,r,a,l,u,16,i),m.lineEnd=b,b()}return m}}(e,t):function KPe(e){return sv({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)}var XPe=sv({point:function(e,t){this.stream.point(e*ht,t*ht)}});function WZ(e,t,n,i,r,s){if(!s)return function ZPe(e,t,n,i,r){function s(o,a){return[t+e*(o*=i),n-e*(a*=r)]}return s.invert=function(o,a){return[(o-t)/e*i,(n-a)/e*r]},s}(e,t,n,i,r);var o=He(s),a=Ie(s),l=o*e,u=a*e,c=o/e,d=a/e,f=(a*n-o*t)/e,h=(a*t+o*n)/e;function p(g,m){return[l*(g*=i)-u*(m*=r)+t,n-u*g-l*m]}return p.invert=function(g,m){return[i*(c*g-d*m+f),r*(h-d*g-c*m)]},p}function Rl(e){return YZ(function(){return e})()}function YZ(e){var t,c,_,y,v,C,w,E,T,O,n=150,i=480,r=250,s=0,o=0,a=0,l=0,u=0,d=0,f=1,h=1,p=null,g=LZ,m=null,b=Qy,D=.5;function N(x){return E(x[0]*ht,x[1]*ht)}function P(x){return(x=E.invert(x[0],x[1]))&&[x[0]*ii,x[1]*ii]}function j(){var x=WZ(n,0,0,f,h,d).apply(null,t(s,o)),S=WZ(n,i-x[0],r-x[1],f,h,d);return c=VZ(a,l,u),w=YF(t,S),E=YF(c,w),C=GZ(w,D),A()}function A(){return T=O=null,N}return N.stream=function(x){return T&&O===x?T:T=XPe(function QPe(e){return sv({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}(c)(g(C(b(O=x)))))},N.preclip=function(x){return arguments.length?(g=x,p=void 0,A()):g},N.postclip=function(x){return arguments.length?(b=x,m=_=y=v=null,A()):b},N.clipAngle=function(x){return arguments.length?(g=+x?qPe(p=x*ht):(p=null,LZ),A()):p*ii},N.clipExtent=function(x){return arguments.length?(b=null==x?(m=_=y=v=null,Qy):$Z(m=+x[0][0],_=+x[0][1],y=+x[1][0],v=+x[1][1]),A()):null==m?null:[[m,_],[y,v]]},N.scale=function(x){return arguments.length?(n=+x,j()):n},N.translate=function(x){return arguments.length?(i=+x[0],r=+x[1],j()):[i,r]},N.center=function(x){return arguments.length?(s=x[0]%360*ht,o=x[1]%360*ht,j()):[s*ii,o*ii]},N.rotate=function(x){return arguments.length?(a=x[0]%360*ht,l=x[1]%360*ht,u=x.length>2?x[2]%360*ht:0,j()):[a*ii,l*ii,u*ii]},N.angle=function(x){return arguments.length?(d=x%360*ht,j()):d*ii},N.reflectX=function(x){return arguments.length?(f=x?-1:1,j()):f<0},N.reflectY=function(x){return arguments.length?(h=x?-1:1,j()):h<0},N.precision=function(x){return arguments.length?(C=GZ(w,D=x*x),A()):Ur(D)},N.fitExtent=function(x,S){return pE(N,x,S)},N.fitSize=function(x,S){return QF(N,x,S)},N.fitWidth=function(x,S){return ZF(N,x,S)},N.fitHeight=function(x,S){return eP(N,x,S)},function(){return t=e.apply(this,arguments),N.invert=t.invert&&P,j()}}function tP(e){var t=0,n=ft/3,i=YZ(e),r=i(t,n);return r.parallels=function(s){return arguments.length?i(t=s[0]*ht,n=s[1]*ht):[t*ii,n*ii]},r}function t3e(e,t){var n=Ie(e),i=(n+Ie(t))/2;if(St(i)<Be)return function e3e(e){var t=He(e);function n(i,r){return[i*t,Ie(r)/t]}return n.invert=function(i,r){return[i/t,gs(r*t)]},n}(e);var r=1+n*(2*i-n),s=Ur(r)/i;function o(a,l){var u=Ur(r-2*i*Ie(l))/i;return[u*Ie(a*=i),s-u*He(a)]}return o.invert=function(a,l){var u=s-l,c=jo(a,St(u))*Bo(u);return u*i<0&&(c-=ft*Bo(a)*Bo(u)),[c/i,gs((r-(a*a+u*u)*i*i)/(2*i))]},o}function gE(){return tP(t3e).scale(155.424).center([0,33.6442])}function KZ(){return gE().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function JZ(e){return function(t,n){var i=He(t),r=He(n),s=e(i*r);return s===1/0?[2,0]:[s*r*Ie(t),s*Ie(n)]}}function ov(e){return function(t,n){var i=Ur(t*t+n*n),r=e(i),s=Ie(r),o=He(r);return[jo(t*s,i*o),gs(i&&n*s/i)]}}var XZ=JZ(function(e){return Ur(2/(1+e))});XZ.invert=ov(function(e){return 2*gs(e/2)});var QZ=JZ(function(e){return(e=hZ(e))&&e/Ie(e)});function mE(e,t){return[e,eE(FF((Gn+t)/2))]}function ZZ(e){var a,l,u,t=Rl(e),n=t.center,i=t.scale,r=t.translate,s=t.clipExtent,o=null;function c(){var d=ft*i(),f=t(function WPe(e){function t(n){return(n=e(n[0]*ht,n[1]*ht))[0]*=ii,n[1]*=ii,n}return e=VZ(e[0]*ht,e[1]*ht,e.length>2?e[2]*ht:0),t.invert=function(n){return(n=e.invert(n[0]*ht,n[1]*ht))[0]*=ii,n[1]*=ii,n},t}(t.rotate()).invert([0,0]));return s(null==o?[[f[0]-d,f[1]-d],[f[0]+d,f[1]+d]]:e===mE?[[Math.max(f[0]-d,o),a],[Math.min(f[0]+d,l),u]]:[[o,Math.max(f[1]-d,a)],[l,Math.min(f[1]+d,u)]])}return t.scale=function(d){return arguments.length?(i(d),c()):i()},t.translate=function(d){return arguments.length?(r(d),c()):r()},t.center=function(d){return arguments.length?(n(d),c()):n()},t.clipExtent=function(d){return arguments.length?(null==d?o=a=l=u=null:(o=+d[0][0],a=+d[0][1],l=+d[1][0],u=+d[1][1]),c()):null==o?null:[[o,a],[l,u]]},c()}function _E(e){return FF((Gn+e)/2)}function a3e(e,t){var n=He(e),i=e===t?Ie(e):eE(n/He(t))/eE(_E(t)/_E(e)),r=n*RF(_E(e),i)/i;if(!i)return mE;function s(o,a){r>0?a<-Gn+Be&&(a=-Gn+Be):a>Gn-Be&&(a=Gn-Be);var l=r/RF(_E(a),i);return[l*Ie(i*o),r-l*He(i*o)]}return s.invert=function(o,a){var l=r-a,u=Bo(i)*Ur(o*o+l*l),c=jo(o,St(l))*Bo(l);return l*i<0&&(c-=ft*Bo(o)*Bo(l)),[c/i,2*dm(RF(r/u,1/i))-Gn]},s}function yE(e,t){return[e,t]}function c3e(e,t){var n=He(e),i=e===t?Ie(e):(n-He(t))/(t-e),r=n/i+e;if(St(i)<Be)return yE;function s(o,a){var l=r-a,u=i*o;return[l*Ie(u),r-l*He(u)]}return s.invert=function(o,a){var l=r-a,u=jo(o,St(l))*Bo(l);return l*i<0&&(u-=ft*Bo(o)*Bo(l)),[u/i,r-Bo(i)*Ur(o*o+l*l)]},s}QZ.invert=ov(function(e){return e}),mE.invert=function(e,t){return[e,2*dm(fZ(t))-Gn]},yE.invert=yE;var av=1.340264,lv=-.081106,uv=893e-6,cv=.003796,vE=Ur(3)/2;function eee(e,t){var n=gs(vE*Ie(t)),i=n*n,r=i*i*i;return[e*He(n)/(vE*(av+3*lv*i+r*(7*uv+9*cv*i))),n*(av+lv*i+r*(uv+cv*i))]}function tee(e,t){var n=He(t),i=He(e)*n;return[n*Ie(e)/i,Ie(t)/i]}function nee(e,t){var n=t*t,i=n*n;return[e*(.8707-.131979*n+i*(i*(.003971*n-.001529*i)-.013791)),t*(1.007226+n*(.015085+i*(.028874*n-.044475-.005916*i)))]}function iee(e,t){return[He(t)*Ie(e),Ie(t)]}function ree(e,t){var n=He(t),i=1+He(e)*n;return[n*Ie(e)/i,Ie(t)/i]}function see(e,t){return[eE(FF((Gn+t)/2)),-e]}eee.invert=function(e,t){for(var o,n=t,i=n*n,r=i*i*i,s=0;s<12&&(r=(i=(n-=o=(n*(av+lv*i+r*(uv+cv*i))-t)/(av+3*lv*i+r*(7*uv+9*cv*i)))*n)*i*i,!(St(o)<XC));++s);return[vE*e*(av+3*lv*i+r*(7*uv+9*cv*i))/He(n),gs(Ie(n)/vE)]},tee.invert=ov(dm),nee.invert=function(e,t){var r,n=t,i=25;do{var s=n*n,o=s*s;n-=r=(n*(1.007226+s*(.015085+o*(.028874*s-.044475-.005916*o)))-t)/(1.007226+s*(.045255+o*(.259866*s-.311325-.005916*11*o)))}while(St(r)>Be&&--i>0);return[e/(.8707+(s=n*n)*(s*(s*s*s*(.003971-.001529*s)-.013791)-.131979)),n]},iee.invert=ov(gs),ree.invert=ov(function(e){return 2*dm(e)}),see.invert=function(e,t){return[-t,2*dm(fZ(e))-Gn]};var b3e=Math.abs,nP=(Math,Math,Math,Math.cos),bE=(Math,Math,Math,Math,Math,Math,Math,Math,Math.sin),Ed=(Math,Math.PI),iP=Ed/2,aee=(Math,wE(2));function lee(e){return e>1?iP:e<-1?-iP:Math.asin(e)}function wE(e){return e>0?Math.sqrt(e):0}function D3e(e,t){var r,n=e*bE(t),i=30;do{t-=r=(t+bE(t)-n)/(1+nP(t))}while(b3e(r)>1e-6&&--i>0);return t/2}wE(Ed);var E3e=function C3e(e,t,n){function i(r,s){return[e*r*nP(s=D3e(n,s)),t*bE(s)]}return i.invert=function(r,s){return s=lee(s/t),[r/(e*nP(s)),lee((2*s+bE(2*s))/n)]},i}(aee/iP,aee,Ed);const x3e=NZ(),rP=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function A3e(e,t){return function n(){const i=t();return i.type=e,i.path=NZ().projection(i),i.copy=i.copy||function(){const r=n();return rP.forEach(s=>{i[s]&&r[s](i[s]())}),r.path.pointRadius(i.path.pointRadius()),r},i}}function sP(e,t){if(!e||"string"!=typeof e)throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(DE[e]=A3e(e,t),this):DE[e]||null}function uee(e){return e&&e.path||x3e}const DE={albers:KZ,albersusa:function i3e(){var e,t,i,s,a,l,n=KZ(),r=gE().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o=gE().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(f,h){l=[f,h]}};function c(f){var h=f[0],p=f[1];return l=null,i.point(h,p),l||(s.point(h,p),l)||(a.point(h,p),l)}function d(){return e=t=null,c}return c.invert=function(f){var h=n.scale(),p=n.translate(),g=(f[0]-p[0])/h,m=(f[1]-p[1])/h;return(m>=.12&&m<.234&&g>=-.425&&g<-.214?r:m>=.166&&m<.234&&g>=-.214&&g<-.115?o:n).invert(f)},c.stream=function(f){return e&&t===f?e:e=function n3e(e){var t=e.length;return{point:function(n,i){for(var r=-1;++r<t;)e[r].point(n,i)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}([n.stream(t=f),r.stream(f),o.stream(f)])},c.precision=function(f){return arguments.length?(n.precision(f),r.precision(f),o.precision(f),d()):n.precision()},c.scale=function(f){return arguments.length?(n.scale(f),r.scale(.35*f),o.scale(f),c.translate(n.translate())):n.scale()},c.translate=function(f){if(!arguments.length)return n.translate();var h=n.scale(),p=+f[0],g=+f[1];return i=n.translate(f).clipExtent([[p-.455*h,g-.238*h],[p+.455*h,g+.238*h]]).stream(u),s=r.translate([p-.307*h,g+.201*h]).clipExtent([[p-.425*h+Be,g+.12*h+Be],[p-.214*h-Be,g+.234*h-Be]]).stream(u),a=o.translate([p-.205*h,g+.212*h]).clipExtent([[p-.214*h+Be,g+.166*h+Be],[p-.115*h-Be,g+.234*h-Be]]).stream(u),d()},c.fitExtent=function(f,h){return pE(c,f,h)},c.fitSize=function(f,h){return QF(c,f,h)},c.fitWidth=function(f,h){return ZF(c,f,h)},c.fitHeight=function(f,h){return eP(c,f,h)},c.scale(1070)},azimuthalequalarea:function r3e(){return Rl(XZ).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function s3e(){return Rl(QZ).scale(79.4188).clipAngle(179.999)},conicconformal:function l3e(){return tP(a3e).scale(109.5).parallels([30,30])},conicequalarea:gE,conicequidistant:function d3e(){return tP(c3e).scale(131.154).center([0,13.9389])},equalEarth:function h3e(){return Rl(eee).scale(177.158)},equirectangular:function u3e(){return Rl(yE).scale(152.63)},gnomonic:function p3e(){return Rl(tee).scale(144.049).clipAngle(60)},identity:function g3e(){var o,a,u,c,d,m,_,e=1,t=0,n=0,i=1,r=1,s=0,l=null,f=1,h=1,p=sv({point:function(b,D){var C=v([b,D]);this.stream.point(C[0],C[1])}}),g=Qy;function y(){return f=e*i,h=e*r,m=_=null,v}function v(b){var D=b[0]*f,C=b[1]*h;if(s){var w=C*o-D*a;D=D*o+C*a,C=w}return[D+t,C+n]}return v.invert=function(b){var D=b[0]-t,C=b[1]-n;if(s){var w=C*o+D*a;D=D*o-C*a,C=w}return[D/f,C/h]},v.stream=function(b){return m&&_===b?m:m=p(g(_=b))},v.postclip=function(b){return arguments.length?(g=b,l=u=c=d=null,y()):g},v.clipExtent=function(b){return arguments.length?(g=null==b?(l=u=c=d=null,Qy):$Z(l=+b[0][0],u=+b[0][1],c=+b[1][0],d=+b[1][1]),y()):null==l?null:[[l,u],[c,d]]},v.scale=function(b){return arguments.length?(e=+b,y()):e},v.translate=function(b){return arguments.length?(t=+b[0],n=+b[1],y()):[t,n]},v.angle=function(b){return arguments.length?(a=Ie(s=b%360*ht),o=He(s),y()):s*ii},v.reflectX=function(b){return arguments.length?(i=b?-1:1,y()):i<0},v.reflectY=function(b){return arguments.length?(r=b?-1:1,y()):r<0},v.fitExtent=function(b,D){return pE(v,b,D)},v.fitSize=function(b,D){return QF(v,b,D)},v.fitWidth=function(b,D){return ZF(v,b,D)},v.fitHeight=function(b,D){return eP(v,b,D)},v},mercator:function o3e(){return ZZ(mE).scale(961/Hr)},mollweide:function S3e(){return Rl(E3e).scale(169.529)},naturalEarth1:function m3e(){return Rl(nee).scale(175.295)},orthographic:function _3e(){return Rl(iee).scale(249.5).clipAngle(90+Be)},stereographic:function y3e(){return Rl(ree).scale(250).clipAngle(142)},transversemercator:function v3e(){var e=ZZ(see),t=e.center,n=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):[(i=t())[1],-i[0]]},e.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):[(i=n())[0],i[1],i[2]-90]},n([0,0,90]).scale(159.155)}};for(const e in DE)sP(e,DE[e]);function cee(e,t,n){var i=Ys(e,t-Be,n).concat(t);return function(r){return i.map(function(s){return[r,s]})}}function dee(e,t,n){var i=Ys(e,t-Be,n).concat(t);return function(r){return i.map(function(s){return[s,r]})}}function M3e(){}const Wu=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function hee(){var e=1,t=1,n=a;function i(l,u){return u.map(c=>r(l,c))}function r(l,u){var c=[],d=[];return function s(l,u,c){var h,p,m,_,y,d=new Array,f=new Array;for(h=p=-1,Wu[(m=l[0]>=u)<<1].forEach(v);++h<e-1;)Wu[m|(m=l[h+1]>=u)<<1].forEach(v);for(Wu[m<<0].forEach(v);++p<t-1;){for(h=-1,Wu[(m=l[p*e+e]>=u)<<1|(_=l[p*e]>=u)<<2].forEach(v);++h<e-1;)y=_,Wu[m|(m=l[p*e+e+h+1]>=u)<<1|(_=l[p*e+h+1]>=u)<<2|y<<3].forEach(v);Wu[m|_<<3].forEach(v)}for(h=-1,Wu[(_=l[p*e]>=u)<<2].forEach(v);++h<e-1;)y=_,Wu[(_=l[p*e+h+1]>=u)<<2|y<<3].forEach(v);function v(b){var T,O,D=[b[0][0]+h,b[0][1]+p],C=[b[1][0]+h,b[1][1]+p],w=o(D),E=o(C);(T=f[w])?(O=d[E])?(delete f[T.end],delete d[O.start],T===O?(T.ring.push(C),c(T.ring)):d[T.start]=f[O.end]={start:T.start,end:O.end,ring:T.ring.concat(O.ring)}):(delete f[T.end],T.ring.push(C),f[T.end=E]=T):(T=d[E])?(O=f[w])?(delete d[T.start],delete f[O.end],T===O?(T.ring.push(C),c(T.ring)):d[O.start]=f[T.end]={start:O.start,end:T.end,ring:O.ring.concat(T.ring)}):(delete d[T.start],T.ring.unshift(D),d[T.start=w]=T):d[w]=f[E]={start:w,end:E,ring:[D,C]}}Wu[_<<3].forEach(v)}(l,u,f=>{n(f,l,u),function T3e(e){for(var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}(f)>0?c.push([f]):d.push(f)}),d.forEach(f=>{for(var g,h=0,p=c.length;h<p;++h)if(-1!==O3e((g=c[h])[0],f))return void g.push(f)}),{type:"MultiPolygon",value:u,coordinates:c}}function o(l){return 2*l[0]+l[1]*(e+1)*4}function a(l,u,c){l.forEach(d=>{var m,f=d[0],h=d[1],p=0|f,g=0|h,_=u[g*e+p];f>0&&f<e&&p===f&&(d[0]=f+(c-(m=u[g*e+p-1]))/(_-m)-.5),h>0&&h<t&&g===h&&(d[1]=h+(c-(m=u[(g-1)*e+p]))/(_-m)-.5)})}return i.contour=r,i.size=function(l){if(!arguments.length)return[e,t];var u=Math.floor(l[0]),c=Math.floor(l[1]);return u>=0&&c>=0||ee("invalid size"),e=u,t=c,i},i.smooth=function(l){return arguments.length?(n=l?a:M3e,i):n===a},i}function O3e(e,t){for(var r,n=-1,i=t.length;++n<i;)if(r=N3e(e,t[n]))return r;return 0}function N3e(e,t){for(var n=t[0],i=t[1],r=-1,s=0,o=e.length,a=o-1;s<o;a=s++){var l=e[s],u=l[0],c=l[1],d=e[a],f=d[0],h=d[1];if(k3e(l,d,t))return 0;c>i!=h>i&&n<(f-u)*(i-c)/(h-c)+u&&(r=-r)}return r}function k3e(e,t,n){var i;return function I3e(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}(e,t,n)&&function R3e(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}(e[i=+(e[0]===t[0])],n[i],t[i])}function pee(e,t,n){return function(i){var r=wl(i),s=n?Math.min(r[0],0):r[0],o=r[1],a=o-s,l=t?Gc(s,o,e):a/(e+1);return Ys(s+l,o,l)}}function oP(e){J.call(this,null,e)}function gee(e,t,n,i,r){const s=e.x1||0,o=e.y1||0,a=t*n<0;function l(d){d.forEach(u)}function u(d){a&&d.reverse(),d.forEach(c)}function c(d){d[0]=(d[0]-s)*t+i,d[1]=(d[1]-o)*n+r}return function(d){return d.coordinates.forEach(l),d}}function mee(e,t,n){const i=e>=0?e:jk(t,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function aP(e){return rt(e)?e:gr(+e)}function _ee(){var e=l=>l[0],t=l=>l[1],n=Mg,i=[-1,-1],r=960,s=500,o=2;function a(l,u){const c=mee(i[0],l,e)>>o,d=mee(i[1],l,t)>>o,f=c?c+2:0,h=d?d+2:0,p=2*f+(r>>o),g=2*h+(s>>o),m=new Float32Array(p*g),_=new Float32Array(p*g);let y=m;l.forEach(b=>{const D=f+(+e(b)>>o),C=h+(+t(b)>>o);D>=0&&D<p&&C>=0&&C<g&&(m[D+C*p]+=+n(b))}),c>0&&d>0?(gm(p,g,m,_,c),mm(p,g,_,m,d),gm(p,g,m,_,c),mm(p,g,_,m,d),gm(p,g,m,_,c),mm(p,g,_,m,d)):c>0?(gm(p,g,m,_,c),gm(p,g,_,m,c),gm(p,g,m,_,c),y=_):d>0&&(mm(p,g,m,_,d),mm(p,g,_,m,d),mm(p,g,m,_,d),y=_);const v=u?Math.pow(2,-2*o):1/qQ(y);for(let b=0,D=p*g;b<D;++b)y[b]*=v;return{values:y,scale:1<<o,width:p,height:g,x1:f,y1:h,x2:f+(r>>o),y2:h+(s>>o)}}return a.x=function(l){return arguments.length?(e=aP(l),a):e},a.y=function(l){return arguments.length?(t=aP(l),a):t},a.weight=function(l){return arguments.length?(n=aP(l),a):n},a.size=function(l){if(!arguments.length)return[r,s];var u=+l[0],c=+l[1];return u>=0&&c>=0||ee("invalid size"),r=u,s=c,a},a.cellSize=function(l){return arguments.length?((l=+l)>=1||ee("invalid cell size"),o=Math.floor(Math.log(l)/Math.LN2),a):1<<o},a.bandwidth=function(l){return arguments.length?(1===(l=we(l)).length&&(l=[+l[0],+l[0]]),2!==l.length&&ee("invalid bandwidth"),i=l,a):i},a}function gm(e,t,n,i,r){const s=1+(r<<1);for(let o=0;o<t;++o)for(let a=0,l=0;a<e+r;++a)a<e&&(l+=n[a+o*e]),a>=r&&(a>=s&&(l-=n[a-s+o*e]),i[a-r+o*e]=l/Math.min(a+1,e-1+s-a,s))}function mm(e,t,n,i,r){const s=1+(r<<1);for(let o=0;o<e;++o)for(let a=0,l=0;a<t+r;++a)a<t&&(l+=n[o+a*e]),a>=r&&(a>=s&&(l-=n[o+(a-s)*e]),i[o+(a-r)*e]=l/Math.min(a+1,t-1+s-a,s))}function lP(e){J.call(this,null,e)}oP.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},fe(oP,J,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=e.field||hr,s=hee().smooth(!1!==e.smooth),o=e.thresholds||function F3e(e,t,n){const i=pee(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?i:i(e.map(r=>Zf(t(r).values)))}(i,r,e),a=null===e.as?null:e.as||"contour",l=[];return i.forEach(u=>{const c=r(u),d=s.size([c.width,c.height])(c.values,ne(o)?o:o(c.values));(function P3e(e,t,n,i){let r=i.scale||t.scale,s=i.translate||t.translate;if(rt(r)&&(r=r(n,i)),rt(s)&&(s=s(n,i)),(1===r||null==r)&&!s)return;const o=(en(r)?r:r[0])||1,a=(en(r)?r:r[1])||1;e.forEach(gee(t,o,a,s&&s[0]||0,s&&s[1]||0))})(d,c,u,e),d.forEach(f=>{l.push(xD(u,Vt(null!=a?{[a]:f}:f)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}}),lP.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const L3e=["x","y","weight","size","cellSize","bandwidth"];function yee(e,t){return L3e.forEach(n=>null!=t[n]?e[n](t[n]):0),e}function uP(e){J.call(this,null,e)}fe(lP,J,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var l,n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=function j3e(e,t){var r,s,o,a,l,u,n=[],i=c=>c(a);if(null==t)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],(u=r[l=t.map(i)])||(r[l]=u=[],u.dims=l,n.push(u)),u.push(a);return n}(t.materialize(t.SOURCE).source,e.groupby),s=(e.groupby||[]).map(qn),o=yee(_ee(),e),a=e.as||"grid";return l=r.map(c=>Vt(function u(c,d){for(let f=0;f<s.length;++f)c[s[f]]=d[f];return c}({[a]:o(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}}),uP.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},fe(uP,J,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var a,l,n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=hee().smooth(!1!==e.smooth),r=e.values,s=e.thresholds||pee(e.count||10,e.nice,!!r),o=e.size;return r||(r=t.materialize(t.SOURCE).source,l=gee(a=yee(_ee(),e)(r,!0),a.scale||1,a.scale||1,0,0),o=[a.width,a.height],r=a.values),s=ne(s)?s:s(r),r=i.size(o)(r,s),l&&r.forEach(l),this.value&&(n.rem=this.value),this.value=n.source=n.add=(r||[]).map(Vt),n}});const cP="Feature",dP="FeatureCollection";function fP(e){J.call(this,null,e)}function hP(e){J.call(this,null,e)}function pP(e){J.call(this,null,e)}function gP(e){J.call(this,null,e)}function mP(e){J.call(this,[],e),this.generator=function fee(){var e,t,n,i,r,s,o,a,f,h,p,g,l=10,u=l,c=90,d=360,m=2.5;function _(){return{type:"MultiLineString",coordinates:y()}}function y(){return Ys(ZC(i/c)*c,n,c).map(p).concat(Ys(ZC(a/d)*d,o,d).map(g)).concat(Ys(ZC(t/l)*l,e,l).filter(function(v){return St(v%c)>Be}).map(f)).concat(Ys(ZC(s/u)*u,r,u).filter(function(v){return St(v%d)>Be}).map(h))}return _.lines=function(){return y().map(function(v){return{type:"LineString",coordinates:v}})},_.outline=function(){return{type:"Polygon",coordinates:[p(i).concat(g(o).slice(1),p(n).reverse().slice(1),g(a).reverse().slice(1))]}},_.extent=function(v){return arguments.length?_.extentMajor(v).extentMinor(v):_.extentMinor()},_.extentMajor=function(v){return arguments.length?(a=+v[0][1],o=+v[1][1],(i=+v[0][0])>(n=+v[1][0])&&(v=i,i=n,n=v),a>o&&(v=a,a=o,o=v),_.precision(m)):[[i,a],[n,o]]},_.extentMinor=function(v){return arguments.length?(s=+v[0][1],r=+v[1][1],(t=+v[0][0])>(e=+v[1][0])&&(v=t,t=e,e=v),s>r&&(v=s,s=r,r=v),_.precision(m)):[[t,s],[e,r]]},_.step=function(v){return arguments.length?_.stepMajor(v).stepMinor(v):_.stepMinor()},_.stepMajor=function(v){return arguments.length?(c=+v[0],d=+v[1],_):[c,d]},_.stepMinor=function(v){return arguments.length?(l=+v[0],u=+v[1],_):[l,u]},_.precision=function(v){return arguments.length?(m=+v,f=cee(s,r,90),h=dee(t,e,m),p=cee(a,o,90),g=dee(i,n,m),_):m},_.extentMajor([[-180,-90+Be],[180,90-Be]]).extentMinor([[-180,-80-Be],[180,80+Be]])}()}function _P(e){J.call(this,null,e)}function vee(e){if(!rt(e))return!1;const t=va(fr(e));return t.$x||t.$y||t.$value||t.$max}function bee(e){J.call(this,null,e),this.modified(!0)}function wee(e,t,n){rt(e[t])&&e[t](n)}function Dee(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,d,f,h,p,g,m,_,y,s=e._root,o={data:i},a=e._x0,l=e._y0,u=e._x1,c=e._y1;if(!s)return e._root=o,e;for(;s.length;)if((g=t>=(d=(a+u)/2))?a=d:u=d,(m=n>=(f=(l+c)/2))?l=f:c=f,r=s,!(s=s[_=m<<1|g]))return r[_]=o,e;if(h=+e._x.call(null,s.data),p=+e._y.call(null,s.data),t===h&&n===p)return o.next=s,r?r[_]=o:e._root=o,e;do{r=r?r[_]=new Array(4):e._root=new Array(4),(g=t>=(d=(a+u)/2))?a=d:u=d,(m=n>=(f=(l+c)/2))?l=f:c=f}while((_=m<<1|g)==(y=(p>=f)<<1|h>=d));return r[y]=s,r[_]=o,e}function zr(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function lLe(e){return e[0]}function cLe(e){return e[1]}function yP(e,t,n){var i=new vP(null==t?lLe:t,null==n?cLe:n,NaN,NaN,NaN,NaN);return null==e?i:i.addAll(e)}function vP(e,t,n,i,r,s){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=s,this._root=void 0}function Cee(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}fP.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},fe(fP,J,{transform(e,t){var u,n=this._features,i=this._points,r=e.fields,s=r&&r[0],o=r&&r[1],a=e.geojson||!r&&hr,l=t.ADD;u=e.modified()||t.changed(t.REM)||t.modified(fr(a))||s&&t.modified(fr(s))||o&&t.modified(fr(o)),(!this.value||u)&&(l=t.SOURCE,this._features=n=[],this._points=i=[]),a&&t.visit(l,c=>n.push(a(c))),s&&o&&(t.visit(l,c=>{var d=s(c),f=o(c);null!=d&&null!=f&&(d=+d)===d&&(f=+f)===f&&i.push([d,f])}),n=n.concat({type:cP,geometry:{type:"MultiPoint",coordinates:i}})),this.value={type:dP,features:n}}}),hP.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},fe(hP,J,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.field||hr,s=e.as||"path",o=n.SOURCE;!i||e.modified()?(this.value=i=uee(e.projection),n.materialize().reflow()):o=r===hr||t.modified(r.fields)?n.ADD_MOD:n.ADD;const a=function $3e(e,t){const n=e.pointRadius();return e.context(null),null!=t&&e.pointRadius(t),n}(i,e.pointRadius);return n.visit(o,l=>l[s]=i(r(l))),i.pointRadius(a),n.modifies(s)}}),pP.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},fe(pP,J,{transform(e,t){var l,n=e.projection,i=e.fields[0],r=e.fields[1],s=e.as||["x","y"],o=s[0],a=s[1];function u(c){const d=n([i(c),r(c)]);d?(c[o]=d[0],c[a]=d[1]):(c[o]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,u):(l=t.modified(i.fields)||t.modified(r.fields),t.visit(l?t.ADD_MOD:t.ADD,u)),t.modifies(s)}}),gP.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},fe(gP,J,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.as||"shape",s=n.ADD;return(!i||e.modified())&&(this.value=i=function V3e(e,t,n){const i=null==n?r=>e(t(r)):r=>{var s=e.pointRadius(),o=e.pointRadius(n)(t(r));return e.pointRadius(s),o};return i.context=r=>(e.context(r),i),i}(uee(e.projection),e.field||ls("datum"),e.pointRadius),n.materialize().reflow(),s=n.SOURCE),n.visit(s,o=>o[r]=i),n.modifies(r)}}),mP.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},fe(mP,J,{transform(e,t){var r,n=this.value,i=this.generator;if(!n.length||e.modified())for(const s in e)rt(i[s])&&i[s](e[s]);return r=i(),n.length?t.mod.push($W(n[0],r)):t.add.push(Vt(r)),n[0]=r,t}}),_P.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},fe(_P,J,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,i="shared"===e.resolve,r=e.field||hr,s=function U3e(e,t){let n;return rt(e)?(n=i=>e(i,t),n.dep=vee(e)):e?n=gr(e):(n=i=>i.$value/i.$max||0,n.dep=!0),n}(e.opacity,e),o=function H3e(e,t){let n;return rt(e)?(n=i=>od(e(i,t)),n.dep=vee(e)):n=gr(od(e||"#888")),n}(e.color,e),a=e.as||"image",l={$x:0,$y:0,$value:0,$max:i?Zf(n.map(u=>Zf(r(u).values))):0};return n.forEach(u=>{const c=r(u),d=st({},u,l);i||(d.$max=Zf(c.values||[])),u[a]=function z3e(e,t,n,i){const r=e.width,o=e.x1||0,a=e.y1||0,l=e.x2||r,u=e.y2||e.height,c=e.values,d=c?m=>c[m]:Vc,f=rd(l-o,u-a),h=f.getContext("2d"),p=h.getImageData(0,0,l-o,u-a),g=p.data;for(let m=a,_=0;m<u;++m){t.$y=m-a;for(let y=o,v=m*r;y<l;++y,_+=4){t.$x=y-o,t.$value=d(y+v);const b=n(t);g[_+0]=b.r,g[_+1]=b.g,g[_+2]=b.b,g[_+3]=~~(255*i(t))}}return h.putImageData(p,0,0),f}(c,d,o.dep?o:gr(o(d)),s.dep?s:gr(s(d)))}),t.reflow(!0).modifies(a)}}),fe(bee,J,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=function G3e(e){const t=sP((e||"mercator").toLowerCase());return t||ee("Unrecognized projection type: "+e),t()}(e.type),rP.forEach(i=>{null!=e[i]&&wee(n,i,e[i])})):rP.forEach(i=>{e.modified(i)&&wee(n,i,e[i])}),null!=e.pointRadius&&n.path.pointRadius(e.pointRadius),e.fit&&function q3e(e,t){const n=function W3e(e){return 1===(e=we(e)).length?e[0]:{type:dP,features:e.reduce((t,n)=>t.concat(function Y3e(e){return e.type===dP?e.features:we(e).filter(t=>null!=t).map(t=>t.type===cP?t:{type:cP,geometry:t})}(n)),[])}}(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});var qr=yP.prototype=vP.prototype;function Gr(e){return function(){return e}}function Sd(e){return 1e-6*(e()-.5)}function fLe(e){return e.x+e.vx}function hLe(e){return e.y+e.vy}qr.copy=function(){var n,i,e=new vP(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root;if(!t)return e;if(!t.length)return e._root=Cee(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(i=t.source[r])&&(i.length?n.push({source:i,target:t.target[r]=new Array(4)}):t.target[r]=Cee(i));return e},qr.add=function J3e(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return Dee(this.cover(t,n),t,n,e)},qr.addAll=function X3e(e){var t,n,r,s,i=e.length,o=new Array(i),a=new Array(i),l=1/0,u=1/0,c=-1/0,d=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(o[n]=r,a[n]=s,r<l&&(l=r),r>c&&(c=r),s<u&&(u=s),s>d&&(d=s));if(l>c||u>d)return this;for(this.cover(l,u).cover(c,d),n=0;n<i;++n)Dee(this,o[n],a[n],e[n]);return this},qr.cover=function Q3e(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,s=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,s=(i=Math.floor(t))+1;else{for(var l,u,o=r-n||1,a=this._root;n>e||e>=r||i>t||t>=s;)switch(u=(t<i)<<1|e<n,l=new Array(4),l[u]=a,a=l,o*=2,u){case 0:r=n+o,s=i+o;break;case 1:n=r-o,s=i+o;break;case 2:r=n+o,i=s-o;break;case 3:n=r-o,i=s-o}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=i,this._x1=r,this._y1=s,this},qr.data=function Z3e(){var e=[];return this.visit(function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)}),e},qr.extent=function eLe(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},qr.find=function tLe(e,t,n){var i,o,a,l,u,p,g,r=this._x0,s=this._y0,c=this._x1,d=this._y1,f=[],h=this._root;for(h&&f.push(new zr(h,r,s,c,d)),null==n?n=1/0:(r=e-n,s=t-n,c=e+n,d=t+n,n*=n);p=f.pop();)if(!(!(h=p.node)||(o=p.x0)>c||(a=p.y0)>d||(l=p.x1)<r||(u=p.y1)<s))if(h.length){var m=(o+l)/2,_=(a+u)/2;f.push(new zr(h[3],m,_,l,u),new zr(h[2],o,_,m,u),new zr(h[1],m,a,l,_),new zr(h[0],o,a,m,_)),(g=(t>=_)<<1|e>=m)&&(p=f[f.length-1],f[f.length-1]=f[f.length-1-g],f[f.length-1-g]=p)}else{var y=e-+this._x.call(null,h.data),v=t-+this._y.call(null,h.data),b=y*y+v*v;if(b<n){var D=Math.sqrt(n=b);r=e-D,s=t-D,c=e+D,d=t+D,i=h.data}}return i},qr.remove=function nLe(e){if(isNaN(c=+this._x.call(null,e))||isNaN(d=+this._y.call(null,e)))return this;var t,i,r,s,c,d,f,h,p,g,m,_,n=this._root,o=this._x0,a=this._y0,l=this._x1,u=this._y1;if(!n)return this;if(n.length)for(;;){if((p=c>=(f=(o+l)/2))?o=f:l=f,(g=d>=(h=(a+u)/2))?a=h:u=h,t=n,!(n=n[m=g<<1|p]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(i=t,_=m)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,r?(s?r.next=s:delete r.next,this):t?(s?t[m]=s:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(i?i[_]=n:this._root=n),this):(this._root=s,this)},qr.removeAll=function iLe(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},qr.root=function rLe(){return this._root},qr.size=function sLe(){var e=0;return this.visit(function(t){if(!t.length)do{++e}while(t=t.next)}),e},qr.visit=function oLe(e){var n,r,s,o,a,l,t=[],i=this._root;for(i&&t.push(new zr(i,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(i=n.node,s=n.x0,o=n.y0,a=n.x1,l=n.y1)&&i.length){var u=(s+a)/2,c=(o+l)/2;(r=i[3])&&t.push(new zr(r,u,c,a,l)),(r=i[2])&&t.push(new zr(r,s,c,u,l)),(r=i[1])&&t.push(new zr(r,u,o,a,c)),(r=i[0])&&t.push(new zr(r,s,o,u,c))}return this},qr.visitAfter=function aLe(e){var i,t=[],n=[];for(this._root&&t.push(new zr(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var r=i.node;if(r.length){var s,o=i.x0,a=i.y0,l=i.x1,u=i.y1,c=(o+l)/2,d=(a+u)/2;(s=r[0])&&t.push(new zr(s,o,a,c,d)),(s=r[1])&&t.push(new zr(s,c,a,l,d)),(s=r[2])&&t.push(new zr(s,o,d,c,u)),(s=r[3])&&t.push(new zr(s,c,d,l,u))}n.push(i)}for(;i=n.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this},qr.x=function uLe(e){return arguments.length?(this._x=e,this):this._x},qr.y=function dLe(e){return arguments.length?(this._y=e,this):this._y};var gLe={value:()=>{}};function Eee(){for(var i,e=0,t=arguments.length,n={};e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new CE(n)}function CE(e){this._=e}function mLe(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}function _Le(e,t){for(var r,n=0,i=e.length;n<i;++n)if((r=e[n]).name===t)return r.value}function See(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=gLe,e=e.slice(0,i).concat(e.slice(i+1));break}return null!=n&&e.push({name:t,value:n}),e}CE.prototype=Eee.prototype={constructor:CE,on:function(e,t){var r,n=this._,i=mLe(e+"",n),s=-1,o=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++s<o;)if(r=(e=i[s]).type)n[r]=See(n[r],e.name,t);else if(null==t)for(r in n)n[r]=See(n[r],e.name,null);return this}for(;++s<o;)if((r=(e=i[s]).type)&&(r=_Le(n[r],e.name)))return r},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new CE(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var r,s,n=new Array(r),i=0;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,r=(s=this._[e]).length;i<r;++i)s[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)}};const yLe=Eee;var EE,pv,_m=0,fv=0,hv=0,SE=0,_h=0,xE=0,gv="object"==typeof performance&&performance.now?performance:Date,Aee="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function bP(){return _h||(Aee(vLe),_h=gv.now()+xE)}function vLe(){_h=0}function AE(){this._call=this._time=this._next=null}function Mee(e,t,n){var i=new AE;return i.restart(e,t,n),i}function Tee(){_h=(SE=gv.now())+xE,_m=fv=0;try{!function bLe(){bP(),++_m;for(var t,e=EE;e;)(t=_h-e._time)>=0&&e._call.call(void 0,t),e=e._next;--_m}()}finally{_m=0,function DLe(){for(var e,n,t=EE,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:EE=n);pv=e,wP(i)}(),_h=0}}function wLe(){var e=gv.now(),t=e-SE;t>1e3&&(xE-=t,SE=e)}function wP(e){_m||(fv&&(fv=clearTimeout(fv)),e-_h>24?(e<1/0&&(fv=setTimeout(Tee,e-gv.now()-xE)),hv&&(hv=clearInterval(hv))):(hv||(SE=gv.now(),hv=setInterval(wLe,1e3)),_m=1,Aee(Tee)))}function xLe(e){return e.x}function ALe(e){return e.y}AE.prototype=Mee.prototype={constructor:AE,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?bP():+n)+(null==t?0:+t),!this._next&&pv!==this&&(pv?pv._next=this:EE=this,pv=this),this._call=e,this._time=n,wP()},stop:function(){this._call&&(this._call=null,this._time=1/0,wP())}};var TLe=Math.PI*(3-Math.sqrt(5));function kLe(e){return e.index}function Nee(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}const kee={center:function K3e(e,t){var n,i=1;function r(){var s,a,o=n.length,l=0,u=0;for(s=0;s<o;++s)l+=(a=n[s]).x,u+=a.y;for(l=(l/o-e)*i,u=(u/o-t)*i,s=0;s<o;++s)(a=n[s]).x-=l,a.y-=u}return null==e&&(e=0),null==t&&(t=0),r.initialize=function(s){n=s},r.x=function(s){return arguments.length?(e=+s,r):e},r.y=function(s){return arguments.length?(t=+s,r):t},r.strength=function(s){return arguments.length?(i=+s,r):i},r},collide:function pLe(e){var t,n,i,r=1,s=1;function o(){for(var u,d,f,h,p,g,m,c=t.length,_=0;_<s;++_)for(d=yP(t,fLe,hLe).visitAfter(a),u=0;u<c;++u)m=(g=n[(f=t[u]).index])*g,h=f.x+f.vx,p=f.y+f.vy,d.visit(y);function y(v,b,D,C,w){var E=v.data,T=v.r,O=g+T;if(!E)return b>h+O||C<h-O||D>p+O||w<p-O;if(E.index>f.index){var N=h-E.x-E.vx,P=p-E.y-E.vy,j=N*N+P*P;j<O*O&&(0===N&&(j+=(N=Sd(i))*N),0===P&&(j+=(P=Sd(i))*P),j=(O-(j=Math.sqrt(j)))/j*r,f.vx+=(N*=j)*(O=(T*=T)/(m+T)),f.vy+=(P*=j)*O,E.vx-=N*(O=1-O),E.vy-=P*O)}}}function a(u){if(u.data)return u.r=n[u.data.index];for(var c=u.r=0;c<4;++c)u[c]&&u[c].r>u.r&&(u.r=u[c].r)}function l(){if(t){var u,d,c=t.length;for(n=new Array(c),u=0;u<c;++u)n[(d=t[u]).index]=+e(d,u,t)}}return"function"!=typeof e&&(e=Gr(null==e?1:+e)),o.initialize=function(u,c){t=u,i=c,l()},o.iterations=function(u){return arguments.length?(s=+u,o):s},o.strength=function(u){return arguments.length?(r=+u,o):r},o.radius=function(u){return arguments.length?(e="function"==typeof u?u:Gr(+u),l(),o):e},o},nbody:function NLe(){var e,t,n,i,s,r=Gr(-30),o=1,a=1/0,l=.81;function u(h){var p,g=e.length,m=yP(e,xLe,ALe).visitAfter(d);for(i=h,p=0;p<g;++p)t=e[p],m.visit(f)}function c(){if(e){var h,g,p=e.length;for(s=new Array(p),h=0;h<p;++h)s[(g=e[h]).index]=+r(g,h,e)}}function d(h){var g,m,y,v,b,p=0,_=0;if(h.length){for(y=v=b=0;b<4;++b)(g=h[b])&&(m=Math.abs(g.value))&&(p+=g.value,_+=m,y+=m*g.x,v+=m*g.y);h.x=y/_,h.y=v/_}else{(g=h).x=g.data.x,g.y=g.data.y;do{p+=s[g.data.index]}while(g=g.next)}h.value=p}function f(h,p,g,m){if(!h.value)return!0;var _=h.x-t.x,y=h.y-t.y,v=m-p,b=_*_+y*y;if(v*v/l<b)return b<a&&(0===_&&(b+=(_=Sd(n))*_),0===y&&(b+=(y=Sd(n))*y),b<o&&(b=Math.sqrt(o*b)),t.vx+=_*h.value*i/b,t.vy+=y*h.value*i/b),!0;if(!(h.length||b>=a)){(h.data!==t||h.next)&&(0===_&&(b+=(_=Sd(n))*_),0===y&&(b+=(y=Sd(n))*y),b<o&&(b=Math.sqrt(o*b)));do{h.data!==t&&(t.vx+=_*(v=s[h.data.index]*i/b),t.vy+=y*v)}while(h=h.next)}}return u.initialize=function(h,p){e=h,n=p,c()},u.strength=function(h){return arguments.length?(r="function"==typeof h?h:Gr(+h),c(),u):r},u.distanceMin=function(h){return arguments.length?(o=h*h,u):Math.sqrt(o)},u.distanceMax=function(h){return arguments.length?(a=h*h,u):Math.sqrt(a)},u.theta=function(h){return arguments.length?(l=h*h,u):Math.sqrt(l)},u},link:function ILe(e){var i,s,o,a,l,u,t=kLe,n=function d(m){return 1/Math.min(a[m.source.index],a[m.target.index])},r=Gr(30),c=1;function f(m){for(var _=0,y=e.length;_<c;++_)for(var b,D,C,w,E,T,O,v=0;v<y;++v)w=(C=(b=e[v]).target).x+C.vx-(D=b.source).x-D.vx||Sd(u),E=C.y+C.vy-D.y-D.vy||Sd(u),E*=T=((T=Math.sqrt(w*w+E*E))-s[v])/T*m*i[v],C.vx-=(w*=T)*(O=l[v]),C.vy-=E*O,D.vx+=w*(O=1-O),D.vy+=E*O}function h(){if(o){var m,b,_=o.length,y=e.length,v=new Map(o.map((D,C)=>[t(D,C,o),D]));for(m=0,a=new Array(_);m<y;++m)(b=e[m]).index=m,"object"!=typeof b.source&&(b.source=Nee(v,b.source)),"object"!=typeof b.target&&(b.target=Nee(v,b.target)),a[b.source.index]=(a[b.source.index]||0)+1,a[b.target.index]=(a[b.target.index]||0)+1;for(m=0,l=new Array(y);m<y;++m)l[m]=a[(b=e[m]).source.index]/(a[b.source.index]+a[b.target.index]);i=new Array(y),p(),s=new Array(y),g()}}function p(){if(o)for(var m=0,_=e.length;m<_;++m)i[m]=+n(e[m],m,e)}function g(){if(o)for(var m=0,_=e.length;m<_;++m)s[m]=+r(e[m],m,e)}return null==e&&(e=[]),f.initialize=function(m,_){o=m,u=_,h()},f.links=function(m){return arguments.length?(e=m,h(),f):e},f.id=function(m){return arguments.length?(t=m,f):t},f.iterations=function(m){return arguments.length?(c=+m,f):c},f.strength=function(m){return arguments.length?(n="function"==typeof m?m:Gr(+m),p(),f):n},f.distance=function(m){return arguments.length?(r="function"==typeof m?m:Gr(+m),g(),f):r},f},x:function RLe(e){var n,i,r,t=Gr(.1);function s(a){for(var c,l=0,u=n.length;l<u;++l)(c=n[l]).vx+=(r[l]-c.x)*i[l]*a}function o(){if(n){var a,l=n.length;for(i=new Array(l),r=new Array(l),a=0;a<l;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return"function"!=typeof e&&(e=Gr(null==e?0:+e)),s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t="function"==typeof a?a:Gr(+a),o(),s):t},s.x=function(a){return arguments.length?(e="function"==typeof a?a:Gr(+a),o(),s):e},s},y:function FLe(e){var n,i,r,t=Gr(.1);function s(a){for(var c,l=0,u=n.length;l<u;++l)(c=n[l]).vy+=(r[l]-c.y)*i[l]*a}function o(){if(n){var a,l=n.length;for(i=new Array(l),r=new Array(l),a=0;a<l;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return"function"!=typeof e&&(e=Gr(null==e?0:+e)),s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t="function"==typeof a?a:Gr(+a),o(),s):t},s.y=function(a){return arguments.length?(e="function"==typeof a?a:Gr(+a),o(),s):e},s}},mv="forces",DP=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],PLe=["static","iterations"],Iee=["x","y","vx","vy"];function CP(e){J.call(this,null,e)}function Ree(e,t,n,i){var s,o,a,l,r=we(t.forces);for(s=0,o=DP.length;s<o;++s)(a=DP[s])!==mv&&t.modified(a)&&e[a](t[a]);for(s=0,o=r.length;s<o;++s)l=mv+s,(a=n||t.modified(mv,s)?$Le(r[s]):i&&BLe(r[s],i)?e.force(l):null)&&e.force(l,a);for(o=e.numForces||0;s<o;++s)e.force(mv+s,null);return e.numForces=r.length,e}function BLe(e,t){var n,i;for(n in e)if(rt(i=e[n])&&t.modified(fr(i)))return 1;return 0}function $Le(e){var t,n;for(n in ke(kee,e.force)||ee("Unrecognized force: "+e.force),t=kee[e.force](),e)rt(t[n])&&VLe(t[n],e[n],e);return t}function VLe(e,t,n){e(rt(t)?i=>t(i,n):t)}function HLe(e){var t=0,n=e.children,i=n&&n.length;if(i)for(;--i>=0;)t+=n[i].value;else t=1;e.value=t}function EP(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=sje)):void 0===t&&(t=rje);for(var i,s,o,a,l,n=new ym(e),r=[n];i=r.pop();)if((o=t(i.data))&&(l=(o=Array.from(o)).length))for(i.children=o,a=l-1;a>=0;--a)r.push(s=o[a]=new ym(o[a])),s.parent=i,s.depth=i.depth+1;return n.eachBefore(Fee)}function rje(e){return e.children}function sje(e){return Array.isArray(e)?e[1]:null}function oje(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function Fee(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function ym(e){this.data=e,this.depth=this.height=0,this.parent=null}function ME(e){return null==e?null:Pee(e)}function Pee(e){if("function"!=typeof e)throw new Error;return e}function yh(){return 0}function vm(e){return function(){return e}}function fje(e,t){var n,i;if(SP(t,e))return[t];for(n=0;n<e.length;++n)if(TE(t,e[n])&&SP(_v(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(i=n+1;i<e.length;++i)if(TE(_v(e[n],e[i]),t)&&TE(_v(e[n],t),e[i])&&TE(_v(e[i],t),e[n])&&SP($ee(e[n],e[i],t),e))return[e[n],e[i],t];throw new Error}function TE(e,t){var n=e.r-t.r,i=t.x-e.x,r=t.y-e.y;return n<0||n*n<i*i+r*r}function Bee(e,t){var n=e.r-t.r+1e-9*Math.max(e.r,t.r,1),i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function SP(e,t){for(var n=0;n<t.length;++n)if(!Bee(e,t[n]))return!1;return!0}function hje(e){switch(e.length){case 1:return function pje(e){return{x:e.x,y:e.y,r:e.r}}(e[0]);case 2:return _v(e[0],e[1]);case 3:return $ee(e[0],e[1],e[2])}}function _v(e,t){var n=e.x,i=e.y,r=e.r,s=t.x,o=t.y,a=t.r,l=s-n,u=o-i,c=a-r,d=Math.sqrt(l*l+u*u);return{x:(n+s+l/d*c)/2,y:(i+o+u/d*c)/2,r:(d+r+a)/2}}function $ee(e,t,n){var i=e.x,r=e.y,s=e.r,o=t.x,a=t.y,l=t.r,u=n.x,c=n.y,d=n.r,f=i-o,h=i-u,p=r-a,g=r-c,m=l-s,_=d-s,y=i*i+r*r-s*s,v=y-o*o-a*a+l*l,b=y-u*u-c*c+d*d,D=h*p-f*g,C=(p*b-g*v)/(2*D)-i,w=(g*m-p*_)/D,E=(h*v-f*b)/(2*D)-r,T=(f*_-h*m)/D,O=w*w+T*T-1,N=2*(s+C*w+E*T),P=C*C+E*E-s*s,j=-(Math.abs(O)>1e-6?(N+Math.sqrt(N*N-4*O*P))/(2*O):P/N);return{x:i+C+w*j,y:r+E+T*j,r:j}}function Vee(e,t,n){var r,s,a,l,i=e.x-t.x,o=e.y-t.y,u=i*i+o*o;u?(s=t.r+n.r,l=e.r+n.r,(s*=s)>(l*=l)?(r=(u+l-s)/(2*u),a=Math.sqrt(Math.max(0,l/u-r*r)),n.x=e.x-r*i-a*o,n.y=e.y-r*o+a*i):(r=(u+s-l)/(2*u),a=Math.sqrt(Math.max(0,s/u-r*r)),n.x=t.x+r*i-a*o,n.y=t.y+r*o+a*i)):(n.x=t.x+n.r,n.y=t.y)}function Hee(e,t){var n=e.r+t.r-1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function Uee(e){var t=e._,n=e.next._,i=t.r+n.r,r=(t.x*n.r+n.x*t.r)/i,s=(t.y*n.r+n.y*t.r)/i;return r*r+s*s}function OE(e){this._=e,this.next=null,this.previous=null}function zee(e,t){if(!(s=(e=function cje(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}(e)).length))return 0;var n,i,r,s,o,a,l,u,c,d,f;if((n=e[0]).x=0,n.y=0,!(s>1))return n.r;if(n.x=-(i=e[1]).r,i.x=n.r,i.y=0,!(s>2))return n.r+i.r;Vee(i,n,r=e[2]),n=new OE(n),i=new OE(i),r=new OE(r),n.next=r.previous=i,i.next=n.previous=r,r.next=i.previous=n;e:for(l=3;l<s;++l){Vee(n._,i._,r=e[l]),r=new OE(r),u=i.next,c=n.previous,d=i._.r,f=n._.r;do{if(d<=f){if(Hee(u._,r._)){n.next=i=u,i.previous=n,--l;continue e}d+=u._.r,u=u.next}else{if(Hee(c._,r._)){(n=c).next=i,i.previous=n,--l;continue e}f+=c._.r,c=c.previous}}while(u!==c.next);for(r.previous=n,r.next=i,n.next=i.previous=i=r,o=Uee(n);(r=r.next)!==i;)(a=Uee(r))<o&&(n=r,o=a);i=n.next}for(n=[i._],r=i;(r=r.next)!==i;)n.push(r._);for(r=function jee(e,t){for(var s,o,n=0,i=(e=function dje(e,t){let i,r,n=e.length;for(;n;)r=t()*n--|0,i=e[n],e[n]=e[r],e[r]=i;return e}(Array.from(e),t)).length,r=[];n<i;)s=e[n],o&&Bee(o,s)?++n:(o=hje(r=fje(r,s)),n=0);return o}(n,t),l=0;l<s;++l)(n=e[l]).x-=r.x,n.y-=r.y;return r.r}function gje(e){return Math.sqrt(e.value)}function qee(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function xP(e,t,n){return function(i){if(r=i.children){var r,s,l,o=r.length,a=e(i)*t||0;if(a)for(s=0;s<o;++s)r[s].r+=a;if(l=zee(r,n),a)for(s=0;s<o;++s)r[s].r-=a;i.r=l+a}}}function Gee(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function Wee(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function yv(e,t,n,i,r){for(var o,s=e.children,a=-1,l=s.length,u=e.value&&(i-t)/e.value;++a<l;)(o=s[a]).y0=n,o.y1=r,o.x0=t,o.x1=t+=o.value*u}CP.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:Iee}]},fe(CP,J,{transform(e,t){var n=this.value,i=t.changed(t.ADD_REM),r=e.modified(DP),s=e.iterations||300;if(n?(i&&(t.modifies("index"),n.nodes(t.source)),(r||t.changed(t.MOD))&&Ree(n,e,0,t)):(this.value=n=function jLe(e,t){const n=function OLe(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),s=0,o=.6,a=new Map,l=Mee(d),u=yLe("tick","end"),c=function SLe(){let e=1;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296}();function d(){f(),u.call("tick",t),n<i&&(l.stop(),u.call("end",t))}function f(g){var m,y,_=e.length;void 0===g&&(g=1);for(var v=0;v<g;++v)for(n+=(s-n)*r,a.forEach(function(b){b(n)}),m=0;m<_;++m)null==(y=e[m]).fx?y.x+=y.vx*=o:(y.x=y.fx,y.vx=0),null==y.fy?y.y+=y.vy*=o:(y.y=y.fy,y.vy=0);return t}function h(){for(var _,g=0,m=e.length;g<m;++g){if((_=e[g]).index=g,null!=_.fx&&(_.x=_.fx),null!=_.fy&&(_.y=_.fy),isNaN(_.x)||isNaN(_.y)){var y=10*Math.sqrt(.5+g),v=g*TLe;_.x=y*Math.cos(v),_.y=y*Math.sin(v)}(isNaN(_.vx)||isNaN(_.vy))&&(_.vx=_.vy=0)}}function p(g){return g.initialize&&g.initialize(e,c),g}return null==e&&(e=[]),h(),t={tick:f,restart:function(){return l.restart(d),t},stop:function(){return l.stop(),t},nodes:function(g){return arguments.length?(e=g,h(),a.forEach(p),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(i=+g,t):i},alphaDecay:function(g){return arguments.length?(r=+g,t):+r},alphaTarget:function(g){return arguments.length?(s=+g,t):s},velocityDecay:function(g){return arguments.length?(o=1-g,t):1-o},randomSource:function(g){return arguments.length?(c=g,a.forEach(p),t):c},force:function(g,m){return arguments.length>1?(null==m?a.delete(g):a.set(g,p(m)),t):a.get(g)},find:function(g,m,_){var b,D,C,w,E,y=0,v=e.length;for(null==_?_=1/0:_*=_,y=0;y<v;++y)(C=(b=g-(w=e[y]).x)*b+(D=m-w.y)*D)<_&&(E=w,_=C);return E},on:function(g,m){return arguments.length>1?(u.on(g,m),t):u.on(g)}}}(e),i=n.stop,r=n.restart;let s=!1;return n.stopped=()=>s,n.restart=()=>(s=!1,r()),n.stop=()=>(s=!0,i()),Ree(n,t,!0).on("end",()=>s=!0)}(t.source,e),n.on("tick",function LLe(e,t){return()=>e.touch(t).run()}(t.dataflow,this)),e.static||(i=!0,n.tick()),t.modifies("index")),r||i||e.modified(PLe)||t.changed()&&e.restart)if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/s)),e.static)for(n.stop();--s>=0;)n.tick();else if(n.stopped()&&n.restart(),!i)return t.StopPropagation;return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let c,a=this._argops,l=0,u=a.length;l<u;++l)if(c=a[l],c.name===mv&&"link"===c.op._argval.force)for(var o,i=c.op._argops,r=0,s=i.length;r<s;++r)if("links"===i[r].name&&(o=i[r].op.source)){n.pulse(o,n.changeset().reflow());break}return t.reflow(e.modified()).modifies(Iee)}}),ym.prototype=EP.prototype={constructor:ym,count:function ULe(){return this.eachAfter(HLe)},each:function zLe(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this},eachAfter:function GLe(e,t){for(var s,o,a,n=this,i=[n],r=[],l=-1;n=i.pop();)if(r.push(n),s=n.children)for(o=0,a=s.length;o<a;++o)i.push(s[o]);for(;n=r.pop();)e.call(t,n,++l,this);return this},eachBefore:function qLe(e,t){for(var r,s,n=this,i=[n],o=-1;n=i.pop();)if(e.call(t,n,++o,this),r=n.children)for(s=r.length-1;s>=0;--s)i.push(r[s]);return this},find:function WLe(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i},sum:function YLe(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n})},sort:function KLe(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})},path:function JLe(e){for(var t=this,n=function XLe(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}(t,e),i=[t];t!==n;)i.push(t=t.parent);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i},ancestors:function QLe(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function ZLe(){return Array.from(this)},leaves:function eje(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e},links:function tje(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t},copy:function ije(){return EP(this).eachBefore(oje)},[Symbol.iterator]:function*nje(){var t,i,r,s,e=this,n=[e];do{for(t=n.reverse(),n=[];e=t.pop();)if(yield e,i=e.children)for(r=0,s=i.length;r<s;++r)n.push(i[r])}while(n.length)}};var yje={depth:-1},Yee={},AP={};function vje(e){return e.id}function bje(e){return e.parentId}function Kee(){var n,e=vje,t=bje;function i(r){var l,u,c,d,f,h,p,g,s=Array.from(r),o=e,a=t,m=new Map;if(null!=n){const _=s.map((b,D)=>function wje(e){let t=(e=`${e}`).length;return MP(e,t-1)&&!MP(e,t-2)&&(e=e.slice(0,-1)),"/"===e[0]?e:`/${e}`}(n(b,D,r))),y=_.map(Jee),v=new Set(_).add("");for(const b of y)v.has(b)||(v.add(b),_.push(b),y.push(Jee(b)),s.push(AP));o=(b,D)=>_[D],a=(b,D)=>y[D]}for(c=0,l=s.length;c<l;++c)h=s[c]=new ym(u=s[c]),null!=(p=o(u,c,r))&&(p+="")&&(g=h.id=p,m.set(g,m.has(g)?Yee:h)),null!=(p=a(u,c,r))&&(p+="")&&(h.parent=p);for(c=0;c<l;++c)if(p=(h=s[c]).parent){if(!(f=m.get(p)))throw new Error("missing: "+p);if(f===Yee)throw new Error("ambiguous: "+p);f.children?f.children.push(h):f.children=[h],h.parent=f}else{if(d)throw new Error("multiple roots");d=h}if(!d)throw new Error("no root");if(null!=n){for(;d.data===AP&&1===d.children.length;)d=d.children[0],--l;for(let _=s.length-1;_>=0&&(h=s[_]).data===AP;--_)h.data=null}if(d.parent=yje,d.eachBefore(function(_){_.depth=_.parent.depth+1,--l}).eachBefore(Fee),d.parent=null,l>0)throw new Error("cycle");return d}return i.id=function(r){return arguments.length?(e=ME(r),i):e},i.parentId=function(r){return arguments.length?(t=ME(r),i):t},i.path=function(r){return arguments.length?(n=ME(r),i):n},i}function Jee(e){let t=e.length;if(t<2)return"";for(;--t>1&&!MP(e,t););return e.slice(0,t)}function MP(e,t){if("/"===e[t]){let n=0;for(;t>0&&"\\"===e[--t];)++n;if(0==(1&n))return!0}return!1}function Dje(e,t){return e.parent===t.parent?1:2}function TP(e){var t=e.children;return t?t[0]:e.t}function OP(e){var t=e.children;return t?t[t.length-1]:e.t}function Cje(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function Sje(e,t,n){return e.a.parent===t.parent?e.a:n}function NE(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function Mje(e,t){return e.parent===t.parent?1:2}function Oje(e,t){return e+t.x}function kje(e,t){return Math.max(e,t.y)}function kE(e,t,n,i,r){for(var o,s=e.children,a=-1,l=s.length,u=e.value&&(r-n)/e.value;++a<l;)(o=s[a]).x0=t,o.x1=i,o.y0=n,o.y1=n+=o.value*u}NE.prototype=Object.create(ym.prototype);var Xee=(1+Math.sqrt(5))/2;function Qee(e,t,n,i,r,s){for(var l,u,h,p,m,_,y,v,b,D,C,o=[],a=t.children,c=0,d=0,f=a.length,g=t.value;c<f;){h=r-n,p=s-i;do{m=a[d++].value}while(!m&&d<f);for(_=y=m,C=m*m*(D=Math.max(p/h,h/p)/(g*e)),b=Math.max(y/C,C/_);d<f;++d){if(m+=u=a[d].value,u<_&&(_=u),u>y&&(y=u),C=m*m*D,(v=Math.max(y/C,C/_))>b){m-=u;break}b=v}o.push(l={value:m,dice:h<p,children:a.slice(c,d)}),l.dice?yv(l,n,i,r,g?i+=p*m/g:s):kE(l,n,i,g?n+=h*m/g:r,s),g-=m,c=d}return o}const Zee=function e(t){function n(i,r,s,o,a){Qee(t,i,r,s,o,a)}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(Xee),jje=function e(t){function n(i,r,s,o,a){if((l=i._squarify)&&l.ratio===t)for(var l,u,c,d,h,f=-1,p=l.length,g=i.value;++f<p;){for(c=(u=l[f]).children,d=u.value=0,h=c.length;d<h;++d)u.value+=c[d].value;u.dice?yv(u,r,s,o,g?s+=(a-s)*u.value/g:a):kE(u,r,s,g?r+=(o-r)*u.value/g:o,a),g-=u.value}else i._squarify=l=Qee(t,i,r,s,o,a),l.ratio=t}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(Xee);function NP(e,t,n){const i={};return e.each(r=>{const s=r.data;n(s)&&(i[t(s)]=r)}),e.lookup=i,e}function kP(e){J.call(this,null,e)}kP.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const $je=e=>e.values;function Vje(){const e=[],t={entries:r=>i(n(r,0),0),key:r=>(e.push(r),t)};function n(r,s){if(s>=e.length)return r;const o=r.length,a=e[s++],l={},u={};let d,f,h,c=-1;for(;++c<o;)d=a(f=r[c])+"",(h=l[d])?h.push(f):l[d]=[f];for(d in l)u[d]=n(l[d],s);return u}function i(r,s){if(++s>e.length)return r;const o=[];for(const a in r)o.push({key:a,values:i(r[a],s)});return o}return t}function Yu(e){J.call(this,null,e)}fe(kP,J,{transform(e,t){t.source||ee("Nest transform requires an upstream data source.");var n=e.generate,i=e.modified(),r=t.clone(),s=this.value;return(!s||i||t.changed())&&(s&&s.each(o=>{o.children&&SD(o.data)&&r.rem.push(o.data)}),this.value=s=EP({values:we(e.keys).reduce((o,a)=>(o.key(a),o),Vje()).entries(r.source)},$je),n&&s.each(o=>{o.children&&(o=Vt(o.data),r.add.push(o),r.source.push(o))}),NP(s,Pe,Pe)),r.source.root=s,r}});const Hje=(e,t)=>e.parent===t.parent?1:2;fe(Yu,J,{transform(e,t){(!t.source||!t.source.root)&&ee(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),i=this.fields,r=t.source.root,s=e.as||i;e.field?r.sum(e.field):r.count(),e.sort&&r.sort(Xf(e.sort,o=>o.data)),function Uje(e,t,n){for(let i,r=0,s=t.length;r<s;++r)i=t[r],i in n&&e[i](n[i])}(n,this.params,e),n.separation&&n.separation(!1!==e.separation?Hje:Mg);try{this.value=n(r)}catch(o){ee(o)}return r.each(o=>function zje(e,t,n){const i=e.data,r=t.length-1;for(let s=0;s<r;++s)i[n[s]]=e[t[s]];i[n[r]]=e.children?e.children.length:0}(o,i,s)),t.reflow(e.modified()).modifies(s).modifies("leaf")}});const IP=["x","y","r","depth","children"];function RP(e){Yu.call(this,e)}RP.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:IP.length,default:IP}]},fe(RP,Yu,{layout:function mje(){var e=null,t=1,n=1,i=yh;function r(s){const o=function uje(){let e=1;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296}();return s.x=t/2,s.y=n/2,e?s.eachBefore(qee(e)).eachAfter(xP(i,.5,o)).eachBefore(Gee(1)):s.eachBefore(qee(gje)).eachAfter(xP(yh,1,o)).eachAfter(xP(i,s.r/Math.min(t,n),o)).eachBefore(Gee(Math.min(t,n)/(2*s.r))),s}return r.radius=function(s){return arguments.length?(e=ME(s),r):e},r.size=function(s){return arguments.length?(t=+s[0],n=+s[1],r):[t,n]},r.padding=function(s){return arguments.length?(i="function"==typeof s?s:vm(+s),r):i},r},params:["radius","size","padding"],fields:IP});const FP=["x0","y0","x1","y1","depth","children"];function PP(e){Yu.call(this,e)}function LP(e){J.call(this,null,e)}PP.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:FP.length,default:FP}]},fe(PP,Yu,{layout:function _je(){var e=1,t=1,n=0,i=!1;function r(o){var a=o.height+1;return o.x0=o.y0=n,o.x1=e,o.y1=t/a,o.eachBefore(function s(o,a){return function(l){l.children&&yv(l,l.x0,o*(l.depth+1)/a,l.x1,o*(l.depth+2)/a);var u=l.x0,c=l.y0,d=l.x1-n,f=l.y1-n;d<u&&(u=d=(u+d)/2),f<c&&(c=f=(c+f)/2),l.x0=u,l.y0=c,l.x1=d,l.y1=f}}(t,a)),i&&o.eachBefore(Wee),o}return r.round=function(o){return arguments.length?(i=!!o,r):i},r.size=function(o){return arguments.length?(e=+o[0],t=+o[1],r):[e,t]},r.padding=function(o){return arguments.length?(n=+o,r):n},r},params:["size","round","padding"],fields:FP}),LP.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},fe(LP,J,{transform(e,t){t.source||ee("Stratify transform requires an upstream data source.");let n=this.value;const i=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),s=!n||i||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),s&&(n=r.source.length?NP(Kee().id(e.key).parentId(e.parentKey)(r.source),e.key,Oo):NP(Kee()([{}]),e.key,e.key)),r.source.root=this.value=n,r}});const ete={tidy:function Aje(){var e=Dje,t=1,n=1,i=null;function r(u){var c=function xje(e){for(var n,r,s,o,a,t=new NE(e,0),i=[t];n=i.pop();)if(s=n._.children)for(n.children=new Array(a=s.length),o=a-1;o>=0;--o)i.push(r=n.children[o]=new NE(s[o],o)),r.parent=n;return(t.parent=new NE(null,0)).children=[t],t}(u);if(c.eachAfter(s),c.parent.m=-c.z,c.eachBefore(o),i)u.eachBefore(l);else{var d=u,f=u,h=u;u.eachBefore(function(y){y.x<d.x&&(d=y),y.x>f.x&&(f=y),y.depth>h.depth&&(h=y)});var p=d===f?1:e(d,f)/2,g=p-d.x,m=t/(f.x+p+g),_=n/(h.depth||1);u.eachBefore(function(y){y.x=(y.x+g)*m,y.y=y.depth*_})}return u}function s(u){var c=u.children,d=u.parent.children,f=u.i?d[u.i-1]:null;if(c){!function Eje(e){for(var s,t=0,n=0,i=e.children,r=i.length;--r>=0;)(s=i[r]).z+=t,s.m+=t,t+=s.s+(n+=s.c)}(u);var h=(c[0].z+c[c.length-1].z)/2;f?(u.z=f.z+e(u._,f._),u.m=u.z-h):u.z=h}else f&&(u.z=f.z+e(u._,f._));u.parent.A=function a(u,c,d){if(c){for(var b,f=u,h=u,p=c,g=f.parent.children[0],m=f.m,_=h.m,y=p.m,v=g.m;p=OP(p),f=TP(f),p&&f;)g=TP(g),(h=OP(h)).a=u,(b=p.z+y-f.z-m+e(p._,f._))>0&&(Cje(Sje(p,u,d),u,b),m+=b,_+=b),y+=p.m,m+=f.m,v+=g.m,_+=h.m;p&&!OP(h)&&(h.t=p,h.m+=y-_),f&&!TP(g)&&(g.t=f,g.m+=m-v,d=u)}return d}(u,f,u.parent.A||d[0])}function o(u){u._.x=u.z+u.parent.m,u.m+=u.parent.m}function l(u){u.x*=t,u.y=u.depth*n}return r.separation=function(u){return arguments.length?(e=u,r):e},r.size=function(u){return arguments.length?(i=!1,t=+u[0],n=+u[1],r):i?null:[t,n]},r.nodeSize=function(u){return arguments.length?(i=!0,t=+u[0],n=+u[1],r):i?[t,n]:null},r},cluster:function Fje(){var e=Mje,t=1,n=1,i=!1;function r(s){var o,a=0;s.eachAfter(function(f){var h=f.children;h?(f.x=function Tje(e){return e.reduce(Oje,0)/e.length}(h),f.y=function Nje(e){return 1+e.reduce(kje,0)}(h)):(f.x=o?a+=e(f,o):0,f.y=0,o=f)});var l=function Ije(e){for(var t;t=e.children;)e=t[0];return e}(s),u=function Rje(e){for(var t;t=e.children;)e=t[t.length-1];return e}(s),c=l.x-e(l,u)/2,d=u.x+e(u,l)/2;return s.eachAfter(i?function(f){f.x=(f.x-s.x)*t,f.y=(s.y-f.y)*n}:function(f){f.x=(f.x-c)/(d-c)*t,f.y=(1-(s.y?f.y/s.y:1))*n})}return r.separation=function(s){return arguments.length?(e=s,r):e},r.size=function(s){return arguments.length?(i=!1,t=+s[0],n=+s[1],r):i?null:[t,n]},r.nodeSize=function(s){return arguments.length?(i=!0,t=+s[0],n=+s[1],r):i?[t,n]:null},r}},jP=["x","y","depth","children"];function BP(e){Yu.call(this,e)}function $P(e){J.call(this,[],e)}BP.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:jP.length,default:jP}]},fe(BP,Yu,{layout(e){const t=e||"tidy";if(ke(ete,t))return ete[t]();ee("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:jP}),$P.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},fe($P,J,{transform(e,t){const n=this.value,i=t.source&&t.source.root,r=t.fork(t.NO_SOURCE),s={};return i||ee("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(r.rem=n,t.visit(t.SOURCE,o=>s[Pe(o)]=1),i.each(o=>{const a=o.data,l=o.parent&&o.parent.data;l&&s[Pe(a)]&&s[Pe(l)]&&r.add.push(Vt({source:l,target:a}))}),this.value=r.add):t.changed(t.MOD)&&(t.visit(t.MOD,o=>s[Pe(o)]=1),n.forEach(o=>{(s[Pe(o.source)]||s[Pe(o.target)])&&r.mod.push(o)})),r}});const tte={binary:function Pje(e,t,n,i,r){var o,l,s=e.children,a=s.length,u=new Array(a+1);for(u[0]=l=o=0;o<a;++o)u[o+1]=l+=s[o].value;!function c(d,f,h,p,g,m,_){if(d>=f-1){var y=s[d];return y.x0=p,y.y0=g,y.x1=m,void(y.y1=_)}for(var v=u[d],b=h/2+v,D=d+1,C=f-1;D<C;){var w=D+C>>>1;u[w]<b?D=w+1:C=w}b-u[D-1]<u[D]-b&&d+1<D&&--D;var E=u[D]-v,T=h-E;if(m-p>_-g){var O=h?(p*T+m*E)/h:m;c(d,D,E,p,g,O,_),c(D,f,T,O,g,m,_)}else{var N=h?(g*T+_*E)/h:_;c(d,D,E,p,g,m,N),c(D,f,T,p,N,m,_)}}(0,a,e.value,t,n,i,r)},dice:yv,slice:kE,slicedice:function Lje(e,t,n,i,r){(1&e.depth?kE:yv)(e,t,n,i,r)},squarify:Zee,resquarify:jje},VP=["x0","y0","x1","y1","depth","children"];function HP(e){Yu.call(this,e)}HP.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:VP.length,default:VP}]},fe(HP,Yu,{layout(){const e=function Bje(){var e=Zee,t=!1,n=1,i=1,r=[0],s=yh,o=yh,a=yh,l=yh,u=yh;function c(f){return f.x0=f.y0=0,f.x1=n,f.y1=i,f.eachBefore(d),r=[0],t&&f.eachBefore(Wee),f}function d(f){var h=r[f.depth],p=f.x0+h,g=f.y0+h,m=f.x1-h,_=f.y1-h;m<p&&(p=m=(p+m)/2),_<g&&(g=_=(g+_)/2),f.x0=p,f.y0=g,f.x1=m,f.y1=_,f.children&&(h=r[f.depth+1]=s(f)/2,p+=u(f)-h,g+=o(f)-h,(m-=a(f)-h)<p&&(p=m=(p+m)/2),(_-=l(f)-h)<g&&(g=_=(g+_)/2),e(f,p,g,m,_))}return c.round=function(f){return arguments.length?(t=!!f,c):t},c.size=function(f){return arguments.length?(n=+f[0],i=+f[1],c):[n,i]},c.tile=function(f){return arguments.length?(e=Pee(f),c):e},c.padding=function(f){return arguments.length?c.paddingInner(f).paddingOuter(f):c.paddingInner()},c.paddingInner=function(f){return arguments.length?(s="function"==typeof f?f:vm(+f),c):s},c.paddingOuter=function(f){return arguments.length?c.paddingTop(f).paddingRight(f).paddingBottom(f).paddingLeft(f):c.paddingTop()},c.paddingTop=function(f){return arguments.length?(o="function"==typeof f?f:vm(+f),c):o},c.paddingRight=function(f){return arguments.length?(a="function"==typeof f?f:vm(+f),c):a},c.paddingBottom=function(f){return arguments.length?(l="function"==typeof f?f:vm(+f),c):l},c.paddingLeft=function(f){return arguments.length?(u="function"==typeof f?f:vm(+f),c):u},c}();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{ke(tte,t)?e.tile(tte[t]):ee("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:VP});const UP=4278190080;function zP(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function IE(e,t,n){if(!t.length)return;const i=t[0].mark.marktype;"group"===i?t.forEach(r=>{r.items.forEach(s=>IE(e,s.items,n))}):Ks[i].draw(e,{items:n?t.map(Wje):t})}function Wje(e){const t=xD(e,{});return t.stroke&&0!==t.strokeOpacity||t.fill&&0!==t.fillOpacity?hce(fce({},t),{strokeOpacity:1,stroke:"#000",fillOpacity:0}):t}const xd=new Uint32Array(33),Na=new Uint32Array(33);Na[0]=0,xd[0]=~Na[0];for(let e=1;e<=32;++e)Na[e]=Na[e-1]<<1|1,xd[e]=~Na[e];function RE(e,t,n,i,r,s){let o=n/2;return e-o<0||e+o>r||t-(o=i/2)<0||t+o>s}function Ad(e,t,n,i,r,s,o,a){const l=r*s/(2*i),u=e(t-l),c=e(t+l),d=e(n-(s/=2)),f=e(n+s);return o.outOfBounds(u,d,c,f)||o.getRange(u,d,c,f)||a&&a.getRange(u,d,c,f)}const Qje=[-1,-1,1,1],Zje=[-1,1,-1,1],t5e=["right","center","left"],n5e=["bottom","middle","top"];function nte(e,t,n,i,r,s,o,a,l,u,c,d){return!(r.outOfBounds(e,n,t,i)||(d&&s||r).getRange(e,n,t,i))}const r5e={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},s5e={naive:function Jje(e,t,n,i){const r=e.width,s=e.height;return function(o){const a=o.datum.datum.items[i].items,l=a.length,u=o.datum.fontSize,c=xa.width(o.datum,o.datum.text);let f,h,p,g,m,_,y,d=0;for(let v=0;v<l;++v)f=a[v].x,p=a[v].y,h=void 0===a[v].x2?f:a[v].x2,g=void 0===a[v].y2?p:a[v].y2,m=(f+h)/2,_=(p+g)/2,y=Math.abs(h-f+g-p),y>=d&&(d=y,o.x=m,o.y=_);return m=c/2,_=u/2,f=o.x-m,h=o.x+m,p=o.y-_,g=o.y+_,o.align="center",f<0&&h<=r?o.align="left":0<=f&&r<h&&(o.align="right"),o.baseline="middle",p<0&&g<=s?o.baseline="top":0<=p&&s<g&&(o.baseline="bottom"),!0}},"reduced-search":function Xje(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1];function l(u,c,d,f,h){const p=e.invert(u),g=e.invert(c);let y,m=d,_=s;if(!RE(p,g,f,h,r,s)&&!Ad(e,p,g,h,f,m,o,a)&&!Ad(e,p,g,h,f,h,o,null)){for(;_-m>=1;)y=(m+_)/2,Ad(e,p,g,h,f,y,o,a)?_=y:m=y;if(m>d)return[p,g,m,!0]}}return function(u){const c=u.datum.datum.items[i].items,d=c.length,f=u.datum.fontSize,h=xa.width(u.datum,u.datum.text);let y,v,b,D,C,w,E,T,O,N,P,j,A,x,S,I,M,p=n?f:0,g=!1,m=!1,_=0;for(let L=0;L<d;++L){for(y=c[L].x,b=c[L].y,v=void 0===c[L].x2?y:c[L].x2,D=void 0===c[L].y2?b:c[L].y2,y>v&&(M=y,y=v,v=M),b>D&&(M=b,b=D,D=M),O=e(y),P=e(v),N=~~((O+P)/2),j=e(b),x=e(D),A=~~((j+x)/2),E=N;E>=O;--E)for(T=A;T>=j;--T)I=l(E,T,p,h,f),I&&([u.x,u.y,p,g]=I);for(E=N;E<=P;++E)for(T=A;T<=x;++T)I=l(E,T,p,h,f),I&&([u.x,u.y,p,g]=I);!g&&!n&&(S=Math.abs(v-y+D-b),C=(y+v)/2,w=(b+D)/2,S>=_&&!RE(C,w,h,f,r,s)&&!Ad(e,C,w,f,h,f,o,null)&&(_=S,u.x=C,u.y=w,m=!0))}return!(!g&&!m||(C=h/2,w=f/2,o.setRange(e(u.x-C),e(u.y-w),e(u.x+C),e(u.y+w)),u.align="center",u.baseline="middle",0))}},floodfill:function e5e(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1],l=e.bitmap();return function(u){const c=u.datum.datum.items[i].items,d=c.length,f=u.datum.fontSize,h=xa.width(u.datum,u.datum.text),p=[];let v,b,D,C,w,E,T,O,N,P,j,A,g=n?f:0,m=!1,_=!1,y=0;for(let x=0;x<d;++x){for(v=c[x].x,D=c[x].y,b=void 0===c[x].x2?v:c[x].x2,C=void 0===c[x].y2?D:c[x].y2,p.push([e((v+b)/2),e((D+C)/2)]);p.length;)if([T,O]=p.pop(),!(o.get(T,O)||a.get(T,O)||l.get(T,O))){l.set(T,O);for(let S=0;S<4;++S)w=T+Qje[S],E=O+Zje[S],l.outOfBounds(w,E,w,E)||p.push([w,E]);if(w=e.invert(T),E=e.invert(O),N=g,P=s,!RE(w,E,h,f,r,s)&&!Ad(e,w,E,f,h,N,o,a)&&!Ad(e,w,E,f,h,f,o,null)){for(;P-N>=1;)j=(N+P)/2,Ad(e,w,E,f,h,j,o,a)?P=j:N=j;N>g&&(u.x=w,u.y=E,g=N,m=!0)}}!m&&!n&&(A=Math.abs(b-v+C-D),w=(v+b)/2,E=(D+C)/2,A>=y&&!RE(w,E,h,f,r,s)&&!Ad(e,w,E,f,h,f,o,null)&&(y=A,u.x=w,u.y=E,_=!0))}return!(!m&&!_||(w=h/2,E=f/2,o.setRange(e(u.x-w),e(u.y-E),e(u.x+w),e(u.y+E)),u.align="center",u.baseline="middle",0))}}};function o5e(e,t,n,i,r,s,o,a,l,u,c){if(!e.length)return e;const d=Math.max(i.length,r.length),f=function a5e(e,t){const n=new Float64Array(t),i=e.length;for(let r=0;r<i;++r)n[r]=e[r]||0;for(let r=i;r<t;++r)n[r]=n[i-1];return n}(i,d),h=function l5e(e,t){const n=new Int8Array(t),i=e.length;for(let r=0;r<i;++r)n[r]|=r5e[e[r]];for(let r=i;r<t;++r)n[r]=n[i-1];return n}(r,d),p=function u5e(e){return e&&e.mark&&e.mark.marktype}(e[0].datum),g="group"===p&&e[0].datum.items[l].marktype,m="area"===g,_=function c5e(e,t,n,i){const r=s=>[s.x,s.x,s.x,s.y,s.y,s.y];return e?"line"===e||"area"===e?s=>r(s.datum):"line"===t?s=>{const o=s.datum.items[i].items;return r(o.length?o["start"===n?0:o.length-1]:{x:NaN,y:NaN})}:s=>{const o=s.datum.bounds;return[o.x1,(o.x1+o.x2)/2,o.x2,o.y1,(o.y1+o.y2)/2,o.y2]}:r}(p,g,a,l),y=null===u||u===1/0,v=m&&"naive"===c;let b=-1,D=-1;const C=e.map(O=>{const N=y?xa.width(O,O.text):void 0;return b=Math.max(b,N),D=Math.max(D,O.fontSize),{datum:O,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:_(O),textWidth:N}});u=null===u||u===1/0?Math.max(b,D)+Math.max(...i):u;const w=function Kje(e,t,n){const i=Math.max(1,Math.sqrt(e*t/1e6)),r=~~((e+2*n+i)/i),s=~~((t+2*n+i)/i),o=a=>~~((a+n)/i);return o.invert=a=>a*i-n,o.bitmap=()=>function Yje(e,t){const n=new Uint32Array(~~((e*t+32)/32));function i(s,o){n[s]|=o}function r(s,o){n[s]&=o}return{array:n,get:(s,o)=>{const a=o*e+s;return n[a>>>5]&1<<(31&a)},set:(s,o)=>{const a=o*e+s;i(a>>>5,1<<(31&a))},clear:(s,o)=>{const a=o*e+s;r(a>>>5,~(1<<(31&a)))},getRange:(s,o,a,l)=>{let c,d,f,h,u=l;for(;u>=o;--u)if(c=u*e+s,d=u*e+a,f=c>>>5,h=d>>>5,f===h){if(n[f]&xd[31&c]&Na[1+(31&d)])return!0}else{if(n[f]&xd[31&c]||n[h]&Na[1+(31&d)])return!0;for(let p=f+1;p<h;++p)if(n[p])return!0}return!1},setRange:(s,o,a,l)=>{let u,c,d,f,h;for(;o<=l;++o)if(u=o*e+s,c=o*e+a,d=u>>>5,f=c>>>5,d===f)i(d,xd[31&u]&Na[1+(31&c)]);else for(i(d,xd[31&u]),i(f,Na[1+(31&c)]),h=d+1;h<f;++h)i(h,4294967295)},clearRange:(s,o,a,l)=>{let u,c,d,f,h;for(;o<=l;++o)if(u=o*e+s,c=o*e+a,d=u>>>5,f=c>>>5,d===f)r(d,Na[31&u]|xd[1+(31&c)]);else for(r(d,Na[31&u]),r(f,xd[1+(31&c)]),h=d+1;h<f;++h)r(h,0)},outOfBounds:(s,o,a,l)=>s<0||o<0||l>=t||a>=e}}(r,s),o.ratio=i,o.padding=n,o.width=e,o.height=t,o}(t[0],t[1],u);let E;if(!v){n&&C.sort((P,j)=>n(P.datum,j.datum));let O=!1;for(let P=0;P<h.length&&!O;++P)O=5===h[P]||f[P]<0;const N=(p&&o||m)&&e.map(P=>P.datum);E=s.length||N?function Gje(e,t,n,i,r){const s=e.width,o=e.height,a=i||r,l=rd(s,o).getContext("2d"),u=rd(s,o).getContext("2d"),c=a&&rd(s,o).getContext("2d");n.forEach(E=>IE(l,E,!1)),IE(u,t,!1),a&&IE(c,t,!0);const d=zP(l,s,o),f=zP(u,s,o),h=a&&zP(c,s,o),p=e.bitmap(),g=a&&e.bitmap();let m,_,y,v,b,D,C,w;for(_=0;_<o;++_)for(m=0;m<s;++m)b=_*s+m,D=d[b]&UP,w=f[b]&UP,C=a&&h[b]&UP,(D||C||w)&&(y=e(m),v=e(_),!r&&(D||w)&&p.set(y,v),a&&(D||C)&&g.set(y,v));return[p,g]}(w,N||[],s,O,m):function qje(e,t){const n=e.bitmap();return(t||[]).forEach(i=>n.set(e(i.boundary[0]),e(i.boundary[3]))),[n,void 0]}(w,o&&C)}const T=m?s5e[c](w,E,o,l):function i5e(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1],l=i.length;return function(u){var c;const d=u.boundary,f=u.datum.fontSize;if(d[2]<0||d[5]<0||d[0]>r||d[3]>s)return!1;let p,g,m,_,y,v,b,D,C,w,E,T,O,N,P,h=null!==(c=u.textWidth)&&void 0!==c?c:0;for(let j=0;j<l;++j){if(p=(3&n[j])-1,g=(n[j]>>>2&3)-1,m=0===p&&0===g||i[j]<0,_=p&&g?Math.SQRT1_2:1,y=i[j]<0?-1:1,v=d[1+p]+i[j]*p*_,E=d[4+g]+y*f*g/2+i[j]*g*_,D=E-f/2,C=E+f/2,T=e(v),N=e(D),P=e(C),!h){if(!nte(T,T,N,P,o,a,0,0,0,0,0,m))continue;h=xa.width(u.datum,u.datum.text)}if(w=v+y*h*p/2,v=w-h/2,b=w+h/2,T=e(v),O=e(b),nte(T,O,N,P,o,a,0,0,0,0,0,m))return u.x=p?p*y<0?b:v:w,u.y=g?g*y<0?C:D:E,u.align=t5e[p*y+1],u.baseline=n5e[g*y+1],o.setRange(T,N,O,P),!0}return!1}}(w,E,h,f);return C.forEach(O=>O.opacity=+T(O)),C}const XP=["x","y","opacity","align","baseline"],ite=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function QP(e){J.call(this,null,e)}function rte(e,t){var r,s,o,a,l,u,n=[],i=function(c){return c(a)};if(null==t)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],(u=r[l=t.map(i)])||(r[l]=u=[],u.dims=l,n.push(u)),u.push(a);return n}function ZP(e){J.call(this,null,e)}QP.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:ite},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:XP.length,default:XP}]},fe(QP,J,{transform(e,t){const i=e.modified();if(!(i||t.changed(t.ADD_REM)||function n(s){const o=e[s];return rt(o)&&t.modified(o.fields)}("sort")))return;(!e.size||2!==e.size.length)&&ee("Size parameter should be specified as a [width, height] array.");const r=e.as||XP;return o5e(t.materialize(t.SOURCE).source||[],e.size,e.sort,we(null==e.offset?1:e.offset),we(e.anchor||ite),e.avoidMarks||[],!1!==e.avoidBaseMark,e.lineAnchor||"end",e.markIndex||0,void 0===e.padding?0:e.padding,e.method||"naive").forEach(s=>{const o=s.datum;o[r[0]]=s.x,o[r[1]]=s.y,o[r[2]]=s.opacity,o[r[3]]=s.align,o[r[4]]=s.baseline}),t.reflow(i).modifies(r)}}),ZP.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},fe(ZP,J,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=rte(t.materialize(t.SOURCE).source,e.groupby),s=(e.groupby||[]).map(qn),o=s.length,a=e.as||[qn(e.x),qn(e.y)],l=[];r.forEach(u=>{_Y(u,e.x,e.y,e.bandwidth||.3).forEach(c=>{const d={};for(let f=0;f<o;++f)d[s[f]]=u.dims[f];d[a[0]]=c[0],d[a[1]]=c[1],l.push(Vt(d))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});const e3={linear:Jk,log:dY,exp:fY,pow:hY,quad:Xk,poly:pY};function t3(e){J.call(this,null,e)}t3.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(e3)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},fe(t3,J,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=rte(t.materialize(t.SOURCE).source,e.groupby),s=(e.groupby||[]).map(qn),o=e.method||"linear",a=e.order||3,l=((e,t)=>"poly"===e?t:"quad"===e?2:1)(o,a),u=e.as||[qn(e.x),qn(e.y)],c=e3[o],d=[];let f=e.extent;ke(e3,o)||ee("Invalid regression method: "+o),null!=f&&"log"===o&&f[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),f=null),r.forEach(h=>{if(h.length<=l)return void t.dataflow.warn("Skipping regression with more parameters than data points.");const g=c(h,e.x,e.y,a);if(e.params)return void d.push(Vt({keys:h.dims,coef:g.coef,rSquared:g.rSquared}));const m=f||wl(h,e.x),_=y=>{const v={};for(let b=0;b<s.length;++b)v[s[b]]=h.dims[b];v[u[0]]=y[0],v[u[1]]=y[1],d.push(Vt(v))};"linear"===o?m.forEach(y=>_([y,g.predict(y)])):LD(g.predict,m,25,200).forEach(_)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=d}return n}});const Si=134217729;function bv(e,t,n,i,r){let s,o,a,l,u=t[0],c=i[0],d=0,f=0;c>u==c>-u?(s=u,u=t[++d]):(s=c,c=i[++f]);let h=0;if(d<e&&f<n)for(c>u==c>-u?(o=u+s,a=s-(o-u),u=t[++d]):(o=c+s,a=s-(o-c),c=i[++f]),s=o,0!==a&&(r[h++]=a);d<e&&f<n;)c>u==c>-u?(o=s+u,l=o-s,a=s-(o-l)+(u-l),u=t[++d]):(o=s+c,l=o-s,a=s-(o-l)+(c-l),c=i[++f]),s=o,0!==a&&(r[h++]=a);for(;d<e;)o=s+u,l=o-s,a=s-(o-l)+(u-l),u=t[++d],s=o,0!==a&&(r[h++]=a);for(;f<n;)o=s+c,l=o-s,a=s-(o-l)+(c-l),c=i[++f],s=o,0!==a&&(r[h++]=a);return(0!==s||0===h)&&(r[h++]=s),h}function ue(e){return new Float64Array(e)}const bm=ue(4),ste=ue(8),ote=ue(12),ate=ue(16),Yr=ue(4);function FE(e,t,n,i,r,s){const o=(t-s)*(n-r),a=(e-r)*(i-s),l=o-a;if(0===o||0===a||o>0!=a>0)return l;const u=Math.abs(o+a);return Math.abs(l)>=33306690738754716e-32*u?l:-function _5e(e,t,n,i,r,s,o){let a,l,u,c,d,f,h,p,g,m,_,y,v,b,D,C,w,E;const T=e-r,O=n-r,N=t-s,P=i-s;b=T*P,f=Si*T,h=f-(f-T),p=T-h,f=Si*P,g=f-(f-P),m=P-g,D=p*m-(b-h*g-p*g-h*m),C=N*O,f=Si*N,h=f-(f-N),p=N-h,f=Si*O,g=f-(f-O),m=O-g,w=p*m-(C-h*g-p*g-h*m),_=D-w,d=D-_,bm[0]=D-(_+d)+(d-w),y=b+_,d=y-b,v=b-(y-d)+(_-d),_=v-C,d=v-_,bm[1]=v-(_+d)+(d-C),E=y+_,d=E-y,bm[2]=y-(E-d)+(_-d),bm[3]=E;let j=function h5e(e,t){let n=t[0];for(let i=1;i<e;i++)n+=t[i];return n}(4,bm),A=22204460492503146e-32*o;if(j>=A||-j>=A||(d=e-T,a=e-(T+d)+(d-r),d=n-O,u=n-(O+d)+(d-r),d=t-N,l=t-(N+d)+(d-s),d=i-P,c=i-(P+d)+(d-s),0===a&&0===l&&0===u&&0===c)||(A=11093356479670487e-47*o+33306690738754706e-32*Math.abs(j),j+=T*c+P*a-(N*u+O*l),j>=A||-j>=A))return j;b=a*P,f=Si*a,h=f-(f-a),p=a-h,f=Si*P,g=f-(f-P),m=P-g,D=p*m-(b-h*g-p*g-h*m),C=l*O,f=Si*l,h=f-(f-l),p=l-h,f=Si*O,g=f-(f-O),m=O-g,w=p*m-(C-h*g-p*g-h*m),_=D-w,d=D-_,Yr[0]=D-(_+d)+(d-w),y=b+_,d=y-b,v=b-(y-d)+(_-d),_=v-C,d=v-_,Yr[1]=v-(_+d)+(d-C),E=y+_,d=E-y,Yr[2]=y-(E-d)+(_-d),Yr[3]=E;const x=bv(4,bm,4,Yr,ste);b=T*c,f=Si*T,h=f-(f-T),p=T-h,f=Si*c,g=f-(f-c),m=c-g,D=p*m-(b-h*g-p*g-h*m),C=N*u,f=Si*N,h=f-(f-N),p=N-h,f=Si*u,g=f-(f-u),m=u-g,w=p*m-(C-h*g-p*g-h*m),_=D-w,d=D-_,Yr[0]=D-(_+d)+(d-w),y=b+_,d=y-b,v=b-(y-d)+(_-d),_=v-C,d=v-_,Yr[1]=v-(_+d)+(d-C),E=y+_,d=E-y,Yr[2]=y-(E-d)+(_-d),Yr[3]=E;const S=bv(x,ste,4,Yr,ote);b=a*c,f=Si*a,h=f-(f-a),p=a-h,f=Si*c,g=f-(f-c),m=c-g,D=p*m-(b-h*g-p*g-h*m),C=l*u,f=Si*l,h=f-(f-l),p=l-h,f=Si*u,g=f-(f-u),m=u-g,w=p*m-(C-h*g-p*g-h*m),_=D-w,d=D-_,Yr[0]=D-(_+d)+(d-w),y=b+_,d=y-b,v=b-(y-d)+(_-d),_=v-C,d=v-_,Yr[1]=v-(_+d)+(d-C),E=y+_,d=E-y,Yr[2]=y-(E-d)+(_-d),Yr[3]=E;const I=bv(S,ote,4,Yr,ate);return ate[I-1]}(e,t,n,i,r,s,u)}ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(8),ue(8),ue(8),ue(4),ue(8),ue(8),ue(8),ue(12),ue(192),ue(192),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(8),ue(8),ue(8),ue(8),ue(8),ue(8),ue(8),ue(8),ue(8),ue(4),ue(4),ue(4),ue(8),ue(16),ue(16),ue(16),ue(32),ue(32),ue(48),ue(64),ue(1152),ue(1152),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(24),ue(24),ue(24),ue(24),ue(24),ue(24),ue(24),ue(24),ue(24),ue(24),ue(1152),ue(1152),ue(1152),ue(1152),ue(1152),ue(2304),ue(2304),ue(3456),ue(5760),ue(8),ue(8),ue(8),ue(16),ue(24),ue(48),ue(48),ue(96),ue(192),ue(384),ue(384),ue(384),ue(768),ue(96),ue(96),ue(96),ue(1152);const Mte=Math.pow(2,-52),qE=new Uint32Array(512);class GE{static from(t,n=L5e,i=j5e){const r=t.length,s=new Float64Array(2*r);for(let o=0;o<r;o++){const a=t[o];s[2*o]=n(a),s[2*o+1]=i(a)}return new GE(s)}constructor(t){const n=t.length>>1;if(n>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(3*i),this._halfedges=new Int32Array(3*i),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:s}=this,o=t.length>>1;let a=1/0,l=1/0,u=-1/0,c=-1/0;for(let O=0;O<o;O++){const N=t[2*O],P=t[2*O+1];N<a&&(a=N),P<l&&(l=P),N>u&&(u=N),P>c&&(c=P),this._ids[O]=O}const d=(a+u)/2,f=(l+c)/2;let p,g,m,h=1/0;for(let O=0;O<o;O++){const N=M3(d,f,t[2*O],t[2*O+1]);N<h&&(p=O,h=N)}const _=t[2*p],y=t[2*p+1];h=1/0;for(let O=0;O<o;O++){if(O===p)continue;const N=M3(_,y,t[2*O],t[2*O+1]);N<h&&N>0&&(g=O,h=N)}let v=t[2*g],b=t[2*g+1],D=1/0;for(let O=0;O<o;O++){if(O===p||O===g)continue;const N=F5e(_,y,v,b,t[2*O],t[2*O+1]);N<D&&(m=O,D=N)}let C=t[2*m],w=t[2*m+1];if(D===1/0){for(let P=0;P<o;P++)this._dists[P]=t[2*P]-t[0]||t[2*P+1]-t[1];Mm(this._ids,this._dists,0,o-1);const O=new Uint32Array(o);let N=0;for(let P=0,j=-1/0;P<o;P++){const A=this._ids[P];this._dists[A]>j&&(O[N++]=A,j=this._dists[A])}return this.hull=O.subarray(0,N),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(FE(_,y,v,b,C,w)<0){const O=g,N=v,P=b;g=m,v=C,b=w,m=O,C=N,w=P}const E=function P5e(e,t,n,i,r,s){const o=n-e,a=i-t,l=r-e,u=s-t,c=o*o+a*a,d=l*l+u*u,f=.5/(o*u-a*l);return{x:e+(u*c-a*d)*f,y:t+(o*d-l*c)*f}}(_,y,v,b,C,w);this._cx=E.x,this._cy=E.y;for(let O=0;O<o;O++)this._dists[O]=M3(t[2*O],t[2*O+1],E.x,E.y);Mm(this._ids,this._dists,0,o-1),this._hullStart=p;let T=3;i[p]=n[m]=g,i[g]=n[p]=m,i[m]=n[g]=p,r[p]=0,r[g]=1,r[m]=2,s.fill(-1),s[this._hashKey(_,y)]=p,s[this._hashKey(v,b)]=g,s[this._hashKey(C,w)]=m,this.trianglesLen=0,this._addTriangle(p,g,m,-1,-1,-1);for(let N,P,O=0;O<this._ids.length;O++){const j=this._ids[O],A=t[2*j],x=t[2*j+1];if(O>0&&Math.abs(A-N)<=Mte&&Math.abs(x-P)<=Mte||(N=A,P=x,j===p||j===g||j===m))continue;let S=0;for(let V=0,U=this._hashKey(A,x);V<this._hashSize&&(S=s[(U+V)%this._hashSize],-1===S||S===i[S]);V++);S=n[S];let M,I=S;for(;M=i[I],FE(A,x,t[2*I],t[2*I+1],t[2*M],t[2*M+1])>=0;)if(I=M,I===S){I=-1;break}if(-1===I)continue;let L=this._addTriangle(I,j,i[I],-1,-1,r[I]);r[j]=this._legalize(L+2),r[I]=L,T++;let R=i[I];for(;M=i[R],FE(A,x,t[2*R],t[2*R+1],t[2*M],t[2*M+1])<0;)L=this._addTriangle(R,j,M,r[j],-1,r[R]),r[j]=this._legalize(L+2),i[R]=R,T--,R=M;if(I===S)for(;M=n[I],FE(A,x,t[2*M],t[2*M+1],t[2*I],t[2*I+1])<0;)L=this._addTriangle(M,j,I,-1,r[I],r[M]),this._legalize(L+2),r[M]=L,i[I]=I,T--,I=M;this._hullStart=n[j]=I,i[I]=n[R]=j,i[j]=R,s[this._hashKey(A,x)]=j,s[this._hashKey(t[2*I],t[2*I+1])]=I}this.hull=new Uint32Array(T);for(let O=0,N=this._hullStart;O<T;O++)this.hull[O]=N,N=i[N];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(function I5e(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:i,coords:r}=this;let s=0,o=0;for(;;){const a=i[t],l=t-t%3;if(o=l+(t+2)%3,-1===a){if(0===s)break;t=qE[--s];continue}const u=a-a%3,d=u+(a+2)%3,f=n[o],h=n[t],p=n[l+(t+1)%3],g=n[d];if(R5e(r[2*f],r[2*f+1],r[2*h],r[2*h+1],r[2*p],r[2*p+1],r[2*g],r[2*g+1])){n[t]=g,n[a]=f;const _=i[d];if(-1===_){let v=this._hullStart;do{if(this._hullTri[v]===d){this._hullTri[v]=t;break}v=this._hullPrev[v]}while(v!==this._hullStart)}this._link(t,_),this._link(a,i[o]),this._link(o,d);const y=u+(a+1)%3;s<qE.length&&(qE[s++]=y)}else{if(0===s)break;t=qE[--s]}}return o}_link(t,n){this._halfedges[t]=n,-1!==n&&(this._halfedges[n]=t)}_addTriangle(t,n,i,r,s,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=i,this._link(a,r),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function M3(e,t,n,i){const r=e-n,s=t-i;return r*r+s*s}function R5e(e,t,n,i,r,s,o,a){const l=e-o,u=t-a,c=n-o,d=i-a,f=r-o,h=s-a,g=c*c+d*d,m=f*f+h*h;return l*(d*m-g*h)-u*(c*m-g*f)+(l*l+u*u)*(c*h-d*f)<0}function F5e(e,t,n,i,r,s){const o=n-e,a=i-t,l=r-e,u=s-t,c=o*o+a*a,d=l*l+u*u,f=.5/(o*u-a*l),h=(u*c-a*d)*f,p=(o*d-l*c)*f;return h*h+p*p}function Mm(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const s=e[r],o=t[s];let a=r-1;for(;a>=n&&t[e[a]]>o;)e[a+1]=e[a--];e[a+1]=s}else{let s=n+1,o=i;Ev(e,n+i>>1,s),t[e[n]]>t[e[i]]&&Ev(e,n,i),t[e[s]]>t[e[i]]&&Ev(e,s,i),t[e[n]]>t[e[s]]&&Ev(e,n,s);const a=e[s],l=t[a];for(;;){do{s++}while(t[e[s]]<l);do{o--}while(t[e[o]]>l);if(o<s)break;Ev(e,s,o)}e[n+1]=e[o],e[o]=a,i-s+1>=o-n?(Mm(e,t,s,i),Mm(e,t,n,o-1)):(Mm(e,t,n,o-1),Mm(e,t,s,i))}}function Ev(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function L5e(e){return e[0]}function j5e(e){return e[1]}class Ah{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,i){const r=(t=+t)+(i=+i),s=n=+n;if(i<0)throw new Error("negative radius");null===this._x1?this._+=`M${r},${s}`:(Math.abs(this._x1-r)>1e-6||Math.abs(this._y1-s)>1e-6)&&(this._+="L"+r+","+s),i&&(this._+=`A${i},${i},0,1,1,${t-i},${n}A${i},${i},0,1,1,${this._x1=r},${this._y1=s}`)}rect(t,n,i,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class T3{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class B5e{constructor(t,[n,i,r,s]=[0,0,960,500]){if(!((r=+r)>=(n=+n)&&(s=+s)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=r,this.xmin=n,this.ymax=s,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:i},vectors:r}=this,s=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let m,_,h=0,p=0,g=i.length;h<g;h+=3,p+=2){const y=2*i[h],v=2*i[h+1],b=2*i[h+2],D=t[y],C=t[y+1],T=t[b],O=t[b+1],N=t[v]-D,P=t[v+1]-C,j=T-D,A=O-C,x=2*(N*A-P*j);if(Math.abs(x)<1e-9){let S=1e9;const I=2*i[0];S*=Math.sign((t[I]-D)*A-(t[I+1]-C)*j),m=(D+T)/2-S*A,_=(C+O)/2+S*j}else{const S=1/x,I=N*N+P*P,M=j*j+A*A;m=D+(A*I-P*M)*S,_=C+(N*M-j*I)*S}s[p]=m,s[p+1]=_}let a,u,d,o=n[n.length-1],l=4*o,c=t[2*o],f=t[2*o+1];r.fill(0);for(let h=0;h<n.length;++h)o=n[h],a=l,u=c,d=f,l=4*o,c=t[2*o],f=t[2*o+1],r[a+2]=r[l]=d-f,r[a+3]=r[l+1]=c-u}render(t){const n=null==t?t=new Ah:void 0,{delaunay:{halfedges:i,inedges:r,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let c=0,d=i.length;c<d;++c){const f=i[c];if(f<c)continue;const h=2*Math.floor(c/3),p=2*Math.floor(f/3);this._renderSegment(o[h],o[h+1],o[p],o[p+1],t)}let l,u=s[s.length-1];for(let c=0;c<s.length;++c){l=u,u=s[c];const d=2*Math.floor(r[u]/3),f=o[d],h=o[d+1],p=4*l,g=this._project(f,h,a[p+2],a[p+3]);g&&this._renderSegment(f,h,g[0],g[1],t)}return n&&n.value()}renderBounds(t){const n=null==t?t=new Ah:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const i=null==n?n=new Ah:void 0,r=this._clip(t);if(null===r||!r.length)return;n.moveTo(r[0],r[1]);let s=r.length;for(;r[0]===r[s-2]&&r[1]===r[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(r[o]!==r[o-2]||r[o+1]!==r[o-1])&&n.lineTo(r[o],r[o+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,i=t.length/2;n<i;++n){const r=this.cellPolygon(n);r&&(r.index=n,yield r)}}cellPolygon(t){const n=new T3;return this.renderCell(t,n),n.value()}_renderSegment(t,n,i,r,s){let o;const a=this._regioncode(t,n),l=this._regioncode(i,r);0===a&&0===l?(s.moveTo(t,n),s.lineTo(i,r)):(o=this._clipSegment(t,n,i,r,a,l))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(t,n,i){return(n=+n)==n&&(i=+i)==i&&this.delaunay._step(t,n,i)===t}*neighbors(t){const n=this._clip(t);if(n)for(const i of this.delaunay.neighbors(t)){const r=this._clip(i);if(r)e:for(let s=0,o=n.length;s<o;s+=2)for(let a=0,l=r.length;a<l;a+=2)if(n[s]==r[a]&&n[s+1]==r[a+1]&&n[(s+2)%o]==r[(a+l-2)%l]&&n[(s+3)%o]==r[(a+l-1)%l]){yield i;break e}}}_cell(t){const{circumcenters:n,delaunay:{inedges:i,halfedges:r,triangles:s}}=this,o=i[t];if(-1===o)return null;const a=[];let l=o;do{const u=Math.floor(l/3);if(a.push(n[2*u],n[2*u+1]),l=l%3==2?l-2:l+1,s[l]!==t)break;l=r[l]}while(l!==o&&-1!==l);return a}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(null===n)return null;const{vectors:i}=this,r=4*t;return i[r]||i[r+1]?this._clipInfinite(t,n,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(t,n)}_clipFinite(t,n){const i=n.length;let s,o,u,d,r=null,a=n[i-2],l=n[i-1],c=this._regioncode(a,l),f=0;for(let h=0;h<i;h+=2)if(s=a,o=l,a=n[h],l=n[h+1],u=c,c=this._regioncode(a,l),0===u&&0===c)d=f,f=0,r?r.push(a,l):r=[a,l];else{let p,g,m,_,y;if(0===u){if(null===(p=this._clipSegment(s,o,a,l,u,c)))continue;[g,m,_,y]=p}else{if(null===(p=this._clipSegment(a,l,s,o,c,u)))continue;[_,y,g,m]=p,d=f,f=this._edgecode(g,m),d&&f&&this._edge(t,d,f,r,r.length),r?r.push(g,m):r=[g,m]}d=f,f=this._edgecode(_,y),d&&f&&this._edge(t,d,f,r,r.length),r?r.push(_,y):r=[_,y]}if(r)d=f,f=this._edgecode(r[0],r[1]),d&&f&&this._edge(t,d,f,r,r.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(t,n,i,r,s,o){for(;;){if(0===s&&0===o)return[t,n,i,r];if(s&o)return null;let a,l,u=s||o;8&u?(a=t+(i-t)*(this.ymax-n)/(r-n),l=this.ymax):4&u?(a=t+(i-t)*(this.ymin-n)/(r-n),l=this.ymin):2&u?(l=n+(r-n)*(this.xmax-t)/(i-t),a=this.xmax):(l=n+(r-n)*(this.xmin-t)/(i-t),a=this.xmin),s?s=this._regioncode(t=a,n=l):o=this._regioncode(i=a,r=l)}}_clipInfinite(t,n,i,r,s,o){let l,a=Array.from(n);if((l=this._project(a[0],a[1],i,r))&&a.unshift(l[0],l[1]),(l=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(l[0],l[1]),a=this._clipFinite(t,a))for(let d,u=0,c=a.length,f=this._edgecode(a[c-2],a[c-1]);u<c;u+=2)d=f,f=this._edgecode(a[u],a[u+1]),d&&f&&(u=this._edge(t,d,f,a,u),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,i,r,s){for(;n!==i;){let o,a;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,a=this.ymin}(r[s]!==o||r[s+1]!==a)&&this.contains(t,o,a)&&(r.splice(s,0,o,a),s+=2)}if(r.length>4)for(let o=0;o<r.length;o+=2){const a=(o+2)%r.length,l=(o+4)%r.length;(r[o]===r[a]&&r[a]===r[l]||r[o+1]===r[a+1]&&r[a+1]===r[l+1])&&(r.splice(a,2),o-=2)}return s}_project(t,n,i,r){let o,a,l,s=1/0;if(r<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/r)<s&&(l=this.ymin,a=t+(s=o)*i)}else if(r>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/r)<s&&(l=this.ymax,a=t+(s=o)*i)}if(i>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/i)<s&&(a=this.xmax,l=n+(s=o)*r)}else if(i<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/i)<s&&(a=this.xmin,l=n+(s=o)*r)}return[a,l]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const $5e=2*Math.PI,Tm=Math.pow;function V5e(e){return e[0]}function H5e(e){return e[1]}function z5e(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class O3{static from(t,n=V5e,i=H5e,r){return new O3("length"in t?function q5e(e,t,n,i){const r=e.length,s=new Float64Array(2*r);for(let o=0;o<r;++o){const a=e[o];s[2*o]=t.call(i,a,o,e),s[2*o+1]=n.call(i,a,o,e)}return s}(t,n,i,r):Float64Array.from(function*G5e(e,t,n,i){let r=0;for(const s of e)yield t.call(i,s,r,e),yield n.call(i,s,r,e),++r}(t,n,i,r)))}constructor(t){this._delaunator=new GE(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&function U5e(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const r=2*t[i],s=2*t[i+1],o=2*t[i+2];if((n[o]-n[r])*(n[s+1]-n[r+1])-(n[s]-n[r])*(n[o+1]-n[r+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:n.length/2},(f,h)=>h).sort((f,h)=>n[2*f]-n[2*h]||n[2*f+1]-n[2*h+1]);const l=this.collinear[0],u=this.collinear[this.collinear.length-1],c=[n[2*l],n[2*l+1],n[2*u],n[2*u+1]],d=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let f=0,h=n.length/2;f<h;++f){const p=z5e(n[2*f],n[2*f+1],d);n[2*f]=p[0],n[2*f+1]=p[1]}this._delaunator=new GE(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let l=0,u=i.length;l<u;++l){const c=s[l%3==2?l-2:l+1];(-1===i[l]||-1===o[c])&&(o[c]=l)}for(let l=0,u=r.length;l<u;++l)a[r[l]]=l;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,2===r.length&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(t){return new B5e(this,t)}*neighbors(t){const{inedges:n,hull:i,_hullIndex:r,halfedges:s,triangles:o,collinear:a}=this;if(a){const d=a.indexOf(t);return d>0&&(yield a[d-1]),void(d<a.length-1&&(yield a[d+1]))}const l=n[t];if(-1===l)return;let u=l,c=-1;do{if(yield c=o[u],u=u%3==2?u-2:u+1,o[u]!==t)return;if(u=s[u],-1===u){const d=i[(r[t]+1)%i.length];return void(d!==c&&(yield d))}}while(u!==l)}find(t,n,i=0){if((t=+t)!=t||(n=+n)!=n)return-1;const r=i;let s;for(;(s=this._step(i,t,n))>=0&&s!==i&&s!==r;)i=s;return s}_step(t,n,i){const{inedges:r,hull:s,_hullIndex:o,halfedges:a,triangles:l,points:u}=this;if(-1===r[t]||!u.length)return(t+1)%(u.length>>1);let c=t,d=Tm(n-u[2*t],2)+Tm(i-u[2*t+1],2);const f=r[t];let h=f;do{let p=l[h];const g=Tm(n-u[2*p],2)+Tm(i-u[2*p+1],2);if(g<d&&(d=g,c=p),h=h%3==2?h-2:h+1,l[h]!==t)break;if(h=a[h],-1===h){if(h=s[(o[t]+1)%s.length],h!==p&&Tm(n-u[2*h],2)+Tm(i-u[2*h+1],2)<d)return h;break}}while(h!==f);return c}render(t){const n=null==t?t=new Ah:void 0,{points:i,halfedges:r,triangles:s}=this;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l<o)continue;const u=2*s[o],c=2*s[l];t.moveTo(i[u],i[u+1]),t.lineTo(i[c],i[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){void 0===n&&(!t||"function"!=typeof t.moveTo)&&(n=t,t=null),n=null==n?2:+n;const i=null==t?t=new Ah:void 0,{points:r}=this;for(let s=0,o=r.length;s<o;s+=2){const a=r[s],l=r[s+1];t.moveTo(a+n,l),t.arc(a,l,n,0,$5e)}return i&&i.value()}renderHull(t){const n=null==t?t=new Ah:void 0,{hull:i,points:r}=this,s=2*i[0],o=i.length;t.moveTo(r[s],r[s+1]);for(let a=1;a<o;++a){const l=2*i[a];t.lineTo(r[l],r[l+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new T3;return this.renderHull(t),t.value()}renderTriangle(t,n){const i=null==n?n=new Ah:void 0,{points:r,triangles:s}=this,o=2*s[t*=3],a=2*s[t+1],l=2*s[t+2];return n.moveTo(r[o],r[o+1]),n.lineTo(r[a],r[a+1]),n.lineTo(r[l],r[l+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,i=t.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new T3;return this.renderTriangle(t,n),n.value()}}function N3(e){J.call(this,null,e)}N3.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const W5e=[-1e5,-1e5,1e5,1e5];function Y5e(e){const t=e[0][0],n=e[0][1];let i=e.length-1;for(;e[i][0]===t&&e[i][1]===n;--i);return"M"+e.slice(0,i+1).join("L")+"Z"}fe(N3,J,{transform(e,t){const n=e.as||"path",i=t.source;if(!i||!i.length)return t;let r=e.size;r=r?[0,0,r[0],r[1]]:(r=e.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:W5e;const s=this.value=O3.from(i,e.x,e.y).voronoi(r);for(let o=0,a=i.length;o<a;++o){const l=s.cellPolygon(o);i[o][n]=l?Y5e(l):null}return t.reflow(e.modified()).modifies(n)}});var k3=Math.PI/180;function J5e(e,t,n,i){if(!t.sprite){var r=e.context,s=e.ratio;r.clearRect(0,0,2048/s,2048/s);var c,d,f,h,p,o=0,a=0,l=0,u=n.length;for(--i;++i<u;){if(t=n[i],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font,c=r.measureText(t.text+"m").width*s,f=t.size<<1,t.rotate){var g=Math.sin(t.rotate*k3),m=Math.cos(t.rotate*k3),_=c*m,y=c*g,v=f*m,b=f*g;c=Math.max(Math.abs(_+b),Math.abs(_-b))+31>>5<<5,f=~~Math.max(Math.abs(y+v),Math.abs(y-v))}else c=c+31>>5<<5;if(f>l&&(l=f),o+c>=2048&&(o=0,a+=l,l=0),a+f>=2048)break;r.translate((o+(c>>1))/s,(a+(f>>1))/s),t.rotate&&r.rotate(t.rotate*k3),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=c,t.height=f,t.xoff=o,t.yoff=a,t.x1=c>>1,t.y1=f>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,o+=c}for(var D=r.getImageData(0,0,2048/s,2048/s).data,C=[];--i>=0;)if((t=n[i]).hasText){for(d=(c=t.width)>>5,f=t.y1-t.y0,h=0;h<f*d;h++)C[h]=0;if(null==(o=t.xoff))return;a=t.yoff;var w=0,E=-1;for(p=0;p<f;p++){for(h=0;h<c;h++){var O=D[2048*(a+p)+(o+h)<<2]?1<<31-h%32:0;C[d*p+(h>>5)]|=O,w|=O}w?E=p:(t.y0++,f--,p--,a++)}t.y1=t.y0+E,t.sprite=C.slice(0,(t.y1-t.y0)*d)}}}function X5e(e,t,n){for(var c,i=e.sprite,r=e.width>>5,s=e.x-(r<<4),o=127&s,a=32-o,l=e.y1-e.y0,u=(e.y+e.y0)*(n>>=5)+(s>>5),d=0;d<l;d++){c=0;for(var f=0;f<=r;f++)if((c<<a|(f<r?(c=i[d*r+f])>>>o:0))&t[u+f])return!0;u+=n}return!1}function Q5e(e,t){var n=e[0],i=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>i.x&&(i.x=t.x+t.x1),t.y+t.y1>i.y&&(i.y=t.y+t.y1)}function Z5e(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function Ote(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Mh(e){return"function"==typeof e?e:function(){return e}}var nBe={archimedean:Ote,rectangular:function eBe(e){var n=4*e[0]/e[1],i=0,r=0;return function(s){var o=s<0?-1:1;switch(Math.sqrt(1+4*o*s)-o&3){case 0:i+=n;break;case 1:r+=4;break;case 2:i-=n;break;default:r-=4}return[i,r]}}};const Nte=["x","y","font","fontSize","fontStyle","fontWeight","angle"],iBe=["text","font","rotate","fontSize","fontStyle","fontWeight"];function I3(e){J.call(this,function K5e(){var t,n,i,r,s,o,a,e=[256,256],l=Ote,u=[],c=Math.random,d={};function h(p,g,m){for(var w,E,T,_=g.x,y=g.y,v=Math.sqrt(e[0]*e[0]+e[1]*e[1]),b=l(e),D=c()<.5?1:-1,C=-D;(w=b(C+=D))&&(E=~~w[0],T=~~w[1],!(Math.min(Math.abs(E),Math.abs(T))>=v));)if(g.x=_+E,g.y=y+T,!(g.x+g.x0<0||g.y+g.y0<0||g.x+g.x1>e[0]||g.y+g.y1>e[1])&&(!m||!X5e(g,p,e[0]))&&(!m||Z5e(g,m))){for(var M,O=g.sprite,N=g.width>>5,P=e[0]>>5,j=g.x-(N<<4),A=127&j,x=32-A,S=g.y1-g.y0,I=(g.y+g.y0)*P+(j>>5),L=0;L<S;L++){M=0;for(var R=0;R<=N;R++)p[I+R]|=M<<x|(R<N?(M=O[L*N+R])>>>A:0);I+=P}return g.sprite=null,!0}return!1}return d.layout=function(){for(var p=function f(p){p.width=p.height=1;var g=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=2048/g,p.height=2048/g;var m=p.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:g}}(rd()),g=function tBe(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}((e[0]>>5)*e[1]),m=null,_=u.length,y=-1,v=[],b=u.map(C=>({text:t(C),font:n(C),style:r(C),weight:s(C),rotate:o(C),size:~~(i(C)+1e-14),padding:a(C),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:C})).sort((C,w)=>w.size-C.size);++y<_;){var D=b[y];D.x=e[0]*(c()+.5)>>1,D.y=e[1]*(c()+.5)>>1,J5e(p,D,b,y),D.hasText&&h(g,D,m)&&(v.push(D),m?Q5e(m,D):m=[{x:D.x+D.x0,y:D.y+D.y0},{x:D.x+D.x1,y:D.y+D.y1}],D.x-=e[0]>>1,D.y-=e[1]>>1)}return v},d.words=function(p){return arguments.length?(u=p,d):u},d.size=function(p){return arguments.length?(e=[+p[0],+p[1]],d):e},d.font=function(p){return arguments.length?(n=Mh(p),d):n},d.fontStyle=function(p){return arguments.length?(r=Mh(p),d):r},d.fontWeight=function(p){return arguments.length?(s=Mh(p),d):s},d.rotate=function(p){return arguments.length?(o=Mh(p),d):o},d.text=function(p){return arguments.length?(t=Mh(p),d):t},d.spiral=function(p){return arguments.length?(l=nBe[p]||p,d):l},d.fontSize=function(p){return arguments.length?(i=Mh(p),d):i},d.padding=function(p){return arguments.length?(a=Mh(p),d):a},d.random=function(p){return arguments.length?(c=p,d):c},d}(),e)}I3.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:Nte}]},fe(I3,J,{transform(e,t){e.size&&(!e.size[0]||!e.size[1])&&ee("Wordcloud size dimensions must be non-zero.");const i=e.modified();if(!(i||t.changed(t.ADD_REM)||iBe.some(function n(p){const g=e[p];return rt(g)&&t.modified(g.fields)})))return;const r=t.materialize(t.SOURCE).source,s=this.value,o=e.as||Nte;let l,a=e.fontSize||14;if(rt(a)?l=e.fontSizeRange:a=gr(a),l){const p=a,g=Ft("sqrt")().domain(wl(r,p)).range(l);a=m=>g(p(m))}r.forEach(p=>{p[o[0]]=NaN,p[o[1]]=NaN,p[o[3]]=0});const u=s.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(Io).layout(),c=s.size(),d=c[0]>>1,f=c[1]>>1,h=u.length;for(let g,m,p=0;p<h;++p)g=u[p],m=g.datum,m[o[0]]=g.x+d,m[o[1]]=g.y+f,m[o[2]]=g.font,m[o[3]]=g.size,m[o[4]]=g.style,m[o[5]]=g.weight,m[o[6]]=g.rotate;return t.reflow(i).modifies(o)}});const sBe=e=>new Uint8Array(e),oBe=e=>new Uint16Array(e),xv=e=>new Uint32Array(e);function YE(e,t,n){const i=(t<257?sBe:t<65537?oBe:xv)(e);return n&&i.set(n),i}function kte(e,t,n){const i=1<<t;return{one:i,zero:~i,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(r,s){const o=this,a=o.bisect(o.range,r.value),l=r.index,u=a[0],c=a[1],d=l.length;let f;for(f=0;f<u;++f)s[l[f]]|=i;for(f=c;f<d;++f)s[l[f]]|=i;return o}}}function Ite(){let e=xv(0),t=[],n=0;return{insert:function i(a,l,u){if(!l.length)return[];const c=n,d=l.length,f=xv(d);let p,g,m,h=Array(d);for(m=0;m<d;++m)h[m]=a(l[m]),f[m]=m;if(h=function uBe(e,t){return e.sort.call(t,(n,i)=>{const r=e[n],s=e[i];return r<s?-1:r>s?1:0}),function rBe(e,t){return Array.from(t,n=>e[n])}(e,t)}(h,f),c)p=t,g=e,t=Array(c+d),e=xv(c+d),function cBe(e,t,n,i,r,s,o,a,l){let d,u=0,c=0;for(d=0;u<i&&c<o;++d)t[u]<r[c]?(a[d]=t[u],l[d]=n[u++]):(a[d]=r[c],l[d]=s[c++]+e);for(;u<i;++u,++d)a[d]=t[u],l[d]=n[u];for(;c<o;++c,++d)a[d]=r[c],l[d]=s[c]+e}(u,p,g,c,h,f,d,t,e);else{if(u>0)for(m=0;m<d;++m)f[m]+=u;t=h,e=f}return n=c+d,{index:f,value:h}},remove:function r(a,l){const u=n;let c,d,f;for(d=0;!l[e[d]]&&d<u;++d);for(f=d;d<u;++d)l[c=e[d]]||(e[f]=c,t[f]=t[d],++f);n=u-a},bisect:function o(a,l){let u;return l?u=l.length:(l=t,u=n),[dNe(l,a[0],0,u),WD(l,a[1],0,u)]},reindex:function s(a){for(let l=0,u=n;l<u;++l)e[l]=a[e[l]]},index:()=>e,size:()=>n}}function R3(e){J.call(this,function aBe(){let e=8,t=[],n=xv(0),i=YE(0,e),r=YE(0,e);return{data:()=>t,seen:()=>n=function lBe(e,t,n){return e.length>=t?e:((n=n||new e.constructor(t)).set(e),n)}(n,t.length),add(s){for(let u,o=0,a=t.length,l=s.length;o<l;++o)u=s[o],u._index=a++,t.push(u)},remove(s,o){const a=t.length,l=Array(a-s),u=t;let c,d,f;for(d=0;!o[d]&&d<a;++d)l[d]=t[d],u[d]=d;for(f=d;d<a;++d)c=t[d],o[d]?u[d]=-1:(u[d]=f,i[f]=i[d],r[f]=r[d],l[f]=c,c._index=f++),i[d]=0;return t=l,u},size:()=>t.length,curr:()=>i,prev:()=>r,reset:s=>r[s]=i[s],all:()=>e<257?255:e<65537?65535:4294967295,set(s,o){i[s]|=o},clear(s,o){i[s]&=~o},resize(s,o){(s>i.length||o>e)&&(e=Math.max(o,e),i=YE(s,e,i),r=YE(s,e))}}}(),e),this._indices=null,this._dims=null}function F3(e){J.call(this,null,e)}R3.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},fe(R3,J,{transform(e,t){return this._dims?e.modified("fields")||e.fields.some(i=>t.modified(i.fields))?this.reinit(e,t):this.eval(e,t):this.init(e,t)},init(e,t){const n=e.fields,i=e.query,r=this._indices={},s=this._dims=[],o=i.length;let l,u,a=0;for(;a<o;++a)l=n[a].fname,u=r[l]||(r[l]=Ite()),s.push(kte(u,a,i[a]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),i=e.fields,r=e.query,s=this._indices,o=this._dims,a=this.value,l=a.curr(),u=a.prev(),c=a.all(),d=n.rem=n.add,f=n.mod,h=r.length,p={};let g,m,_,y,v,b,D,C,w;if(u.set(l),t.rem.length&&(v=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(b={},y=t.mod,D=0,C=y.length;D<C;++D)b[y[D]._index]=1;for(D=0;D<h;++D)w=i[D],(!o[D]||e.modified("fields",D)||t.modified(w.fields))&&(_=w.fname,(g=p[_])||(s[_]=m=Ite(),p[_]=g=m.insert(w,t.source,0)),o[D]=kte(m,D,r[D]).onAdd(g,l));for(D=0,C=a.data().length;D<C;++D)v[D]||(u[D]!==l[D]?d.push(D):b[D]&&l[D]!==c&&f.push(D));return a.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),i=this._dims.length;let r=0;return t.rem.length&&(this.remove(e,t,n),r|=(1<<i)-1),e.modified("query")&&!e.modified("fields")&&(r|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),r|=(1<<i)-1),t.mod.length&&(this.modify(t,n),r|=(1<<i)-1),this.value.mask=r,n},insert(e,t,n){const i=t.add,r=this.value,s=this._dims,o=this._indices,a=e.fields,l={},u=n.add,c=r.size()+i.length,d=s.length;let h,p,g,f=r.size();r.resize(c,d),r.add(i);const m=r.curr(),_=r.prev(),y=r.all();for(h=0;h<d;++h)p=a[h].fname,g=l[p]||(l[p]=o[p].insert(a[h],i,f)),s[h].onAdd(g,m);for(;f<c;++f)_[f]=y,m[f]!==y&&u.push(f)},modify(e,t){const n=t.mod,i=this.value,r=i.curr(),s=i.all(),o=e.mod;let a,l,u;for(a=0,l=o.length;a<l;++a)u=o[a]._index,r[u]!==s&&n.push(u)},remove(e,t,n){const i=this._indices,r=this.value,s=r.curr(),o=r.prev(),a=r.all(),l={},u=n.rem,c=t.rem;let d,f,h,p;for(d=0,f=c.length;d<f;++d)h=c[d]._index,l[h]=1,o[h]=p=s[h],s[h]=a,p!==a&&u.push(h);for(h in i)i[h].remove(f,l);return this.reindex(t,f,l),l},reindex(e,t,n){const i=this._indices,r=this.value;e.runAfter(()=>{const s=r.remove(t,n);for(const o in i)i[o].reindex(s)})},update(e,t,n){const i=this._dims,r=e.query,s=t.stamp,o=i.length;let l,u,a=0;for(n.filters=0,u=0;u<o;++u)e.modified("query",u)&&(l=u,++a);if(1===a)a=i[l].one,this.incrementOne(i[l],r[l],n.add,n.rem);else for(u=0,a=0;u<o;++u)!e.modified("query",u)||(a|=i[u].one,this.incrementAll(i[u],r[u],s,n.add),n.rem=n.add);return a},incrementAll(e,t,n,i){const r=this.value,s=r.seen(),o=r.curr(),a=r.prev(),l=e.index(),u=e.bisect(e.range),c=e.bisect(t),d=c[0],f=c[1],h=u[0],p=u[1],g=e.one;let m,_,y;if(d<h)for(m=d,_=Math.min(h,f);m<_;++m)y=l[m],s[y]!==n&&(a[y]=o[y],s[y]=n,i.push(y)),o[y]^=g;else if(d>h)for(m=h,_=Math.min(d,p);m<_;++m)y=l[m],s[y]!==n&&(a[y]=o[y],s[y]=n,i.push(y)),o[y]^=g;if(f>p)for(m=Math.max(d,p),_=f;m<_;++m)y=l[m],s[y]!==n&&(a[y]=o[y],s[y]=n,i.push(y)),o[y]^=g;else if(f<p)for(m=Math.max(h,f),_=p;m<_;++m)y=l[m],s[y]!==n&&(a[y]=o[y],s[y]=n,i.push(y)),o[y]^=g;e.range=t.slice()},incrementOne(e,t,n,i){const s=this.value.curr(),o=e.index(),a=e.bisect(e.range),l=e.bisect(t),u=l[0],c=l[1],d=a[0],f=a[1],h=e.one;let p,g,m;if(u<d)for(p=u,g=Math.min(d,c);p<g;++p)m=o[p],s[m]^=h,n.push(m);else if(u>d)for(p=d,g=Math.min(u,f);p<g;++p)m=o[p],s[m]^=h,i.push(m);if(c>f)for(p=Math.max(u,f),g=c;p<g;++p)m=o[p],s[m]^=h,n.push(m);else if(c<f)for(p=Math.max(d,c),g=f;p<g;++p)m=o[p],s[m]^=h,i.push(m);e.range=t.slice()}}),F3.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},fe(F3,J,{transform(e,t){const n=~(e.ignore||0),i=e.filter,r=i.mask;if(0==(r&n))return t.StopPropagation;const s=t.fork(t.ALL),o=i.data(),a=i.curr(),l=i.prev(),u=c=>a[c]&n?null:o[c];return s.filter(s.MOD,u),r&r-1?(s.filter(s.ADD,c=>{const d=a[c]&n;return!d&&d^l[c]&n?o[c]:null}),s.filter(s.REM,c=>{const d=a[c]&n;return!d||d^d^l[c]&n?null:o[c]})):(s.filter(s.ADD,u),s.filter(s.REM,c=>(a[c]&n)===r?o[c]:null)),s.filter(s.SOURCE,c=>u(c._index))}});const Th="Literal",Rte="CallExpression";function Ra(e){this.type=e}var Bl,Me,Z,Dr,Kt;Ra.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=function wBe(e){switch(e.type){case"ArrayExpression":return e.elements;case"BinaryExpression":case"LogicalExpression":return[e.left,e.right];case Rte:return[e.callee].concat(e.arguments);case"ConditionalExpression":return[e.test,e.consequent,e.alternate];case"MemberExpression":return[e.object,e.property];case"ObjectExpression":return e.properties;case"Property":return[e.key,e.value];case"UnaryExpression":return[e.argument];default:return[]}}(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1},(Bl={})[1]="Boolean",Bl[2]="<end>",Bl[3]="Identifier",Bl[4]="Keyword",Bl[5]="Null",Bl[6]="Numeric",Bl[7]="Punctuator",Bl[8]="String",Bl[9]="RegularExpression";var Fte="Identifier",ji="Unexpected token %0",P3="Invalid regular expression",L3="Invalid regular expression: missing /",Pte="Octal literals are not allowed in strict mode.",Xi="ILLEGAL",Tv="Disabled.",BBe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),$Be=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function XE(e,t){if(!e)throw new Error("ASSERT: "+t)}function Ju(e){return e>=48&&e<=57}function j3(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Ov(e){return"01234567".indexOf(e)>=0}function VBe(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function Nv(e){return 10===e||13===e||8232===e||8233===e}function kv(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&BBe.test(String.fromCharCode(e))}function QE(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&$Be.test(String.fromCharCode(e))}const HBe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function Lte(){for(;Z<Dr;){const e=Me.charCodeAt(Z);if(!VBe(e)&&!Nv(e))break;++Z}}function B3(e){var t,n,i,r=0;for(n="u"===e?4:2,t=0;t<n;++t)Z<Dr&&j3(Me[Z])?(i=Me[Z++],r=16*r+"0123456789abcdef".indexOf(i.toLowerCase())):Pt({},ji,Xi);return String.fromCharCode(r)}function UBe(){var e,t;for(t=0,"}"===(e=Me[Z])&&Pt({},ji,Xi);Z<Dr&&j3(e=Me[Z++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&Pt({},ji,Xi),t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}function jte(){var e,t;for(e=Me.charCodeAt(Z++),t=String.fromCharCode(e),92===e&&(117!==Me.charCodeAt(Z)&&Pt({},ji,Xi),++Z,(!(e=B3("u"))||"\\"===e||!kv(e.charCodeAt(0)))&&Pt({},ji,Xi),t=e);Z<Dr&&QE(e=Me.charCodeAt(Z));)++Z,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==Me.charCodeAt(Z)&&Pt({},ji,Xi),++Z,(!(e=B3("u"))||"\\"===e||!QE(e.charCodeAt(0)))&&Pt({},ji,Xi),t+=e);return t}function $3(){var n,r,s,o,e=Z,t=Me.charCodeAt(Z),i=Me[Z];switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++Z,{type:7,value:String.fromCharCode(t),start:e,end:Z};default:if(61===(n=Me.charCodeAt(Z+1)))switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return Z+=2,{type:7,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:Z};case 33:case 61:return 61===Me.charCodeAt(Z+=2)&&++Z,{type:7,value:Me.slice(e,Z),start:e,end:Z}}}return">>>="===(o=Me.substr(Z,4))?{type:7,value:o,start:e,end:Z+=4}:">>>"===(s=o.substr(0,3))||"<<="===s||">>="===s?{type:7,value:s,start:e,end:Z+=3}:i===(r=s.substr(0,2))[1]&&"+-<>&|".indexOf(i)>=0||"=>"===r?{type:7,value:r,start:e,end:Z+=2}:("//"===r&&Pt({},ji,Xi),"<>=!+-*%&|^/".indexOf(i)>=0?{type:7,value:i,start:e,end:++Z}:void Pt({},ji,Xi))}function Bte(){var e,t,n;if(XE(Ju((n=Me[Z]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=Z,e="","."!==n){if(e=Me[Z++],n=Me[Z],"0"===e){if("x"===n||"X"===n)return++Z,function GBe(e){let t="";for(;Z<Dr&&j3(Me[Z]);)t+=Me[Z++];return 0===t.length&&Pt({},ji,Xi),kv(Me.charCodeAt(Z))&&Pt({},ji,Xi),{type:6,value:parseInt("0x"+t,16),start:e,end:Z}}(t);if(Ov(n))return function WBe(e){let t="0"+Me[Z++];for(;Z<Dr&&Ov(Me[Z]);)t+=Me[Z++];return(kv(Me.charCodeAt(Z))||Ju(Me.charCodeAt(Z)))&&Pt({},ji,Xi),{type:6,value:parseInt(t,8),octal:!0,start:e,end:Z}}(t);n&&Ju(n.charCodeAt(0))&&Pt({},ji,Xi)}for(;Ju(Me.charCodeAt(Z));)e+=Me[Z++];n=Me[Z]}if("."===n){for(e+=Me[Z++];Ju(Me.charCodeAt(Z));)e+=Me[Z++];n=Me[Z]}if("e"===n||"E"===n)if(e+=Me[Z++],("+"===(n=Me[Z])||"-"===n)&&(e+=Me[Z++]),Ju(Me.charCodeAt(Z)))for(;Ju(Me.charCodeAt(Z));)e+=Me[Z++];else Pt({},ji,Xi);return kv(Me.charCodeAt(Z))&&Pt({},ji,Xi),{type:6,value:parseFloat(e),start:t,end:Z}}function $te(){if(Lte(),Z>=Dr)return{type:2,start:Z,end:Z};const e=Me.charCodeAt(Z);return kv(e)?function qBe(){var e,t;return e=Z,t=92===Me.charCodeAt(Z)?jte():function zBe(){var e,t;for(e=Z++;Z<Dr;){if(92===(t=Me.charCodeAt(Z)))return Z=e,jte();if(!QE(t))break;++Z}return Me.slice(e,Z)}(),{type:1===t.length?3:HBe.hasOwnProperty(t)?4:"null"===t?5:"true"===t||"false"===t?1:3,value:t,start:e,end:Z}}():40===e||41===e||59===e?$3():39===e||34===e?function YBe(){var t,n,i,r,e="",s=!1;for(XE("'"===(t=Me[Z])||'"'===t,"String literal must starts with a quote"),n=Z,++Z;Z<Dr;){if((i=Me[Z++])===t){t="";break}if("\\"===i)if((i=Me[Z++])&&Nv(i.charCodeAt(0)))"\r"===i&&"\n"===Me[Z]&&++Z;else switch(i){case"u":case"x":"{"===Me[Z]?(++Z,e+=UBe()):e+=B3(i);break;case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Ov(i)?(0!==(r="01234567".indexOf(i))&&(s=!0),Z<Dr&&Ov(Me[Z])&&(s=!0,r=8*r+"01234567".indexOf(Me[Z++]),"0123".indexOf(i)>=0&&Z<Dr&&Ov(Me[Z])&&(r=8*r+"01234567".indexOf(Me[Z++]))),e+=String.fromCharCode(r)):e+=i}else{if(Nv(i.charCodeAt(0)))break;e+=i}}return""!==t&&Pt({},ji,Xi),{type:8,value:e,octal:s,start:n,end:Z}}():46===e?Ju(Me.charCodeAt(Z+1))?Bte():$3():Ju(e)?Bte():$3()}function vs(){const e=Kt;return Z=e.end,Kt=$te(),Z=e.end,e}function Vte(){const e=Z;Kt=$te(),Z=e}function Hte(e,t,n){const i=new Ra("||"===e||"&&"===e?"LogicalExpression":"BinaryExpression");return i.operator=e,i.left=t,i.right=n,i}function t4e(e,t){const n=new Ra("CallExpression");return n.callee=e,n.arguments=t,n}function V3(e){const t=new Ra(Fte);return t.name=e,t}function Iv(e){const t=new Ra("Literal");return t.value=e.value,t.raw=Me.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function Ute(e,t,n){const i=new Ra("MemberExpression");return i.computed="["===e,i.object=t,i.property=n,i.computed||(n.member=!0),i}function zte(e,t,n){const i=new Ra("Property");return i.key=t,i.value=n,i.kind=e,i}function Pt(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(s,o)=>(XE(o<i.length,"Message reference must be in range"),i[o]));throw(n=new Error(r)).index=Z,n.description=r,n}function ZE(e){2===e.type&&Pt(e,"Unexpected end of input"),6===e.type&&Pt(e,"Unexpected number"),8===e.type&&Pt(e,"Unexpected string"),3===e.type&&Pt(e,"Unexpected identifier"),4===e.type&&Pt(e,"Unexpected reserved word"),Pt(e,ji,e.value)}function Cr(e){const t=vs();(7!==t.type||t.value!==e)&&ZE(t)}function Dn(e){return 7===Kt.type&&Kt.value===e}function H3(e){return 4===Kt.type&&Kt.value===e}function qte(){Z=Kt.start;const e=vs();return 8===e.type||6===e.type?(e.octal&&Pt(e,Pte),Iv(e)):V3(e.value)}function o4e(){var e,t,n;return Z=Kt.start,3===(e=Kt).type?(n=qte(),Cr(":"),zte("init",n,kh())):2!==e.type&&7!==e.type?(t=qte(),Cr(":"),zte("init",t,kh())):void ZE(e)}const u4e={if:1};function c4e(){var e,t,n;if(Dn("("))return function l4e(){Cr("(");const e=U3();return Cr(")"),e}();if(Dn("["))return function s4e(){const e=[];for(Z=Kt.start,Cr("[");!Dn("]");)Dn(",")?(vs(),e.push(null)):(e.push(kh()),Dn("]")||Cr(","));return vs(),function e4e(e){const t=new Ra("ArrayExpression");return t.elements=e,t}(e)}();if(Dn("{"))return function a4e(){var t,i,e=[],r={},s=String;for(Z=Kt.start,Cr("{");!Dn("}");)i="$"+((t=o4e()).key.type===Fte?t.key.name:s(t.key.value)),Object.prototype.hasOwnProperty.call(r,i)?Pt({},"Duplicate data property in object literal not allowed in strict mode"):r[i]=!0,e.push(t),Dn("}")||Cr(",");return Cr("}"),function i4e(e){const t=new Ra("ObjectExpression");return t.properties=e,t}(e)}();if(Z=Kt.start,3===(e=Kt.type)||u4e[Kt.value])n=V3(vs().value);else if(8===e||6===e)Kt.octal&&Pt(Kt,Pte),n=Iv(vs());else{if(4===e)throw new Error(Tv);1===e?((t=vs()).value="true"===t.value,n=Iv(t)):5===e?((t=vs()).value=null,n=Iv(t)):Dn("/")||Dn("/=")?(n=Iv(function QBe(){var e,t,n,i;return Kt=null,Lte(),e=Z,t=function JBe(){var e,t,n,i;for(XE("/"===(e=Me[Z]),"Regular expression literal must start with a slash"),t=Me[Z++],n=!1,i=!1;Z<Dr;)if(t+=e=Me[Z++],"\\"===e)Nv((e=Me[Z++]).charCodeAt(0))&&Pt({},L3),t+=e;else if(Nv(e.charCodeAt(0)))Pt({},L3);else if(n)"]"===e&&(n=!1);else{if("/"===e){i=!0;break}"["===e&&(n=!0)}return i||Pt({},L3),{value:t.substr(1,t.length-2),literal:t}}(),n=function XBe(){var e,t,n;for(t="",n="";Z<Dr&&QE((e=Me[Z]).charCodeAt(0));)++Z,"\\"===e&&Z<Dr?Pt({},ji,Xi):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Pt({},P3,n),{value:n,literal:t}}(),i=function KBe(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";Pt({},P3)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(i){Pt({},P3)}try{return new RegExp(e,t)}catch(i){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:Z}}()),Vte()):ZE(vs())}return n}function d4e(){const e=[];if(Cr("("),!Dn(")"))for(;Z<Dr&&(e.push(kh()),!Dn(")"));)Cr(",");return Cr(")"),e}function p4e(){Cr("[");const e=U3();return Cr("]"),e}function Gte(){const e=function g4e(){var e;for(e=c4e();;)if(Dn("."))e=Ute(".",e,(Cr("."),function f4e(){Z=Kt.start;const e=vs();return function ZBe(e){return 3===e.type||4===e.type||1===e.type||5===e.type}(e)||ZE(e),V3(e.value)}()));else if(Dn("("))e=t4e(e,d4e());else{if(!Dn("["))break;e=Ute("[",e,p4e())}return e}();if(7===Kt.type&&(Dn("++")||Dn("--")))throw new Error(Tv);return e}function eS(){var e,t;if(7!==Kt.type&&4!==Kt.type)t=Gte();else{if(Dn("++")||Dn("--"))throw new Error(Tv);if(Dn("+")||Dn("-")||Dn("~")||Dn("!"))e=vs(),t=eS(),t=function r4e(e,t){const n=new Ra("UnaryExpression");return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if(H3("delete")||H3("void")||H3("typeof"))throw new Error(Tv);t=Gte()}}return t}function Wte(e){let t=0;if(7!==e.type&&4!==e.type)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function kh(){var e,t;return e=function m4e(){var e,t,n,i,r,s,o,a,l,u;if(e=Kt,l=eS(),0===(r=Wte(i=Kt)))return l;for(i.prec=r,vs(),t=[e,Kt],s=[l,i,o=eS()];(r=Wte(Kt))>0;){for(;s.length>2&&r<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,l=s.pop(),t.pop(),n=Hte(a,l,o),s.push(n);(i=vs()).prec=r,s.push(i),t.push(Kt),n=eS(),s.push(n)}for(n=s[u=s.length-1],t.pop();u>1;)t.pop(),n=Hte(s[u-1].value,s[u-2],n),u-=2;return n}(),Dn("?")&&(vs(),t=kh(),Cr(":"),e=function n4e(e,t,n){const i=new Ra("ConditionalExpression");return i.test=e,i.consequent=t,i.alternate=n,i}(e,t,kh())),e}function U3(){const e=kh();if(Dn(","))throw new Error(Tv);return e}function z3(e){Z=0,Dr=(Me=e).length,Kt=null,Vte();const t=U3();if(2!==Kt.type)throw new Error("Unexpect token after expression.");return t}var Yte={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function Kte(e){function n(o,a,l){return u=>function t(o,a,l,u){let c=e(a[0]);return l&&(c=l+"("+c+")",0===l.lastIndexOf("new ",0)&&(c="("+c+")")),c+"."+o+(u<0?"":0===u?"()":"("+a.slice(1).map(e).join(",")+")")}(o,u,a,l)}const i="new Date",r="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&ee("Missing arguments to clamp function."),o.length>3&&ee("Too many arguments to clamp function.");const a=o.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:n("getDate",i,0),day:n("getDay",i,0),year:n("getFullYear",i,0),month:n("getMonth",i,0),hours:n("getHours",i,0),minutes:n("getMinutes",i,0),seconds:n("getSeconds",i,0),milliseconds:n("getMilliseconds",i,0),time:n("getTime",i,0),timezoneoffset:n("getTimezoneOffset",i,0),utcdate:n("getUTCDate",i,0),utcday:n("getUTCDay",i,0),utcyear:n("getUTCFullYear",i,0),utcmonth:n("getUTCMonth",i,0),utchours:n("getUTCHours",i,0),utcminutes:n("getUTCMinutes",i,0),utcseconds:n("getUTCSeconds",i,0),utcmilliseconds:n("getUTCMilliseconds",i,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",r,0),lower:n("toLowerCase",r,0),substring:n("substring",r),split:n("split",r),trim:n("trim",r,0),regexp:s,test:n("test",s),if:function(o){o.length<3&&ee("Missing arguments to if function."),o.length>3&&ee("Too many arguments to if function.");const a=o.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function Jte(e){const t=(e=e||{}).allowed?va(e.allowed):{},n=e.forbidden?va(e.forbidden):{},i=e.constants||Yte,r=(e.functions||Kte)(d),s=e.globalvar,o=e.fieldvar,a=rt(s)?s:p=>`${s}["${p}"]`;let l={},u={},c=0;function d(p){if(be(p))return p;const g=f[p.type];return null==g&&ee("Unsupported type: "+p.type),g(p)}const f={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:ke(n,g)?ee("Illegal identifier: "+g):ke(i,g)?i[g]:ke(t,g)?g:(l[g]=1,a(g))},MemberExpression:p=>{const g=!p.computed,m=d(p.object);g&&(c+=1);const _=d(p.property);return m===o&&(u[function _4e(e){const t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}(_)]=1),g&&(c-=1),m+(g?"."+_:"["+_+"]")},CallExpression:p=>{"Identifier"!==p.callee.type&&ee("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,_=ke(r,g)&&r[g];return _||ee("Unrecognized function: "+g),rt(_)?_(m):_+"("+m.map(d).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(d).join(",")+"]",BinaryExpression:p=>"("+d(p.left)+" "+p.operator+" "+d(p.right)+")",UnaryExpression:p=>"("+p.operator+d(p.argument)+")",ConditionalExpression:p=>"("+d(p.test)+"?"+d(p.consequent)+":"+d(p.alternate)+")",LogicalExpression:p=>"("+d(p.left)+p.operator+d(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(d).join(",")+"}",Property:p=>{c+=1;const g=d(p.key);return c-=1,g+":"+d(p.value)}};function h(p){const g={code:d(p),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},g}return h.functions=r,h.constants=i,h}var Xte,Qte,q3,G3,W3,tS=new Ki,nS=new Ki,$l={point:Ji,lineStart:Ji,lineEnd:Ji,polygonStart:function(){tS=new Ki,$l.lineStart=y4e,$l.lineEnd=v4e},polygonEnd:function(){var e=+tS;nS.add(e<0?Hr+e:e),this.lineStart=this.lineEnd=this.point=Ji},sphere:function(){nS.add(Hr)}};function y4e(){$l.point=b4e}function v4e(){Zte(Xte,Qte)}function b4e(e,t){$l.point=Zte,Xte=e,Qte=t,q3=e*=ht,G3=He(t=(t*=ht)/2+QC),W3=Ie(t)}function Zte(e,t){var n=(e*=ht)-q3,i=n>=0?1:-1,r=i*n,s=He(t=(t*=ht)/2+QC),o=Ie(t),a=W3*o,l=G3*s+a*He(r),u=a*i*Ie(r);tS.add(jo(u,l)),q3=e,G3=s,W3=o}var jn,bs,Wn,no,Ih,ene,tne,Om,Rv,Rd,Xu,Qu={point:Y3,lineStart:ine,lineEnd:rne,polygonStart:function(){Qu.point=sne,Qu.lineStart=D4e,Qu.lineEnd=C4e,Rv=new Ki,$l.polygonStart()},polygonEnd:function(){$l.polygonEnd(),Qu.point=Y3,Qu.lineStart=ine,Qu.lineEnd=rne,tS<0?(jn=-(Wn=180),bs=-(no=90)):Rv>Be?no=90:Rv<-Be&&(bs=-90),Xu[0]=jn,Xu[1]=Wn},sphere:function(){jn=-(Wn=180),bs=-(no=90)}};function Y3(e,t){Rd.push(Xu=[jn=e,Wn=e]),t<bs&&(bs=t),t>no&&(no=t)}function nne(e,t){var n=mh([e*ht,t*ht]);if(Om){var i=pm(Om,n),s=pm([i[1],-i[0],0],i);fE(s),s=uE(s);var u,o=e-Ih,a=o>0?1:-1,l=s[0]*ii*a,c=St(o)>180;c^(a*Ih<l&&l<a*e)?(u=s[1]*ii)>no&&(no=u):c^(a*Ih<(l=(l+360)%360-180)&&l<a*e)?(u=-s[1]*ii)<bs&&(bs=u):(t<bs&&(bs=t),t>no&&(no=t)),c?e<Ih?io(jn,e)>io(jn,Wn)&&(Wn=e):io(e,Wn)>io(jn,Wn)&&(jn=e):Wn>=jn?(e<jn&&(jn=e),e>Wn&&(Wn=e)):e>Ih?io(jn,e)>io(jn,Wn)&&(Wn=e):io(e,Wn)>io(jn,Wn)&&(jn=e)}else Rd.push(Xu=[jn=e,Wn=e]);t<bs&&(bs=t),t>no&&(no=t),Om=n,Ih=e}function ine(){Qu.point=nne}function rne(){Xu[0]=jn,Xu[1]=Wn,Qu.point=Y3,Om=null}function sne(e,t){if(Om){var n=e-Ih;Rv.add(St(n)>180?n+(n>0?360:-360):n)}else ene=e,tne=t;$l.point(e,t),nne(e,t)}function D4e(){$l.lineStart()}function C4e(){sne(ene,tne),$l.lineEnd(),St(Rv)>Be&&(jn=-(Wn=180)),Xu[0]=jn,Xu[1]=Wn,Om=null}function io(e,t){return(t-=e)<0?t+360:t}function E4e(e,t){return e[0]-t[0]}function one(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var Fv,iS,rS,sS,oS,aS,lS,uS,K3,J3,X3,ane,lne,Xr,Qr,Zr,Fa={sphere:Ji,point:Q3,lineStart:une,lineEnd:cne,polygonStart:function(){Fa.lineStart=M4e,Fa.lineEnd=T4e},polygonEnd:function(){Fa.lineStart=une,Fa.lineEnd=cne}};function Q3(e,t){e*=ht;var n=He(t*=ht);Pv(n*He(e),n*Ie(e),Ie(t))}function Pv(e,t,n){++Fv,rS+=(e-rS)/Fv,sS+=(t-sS)/Fv,oS+=(n-oS)/Fv}function une(){Fa.point=x4e}function x4e(e,t){e*=ht;var n=He(t*=ht);Xr=n*He(e),Qr=n*Ie(e),Zr=Ie(t),Fa.point=A4e,Pv(Xr,Qr,Zr)}function A4e(e,t){e*=ht;var n=He(t*=ht),i=n*He(e),r=n*Ie(e),s=Ie(t),o=jo(Ur((o=Qr*s-Zr*r)*o+(o=Zr*i-Xr*s)*o+(o=Xr*r-Qr*i)*o),Xr*i+Qr*r+Zr*s);iS+=o,aS+=o*(Xr+(Xr=i)),lS+=o*(Qr+(Qr=r)),uS+=o*(Zr+(Zr=s)),Pv(Xr,Qr,Zr)}function cne(){Fa.point=Q3}function M4e(){Fa.point=O4e}function T4e(){dne(ane,lne),Fa.point=Q3}function O4e(e,t){ane=e,lne=t,e*=ht,t*=ht,Fa.point=dne;var n=He(t);Xr=n*He(e),Qr=n*Ie(e),Zr=Ie(t),Pv(Xr,Qr,Zr)}function dne(e,t){e*=ht;var n=He(t*=ht),i=n*He(e),r=n*Ie(e),s=Ie(t),o=Qr*s-Zr*r,a=Zr*i-Xr*s,l=Xr*r-Qr*i,u=IF(o,a,l),c=gs(u),d=u&&-c/u;K3.add(d*o),J3.add(d*a),X3.add(d*l),iS+=c,aS+=c*(Xr+(Xr=i)),lS+=c*(Qr+(Qr=r)),uS+=c*(Zr+(Zr=s)),Pv(Xr,Qr,Zr)}function fne(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function F4e(e){return e instanceof iC?e:new iC(e)}const Z3="intersect",Vl="_vgsid_",Lv=ls(Vl),cS="index:unit";function gne(e,t){for(var o,a,n=t.fields,i=t.values,r=n.length,s=0;s<r;++s)if((a=n[s]).getter=ls.getter||ls(a.field),zc(o=a.getter(e))&&(o=pr(o)),zc(i[s])&&(i[s]=pr(i[s])),zc(i[s][0])&&(i[s]=i[s].map(pr)),"E"===a.type){if(ne(i[s])?i[s].indexOf(o)<0:o!==i[s])return!1}else if("R"===a.type){if(!kg(o,i[s]))return!1}else if("R-RE"===a.type){if(!kg(o,i[s],!0,!1))return!1}else if("R-E"===a.type){if(!kg(o,i[s],!1,!1))return!1}else if("R-LE"===a.type&&!kg(o,i[s],!1,!0))return!1;return!0}const mne=function k4e(e){let t=e,n=e,i=e;function r(a,l,u=0,c=a.length){if(u<c){if(0!==n(l,l))return c;do{const d=u+c>>>1;i(a[d],l)<0?u=d+1:c=d}while(u<c)}return u}return 2!==e.length&&(t=(a,l)=>e(a)-l,n=fne,i=(a,l)=>fne(e(a),l)),{left:r,center:function o(a,l,u=0,c=a.length){const d=r(a,l,u,c-1);return d>u&&t(a[d-1],l)>-t(a[d],l)?d-1:d},right:function s(a,l,u=0,c=a.length){if(u<c){if(0!==n(l,l))return c;do{const d=u+c>>>1;i(a[d],l)<=0?u=d+1:c=d}while(u<c)}return u}}}(Lv),q4e=mne.left,G4e=mne.right;var eL={["".concat(Vl,"_union")]:function I4e(...e){const t=new iC;for(const n of e)for(const i of n)t.add(i);return t},["".concat(Vl,"_intersect")]:function R4e(e,...t){e=new iC(e),t=t.map(F4e);e:for(const n of e)for(const i of t)if(!i.has(n)){e.delete(n);continue e}return e},E_union:function(e,t){if(!e.length)return t;for(var n=0,i=t.length;n<i;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=pr(t[0]),i=pr(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<i&&(e[1]=i),e):[n,i]},R_intersect:function(e,t){var n=pr(t[0]),i=pr(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?i<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>i&&(e[1]=i),e):[n,i]}};function tL(e,t,n,i){t[0].type!==Th&&ee("First argument to selection functions must be a string literal.");const r=t[0].value,o="unit",a="@"+o,l=":"+r;(t.length>=2&&bt(t).value)===Z3&&!ke(i,a)&&(i[a]=n.getData(r).indataRef(n,o)),ke(i,l)||(i[l]=n.getData(r).tuplesRef())}function _ne(e){const t=this.context.data[e];return t?t.values.value:[]}const jv=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},t8e=jv("format"),yne=jv("timeFormat"),n8e=jv("utcFormat"),i8e=jv("timeParse"),r8e=jv("utcParse"),dS=new Date(2e3,0,1);function fS(e,t,n){return Number.isInteger(e)&&Number.isInteger(t)?(dS.setYear(2e3),dS.setMonth(e),dS.setDate(t),yne.call(this,dS,n)):""}function iL(e,t,n,i){t[0].type!==Th&&ee("First argument to data functions must be a string literal.");const r=t[0].value,s=":"+r;if(!ke(s,i))try{i[s]=n.getData(r).tuplesRef()}catch(o){}}function ws(e,t,n,i){if(t[0].type===Th)bne(n,i,t[0].value);else for(e in n.scales)bne(n,i,e)}function bne(e,t,n){const i="%"+n;if(!ke(t,i))try{t[i]=e.scaleRef(n)}catch(r){}}function Zu(e,t){let n;return rt(e)?e:be(e)?(n=t.scales[e])&&n.value:void 0}function rL(e,t){return function(n,i,r){if(n){const s=Zu(n,(r||this).context);return s&&s.path[e](i)}return t(i)}}const h8e=rL("area",function w4e(e){return nS=new Ki,Gu(e,$l),2*nS}),p8e=rL("bounds",function S4e(e){var t,n,i,r,s,o,a;if(no=Wn=-(jn=bs=1/0),Rd=[],Gu(e,Qu),n=Rd.length){for(Rd.sort(E4e),t=1,s=[i=Rd[0]];t<n;++t)one(i,(r=Rd[t])[0])||one(i,r[1])?(io(i[0],r[1])>io(i[0],i[1])&&(i[1]=r[1]),io(r[0],i[1])>io(i[0],i[1])&&(i[0]=r[0])):s.push(i=r);for(o=-1/0,t=0,i=s[n=s.length-1];t<=n;i=r,++t)(a=io(i[1],(r=s[t])[0]))>o&&(o=a,jn=r[0],Wn=i[1])}return Rd=Xu=null,jn===1/0||bs===1/0?[[NaN,NaN],[NaN,NaN]]:[[jn,bs],[Wn,no]]}),g8e=rL("centroid",function N4e(e){Fv=iS=rS=sS=oS=aS=lS=uS=0,K3=new Ki,J3=new Ki,X3=new Ki,Gu(e,Fa);var t=+K3,n=+J3,i=+X3,r=IF(t,n,i);return r<XC&&(t=aS,n=lS,i=uS,iS<Be&&(t=rS,n=sS,i=oS),(r=IF(t,n,i))<XC)?[NaN,NaN]:[jo(n,t)*ii,gs(i/r)*ii]});function sL(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(i){e.warn(i)}return n[n.length-1]}function oL(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function aL(e){const t=od(e);return.2126*oL(t.r)+.7152*oL(t.g)+.0722*oL(t.b)}function wne(e,t){return e===t||e!=e&&t!=t||(ne(e)?!(!ne(t)||e.length!==t.length)&&function D8e(e,t){for(let n=0,i=e.length;n<i;++n)if(!wne(e[n],t[n]))return!1;return!0}(e,t):!(!Se(e)||!Se(t))&&Dne(e,t))}function Dne(e,t){for(const n in e)if(!wne(e[n],t[n]))return!1;return!0}function Cne(e){return t=>Dne(e,t)}const Ene={};function lL(e){return ne(e)||ArrayBuffer.isView(e)?e:null}function uL(e){return lL(e)||(be(e)?e:null)}const Sne=e=>e.data;function xne(e,t){const n=_ne.call(t,e);return n.root&&n.root.lookup||{}}const Ane=()=>"undefined"!=typeof window&&window||null;function Mne(e,t,n){if(!e)return[];const[i,r]=e,s=(new di).set(i[0],i[1],r[0],r[1]);return mQ(n||this.context.dataflow.scenegraph().root,s,function Y8e(e){let t=null;if(e){const n=we(e.marktype),i=we(e.markname);t=r=>(!n.length||n.some(s=>r.marktype===s))&&(!i.length||i.some(s=>r.name===s))}return t}(t))}const Bv={random:()=>Io(),cumulativeNormal:RD,cumulativeLogNormal:zk,cumulativeUniform:Yk,densityNormal:Bk,densityLogNormal:Uk,densityUniform:Wk,quantileNormal:FD,quantileLogNormal:qk,quantileUniform:Kk,sampleNormal:ID,sampleLogNormal:Hk,sampleUniform:Gk,isArray:ne,isBoolean:Uc,isDate:zc,isDefined:e=>void 0!==e,isNumber:en,isObject:Se,isRegExp:sG,isString:be,isTuple:SD,isValid:e=>null!=e&&e==e,toBoolean:NN,toDate:e=>kN(e),toNumber:pr,toString:IN,indexof:function M8e(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return uL(e).indexOf(...n)},join:function A8e(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return lL(e).join(...n)},lastindexof:function T8e(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return uL(e).lastIndexOf(...n)},replace:function N8e(e,t,n){return rt(n)&&ee("Function argument passed to replace."),String(e).replace(t,n)},reverse:function k8e(e){return lL(e).slice().reverse()},slice:function O8e(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return uL(e).slice(...n)},flush:iG,lerp:oG,merge:function w8e(){const e=[].slice.call(arguments);return e.unshift({}),st(...e)},pad:uG,peek:bt,pluck:function x8e(e,t){const n=Ene[t]||(Ene[t]=ls(t));return ne(e)?e.map(n):n(e)},span:Q_,inrange:kg,truncate:cG,rgb:od,lab:oC,hcl:aC,hsl:JD,luminance:aL,contrast:function b8e(e,t){const n=aL(e),i=aL(t);return(Math.max(n,i)+.05)/(Math.min(n,i)+.05)},sequence:Ys,format:t8e,utcFormat:n8e,utcParse:r8e,utcOffset:JG,utcSequence:ZG,timeFormat:yne,timeParse:i8e,timeOffset:KG,timeSequence:QG,timeUnitSpecifier:jG,monthFormat:function s8e(e){return fS.call(this,e,1,"%B")},monthAbbrevFormat:function o8e(e){return fS.call(this,e,1,"%b")},dayFormat:function a8e(e){return fS.call(this,0,2+e,"%A")},dayAbbrevFormat:function l8e(e){return fS.call(this,0,2+e,"%a")},quarter:Zq,utcquarter:eG,week:$G,utcweek:UG,dayofyear:BG,utcdayofyear:HG,warn:function _8e(){return sL(this.context.dataflow,"warn",arguments)},info:function y8e(){return sL(this.context.dataflow,"info",arguments)},debug:function v8e(){return sL(this.context.dataflow,"debug",arguments)},extent:e=>wl(e),inScope:function m8e(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n},intersect:Mne,clampRange:tG,pinchDistance:function E8e(e){const t=e.touches,n=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+i*i)},pinchAngle:function S8e(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)},screen:function q8e(){const e=Ane();return e?e.screen:{}},containerSize:function W8e(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]},windowSize:function G8e(){const e=Ane();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]},bandspace:function I8e(e,t,n){return fR(e||0,t||0,n||0)},setdata:function Z4e(e,t){const n=this.context.dataflow;return n.pulse(this.context.data[e].input,n.changeset().remove(Oo).insert(t)),1},pathShape:function H8e(e){let t=null;return function(n){return n?Ry(n,t=t||tm(e)):e}},panLinear:Kq,panLog:Jq,panPow:Xq,panSymlog:Qq,zoomLinear:SN,zoomLog:xN,zoomPow:aD,zoomSymlog:AN,encode:function e8e(e,t,n){if(e){const i=this.context.dataflow;i.pulse(e.mark.source,i.changeset().encode(e,t))}return void 0!==n?n:e},modify:function C8e(e,t,n,i,r,s){const o=this.context.dataflow,a=this.context.data[e],l=a.input,u=o.stamp();let d,f,c=a.changes;if(!1===o._trigger||!(l.value.length||t||i))return 0;if((!c||c.stamp<u)&&(a.changes=c=o.changeset(),c.stamp=u,o.runAfter(()=>{a.modified=!0,o.pulse(l,c).run()},!0,1)),n&&(d=!0===n?Oo:ne(n)||SD(n)?n:Cne(n),c.remove(d)),t&&c.insert(t),i&&(d=Cne(i),l.value.some(d)?c.remove(d):c.insert(i)),r)for(f in s)c.modify(r,f,s[f]);return 1},lassoAppend:function K8e(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;const r=e[e.length-1];return void 0===r||Math.sqrt((r[0]-t)**2+(r[1]-n)**2)>i?(e.push([t,n]),[...e]):e},lassoPath:function J8e(e){return(null!=e?e:[]).reduce((t,n,i)=>{let[r,s]=n;return t+(0==i?"M ".concat(r,",").concat(s," "):i===e.length-1?" Z":"L ".concat(r,",").concat(s," "))},"")},intersectLasso:function X8e(e,t,n){const{x:i,y:r,mark:s}=n,o=(new di).set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[l,u]of t)l<o.x1&&(o.x1=l),l>o.x2&&(o.x2=l),u<o.y1&&(o.y1=u),u>o.y2&&(o.y2=u);return o.translate(i,r),Mne([[o.x1,o.y1],[o.x2,o.y2]],e,s).filter(l=>function Q8e(e,t,n){let i=0;for(let r=0,s=n.length-1;r<n.length;s=r++){const[o,a]=n[s],[l,u]=n[r];u>t!=a>t&&e<(o-l)*(t-u)/(a-u)+l&&i++}return 1&i}(l.x,l.y,t))}},Z8e=["view","item","group","xy","x","y"],cL={},One={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>"_[".concat(pe("$"+e),"]"),functions:function t$e(e){const t=Kte(e);Z8e.forEach(n=>t[n]="event.vega."+n);for(const n in Bv)t[n]="this."+n;return st(t,function f8e(e,t,n){t.__bandwidth=r=>r&&r.bandwidth?r.bandwidth():0,n._bandwidth=ws,n._range=ws,n._scale=ws;const i=r=>"_["+(r.type===Th?pe("%"+r.value):pe("%")+"+"+e(r))+"]";return{_bandwidth:r=>"this.__bandwidth(".concat(i(r[0]),")"),_range:r=>"".concat(i(r[0]),".range()"),_scale:r=>"".concat(i(r[0]),"(").concat(e(r[1]),")")}}(e,Bv,cL)),t},constants:Yte,visitors:cL},dL=Jte(One);function fi(e,t,n){return 1===arguments.length?Bv[e]:(Bv[e]=t,n&&(cL[e]=n),dL&&(dL.functions[e]="this."+e),this)}function Hl(e,t){const n={};let i;try{i=z3(e=be(e)?e:pe(e)+"")}catch(s){ee("Expression parse error: "+e)}i.visit(s=>{if(s.type!==Rte)return;const o=s.callee.name,a=One.visitors[o];a&&a(o,s.arguments,t,n)});const r=dL(i);return r.globals.forEach(s=>{const o="$"+s;!ke(n,o)&&t.getSignal(s)&&(n[o]=t.signalRef(s))}),{$expr:st({code:r.code},t.options.ast?{ast:i}:null),$fields:r.fields,$params:n}}fi("bandwidth",function R8e(e,t){const n=Zu(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0},ws),fi("copy",function F8e(e,t){const n=Zu(e,(t||this).context);return n?n.copy():void 0},ws),fi("domain",function P8e(e,t){const n=Zu(e,(t||this).context);return n?n.domain():[]},ws),fi("range",function j8e(e,t){const n=Zu(e,(t||this).context);return n&&n.range?n.range():[]},ws),fi("invert",function L8e(e,t,n){const i=Zu(e,(n||this).context);return i?ne(t)?(i.invertRange||i.invert)(t):(i.invert||i.invertExtent)(t):void 0},ws),fi("scale",function B8e(e,t,n){const i=Zu(e,(n||this).context);return i?i(t):void 0},ws),fi("gradient",function $8e(e,t,n,i,r){e=Zu(e,(r||this).context);const s=nX(t,n);let o=e.domain(),a=o[0],l=bt(o),u=hr;return l-a?u=VJ(e,a,l):e=(e.interpolator?Ft("sequential")().interpolator(e.interpolator()):Ft("linear")().interpolate(e.interpolate()).range(e.range())).domain([a=0,l=1]),e.ticks&&(o=e.ticks(+i||15),a!==o[0]&&o.unshift(a),l!==bt(o)&&o.push(l)),o.forEach(c=>s.stop(u(c),e(c))),s},ws),fi("geoArea",h8e,ws),fi("geoBounds",p8e,ws),fi("geoCentroid",g8e,ws),fi("geoShape",function V8e(e,t,n){const i=Zu(e,(n||this).context);return function(r){return i?i.path.context(r)(t):""}},ws),fi("indata",function Q4e(e,t,n){const i=this.context.data[e]["index:"+t],r=i?i.value.get(n):void 0;return r&&r.count},function d8e(e,t,n,i){t[0].type!==Th&&ee("First argument to indata must be a string literal."),t[1].type!==Th&&ee("Second argument to indata must be a string literal.");const r=t[0].value,s=t[1].value,o="@"+s;ke(o,i)||(i[o]=n.getData(r).indataRef(n,s))}),fi("data",_ne,iL),fi("treePath",function U8e(e,t,n){const i=xne(e,this),r=i[t],s=i[n];return r&&s?r.path(s).map(Sne):void 0},iL),fi("treeAncestors",function z8e(e,t){const n=xne(e,this)[t];return n?n.ancestors().map(Sne):void 0},iL),fi("vlSelectionTest",function z4e(e,t,n){for(var u,c,d,f,h,i=this.context.data[e],r=i?i.values.value:[],s=i?i[cS]&&i[cS].value:void 0,o=n===Z3,a=r.length,l=0;l<a;++l)if(u=r[l],s&&o){if(-1===(d=(c=c||{})[f=u.unit]||0))continue;if(h=gne(t,u),c[f]=h?-1:++d,h&&1===s.size)return!0;if(!h&&d===s.get(f).count)return!1}else if(o^(h=gne(t,u)))return h;return a&&o},tL),fi("vlSelectionIdTest",function W4e(e,t,n){const i=this.context.data[e],r=i?i.values.value:[],s=i?i[cS]&&i[cS].value:void 0,o=n===Z3,a=Lv(t),l=q4e(r,a);if(l===r.length||Lv(r[l])!==a)return!1;if(s&&o){if(1===s.size)return!0;if(G4e(r,a)-l<s.size)return!1}return!0},tL),fi("vlSelectionResolve",function K4e(e,t,n,i){for(var u,c,d,f,h,p,g,m,_,y,D,C,r=this.context.data[e],s=r?r.values.value:[],o={},a={},l={},v=s.length,b=0;b<v;++b)if(f=(u=s[b]).unit,d=u.values,(c=u.fields)&&d){for(D=0,C=c.length;D<C;++D)m=(g=o[(h=c[D]).field]||(o[h.field]={}))[f]||(g[f]=[]),l[h.field]=_=h.type.charAt(0),y=eL["".concat(_,"_union")],g[f]=y(m,we(d[D]));n&&(m=a[f]||(a[f]=[])).push(we(d).reduce((w,E,T)=>(w[c[T].field]=E,w),{}))}else h=Vl,p=Lv(u),(m=(g=o[h]||(o[h]={}))[f]||(g[f]=[])).push(p),n&&(m=a[f]||(a[f]=[])).push({[Vl]:p});return t=t||"union",o[Vl]?o[Vl]=eL["".concat(Vl,"_").concat(t)](...Object.values(o[Vl])):Object.keys(o).forEach(w=>{o[w]=Object.keys(o[w]).map(E=>o[w][E]).reduce((E,T)=>void 0===E?T:eL["".concat(l[w],"_").concat(t)](E,T))}),s=Object.keys(a),n&&s.length&&(o[i?"vlPoint":"vlMulti"]="union"===t?{or:s.reduce((E,T)=>(E.push(...a[T]),E),[])}:{and:s.map(E=>({or:a[E]}))}),o},tL),fi("vlSelectionTuples",function Y4e(e,t){return e.map(n=>st(t.fields?{values:t.fields.map(i=>(i.getter||(i.getter=ls(i.field)))(n.datum))}:{[Vl]:Lv(n.datum)},t))});const i$e=va(["rule"]),Nne=va(["group","image","rect"]);function fL(e){return(e+"").toLowerCase()}function $v(e,t,n){";"!==n[n.length-1]&&(n="return("+n+");");const i=Function(...t.concat(n));return e&&e.functions?i.bind(e.functions):i}var l$e={operator:(e,t)=>$v(e,["_"],t.code),parameter:(e,t)=>$v(e,["datum","_"],t.code),event:(e,t)=>$v(e,["event"],t.code),handler:(e,t)=>$v(e,["_","event"],"var datum=event.item&&event.item.datum;return ".concat(t.code,";")),encode:(e,t)=>{const{marktype:n,channels:i}=t;let r="var o=item,datum=o.datum,m=0,$;";for(const s in i){const o="o["+pe(s)+"]";r+="$=".concat(i[s].code,";if(").concat(o,"!==$)").concat(o,"=$,m=1;")}return r+=function r$e(e,t){let n="";return i$e[t]||(e.x2&&(e.x?(Nne[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(Nne[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(i,n),r+="return m;",$v(e,["item","_"],r)},codegen:{get(e){const t="[".concat(e.map(pe).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator(e,t){let n;const r=Function("a","b","var u, v; return "+e.map((s,o)=>{const a=t[o];let l,u;return s.path?(l="a".concat(s.path),u="b".concat(s.path)):((n=n||{})["f"+o]=s,l="this.f".concat(o,"(a)"),u="this.f".concat(o,"(b)")),function a$e(e,t,n,i){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(i,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(i," : ")}(l,u,-a,a)}).join("")+"0;");return n?r.bind(n):r}}};function kne(e,t,n){if(!e||!Se(e))return e;for(let s,i=0,r=Ine.length;i<r;++i)if(s=Ine[i],ke(e,s.key))return s.parse(e,t,n);return e}var Ine=[{key:"$ref",parse:function f$e(e,t){return t.get(e.$ref)||ee("Operator not defined: "+e.$ref)}},{key:"$key",parse:function p$e(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=ON(e.$key,e.$flat,t.expr.codegen))}},{key:"$expr",parse:function h$e(e,t,n){e.$params&&t.parseParameters(e.$params,n);const i="e:"+e.$expr.code+"_"+e.$name;return t.fn[i]||(t.fn[i]=as(t.parameterExpression(e.$expr),e.$fields,e.$name))}},{key:"$field",parse:function g$e(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=ls(e.$field,e.$name,t.expr.codegen))}},{key:"$encode",parse:function _$e(e,t){const n=e.$encode,i={};for(const r in n){const s=n[r];i[r]=as(t.encodeExpression(s.$expr),s.$fields),i[r].output=s.$output}return i}},{key:"$compare",parse:function m$e(e,t){const n="c:"+e.$compare+"_"+e.$order,i=we(e.$compare).map(r=>r&&r.$tupleid?Pe:r);return t.fn[n]||(t.fn[n]=MN(i,e.$order,t.expr.codegen))}},{key:"$context",parse:function y$e(e,t){return t}},{key:"$subflow",parse:function v$e(e,t){const n=e.$subflow;return function(i,r,s){const o=t.fork().parse(n),a=o.get(n.operators[0].id),l=o.signals.parent;return l&&l.set(s),a.detachSubflow=()=>t.detach(o),a}}},{key:"$tupleid",parse:function b$e(){return Pe}}];const C$e={skip:!0};function Rne(e,t,n,i){return new Fne(e,t,n,i)}function Fne(e,t,n,i){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=i||l$e,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function Pne(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}function Lne(e,t){e&&(null==t?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}Fne.prototype=Pne.prototype={fork(){const e=new Pne(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,i=n.dataflow,r=e.value;if(n.set(e.id,t),function o$e(e){return"collect"===fL(e)}(e.type)&&r&&(r.$ingest?i.ingest(t,r.$ingest,r.$format):r.$request?i.preload(t,r.$request,r.$format):i.pulse(t,i.changeset().insert(r))),e.root&&(n.root=t),e.parent){let s=n.get(e.parent.$ref);s?(i.connect(s,[t]),t.targets().add(s)):(n.unresolved=n.unresolved||[]).push(()=>{s=n.get(e.parent.$ref),i.connect(s,[t]),t.targets().add(s)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const s in e.data){const o=n.data[s]||(n.data[s]={});e.data[s].forEach(a=>o[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[fL(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,i,r){this.dataflow.on(t,n,i,r,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:function n$e(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(i=>t.parseOperator(i)),n.forEach(i=>t.parseOperatorParameters(i)),(e.streams||[]).forEach(i=>t.parseStream(i)),(e.updates||[]).forEach(i=>t.parseUpdate(i)),t.resolve()},parseOperator:function u$e(e){const t=this;!function s$e(e){return"operator"===fL(e)}(e.type)&&e.type?t.transform(e,e.type):t.operator(e,e.update?t.operatorExpression(e.update):null)},parseOperatorParameters:function c$e(e){const t=this;if(e.params){const n=t.get(e.id);n||ee("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}},parseParameters:function d$e(e,t){t=t||{};const n=this;for(const i in e){const r=e[i];t[i]=ne(r)?r.map(s=>kne(s,n,t)):kne(r,n,t)}return t},parseStream:function w$e(e){var r,t=this,n=null!=e.filter?t.eventExpression(e.filter):void 0,i=null!=e.stream?t.get(e.stream):void 0;e.source?i=t.events(e.source,e.type,n):e.merge&&(i=(r=e.merge.map(s=>t.get(s)))[0].merge.apply(r[0],r.slice(1))),e.between&&(r=e.between.map(s=>t.get(s)),i=i.between(r[0],r[1])),e.filter&&(i=i.filter(n)),null!=e.throttle&&(i=i.throttle(+e.throttle)),null!=e.debounce&&(i=i.debounce(+e.debounce)),null==i&&ee("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),t.stream(e,i)},parseUpdate:function D$e(e){var r,t=this,n=Se(n=e.source)?n.$ref:n,i=t.get(n),s=e.update,o=void 0;i||ee("Source not defined: "+e.source),r=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),s&&s.$expr&&(s.$params&&(o=t.parseParameters(s.$params)),s=t.handlerExpression(s.$expr)),t.update(e,i,r,s,o)},getState:function E$e(e){var t=this,n={};if(e.signals){var i=n.signals={};Object.keys(t.signals).forEach(s=>{const o=t.signals[s];e.signals(s,o)&&(i[s]=o.value)})}if(e.data){var r=n.data={};Object.keys(t.data).forEach(s=>{const o=t.data[s];e.data(s,o)&&(r[s]=o.input.value)})}return t.subcontext&&!1!==e.recurse&&(n.subcontext=t.subcontext.map(s=>s.getState(e))),n},setState:function S$e(e){var t=this,n=t.dataflow,i=e.data,r=e.signals;Object.keys(r||{}).forEach(s=>{n.update(t.signals[s],r[s],C$e)}),Object.keys(i||{}).forEach(s=>{n.pulse(t.data[s].input,n.changeset().remove(Oo).insert(i[s]))}),(e.subcontext||[]).forEach((s,o)=>{const a=t.subcontext[o];a&&a.setState(s)})}};const hL="default";function pL(e,t){const n=e.globalCursor()?"undefined"!=typeof document&&document.body:e.container();if(n)return null==t?n.style.removeProperty("cursor"):n.style.cursor=t}function hS(e,t){var n=e._runtime.data;return ke(n,t)||ee("Unrecognized data set: "+t),n[t]}function pS(e,t){VW(t)||ee("Second argument to changes must be a changeset.");const n=hS(this,e);return n.modified=!0,this.pulse(n.input,t)}function jne(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function Bne(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function gS(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}const j$e={trap:!1};function Vne(e,t,n,i){e._eventListeners.push({type:n,sources:we(t),handler:i})}function mS(e,t,n){const i=e._eventConfig&&e._eventConfig[t];return!(!1===i||Se(i)&&!i[n])||(e.warn("Blocked ".concat(t," ").concat(n," event listener.")),!1)}function Hne(e){return e.item}function Une(e){return e.item.mark.source}function zne(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function ro(e,t,n){const i=document.createElement(e);for(const r in t)i.setAttribute(r,t[r]);return null!=n&&(i.textContent=n),i}function W$e(e,t,n){if(!t)return;const i=n.param;let r=n.state;return r||(r=n.state={elements:null,active:!1,set:null,update:o=>{o!=e.signal(i.signal)&&e.runAsync(null,()=>{r.source=!0,e.signal(i.signal,o)})}},i.debounce&&(r.update=TN(i.debounce,r.update))),(null==i.input&&i.element?Y$e:J$e)(r,t,i,e),r.active||(e.on(e._signals[i.signal],null,()=>{r.source?r.source=!1:r.set(e.signal(i.signal))}),r.active=!0),r}function Y$e(e,t,n,i){const r=n.event||"input",s=()=>e.update(t.value);i.signal(n.signal,t.value),t.addEventListener(r,s),Vne(i,t,r,s),e.set=o=>{t.value=o,t.dispatchEvent(function K$e(e){return"undefined"!=typeof Event?new Event(e):{type:e}}(r))}}function J$e(e,t,n,i){const r=i.signal(n.signal),s=ro("div",{class:"vega-bind"}),o="radio"===n.input?s:s.appendChild(ro("label"));o.appendChild(ro("span",{class:"vega-bind-name"},n.name||n.signal)),t.appendChild(s);let a=X$e;switch(n.input){case"checkbox":a=Q$e;break;case"select":a=Z$e;break;case"radio":a=e6e;break;case"range":a=t6e}a(e,o,n,r)}function X$e(e,t,n,i){const r=ro("input");for(const s in n)"signal"!==s&&"element"!==s&&r.setAttribute("input"===s?"type":s,n[s]);r.setAttribute("name",n.signal),r.value=i,t.appendChild(r),r.addEventListener("input",()=>e.update(r.value)),e.elements=[r],e.set=s=>r.value=s}function Q$e(e,t,n,i){const r={type:"checkbox",name:n.signal};i&&(r.checked=!0);const s=ro("input",r);t.appendChild(s),s.addEventListener("change",()=>e.update(s.checked)),e.elements=[s],e.set=o=>s.checked=!!o||null}function Z$e(e,t,n,i){const r=ro("select",{name:n.signal}),s=n.labels||[];n.options.forEach((o,a)=>{const l={value:o};_S(o,i)&&(l.selected=!0),r.appendChild(ro("option",l,(s[a]||o)+""))}),t.appendChild(r),r.addEventListener("change",()=>{e.update(n.options[r.selectedIndex])}),e.elements=[r],e.set=o=>{for(let a=0,l=n.options.length;a<l;++a)if(_S(n.options[a],o))return void(r.selectedIndex=a)}}function e6e(e,t,n,i){const r=ro("span",{class:"vega-bind-radio"}),s=n.labels||[];t.appendChild(r),e.elements=n.options.map((o,a)=>{const l={type:"radio",name:n.signal,value:o};_S(o,i)&&(l.checked=!0);const u=ro("input",l);u.addEventListener("change",()=>e.update(o));const c=ro("label",{},(s[a]||o)+"");return c.prepend(u),r.appendChild(c),u}),e.set=o=>{const a=e.elements,l=a.length;for(let u=0;u<l;++u)_S(a[u].value,o)&&(a[u].checked=!0)}}function t6e(e,t,n,i){i=void 0!==i?i:(+n.max+ +n.min)/2;const r=null!=n.max?n.max:Math.max(100,+i)||100,s=n.min||Math.min(0,r,+i)||0,o=n.step||Gc(s,r,100),a=ro("input",{type:"range",name:n.signal,min:s,max:r,step:o});a.value=i;const l=ro("span",{},+i);t.appendChild(a),t.appendChild(l);const u=()=>{l.textContent=a.value,e.update(+a.value)};a.addEventListener("input",u),a.addEventListener("change",u),e.elements=[a],e.set=c=>{a.value=c,l.textContent=c}}function _S(e,t){return e===t||e+""==t+""}function qne(e,t,n,i,r,s){return(t=t||new i(e.loader())).initialize(n,jne(e),Bne(e),gS(e),r,s).background(e.background())}function gL(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function mL(e,t,n){if("string"==typeof t){if("undefined"==typeof document)return e.error("DOM document instance not found."),null;if(!(t=document.querySelector(t)))return e.error("Signal bind element not found: "+t),null}if(t&&n)try{t.textContent=""}catch(i){t=null,e.error(i)}return t}const Vv=e=>+e||0;function Gne(e){return Se(e)?{top:Vv(e.top),bottom:Vv(e.bottom),left:Vv(e.left),right:Vv(e.right)}:(e=>({top:e,bottom:e,left:e,right:e}))(Vv(e))}function _L(e,t,n,i){return yL.apply(this,arguments)}function yL(){return yL=Br(function*(e,t,n,i){const r=zC(t),s=r&&r.headless;return s||ee("Unrecognized renderer type: "+t),yield e.runAsync(),qne(e,null,null,s,n,i).renderAsync(e._scenegraph.root)}),yL.apply(this,arguments)}function vL(){return vL=Br(function*(e,t){e!==vd.Canvas&&e!==vd.SVG&&e!==vd.PNG&&ee("Unrecognized image type: "+e);const n=yield _L(this,e,t);return e===vd.SVG?o6e(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}),vL.apply(this,arguments)}function o6e(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}function bL(){return bL=Br(function*(e,t){return(yield _L(this,vd.Canvas,e,t)).canvas()}),bL.apply(this,arguments)}function wL(){return wL=Br(function*(e){return(yield _L(this,vd.SVG,e)).svg()}),wL.apply(this,arguments)}var DL="padding",Kne={skip:!0};function Jne(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===DL?i.left+i.right:0)}function Xne(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===DL?i.top+i.bottom:0)}function p6e(e,t){return t.modified&&ne(t.input.value)&&e.indexOf("_:vega:_")}function g6e(e,t){return!("parent"===e||t instanceof zg.proxy)}function y6e(e,t,n,i){const r=e.element();r&&r.setAttribute("title",function v6e(e){return null==e?"":ne(e)?Qne(e):Se(e)&&!zc(e)?function b6e(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(ne(n)?Qne(n):Zne(n))}).join("\n")}(e):e+""}(i))}function Qne(e){return"["+e.map(Zne).join(", ")+"]"}function Zne(e){return ne(e)?"[\u2026]":Se(e)&&!zc(e)?"{\u2026}":e}function eie(e,t){const n=this;if(t=t||{},Ug.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),null!=t.logLevel&&n.logLevel(t.logLevel),t.locale||e.locale){const s=st({},e.locale,t.locale);n.locale(TW(s.number,s.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||vd.Canvas,n._scenegraph=new nF;const i=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||y6e,n._redraw=!0,n._handler=(new Yy).scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function B$e(e){const t=st({defaults:{}},e),n=(i,r)=>{r.forEach(s=>{ne(i[s])&&(i[s]=va(i[s]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const r=function u6e(e,t,n){return Rne(e,zg,Bv,n).parse(t)}(n,e,t.expr);n._runtime=r,n._signals=r.signals,n._bind=(e.bindings||[]).map(s=>({state:null,param:st({},s)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=Jne(n,n._width),n._viewHeight=Xne(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function d6e(e){var t=e._signals,n=t.width,i=t.height,r=t[DL];function s(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=Jne(e,a.size),s()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=Xne(e,a.size),s()},{size:i});const o=e.add(null,s,{pad:r});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=i.rank+1,o.rank=r.rank+1}(n),function M$e(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}(n),function T$e(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:hL,item:null}));e.on(e.events("view","mousemove"),t,(n,i)=>{const r=t.value,s=r?be(r)?r:r.user:hL,o=i.item&&i.item.cursor||null;return r&&s===r.user&&o==r.item?r:{user:s,item:o}}),e.add(null,function(n){let i=n.cursor,r=this.value;return be(i)||(r=i.item,i=i.user),pL(e,i&&i!==hL?i:r||i),r},{cursor:t})}(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function yS(e,t){return ke(e._signals,t)?e._signals[t]:ee("Unrecognized signal name: "+pe(t))}function tie(e,t){const n=(e._targets||[]).filter(i=>i._update&&i._update.handler===t);return n.length?n[0]:null}function nie(e,t,n,i){let r=tie(n,i);return r||(r=gL(e,()=>i(t,n.value)),r.handler=i,e.on(n,null,r)),e}function iie(e,t,n){const i=tie(t,n);return i&&t._targets.remove(i),e}fe(eie,Ug,{evaluate(e,t,n){var i=this;return Br(function*(){if(yield Ug.prototype.evaluate.call(i,e,t),i._redraw||i._resize)try{i._renderer&&(i._resize&&(i._resize=0,function I$e(e){var t=gS(e),n=jne(e),i=Bne(e);e._renderer.background(e.background()),e._renderer.resize(n,i,t),e._handler.origin(t),e._resizeListeners.forEach(r=>{try{r(n,i)}catch(s){e.error(s)}})}(i)),yield i._renderer.renderAsync(i._scenegraph.root)),i._redraw=!1}catch(r){i.error(r)}return n&&ED(i,n),i})()},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=null!=e?e+"":null;return t!==this._desc&&Lne(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const i=yS(this,e);return 1===arguments.length?i.value:this.update(i,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",Gne(e)):Gne(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(zC(e)||ee("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Ug.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(yS(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function f6e(e,t,n,i,r,s){this.runAfter(o=>{let a=0;o._autosize=0,o.width()!==n&&(a=1,o.signal("width",n,Kne),o._resizeWidth.skip(!0)),o.height()!==i&&(a=1,o.signal("height",i,Kne),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),(o._origin[0]!==r[0]||o._origin[1]!==r[1])&&(o._resize=1,o._origin=r),a&&o.run("enter"),s&&o.runAfter(l=>l.resize())},!1,1)},addEventListener(e,t,n){let i=t;return n&&!1===n.trap||(i=gL(this,t),i.raw=t),this._handler.on(e,i),this},removeEventListener(e,t){for(var r,s,n=this._handler.handlers(e),i=n.length;--i>=0;)if(r=n[i].handler,e===(s=n[i].type)&&(t===r||t===r.raw)){this._handler.off(s,r);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return nie(this,e,yS(this,e),t)},removeSignalListener(e,t){return iie(this,yS(this,e),t)},addDataListener(e,t){return nie(this,e,hS(this,e).values,t)},removeDataListener(e,t){return iie(this,hS(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=pL(this,null);this._globalCursor=!!e,t&&pL(this,t)}return this}return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:function _6e(e,t){this._timers.push(function x$e(e,t,n){var i=new AE,r=t;return null==t?(i.restart(e,t,n),i):(i._restart=i.restart,i.restart=function(s,o,a){o=+o,a=null==a?bP():+a,i._restart(function l(u){u+=r,i._restart(l,r+=o,a),s(u)},o,a)},i.restart(e,t,n),i)}(function n(i){e({timestamp:Date.now(),elapsed:i})},t))},events:function V$e(e,t,n){var o,i=this,r=new TD(n),s=function(u,c){i.runAsync(null,()=>{"view"===e&&function $$e(e,t){var n=e._eventConfig.defaults,i=n.prevent,r=n.allow;return!1!==i&&!0!==r&&(!0===i||!1===r||(i?i[t]:r?!r[t]:e.preventDefault()))}(i,t)&&u.preventDefault(),r.receive(function R$e(e,t,n){var s,a,i=e._renderer,r=i&&i.canvas();return r&&(a=gS(e),(s=IC(t.changedTouches?t.changedTouches[0]:t,r))[0]-=a[0],s[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=function F$e(e,t,n){const i=t?"group"===t.mark.marktype?t:t.mark.group:null;function r(o){var l,a=i;if(o)for(l=t;l;l=l.mark.group)if(l.mark.name===o){a=l;break}return a&&a.mark&&a.mark.interactive?a:{}}function s(o){if(!o)return n;be(o)&&(o=r(o));const a=n.slice();for(;o;)a[0]-=o.x||0,a[1]-=o.y||0,o=o.mark&&o.mark.group;return a}return{view:gr(e),item:gr(t||{}),group:r,xy:s,x:o=>s(o)[0],y:o=>s(o)[1]}}(e,n,s),t}(i,u,c))})};if("timer"===e)mS(i,"timer",t)&&i.timer(s,t);else if("view"===e)mS(i,"view",t)&&i.addEventListener(t,s,j$e);else if("window"===e?mS(i,"window",t)&&"undefined"!=typeof window&&(o=[window]):"undefined"!=typeof document&&mS(i,"selector",t)&&(o=document.querySelectorAll(e)),o){for(var a=0,l=o.length;a<l;++a)o[a].addEventListener(t,s);Vne(i,o,t,s)}else i.warn("Can not resolve event source: "+e);return r},finalize:function U$e(){var i,r,s,e=this._tooltip,t=this._timers,n=this._eventListeners;for(i=t.length;--i>=0;)t[i].stop();for(i=n.length;--i>=0;)for(r=(s=n[i]).sources.length;--r>=0;)s.sources[r].removeEventListener(s.type,s.handler);return e&&e.call(this,this._handler,null,null,null),this},hover:function H$e(e,t){return t=[t||"update",(e=[e||"hover"])[0]],this.on(this.events("view","mouseover",Hne),Une,zne(e)),this.on(this.events("view","mouseout",Hne),Une,zne(t)),this},data:function O$e(e,t){return arguments.length<2?hS(this,e).values.value:pS.call(this,e,Qf().remove(Oo).insert(t))},change:pS,insert:function N$e(e,t){return pS.call(this,e,Qf().insert(t))},remove:function k$e(e,t){return pS.call(this,e,Qf().remove(t))},scale:function c6e(e){var t=this._runtime.scales;return ke(t,e)||ee("Unrecognized scale or projection: "+e),t[e].value},initialize:function i6e(e,t){const n=this,i=n._renderType,r=n._eventConfig.bind,s=zC(i);e=n._el=e?mL(n,e,!0):null,function A$e(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),Lne(t,e.description()))}(n),s||n.error("Unrecognized renderer type: "+i);const o=s.handler||Yy,a=e?s.renderer:s.headless;return n._renderer=a?qne(n,n._renderer,e,a):null,n._handler=function n6e(e,t,n,i){const r=new i(e.loader(),gL(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,gS(e),e);return t&&t.handlers().forEach(s=>{r.on(s.type,s.handler)}),r}(n,n._handler,e,o),n._redraw=!0,e&&"none"!==r&&(t=t?n._elBind=mL(n,t,!0):e.appendChild(ro("form",{class:"vega-bindings"})),n._bind.forEach(l=>{l.param.element&&"container"!==r&&(l.element=mL(n,l.param.element,!!l.param.input))}),n._bind.forEach(l=>{W$e(n,l.element||t,l)})),n},toImageURL:function s6e(e,t){return vL.apply(this,arguments)},toCanvas:function a6e(e,t){return bL.apply(this,arguments)},toSVG:function l6e(e){return wL.apply(this,arguments)},getState:function h6e(e){return this._runtime.getState(e||{data:p6e,signals:g6e,recurse:!0})},setState:function m6e(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}});const S6e=/[[\]{}]/,x6e={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let aie,lie;function Fd(e,t,n){return aie=t||"view",lie=n||x6e,uie(e.trim()).map(CL)}function Hv(e,t,n,i,r){const s=e.length;let a,o=0;for(;t<s;++t){if(a=e[t],!o&&a===n)return t;r&&r.indexOf(a)>=0?--o:i&&i.indexOf(a)>=0&&++o}return t}function uie(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=Hv(e,r,",","[{","]}"),t.push(e.substring(i,r).trim()),i=++r;if(0===t.length)throw"Empty event selector: "+e;return t}function CL(e){return"["===e[0]?function M6e(e){const t=e.length;let i,n=1;if(n=Hv(e,n,"]","[","]"),n===t)throw"Empty between selector: "+e;if(i=uie(e.substring(1,n)),2!==i.length)throw"Between selector must have two elements: "+e;if(">"!==(e=e.slice(n+1).trim())[0])throw"Expected '>' after between selector: "+e;i=i.map(CL);const r=CL(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}(e):function T6e(e){const t={source:aie},n=[];let l,u,i=[0,0],r=0,s=0,o=e.length,a=0;if("}"===e[o-1]){if(a=e.lastIndexOf("{"),!(a>=0))throw"Unmatched right brace: "+e;try{i=function O6e(e){const t=e.split(",");if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!=i)throw e;return i})}(e.substring(a+1,o-1))}catch(c){throw"Invalid throttle specification: "+e}o=(e=e.slice(0,a).trim()).length,a=0}if(!o)throw e;if("@"===e[0]&&(r=++a),l=Hv(e,a,":"),l<o&&(n.push(e.substring(s,l).trim()),s=a=++l),a=Hv(e,a,"["),a===o)n.push(e.substring(s,o).trim());else if(n.push(e.substring(s,a).trim()),u=[],s=++a,s===o)throw"Unmatched left bracket: "+e;for(;a<o;){if(a=Hv(e,a,"]"),a===o)throw"Unmatched left bracket: "+e;if(u.push(e.substring(s,a).trim()),a<o-1&&"["!==e[++a])throw"Expected left bracket: "+e;s=++a}if(!(o=n.length)||S6e.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],r?t.markname=n[0].slice(1):function A6e(e){return lie[e]}(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],"!"===t.type.slice(-1)&&(t.consume=!0,t.type=t.type.slice(0,-1)),null!=u&&(t.filter=u),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}(e)}function N6e(e){return Se(e)?e:{type:e||"pad"}}const Uv=e=>+e||0;function I6e(e){return Se(e)?e.signal?e:{top:Uv(e.top),bottom:Uv(e.bottom),left:Uv(e.left),right:Uv(e.right)}:(e=>({top:e,bottom:e,left:e,right:e}))(Uv(e))}const Bi=e=>Se(e)&&!ne(e)?st({},e):{value:e};function cie(e,t,n,i){return null!=n?(Se(n)&&!ne(n)||ne(n)&&n.length&&Se(n[0])?e.update[t]=n:e[i||"enter"][t]={value:n},1):0}function Qi(e,t,n){for(const i in t)cie(e,i,t[i]);for(const i in n)cie(e,i,n[i],"update")}function Nm(e,t,n){for(const i in t)n&&ke(n,i)||(e[i]=st(e[i]||{},t[i]));return e}function km(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const EL="mark",SL="frame",xL="scope",die="legend-label";function AL(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const fie=e=>be(e)?pe(e):e.signal?`(${e.signal})`:hie(e);function wS(e){if(null!=e.gradient)return function X6e(e){const t=[e.start,e.stop,e.count].map(n=>null==n?null:pe(n));for(;t.length&&null==bt(t);)t.pop();return t.unshift(fie(e.gradient)),`gradient(${t.join(",")})`}(e);let t=e.signal?`(${e.signal})`:e.color?function J6e(e){return e.c?DS("hcl",e.h,e.c,e.l):e.h||e.s?DS("hsl",e.h,e.s,e.l):e.l||e.a?DS("lab",e.l,e.a,e.b):e.r||e.g||e.b?DS("rgb",e.r,e.g,e.b):null}(e.color):null!=e.field?hie(e.field):void 0!==e.value?pe(e.value):void 0;return null!=e.scale&&(t=function Q6e(e,t){const n=fie(e.scale);return null!=e.range?t=`lerp(_range(${n}), ${+e.range})`:(void 0!==t&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(1==+e.band?"":"*"+CS(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),null==t&&(t="0")),t}(e,t)),void 0===t&&(t=null),null!=e.exponent&&(t=`pow(${t},${CS(e.exponent)})`),null!=e.mult&&(t+=`*${CS(e.mult)}`),null!=e.offset&&(t+=`+${CS(e.offset)}`),e.round&&(t=`round(${t})`),t}const DS=(e,t,n,i)=>`(${e}(${[t,n,i].map(wS).join(",")})+'')`;function CS(e){return Se(e)?"("+wS(e)+")":e}function hie(e){return pie(Se(e)?e:{datum:e})}function pie(e){let t,n,i;if(e.signal)t="datum",i=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(i=e.parent,t+=".datum"):i=e.group}else e.datum?(t="datum",i=e.datum):ee("Invalid field reference: "+pe(e));return e.signal||(i=be(i)?bl(i).map(pe).join("]["):pie(i)),t+"["+i+"]"}function gie(e,t,n,i,r,s){const o={};(s=s||{}).encoders={$encode:o},e=function K6e(e,t,n,i,r){const s={},o={};let a,l,u,c;for(l in l="lineBreak","text"===t&&null!=r[l]&&!km(l,e)&&AL(s,l,r[l]),("legend"==n||String(n).startsWith("axis"))&&(n=null),c=n===SL?r.group:n===EL?st({},r.mark,r[t]):null,c)u=km(l,e)||("fill"===l||"stroke"===l)&&(km("fill",e)||km("stroke",e)),u||AL(s,l,c[l]);for(l in we(i).forEach(d=>{const f=r.style&&r.style[d];for(const h in f)km(h,e)||AL(s,h,f[h])}),e=st({},e),s)c=s[l],c.signal?(a=a||{})[l]=c:o[l]=c;return e.enter=st(o,e.enter),a&&(e.update=st(a,e.update)),e}(e,t,n,i,r.config);for(const a in e)o[a]=eVe(e[a],t,s,r);return s}function eVe(e,t,n,i){const r={},s={};for(const o in e)null!=e[o]&&(r[o]=nVe(tVe(e[o]),i,n,s));return{$expr:{marktype:t,channels:r},$fields:Object.keys(s),$output:Object.keys(e)}}function tVe(e){return ne(e)?function Z6e(e){let t="";return e.forEach(n=>{const i=wS(n);t+=n.test?`(${n.test})?${i}:`:i}),":"===bt(t)&&(t+="null"),t}(e):wS(e)}function nVe(e,t,n,i){const r=Hl(e,t);return r.$fields.forEach(s=>i[s]=1),st(n,r.$params),r.$expr}const rVe=["value","update","init","react","bind"];function mie(e,t){ee(e+' for "outer" push: '+pe(t))}function _ie(e,t){const n=e.name;if("outer"===e.push)t.signals[n]||mie("No prior signal definition",n),rVe.forEach(i=>{void 0!==e[i]&&mie("Invalid property ",i)});else{const i=t.addSignal(n,e.value);!1===e.react&&(i.react=!1),e.bind&&t.addBinding(n,e.bind)}}function ML(e,t,n,i){this.id=-1,this.type=e,this.value=t,this.params=n,i&&(this.parent=i)}function ES(e,t,n,i){return new ML(e,t,n,i)}function SS(e,t){return ES("operator",e,t)}function Le(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function zv(e,t){return t?{$field:e,$name:t}:{$field:e}}const TL=zv("key");function yie(e,t){return{$compare:e,$order:t}}function xS(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const OL="scope",NL="view";function xi(e){return e&&e.signal}function AS(e){if(xi(e))return!0;if(Se(e))for(const t in e)if(AS(e[t]))return!0;return!1}function Pa(e,t){return null!=e?e:t}function Rh(e){return e&&e.signal||e}function qv(e,t){return(e.merge?dVe:e.stream?fVe:e.type?hVe:ee("Invalid stream specification: "+pe(e)))(e,t)}function dVe(e,t){const i=kL({merge:e.merge.map(r=>qv(r,t))},e,t);return t.addStream(i).id}function fVe(e,t){const i=kL({stream:qv(e.stream,t)},e,t);return t.addStream(i).id}function hVe(e,t){let n;"timer"===e.type?(n=t.event("timer",e.throttle),e={between:e.between,filter:e.filter}):n=t.event(function cVe(e){return e===OL?NL:e||NL}(e.source),e.type);const i=kL({stream:n},e,t);return 1===Object.keys(i).length?n:t.addStream(i).id}function kL(e,t,n){let i=t.between;return i&&(2!==i.length&&ee('Stream "between" parameter must have 2 entries: '+pe(t)),e.between=[qv(i[0],n),qv(i[1],n)]),i=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&i.push(function pVe(e,t,n){const i="event.item";return i+(e&&"*"!==e?"&&"+i+".mark.marktype==='"+e+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(t?"&&"+i+".mark.name==='"+t+"'":"")}(t.marktype,t.markname,t.markrole)),t.source===OL&&i.push("inScope(event.item)"),i.length&&(e.filter=Hl("("+i.join(")&&(")+")",n).$expr),null!=(i=t.throttle)&&(e.throttle=+i),null!=(i=t.debounce)&&(e.debounce=+i),t.consume&&(e.consume=!0),e}const gVe={code:"_.$value",ast:{type:"Identifier",value:"value"}};function yVe(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}const tn=e=>(t,n,i)=>ES(e,n,t||void 0,i),bie=tn("aggregate"),bVe=tn("axisticks"),wie=tn("bound"),La=tn("collect"),Die=tn("compare"),wVe=tn("datajoin"),Cie=tn("encode"),DVe=tn("expression"),CVe=tn("facet"),EVe=tn("field"),SVe=tn("key"),xVe=tn("legendentries"),AVe=tn("load"),MVe=tn("mark"),TVe=tn("multiextent"),OVe=tn("multivalues"),NVe=tn("overlap"),kVe=tn("params"),Eie=tn("prefacet"),IVe=tn("projection"),RVe=tn("proxy"),FVe=tn("relay"),Sie=tn("render"),PVe=tn("scale"),Fh=tn("sieve"),LVe=tn("sortitems"),xie=tn("viewlayout"),jVe=tn("values");let BVe=0;const Aie={min:"min",max:"max",count:"sum"};function VVe(e,t){const n=t.getScale(e.name).params;let i;for(i in n.domain=Mie(e.domain,e,t),null!=e.range&&(n.range=Oie(e,t,n)),null!=e.interpolate&&function XVe(e,t){t.interpolate=$o(e.type||e),null!=e.gamma&&(t.interpolateGamma=$o(e.gamma))}(e.interpolate,n),null!=e.nice&&(n.nice=function JVe(e){return Se(e)?{interval:$o(e.interval),step:$o(e.step)}:$o(e)}(e.nice)),null!=e.bins&&(n.bins=function KVe(e,t){return e.signal||ne(e)?MS(e,t):t.objectProperty(e)}(e.bins,t)),e)ke(n,i)||"name"===i||(n[i]=$o(e[i],t))}function $o(e,t){return Se(e)?e.signal?t.signalRef(e.signal):ee("Unsupported object: "+pe(e)):e}function MS(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>$o(n,t))}function TS(e){ee("Can not find data set: "+pe(e))}function Mie(e,t,n){if(e)return e.signal?n.signalRef(e.signal):(ne(e)?HVe:e.fields?zVe:UVe)(e,t,n);(null!=t.domainMin||null!=t.domainMax)&&ee("No scale domain defined for domainMin/domainMax to override.")}function HVe(e,t,n){return e.map(i=>$o(i,n))}function UVe(e,t,n){const i=n.getData(e.data);return i||TS(e.data),em(t.type)?i.valuesRef(n,e.field,Tie(e.sort,!1)):jJ(t.type)?i.domainRef(n,e.field):i.extentRef(n,e.field)}function zVe(e,t,n){const i=e.data,r=e.fields.reduce((s,o)=>(o=be(o)?{data:i,field:o}:ne(o)||o.signal?function qVe(e,t){const n="_:vega:_"+BVe++,i=La({});if(ne(e))i.value={$ingest:e};else if(e.signal){const r="setdata("+pe(n)+","+e.signal+")";i.params.input=t.signalRef(r)}return t.addDataPipeline(n,[i,Fh({})]),{data:n,field:"data"}}(o,n):o,s.push(o),s),[]);return(em(t.type)?GVe:jJ(t.type)?WVe:YVe)(e,n,r)}function GVe(e,t,n){const i=Tie(e.sort,!0);let r,s;const o=n.map(u=>{const c=t.getData(u.data);return c||TS(u.data),c.countsRef(t,u.field,i)}),a={groupby:TL,pulse:o};i&&(r=i.op||"count",s=i.field?xS(r,i.field):"count",a.ops=[Aie[r]],a.fields=[t.fieldRef(s)],a.as=[s]),r=t.add(bie(a));const l=t.add(La({pulse:Le(r)}));return s=t.add(jVe({field:TL,sort:t.sortRef(i),pulse:Le(l)})),Le(s)}function Tie(e,t){return e&&(e.field||e.op?e.field||"count"===e.op?t&&e.field&&e.op&&!Aie[e.op]&&ee("Multiple domain scales can not be sorted using "+e.op):ee("No field provided for sort aggregate op: "+e.op):Se(e)?e.field="key":e={field:"key"}),e}function WVe(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||TS(r.data),s.domainRef(t,r.field)});return Le(t.add(OVe({values:i})))}function YVe(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||TS(r.data),s.extentRef(t,r.field)});return Le(t.add(TVe({extents:i})))}function Oie(e,t,n){const i=t.config.range;let r=e.range;if(r.signal)return t.signalRef(r.signal);if(be(r)){if(i&&ke(i,r))return Oie(e=st({},e,{range:i[r]}),t,n);"width"===r?r=[0,{signal:"width"}]:"height"===r?r=em(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:ee("Unrecognized scale range value: "+pe(r))}else{if(r.scheme)return n.scheme=ne(r.scheme)?MS(r.scheme,t):$o(r.scheme,t),r.extent&&(n.schemeExtent=MS(r.extent,t)),void(r.count&&(n.schemeCount=$o(r.count,t)));if(r.step)return void(n.rangeStep=$o(r.step,t));if(em(e.type)&&!ne(r))return Mie(r,e,t);ne(r)||ee("Unsupported range type: "+pe(r))}return r.map(s=>(ne(s)?MS:$o)(s,t))}function IL(e,t,n){return ne(e)?e.map(i=>IL(i,t,n)):Se(e)?e.signal?n.signalRef(e.signal):"fit"===t?e:ee("Unsupported parameter object: "+pe(e)):e}const ja="top",Pd="bottom",FL="label",Vo="value",Gv="guide-label",PL="guide-title",OS="gradient",LL="discrete",BL=["size","shape","fill","stroke","strokeWidth","strokeDash","opacity"],Wv={name:1,style:1,interactive:1},At={value:0},Ho={value:1},NS="group",$L="rule",Ph="text";function Yv(e){return e.type=NS,e.interactive=e.interactive||!1,e}function Ds(e,t){const n=(i,r)=>Pa(e[i],Pa(t[i],r));return n.isVertical=i=>"vertical"===Pa(e.direction,t.direction||(i?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>Pa(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>Pa(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>Pa(e.columns,Pa(t.columns,+n.isVertical(!0))),n}function Rie(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function kS(e,t,n){return`item.anchor === 'start' ? ${e} : item.anchor === 'end' ? ${t} : ${n}`}const VL=kS(pe("left"),pe("right"),pe("center"));function Fie(e,t){return t?e?Se(e)?Object.assign({},e,{offset:Fie(e.offset,t)}):{value:e,offset:t}:t:e}function so(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=Nm(e.encode,t,Wv)):e.interactive=!1,e}function c7e(e,t,n,i){const r=Ds(e,n),s=r.isVertical(),o=r.gradientThickness(),a=r.gradientLength();let l,u,c,d,f;s?(u=[0,1],c=[0,0],d=o,f=a):(u=[0,0],c=[1,0],d=a,f=o);const h={enter:l={opacity:At,x:At,y:At,width:Bi(d),height:Bi(f)},update:st({},l,{opacity:Ho,fill:{gradient:t,start:u,stop:c}}),exit:{opacity:At}};return Qi(h,{stroke:r("gradientStrokeColor"),strokeWidth:r("gradientStrokeWidth")},{opacity:r("gradientOpacity")}),so({type:"rect",role:"legend-gradient",encode:h},i)}function d7e(e,t,n,i,r){const s=Ds(e,n),o=s.isVertical(),a=s.gradientThickness(),l=s.gradientLength();let u,c,d,f,h="";o?(u="y",d="y2",c="x",f="width",h="1-"):(u="x",d="x2",c="y",f="height");const p={opacity:At,fill:{scale:t,field:Vo}};p[u]={signal:h+"datum.perc",mult:l},p[c]=At,p[d]={signal:h+"datum.perc2",mult:l},p[f]=Bi(a);const g={enter:p,update:st({},p,{opacity:Ho}),exit:{opacity:At}};return Qi(g,{stroke:s("gradientStrokeColor"),strokeWidth:s("gradientStrokeWidth")},{opacity:s("gradientOpacity")}),so({type:"rect",role:"legend-band",key:Vo,from:r,encode:g},i)}const h7e=`datum.perc<=0?"${Pd}":datum.perc>=1?"top":"middle"`;function Pie(e,t,n,i){const r=Ds(e,t),s=r.isVertical(),o=Bi(r.gradientThickness()),a=r.gradientLength();let u,c,d,f,l=r("labelOverlap"),h="";const p={enter:u={opacity:At},update:c={opacity:Ho,text:{field:FL}},exit:{opacity:At}};return Qi(p,{fill:r("labelColor"),fillOpacity:r("labelOpacity"),font:r("labelFont"),fontSize:r("labelFontSize"),fontStyle:r("labelFontStyle"),fontWeight:r("labelFontWeight"),limit:Pa(e.labelLimit,t.gradientLabelLimit)}),s?(u.align={value:"left"},u.baseline=c.baseline={signal:h7e},d="y",f="x",h="1-"):(u.align=c.align={signal:'datum.perc<=0?"left":datum.perc>=1?"right":"center"'},u.baseline={value:"top"},d="x",f="y"),u[d]=c[d]={signal:h+"datum.perc",mult:a},u[f]=c[f]=o,o.offset=Pa(e.labelOffset,t.gradientLabelOffset)||0,l=l?{separation:r("labelSeparation"),method:l,order:"datum.index"}:void 0,so({type:Ph,role:die,style:Gv,key:Vo,from:i,encode:p,overlap:l},n)}function p7e(e,t,n,i,r){const s=Ds(e,t),o=n.entries,a=!(!o||!o.interactive),l=o?o.name:void 0,u=s("clipHeight"),c=s("symbolOffset"),d={data:"value"},f=`(${r}) ? datum.offset : datum.size`,h=u?Bi(u):{field:"size"},p="datum.index",g=`max(1, ${r})`;let m,_,y,v,b;h.mult=.5,m={enter:_={opacity:At,x:{signal:f,mult:.5,offset:c},y:h},update:y={opacity:Ho,x:_.x,y:_.y},exit:{opacity:At}};let D=null,C=null;e.fill||(D=t.symbolBaseFillColor,C=t.symbolBaseStrokeColor),Qi(m,{fill:s("symbolFillColor",D),shape:s("symbolType"),size:s("symbolSize"),stroke:s("symbolStrokeColor",C),strokeDash:s("symbolDash"),strokeDashOffset:s("symbolDashOffset"),strokeWidth:s("symbolStrokeWidth")},{opacity:s("symbolOpacity")}),BL.forEach(O=>{e[O]&&(y[O]=_[O]={scale:e[O],field:Vo})});const w=so({type:"symbol",role:"legend-symbol",key:Vo,from:d,clip:!!u||void 0,encode:m},n.symbols),E=Bi(c);E.offset=s("labelOffset"),m={enter:_={opacity:At,x:{signal:f,offset:E},y:h},update:y={opacity:Ho,text:{field:FL},x:_.x,y:_.y},exit:{opacity:At}},Qi(m,{align:s("labelAlign"),baseline:s("labelBaseline"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontStyle:s("labelFontStyle"),fontWeight:s("labelFontWeight"),limit:s("labelLimit")});const T=so({type:Ph,role:die,style:Gv,key:Vo,from:d,encode:m},n.labels);return m={enter:{noBound:{value:!u},width:At,height:u?Bi(u):At,opacity:At},exit:{opacity:At},update:y={opacity:Ho,row:{signal:null},column:{signal:null}}},s.isVertical(!0)?(v=`ceil(item.mark.items.length / ${g})`,y.row.signal=`${p}%${v}`,y.column.signal=`floor(${p} / ${v})`,b={field:["row",p]}):(y.row.signal=`floor(${p} / ${g})`,y.column.signal=`${p} % ${g}`,b={field:p}),y.column.signal=`(${r})?${y.column.signal}:${p}`,Yv({role:xL,from:i={facet:{data:i,name:"value",groupby:"index"}},encode:Nm(m,o,Wv),marks:[w,T],name:l,interactive:a,sort:b})}const HL='item.orient === "left"',UL='item.orient === "right"',IS=`(${HL} || ${UL})`,m7e=`datum.vgrad && ${IS}`,_7e=kS('"top"','"bottom"','"middle"'),v7e=`datum.vgrad && ${UL} ? (${kS('"right"','"left"','"center"')}) : (${IS} && !(datum.vgrad && ${HL})) ? "left" : ${VL}`,b7e=`item._anchor || (${IS} ? "middle" : "start")`,w7e=`${m7e} ? (${HL} ? -90 : 90) : 0`,D7e=`${IS} ? (datum.vgrad ? (${UL} ? "bottom" : "top") : ${_7e}) : "top"`;function E7e(e,t){let n;return Se(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+Lie(e.path)+")":e.sphere&&(n="geoShape("+Lie(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function Lie(e){return Se(e)&&e.signal?e.signal:pe(e)}function jie(e){const t=e.role||"";return t.indexOf("axis")&&t.indexOf("legend")&&t.indexOf("title")?e.type===NS?xL:t||EL:t}function S7e(e){return{marktype:e.type,name:e.name||void 0,role:e.role||jie(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function x7e(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e}function zL(e,t){const n=JW(e.type);n||ee("Unrecognized transform type: "+pe(e.type));const i=ES(n.type.toLowerCase(),null,Bie(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(i)),i.metadata=n.metadata||{},i}function Bie(e,t,n){const i={},r=e.params.length;for(let s=0;s<r;++s){const o=e.params[s];i[o.name]=A7e(o,t,n)}return i}function A7e(e,t,n){const i=e.type,r=t[e.name];return"index"===i?function M7e(e,t,n){return be(t.from)||ee('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}(0,t,n):void 0!==r?"param"===i?function T7e(e,t,n){const i=t[e.name];return e.array?(ne(i)||ee("Expected an array of sub-parameters. Instead: "+pe(i)),i.map(r=>Vie(e,r,n))):Vie(e,i,n)}(e,t,n):"projection"===i?n.projectionRef(t[e.name]):e.array&&!xi(r)?r.map(s=>$ie(e,s,n)):$ie(e,r,n):void(e.required&&ee("Missing required "+pe(t.type)+" parameter: "+pe(e.name)))}function $ie(e,t,n){const i=e.type;if(xi(t))return Hie(i)?ee("Expression references can not be signals."):qL(i)?n.fieldRef(t):Uie(i)?n.compareRef(t):n.signalRef(t.signal);{const r=e.expr||qL(i);return r&&O7e(t)?n.exprRef(t.expr,t.as):r&&N7e(t)?zv(t.field,t.as):Hie(i)?Hl(t,n):k7e(i)?Le(n.getData(t).values):qL(i)?zv(t):Uie(i)?n.compareRef(t):t}}function Vie(e,t,n){const i=e.params.length;let r;for(let o=0;o<i;++o){r=e.params[o];for(const a in r.key)if(r.key[a]!==t[a]){r=null;break}if(r)break}r||ee("Unsupported parameter: "+pe(t));const s=st(Bie(r,t,n),r.key);return Le(n.add(kVe(s)))}const O7e=e=>e&&e.expr,N7e=e=>e&&e.field,k7e=e=>"data"===e,Hie=e=>"expr"===e,qL=e=>"field"===e,Uie=e=>"compare"===e;function RS(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:Le(t.getData(e.data).output)}function Lh(e,t,n,i,r){this.scope=e,this.input=t,this.output=n,this.values=i,this.aggregate=r,this.index={}}function zie(e){return be(e)?e:null}function qie(e,t,n){const i=xS(n.op,n.field);let r;if(t.ops){for(let s=0,o=t.as.length;s<o;++s)if(t.as[s]===i)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(i))}function Kv(e,t,n,i,r,s,o){const a=t[n]||(t[n]={}),l=function lVe(e){return Se(e)?("descending"===e.order?"-":"+")+xS(e.op,e.field):""}(s);let c,d,u=zie(r);if(null!=u&&(e=t.scope,u+=l?"|"+l:"",c=a[u]),!c){const f=s?{field:TL,pulse:t.countsRef(e,r,s)}:{field:e.fieldRef(r),pulse:Le(t.output)};l&&(f.sort=e.sortRef(s)),d=e.add(ES(i,void 0,f)),o&&(t.index[r]=d),c=Le(d),null!=u&&(a[u]=c)}return c}function Gie(e,t,n){const i=e.remove,r=e.insert,s=e.toggle,o=e.modify,a=e.values,l=t.add(SS()),c=Hl("if("+e.trigger+',modify("'+n+'",'+[r,i,s,o,a].map(d=>null==d?"null":d).join(",")+"),0)",t);l.update=c.$expr,l.params=c.$params}function FS(e,t){const n=jie(e),i=e.type===NS,r=e.from&&e.from.facet,s=e.overlap;let a,l,u,c,d,f,h,o=e.layout||n===xL||n===SL;const p=n===EL||o||r,g=function I7e(e,t,n){let i,r,s,o,a;return e?(i=e.facet)&&(t||ee("Only group marks can be faceted."),null!=i.field?o=a=RS(i,n):(e.data?a=Le(n.getData(e.data).aggregate):(s=zL(st({type:"aggregate",groupby:we(i.groupby)},i.aggregate),n),s.params.key=n.keyRef(i.groupby),s.params.pulse=RS(i,n),o=a=Le(n.add(s))),r=n.keyRef(i.groupby,!0))):o=Le(n.add(La(null,[{}]))),o||(o=RS(e,n)),{key:r,pulse:o,parent:a}}(e.from,i,t);l=t.add(wVe({key:g.key||(e.key?zv(e.key):void 0),pulse:g.pulse,clean:!i}));const m=Le(l);l=u=t.add(La({pulse:m})),l=t.add(MVe({markdef:S7e(e),interactive:x7e(e.interactive,t),clip:E7e(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:Le(l)}));const _=Le(l);l=c=t.add(Cie(gie(e.encode,e.type,n,e.style,t,{mod:!1,pulse:_}))),l.params.parent=t.encode(),e.transform&&e.transform.forEach(C=>{const w=zL(C,t),E=w.metadata;(E.generates||E.changes)&&ee("Mark transforms should not generate new data."),E.nomod||(c.params.mod=!0),w.params.pulse=Le(l),t.add(l=w)}),e.sort&&(l=t.add(LVe({sort:t.compareRef(e.sort),pulse:Le(l)})));const y=Le(l);(r||o)&&(o=t.add(xie({layout:t.objectProperty(e.layout),legends:t.legends,mark:_,pulse:y})),f=Le(o));const v=t.add(wie({mark:_,pulse:f||y}));h=Le(v),i&&(p&&(a=t.operators,a.pop(),o&&a.pop()),t.pushState(y,f||h,m),r?function R7e(e,t,n){const i=e.from.facet,r=i.name,s=RS(i,t);let o;i.name||ee("Facet must have a name: "+pe(i)),i.data||ee("Facet must reference a data set: "+pe(i)),i.field?o=t.add(Eie({field:t.fieldRef(i.field),pulse:s})):i.groupby?o=t.add(CVe({key:t.keyRef(i.groupby),group:Le(t.proxy(n.parent)),pulse:s})):ee("Facet must specify groupby or field: "+pe(i));const a=t.fork(),l=a.add(La()),u=a.add(Fh({pulse:Le(l)}));a.addData(r,new Lh(a,l,l,u)),a.addSignal("parent",null),o.params.subflow={$subflow:a.parse(e).toRuntime()}}(e,t,g):p?function F7e(e,t,n){const i=t.add(Eie({pulse:n.pulse})),r=t.fork();r.add(Fh()),r.addSignal("parent",null),i.params.subflow={$subflow:r.parse(e).toRuntime()}}(e,t,g):t.parse(e),t.popState(),p&&(o&&a.push(o),a.push(v))),s&&(h=function P7e(e,t,n){const i=e.method,r=e.bound,s=e.separation,o={separation:xi(s)?n.signalRef(s.signal):s,method:xi(i)?n.signalRef(i.signal):i,pulse:t};if(e.order&&(o.sort=n.compareRef({field:e.order})),r){const a=r.tolerance;o.boundTolerance=xi(a)?n.signalRef(a.signal):+a,o.boundScale=n.scaleRef(r.scale),o.boundOrient=r.orient}return Le(n.add(NVe(o)))}(s,h,t));const b=t.add(Sie({pulse:h})),D=t.add(Fh({pulse:Le(b)},void 0,t.parent()));null!=e.name&&(d=e.name,t.addData(d,new Lh(t,u,b,D)),e.on&&e.on.forEach(C=>{(C.insert||C.remove||C.toggle)&&ee("Marks only support modify triggers."),Gie(C,t,d)}))}function $7e(e,t,n){const i={enter:{},update:{}};return Qi(i,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),i}function Wie(e,t,n){return t[e]?`scale("${t[e]}",datum)`:Rie(e,n[0].encode)}function G7e(e,t){const n={enter:{},update:{}};return Qi(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:VL},angle:{signal:'item.orient==="left"?-90:item.orient==="right"?90:0'},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),Nm(n,t,Wv)}function jh(e){const t=La({},e);return t.metadata={source:!0},t}function Yie(e,t){return AVe({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}Lh.fromEntries=function(e,t){const n=t.length,i=t[n-1],r=t[n-2];let s=t[0],o=null,a=1;for(s&&"load"===s.type&&(s=t[1]),e.add(t[0]);a<n;++a)t[a].params.pulse=Le(t[a-1]),e.add(t[a]),"aggregate"===t[a].type&&(o=t[a]);return new Lh(e,s,r,i,o)},Lh.prototype={countsRef(e,t,n){const i=this,r=i.counts||(i.counts={}),s=zie(t);let o,a,l;return null!=s&&(e=i.scope,o=r[s]),o?n&&n.field&&qie(e,o.agg.params,n):(l={groupby:e.fieldRef(t,"key"),pulse:Le(i.output)},n&&n.field&&qie(e,l,n),a=e.add(bie(l)),o=e.add(La({pulse:Le(a)})),o={agg:a,ref:Le(o)},null!=s&&(r[s]=o)),o.ref},tuplesRef(){return Le(this.values)},extentRef(e,t){return Kv(e,this,"extent","extent",t,!1)},domainRef(e,t){return Kv(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return Kv(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return Kv(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return Kv(e,this,"indata","tupleindex",t,!0,!0)}};const Kie=e=>e===Pd||e===ja,PS=(e,t,n)=>xi(e)?eHe(e.signal,t,n):"left"===e||e===ja?t:n,$i=(e,t,n)=>xi(e)?Q7e(e.signal,t,n):Kie(e)?t:n,Ba=(e,t,n)=>xi(e)?Z7e(e.signal,t,n):Kie(e)?n:t,Jie=(e,t,n)=>xi(e)?tHe(e.signal,t,n):e===ja?{value:t}:{value:n},Q7e=(e,t,n)=>Xie(`${e} === 'top' || ${e} === '${Pd}'`,t,n),Z7e=(e,t,n)=>Xie(`${e} !== 'top' && ${e} !== '${Pd}'`,t,n),eHe=(e,t,n)=>GL(`${e} === 'left' || ${e} === 'top'`,t,n),tHe=(e,t,n)=>GL(`${e} === 'top'`,t,n),Xie=(e,t,n)=>(t=null!=t?Bi(t):t,n=null!=n?Bi(n):n,Qie(t)&&Qie(n)?{signal:`${e} ? (${t=t?t.signal||pe(t.value):null}) : (${n=n?n.signal||pe(n.value):null})`}:[st({test:e},t)].concat(n||[])),Qie=e=>null==e||1===Object.keys(e).length,GL=(e,t,n)=>({signal:`${e} ? (${Pm(t)}) : (${Pm(n)})`}),iHe=(e,t,n,i,r)=>({signal:(null!=i?`${e} === 'left' ? (${Pm(i)}) : `:"")+(null!=n?`${e} === '${Pd}' ? (${Pm(n)}) : `:"")+(null!=r?`${e} === 'right' ? (${Pm(r)}) : `:"")+(null!=t?`${e} === 'top' ? (${Pm(t)}) : `:"")+"(null)"}),Pm=e=>xi(e)?e.signal:null==e?null:pe(e),Lm=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function jm(e,t,n,i){let r;if(t&&ke(t,e))return t[e];if(ke(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=e[5].toLowerCase()+e.slice(6)}return i[PL][r]}if(e.startsWith("label")){switch(e){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=e[5].toLowerCase()+e.slice(6)}return i[Gv][r]}return null}function Zie(e){const t={};for(const n of e)if(n)for(const i in n)t[i]=1;return Object.keys(t)}function ere(e,t){return{scale:e.scale,range:t}}function WL(e,t,n,i,r){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+i+","+r+")"}}function cHe(e,t,n,i,r,s){const o=Ds(e,t),a=e.orient,l=e.scale,u=PS(a,-1,1),c=Rh(o("labelFlush")),d=Rh(o("labelFlushOffset")),f=o("labelAlign"),h=o("labelBaseline");let g,p=0===c||!!c;const m=Bi(r);m.mult=u,m.offset=Bi(o("labelPadding")||0),m.offset.mult=u;const _={scale:l,field:Vo,band:.5,offset:Fie(s.offset,o("labelOffset"))},y=$i(a,p?WL(l,c,'"left"','"right"','"center"'):{value:"center"},((e,t,n)=>xi(e)?((e,t,n)=>GL(`${e} === 'right'`,t,n))(e.signal,t,n):"right"===e?{value:t}:{value:n})(a,"left","right")),v=$i(a,Jie(a,"bottom","top"),p?WL(l,c,'"top"','"bottom"','"middle"'):{value:"middle"}),b=WL(l,c,`-(${d})`,d,0);p=p&&d;const D={opacity:At,x:$i(a,_,m),y:Ba(a,_,m)},C={enter:D,update:g={opacity:Ho,text:{field:FL},x:D.x,y:D.y,align:y,baseline:v},exit:{opacity:At,x:D.x,y:D.y}};Qi(C,{dx:!f&&p?$i(a,b):null,dy:!h&&p?Ba(a,b):null}),Qi(C,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:f,baseline:h});const w=o("labelBound");let E=o("labelOverlap");return E=E||w?{separation:o("labelSeparation"),method:E,order:"datum.index",bound:w?{scale:l,orient:a,tolerance:w}:null}:void 0,g.align!==y&&(g.align=Lm(g.align,y)),g.baseline!==v&&(g.baseline=Lm(g.baseline,v)),so({type:Ph,role:"axis-label",style:Gv,key:Vo,from:i,encode:C,overlap:E},n)}function hHe(e,t){const n=function sHe(e,t){var a,l,u,n=t.config,i=n.style,r=n.axis,s="band"===t.scaleType(e.scale)&&n.axisBand,o=e.orient;if(xi(o)){const d=Zie([n.axisX,n.axisY]),f=Zie([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);for(u of(a={},d))a[u]=$i(o,jm(u,n.axisX,r,i),jm(u,n.axisY,r,i));for(u of(l={},f))l[u]=iHe(o.signal,jm(u,n.axisTop,r,i),jm(u,n.axisBottom,r,i),jm(u,n.axisLeft,r,i),jm(u,n.axisRight,r,i))}else a=o===ja||o===Pd?n.axisX:n.axisY,l=n["axis"+o[0].toUpperCase()+o.slice(1)];return a||l||s?st({},r,a,l,s):r}(e,t),i=e.encode||{},r=i.axis||{},s=r.name||void 0,o=r.interactive,a=r.style,l=Ds(e,n),u=function u7e(e){const t=e("tickBand");let i,r,n=e("tickOffset");return t?t.signal?(i={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${t.signal}) === 'extent'`},Se(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):"extent"===t?(i=1,r=!0,n=0):(i=.5,r=!1):(i=e("bandPosition"),r=e("tickExtra")),{extra:r,band:i,offset:n}}(l),c={scale:e.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:null!=e.title},d=Le(t.add(La({},[c]))),f=Le(t.add(bVe({scale:t.scaleRef(e.scale),extra:t.property(u.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(function aHe(e,t,n,i,r){const s=Ds(e,t),o=e.orient,a=e.gridScale,l=PS(o,1,-1),u=function lHe(e,t){if(1!==t)if(Se(e)){let n=e=st({},e);for(;null!=n.mult;){if(!Se(n.mult))return n.mult=xi(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n=n.mult=st({},n.mult)}n.mult=t}else e=xi(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);return e}(e.offset,l);let c,d,f;const h={enter:c={opacity:At},update:f={opacity:Ho},exit:d={opacity:At}};Qi(h,{stroke:s("gridColor"),strokeCap:s("gridCap"),strokeDash:s("gridDash"),strokeDashOffset:s("gridDashOffset"),strokeOpacity:s("gridOpacity"),strokeWidth:s("gridWidth")});const p={scale:e.scale,field:Vo,band:r.band,extra:r.extra,offset:r.offset,round:s("tickRound")},g=$i(o,{signal:"height"},{signal:"width"}),m=a?{scale:a,range:0,mult:l,offset:u}:{value:0,offset:u},_=a?{scale:a,range:1,mult:l,offset:u}:st(g,{mult:l,offset:u});return c.x=f.x=$i(o,p,m),c.y=f.y=Ba(o,p,m),c.x2=f.x2=Ba(o,_),c.y2=f.y2=$i(o,_),d.x=$i(o,p),d.y=Ba(o,p),so({type:$L,role:"axis-grid",key:Vo,from:i,encode:h},n)}(e,n,i.grid,f,u)),c.ticks&&(p=l("tickSize"),h.push(function uHe(e,t,n,i,r,s){const o=Ds(e,t),a=e.orient,l=PS(a,-1,1);let u,c,d;const f={enter:u={opacity:At},update:d={opacity:Ho},exit:c={opacity:At}};Qi(f,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const h=Bi(r);h.mult=l;const p={scale:e.scale,field:Vo,band:s.band,extra:s.extra,offset:s.offset,round:o("tickRound")};return d.y=u.y=$i(a,At,p),d.y2=u.y2=$i(a,h),c.x=$i(a,p),d.x=u.x=Ba(a,At,p),d.x2=u.x2=Ba(a,h),c.y=Ba(a,p),so({type:$L,role:"axis-tick",key:Vo,from:i,encode:f},n)}(e,n,i.ticks,f,p,u))),c.labels&&(p=c.ticks?p:0,h.push(cHe(e,n,i.labels,f,p,u))),c.domain&&h.push(function oHe(e,t,n,i){const r=Ds(e,t),s=e.orient;let o,a;const l={enter:o={opacity:At},update:a={opacity:Ho},exit:{opacity:At}};Qi(l,{stroke:r("domainColor"),strokeCap:r("domainCap"),strokeDash:r("domainDash"),strokeDashOffset:r("domainDashOffset"),strokeWidth:r("domainWidth"),strokeOpacity:r("domainOpacity")});const u=ere(e,0),c=ere(e,1);return o.x=a.x=$i(s,u,At),o.x2=a.x2=$i(s,c),o.y=a.y=Ba(s,u,At),o.y2=a.y2=Ba(s,c),so({type:$L,role:"axis-domain",from:i,encode:l},n)}(e,n,i.domain,d)),c.title&&h.push(function dHe(e,t,n,i){const r=Ds(e,t),s=e.orient,o=PS(s,-1,1);let a,l;const u={enter:a={opacity:At,anchor:Bi(r("titleAnchor",null)),align:{signal:VL}},update:l=st({},a,{opacity:Ho,text:Bi(e.title)}),exit:{opacity:At}},c={signal:`lerp(range("${e.scale}"), ${kS(0,1,.5)})`};return l.x=$i(s,c),l.y=Ba(s,c),a.angle=$i(s,At,((e,t)=>xi(e)?{signal:`(${e.signal}) * 90`}:{value:90*e})(o)),a.baseline=$i(s,Jie(s,Pd,ja),{value:Pd}),l.angle=a.angle,l.baseline=a.baseline,Qi(u,{fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),angle:r("titleAngle"),baseline:r("titleBaseline")}),function fHe(e,t,n,i){const r=(a,l)=>null!=a?(n.update[l]=Lm(Bi(a),n.update[l]),!1):!km(l,i),s=r(e("titleX"),"x"),o=r(e("titleY"),"y");n.enter.auto=o===s?Bi(o):$i(t,Bi(o),Bi(s))}(r,s,u,n),u.update.align=Lm(u.update.align,a.align),u.update.angle=Lm(u.update.angle,a.angle),u.update.baseline=Lm(u.update.baseline,a.baseline),so({type:Ph,role:"axis-title",style:PL,from:i,encode:u},n)}(e,n,i.title,d)),FS(Yv({role:"axis",from:d,encode:Nm(pHe(l,e),r,Wv),marks:h,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:s,interactive:o,style:a}),t)}function pHe(e,t){const n={enter:{},update:{}};return Qi(n,{orient:e("orient"),offset:e("offset")||0,position:Pa(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function tre(e,t,n){const i=we(e.signals),r=we(e.scales);return n||i.forEach(s=>_ie(s,t)),we(e.projections).forEach(s=>function QVe(e,t){const n=t.config.projection||{},i={};for(const r in e)"name"!==r&&(i[r]=IL(e[r],r,t));for(const r in n)null==i[r]&&(i[r]=IL(n[r],r,t));t.addProjection(e.name,i)}(s,t)),r.forEach(s=>function $Ve(e,t){const n=e.type||"linear";FJ(n)||ee("Unrecognized scale type: "+pe(n)),t.addScale(e.name,{type:n,domain:void 0})}(s,t)),we(e.data).forEach(s=>function K7e(e,t){const n=[];e.transform&&e.transform.forEach(i=>{n.push(zL(i,t))}),e.on&&e.on.forEach(i=>{Gie(i,t,e.name)}),t.addDataPipeline(e.name,function J7e(e,t,n){const i=[];let a,l,u,c,d,r=null,s=!1,o=!1;for(e.values?xi(e.values)||AS(e.format)?(i.push(Yie(t,e)),i.push(r=jh())):i.push(r=jh({$ingest:e.values,$format:e.format})):e.url?AS(e.url)||AS(e.format)?(i.push(Yie(t,e)),i.push(r=jh())):i.push(r=jh({$request:e.url,$format:e.format})):e.source&&(r=a=we(e.source).map(f=>Le(t.getData(f).output)),i.push(null)),l=0,u=n.length;l<u;++l)c=n[l],d=c.metadata,!r&&!d.source&&i.push(r=jh()),i.push(c),d.generates&&(o=!0),d.modifies&&!o&&(s=!0),d.source?r=c:d.changes&&(r=null);return a&&(u=a.length-1,i[0]=FVe({derive:s,pulse:u?a:a[0]}),(s||u)&&i.splice(1,0,jh())),r||i.push(jh()),i.push(Fh({})),i}(e,t,n))}(s,t)),r.forEach(s=>VVe(s,t)),(n||i).forEach(s=>function vVe(e,t){const n=t.getSignal(e.name);let i=e.update;e.init&&(i?ee("Signals can not include both init and update expressions."):(i=e.init,n.initonly=!0)),i&&(i=Hl(i,t),n.update=i.$expr,n.params=i.$params),e.on&&e.on.forEach(r=>function mVe(e,t,n){const i=e.encode,r={target:n};let s=e.events,o=e.update,a=[];s||ee("Signal update missing events specification."),be(s)&&(s=Fd(s,t.isSubscope()?OL:NL)),s=we(s).filter(l=>l.signal||l.scale?(a.push(l),0):1),a.length>1&&(a=[yVe(a)]),s.length&&a.push(s.length>1?{merge:s}:s[0]),null!=i&&(o&&ee("Signal encode and update are mutually exclusive."),o="encode(item(),"+pe(i)+")"),r.update=be(o)?Hl(o,t):null!=o.expr?Hl(o.expr,t):null!=o.value?o.value:null!=o.signal?{$expr:gVe,$params:{$value:t.signalRef(o.signal)}}:ee("Invalid signal update specification."),e.force&&(r.options={force:!0}),a.forEach(l=>t.addUpdate(st(function _Ve(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):qv(e,t)}}(l,t),r)))}(r,t,n.id))}(s,t)),we(e.axes).forEach(s=>hHe(s,t)),we(e.marks).forEach(s=>FS(s,t)),we(e.legends).forEach(s=>function L7e(e,t){const n=t.config.legend,i=e.encode||{},r=Ds(e,n),s=i.legend||{},o=s.name||void 0,a=s.interactive,l=s.style,u={};let d,f,h,c=0;BL.forEach(v=>e[v]?(u[v]=e[v],c=c||e[v]):0),c||ee("Missing valid scale for legend.");const p=function j7e(e,t){let n=e.type||"symbol";return!e.type&&1===function B7e(e){return BL.reduce((t,n)=>t+(e[n]?1:0),0)}(e)&&(e.fill||e.stroke)&&(n=yR(t)?OS:vR(t)?LL:"symbol"),n!==OS?n:vR(t)?LL:OS}(e,t.scaleType(c)),g={title:null!=e.title,scales:u,type:p,vgrad:"symbol"!==p&&r.isVertical()},m=Le(t.add(La(null,[g]))),y=Le(t.add(xVe(f={type:p,scale:t.scaleRef(c),count:t.objectProperty(r("tickCount")),limit:t.property(r("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===OS?(h=[c7e(e,c,n,i.gradient),Pie(e,n,i.labels,y)],f.count=f.count||t.signalRef(`max(2,2*floor((${Rh(r.gradientLength())})/100))`)):p===LL?h=[d7e(e,c,n,i.gradient,y),Pie(e,n,i.labels,y)]:(d=function g7e(e,t){const n=Ds(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(e,n),h=[p7e(e,n,i,y,Rh(d.columns))],f.size=function V7e(e,t,n){const i=Rh(Wie("size",e,n)),r=Rh(Wie("strokeWidth",e,n)),s=Rh(function H7e(e,t,n){return Rie("fontSize",e)||function l7e(e,t,n){const i=t.config.style[n];return i&&i[e]}("fontSize",t,n)}(n[1].encode,t,Gv));return Hl(`max(ceil(sqrt(${i})+${r}),${s})`,t)}(e,t,h[0].marks)),h=[Yv({role:"legend-entry",from:m,encode:{enter:{x:{value:0},y:{value:0}}},marks:h,layout:d,interactive:a})],g.title&&h.push(function C7e(e,t,n,i){const r=Ds(e,t),s={enter:{opacity:At},update:{opacity:Ho,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:At}};return Qi(s,{orient:r("titleOrient"),_anchor:r("titleAnchor"),anchor:{signal:b7e},angle:{signal:w7e},align:{signal:v7e},baseline:{signal:D7e},text:e.title,fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),baseline:r("titleBaseline")}),so({type:Ph,role:"legend-title",style:PL,from:i,encode:s},n)}(e,n,i.title,m)),FS(Yv({role:"legend",from:m,encode:Nm($7e(r,e,n),s,Wv),marks:h,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:o,interactive:a,style:l}),t)}(s,t)),e.title&&function z7e(e,t){const n=Ds(e=be(e)?{text:e}:e,t.config.title),i=e.encode||{},r=i.group||{},s=r.name||void 0,o=r.interactive,a=r.style,l=[],c=Le(t.add(La(null,[{}])));return l.push(function W7e(e,t,n,i){const r={value:0},o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return Qi(o,{text:e.text,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),so({type:Ph,role:"title-text",style:"group-title",from:i,encode:o},n)}(e,n,function q7e(e){const t=e.encode;return t&&t.title||st({name:e.name,interactive:e.interactive,style:e.style},t)}(e),c)),e.subtitle&&l.push(function Y7e(e,t,n,i){const r={value:0},o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return Qi(o,{text:e.subtitle,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),so({type:Ph,role:"title-subtitle",style:"group-subtitle",from:i,encode:o},n)}(e,n,i.subtitle,c)),FS(Yv({role:"title",from:c,encode:G7e(n,r),marks:l,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:s,interactive:o,style:a}),t)}(e.title,t),t.parseLambdas(),t}function Jv(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function nre(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function ire(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}function YL(e){return(ne(e)?yHe:vHe)(e)}function yHe(e){const t=e.length;let n="[";for(let i=0;i<t;++i){const r=e[i];n+=(i>0?",":"")+(Se(r)?r.signal||YL(r):pe(r))}return n+"]"}function vHe(e){let i,r,t="{",n=0;for(i in e)r=e[i],t+=(++n>1?",":"")+pe(i)+":"+(Se(r)?r.signal||YL(r):pe(r));return t+"}"}function wHe(e,t,n){return Se(e)||ee("Input Vega specification must be an object."),function mHe(e,t){const n=t.config,i=Le(t.root=t.add(SS())),r=function _He(e,t){const n=o=>Pa(e[o],t[o]),i=[Jv("background",n("background")),Jv("autosize",N6e(n("autosize"))),Jv("padding",I6e(n("padding"))),Jv("width",n("width")||0),Jv("height",n("height")||0)],r=i.reduce((o,a)=>(o[a.name]=a,o),{}),s={};return we(e.signals).forEach(o=>{ke(r,o.name)?o=st(r[o.name],o):i.push(o),s[o.name]=o}),we(t.signals).forEach(o=>{!ke(s,o.name)&&!ke(r,o.name)&&i.push(o)}),i}(e,n);r.forEach(u=>_ie(u,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const s=t.add(La()),o=t.add(Cie(gie((e=>Nm({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e))(e.encode),NS,SL,e.style,t,{pulse:Le(s)}))),a=t.add(xie({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:i,pulse:Le(o)}));t.operators.pop(),t.pushState(Le(o),Le(a),null),tre(e,t,r),t.operators.push(a);let l=t.add(wie({mark:i,pulse:Le(a)}));return l=t.add(Sie({pulse:Le(l)})),l=t.add(Fh({pulse:Le(l)})),t.addData("root",new Lh(t,s,s,l)),t}(e,new nre(t=Tg(function bHe(){const e="sans-serif",i="#4c78a8",r="#000",s="#888",o="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i},area:{fill:i},image:null,line:{stroke:i,strokeWidth:2},path:{stroke:i},rect:{fill:i},rule:{stroke:r},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:r,font:e,fontSize:11},trail:{fill:i,size:2},style:{"guide-label":{fill:r,font:e,fontSize:10},"guide-title":{fill:r,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:o}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:s,grid:!1,gridWidth:1,gridColor:o,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:s,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:o,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:s,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}(),t,e.config),n)).toRuntime()}nre.prototype=ire.prototype={parse(e){return tre(e,this)},fork(){return new ire(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof ML?Le(e):e;return this.add(RVe({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(i,r,s){let o,a;i&&(o=i.data||(i.data={}),a=o[r]||(o[r]=[]),a.push(s))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const i in t.index)n(t.index[i],e,"index:"+i)}return this},pushState(e,t,n){this._encode.push(Le(this.add(Fh({pulse:e})))),this._parent.push(t),this._lookup.push(n?Le(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return bt(this._parent)},encode(){return bt(this._encode)},lookup(){return bt(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(be(e))return zv(e,t);e.signal||ee("Unsupported field reference: "+pe(e));const n=e.signal;let i=this.field[n];if(!i){const r={name:this.signalRef(n)};t&&(r.as=t),this.field[n]=i=Le(this.add(EVe(r)))}return i},compareRef(e){let t=!1;const n=s=>xi(s)?(t=!0,this.signalRef(s.signal)):function uVe(e){return e&&e.expr}(s)?(t=!0,this.exprRef(s.expr)):s,i=we(e.field).map(n),r=we(e.order).map(n);return t?Le(this.add(Die({fields:i,orders:r}))):yie(i,r)},keyRef(e,t){let n=!1;const r=this.signals;return e=we(e).map(s=>xi(s)?(n=!0,Le(r[s.signal])):s),n?Le(this.add(SVe({fields:e,flat:t}))):function sVe(e,t){const n={$key:e};return t&&(n.$flat=!0),n}(e,t)},sortRef(e){if(!e)return e;const t=xS(e.op,e.field),n=e.order||"ascending";return n.signal?Le(this.add(Die({fields:t,orders:this.signalRef(n.signal)}))):yie(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:e,type:t}),this.events[n]=i}return this.events[n]},hasOwnSignal(e){return ke(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&ee("Duplicate signal name: "+pe(e));const n=t instanceof ML?t:this.add(SS(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||ee("Unrecognized signal name: "+pe(e)),this.signals[e]},signalRef(e){return this.signals[e]?Le(this.signals[e]):(ke(this.lambdas,e)||(this.lambdas[e]=this.add(SS(null))),Le(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const i=e[t],r=Hl(i,this),s=this.lambdas[i];s.params=r.$params,s.update=r.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return e&&Se(e)?this.signalRef(e.signal||YL(e)):e},exprRef(e,t){const n={expr:Hl(e,this)};return t&&(n.expr.$name=t),Le(this.add(DVe(n)))},addBinding(e,t){this.bindings||ee("Nested signals do not support binding: "+pe(e)),this.bindings.push(st({signal:e},t))},addScaleProj(e,t){ke(this.scales,e)&&ee("Duplicate scale or projection name: "+pe(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,PVe(t))},addProjection(e,t){this.addScaleProj(e,IVe(t))},getScale(e){return this.scales[e]||ee("Unrecognized scale name: "+pe(e)),this.scales[e]},scaleRef(e){return Le(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return ke(this.data,e)&&ee("Duplicate data set name: "+pe(e)),this.data[e]=t},getData(e){return this.data[e]||ee("Undefined data set name: "+pe(e)),this.data[e]},addDataPipeline(e,t){return ke(this.data,e)&&ee("Duplicate data set name: "+pe(e)),this.addData(e,Lh.fromEntries(this,t))}};var DHe="5.22.1";st(zg,Xt,ct,Yn,Nt,Os,Tt,Ns,mt,qi,po,Xo);var EHe={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},SHe={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},xHe={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const AHe=Array.prototype.slice,Bh=(e,t,n)=>{const i=n?n(t[0]):t[0];return i[e].apply(i,AHe.call(t,1))};var THe={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:(e,t,n,i,r,s,o)=>new Date(e,t||0,null!=n?n:1,i||0,r||0,s||0,o||0),date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return Bh("join",arguments)},indexof:function(){return Bh("indexOf",arguments)},lastindexof:function(){return Bh("lastIndexOf",arguments)},slice:function(){return Bh("slice",arguments)},reverse:e=>e.slice().reverse(),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return Bh("substring",arguments,String)},split:function(){return Bh("split",arguments,String)},replace:function(){return Bh("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const OHe=["view","item","group","xy","x","y"],NHe={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:"datum"===n?e.datum:"event"===n?e.event:"item"===n?e.item:EHe[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,i=e(t.object);n&&(e.memberDepth+=1);const r=e(t.property);return n&&(e.memberDepth-=1),i[r]},CallExpression:(e,t)=>{const n=t.arguments;let i=t.callee.name;return i.startsWith("_")&&(i=i.slice(1)),"if"===i?e(n[0])?e(n[1]):e(n[2]):(e.fn[i]||THe[i]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>SHe[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>xHe[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>"&&"===t.operator?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,i)=>{e.memberDepth+=1;const r=e(i.key);return e.memberDepth-=1,n[r]=e(i.value),n},{})};function Xv(e,t,n,i,r,s){const o=a=>NHe[a.type](o,a);return o.memberDepth=0,o.fn=Object.create(t),o.params=n,o.datum=i,o.event=r,o.item=s,OHe.forEach(a=>o.fn[a]=(...l)=>r.vega[a](...l)),o(e)}var kHe={operator(e,t){const n=t.ast,i=e.functions;return r=>Xv(n,i,r)},parameter(e,t){const n=t.ast,i=e.functions;return(r,s)=>Xv(n,i,s,r)},event(e,t){const n=t.ast,i=e.functions;return r=>Xv(n,i,void 0,void 0,r)},handler(e,t){const n=t.ast,i=e.functions;return(r,s)=>Xv(n,i,r,s.item&&s.item.datum,s)},encode(e,t){const{marktype:n,channels:i}=t,r=e.functions,s="group"===n||"image"===n||"rect"===n;return(o,a)=>{const l=o.datum;let c,u=0;for(const d in i)c=Xv(i[d].ast,r,a,l,void 0,o),o[d]!==c&&(o[d]=c,u=1);return"rule"!==n&&function CHe(e,t,n){let i;t.x2&&(t.x?(n&&e.x>e.x2&&(i=e.x,e.x=e.x2,e.x2=i),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(i=e.y,e.y=e.y2,e.y2=i),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}(o,i,s),u}}};Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,i){return Array.isArray(i)?n.push.apply(n,e.call(i,t-1)):n.push(i),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var RHe=de(478),FHe=de.n(RHe),PHe=de(559),LHe=de.n(PHe),jHe=de(245),KL=de.n(jHe);function JL(e){return!!e.or}function XL(e){return!!e.and}function QL(e){return!!e.not}function LS(e,t){if(QL(e))LS(e.not,t);else if(XL(e))for(const n of e.and)LS(n,t);else if(JL(e))for(const n of e.or)LS(n,t);else t(e)}function Bm(e,t){return QL(e)?{not:Bm(e.not,t)}:XL(e)?{and:e.and.map(n=>Bm(n,t))}:JL(e)?{or:e.or.map(n=>Bm(n,t))}:t(e)}const Ul=LHe(),nt=FHe();function rre(e){throw new Error(e)}function $m(e,t){const n={};for(const i of t)ke(e,i)&&(n[i]=e[i]);return n}function oo(e,t){const n=Object.assign({},e);for(const i of t)delete n[i];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>KL()(e)).join(",")})`};const mn=KL();function wt(e){if(en(e))return e;const t=be(e)?e:KL()(e);if(t.length<250)return t;let n=0;for(let i=0;i<t.length;i++)n=(n<<5)-n+t.charCodeAt(i),n&=n;return n}function ZL(e){return!1===e||null===e}function Dt(e,t){return e.includes(t)}function $h(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function ej(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function sre(e,...t){for(const n of t)BHe(e,null!=n?n:{});return e}function BHe(e,t){for(const n of oe(t))Og(e,n,t[n],!0)}function zl(e,t){const n=[],i={};let r;for(const s of e)r=t(s),!(r in i)&&(i[r]=1,n.push(s));return n}function $He(e,t){const n=oe(e),i=oe(t);if(n.length!==i.length)return!1;for(const r of n)if(e[r]!==t[r])return!1;return!0}function ore(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function tj(e,t){for(const n of e)if(t.has(n))return!0;return!1}function nj(e){const t=new Set;for(const n of e){const r=bl(n).map((o,a)=>0===a?o:`[${o}]`),s=r.map((o,a)=>r.slice(0,a+1).join(""));for(const o of s)t.add(o)}return t}function ij(e,t){return void 0===e||void 0===t||tj(nj(e),nj(t))}function nn(e){return 0===oe(e).length}const oe=Object.keys,Er=Object.values,Ld=Object.entries;function Qv(e){return!0===e||!1===e}function Fn(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function Zv(e,t){return QL(e)?`!(${Zv(e.not,t)})`:XL(e)?`(${e.and.map(n=>Zv(n,t)).join(") && (")})`:JL(e)?`(${e.or.map(n=>Zv(n,t)).join(") || (")})`:t(e)}function jS(e,t){if(0===t.length)return!0;const n=t.shift();return n in e&&jS(e[n],t)&&delete e[n],nn(e)}function e1(e){return e.charAt(0).toUpperCase()+e.substr(1)}function rj(e,t="datum"){const n=bl(e),i=[];for(let r=1;r<=n.length;r++){const s=`[${n.slice(0,r).map(pe).join("][")}]`;i.push(`${t}${s}`)}return i.join(" && ")}function are(e,t="datum"){return`${t}[${pe(bl(e).join("."))}]`}function VHe(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Uo(e){return`${bl(e).map(VHe).join("\\.")}`}function Vh(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function sj(e){return`${bl(e).join(".")}`}function Vm(e){return e?bl(e).length:0}function hi(...e){for(const t of e)if(void 0!==t)return t}let lre=42;function ure(e){const t=++lre;return e?String(e)+t:t}function HHe(){lre=42}function cre(e){return dre(e)?e:`__${e}`}function dre(e){return e.startsWith("__")}function t1(e){if(void 0!==e)return(e%360+360)%360}function BS(e){return!!en(e)||!isNaN(e)&&!isNaN(parseFloat(e))}var n1=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};const ec="row",tc="column",$S="facet",Bn="x",Vi="y",$a="x2",ql="y2",jd="xOffset",Hm="yOffset",Gl="radius",nc="radius2",Va="theta",ic="theta2",Wl="latitude",Yl="longitude",Ha="latitude2",zo="longitude2",Cs="color",Kl="fill",Jl="stroke",Es="shape",rc="size",Hh="angle",sc="opacity",Bd="fillOpacity",$d="strokeOpacity",Vd="strokeWidth",Hd="strokeDash",i1="text",r1="order",s1="detail",VS="key",Uh="tooltip",HS="href",US="url",zS="description",fre={theta:1,theta2:1,radius:1,radius2:1};function hre(e){return e in fre}const oj={longitude:1,longitude2:1,latitude:1,latitude2:1},GHe=oe(oj),qS=Object.assign(Object.assign(Object.assign(Object.assign({},{x:1,y:1,x2:1,y2:1}),fre),oj),{xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function Um(e){return e===Cs||e===Kl||e===Jl}const pre={row:1,column:1,facet:1},qo=oe(pre),GS=Object.assign(Object.assign({},qS),pre),WHe=oe(GS),aj=n1(GS,["order","detail","tooltip"]),gre=n1(aj,["row","column","facet"]);function YHe(e){return!!gre[e]}function mre(e){return!!GS[e]}oe(aj),oe(gre);const KHe=[$a,ql,Ha,zo,ic,nc];function _re(e){return zh(e)!==e}function zh(e){switch(e){case $a:return Bn;case ql:return Vi;case Ha:return Wl;case zo:return Yl;case ic:return Va;case nc:return Gl}return e}function Ud(e){if(hre(e))switch(e){case Va:return"startAngle";case ic:return"endAngle";case Gl:return"outerRadius";case nc:return"innerRadius"}return e}function oc(e){switch(e){case Bn:return $a;case Vi:return ql;case Wl:return Ha;case Yl:return zo;case Va:return ic;case Gl:return nc}}function Ss(e){switch(e){case Bn:case $a:return"width";case Vi:case ql:return"height"}}function yre(e){switch(e){case Bn:return"xOffset";case Vi:return"yOffset"}}function vre(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const XHe=oe(qS),WS=n1(qS,["x","y","x2","y2","xOffset","yOffset","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),QHe=oe(WS),lj={x:1,y:1},Xl=oe(lj);function Zi(e){return e in lj}const uj={theta:1,radius:1},ZHe=oe(uj);function YS(e){return"width"===e?Bn:Vi}const cj={xOffset:1,yOffset:1};function zm(e){return e in cj}oe(cj);const bre=n1(WS,["text","tooltip","href","url","description","detail","key","order"]),e9e=oe(bre),wre=Object.assign(Object.assign(Object.assign(Object.assign({},lj),uj),cj),bre),KS=oe(wre);function zd(e){return!!wre[e]}const dj={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},r9e=n1(dj,["geoshape"]);function fj(e){switch(e){case Bn:case Vi:case Va:case Gl:case jd:case Hm:case rc:case Hh:case Vd:case sc:case Bd:case $d:case $a:case ql:case ic:case nc:return;case $S:case ec:case tc:case Es:case Hd:case i1:case Uh:case HS:case US:case zS:return"discrete";case Cs:case Kl:case Jl:return"flexible";case Wl:case Yl:case Ha:case zo:case s1:case VS:case r1:return}}const o9e={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},a9e={count:1,min:1,max:1};function ac(e){return!!e&&!!e.argmin}function qd(e){return!!e&&!!e.argmax}function hj(e){return be(e)&&!!o9e[e]}const l9e=new Set(["count","valid","missing","distinct"]);function Dre(e){return be(e)&&l9e.has(e)}const c9e=new Set(["count","sum","distinct","valid","missing"]),d9e=new Set(["mean","average","median","q1","q3","min","max"]);function Cre(e){return Uc(e)&&(e=_x(e,void 0)),"bin"+oe(e).map(t=>JS(e[t])?Fn(`_${t}_${Ld(e[t])}`):Fn(`_${t}_${e[t]}`)).join("")}function _n(e){return!0===e||qh(e)&&!e.binned}function es(e){return"binned"===e||qh(e)&&!0===e.binned}function qh(e){return Se(e)}function JS(e){return null==e?void 0:e.param}function Ere(e){switch(e){case ec:case tc:case rc:case Cs:case Kl:case Jl:case Vd:case sc:case Bd:case $d:case Es:return 6;case Hd:return 4;default:return 10}}function o1(e){return e&&!!e.expr}function xs(e){const t=oe(e||{}),n={};for(const i of t)n[i]=ao(e[i]);return n}function Sre(e){const{anchor:t,frame:n,offset:i,orient:r,angle:s,limit:o,color:a,subtitleColor:l,subtitleFont:u,subtitleFontSize:c,subtitleFontStyle:d,subtitleFontWeight:f,subtitleLineHeight:h,subtitlePadding:p}=e,g=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["anchor","frame","offset","orient","angle","limit","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),m=Object.assign(Object.assign({},g),a?{fill:a}:{}),_=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),i?{offset:i}:{}),r?{orient:r}:{}),void 0!==s?{angle:s}:{}),void 0!==o?{limit:o}:{}),y=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{subtitleColor:l}:{}),u?{subtitleFont:u}:{}),c?{subtitleFontSize:c}:{}),d?{subtitleFontStyle:d}:{}),f?{subtitleFontWeight:f}:{}),h?{subtitleLineHeight:h}:{}),p?{subtitlePadding:p}:{});return{titleMarkConfig:m,subtitleMarkConfig:$m(e,["align","baseline","dx","dy","limit"]),nonMarkTitleProperties:_,subtitle:y}}function Gd(e){return be(e)||ne(e)&&be(e[0])}function Re(e){return e&&!!e.signal}function Wd(e){return!!e.step}function lc(e){return!ne(e)&&"field"in e&&"data"in e}const g9e=oe({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1}),m9e={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},pj=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];var gj=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function xre(e){const t=ne(e.condition)?e.condition.map(Are):Are(e.condition);return Object.assign(Object.assign({},ao(e)),{condition:t})}function ao(e){if(o1(e)){const{expr:t}=e,n=gj(e,["expr"]);return Object.assign({signal:t},n)}return e}function Are(e){if(o1(e)){const{expr:t}=e,n=gj(e,["expr"]);return Object.assign({signal:t},n)}return e}function Cn(e){if(o1(e)){const{expr:t}=e,n=gj(e,["expr"]);return Object.assign({signal:t},n)}return Re(e)?e:void 0!==e?{value:e}:void 0}function _9e(e){return Re(e)?e.signal:pe(e)}function Mre(e){return Re(e)?e.signal:pe(e.value)}function uc(e){return Re(e)?e.signal:null==e?null:pe(e)}function Tre(e){var t;return[].concat(e.type,null!==(t=e.style)&&void 0!==t?t:[])}function Wt(e,t,n,i={}){const{vgChannel:r,ignoreVgConfig:s}=i;return r&&void 0!==t[r]?t[r]:void 0!==t[e]?t[e]:!s||r&&r!==e?Gh(e,t,n,i):void 0}function Gh(e,t,n,{vgChannel:i}={}){return hi(i?XS(e,t,n.style):void 0,XS(e,t,n.style),i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function XS(e,t,n){return Ore(e,Tre(t),n)}function Ore(e,t,n){let i;t=we(t);for(const r of t){const s=n[r];s&&void 0!==s[e]&&(i=s[e])}return i}function Nre(e,t){return we(e).reduce((n,i)=>{var r;return n.field.push(_e(i,t)),n.order.push(null!==(r=i.sort)&&void 0!==r?r:"ascending"),n},{field:[],order:[]})}function kre(e,t){const n=[...e];return t.forEach(i=>{for(const r of n)if(Ul(r,i))return;n.push(i)}),n}function Ire(e,t){return Ul(e,t)||!t?e:e?[...we(e),...we(t)].join(", "):t}function Rre(e,t){const n=e.value,i=t.value;if(null==n||null===i)return{explicit:e.explicit,value:null};if((Gd(n)||Re(n))&&(Gd(i)||Re(i)))return{explicit:e.explicit,value:Ire(n,i)};if(Gd(n)||Re(n))return{explicit:e.explicit,value:n};if(Gd(i)||Re(i))return{explicit:e.explicit,value:i};if(!(Gd(n)||Re(n)||Gd(i)||Re(i)))return{explicit:e.explicit,value:kre(n,i)};throw new Error("It should never reach here")}function mj(e){return`Invalid specification ${mn(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}function Fre(e){return("width"==e?"Width":"Height")+' "container" only works for single views and layered views.'}function Pre(e){return`${"width"==e?"Width":"Height"} "container" only works well with autosize "fit" or "fit-${"width"==e?"x":"y"}".`}function Lre(e){return e?`Dropping "fit-${e}" because spec has discrete ${Ss(e)}.`:'Dropping "fit" because spec has discrete size.'}function _j(e){return`Unknown field for ${e}. Cannot calculate view size.`}function jre(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function b9e(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function Bre(e){return`Selection not supported for ${e} yet.`}function $re(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}function Vre(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}function I9e(e){return`Ignoring an invalid transform: ${mn(e)}.`}function Hre(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function L9e(e){return`${e}Offset dropped because ${e} is continuous`}function j9e(e){return`There is no ${e} encoding. Replacing ${e}Offset encoding as ${e}.`}function Ure(e){return`Invalid field type "${e}".`}function zre(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`}function yj(e,t){return`Dropping ${mn(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}function QS(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function z9e(e){return`${e} encoding has no scale, so specified scale is ignored.`}function q9e(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function G9e(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function W9e(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function vj(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${"ordinal"===t?"order":"magnitude"}.`}function eUe(e){return`Using unaggregated domain with raw field has no effect (${mn(e)}).`}function tUe(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function nUe(e){return`Unaggregated domain is currently unsupported for log scale (${mn(e)}).`}function qre(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function Gre(e){return`The step for "${e}" is dropped because the ${"width"===e?"x":"y"} is continuous.`}const Wre="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";function ZS(e,t){return`Invalid ${e}: ${mn(t)}.`}function Yre(e){return`1D error band does not support ${e}.`}function Kre(e){return`Channel ${e} is required for "binned" bin.`}const Jre=EN(CN);let Ql=Jre;function ce(...e){Ql.warn(...e)}function Wh(e){if(e&&Se(e))for(const t of wj)if(t in e)return!0;return!1}const Qre=["january","february","march","april","may","june","july","august","september","october","november","december"],xUe=Qre.map(e=>e.substr(0,3)),Zre=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],AUe=Zre.map(e=>e.substr(0,3));function bj(e,t){const n=[];if(t&&void 0!==e.day&&oe(e).length>1&&(ce(function mUe(e){return`Dropping day from datetime ${mn(e)} as day cannot be combined with other units.`}(e)),delete(e=nt(e)).day),n.push(void 0!==e.year?e.year:2012),void 0!==e.month){const i=t?function TUe(e){if(BS(e)&&(e=+e),en(e))return e-1;{const t=e.toLowerCase(),n=Qre.indexOf(t);if(-1!==n)return n;const i=t.substr(0,3),r=xUe.indexOf(i);if(-1!==r)return r;throw new Error(ZS("month",e))}}(e.month):e.month;n.push(i)}else if(void 0!==e.quarter){const i=t?function MUe(e){if(BS(e)&&(e=+e),en(e))return e>4&&ce(ZS("quarter",e)),e-1;throw new Error(ZS("quarter",e))}(e.quarter):e.quarter;n.push(en(i)?3*i:`${i}*3`)}else n.push(0);if(void 0!==e.date)n.push(e.date);else if(void 0!==e.day){const i=t?function OUe(e){if(BS(e)&&(e=+e),en(e))return e%7;{const t=e.toLowerCase(),n=Zre.indexOf(t);if(-1!==n)return n;const i=t.substr(0,3),r=AUe.indexOf(i);if(-1!==r)return r;throw new Error(ZS("day",e))}}(e.day):e.day;n.push(en(i)?i+1:`${i}+1`)}else n.push(1);for(const i of["hours","minutes","seconds","milliseconds"]){const r=e[i];n.push(void 0===r?0:r)}return n}function l1(e){const n=bj(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}const ese={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},wj=oe(ese);function Dj(e){return e.startsWith("utc")}const PUe={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function Cj(e){return wj.filter(t=>tse(e,t))}function tse(e,t){const n=e.indexOf(t);return!(n<0||n>0&&"seconds"===t&&"i"===e.charAt(n-1)||e.length>n+3&&"day"===t&&"o"===e.charAt(n+3)||n>0&&"year"===t&&"f"===e.charAt(n-1))}function nse(e){if(!e)return;const t=Cj(e);return`timeUnitSpecifier(${mn(t)}, ${mn(PUe)})`}function ts(e){if(!e)return;let t;return be(e)?t={unit:e}:Se(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),Dj(t.unit)&&(t.utc=!0,t.unit=function FUe(e){return e.substr(3)}(t.unit)),t}function Ej(e){return e&&!!e.field&&void 0!==e.equal}function Sj(e){return e&&!!e.field&&void 0!==e.lt}function xj(e){return e&&!!e.field&&void 0!==e.lte}function Aj(e){return e&&!!e.field&&void 0!==e.gt}function Mj(e){return e&&!!e.field&&void 0!==e.gte}function Tj(e){if(null==e?void 0:e.field){if(ne(e.range)&&2===e.range.length)return!0;if(Re(e.range))return!0}return!1}function Oj(e){return e&&!!e.field&&(ne(e.oneOf)||ne(e.in))}function ise(e){return Oj(e)||Ej(e)||Tj(e)||Sj(e)||Aj(e)||xj(e)||Mj(e)}function Zl(e,t){return yx(e,{timeUnit:t,wrapTime:!0})}function rse(e,t=!0){var n;const{field:i}=e,r=null===(n=ts(e.timeUnit))||void 0===n?void 0:n.unit,s=r?`time(${function LUe(e,t,{end:n}={end:!1}){const i=rj(t),r=Dj(e)?"utc":"";function s(l){return"quarter"===l?`(${r}quarter(${i})-1)`:`${r}${l}(${i})`}let o;const a={};for(const l of wj)tse(e,l)&&(a[l]=s(l),o=l);return n&&(a[o]+="+1"),function NUe(e){const n=bj(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}(a)}(r,i)})`:_e(e,{expr:"datum"});if(Ej(e))return`${s}===${Zl(e.equal,r)}`;if(Sj(e))return`${s}<${Zl(e.lt,r)}`;if(Aj(e))return`${s}>${Zl(e.gt,r)}`;if(xj(e))return`${s}<=${Zl(e.lte,r)}`;if(Mj(e))return`${s}>=${Zl(e.gte,r)}`;if(Oj(e))return`indexof([${function HUe(e,t){return e.map(n=>Zl(n,t))}(e.oneOf,r).join(",")}], ${s}) !== -1`;if(function VUe(e){return e&&!!e.field&&void 0!==e.valid}(e))return Nj(s,e.valid);if(Tj(e)){const{range:o}=e,a=Re(o)?{signal:`${o.signal}[0]`}:o[0],l=Re(o)?{signal:`${o.signal}[1]`}:o[1];if(null!==a&&null!==l&&t)return"inrange("+s+", ["+Zl(a,r)+", "+Zl(l,r)+"])";const u=[];return null!==a&&u.push(`${s} >= ${Zl(a,r)}`),null!==l&&u.push(`${s} <= ${Zl(l,r)}`),u.length>0?u.join(" && "):"true"}throw new Error(`Invalid field predicate: ${mn(e)}`)}function Nj(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function UUe(e){var t;return ise(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:null===(t=ts(e.timeUnit))||void 0===t?void 0:t.unit}):e}const Yh={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function zUe(e){return"quantitative"===e||"temporal"===e}function sse(e){return"ordinal"===e||"nominal"===e}const Kh=Yh.quantitative,kj=Yh.ordinal,qm=Yh.temporal,Ij=Yh.nominal,Gm=Yh.geojson;oe(Yh);const ex={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function WUe(e,t){const n=ex[e],i=ex[t];return n===i||"ordinal-position"===n&&"time"===i||"ordinal-position"===i&&"time"===n}oe(ex);const YUe={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function ose(e){return YUe[e]}const ase=new Set(["linear","log","pow","sqrt","symlog"]),lse=new Set([...ase,"time","utc"]);function use(e){return ase.has(e)}const cse=new Set(["quantile","quantize","threshold"]),KUe=new Set([...lse,...cse,"sequential","identity"]),JUe=new Set(["ordinal","bin-ordinal","point","band"]);function Hi(e){return JUe.has(e)}function lo(e){return KUe.has(e)}function Ua(e){return lse.has(e)}function Wm(e){return cse.has(e)}function dse(e){return null==e?void 0:e.param}const Rj={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},tze=(oe(Rj),function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(Rj,["type","domain","range","rangeMax","rangeMin","scheme"])),nze=oe(tze);function Fj(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return Ua(e)||"band"===e||"point"===e;case"padding":case"rangeMin":case"rangeMax":return Ua(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return"band"===e;case"domainMax":case"domainMid":case"domainMin":case"clamp":return Ua(e);case"nice":return Ua(e)||"quantize"===e||"threshold"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"constant":return"symlog"===e;case"zero":return lo(e)&&!Dt(["log","time","utc","threshold","quantile"],e)}}function fse(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return Um(e)?void 0:function Q9e(e){return`Cannot use the scale property "${e}" with non-color channel.`}(e);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}const Sr={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},hse=Sr.arc,tx=Sr.area,nx=Sr.bar,sze=Sr.image,ix=Sr.line,rx=Sr.point,oze=Sr.rect,sx=Sr.rule,pse=Sr.text,Pj=Sr.tick,aze=Sr.trail,Lj=Sr.circle,jj=Sr.square,gse=Sr.geoshape;function Kd(e){return["line","area","trail"].includes(e)}function mse(e){return["rect","bar","image","arc"].includes(e)}const _se=new Set(oe(Sr));function za(e){return e.type}const cze=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],yse=oe({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1}),vse=oe({mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1});function Ym(e){return e&&null!=e.band}const hze={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]};function Bj(e){const{channel:t,channelDef:n,markDef:i,scale:r,config:s}=e,o=Vj(e);return ge(n)&&!Dre(n.aggregate)&&r&&Ua(r.get("type"))?function yze({fieldDef:e,channel:t,markDef:n,ref:i,config:r}){return Kd(n.type)?i:null===Wt("invalid",n,r)?[vze(e,t),i]:i}({fieldDef:n,channel:t,markDef:i,ref:o,config:s}):o}function vze(e,t){const n=$j(e,!0),r="y"===zh(t)?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function $j(e,t=!0){return Nj(be(e)?e:_e(e,{expr:"datum"}),!t)}function Jh(e,t,n,i){const r={};if(t&&(r.scale=t),tu(e)){const{datum:s}=e;Wh(s)?r.signal=l1(s):Re(s)?r.signal=s.signal:o1(s)?r.signal=s.expr:r.value=s}else r.field=_e(e,n);if(i){const{offset:s,band:o}=i;s&&(r.offset=s),o&&(r.band=o)}return r}function ox({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,bandPosition:s=.5}){const o=0<s&&s<1?"datum":void 0,a=_e(t,{expr:o,suffix:r}),l=void 0!==n?_e(n,{expr:o}):_e(t,{suffix:"end",expr:o}),u={};if(0===s||1===s)u.scale=e,u.field=0===s?a:l;else{const c=Re(s)?`${s.signal} * ${a} + (1-${s.signal}) * ${l}`:`${s} * ${a} + ${1-s} * ${l}`;u.signal=`scale("${e}", ${c})`}return i&&(u.offset=i),u}function Vj({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:l,defaultRef:u,bandPosition:c}){var d;if(t){if(Ke(t)){const f=null==o?void 0:o.get("type");if(Go(t)){null!=c||(c=kse({fieldDef:t,fieldDef2:n,markDef:i,config:r}));const{bin:h,timeUnit:p,type:g}=t;if(_n(h)||c&&p&&g===qm)return(null==a?void 0:a.impute)?Jh(t,s,{binSuffix:"mid"},{offset:l}):c&&!Hi(f)?ox({scaleName:s,fieldOrDatumDef:t,bandPosition:c,offset:l}):Jh(t,s,f1(t,e)?{binSuffix:"range"}:{},{offset:l});if(es(h)){if(ge(n))return ox({scaleName:s,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:l});ce(Kre(e===Bn?$a:ql))}}return Jh(t,s,Hi(f)?{binSuffix:"range"}:{},{offset:l,band:"band"===f?null!==(d=null!=c?c:t.bandPosition)&&void 0!==d?d:.5:void 0})}if(qa(t)){const h=l?{offset:l}:{};return Object.assign(Object.assign({},u1(e,t.value)),h)}}return rt(u)&&(u=u()),u&&Object.assign(Object.assign({},u),l?{offset:l}:{})}function u1(e,t){return Dt(["x","x2"],e)&&"width"===t?{field:{group:"width"}}:Dt(["y","y2"],e)&&"height"===t?{field:{group:"height"}}:Cn(t)}function Xh(e){return e&&"number"!==e&&"time"!==e}function wse(e,t,n){return`${e}(${t}${n?`, ${mn(n)}`:""})`}function Hj({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s}){var o,a;if(Xh(n))return Uj({fieldOrDatumDef:e,format:t,formatType:n,expr:i,config:s});const l=Dse(e,i,r);if(Xm(e)){const u=function Cze(e,t,n,i,r){return!t||n?`${r?"utc":"time"}Format(${e}, '${n=be(n)?n:i}')`:function jUe(e,t,n){if(!e)return;const i=nse(e);return`${n||Dj(e)?"utc":"time"}Format(${t}, ${i})`}(t,e,r)}(l,ge(e)?null===(o=ts(e.timeUnit))||void 0===o?void 0:o.unit:void 0,t,s.timeFormat,Qh(e)&&"utc"===(null===(a=e.scale)||void 0===a?void 0:a.type));return u?{signal:u}:void 0}return t=Sse(fx(e),t,s),ge(e)&&_n(e.bin)?{signal:ax(l,_e(e,{expr:i,binSuffix:"end"}),t,n,s)}:t||"quantitative"===fx(e)?{signal:`${xse(l,t)}`}:{signal:`isValid(${l}) ? ${l} : ""+${l}`}}function Dse(e,t,n){return ge(e)?n?`${_e(e,{expr:t,suffix:"end"})}-${_e(e,{expr:t,suffix:"start"})}`:_e(e,{expr:t}):function bze(e){const{datum:t}=e;return Wh(t)?l1(t):`${mn(t)}`}(e)}function Uj({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s,field:o}){return null!=o||(o=Dse(e,i,r)),ge(e)&&_n(e.bin)?{signal:ax(o,_e(e,{expr:i,binSuffix:"end"}),t,n,s)}:{signal:wse(n,o,t)}}function Cse(e,t,n,i,r,s){var o;if(!Xh(i))return Xm(e)?function Dze(e,t,n,i){return e||(t?{signal:nse(t)}:i?void 0:n.timeFormat)}(n,ge(e)?null===(o=ts(e.timeUnit))||void 0===o?void 0:o.unit:void 0,r,s):Sse(t,n,r)}function Ese(e,t,n){return e&&(Re(e)||"number"===e||"time"===e)?e:Xm(t)&&"time"!==n&&"utc"!==n?"time":void 0}function Sse(e,t,n){return be(t)?t:e===Kh?n.numberFormat:void 0}function xse(e,t){return`format(${e}, "${t||""}")`}function Ase(e,t,n,i){var r;return Xh(n)?wse(n,e,t):xse(e,null!==(r=be(t)?t:void 0)&&void 0!==r?r:i.numberFormat)}function ax(e,t,n,i,r){const s=Ase(e,n,i,r),o=Ase(t,n,i,r);return`${Nj(e,!1)} ? "null" : ${s} + " \u2013 " + ${o}`}const lx="min",Eze={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function Mse(e){return e in Eze}function Tse(e){return!!e&&!!e.encoding}function eu(e){return!(!e||"count"!==e.op&&!e.field)}function Ose(e){return!!e&&ne(e)}function c1(e){return"row"in e||"column"in e}function zj(e){return!!e&&"header"in e}function ux(e){return"facet"in e}var qj=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Nse(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),i?{bin:i}:{}),r?{aggregate:r}:{}),{field:t})}function Gj(e){return"sort"in e}function kse({fieldDef:e,fieldDef2:t,markDef:n,config:i}){if(Ke(e)&&void 0!==e.bandPosition)return e.bandPosition;if(ge(e)){const{timeUnit:r,bin:s}=e;if(r&&!t)return mse(n.type)?0:Gh("timeUnitBandPosition",n,i);if(_n(s))return.5}}function Ise({channel:e,fieldDef:t,fieldDef2:n,markDef:i,config:r,scaleType:s,useVlSizeChannel:o}){var a,l,u;const c=Ss(e),d=Wt(o?"size":c,i,r,{vgChannel:c});if(void 0!==d)return d;if(ge(t)){const{timeUnit:f,bin:h}=t;if(f&&!n)return{band:Gh("timeUnitBandSize",i,r)};if(_n(h)&&!Hi(s))return{band:1}}return mse(i.type)?s?Hi(s)?(null===(a=r[i.type])||void 0===a?void 0:a.discreteBandSize)||{band:1}:null===(l=r[i.type])||void 0===l?void 0:l.continuousBandSize:null===(u=r[i.type])||void 0===u?void 0:u.discreteBandSize:void 0}function Rse(e,t,n,i){return!!(_n(e.bin)||e.timeUnit&&Go(e)&&"temporal"===e.type)&&void 0!==kse({fieldDef:e,fieldDef2:t,markDef:n,config:i})}function cx(e){return e&&"condition"in e}function dx(e){const t=e&&e.condition;return!!t&&!ne(t)&&ge(t)}function d1(e){const t=e&&e.condition;return!!t&&!ne(t)&&Ke(t)}function ge(e){return e&&(!!e.field||"count"===e.aggregate)}function fx(e){return e&&e.type}function tu(e){return e&&"datum"in e}function nu(e){return Go(e)&&!px(e)||hx(e)}function hx(e){return tu(e)&&en(e.datum)}function Ke(e){return ge(e)||tu(e)}function Go(e){return e&&("field"in e||"count"===e.aggregate)&&"type"in e}function qa(e){return e&&"value"in e&&"value"in e}function Qh(e){return e&&("scale"in e||"sort"in e)}function Wj(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function Fse(e){return e&&"legend"in e}function Pse(e){return e&&("format"in e||"formatType"in e)}function Mze(e){return oo(e,["legend","axis","header","scale"])}function _e(e,t={}){var n,i,r;let s=e.field;const o=t.prefix;let a=t.suffix,l="";if(function Nze(e){return"count"===e.aggregate}(e))s=cre("count");else{let u;if(!t.nofn)if(function Tze(e){return"op"in e}(e))u=e.op;else{const{bin:c,aggregate:d,timeUnit:f}=e;_n(c)?(u=Cre(c),a=(null!==(n=t.binSuffix)&&void 0!==n?n:"")+(null!==(i=t.suffix)&&void 0!==i?i:"")):d?qd(d)?(l=`["${s}"]`,s=`argmax_${d.argmax}`):ac(d)?(l=`["${s}"]`,s=`argmin_${d.argmin}`):u=String(d):f&&(u=function BUe(e){const t=ts(e),{utc:n}=t,i=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["utc"]);return i.unit?(n?"utc":"")+oe(i).map(r=>Fn(`${"unit"===r?"":`_${r}_`}${i[r]}`)).join(""):(n?"utc":"")+"timeunit"+oe(i).map(r=>Fn(`_${r}_${i[r]}`)).join("")}(f),a=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(null!==(r=t.suffix)&&void 0!==r?r:""))}u&&(s=s?`${u}_${s}`:u)}return a&&(s=`${s}_${a}`),o&&(s=`${o}_${s}`),t.forAs?sj(s):t.expr?are(s,t.expr)+l:Uo(s)+l}function px(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return ge(e)&&!!e.bin;case"temporal":return!1}throw new Error(Ure(e.type))}const Lse=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return function Ize(e){const{aggregate:t,bin:n,timeUnit:i,field:r}=e;if(qd(t))return`${r} for argmax(${t.argmax})`;if(ac(t))return`${r} for argmin(${t.argmin})`;const s=ts(i),o=t||(null==s?void 0:s.unit)||(null==s?void 0:s.maxbins)&&"timeunit"||_n(n)&&"bin";return o?`${o.toUpperCase()}(${r})`:r}(e);default:return function kze(e,t){var n;const{field:i,bin:r,timeUnit:s,aggregate:o}=e;if("count"===o)return t.countTitle;if(_n(r))return`${i} (binned)`;if(s){const a=null===(n=ts(s))||void 0===n?void 0:n.unit;if(a)return`${i} (${Cj(a).join("-")})`}else if(o)return qd(o)?`${i} for max ${o.argmax}`:ac(o)?`${i} for min ${o.argmin}`:`${e1(o)} of ${i}`;return i}(e,t)}};let jse=Lse;function Bse(e){jse=e}function Km(e,t,{allowDisabling:n,includeDefault:i=!0}){var r,s;const o=null===(r=Yj(e))||void 0===r?void 0:r.title;if(!ge(e))return null!=o?o:e.title;const a=e,l=i?Kj(a,t):void 0;return n?hi(o,a.title,l):null!==(s=null!=o?o:a.title)&&void 0!==s?s:l}function Yj(e){return Wj(e)&&e.axis?e.axis:Fse(e)&&e.legend?e.legend:zj(e)&&e.header?e.header:void 0}function Kj(e,t){return jse(e,t)}function gx(e){var t;if(Pse(e)){const{format:n,formatType:i}=e;return{format:n,formatType:i}}{const n=null!==(t=Yj(e))&&void 0!==t?t:{},{format:i,formatType:r}=n;return{format:i,formatType:r}}}function iu(e){return ge(e)?e:dx(e)?e.condition:void 0}function Ai(e){return Ke(e)?e:d1(e)?e.condition:void 0}function $se(e,t,n,i={}){return be(e)||en(e)||Uc(e)?(ce(function B9e(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${mn(n)}}.`}(t,be(e)?"string":en(e)?"number":"boolean",e)),{value:e}):Ke(e)?mx(e,t,n,i):d1(e)?Object.assign(Object.assign({},e),{condition:mx(e.condition,t,n,i)}):e}function mx(e,t,n,i){if(Pse(e)){const{formatType:s}=e,o=qj(e,["format","formatType"]);if(Xh(s)&&!n.customFormatTypes)return ce(Hre(t)),mx(o,t,n,i)}else{const r=Wj(e)?"axis":Fse(e)?"legend":zj(e)?"header":null;if(r&&e[r]){const s=e[r],{formatType:a}=s,l=qj(s,["format","formatType"]);if(Xh(a)&&!n.customFormatTypes)return ce(Hre(t)),mx(Object.assign(Object.assign({},e),{[r]:l}),t,n,i)}}return ge(e)?Jj(e,t,i):function Pze(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=en(n)?"quantitative":be(n)?"nominal":Wh(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}(e)}function Jj(e,t,{compositeMark:n=!1}={}){const{aggregate:i,timeUnit:r,bin:s,field:o}=e,a=Object.assign({},e);if(!n&&i&&!hj(i)&&!qd(i)&&!ac(i)&&(ce(function V9e(e){return`Invalid aggregation operator "${e}".`}(i)),delete a.aggregate),r&&(a.timeUnit=ts(r)),o&&(a.field=`${o}`),_n(s)&&(a.bin=_x(s,t)),es(s)&&!Zi(t)&&ce(function bUe(e){return`Channel ${e} should not be used with "binned" bin.`}(t)),Go(a)){const{type:l}=a,u=function qUe(e){if(e)switch(e=e.toLowerCase(),e){case"q":case Kh:return"quantitative";case"t":case qm:return"temporal";case"o":case kj:return"ordinal";case"n":case Ij:return"nominal";case Gm:return"geojson"}}(l);l!==u&&(a.type=u),"quantitative"!==l&&Dre(i)&&(ce(function $9e(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}(l,i)),a.type="quantitative")}else if(!_re(t)){const l=function Fze(e,t){var n;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(Gj(e)&&ne(e.sort))return"ordinal";const{aggregate:i,bin:r,timeUnit:s}=e;if(s)return"temporal";if(r||i&&!qd(i)&&!ac(i))return"quantitative";if(Qh(e)&&(null===(n=e.scale)||void 0===n?void 0:n.type))switch(ex[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}(a,t);a.type=l}if(Go(a)){const{compatible:l,warning:u}=function Lze(e,t){const n=e.type;if("geojson"===n&&"shape"!==t)return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case ec:case tc:case $S:return px(e)?Jm:{compatible:!1,warning:G9e(t)};case Bn:case Vi:case jd:case Hm:case Cs:case Kl:case Jl:case i1:case s1:case VS:case Uh:case HS:case US:case Hh:case Va:case Gl:case zS:return Jm;case Yl:case zo:case Wl:case Ha:return n!==Kh?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Jm;case sc:case Bd:case $d:case Vd:case rc:case ic:case nc:case $a:case ql:return"nominal"!==n||e.sort?Jm:{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`};case Es:case Hd:return px(e)||function Oze(e){var t;return Qh(e)&&Wm(null===(t=e.scale)||void 0===t?void 0:t.type)}(e)?Jm:{compatible:!1,warning:W9e(t)};case r1:return"nominal"!==e.type||"sort"in e?Jm:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(a,t)||{};!1===l&&ce(u)}if(Gj(a)&&be(a.sort)){const{sort:l}=a;if(Mse(l))return Object.assign(Object.assign({},a),{sort:{encoding:l}});const u=l.substr(1);if("-"===l.charAt(0)&&Mse(u))return Object.assign(Object.assign({},a),{sort:{encoding:u,order:"descending"}})}if(zj(a)){const{header:l}=a;if(l){const{orient:u}=l,c=qj(l,["orient"]);if(u)return Object.assign(Object.assign({},a),{header:Object.assign(Object.assign({},c),{labelOrient:l.labelOrient||u,titleOrient:l.titleOrient||u})})}}return a}function _x(e,t){return Uc(e)?{maxbins:Ere(t)}:"binned"===e?{binned:!0}:e.maxbins||e.step?e:Object.assign(Object.assign({},e),{maxbins:Ere(t)})}const Jm={compatible:!0};function Xm(e){const{formatType:t}=gx(e);return"time"===t||!t&&function jze(e){return e&&("temporal"===e.type||ge(e)&&!!e.timeUnit)}(e)}function yx(e,{timeUnit:t,type:n,wrapTime:i,undefinedIfExprNotRequired:r}){var s;const o=t&&(null===(s=ts(t))||void 0===s?void 0:s.unit);let l,a=o||"temporal"===n;return o1(e)?l=e.expr:Re(e)?l=e.signal:Wh(e)?(a=!0,l=l1(e)):(be(e)||en(e))&&a&&(l=`datetime(${mn(e)})`,function RUe(e){return!!ese[e]}(o)&&(en(e)&&e<1e4||be(e)&&isNaN(Date.parse(e)))&&(l=l1({[o]:e}))),l?i&&a?`time(${l})`:l:r?void 0:mn(e)}function Vse(e,t){const{type:n}=e;return t.map(i=>{const r=yx(i,{timeUnit:ge(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==r?{signal:r}:i})}function f1(e,t){return _n(e.bin)?zd(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const Hse={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function h1(e){return e&&e.condition}const Use=["domain","grid","labels","ticks","title"],Bze={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},zse={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},qse=Object.assign(Object.assign({},zse),{style:1,labelExpr:1,encoding:1});function Gse(e){return!!qse[e]}oe(qse);const Wse=oe({axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1});function cc(e){return"mark"in e}class vx{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return!!cc(t)&&function _ze(e){return za(e)?e.type:e}(t.mark)===this.name}}function Zh(e,t){const n=e&&e[t];return!!n&&(ne(n)?$h(n,i=>!!i.field):ge(n)||dx(n))}function Yse(e,t){const n=e&&e[t];return!!n&&(ne(n)?$h(n,i=>!!i.field):ge(n)||tu(n)||d1(n))}function Xj(e,t){if(Zi(t)){const n=e[t];if((ge(n)||tu(n))&&sse(n.type))return Yse(e,yre(t))}return!1}function Qj(e){return $h(WHe,t=>{if(Zh(e,t)){const n=e[t];if(ne(n))return $h(n,i=>!!i.aggregate);{const i=iu(n);return i&&!!i.aggregate}}return!1})}function Kse(e,t){const n=[],i=[],r=[],s=[],o={};return Zj(e,(a,l)=>{if(ge(a)){const{field:u,aggregate:c,bin:d,timeUnit:f}=a,h=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(a,["field","aggregate","bin","timeUnit"]);if(c||f||d){const p=Yj(a),g=null==p?void 0:p.title;let m=_e(a,{forAs:!0});const _=Object.assign(Object.assign(Object.assign({},g?[]:{title:Km(a,t,{allowDisabling:!0})}),h),{field:m});if(c){let y;if(qd(c)?(y="argmax",m=_e({op:"argmax",field:c.argmax},{forAs:!0}),_.field=`${m}.${u}`):ac(c)?(y="argmin",m=_e({op:"argmin",field:c.argmin},{forAs:!0}),_.field=`${m}.${u}`):"boxplot"!==c&&"errorbar"!==c&&"errorband"!==c&&(y=c),y){const v={op:y,as:m};u&&(v.field=u),s.push(v)}}else if(n.push(m),Go(a)&&_n(d))i.push({bin:d,field:u,as:m}),n.push(_e(a,{binSuffix:"end"})),f1(a,l)&&n.push(_e(a,{binSuffix:"range"})),Zi(l)&&(o[`${l}2`]={field:`${m}_end`}),_.bin="binned",_re(l)||(_.type=Kh);else if(f){r.push({timeUnit:f,field:u,as:m});const y=Go(a)&&a.type!==qm&&"time";y&&(l===i1||l===Uh?_.formatType=y:function t9e(e){return!!WS[e]}(l)?_.legend=Object.assign({formatType:y},_.legend):Zi(l)&&(_.axis=Object.assign({formatType:y},_.axis)))}o[l]=_}else n.push(u),o[l]=e[l]}else o[l]=e[l]}),{bins:i,timeUnits:r,aggregate:s,groupby:n,encoding:o}}function Vze(e,t,n){const i=function i9e(e,t){return function s9e(e){switch(e){case Cs:case Kl:case Jl:case zS:case s1:case VS:case Uh:case HS:case r1:case sc:case Bd:case $d:case Vd:case $S:case ec:case tc:return dj;case Bn:case Vi:case jd:case Hm:case Wl:case Yl:return r9e;case $a:case ql:case Ha:case zo:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case rc:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Hd:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case Es:return{point:"always",geoshape:"always"};case i1:return{text:"always"};case Hh:return{point:"always",square:"always",text:"always"};case US:return{image:"always"};case Va:case Gl:return{text:"always",arc:"always"};case ic:case nc:return{arc:"always"}}}(e)[t]}(t,n);if(!i)return!1;if("binned"===i){const r=e[t===$a?Bn:Vi];return!!(ge(r)&&ge(e[t])&&es(r.bin))}return!0}function bx(e,t){const n={};for(const i of oe(e)){const r=$se(e[i],i,t,{compositeMark:!0});n[i]=r}return n}function Zj(e,t,n){if(e)for(const i of oe(e)){const r=e[i];if(ne(r))for(const s of r)t.call(n,s,i);else t.call(n,r,i)}}function Jse(e,t){return oe(t).reduce((n,i)=>{switch(i){case Bn:case Vi:case HS:case zS:case US:case $a:case ql:case jd:case Hm:case Va:case ic:case Gl:case nc:case Wl:case Yl:case Ha:case zo:case i1:case Es:case Hh:case Uh:return n;case r1:if("line"===e||"trail"===e)return n;case s1:case VS:{const r=t[i];if(ne(r)||ge(r))for(const s of we(r))s.aggregate||n.push(_e(s,{}));return n}case rc:if("trail"===e)return n;case Cs:case Kl:case Jl:case sc:case Bd:case $d:case Hd:case Vd:{const r=iu(t[i]);return r&&!r.aggregate&&n.push(_e(r,{})),n}}},[])}var Xse=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function e5(e,t,n,i=!0){if("tooltip"in n)return{tooltip:n.tooltip};const r=e.map(({fieldPrefix:o,titlePrefix:a})=>{const l=i?` of ${t5(t)}`:"";return{field:o+t.field,type:t.type,title:Re(a)?{signal:`${a}"${escape(l)}"`}:a+l}}),s=function Uze(e){const t=[];for(const n of oe(e))if(Zh(e,n)){const r=we(e[n]);for(const s of r)ge(s)?t.push(s):dx(s)&&t.push(s.condition)}return t}(n).map(Mze);return{tooltip:[...r,...zl(s,wt)]}}function t5(e){const{title:t,field:n}=e;return hi(t,n)}function n5(e,t,n,i,r){const{scale:s,axis:o}=n;return({partName:a,mark:l,positionPrefix:u,endPositionPrefix:c,extraEncoding:d={}})=>{const f=t5(n);return Qse(e,a,r,{mark:l,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:`${u}_${n.field}`,type:n.type},void 0!==f?{title:f}:{}),void 0!==s?{scale:s}:{}),void 0!==o?{axis:o}:{})},be(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{}),i),d)})}}function Qse(e,t,n,i){const{clip:r,color:s,opacity:o}=e,a=e.type;return e[t]||void 0===e[t]&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),r?{clip:r}:{}),s?{color:s}:{}),o?{opacity:o}:{}),za(i.mark)?i.mark:{type:i.mark}),{style:`${a}-${t}`}),Uc(e[t])?{}:e[t])})]:[]}function Zse(e,t,n){const{encoding:i}=e,r="vertical"===t?"y":"x",o=i[`${r}2`],a=i[`${r}Error`],l=i[`${r}Error2`];return{continuousAxisChannelDef:wx(i[r],n),continuousAxisChannelDef2:wx(o,n),continuousAxisChannelDefError:wx(a,n),continuousAxisChannelDefError2:wx(l,n),continuousAxis:r}}function wx(e,t){if(null==e?void 0:e.aggregate){const{aggregate:n}=e,i=Xse(e,["aggregate"]);return n!==t&&ce(function vUe(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}(n,t)),i}return e}function eoe(e,t){const{mark:n,encoding:i}=e,{x:r,y:s}=i;if(za(n)&&n.orient)return n.orient;if(nu(r)){if(nu(s)){const o=ge(r)&&r.aggregate,a=ge(s)&&s.aggregate;if(!o&&a===t)return"vertical";if(!a&&o===t)return"horizontal";if(o===t&&a===t)throw new Error("Both x and y cannot have aggregate");return Xm(s)&&!Xm(r)?"horizontal":"vertical"}return"horizontal"}if(nu(s))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}var Dx=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};const Cx="boxplot",Wze=new vx(Cx,noe);function toe(e){return en(e)?"tukey":e}function noe(e,{config:t}){var n,i;e=Object.assign(Object.assign({},e),{encoding:bx(e.encoding,t)});const{mark:r,params:o}=e,l=Dx(e,["mark","encoding","params","projection"]),u=za(r)?r:{type:r};o&&ce(Bre("boxplot"));const c=null!==(n=u.extent)&&void 0!==n?n:t.boxplot.extent,d=Wt("size",u,t),f=toe(c),{bins:h,timeUnits:p,transform:g,continuousAxisChannelDef:m,continuousAxis:_,groupby:y,aggregate:v,encodingWithoutContinuousAxis:b,ticksOrient:D,boxOrient:C,customTooltipWithoutAggregatedField:w}=function Yze(e,t,n){const i=eoe(e,Cx),{continuousAxisChannelDef:r,continuousAxis:s}=Zse(e,i,Cx),o=r.field,a=toe(t),l=[...ioe(o),{op:"median",field:o,as:`mid_box_${o}`},{op:"min",field:o,as:("min-max"===a?"lower_whisker_":"min_")+o},{op:"max",field:o,as:("min-max"===a?"upper_whisker_":"max_")+o}],u="min-max"===a||"tukey"===a?[]:[{calculate:`datum["upper_box_${o}"] - datum["lower_box_${o}"]`,as:`iqr_${o}`},{calculate:`min(datum["upper_box_${o}"] + datum["iqr_${o}"] * ${t}, datum["max_${o}"])`,as:`upper_whisker_${o}`},{calculate:`max(datum["lower_box_${o}"] - datum["iqr_${o}"] * ${t}, datum["min_${o}"])`,as:`lower_whisker_${o}`}],h=Dx(e.encoding,["symbol"==typeof s?s:s+""]),{customTooltipWithoutAggregatedField:p,filteredEncoding:g}=function qze(e){const{tooltip:t}=e,n=Xse(e,["tooltip"]);if(!t)return{filteredEncoding:n};let i,r;if(ne(t)){for(const s of t)s.aggregate?(i||(i=[]),i.push(s)):(r||(r=[]),r.push(s));i&&(n.tooltip=i)}else t.aggregate?n.tooltip=t:r=t;return ne(r)&&1===r.length&&(r=r[0]),{customTooltipWithoutAggregatedField:r,filteredEncoding:n}}(h),{bins:m,timeUnits:_,aggregate:y,groupby:v,encoding:b}=Kse(g,n),D="vertical"===i?"horizontal":"vertical",C=i;return{bins:m,timeUnits:_,transform:[...m,..._,{aggregate:[...y,...l],groupby:v},...u],groupby:v,aggregate:y,continuousAxisChannelDef:r,continuousAxis:s,encodingWithoutContinuousAxis:b,ticksOrient:D,boxOrient:C,customTooltipWithoutAggregatedField:p}}(e,c,t),{color:E,size:T}=b,O=Dx(b,["color","size"]),N=Te=>n5(u,_,m,Te,t.boxplot),P=N(O),j=N(b),A=N(Object.assign(Object.assign({},O),T?{size:T}:{})),x=e5([{fieldPrefix:"min-max"===f?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===f?"lower_whisker_":"min_",titlePrefix:"Min"}],m,b),S={type:"tick",color:"black",opacity:1,orient:D,invalid:null,aria:!1},I="min-max"===f?x:e5([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],m,b),M=[...P({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:I}),...P({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:I}),...P({partName:"ticks",mark:S,positionPrefix:"lower_whisker",extraEncoding:I}),...P({partName:"ticks",mark:S,positionPrefix:"upper_whisker",extraEncoding:I})],L=[..."tukey"!==f?M:[],...j({partName:"box",mark:Object.assign(Object.assign({type:"bar"},d?{size:d}:{}),{orient:C,invalid:null,ariaRoleDescription:"box"}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:x}),...A({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},Se(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),d?{size:d}:{}),{orient:D,aria:!1}),positionPrefix:"mid_box",extraEncoding:x})];if("min-max"===f)return Object.assign(Object.assign({},l),{transform:(null!==(i=l.transform)&&void 0!==i?i:[]).concat(g),layer:L});const R=`datum["lower_box_${m.field}"]`,V=`datum["upper_box_${m.field}"]`,U=`(${V} - ${R})`,z=`${R} - ${c} * ${U}`,$=`${V} + ${c} * ${U}`,Y=`datum["${m.field}"]`,ie={joinaggregate:ioe(m.field),groupby:y},K={transform:[{filter:`(${z} <= ${Y}) && (${Y} <= ${$})`},{aggregate:[{op:"min",field:m.field,as:`lower_whisker_${m.field}`},{op:"max",field:m.field,as:`upper_whisker_${m.field}`},{op:"min",field:`lower_box_${m.field}`,as:`lower_box_${m.field}`},{op:"max",field:`upper_box_${m.field}`,as:`upper_box_${m.field}`},...v],groupby:y}],layer:M},G=Dx(O,["tooltip"]),{scale:Q,axis:te}=m,q=t5(m),he=oo(te,["title"]),ve=Qse(u,"outliers",t.boxplot,{transform:[{filter:`(${Y} < ${z}) || (${Y} > ${$})`}],mark:"point",encoding:Object.assign(Object.assign(Object.assign({[_]:Object.assign(Object.assign(Object.assign({field:m.field,type:m.type},void 0!==q?{title:q}:{}),void 0!==Q?{scale:Q}:{}),nn(he)?{}:{axis:he})},G),E?{color:E}:{}),w?{tooltip:w}:{})})[0];let Ne;const Ce=[...h,...p,ie];return ve?Ne={transform:Ce,layer:[ve,K]}:(Ne=K,Ne.transform.unshift(...Ce)),Object.assign(Object.assign({},l),{layer:[Ne,{transform:g,layer:L}]})}function ioe(e){return[{op:"q1",field:e,as:`lower_box_${e}`},{op:"q3",field:e,as:`upper_box_${e}`}]}var roe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};const i5="errorbar",Jze=new vx(i5,soe);function soe(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:bx(e.encoding,t)});const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,ticksOrient:o,markDef:a,outerSpec:l,tooltipEncoding:u}=ooe(e,i5,t);delete s.size;const c=n5(a,r,i,s,t.errorbar),d=a.thickness,f=a.size,h=Object.assign(Object.assign({type:"tick",orient:o,aria:!1},void 0!==d?{thickness:d}:{}),void 0!==f?{size:f}:{}),p=[...c({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:u}),...c({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:u}),...c({partName:"rule",mark:Object.assign({type:"rule",ariaRoleDescription:"errorbar"},void 0!==d?{size:d}:{}),positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u})];return Object.assign(Object.assign(Object.assign({},l),{transform:n}),p.length>1?{layer:p}:Object.assign({},p[0]))}function ooe(e,t,n){var i;const{mark:r,encoding:s,params:o}=e,l=roe(e,["mark","encoding","params","projection"]),u=za(r)?r:{type:r};o&&ce(Bre(t));const{orient:c,inputType:d}=function Xze(e,t){const{encoding:n}=e;if(function Qze(e){return(Ke(e.x)||Ke(e.y))&&!Ke(e.x2)&&!Ke(e.y2)&&!Ke(e.xError)&&!Ke(e.xError2)&&!Ke(e.yError)&&!Ke(e.yError2)}(n))return{orient:eoe(e,t),inputType:"raw"};const i=function Zze(e){return Ke(e.x2)||Ke(e.y2)}(n),r=function eqe(e){return Ke(e.xError)||Ke(e.xError2)||Ke(e.yError)||Ke(e.yError2)}(n),s=n.x,o=n.y;if(i){if(r)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const a=n.x2,l=n.y2;if(Ke(a)&&Ke(l))throw new Error(`${t} cannot have both x2 and y2`);if(Ke(a)){if(nu(s))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}if(Ke(l)){if(nu(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}{const a=n.xError,u=n.yError,c=n.yError2;if(Ke(n.xError2)&&!Ke(a))throw new Error(`${t} cannot have xError2 without xError`);if(Ke(c)&&!Ke(u))throw new Error(`${t} cannot have yError2 without yError`);if(Ke(a)&&Ke(u))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(Ke(a)){if(nu(s))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(Ke(u)){if(nu(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}(e,t),{continuousAxisChannelDef:f,continuousAxisChannelDef2:h,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:g,continuousAxis:m}=Zse(e,c,t),{errorBarSpecificAggregate:_,postAggregateCalculates:y,tooltipSummary:v,tooltipTitleWithFieldName:b}=function tqe(e,t,n,i,r,s,o,a){let l=[],u=[];const c=t.field;let d,f=!1;if("raw"===s){const h=e.center?e.center:e.extent?"iqr"===e.extent?"median":"mean":a.errorbar.center,p=e.extent?e.extent:"mean"===h?"stderr":"iqr";if("median"===h!=("iqr"===p)&&ce(function yUe(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}(h,p,o)),"stderr"===p||"stdev"===p)l=[{op:p,field:c,as:`extent_${c}`},{op:h,field:c,as:`center_${c}`}],u=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],d=[{fieldPrefix:"center_",titlePrefix:e1(h)},{fieldPrefix:"upper_",titlePrefix:aoe(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:aoe(h,p,"-")}],f=!0;else{let g,m,_;"ci"===p?(g="mean",m="ci0",_="ci1"):(g="median",m="q1",_="q3"),l=[{op:m,field:c,as:`lower_${c}`},{op:_,field:c,as:`upper_${c}`},{op:g,field:c,as:`center_${c}`}],d=[{fieldPrefix:"upper_",titlePrefix:Km({field:c,aggregate:_,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Km({field:c,aggregate:m,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Km({field:c,aggregate:g,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&ce(function _Ue(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}(e.center,e.extent)),"aggregated-upper-lower"===s?(d=[],u=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):"aggregated-error"===s&&(d=[{fieldPrefix:"",titlePrefix:c}],u=[{calculate:`datum["${c}"] + datum["${i.field}"]`,as:`upper_${c}`}],u.push(r?{calculate:`datum["${c}"] + datum["${r.field}"]`,as:`lower_${c}`}:{calculate:`datum["${c}"] - datum["${i.field}"]`,as:`lower_${c}`}));for(const h of u)d.push({fieldPrefix:h.as.substring(0,6),titlePrefix:Vh(Vh(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:l,tooltipSummary:d,tooltipTitleWithFieldName:f}}(u,f,h,p,g,d,t,n),E="x"===m?"x2":"y2",O="x"===m?"xError":"yError",P="x"===m?"xError2":"yError2",A=roe(s,["symbol"==typeof m?m:m+"","symbol"==typeof E?E:E+"","symbol"==typeof O?O:O+"","symbol"==typeof P?P:P+""]),{bins:x,timeUnits:S,aggregate:I,groupby:M,encoding:L}=Kse(A,n),R=[...I,..._],V="raw"!==d?[]:M,U=e5(v,f,L,b);return{transform:[...null!==(i=l.transform)&&void 0!==i?i:[],...x,...S,...0===R.length?[]:[{aggregate:R,groupby:V}],...y],groupby:V,continuousAxisChannelDef:f,continuousAxis:m,encodingWithoutContinuousAxis:L,ticksOrient:"vertical"===c?"horizontal":"vertical",markDef:u,outerSpec:l,tooltipEncoding:U}}function aoe(e,t,n){return`${e1(e)} ${n} ${t}`}const r5="errorband",iqe=new vx(r5,loe);function loe(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:bx(e.encoding,t)});const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,markDef:o,outerSpec:a,tooltipEncoding:l}=ooe(e,r5,t),u=o,c=n5(u,r,i,s,t.errorband),d=void 0!==e.encoding.x&&void 0!==e.encoding.y;let f={type:d?"area":"rect"},h={type:d?"line":"rule"};const p=Object.assign(Object.assign({},u.interpolate?{interpolate:u.interpolate}:{}),u.tension&&u.interpolate?{tension:u.tension}:{});return d?(f=Object.assign(Object.assign(Object.assign({},f),p),{ariaRoleDescription:"errorband"}),h=Object.assign(Object.assign(Object.assign({},h),p),{aria:!1})):u.interpolate?ce(Yre("interpolate")):u.tension&&ce(Yre("tension")),Object.assign(Object.assign({},a),{transform:n,layer:[...c({partName:"band",mark:f,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l}),...c({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:l}),...c({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:l})]})}const s5={};function o5(e,t,n){const i=new vx(e,t);s5[e]={normalizer:i,parts:n}}o5(Cx,noe,["box","median","outliers","rule","ticks"]),o5(i5,soe,["ticks","rule"]),o5(r5,loe,["band","borders"]);const sqe=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],uoe={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},coe={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},oqe=oe(uoe),aqe=oe(coe),doe=oe({header:1,headerRow:1,headerColumn:1,headerFacet:1}),foe=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],hoe={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},p1=(oe(hoe),"_vgsid_"),uqe={point:{on:"click",fields:[p1],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function a5(e){return!(!e||"legend"!==e&&!e.legend)}function l5(e){return a5(e)&&Se(e)}function u5(e){return!!e.select}var cqe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function poe(e){const t=[];for(const n of e||[]){if(u5(n))continue;const{expr:i,bind:r}=n,s=cqe(n,["expr","bind"]);if(r&&i){const o=Object.assign(Object.assign({},s),{bind:r,init:i});t.push(o)}else{const o=Object.assign(Object.assign(Object.assign({},s),i?{update:i}:{}),r?{bind:r}:{});t.push(o)}}return t}function c5(e){return"concat"in e}function Ex(e){return"vconcat"in e}function d5(e){return"hconcat"in e}function goe({step:e,offsetIsDiscrete:t}){var n;return t?null!==(n=e.for)&&void 0!==n?n:"offset":"position"}function ru(e){return Se(e)&&void 0!==e.step}function moe(e){return e.view||e.width||e.height}const fqe=oe({align:1,bounds:1,center:1,columns:1,spacing:1});function f5(e,t){var n;return null!==(n=e[t])&&void 0!==n?n:e["width"===t?"continuousWidth":"continuousHeight"]}function Sx(e,t){const n=xx(e,t);return ru(n)?n.step:yoe}function xx(e,t){var n;return hi(null!==(n=e[t])&&void 0!==n?n:e["width"===t?"discreteWidth":"discreteHeight"],{step:e.step})}const yoe=20,mqe={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:yoe},mark:{color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},arc:{},area:{},bar:{binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},circle:{},geoshape:{},image:{},line:{},point:{},rect:{binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5},rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:uqe,style:{},title:{},facet:{spacing:20},concat:{spacing:20}},dc=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],voe={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},boe={blue:dc[0],orange:dc[1],red:dc[2],teal:dc[3],green:dc[4],yellow:dc[5],purple:dc[6],pink:dc[7],brown:dc[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function woe(e){const t=oe(e||{}),n={};for(const i of t){const r=e[i];n[i]=h1(r)?xre(r):ao(r)}return n}const wqe=[...vse,...Wse,...doe,"background","padding","legend","lineBreak","scale","style","title","view"];function Doe(e={}){const{color:t,font:n,fontSize:i,selection:r}=e,s=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["color","font","fontSize","selection"]),o=Tg({},nt(mqe),n?function vqe(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}(n):{},t?function _qe(e={}){return{signals:[{name:"color",value:Se(e)?Object.assign(Object.assign({},boe),e):boe}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(t):{},i?function yqe(e){return{signals:[{name:"fontSize",value:Se(e)?Object.assign(Object.assign({},voe),e):voe}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(i):{},s||{});r&&Og(o,"selection",r,!0);const a=oo(o,wqe);for(const l of["background","lineBreak","padding"])o[l]&&(a[l]=ao(o[l]));for(const l of vse)o[l]&&(a[l]=xs(o[l]));for(const l of Wse)o[l]&&(a[l]=woe(o[l]));for(const l of doe)o[l]&&(a[l]=xs(o[l]));return o.legend&&(a.legend=xs(o.legend)),o.scale&&(a.scale=xs(o.scale)),o.style&&(a.style=function bqe(e){const t=oe(e),n={};for(const i of t)n[i]=woe(e[i]);return n}(o.style)),o.title&&(a.title=xs(o.title)),o.view&&(a.view=xs(o.view)),a}const Dqe=new Set(["view",..._se]),Cqe=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],Eqe=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},{area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]});function Aqe(e,t,n,i){"view"===t&&(n="cell");const s=Object.assign(Object.assign({},i?e[t][i]:e[t]),e.style[null!=n?n:t]);nn(s)||(e.style[null!=n?n:t]=s),i||delete e[t]}function Ax(e){return"layer"in e}class h5{map(t,n){return ux(t)?this.mapFacet(t,n):function Mqe(e){return"repeat"in e}(t)?this.mapRepeat(t,n):d5(t)?this.mapHConcat(t,n):Ex(t)?this.mapVConcat(t,n):c5(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(Ax(t))return this.mapLayer(t,n);if(cc(t))return this.mapUnit(t,n);throw new Error(mj(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(i=>this.mapLayerOrUnit(i,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(i=>this.map(i,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(i=>this.map(i,n))})}mapConcat(t,n){const{concat:i}=t,r=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["concat"]);return Object.assign(Object.assign({},r),{concat:i.map(s=>this.map(s,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const Nqe={zero:1,center:1,normalize:1},Iqe=new Set([hse,nx,tx,sx,rx,Lj,jj,ix,pse,Pj]),Rqe=new Set([nx,tx,hse]);function Qm(e){return ge(e)&&"quantitative"===fx(e)&&!e.bin}function Coe(e,t){var n,i;const r="x"===t?"y":"radius",s=e[t],o=e[r];if(ge(s)&&ge(o))if(Qm(s)&&Qm(o)){if(s.stack)return t;if(o.stack)return r;const a=ge(s)&&!!s.aggregate;if(a!==(ge(o)&&!!o.aggregate))return a?t:r;{const u=null===(n=s.scale)||void 0===n?void 0:n.type,c=null===(i=o.scale)||void 0===i?void 0:i.type;if(u&&"linear"!==u)return r;if(c&&"linear"!==c)return t}}else{if(Qm(s))return t;if(Qm(o))return r}else{if(Qm(s))return t;if(Qm(o))return r}}function Eoe(e,t,n={}){var i,r;const s=za(e)?e.type:e;if(!Iqe.has(s))return null;const o=Coe(t,"x")||Coe(t,"theta");if(!o)return null;const a=t[o],l=ge(a)?_e(a,{}):void 0,u=function Fqe(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(o),c=[],d=new Set;if(t[u]){const p=t[u],g=ge(p)?_e(p,{}):void 0;g&&g!==l&&(c.push(u),d.add(g));const m="x"===u?"xOffset":"yOffset",_=t[m],y=ge(_)?_e(_,{}):void 0;y&&y!==l&&(c.push(m),d.add(y))}const f=QHe.reduce((p,g)=>{if("tooltip"!==g&&Zh(t,g)){const m=t[g];for(const _ of we(m)){const y=iu(_);if(y.aggregate)continue;const v=_e(y,{});(!v||!d.has(v))&&p.push({channel:g,fieldDef:y})}}return p},[]);let h;if(void 0!==a.stack?h=Uc(a.stack)?a.stack?"zero":null:a.stack:Rqe.has(s)&&(h="zero"),!h||!function kqe(e){return e in Nqe}(h)||Qj(t)&&0===f.length)return null;if((null===(i=null==a?void 0:a.scale)||void 0===i?void 0:i.type)&&"linear"!==(null===(r=null==a?void 0:a.scale)||void 0===r?void 0:r.type)){if(n.disallowNonLinearStack)return null;ce(function pUe(e){return`Cannot stack non-linear scale (${e}).`}(a.scale.type))}return Ke(t[oc(o)])?(void 0!==a.stack&&ce(function hUe(e){return`Cannot stack "${e}" if there is already "${e}2".`}(o)),null):(ge(a)&&a.aggregate&&!c9e.has(a.aggregate)&&ce(function gUe(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}(a.aggregate)),{groupbyChannels:c,groupbyFields:d,fieldChannel:o,impute:null!==a.impute&&Kd(s),stackBy:f,offset:h})}var Soe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Pqe(e){const i=Soe(e,["point","line"]);return oe(i).length>1?i:i.type}function Lqe(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:oo(e[t],["point","line"])}));return e}function p5(e,t={},n){return"transparent"===e.point?{opacity:0}:e.point?Se(e.point)?e.point:{}:void 0!==e.point?null:t.point||n.shape?Se(t.point)?t.point:{}:void 0}function xoe(e,t={}){return e.line?!0===e.line?{}:e.line:void 0!==e.line?null:t.line?!0===t.line?{}:t.line:void 0}class jqe{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(cc(t)){const{mark:i,encoding:r}=t,s=za(i)?i:{type:i};switch(s.type){case"line":case"rule":case"trail":return!!p5(s,n[s.type],r);case"area":return!!p5(s,n[s.type],r)||!!xoe(s,n[s.type])}}return!1}run(t,n,i){const{config:r}=n,{params:s,projection:o,mark:a,encoding:l}=t,u=Soe(t,["params","projection","mark","encoding"]),c=bx(l,r),d=za(a)?a:{type:a},f=p5(d,r[d.type],c),h="area"===d.type&&xoe(d,r[d.type]),p=[Object.assign(Object.assign({},s?{params:s}:{}),{mark:Pqe(Object.assign(Object.assign({},"area"===d.type&&void 0===d.opacity&&void 0===d.fillOpacity?{opacity:.7}:{}),d)),encoding:oo(c,["shape"])})],g=Eoe(d,c);let m=c;if(g){const{fieldChannel:_,offset:y}=g;m=Object.assign(Object.assign({},c),{[_]:Object.assign(Object.assign({},c[_]),y?{stack:y}:{})})}return h&&p.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},$m(d,["clip","interpolate","tension","tooltip"])),h),encoding:m})),f&&p.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},$m(d,["clip","tooltip"])),f),encoding:m})),i(Object.assign(Object.assign({},u),{layer:p}),Object.assign(Object.assign({},n),{config:Lqe(r)}))}}function $qe(e,t){return t?c1(e)?Ooe(e,t):Aoe(e,t):e}function g5(e,t){return t?Ooe(e,t):e}function m5(e,t,n){const i=t[e];return function xze(e){return e&&!be(e)&&"repeat"in e}(i)?i.repeat in n?Object.assign(Object.assign({},t),{[e]:n[i.repeat]}):void ce(function T9e(e){return`Unknown repeated value "${e}".`}(i.repeat)):t}function Aoe(e,t){if(void 0!==(e=m5("field",e,t))){if(null===e)return null;if(Gj(e)&&eu(e.sort)){const n=m5("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function Moe(e,t){if(ge(e))return Aoe(e,t);{const n=m5("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function Toe(e,t){if(!Ke(e)){if(d1(e)){const n=Moe(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["condition"])}return e}{const n=Moe(e,t);if(n)return n;if(cx(e))return{condition:e.condition}}}function Ooe(e,t){const n={};for(const i in e)if(ke(e,i)){const r=e[i];if(ne(r))n[i]=r.map(s=>Toe(s,t)).filter(s=>s);else{const s=Toe(r,t);void 0!==s&&(n[i]=s)}}return n}class Vqe{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(cc(t)){const{encoding:n,mark:i}=t;if("line"===i||za(i)&&"line"===i.type)for(const r of KHe){const o=n[zh(r)];if(n[r]&&(ge(o)&&!es(o.bin)||tu(o)))return!0}}return!1}run(t,n,i){const{encoding:r,mark:s}=t;return ce(function J9e(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}(!!r.x2,!!r.y2)),i(Object.assign(Object.assign({},t),{mark:Se(s)?Object.assign(Object.assign({},s),{type:"rule"}):"rule"}),n)}}var Jd=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Noe({parentEncoding:e,encoding:t={},layer:n}){let i={};if(e){const r=new Set([...oe(e),...oe(t)]);for(const s of r){const o=t[s],a=e[s];if(Ke(o)){const l=Object.assign(Object.assign({},a),o);i[s]=l}else d1(o)?i[s]=Object.assign(Object.assign({},o),{condition:Object.assign(Object.assign({},a),o.condition)}):o||null===o?i[s]=o:(n||qa(a)||Re(a)||Ke(a)||ne(a))&&(i[s]=a)}}else i=t;return!i||nn(i)?void 0:i}function koe(e){const{parentProjection:t,projection:n}=e;return t&&n&&ce(function F9e(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${mn(t)} is overridden by a child projection ${mn(n)}.`}({parentProjection:t,projection:n})),null!=n?n:t}function _5(e){return"filter"in e}function Uqe(e){return void 0!==(null==e?void 0:e.stop)}function Ioe(e){return"lookup"in e}function Gqe(e){return"pivot"in e}function Wqe(e){return"density"in e}function Yqe(e){return"quantile"in e}function Kqe(e){return"regression"in e}function Jqe(e){return"loess"in e}function Xqe(e){return"sample"in e}function Qqe(e){return"window"in e}function Zqe(e){return"joinaggregate"in e}function eGe(e){return"flatten"in e}function tGe(e){return"calculate"in e}function Roe(e){return"bin"in e}function nGe(e){return"impute"in e}function iGe(e){return"timeUnit"in e}function rGe(e){return"aggregate"in e}function sGe(e){return"stack"in e}function oGe(e){return"fold"in e}var Xd=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Foe(e,t){const{transform:n}=e,i=Xd(e,["transform"]);if(n){const r=n.map(s=>{if(_5(s))return{filter:y5(s,t)};if(Roe(s)&&qh(s.bin))return Object.assign(Object.assign({},s),{bin:Loe(s.bin)});if(Ioe(s)){const o=s.from,{selection:a}=o,l=Xd(o,["selection"]);return a?Object.assign(Object.assign({},s),{from:Object.assign({param:a},l)}):s}return s});return Object.assign(Object.assign({},i),{transform:r})}return e}function Poe(e,t){var n,i;const r=nt(e);if(ge(r)&&qh(r.bin)&&(r.bin=Loe(r.bin)),Qh(r)&&(null===(i=null===(n=r.scale)||void 0===n?void 0:n.domain)||void 0===i?void 0:i.selection)){const s=r.scale.domain,{selection:o}=s,a=Xd(s,["selection"]);r.scale.domain=Object.assign(Object.assign({},a),o?{param:o}:{})}if(cx(r))if(ne(r.condition))r.condition=r.condition.map(s=>{const{param:a}=s,u=Xd(s,["selection","param","test"]);return a?s:Object.assign(Object.assign({},u),{test:y5(s,t)})});else{const s=Poe(r.condition,t),{param:a}=s,u=Xd(s,["selection","param","test"]);r.condition=a?r.condition:Object.assign(Object.assign({},u),{test:y5(r.condition,t)})}return r}function Loe(e){const t=e.extent;if(null==t?void 0:t.selection){const{selection:n}=t,i=Xd(t,["selection"]);return Object.assign(Object.assign({},e),{extent:Object.assign(Object.assign({},i),{param:n})})}return e}function y5(e,t){const n=i=>Bm(i,r=>{var s,o,a;const u={param:r,empty:null===(s=t.emptySelections[r])||void 0===s||s};return null!==(o=(a=t.selectionPredicates)[r])&&void 0!==o||(a[r]=[]),t.selectionPredicates[r].push(u),u});return e.selection?n(e.selection):Bm(e.test||e.filter,i=>i.selection?n(i.selection):i)}class v5 extends h5{map(t,n){var i;const r=null!==(i=n.selections)&&void 0!==i?i:[];if(t.params&&!cc(t)){const s=[];for(const o of t.params)u5(o)?r.push(o):s.push(o);t.params=s}return n.selections=r,super.map(t,joe(t,n))}mapUnit(t,n){var i;const r=n.selections;if(!r||!r.length)return t;const s=(null!==(i=n.path)&&void 0!==i?i:[]).concat(t.name),o=[];for(const a of r)if(a.views&&a.views.length)for(const l of a.views)(be(l)&&(l===t.name||s.indexOf(l)>=0)||ne(l)&&l.map(u=>s.indexOf(u)).every((u,c,d)=>-1!==u&&(0===c||u>d[c-1])))&&o.push(a);else o.push(a);return o.length&&(t.params=o),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=v5.prototype[e];v5.prototype[e]=function(n,i){return t.call(this,n,joe(n,i))}}function joe(e,t){var n;return e.name?Object.assign(Object.assign({},t),{path:(null!==(n=t.path)&&void 0!==n?n:[]).concat(e.name)}):t}function Boe(e,t){void 0===t&&(t=Doe(e.config));const n=function fGe(e,t={}){const n={config:t};return dGe.map(uGe.map(cGe.map(e,n),n),n)}(e,t),{width:i,height:r}=e,s=function hGe(e,t,n){let{width:i,height:r}=t;const s=cc(e)||Ax(e),o={};s?"container"==i&&"container"==r?(o.type="fit",o.contains="padding"):"container"==i?(o.type="fit-x",o.contains="padding"):"container"==r&&(o.type="fit-y",o.contains="padding"):("container"==i&&(ce(Fre("width")),i=void 0),"container"==r&&(ce(Fre("height")),r=void 0));const a=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?$oe(n.autosize):{}),$oe(e.autosize));if("fit"===a.type&&!s&&(ce('Autosize "fit" only works for single views and layered views.'),a.type="pad"),"container"==i&&!("fit"==a.type||"fit-x"==a.type)&&ce(Pre("width")),"container"==r&&!("fit"==a.type||"fit-y"==a.type)&&ce(Pre("height")),!Ul(a,{type:"pad"}))return a}(n,{width:i,height:r,autosize:e.autosize},t);return Object.assign(Object.assign({},n),s?{autosize:s}:{})}const uGe=new class Hqe extends h5{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[Wze,Jze,iqe,new jqe,new Vqe]}map(t,n){if(cc(t)){const i=Zh(t.encoding,ec),r=Zh(t.encoding,tc),s=Zh(t.encoding,$S);if(i||r||s)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:i,parentProjection:r}=n,s=g5(t.encoding,n.repeater),o=Object.assign(Object.assign({},t),s?{encoding:s}:{});if(i||r)return this.mapUnitWithParentEncodingOrProjection(o,n);const a=this.mapLayerOrUnit.bind(this);for(const l of this.nonFacetUnitNormalizers)if(l.hasMatchingType(o,n.config))return l.run(o,n,a);return o}mapRepeat(t,n){return function Tqe(e){return!ne(e.repeat)&&e.repeat.layer}(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:i,spec:r}=t,s=Jd(t,["repeat","spec"]),{row:o,column:a,layer:l}=i,{repeater:u={},repeaterPrefix:c=""}=n;return o||a?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),a?{column:a}:{}),spec:{repeat:{layer:l},spec:r}}),n):Object.assign(Object.assign({},s),{layer:l.map(d=>{const f=Object.assign(Object.assign({},u),{layer:d}),h=`${(r.name||"")+c}child__layer_${Fn(d)}`,p=this.mapLayerOrUnit(r,Object.assign(Object.assign({},n),{repeater:f,repeaterPrefix:h}));return p.name=h,p})})}mapNonLayerRepeat(t,n){var i;const{repeat:r,spec:s,data:o}=t,a=Jd(t,["repeat","spec","data"]);!ne(r)&&t.columns&&(t=oo(t,["columns"]),ce($re("repeat")));const l=[],{repeater:u={},repeaterPrefix:c=""}=n,d=!ne(r)&&r.row||[u?u.row:null],f=!ne(r)&&r.column||[u?u.column:null],h=ne(r)&&r||[u?u.repeat:null];for(const g of h)for(const m of d)for(const _ of f){const y={repeat:g,row:m,column:_,layer:u.layer},v=(s.name||"")+c+"child__"+(ne(r)?`${Fn(g)}`:(r.row?`row_${Fn(m)}`:"")+(r.column?`column_${Fn(_)}`:"")),b=this.map(s,Object.assign(Object.assign({},n),{repeater:y,repeaterPrefix:v}));b.name=v,l.push(oo(b,["data"]))}const p=ne(r)?t.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:null!==(i=s.data)&&void 0!==i?i:o,align:"all"},a),{columns:p,concat:l})}mapFacet(t,n){const{facet:i}=t;return c1(i)&&t.columns&&(t=oo(t,["columns"]),ce($re("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:i,projection:r}=t,{parentEncoding:s,parentProjection:o,config:a}=n,l=koe({parentProjection:o,projection:r}),u=Noe({parentEncoding:s,encoding:g5(i,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),l?{projection:l}:{}),u?{encoding:u}:{}),{config:a})}mapFacetedUnit(t,n){const i=t.encoding,{row:r,column:s,facet:o}=i,a=Jd(i,["row","column","facet"]),{mark:l,width:u,projection:c,height:d,view:f,params:h}=t,g=Jd(t,["mark","width","projection","height","view","params","encoding"]),{facetMapping:m,layout:_}=this.getFacetMappingAndLayout({row:r,column:s,facet:o},n),y=g5(a,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},g),_),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u?{width:u}:{}),d?{height:d}:{}),f?{view:f}:{}),c?{projection:c}:{}),{mark:l,encoding:y}),h?{params:h}:{})}),n)}getFacetMappingAndLayout(t,n){var i;const{row:r,column:s,facet:o}=t;if(r||s){o&&ce(function Y9e(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}([...r?[ec]:[],...s?[tc]:[]]));const a={},l={};for(const u of[ec,tc]){const c=t[u];if(c){const g=Jd(c,["align","center","spacing","columns"]);a[u]=g;for(const m of["align","center","spacing"])void 0!==c[m]&&(null!==(i=l[m])&&void 0!==i||(l[m]={}),l[m][u]=c[m])}}return{facetMapping:a,layout:l}}{const{align:a,center:l,spacing:u,columns:c}=o;return{facetMapping:$qe(Jd(o,["align","center","spacing","columns"]),n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},a?{align:a}:{}),l?{center:l}:{}),u?{spacing:u}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:i,parentProjection:r}=n,s=Jd(n,["parentEncoding","parentProjection"]);const{encoding:o,projection:a}=t,l=Jd(t,["encoding","projection"]),u=Object.assign(Object.assign({},s),{parentEncoding:Noe({parentEncoding:i,encoding:o,layer:!0}),parentProjection:koe({parentProjection:r,projection:a})});return super.mapLayer(l,u)}},cGe=new class lGe extends h5{map(t,n){var i,r;return null!==(i=n.emptySelections)&&void 0!==i||(n.emptySelections={}),null!==(r=n.selectionPredicates)&&void 0!==r||(n.selectionPredicates={}),t=Foe(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if((t=Foe(t,n)).encoding){const i={};for(const[r,s]of Ld(t.encoding))i[r]=Poe(s,n);t=Object.assign(Object.assign({},t),{encoding:i})}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const i=t,{selection:r}=i,s=Xd(i,["selection"]);return r?Object.assign(Object.assign({},s),{params:Ld(r).map(([o,a])=>{var l;const u=a,{init:c,bind:d,empty:f}=u,h=Xd(u,["init","bind","empty"]);"single"===h.type?(h.type="point",h.toggle=!1):"multi"===h.type&&(h.type="point"),n.emptySelections[o]="none"!==f;for(const p of Er(null!==(l=n.selectionPredicates[o])&&void 0!==l?l:{}))p.empty="none"!==f;return{name:o,value:c,select:h,bind:d}})}):t}},dGe=new v5;function $oe(e){return be(e)?{type:e}:null!=e?e:{}}const mGe=["background","padding"];function Voe(e,t){const n={};for(const i of mGe)e&&void 0!==e[i]&&(n[i]=ao(e[i]));return t&&(n.params=e.params),n}class fc{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new fc(nt(this.explicit),nt(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return hi(this.explicit[t],this.implicit[t])}getWithExplicit(t){return void 0!==this.explicit[t]?{explicit:!0,value:this.explicit[t]}:void 0!==this.implicit[t]?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:i}){void 0!==n&&this.set(t,n,i)}set(t,n,i){return delete this[i?"implicit":"explicit"][t],this[i?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:i}){void 0!==n[t]?this.set(t,n[t],!0):void 0!==i[t]&&this.set(t,i[t],!1)}copyKeyFromObject(t,n){void 0!==n[t]&&this.set(t,n[t],!0)}copyAll(t){for(const n of oe(t.combine())){const i=t.getWithExplicit(n);this.setWithExplicit(n,i)}}}function su(e){return{explicit:!0,value:e}}function uo(e){return{explicit:!1,value:e}}function Hoe(e){return(t,n,i,r)=>{const s=e(t.value,n.value);return s>0?t:s<0?n:Mx(t,n,i,r)}}function Mx(e,t,n,i){return e.explicit&&t.explicit&&ce(function oUe(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${mn(n)} and ${mn(i)}). Using ${mn(n)}.`}(n,i,e.value,t.value)),e}function Qd(e,t,n,i,r=Mx){return void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:Ul(e.value,t.value)?e:r(e,t,n,i)}class _Ge extends fc{constructor(t={},n={},i=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=i}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function Zm(e){return"url"in e}function g1(e){return"values"in e}function Uoe(e){return"name"in e&&!Zm(e)&&!g1(e)&&!Zd(e)}function Zd(e){return e&&(zoe(e)||qoe(e)||b5(e))}function zoe(e){return"sequence"in e}function qoe(e){return"sphere"in e}function b5(e){return"graticule"in e}var hn=(()=>(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup"}(hn||(hn={})),hn))(),yGe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function e0(e,t=!0,n=hr){if(ne(e)){const i=e.map(r=>e0(r,t,n));return t?`[${i.join(", ")}]`:i}return Wh(e)?n(t?l1(e):function kUe(e){const t=bj(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}(e)):t?n(mn(e)):e}function vGe(e,t){var n;for(const i of Er(null!==(n=e.component.selection)&&void 0!==n?n:{})){const r=i.name;let s=`${r}${nf}, ${"global"===i.resolve?"true":`{unit: ${r0(e)}}`}`;for(const o of Ix)!o.defined(i)||(o.signals&&(t=o.signals(e,i,t)),o.modifyExpr&&(s=o.modifyExpr(e,i,s)));t.push({name:r+ZGe,on:[{events:{signal:i.name+nf},update:`modify(${pe(i.name+ep)}, ${s})`}]})}return w5(t)}function bGe(e,t){if(e.component.selection&&oe(e.component.selection).length){const n=pe(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Fd("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return w5(t)}function Goe(e,t){var n;for(const i of Er(null!==(n=e.component.selection)&&void 0!==n?n:{}))for(const r of Ix)r.defined(i)&&r.marks&&(t=r.marks(e,i,t));return t}function w5(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}class rn{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){this._children.includes(t)?ce("Attempt to add the same child twice."):void 0!==n?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const i of this._children)i.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class ns extends rn{constructor(t,n,i,r){super(t,n),this.type=i,this.refCounts=r,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash=`Output ${ure()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}var Woe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};class ou extends rn{constructor(t,n){super(t),this.formula=n}clone(){return new ou(null,nt(this.formula))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s)=>{const{field:o,timeUnit:a}=s;if(a){const l=_e(s,{forAs:!0});r[wt({as:l,field:o,timeUnit:a})]={as:l,field:o,timeUnit:a}}return r},{});return nn(i)?null:new ou(t,i)}static makeFromTransform(t,n){const i=Object.assign({},n),{timeUnit:r}=i,s=Woe(i,["timeUnit"]),o=ts(r),a=Object.assign(Object.assign({},s),{timeUnit:o});return new ou(t,{[wt(a)]:a})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)this.formula[n]||(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[i,r]of Ld(this.formula))t.has(r.as)||(n[i]=r);this.formula=n}producedFields(){return new Set(Er(this.formula).map(t=>t.as))}dependentFields(){return new Set(Er(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${wt(this.formula)}`}assemble(){const t=[];for(const n of Er(this.formula)){const{field:i,as:r,timeUnit:s}=n,o=ts(s),{unit:a,utc:l}=o,u=Woe(o,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:Uo(i),type:"timeunit"},a?{units:Cj(a)}:{}),l?{timezone:"utc"}:{}),u),{as:[r,`${r}_end`]}))}return t}}const m1="_tuple_fields";class xGe{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const AGe={defined:()=>!0,parse:(e,t,n)=>{var i;const r=t.name,s=null!==(i=t.project)&&void 0!==i?i:t.project=new xGe,o={},a={},l=new Set,u=(g,m)=>{const _="visual"===m?g.channel:g.field;let y=Fn(`${r}_${_}`);for(let v=1;l.has(y);v++)y=Fn(`${r}_${_}_${v}`);return l.add(y),{[m]:y}},c=t.type,d=e.config.selection[c],f=void 0!==n.value?we(n.value):null;let{fields:h,encodings:p}=Se(n.select)?n.select:{};if(!h&&!p&&f)for(const g of f)if(Se(g))for(const m of oe(g))YHe(m)?(p||(p=[])).push(m):"interval"===c?(ce('Interval selections should be initialized using "x" and/or "y" keys.'),p=d.encodings):(h||(h=[])).push(m);!h&&!p&&(p=d.encodings,"fields"in d&&(h=d.fields));for(const g of null!=p?p:[]){const m=e.fieldDef(g);if(m){let _=m.field;if(m.aggregate){ce(b9e(g,m.aggregate));continue}if(!_){ce(jre(g));continue}if(m.timeUnit){_=e.vgField(g);const y={timeUnit:m.timeUnit,as:_,field:m.field};a[wt(y)]=y}if(!o[_]){let y="E";"interval"===c?lo(e.getScaleComponent(g).get("type"))&&(y="R"):m.bin&&(y="R-RE");const v={field:_,channel:g,type:y};v.signals=Object.assign(Object.assign({},u(v,"data")),u(v,"visual")),s.items.push(o[_]=v),s.hasField[_]=s.hasChannel[g]=o[_]}}else ce(jre(g))}for(const g of null!=h?h:[]){if(s.hasField[g])continue;const m={type:"E",field:g};m.signals=Object.assign({},u(m,"data")),s.items.push(m),s.hasField[g]=m}f&&(t.init=f.map(g=>s.items.map(m=>Se(g)?void 0!==g[m.channel]?g[m.channel]:g[m.field]:g))),nn(a)||(s.timeUnit=new ou(null,a))},signals:(e,t,n)=>{const i=t.name+m1;return n.filter(s=>s.name===i).length>0?n:n.concat({name:i,value:t.project.items.map(s=>{const l=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(s,["signals","hasLegend"]);return l.field=Uo(l.field),l})})}},ef={defined:e=>"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind,parse:(e,t)=>{const n=t.scales=[];for(const i of t.project.items){const r=i.channel;if(!zd(r))continue;const s=e.getScaleComponent(r),o=s?s.get("type"):void 0;s&&lo(o)?(s.set("selectionExtent",{param:t.name,field:i.field},!0),n.push(i)):ce("Scale bindings are currently only supported for scales with unbinned, continuous domains.")}},topLevelSignals:(e,t,n)=>{const i=t.scales.filter(o=>0===n.filter(a=>a.name===o.signals.data).length);if(!e.parent||C5(e)||0===i.length)return n;const r=n.filter(o=>o.name===t.name)[0];let s=r.update;if(s.indexOf(pae)>=0)r.update=`{${i.map(o=>`${pe(Uo(o.field))}: ${o.signals.data}`).join(", ")}}`;else{for(const o of i){const a=`${pe(Uo(o.field))}: ${o.signals.data}`;s.includes(a)||(s=`${s.substring(0,s.length-1)}, ${a}}`)}r.update=s}return n.concat(i.map(o=>({name:o.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!C5(e))for(const i of t.scales){const r=n.filter(s=>s.name===i.signals.data)[0];r.push="outer",delete r.value,delete r.update}return n}};function D5(e,t){return`domain(${pe(e.scaleName(t))})`}function C5(e){var t;return e.parent&&d0(e.parent)&&(null!==(t=!e.parent.parent)&&void 0!==t?t:C5(e.parent.parent))}const t0="_brush",E5="_scale_trigger",TGe={defined:e=>"interval"===e.type,signals:(e,t,n)=>{const i=t.name,r=i+m1,s=ef.defined(t),o=t.init?t.init[0]:null,a=[],l=[];if(t.translate&&!s){const c=`!event.item || event.item.mark.name !== ${pe(i+t0)}`;Yoe(t,(d,f)=>{var h,p;const g=we(null!==(h=(p=f.between[0]).filter)&&void 0!==h?h:p.filter=[]);return g.includes(c)||g.push(c),d})}t.project.items.forEach((c,d)=>{const f=c.channel;if(f!==Bn&&f!==Vi)return void ce("Interval selections only support x and y encoding channels.");const p=function OGe(e,t,n,i){const r=n.channel,s=n.signals.visual,o=n.signals.data,a=ef.defined(t),l=pe(e.scaleName(r)),u=e.getScaleComponent(r),c=u?u.get("type"):void 0,d=g=>`scale(${l}, ${g})`,f=e.getSizeSignalRef(r===Bn?"width":"height").signal,h=`${r}(unit)`,p=Yoe(t,(g,m)=>[...g,{events:m.between[0],update:`[${h}, ${h}]`},{events:m,update:`[${s}[0], clamp(${h}, 0, ${f})]`}]);return p.push({events:{signal:t.name+E5},update:lo(c)?`[${d(`${o}[0]`)}, ${d(`${o}[1]`)}]`:"[0, 0]"}),a?[{name:o,on:[]}]:[Object.assign(Object.assign({name:s},i?{init:e0(i,!0,d)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:o},i?{init:e0(i)}:{}),{on:[{events:{signal:s},update:`${s}[0] === ${s}[1] ? null : invert(${l}, ${s})`}]})]}(e,t,c,o?o[d]:null),g=c.signals.data,m=c.signals.visual,_=pe(e.scaleName(f)),v=lo(e.getScaleComponent(f).get("type"))?"+":"";n.push(...p),a.push(g),l.push({scaleName:e.scaleName(f),expr:`(!isArray(${g}) || (${v}invert(${_}, ${m})[0] === ${v}${g}[0] && ${v}invert(${_}, ${m})[1] === ${v}${g}[1]))`})}),!s&&l.length&&n.push({name:i+E5,value:{},on:[{events:l.map(c=>({scale:c.scaleName})),update:`${l.map(c=>c.expr).join(" && ")} ? ${i+E5} : {}`}]});const u=`unit: ${r0(e)}, fields: ${r}, values`;return n.concat(Object.assign(Object.assign({name:i+nf},o?{init:`{${u}: ${e0(o)}}`}:{}),a.length?{on:[{events:[{signal:a.join(" || ")}],update:`${a.join(" && ")} ? {${u}: [${a}]} : null`}]}:{}))},marks:(e,t,n)=>{const i=t.name,{x:r,y:s}=t.project.hasChannel,o=null==r?void 0:r.signals.visual,a=null==s?void 0:s.signals.visual,l=`data(${pe(t.name+ep)})`;if(ef.defined(t)||!r&&!s)return n;const u={x:void 0!==r?{signal:`${o}[0]`}:{value:0},y:void 0!==s?{signal:`${a}[0]`}:{value:0},x2:void 0!==r?{signal:`${o}[1]`}:{field:{group:"width"}},y2:void 0!==s?{signal:`${a}[1]`}:{field:{group:"height"}}};if("global"===t.resolve)for(const m of oe(u))u[m]=[Object.assign({test:`${l}.length && ${l}[0].unit === ${r0(e)}`},u[m]),{value:0}];const c=t.mark,{fill:d,fillOpacity:f,cursor:h}=c,p=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(c,["fill","fillOpacity","cursor"]),g=oe(p).reduce((m,_)=>(m[_]=[{test:[void 0!==r&&`${o}[0] !== ${o}[1]`,void 0!==s&&`${a}[0] !== ${a}[1]`].filter(y=>y).join(" && "),value:p[_]},{value:null}],m),{});return[{name:`${i+t0}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:d},fillOpacity:{value:f}},update:u}},...n,{name:i+t0,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},h?{cursor:{value:h}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},u),g)}}]}};function Yoe(e,t){return e.events.reduce((n,i)=>i.between?t(n,i):(ce(`${i} is not an ordered event stream for interval selections.`),n),[])}const NGe={defined:e=>"point"===e.type,signals:(e,t,n)=>{var i;const r=t.name,s=r+m1,a="(item().isVoronoi ? datum.datum : datum)",l=t.project.items.map(h=>{const p=e.fieldDef(h.channel);return(null==p?void 0:p.bin)?`[${a}[${pe(e.vgField(h.channel,{}))}], ${a}[${pe(e.vgField(h.channel,{binSuffix:"end"}))}]]`:`${a}[${pe(h.field)}]`}).join(", "),u=`unit: ${r0(e)}, fields: ${s}, values`,c=t.events,d=Er(null!==(i=e.component.selection)&&void 0!==i?i:{}).reduce((h,p)=>"interval"===p.type?h.concat(p.name+t0):h,[]).map(h=>`indexof(item().mark.name, '${h}') < 0`).join(" && ");return n.concat([{name:r+nf,on:c?[{events:c,update:`${"datum && item().mark.marktype !== 'group'"+(d?` && ${d}`:"")} ? {${u}: [${l}]} : null`,force:!0}]:[]}])}};function n0(e,t,n,i){const r=cx(t)&&t.condition,s=i(t);return r?{[n]:[...we(r).map(l=>{const u=i(l);if(function Sze(e){return e.param}(l)){const{param:c,empty:d}=l,f=yae(e,{param:c,empty:d});return Object.assign({test:f},u)}{const c=Rx(e,l.test);return Object.assign({test:c},u)}}),...void 0!==s?[s]:[]]}:void 0!==s?{[n]:s}:{}}function S5(e,t="text"){return n0(e,e.encoding[t],t,i=>Tx(i,e.config))}function Tx(e,t,n="datum"){if(e){if(qa(e))return Cn(e.value);if(Ke(e)){const{format:i,formatType:r}=gx(e);return Hj({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t})}}}function Koe(e,t={}){const{encoding:n,markDef:i,config:r,stack:s}=e,o=n.tooltip;if(ne(o))return{tooltip:Xoe({tooltip:o},s,r,t)};{const a=t.reactiveGeom?"datum.datum":"datum";return n0(e,o,"tooltip",l=>{const u=Tx(l,r,a);if(u)return u;if(null===l)return;let c=Wt("tooltip",i,r);return!0===c&&(c={content:"encoding"}),be(c)?{value:c}:Se(c)?Re(c)?c:"encoding"===c.content?Xoe(n,s,r,t):{signal:a}:void 0})}}function Joe(e,t,n,{reactiveGeom:i}={}){const r={},s=i?"datum.datum":"datum",o=[];function a(u,c){const d=zh(c),f=Go(u)?u:Object.assign(Object.assign({},u),{type:e[d].type}),p=we(f.title||Kj(f,n)).join(", ");let g;if(Zi(c)){const m="x"===c?"x2":"y2",_=iu(e[m]);if(es(f.bin)&&_){const y=_e(f,{expr:s}),v=_e(_,{expr:s}),{format:b,formatType:D}=gx(f);g=ax(y,v,b,D,n),r[m]=!0}else if(t&&t.fieldChannel===c&&"normalize"===t.offset){const{format:y,formatType:v}=gx(f);g=Hj({fieldOrDatumDef:f,format:y,formatType:v,expr:s,config:n,normalizeStack:!0}).signal}}null!=g||(g=Tx(f,n,s).signal),o.push({channel:c,key:p,value:g})}Zj(e,(u,c)=>{ge(u)?a(u,c):dx(u)&&a(u.condition,c)});const l={};for(const{channel:u,key:c,value:d}of o)!r[u]&&!l[c]&&(l[c]=d);return l}function Xoe(e,t,n,{reactiveGeom:i}={}){const r=Joe(e,t,n,{reactiveGeom:i}),s=Ld(r).map(([o,a])=>`"${o}": ${a}`);return s.length>0?{signal:`{${s.join(", ")}}`}:void 0}function Ui(e,t,n={}){const{markDef:i,encoding:r,config:s}=t,{vgChannel:o}=n;let{defaultRef:a,defaultValue:l}=n;return void 0===a&&(null!=l||(l=Wt(e,i,s,{vgChannel:o,ignoreVgConfig:!0})),void 0!==l&&(a=Cn(l))),n0(t,r[e],null!=o?o:e,c=>Vj({channel:e,channelDef:c,markDef:i,config:s,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:a}))}function Qoe(e,t={filled:void 0}){var n,i,r,s;const{markDef:o,encoding:a,config:l}=e,{type:u}=o,c=null!==(n=t.filled)&&void 0!==n?n:Wt("filled",o,l),d=Dt(["bar","point","circle","square","geoshape"],u)?"transparent":void 0,f=null!==(r=null!==(i=Wt(!0===c?"color":void 0,o,l,{vgChannel:"fill"}))&&void 0!==i?i:l.mark[!0===c&&"color"])&&void 0!==r?r:d,h=null!==(s=Wt(!1===c?"color":void 0,o,l,{vgChannel:"stroke"}))&&void 0!==s?s:l.mark[!1===c&&"color"],p=c?"fill":"stroke",g=Object.assign(Object.assign({},f?{fill:Cn(f)}:{}),h?{stroke:Cn(h)}:{});return o.color&&(c?o.fill:o.stroke)&&ce(zre("property",{fill:"fill"in o,stroke:"stroke"in o})),Object.assign(Object.assign(Object.assign(Object.assign({},g),Ui("color",e,{vgChannel:p,defaultValue:c?f:h})),Ui("fill",e,{defaultValue:a.fill?f:void 0})),Ui("stroke",e,{defaultValue:a.stroke?h:void 0}))}function _1({channel:e,markDef:t,encoding:n={},model:i,bandPosition:r}){const s=`${e}Offset`,o=t[s],a=n[s];if(("xOffset"===s||"yOffset"===s)&&a)return{offsetType:"encoding",offset:Vj({channel:s,channelDef:a,markDef:t,config:null==i?void 0:i.config,scaleName:i.scaleName(s),scale:i.getScaleComponent(s),stack:null,defaultRef:Cn(o),bandPosition:r})};const l=t[s];return l?{offsetType:"visual",offset:l}:{}}function xr(e,t,{defaultPos:n,vgChannel:i}){const{encoding:r,markDef:s,config:o,stack:a}=t,l=r[e],u=r[oc(e)],c=t.scaleName(e),d=t.getScaleComponent(e),{offset:f,offsetType:h}=_1({channel:e,markDef:s,encoding:r,model:t,bandPosition:.5}),p=x5({model:t,defaultPos:n,channel:e,scaleName:c,scale:d}),g=!l&&Zi(e)&&(r.latitude||r.longitude)?{field:t.getName(e)}:function PGe(e){const{channel:t,channelDef:n,scaleName:i,stack:r,offset:s,markDef:o}=e;if(Ke(n)&&r&&t===r.fieldChannel){if(ge(n)){let a=n.bandPosition;if(void 0===a&&"text"===o.type&&("radius"===t||"theta"===t)&&(a=.5),void 0!==a)return ox({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",bandPosition:a,offset:s})}return Jh(n,i,{suffix:"end"},{offset:s})}return Bj(e)}({channel:e,channelDef:l,channel2Def:u,markDef:s,config:o,scaleName:c,scale:d,stack:a,offset:f,defaultRef:p,bandPosition:"encoding"===h?0:void 0});return g?{[i||e]:g}:void 0}function x5({model:e,defaultPos:t,channel:n,scaleName:i,scale:r}){const{markDef:s,config:o}=e;return()=>{const a=zh(n),l=Ud(n),u=Wt(n,s,o,{vgChannel:l});if(void 0!==u)return u1(n,u);switch(t){case"zeroOrMin":case"zeroOrMax":if(i){if(!Dt(["log","time","utc"],r.get("type"))&&r.domainDefinitelyIncludesZero())return{scale:i,value:0}}if("zeroOrMin"===t)return"y"===a?{field:{group:"height"}}:{value:0};switch(a){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[Ss(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const LGe={left:"x",center:"xc",right:"x2"},jGe={top:"y",middle:"yc",bottom:"y2"};function Zoe(e,t,n,i="middle"){if("radius"===e||"theta"===e)return Ud(e);const r="x"===e?"align":"baseline",s=Wt(r,t,n);let o;return Re(s)?(ce(function K9e(e){return`The ${e} for range marks cannot be an expression`}(r)),o=void 0):o=s,"x"===e?LGe[o||("top"===i?"left":"center")]:jGe[o||i]}function Ox(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?eae(e,t,{defaultPos:n,defaultPos2:i}):xr(e,t,{defaultPos:n})}function eae(e,t,{defaultPos:n,defaultPos2:i}){const{markDef:r,config:s}=t,o=oc(e),a=Ss(e),l=function BGe(e,t,n){const{encoding:i,mark:r,markDef:s,stack:o,config:a}=e,l=zh(n),u=Ss(n),c=Ud(n),d=i[l],f=e.scaleName(l),h=e.getScaleComponent(l),{offset:p}=_1(n in i||n in s?{channel:n,markDef:s,encoding:i,model:e}:{channel:l,markDef:s,encoding:i,model:e});if(!d&&("x2"===n||"y2"===n)&&(i.latitude||i.longitude)){const m=Ss(n),_=e.markDef[m];return null!=_?{[m]:{value:_}}:{[c]:{field:e.getName(n)}}}const g=function $Ge({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:l,defaultRef:u}){return Ke(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?Jh(t,s,{suffix:"start"},{offset:l}):Bj({channel:e,channelDef:n,scaleName:s,scale:o,stack:a,markDef:i,config:r,offset:l,defaultRef:u})}({channel:n,channelDef:d,channel2Def:i[n],markDef:s,config:a,scaleName:f,scale:h,stack:o,offset:p,defaultRef:void 0});return void 0!==g?{[c]:g}:Nx(n,s)||Nx(n,{[n]:XS(n,s,a.style),[u]:XS(u,s,a.style)})||Nx(n,a[r])||Nx(n,a.mark)||{[c]:x5({model:e,defaultPos:t,channel:n,scaleName:f,scale:h})()}}(t,i,o),u=l[a]?Zoe(e,r,s):Ud(e);return Object.assign(Object.assign({},xr(e,t,{defaultPos:n,vgChannel:u})),l)}function Nx(e,t){const n=Ss(e),i=Ud(e);if(void 0!==t[i])return{[i]:u1(e,t[i])};if(void 0!==t[e])return{[i]:u1(e,t[e])};if(t[n]){const r=t[n];if(!Ym(r))return{[n]:u1(e,r)};ce(function H9e(e){return`Position range does not support relative band size for ${e}.`}(n))}}function tf(e,t){var n,i;const{config:r,encoding:s,markDef:o}=e,a=o.type,l=oc(t),u=Ss(t),c=s[t],d=s[l],f=e.getScaleComponent(t),h=f?f.get("type"):void 0,p=o.orient,g=null!==(i=null!==(n=s[u])&&void 0!==n?n:s.size)&&void 0!==i?i:Wt("size",o,r,{vgChannel:u}),m="bar"===a&&("x"===t?"vertical"===p:"horizontal"===p);return!ge(c)||!(_n(c.bin)||es(c.bin)||c.timeUnit&&!d)||g&&!Ym(g)||Hi(h)?(Ke(c)&&Hi(h)||m)&&!d?function HGe(e,t,n){const{markDef:i,encoding:r,config:s,stack:o}=n,a=i.orient,l=n.scaleName(t),u=n.getScaleComponent(t),c=Ss(t),d=oc(t),f=function JHe(e){switch(e){case Bn:return"xOffset";case Vi:return"yOffset";case $a:return"x2Offset";case ql:return"y2Offset";case Va:return"thetaOffset";case Gl:return"radiusOffset";case ic:return"theta2Offset";case nc:return"radius2Offset"}}(t),h=n.scaleName(f),p="horizontal"===a&&"y"===t||"vertical"===a&&"x"===t;let g;(r.size||i.size)&&(p?g=Ui("size",n,{vgChannel:c,defaultRef:Cn(i.size)}):ce(function iUe(e){return`Cannot apply size to non-oriented mark "${e}".`}(i.type)));const m=Ise({channel:t,fieldDef:e,markDef:i,config:s,scaleType:null==u?void 0:u.get("type"),useVlSizeChannel:p});g=g||{[c]:VGe(c,h||l,u,s,m)};const y=Zoe(t,i,s,"band"===(null==u?void 0:u.get("type"))&&"band"in g[c]?"top":"middle"),v="xc"===y||"yc"===y,{offset:b,offsetType:D}=_1({channel:t,markDef:i,encoding:r,model:n,bandPosition:v?.5:0}),C=Bj({channel:t,channelDef:e,markDef:i,config:s,scaleName:l,scale:u,stack:o,offset:b,defaultRef:x5({model:n,defaultPos:"mid",channel:t,scaleName:l,scale:u}),bandPosition:v?"encoding"===D?0:.5:Re(m)?{signal:`(1-${m})/2`}:Ym(m)?(1-m.band)/2:0});if(c)return Object.assign({[y]:C},g);{const w=Ud(d),E=g[c],T=b?Object.assign(Object.assign({},E),{offset:b}):E;return{[y]:C,[w]:ne(C)?[C[0],Object.assign(Object.assign({},C[1]),{offset:T})]:Object.assign(Object.assign({},C),{offset:T})}}}(c,t,e):eae(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"}):function UGe({fieldDef:e,fieldDef2:t,channel:n,model:i}){var r,s,o;const{config:a,markDef:l,encoding:u}=i,c=i.getScaleComponent(n),d=i.scaleName(n),f=c?c.get("type"):void 0,h=c.get("reverse"),p=Ise({channel:n,fieldDef:e,markDef:l,config:a,scaleType:f}),g=null===(r=i.component.axes[n])||void 0===r?void 0:r[0],m=null!==(s=null==g?void 0:g.get("translate"))&&void 0!==s?s:.5,_=Zi(n)&&null!==(o=Wt("binSpacing",l,a))&&void 0!==o?o:0,y=oc(n),v=Ud(n),b=Ud(y),{offset:D}=_1({channel:n,markDef:l,encoding:u,model:i,bandPosition:0}),C=Re(p)?{signal:`(1-${p.signal})/2`}:Ym(p)?(1-p.band)/2:.5;if(_n(e.bin)||e.timeUnit)return{[b]:tae({fieldDef:e,scaleName:d,bandPosition:C,offset:y1(y,_,h,m,D)}),[v]:tae({fieldDef:e,scaleName:d,bandPosition:Re(C)?{signal:`1-${C.signal}`}:1-C,offset:y1(n,_,h,m,D)})};if(es(e.bin)){const w=Jh(e,d,{},{offset:y1(y,_,h,m,D)});if(ge(t))return{[b]:w,[v]:Jh(t,d,{},{offset:y1(n,_,h,m,D)})};if(qh(e.bin)&&e.bin.step)return{[b]:w,[v]:{signal:`scale("${d}", ${_e(e,{expr:"datum"})} + ${e.bin.step})`,offset:y1(n,_,h,m,D)}}}ce(Kre(y))}({fieldDef:c,fieldDef2:d,channel:t,model:e})}function VGe(e,t,n,i,r){if(Ym(r)){if(!n)return{mult:r.band,field:{group:e}};{const o=n.get("type");if("band"===o)return{scale:t,band:r.band};1!==r.band&&(ce(function Z9e(e){return`Cannot use the relative band size with ${e} scale.`}(o)),r=void 0)}}else{if(Re(r))return r;if(r)return{value:r}}if(n){const o=n.get("range");if(Wd(o)&&en(o.step))return{value:o.step-2}}return{value:Sx(i.view,e)-2}}function y1(e,t,n,i,r){if(hre(e))return 0;const s="x"===e||"y2"===e?-t/2:t/2;if(Re(n)||Re(r)||Re(i)){const o=uc(n),a=uc(r),l=uc(i);return{signal:(l?`${l} + `:"")+(o?`(${o} ? -1 : 1) * `:"")+(a?`(${a} + ${s})`:s)}}return r=r||0,i+(n?-r-s:+r+s)}function tae({fieldDef:e,scaleName:t,bandPosition:n,offset:i}){return ox({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:i})}const zGe=new Set(["aria","width","height"]);function Wo(e,t){const{fill:n,stroke:i}="include"===t.color?Qoe(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function qGe(e,t){return g9e.reduce((n,i)=>(!zGe.has(i)&&void 0!==e[i]&&"ignore"!==t[i]&&(n[i]=Cn(e[i])),n),{})}(e.markDef,t)),nae(e,"fill",n)),nae(e,"stroke",i)),Ui("opacity",e)),Ui("fillOpacity",e)),Ui("strokeOpacity",e)),Ui("strokeWidth",e)),Ui("strokeDash",e)),function FGe(e){const{encoding:t,mark:n}=e,i=t.order;return!Kd(n)&&qa(i)?n0(e,i,"zindex",r=>Cn(r.value)):{}}(e)),Koe(e)),S5(e,"href")),function kGe(e){const{markDef:t,config:n}=e,i=Wt("aria",t,n);return!1===i?{}:Object.assign(Object.assign(Object.assign({},i?{aria:i}:{}),function IGe(e){const{mark:t,markDef:n,config:i}=e;if(!1===i.aria)return{};const r=Wt("ariaRoleDescription",n,i);return null!=r?{ariaRoleDescription:{value:r}}:t in m9e?{}:{ariaRoleDescription:{value:t}}}(e)),function RGe(e){const{encoding:t,markDef:n,config:i,stack:r}=e,s=t.description;if(s)return n0(e,s,"description",l=>Tx(l,e.config));const o=Wt("description",n,i);if(null!=o)return{description:Cn(o)};if(!1===i.aria)return{};const a=Joe(t,r,i);return nn(a)?void 0:{description:{signal:Ld(a).map(([l,u],c)=>`"${c>0?"; ":""}${l}: " + (${u})`).join(" + ")}}}(e))}(e))}function nae(e,t,n){const{config:i,mark:r,markDef:s}=e;if("hide"===Wt("invalid",s,i)&&n&&!Kd(r)){const a=function GGe(e,{invalid:t=!1,channels:n}){const i=n.reduce((s,o)=>{const a=e.getScaleComponent(o);if(a){const l=a.get("type"),u=e.vgField(o,{expr:"datum"});u&&lo(l)&&(s[u]=!0)}return s},{}),r=oe(i);if(r.length>0){const s=t?"||":"&&";return r.map(o=>$j(o,t)).join(` ${s} `)}}(e,{invalid:!0,channels:KS});if(a)return{[t]:[{test:a,value:null},...we(n)]}}return n?{[t]:n}:{}}function A5(e){const{config:t,markDef:n}=e;if(Wt("invalid",n,t)){const r=function WGe(e,{invalid:t=!1,channels:n}){const i=n.reduce((s,o)=>{const a=e.getScaleComponent(o);if(a){const l=a.get("type"),u=e.vgField(o,{expr:"datum"});u&&lo(l)&&(s[u]=!0)}return s},{}),r=oe(i);if(r.length>0){const s=t?"||":"&&";return r.map(o=>$j(o,t)).join(` ${s} `)}}(e,{channels:Xl});if(r)return{defined:{signal:r}}}return{}}function iae(e,t){if(void 0!==t)return{[e]:Cn(t)}}const M5="voronoi",rae={defined:e=>"point"===e.type&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(M5)},marks:(e,t,n)=>{const{x:i,y:r}=t.project.hasChannel,s=e.mark;if(Kd(s))return ce(function w9e(e){return`The "nearest" transform is not supported for ${e} marks.`}(s)),n;const o={name:e.getName(M5),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},Koe(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:i||!r?"datum.datum.x || 0":"0"},y:{expr:r||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let a=0,l=!1;return n.forEach((u,c)=>{var d;const f=null!==(d=u.name)&&void 0!==d?d:"";f===e.component.mark[0].name?a=c:f.indexOf(M5)>=0&&(l=!0)}),l||n.splice(a+1,0,o),n}},sae={defined:e=>"point"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind&&!a5(e.bind),parse:(e,t,n)=>gae(t,n),topLevelSignals:(e,t,n)=>{const i=t.name,r=t.project,s=t.bind,o=t.init&&t.init[0],a=rae.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return r.items.forEach((l,u)=>{var c,d;const f=Fn(`${i}_${l.field}`);n.filter(p=>p.name===f).length||n.unshift(Object.assign(Object.assign({name:f},o?{init:e0(o[u])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${pe(l.field)}] : null`}]:[],bind:null!==(d=null!==(c=s[l.field])&&void 0!==c?c:s[l.channel])&&void 0!==d?d:s}))}),n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.filter(u=>u.name===i+nf)[0],o=i+m1,a=r.items.map(u=>Fn(`${i}_${u.field}`)),l=a.map(u=>`${u} !== null`).join(" && ");return a.length&&(s.update=`${l} ? {fields: ${o}, values: [${a.join(", ")}]} : null`),delete s.value,delete s.on,n}},kx="_toggle",oae={defined:e=>"point"===e.type&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+kx,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+nf,i=t.name+kx;return`${i} ? null : ${n}, `+("global"===t.resolve?`${i} ? null : true, `:`${i} ? null : {unit: ${r0(e)}}, `)+`${i} ? ${n} : null`}},YGe={defined:e=>void 0!==e.clear&&!1!==e.clear,parse:(e,t)=>{t.clear&&(t.clear=be(t.clear)?Fd(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(sae.defined(t))for(const i of t.project.items){const r=n.findIndex(s=>s.name===Fn(`${t.name}_${i.field}`));-1!==r&&n[r].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function i(r,s){-1!==r&&n[r].on&&n[r].on.push({events:t.clear,update:s})}if("interval"===t.type)for(const r of t.project.items){const s=n.findIndex(o=>o.name===r.signals.visual);i(s,"[0, 0]"),-1===s&&i(n.findIndex(a=>a.name===r.signals.data),"null")}else{let r=n.findIndex(s=>s.name===t.name+nf);i(r,"null"),oae.defined(t)&&(r=n.findIndex(s=>s.name===t.name+kx),i(r,"false"))}return n}},aae={defined:e=>{const t="global"===e.resolve&&e.bind&&a5(e.bind),n=1===e.project.items.length&&e.project.items[0].field!==p1;return t&&!n&&ce("Legend bindings are only supported for selections over an individual field or encoding channel."),t&&n},parse:(e,t,n)=>{var i;const r=nt(n);if(r.select=be(r.select)?{type:r.select,toggle:t.toggle}:Object.assign(Object.assign({},r.select),{toggle:t.toggle}),gae(t,r),Se(n.select)&&(n.select.on||n.select.clear)){const a='event.item && indexof(event.item.mark.role, "legend") < 0';for(const l of t.events)l.filter=we(null!==(i=l.filter)&&void 0!==i?i:[]),l.filter.includes(a)||l.filter.push(a)}const s=l5(t.bind)?t.bind.legend:"click",o=be(s)?Fd(s,"view"):we(s);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const i=t.name,r=l5(t.bind)&&t.bind.legend,s=o=>a=>{const l=nt(a);return l.markname=o,l};for(const o of t.project.items){if(!o.hasLegend)continue;const a=`${Fn(o.field)}_legend`,l=`${i}_${a}`;if(0===n.filter(c=>c.name===l).length){const c=r.merge.map(s(`${a}_symbols`)).concat(r.merge.map(s(`${a}_labels`))).concat(r.merge.map(s(`${a}_entries`)));n.unshift(Object.assign(Object.assign({name:l},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:`!event.item || !datum ? null : ${l}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.find(f=>f.name===i+nf),o=i+m1,a=r.items.filter(f=>f.hasLegend).map(f=>Fn(`${i}_${Fn(f.field)}_legend`)),u=`${a.map(f=>`${f} !== null`).join(" && ")} ? {fields: ${o}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?s.on.push({events:a.map(f=>({signal:f})),update:u}):a.length>0&&(s.update=u,delete s.value,delete s.on);const c=n.find(f=>f.name===i+kx),d=l5(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:d})):c.on[0].events=d),n}},lae="_translate_anchor",uae="_translate_delta",XGe={defined:e=>"interval"===e.type&&e.translate,signals:(e,t,n)=>{const i=t.name,r=ef.defined(t),s=i+lae,{x:o,y:a}=t.project.hasChannel;let l=Fd(t.translate,"scope");return r||(l=l.map(u=>(u.between[0].markname=i+t0,u))),n.push({name:s,value:{},on:[{events:l.map(u=>u.between[0]),update:"{x: x(unit), y: y(unit)"+(void 0!==o?`, extent_x: ${r?D5(e,Bn):`slice(${o.signals.visual})`}`:"")+(void 0!==a?`, extent_y: ${r?D5(e,Vi):`slice(${a.signals.visual})`}`:"")+"}"}]},{name:i+uae,value:{},on:[{events:l,update:`{x: ${s}.x - x(unit), y: ${s}.y - y(unit)}`}]}),void 0!==o&&cae(e,t,o,"width",n),void 0!==a&&cae(e,t,a,"height",n),n}};function cae(e,t,n,i,r){var s,o;const a=t.name,l=a+lae,u=a+uae,c=n.channel,d=ef.defined(t),f=r.filter(w=>w.name===n.signals[d?"data":"visual"])[0],h=e.getSizeSignalRef(i).signal,p=e.getScaleComponent(c),g=p.get("type"),m=p.get("reverse"),y=`${l}.extent_${c}`,C=`${d?"log"===g?"panLog":"symlog"===g?"panSymlog":"pow"===g?"panPow":"panLinear":"panLinear"}(${y}, ${d?c===Bn?m?"":"-":m?"-":"":""}${u}.${c} / ${d?`${h}`:`span(${y})`}${d?"pow"===g?`, ${null!==(s=p.get("exponent"))&&void 0!==s?s:1}`:"symlog"===g?`, ${null!==(o=p.get("constant"))&&void 0!==o?o:1}`:"":""})`;f.on.push({events:{signal:u},update:d?C:`clampRange(${C}, 0, ${h})`})}const dae="_zoom_anchor",fae="_zoom_delta",QGe={defined:e=>"interval"===e.type&&e.zoom,signals:(e,t,n)=>{const i=t.name,r=ef.defined(t),s=i+fae,{x:o,y:a}=t.project.hasChannel,l=pe(e.scaleName(Bn)),u=pe(e.scaleName(Vi));let c=Fd(t.zoom,"scope");return r||(c=c.map(d=>(d.markname=i+t0,d))),n.push({name:i+dae,on:[{events:c,update:r?"{"+[l?`x: invert(${l}, x(unit))`:"",u?`y: invert(${u}, y(unit))`:""].filter(d=>!!d).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:s,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==o&&hae(e,t,o,"width",n),void 0!==a&&hae(e,t,a,"height",n),n}};function hae(e,t,n,i,r){var s,o;const a=t.name,l=n.channel,u=ef.defined(t),c=r.filter(b=>b.name===n.signals[u?"data":"visual"])[0],d=e.getSizeSignalRef(i).signal,f=e.getScaleComponent(l),h=f.get("type"),p=u?D5(e,l):c.name,g=a+fae,v=`${u?"log"===h?"zoomLog":"symlog"===h?"zoomSymlog":"pow"===h?"zoomPow":"zoomLinear":"zoomLinear"}(${p}, ${a}${dae}.${l}, ${g}${u?"pow"===h?`, ${null!==(s=f.get("exponent"))&&void 0!==s?s:1}`:"symlog"===h?`, ${null!==(o=f.get("constant"))&&void 0!==o?o:1}`:"":""})`;c.on.push({events:{signal:g},update:u?v:`clampRange(${v}, 0, ${d})`})}const ep="_store",nf="_tuple",ZGe="_modify",pae="vlSelectionResolve",Ix=[NGe,TGe,AGe,oae,sae,ef,aae,YGe,XGe,QGe,rae];function r0(e,{escape:t}={escape:!0}){let n=t?pe(e.name):e.name;const i=function eWe(e){let t=e.parent;for(;t&&!Ya(t);)t=t.parent;return t}(e);if(i){const{facet:r}=i;for(const s of qo)r[s]&&(n+=` + '__facet_${s}_' + (facet[${pe(i.vgField(s))}])`)}return n}function T5(e){var t;return Er(null!==(t=e.component.selection)&&void 0!==t?t:{}).reduce((n,i)=>n||i.project.items.some(r=>r.field===p1),!1)}function gae(e,t){(be(t.select)||!t.select.on)&&delete e.events,(be(t.select)||!t.select.clear)&&delete e.clear,(be(t.select)||!t.select.toggle)&&delete e.toggle}function O5(e){const t=[];return"Identifier"===e.type?[e.name]:"Literal"===e.type?[e.value]:("MemberExpression"===e.type&&(t.push(...O5(e.object)),t.push(...O5(e.property))),t)}function mae(e){return"MemberExpression"===e.object.type?mae(e.object):"datum"===e.object.name}function _ae(e){const t=z3(e),n=new Set;return t.visit(i=>{"MemberExpression"===i.type&&mae(i)&&n.add(O5(i).slice(1).join("."))}),n}class s0 extends rn{constructor(t,n,i){super(t),this.model=n,this.filter=i,this.expr=Rx(this.model,this.filter,this),this._dependentFields=_ae(this.expr)}clone(){return new s0(null,this.model,nt(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function yae(e,t,n,i="datum"){const r=be(t)?t:t.param,s=Fn(r),o=pe(s+ep);let a;try{a=e.getSelectionComponent(s,r)}catch(c){return`!!${s}`}if(a.project.timeUnit){const c=null!=n?n:e.component.data.raw,d=a.project.timeUnit.clone();c.parent?d.insertAsParentOf(c):c.parent=d}const l=`vlSelectionTest(${o}, ${i}${"global"===a.resolve?")":`, ${pe(a.resolve)})`}`,u=`length(data(${o}))`;return!1===t.empty?`${u} && ${l}`:`!${u} || ${l}`}function vae(e,t,n){const i=Fn(t),r=n.encoding;let o,s=n.field;try{o=e.getSelectionComponent(i,t)}catch(a){return i}if(r||s){if(r&&!s){const a=o.project.items.filter(l=>l.channel===r);!a.length||a.length>1?(s=o.project.items[0].field,ce((a.length?"Multiple ":"No ")+`matching ${pe(r)} encoding found for selection ${pe(n.param)}. Using "field": ${pe(s)}.`)):s=a[0].field}}else s=o.project.items[0].field,o.project.items.length>1&&ce(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${pe(s)}.`);return`${o.name}[${pe(Uo(s))}]`}function Rx(e,t,n){return Zv(t,i=>be(i)?i:function $Ue(e){return null==e?void 0:e.param}(i)?yae(e,i,n):rse(i))}var Fx=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function N5(e,t,n,i){var r,s,o,a,l;null!==(r=e.encode)&&void 0!==r||(e.encode={}),null!==(s=(a=e.encode)[t])&&void 0!==s||(a[t]={}),null!==(o=(l=e.encode[t]).update)&&void 0!==o||(l.update={}),e.encode[t].update[n]=i}function v1(e,t,n,i={header:!1}){var r,s;const o=e.combine(),{disable:a,orient:l,scale:u,labelExpr:c,title:d,zindex:f}=o,h=Fx(o,["disable","orient","scale","labelExpr","title","zindex"]);if(!a){for(const p in h){const g=Bze[p],m=h[p];if(g&&g!==t&&"both"!==g)delete h[p];else if(h1(m)){const{condition:_}=m,y=Fx(m,["condition"]),v=we(_),b=Hse[p];if(b){const{vgProp:D,part:C}=b;N5(h,C,D,[...v.map(E=>{const{test:T}=E,O=Fx(E,["test"]);return Object.assign({test:Rx(null,T)},O)}),y]),delete h[p]}else if(null===b){const D={signal:v.map(C=>{const{test:w}=C,E=Fx(C,["test"]);return`${Rx(null,w)} ? ${Mre(E)} : `}).join("")+Mre(y)};h[p]=D}}else if(Re(m)){const _=Hse[p];if(_){const{vgProp:y,part:v}=_;N5(h,v,y,m),delete h[p]}}Dt(["labelAlign","labelBaseline"],p)&&null===h[p]&&delete h[p]}if("grid"===t){if(!h.grid)return;if(h.encode){const{grid:p}=h.encode;h.encode=Object.assign({},p?{grid:p}:{}),nn(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:u,orient:l},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:hi(f,0)})}{if(!i.header&&e.mainExtracted)return;if(void 0!==c){let g=c;(null===(s=null===(r=h.encode)||void 0===r?void 0:r.labels)||void 0===s?void 0:s.update)&&Re(h.encode.labels.update.text)&&(g=Vh(c,"datum.label",h.encode.labels.update.text.signal)),N5(h,"labels","text",{signal:g})}if(null===h.labelAlign&&delete h.labelAlign,h.encode){for(const g of Use)e.hasAxisPart(g)||delete h.encode[g];nn(h.encode)&&delete h.encode}const p=function iWe(e,t){if(e)return ne(e)&&!Gd(e)?e.map(n=>Kj(n,t)).join(", "):e}(d,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:u,orient:l,grid:!1},p?{title:p}:{}),h),!1===n.aria?{aria:!1}:{}),{zindex:hi(f,0)})}}}function bae(e){const{axes:t}=e.component,n=[];for(const i of Xl)if(t[i])for(const r of t[i])if(!r.get("disable")&&!r.get("gridScale")){const s="x"===i?"height":"width",o=e.getSizeSignalRef(s).signal;s!==o&&n.push({name:s,update:o})}return n}function wae(e,t,n,i){return Object.assign.apply(null,[{},...e.map(r=>{if("axisOrient"===r){const s="x"===n?"bottom":"left",o=t["x"===n?"axisBottom":"axisLeft"]||{},a=t["x"===n?"axisTop":"axisRight"]||{},l=new Set([...oe(o),...oe(a)]),u={};for(const c of l.values())u[c]={signal:`${i.signal} === "${s}" ? ${uc(o[c])} : ${uc(a[c])}`};return u}return t[r]})])}function oWe(e,t){var n;const i=[{}];for(const r of e){let s=null===(n=t[r])||void 0===n?void 0:n.style;if(s){s=we(s);for(const o of s)i.push(t.style[o])}}return Object.assign.apply(null,i)}function k5(e,t,n,i={}){var r;const s=Ore(e,n,t);if(void 0!==s)return{configFrom:"style",configValue:s};for(const o of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(void 0!==(null===(r=i[o])||void 0===r?void 0:r[e]))return{configFrom:o,configValue:i[o][e]};return{}}const Dae={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:i,formatType:r}=n;return Cse(e,e.type,i,r,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return Ese(i,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var i;return null!==(i=t.grid)&&void 0!==i?i:function aWe(e,t){return!Hi(e)&&ge(t)&&!_n(null==t?void 0:t.bin)&&!es(null==t?void 0:t.bin)}(n,e)},gridScale:({model:e,channel:t})=>function lWe(e,t){const n="x"===t?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||Eae(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||Cae(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var i;return null!==(i=e.labelFlush)&&void 0!==i?i:function cWe(e,t){if("x"===t&&Dt(["quantitative","temporal"],e))return!0}(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var i;return null!==(i=e.labelOverlap)&&void 0!==i?i:function dWe(e,t,n,i){if(n&&!Se(i)||"nominal"!==e&&"ordinal"!==e)return"log"!==t&&"symlog"!==t||"greedy"}(t.type,n,ge(t)&&!!t.timeUnit,ge(t)?t.sort:void 0)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{var s;const o="x"===e?"width":"y"===e?"height":void 0,a=o?t.getSizeSignalRef(o):void 0;return null!==(s=n.tickCount)&&void 0!==s?s:function hWe({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){var r;if(!i&&!Hi(t)&&"log"!==t){if(ge(e)){if(_n(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&Dt(["month","hours","day","quarter"],null===(r=ts(e.timeUnit))||void 0===r?void 0:r.unit))return}return{signal:`ceil(${n.signal}/40)`}}}({fieldOrDatumDef:i,scaleType:r,size:a,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(void 0!==e.title)return e.title;const i=Sae(t,n);if(void 0!==i)return i;const r=t.typedFieldDef(n),o=t.fieldDef("x"===n?"x2":"y2");return kre(r?[Nse(r)]:[],ge(o)?[Nse(o)]:[])},values:({axis:e,fieldOrDatumDef:t})=>function pWe(e,t){const n=e.values;return ne(n)?Vse(t,n):Re(n)?n:void 0}(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var i;return null!==(i=e.zindex)&&void 0!==i?i:function gWe(e,t){return"rect"===e&&px(t)?1:0}(n,t)}};function I5(e){return`(((${e.signal} % 360) + 360) % 360)`}function Cae(e,t,n,i){if(void 0!==e){if("x"===n){if(Re(e)){const r=I5(e);return{signal:`(45 < ${r} && ${r} < 135) || (225 < ${r} && ${r} < 315) ? "middle" :(${r} <= 45 || 315 <= ${r}) === ${Re(t)?`(${t.signal} === "top")`:"top"===t} ? "bottom" : "top"`}}return 45<e&&e<135||225<e&&e<315?"middle":Re(t)?{signal:`${t.signal} ${e<=45||315<=e?"===":"!=="} "top" ? "bottom" : "top"`}:(e<=45||315<=e)==("top"===t)?"bottom":"top"}if(Re(e)){const r=I5(e);return{signal:`${r} <= 45 || 315 <= ${r} || (135 <= ${r} && ${r} <= 225) ? ${i?'"middle"':"null"} : (45 <= ${r} && ${r} <= 135) === ${Re(t)?`(${t.signal} === "left")`:"left"===t} ? "top" : "bottom"`}}return e<=45||315<=e||135<=e&&e<=225?i?"middle":null:Re(t)?{signal:`${t.signal} ${45<=e&&e<=135?"===":"!=="} "left" ? "top" : "bottom"`}:(45<=e&&e<=135)==("left"===t)?"top":"bottom"}}function Eae(e,t,n){if(void 0===e)return;const i="x"===n,r=i?0:90,s=i?"bottom":"left";if(Re(e)){const o=I5(e);return{signal:`(${r?`(${o} + 90)`:o} % 180 === 0) ? ${i?null:'"center"'} :(${r} < ${o} && ${o} < ${180+r}) === ${Re(t)?`(${t.signal} === "${s}")`:t===s} ? "left" : "right"`}}return(e+r)%180==0?i?null:"center":Re(t)?{signal:`${t.signal} ${r<e&&e<180+r?"===":"!=="} "${s}" ? "left" : "right"`}:(r<e&&e<180+r)==(t===s)?"left":"right"}function Sae(e,t){const n="x"===t?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),s=i?i.title:void 0,o=r?r.title:void 0;return s&&o?Ire(s,o):s||o||(void 0!==s?s:void 0!==o?o:void 0)}class o0 extends rn{constructor(t,n){super(t),this.transform=n,this._dependentFields=_ae(this.transform.calculate)}clone(){return new o0(null,nt(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((i,r)=>{if(Qh(i)&&Ose(i.sort)){const{field:s,timeUnit:o}=i,a=i.sort,l=a.map((u,c)=>`${rse({field:s,timeUnit:o,equal:u})} ? ${c} : `).join("")+a.length;t=new o0(t,{calculate:l,as:a0(i,r,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${wt(this.transform)}`}}function a0(e,t,n){return _e(e,Object.assign({prefix:t,suffix:"sort_index"},null!=n?n:{}))}function Px(e,t){return Dt(["top","bottom"],t)?"column":Dt(["left","right"],t)||"row"===e?"row":"column"}function l0(e,t,n,i){return hi((t||{})[e],("row"===i?n.headerRow:"column"===i?n.headerColumn:n.headerFacet)[e],n.header[e])}function Lx(e,t,n,i){const r={};for(const s of e){const o=l0(s,t||{},n,i);void 0!==o&&(r[s]=o)}return r}const R5=["row","column"],F5=["header","footer"];function mWe(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:s,titleAngle:o,titleOrient:a}=Lx(["titleAnchor","titleAngle","titleOrient"],r.header,i,t),l=Px(t,a),u=t1(o);return{name:`${t}-title`,type:"group",role:`${l}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},"row"===t?{orient:"left"}:{}),{style:"guide-title"}),Aae(u,l)),xae(l,u,s)),Mae(i,r,t,oqe,uoe))}}function xae(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const i=Eae(t,"row"===e?"left":"top","row"===e?"y":"x");return i?{align:i}:{}}function Aae(e,t){const n=Cae(e,"row"===t?"left":"top","row"===t?"y":"x",!0);return n?{baseline:n}:{}}function _We(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of F5)if(n[r])for(const s of n[r]){const o=vWe(e,t,r,n,s);null!=o&&i.push(o)}return i}function yWe(e,t){var n;const{sort:i}=e;return eu(i)?{field:_e(i,{expr:"datum"}),order:null!==(n=i.order)&&void 0!==n?n:"ascending"}:ne(i)?{field:a0(e,t,{expr:"datum"}),order:"ascending"}:{field:_e(e,{expr:"datum"}),order:null!=i?i:"ascending"}}function P5(e,t,n){const{format:i,formatType:r,labelAngle:s,labelAnchor:o,labelOrient:a,labelExpr:l}=Lx(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),u=Hj({fieldOrDatumDef:e,format:i,formatType:r,expr:"parent",config:n}).signal,c=Px(t,a);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:l?Vh(Vh(l,"datum.label",u),"datum.value",_e(e,{expr:"parent"})):u}},"row"===t?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),Aae(s,c)),xae(c,s,o)),Mae(n,e,t,aqe,coe))}function vWe(e,t,n,i,r){if(r){let s=null;const{facetFieldDef:o}=i,a=e.config?e.config:void 0;if(o&&r.labels){const{labelOrient:d}=Lx(["labelOrient"],o.header,a,t);("row"===t&&!Dt(["top","bottom"],d)||"column"===t&&!Dt(["left","right"],d))&&(s=P5(o,t,a))}const l=Ya(e)&&!c1(e.facet),u=r.axes,c=(null==u?void 0:u.length)>0;if(s||c){const d="row"===t?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},i.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:yWe(o,t)}:{}),c&&l?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),s?{title:s}:{}),r.sizeSignal?{encode:{update:{[d]:r.sizeSignal}}}:{}),c?{axes:u}:{})}}return null}const bWe={column:{start:0,end:1},row:{start:1,end:0}};function wWe(e,t){return bWe[t][e]}function Mae(e,t,n,i,r){const s={};for(const o of i){if(!r[o])continue;const a=l0(o,null==t?void 0:t.header,e,n);void 0!==a&&(s[r[o]]=a)}return s}function L5(e){return[...jx(e,"width"),...jx(e,"height"),...jx(e,"childWidth"),...jx(e,"childHeight")]}function jx(e,t){const n="width"===t?"x":"y",i=e.component.layoutSize.get(t);if(!i||"merged"===i)return[];const r=e.getSizeSignalRef(t).signal;if("step"===i){const s=e.getScaleComponent(n);if(s){const o=s.get("type"),a=s.get("range");if(Hi(o)&&Wd(a)){const l=e.scaleName(n);return Ya(e.parent)&&"independent"===e.parent.component.resolve.scale[n]?[Tae(l,a)]:[Tae(l,a),{name:r,update:Oae(l,s,`domain('${l}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==i){const s=r.endsWith("width"),o=s?"containerSize()[0]":"containerSize()[1]",l=`isFinite(${o}) ? ${o} : ${f5(e.config.view,s?"width":"height")}`;return[{name:r,init:l,on:[{update:l,events:"window:resize"}]}]}return[{name:r,value:i}]}function Tae(e,t){const n=`${e}_step`;return Re(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function Oae(e,t,n){const i=t.get("type"),r=t.get("padding"),s=hi(t.get("paddingOuter"),r);let o=t.get("paddingInner");return o="band"===i?void 0!==o?o:r:1,`bandspace(${n}, ${uc(o)}, ${uc(s)}) * ${e}_step`}function Nae(e){return"childWidth"===e?"width":"childHeight"===e?"height":e}function kae(e,t){return oe(e).reduce((n,i)=>{const r=e[i];return Object.assign(Object.assign({},n),n0(t,r,i,s=>Cn(s.value)))},{})}function Iae(e,t){if(Ya(t))return"theta"===e?"independent":"shared";if(d0(t))return"shared";if(Z5(t))return Zi(e)||"theta"===e||"radius"===e?"independent":"shared";throw new Error("invalid model type for resolve")}function j5(e,t){const n=e.scale[t],i=Zi(t)?"axis":"legend";return"independent"===n?("shared"===e[i][t]&&ce(function lUe(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}(t)),"independent"):e[i][t]||"shared"}const CWe=Object.assign(Object.assign({},hoe),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),Rae=oe(CWe);class EWe extends fc{}const Fae={symbols:function SWe(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r,legendType:s}){var o,a,l,u,c,d,f,h;if("symbol"!==s)return;const{markDef:p,encoding:g,config:m,mark:_}=n,y=p.filled&&"trail"!==_;let v=Object.assign(Object.assign({},function y9e(e,t,n){for(const i of n){const r=Gh(i,t.markDef,t.config);void 0!==r&&(e[i]=Cn(r))}return e}({},n,cze)),Qoe(n,{filled:y}));const b=null!==(o=r.get("symbolOpacity"))&&void 0!==o?o:m.legend.symbolOpacity,D=null!==(a=r.get("symbolFillColor"))&&void 0!==a?a:m.legend.symbolFillColor,C=null!==(l=r.get("symbolStrokeColor"))&&void 0!==l?l:m.legend.symbolStrokeColor,w=void 0===b?null!==(u=Pae(g.opacity))&&void 0!==u?u:p.opacity:void 0;if(v.fill)if("fill"===i||y&&i===Cs)delete v.fill;else if(v.fill.field)D?delete v.fill:(v.fill=Cn(null!==(c=m.legend.symbolBaseFillColor)&&void 0!==c?c:"black"),v.fillOpacity=Cn(null!=w?w:1));else if(ne(v.fill)){const E=null!==(h=null!==(f=B5(null!==(d=g.fill)&&void 0!==d?d:g.color))&&void 0!==f?f:p.fill)&&void 0!==h?h:y&&p.color;E&&(v.fill=Cn(E))}if(v.stroke)if("stroke"===i||!y&&i===Cs)delete v.stroke;else if(v.stroke.field||C)delete v.stroke;else if(ne(v.stroke)){const E=hi(B5(g.stroke||g.color),p.stroke,y?p.color:void 0);E&&(v.stroke={value:E})}if(i!==sc){const E=ge(t)&&jae(0,r,t);E?v.opacity=[Object.assign({test:E},Cn(null!=w?w:1)),Cn(m.legend.unselectedOpacity)]:w&&(v.opacity=Cn(w))}return v=Object.assign(Object.assign({},v),e),nn(v)?void 0:v},gradient:function xWe(e,{model:t,legendType:n,legendCmpt:i}){var r;if("gradient"!==n)return;const{config:s,markDef:o,encoding:a}=t;let l={};const c=void 0===(null!==(r=i.get("gradientOpacity"))&&void 0!==r?r:s.legend.gradientOpacity)?Pae(a.opacity)||o.opacity:void 0;return c&&(l.opacity=Cn(c)),l=Object.assign(Object.assign({},l),e),nn(l)?void 0:l},labels:function AWe(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){const s=n.legend(i)||{},o=n.config,a=ge(t)?jae(0,r,t):void 0,l=a?[{test:a,value:1},{value:o.legend.unselectedOpacity}]:void 0,{format:u,formatType:c}=s,d=Xh(c)?Uj({fieldOrDatumDef:t,field:"datum.value",format:u,formatType:c,config:o}):void 0,f=Object.assign(Object.assign(Object.assign({},l?{opacity:l}:{}),d?{text:d}:{}),e);return nn(f)?void 0:f},entries:function MWe(e,{legendCmpt:t}){const n=t.get("selections");return(null==n?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}};function Pae(e){return Lae(e,(t,n)=>Math.max(t,n.value))}function B5(e){return Lae(e,(t,n)=>hi(t,n.value))}function Lae(e,t){return function Aze(e){const t=e&&e.condition;return!!t&&(ne(t)||qa(t))}(e)?we(e.condition).reduce(t,e.value):qa(e)?e.value:void 0}function jae(e,t,n){const i=t.get("selections");if(!(null==i?void 0:i.length))return;const r=pe(n.field);return i.map(s=>`(!length(data(${pe(Fn(s)+ep)})) || (${s}[${r}] && indexof(${s}[${r}], datum.value) >= 0))`).join(" || ")}const Bae={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:i,formatType:r}=t;return Cse(e,e.type,i,r,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return Ese(i,t,n)},gradientLength:e=>{var t,n;const{legend:i,legendConfig:r}=e;return null!==(n=null!==(t=i.gradientLength)&&void 0!==t?t:r.gradientLength)&&void 0!==n?n:function FWe({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){const{gradientHorizontalMaxLength:s,gradientHorizontalMinLength:o,gradientVerticalMaxLength:a,gradientVerticalMinLength:l}=e;if(Ua(r))return"horizontal"===n?"top"===i||"bottom"===i?$ae(t,"width",o,s):o:$ae(t,"height",l,a)}(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var i,r;return null!==(r=null!==(i=e.labelOverlap)&&void 0!==i?i:t.labelOverlap)&&void 0!==r?r:function PWe(e){if(Dt(["quantile","threshold","log","symlog"],e))return"greedy"}(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>{var r;return null!==(r=e.symbolType)&&void 0!==r?r:function OWe(e,t,n,i){var r;if("shape"!==t){const s=null!==(r=B5(n))&&void 0!==r?r:i;if(s)return s}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(t.type,n,i.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>Km(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(Um(n)&&Ua(t)){if("gradient"===e)return}else if("symbol"===e)return;return e},values:({fieldOrDatumDef:e,legend:t})=>function TWe(e,t){const n=e.values;return ne(n)?Vse(t,n):Re(n)?n:void 0}(t,e)};function $ae(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`}}function Vae(e){const t=pi(e)?function LWe(e){const{encoding:t}=e,n={};for(const i of[Cs,...foe]){const r=Ai(t[i]);!r||!e.getScaleComponent(i)||i===Es&&ge(r)&&r.type===Gm||(n[i]=$We(e,i))}return n}(e):function VWe(e){const{legends:t,resolve:n}=e.component;for(const i of e.children){Vae(i);for(const r of oe(i.component.legends))n.legend[r]=j5(e.component.resolve,r),"shared"===n.legend[r]&&(t[r]=Hae(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]))}for(const i of oe(t))for(const r of e.children)!r.component.legends[i]||"shared"===n.legend[i]&&delete r.component.legends[i];return t}(e);return e.component.legends=t,t}function BWe(e,t,n,i){switch(t){case"disable":return void 0!==n;case"values":return!!(null==n?void 0:n.values);case"title":if("title"===t&&e===(null==i?void 0:i.title))return!0}return e===(n||{})[t]}function $We(e,t){var n,i,r;let s=e.legend(t);const{markDef:o,encoding:a,config:l}=e,u=l.legend,c=new EWe({},function jWe(e,t){const n=e.scaleName(t);if("trail"===e.mark){if("color"===t)return{stroke:n};if("size"===t)return{strokeWidth:n}}return"color"===t?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}(e,t));!function JGe(e,t,n){var i,r,s,o;const a=null===(i=e.fieldDef(t))||void 0===i?void 0:i.field;for(const l of Er(null!==(r=e.component.selection)&&void 0!==r?r:{})){const u=null!==(s=l.project.hasField[a])&&void 0!==s?s:l.project.hasChannel[t];if(u&&aae.defined(l)){const c=null!==(o=n.get("selections"))&&void 0!==o?o:[];c.push(l.name),n.set("selections",c,!1),u.hasLegend=!0}}}(e,t,c);const d=void 0!==s?!s:u.disable;if(c.set("disable",d,void 0!==s),d)return c;s=s||{};const f=e.getScaleComponent(t).get("type"),h=Ai(a[t]),p=ge(h)?null===(n=ts(h.timeUnit))||void 0===n?void 0:n.unit:void 0,g=s.orient||l.legend.orient||"right",m=function NWe(e){const{legend:t}=e;return hi(t.type,function kWe({channel:e,timeUnit:t,scaleType:n}){if(Um(e)){if(Dt(["quarter","month","day"],t))return"symbol";if(Ua(n))return"gradient"}return"symbol"}(e))}({legend:s,channel:t,timeUnit:p,scaleType:f}),_=function IWe({legendConfig:e,legendType:t,orient:n,legend:i}){var r,s;return null!==(s=null!==(r=i.direction)&&void 0!==r?r:e[t?"gradientDirection":"symbolDirection"])&&void 0!==s?s:function RWe(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===t?"horizontal":void 0}}(n,t)}({legend:s,legendType:m,orient:g,legendConfig:u}),y={legend:s,channel:t,model:e,markDef:o,encoding:a,fieldOrDatumDef:h,legendConfig:u,config:l,scaleType:f,orient:g,legendType:m,direction:_};for(const w of Rae){if("gradient"===m&&w.startsWith("symbol")||"symbol"===m&&w.startsWith("gradient"))continue;const E=w in Bae?Bae[w](y):s[w];if(void 0!==E){const T=BWe(E,w,s,e.fieldDef(t));(T||void 0===l.legend[w])&&c.set(w,E,T)}}const v=null!==(i=null==s?void 0:s.encoding)&&void 0!==i?i:{},b=c.get("selections"),D={},C={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:c,legendType:m};for(const w of["labels","legend","title","symbols","gradient","entries"]){const E=kae(null!==(r=v[w])&&void 0!==r?r:{},e),T=w in Fae?Fae[w](E,C):E;void 0!==T&&!nn(T)&&(D[w]=Object.assign(Object.assign(Object.assign({},(null==b?void 0:b.length)&&ge(h)?{name:`${Fn(h.field)}_legend_${w}`}:{}),(null==b?void 0:b.length)?{interactive:!!b}:{}),{update:T}))}return nn(D)||c.set("encode",D,!!(null==s?void 0:s.encoding)),c}function Hae(e,t){var n,i,r,s;if(!e)return t.clone();const o=e.getWithExplicit("orient"),a=t.getWithExplicit("orient");if(o.explicit&&a.explicit&&o.value!==a.value)return;let l=!1;for(const u of Rae){const c=Qd(e.getWithExplicit(u),t.getWithExplicit(u),u,"legend",(d,f)=>{switch(u){case"symbolType":return HWe(d,f);case"title":return Rre(d,f);case"type":return l=!0,uo("symbol")}return Mx(d,f,u,"legend")});e.setWithExplicit(u,c)}return l&&((null===(i=null===(n=e.implicit)||void 0===n?void 0:n.encode)||void 0===i?void 0:i.gradient)&&jS(e.implicit,["encode","gradient"]),(null===(s=null===(r=e.explicit)||void 0===r?void 0:r.encode)||void 0===s?void 0:s.gradient)&&jS(e.explicit,["encode","gradient"])),e}function HWe(e,t){return"circle"===t.value?t:e}function Uae(e){const t=e.component.legends,n={};for(const r of oe(t)){const s=e.getScaleComponent(r),o=mn(s.get("domains"));if(n[o])for(const a of n[o])Hae(a,t[r])||n[o].push(t[r]);else n[o]=[t[r].clone()]}return Er(n).flat().map(r=>function qWe(e,t){var n,i,r;const s=e.combine(),{disable:o,labelExpr:a}=s,u=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(s,["disable","labelExpr","selections"]);if(!o){if(!1===t.aria&&null==u.aria&&(u.aria=!1),null===(n=u.encode)||void 0===n?void 0:n.symbols){const c=u.encode.symbols.update;c.fill&&"transparent"!==c.fill.value&&!c.stroke&&!u.stroke&&(c.stroke={value:"transparent"});for(const d of foe)u[d]&&delete c[d]}if(u.title||delete u.title,void 0!==a){let c=a;(null===(r=null===(i=u.encode)||void 0===i?void 0:i.labels)||void 0===r?void 0:r.update)&&Re(u.encode.labels.update.text)&&(c=Vh(a,"datum.label",u.encode.labels.update.text.signal)),function zWe(e,t,n,i){var r,s,o,a,l;null!==(r=e.encode)&&void 0!==r||(e.encode={}),null!==(s=(a=e.encode)[t])&&void 0!==s||(a[t]={}),null!==(o=(l=e.encode[t]).update)&&void 0!==o||(l.update={}),e.encode[t].update[n]=i}(u,"labels","text",{signal:c})}return u}}(r,e.config)).filter(r=>void 0!==r)}function zae(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:i}=n;if(t.data){const r={signal:`[${t.size.map(o=>o.signal).join(", ")}]`},s=t.data.reduce((o,a)=>{const l=Re(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return Dt(o,l)||o.push(l),o},[]);if(s.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:i,size:r,fit:{signal:s.length>1?`[${s.join(", ")}]`:s[0]}},n)]}return[Object.assign(Object.assign({name:i},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const YWe=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class qae extends fc{constructor(t,n,i,r){super(Object.assign({},n),{name:t}),this.specifiedProjection=n,this.size=i,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function Gae(e){e.component.projection=pi(e)?function KWe(e){var t;if(e.hasProjection){const n=xs(e.specifiedProjection),i=!(n&&(null!=n.scale||null!=n.translate)),r=i?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,s=i?function JWe(e){const t=[],{encoding:n}=e;for(const i of[[Yl,Wl],[zo,Ha]])(Ai(n[i[0]])||Ai(n[i[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(Es)&&e.typedFieldDef(Es).type===Gm&&t.push({signal:e.getName(`geojson_${t.length}`)}),0===t.length&&t.push(e.requestDataName(hn.Main)),t}(e):void 0,o=new qae(e.projectionName(!0),Object.assign(Object.assign({},null!==(t=xs(e.config.projection))&&void 0!==t?t:{}),null!=n?n:{}),r,s);return o.get("type")||o.set("type","equalEarth",!1),o}}(e):function QWe(e){if(0===e.children.length)return;let t;for(const i of e.children)Gae(i);const n=ej(e.children,i=>{const r=i.component.projection;if(r){if(t){const s=function XWe(e,t){const n=ej(YWe,r=>!!(!ke(e.explicit,r)&&!ke(t.explicit,r)||ke(e.explicit,r)&&ke(t.explicit,r)&&Ul(e.get(r),t.get(r))));if(Ul(e.size,t.size)){if(n)return e;if(Ul(e.explicit,{}))return t;if(Ul(t.explicit,{}))return e}return null}(t,r);return s&&(t=s),!!s}return t=r,!0}return!0});if(t&&n){const i=e.projectionName(!0),r=new qae(i,t.specifiedProjection,t.size,nt(t.data));for(const s of e.children){const o=s.component.projection;o&&(o.isFit&&r.data.push(...s.component.projection.data),s.renameProjection(o.get("name"),i),o.merged=!0)}return r}}(e)}function Wae(e,t){return`${Cre(e)}_${t}`}function $5(e,t,n){var i;const s=Wae(null!==(i=_x(n,void 0))&&void 0!==i?i:{},t);return e.getName(`${s}_bins`)}function Yae(e,t,n){let i,r;i=function nYe(e){return"as"in e}(e)?be(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:[_e(e,{forAs:!0}),_e(e,{binSuffix:"end",forAs:!0})];const s=Object.assign({},_x(t,void 0)),o=Wae(s,e.field),{signal:a,extentSignal:l}=function tYe(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}(n,o);if(JS(s.extent)){const c=s.extent;r=vae(n,c.param,c),delete s.extent}return{key:o,binComponent:Object.assign(Object.assign(Object.assign({bin:s,field:e.field,as:[i]},a?{signal:a}:{}),l?{extentSignal:l}:{}),r?{span:r}:{})}}class au extends rn{constructor(t,n){super(t),this.bins=n}clone(){return new au(null,nt(this.bins))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s,o)=>{if(Go(s)&&_n(s.bin)){const{key:a,binComponent:l}=Yae(s,s.bin,n);r[a]=Object.assign(Object.assign(Object.assign({},l),r[a]),function eYe(e,t,n,i){var r,s;if(f1(t,n)){const o=pi(e)&&null!==(s=null!==(r=e.axis(n))&&void 0!==r?r:e.legend(n))&&void 0!==s?s:{},a=_e(t,{expr:"datum"}),l=_e(t,{expr:"datum",binSuffix:"end"});return{formulaAs:_e(t,{binSuffix:"range",forAs:!0}),formula:ax(a,l,o.format,o.formatType,i)}}return{}}(n,s,o,n.config))}return r},{});return nn(i)?null:new au(t,i)}static makeFromTransform(t,n,i){const{key:r,binComponent:s}=Yae(n,n.bin,i);return new au(t,{[r]:s})}merge(t,n){for(const i of oe(t.bins))i in this.bins?(n(t.bins[i].signal,this.bins[i].signal),this.bins[i].as=zl([...this.bins[i].as,...t.bins[i].as],wt)):this.bins[i]=t.bins[i];for(const i of t.children)t.removeChild(i),i.parent=this;t.remove()}producedFields(){return new Set(Er(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(Er(this.bins).map(t=>t.field))}hash(){return`Bin ${wt(this.bins)}`}assemble(){return Er(this.bins).flatMap(t=>{const n=[],[i,...r]=t.as,s=t.bin,{extent:o}=s,a=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(s,["extent"]),l=Object.assign(Object.assign(Object.assign({type:"bin",field:Uo(t.field),as:i,signal:t.signal},JS(o)?{extent:null}:{extent:o}),t.span?{span:{signal:`span(${t.span})`}}:{}),a);!o&&t.extentSignal&&(n.push({type:"extent",field:Uo(t.field),signal:t.extentSignal}),l.extent={signal:t.extentSignal}),n.push(l);for(const u of r)for(let c=0;c<2;c++)n.push({type:"formula",expr:_e({field:i[c]},{expr:"datum"}),as:u[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}class Ga extends rn{constructor(t,n,i){super(t),this.dimensions=n,this.measures=i}clone(){return new Ga(null,new Set(this.dimensions),nt(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let i=!1;n.forEachFieldDef(o=>{o.aggregate&&(i=!0)});const r={},s=new Set;return i&&(n.forEachFieldDef((o,a)=>{var l,u,c,d;const{aggregate:f,field:h}=o;if(f)if("count"===f)null!==(l=r["*"])&&void 0!==l||(r["*"]={}),r["*"].count=new Set([_e(o,{forAs:!0})]);else{if(ac(f)||qd(f)){const p=ac(f)?"argmin":"argmax",g=f[p];null!==(u=r[g])&&void 0!==u||(r[g]={}),r[g][p]=new Set([_e({op:p,field:g},{forAs:!0})])}else null!==(c=r[h])&&void 0!==c||(r[h]={}),r[h][f]=new Set([_e(o,{forAs:!0})]);zd(a)&&"unaggregated"===n.scaleDomain(a)&&(null!==(d=r[h])&&void 0!==d||(r[h]={}),r[h].min=new Set([_e({field:h,aggregate:"min"},{forAs:!0})]),r[h].max=new Set([_e({field:h,aggregate:"max"},{forAs:!0})]))}else!function iYe(e,t,n,i){var r;const s=pi(i)?i.encoding[oc(t)]:void 0;if(Go(n)&&pi(i)&&Rse(n,s,i.markDef,i.config))e.add(_e(n,{})),e.add(_e(n,{suffix:"end"})),n.bin&&f1(n,t)&&e.add(_e(n,{binSuffix:"range"}));else if(function qHe(e){return e in oj}(t)){const o=function zHe(e){switch(e){case Wl:return"y";case Ha:return"y2";case Yl:return"x";case zo:return"x2"}}(t);e.add(i.getName(o))}else e.add(_e(n));return Qh(n)&&function eze(e){return Se(e)&&"field"in e}(null===(r=n.scale)||void 0===r?void 0:r.range)&&e.add(n.scale.range.field),e}(s,a,o,n)}),s.size+oe(r).length!==0)?new Ga(t,s,r):null}static makeFromTransform(t,n){var i,r,s;const o=new Set,a={};for(const l of n.aggregate){const{op:u,field:c,as:d}=l;u&&("count"===u?(null!==(i=a["*"])&&void 0!==i||(a["*"]={}),a["*"].count=new Set([d||_e(l,{forAs:!0})])):(null!==(r=a[c])&&void 0!==r||(a[c]={}),a[c][u]=new Set([d||_e(l,{forAs:!0})])))}for(const l of null!==(s=n.groupby)&&void 0!==s?s:[])o.add(l);return o.size+oe(a).length===0?null:new Ga(t,o,a)}merge(t){return ore(this.dimensions,t.dimensions)?(function rYe(e,t){var n;for(const i of oe(t)){const r=t[i];for(const s of oe(r))i in e?e[i][s]=new Set([...null!==(n=e[i][s])&&void 0!==n?n:[],...r[s]]):e[i]={[s]:r[s]}}}(this.measures,t.measures),!0):(function SUe(...e){Ql.debug(...e)}("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...oe(this.measures)])}producedFields(){const t=new Set;for(const n of oe(this.measures))for(const i of oe(this.measures[n])){const r=this.measures[n][i];0===r.size?t.add(`${i}_${n}`):r.forEach(t.add,t)}return t}hash(){return`Aggregate ${wt({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],i=[];for(const s of oe(this.measures))for(const o of oe(this.measures[s]))for(const a of this.measures[s][o])i.push(a),t.push(o),n.push("*"===s?null:Uo(s));return{type:"aggregate",groupby:[...this.dimensions].map(Uo),ops:t,fields:n,as:i}}}class u0 extends rn{constructor(t,n,i,r){super(t),this.model=n,this.name=i,this.data=r;for(const s of qo){const o=n.facet[s];if(o){const{bin:a,sort:l}=o;this[s]=Object.assign({name:n.getName(`${s}_domain`),fields:[_e(o),..._n(a)?[_e(o,{binSuffix:"end"})]:[]]},eu(l)?{sortField:l}:ne(l)?{sortIndexField:a0(o,s)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of qo)this[n]&&(t+=` ${n.charAt(0)}:${wt(this[n])}`);return t}get fields(){var t;const n=[];for(const i of qo)(null===(t=this[i])||void 0===t?void 0:t.fields)&&n.push(...this[i].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of qo)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of Xl){const i=this.childModel.component.scales[n];if(i&&!i.merged){const r=i.get("type"),s=i.get("range");if(Hi(r)&&Wd(s)){const a=J5($x(this.childModel,n));a?t[n]=a:ce(_j(n))}}}return t}assembleRowColumnHeaderData(t,n,i){const r={row:"y",column:"x",facet:void 0}[t],s=[],o=[],a=[];r&&i&&i[r]&&(n?(s.push(`distinct_${i[r]}`),o.push("max")):(s.push(i[r]),o.push("distinct")),a.push(`distinct_${i[r]}`));const{sortField:l,sortIndexField:u}=this[t];if(l){const{op:c=lx,field:d}=l;s.push(d),o.push(c),a.push(_e(l,{forAs:!0}))}else u&&(s.push(u),o.push("max"),a.push(u));return{name:this[t].name,source:null!=n?n:this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},s.length?{fields:s,ops:o,as:a}:{})]}}assembleFacetHeaderData(t){var n,i;const{columns:r}=this.model.layout,{layoutHeaders:s}=this.model.component,o=[],a={};for(const c of R5){for(const d of F5){const f=null!==(n=s[c]&&s[c][d])&&void 0!==n?n:[];for(const h of f)if((null===(i=h.axes)||void 0===i?void 0:i.length)>0){a[c]=!0;break}}if(a[c]){const d=`length(data("${this.facet.name}"))`;o.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:"row"===c?r?{signal:`ceil(${d} / ${r})`}:1:r?{signal:`min(${d}, ${r})`}:{signal:d}}]})}}const{row:l,column:u}=a;return(l||u)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,t)),o}assemble(){var t,n;const i=[];let r=null;const s=this.getChildIndependentFieldsWithStep(),{column:o,row:a,facet:l}=this;if(o&&a&&(s.x||s.y)){r=`cross_${this.column.name}_${this.row.name}`;const u=[].concat(null!==(t=s.x)&&void 0!==t?t:[],null!==(n=s.y)&&void 0!==n?n:[]),c=u.map(()=>"distinct");i.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:u,ops:c}]})}for(const u of[tc,ec])this[u]&&i.push(this.assembleRowColumnHeaderData(u,r,s));if(l){const u=this.assembleFacetHeaderData(s);u&&i.push(...u)}return i}}function Kae(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function oYe(e){const t={};return LS(e.filter,n=>{var i;if(ise(n)){let r=null;Ej(n)?r=ao(n.equal):xj(n)?r=ao(n.lte):Sj(n)?r=ao(n.lt):Aj(n)?r=ao(n.gt):Mj(n)?r=ao(n.gte):Tj(n)?r=n.range[0]:Oj(n)&&(r=(null!==(i=n.oneOf)&&void 0!==i?i:n.in)[0]),r&&(Wh(r)?t[n.field]="date":en(r)?t[n.field]="number":be(r)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}class Ar extends rn{constructor(t,n){super(t),this._parse=n}clone(){return new Ar(null,nt(this._parse))}hash(){return`Parse ${wt(this._parse)}`}static makeExplicit(t,n,i){var r;let s={};const o=n.data;return!Zd(o)&&(null===(r=null==o?void 0:o.format)||void 0===r?void 0:r.parse)&&(s=o.format.parse),this.makeWithAncestors(t,s,{},i)}static makeWithAncestors(t,n,i,r){for(const a of oe(i)){const l=r.getWithExplicit(a);void 0!==l.value&&(l.explicit||l.value===i[a]||"derived"===l.value||"flatten"===i[a]?delete i[a]:ce(Vre(a,i[a],l.value)))}for(const a of oe(n)){const l=r.get(a);void 0!==l&&(l===n[a]?delete n[a]:ce(Vre(a,n[a],l)))}const s=new fc(n,i);r.copyAll(s);const o={};for(const a of oe(s.combine())){const l=s.get(a);null!==l&&(o[a]=l)}return 0===oe(o).length||r.parseNothing?null:new Ar(t,o)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of oe(this._parse)){const i=this._parse[n];1===Vm(n)&&(t[n]=i)}return t}producedFields(){return new Set(oe(this._parse))}dependentFields(){return new Set(oe(this._parse))}assembleTransforms(t=!1){return oe(this._parse).filter(n=>!t||Vm(n)>1).map(n=>{const i=function sYe(e,t){const n=rj(e);return"number"===t?`toNumber(${n})`:"boolean"===t?`toBoolean(${n})`:"string"===t?`toString(${n})`:"date"===t?`toDate(${n})`:"flatten"===t?n:t.startsWith("date:")?`timeParse(${n},'${Kae(t.slice(5,t.length))}')`:t.startsWith("utc:")?`utcParse(${n},'${Kae(t.slice(4,t.length))}')`:(ce(function N9e(e){return`Unrecognized parse "${e}".`}(t)),null)}(n,this._parse[n]);return i?{type:"formula",expr:i,as:sj(n)}:null}).filter(n=>null!==n)}}class rf extends rn{clone(){return new rf(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([p1])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:p1}}}class b1 extends rn{constructor(t,n){super(t),this.params=n}clone(){return new b1(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${wt(this.params)}`}assemble(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}class w1 extends rn{constructor(t,n){super(t),this.params=n}clone(){return new w1(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([null!==(t=this.params.as)&&void 0!==t?t:"data"])}hash(){return`Hash ${wt(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}class tp extends rn{constructor(t){let n;if(super(null),null!=t||(t={name:"source"}),Zd(t)||(n=t.format?Object.assign({},oo(t.format,["parse"])):{}),g1(t))this._data={values:t.values};else if(Zm(t)){if(this._data={url:t.url},!n.type){let i=/(?:\.([^.]+))?$/.exec(t.url)[1];Dt(["json","csv","tsv","dsv","topojson"],i)||(i="json"),n.type=i}}else qoe(t)?this._data={values:[{type:"Sphere"}]}:(Uoe(t)||Zd(t))&&(this._data={});this._generator=Zd(t),t.name&&(this._name=t.name),n&&!nn(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}var D1,Jae=function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n};function V5(e){return e instanceof tp||e instanceof b1||e instanceof w1}class H5{constructor(){D1.set(this,void 0),Jae(this,D1,!1,"f")}setModified(){Jae(this,D1,!0,"f")}get modifiedFlag(){return function(e,t,n,i){if("function"==typeof t||!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}(this,D1)}}D1=new WeakMap;class np extends H5{getNodeDepths(t,n,i){i.set(t,n);for(const r of t.children)this.getNodeDepths(r,n+1,i);return i}optimize(t){const i=[...this.getNodeDepths(t,0,new Map).entries()].sort((r,s)=>s[1]-r[1]);for(const r of i)this.run(r[0]);return this.modifiedFlag}}class U5 extends H5{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class cYe extends U5{mergeNodes(t,n){const i=n.shift();for(const r of n)t.removeChild(r),r.parent=i,r.remove()}run(t){const n=t.children.map(r=>r.hash()),i={};for(let r=0;r<n.length;r++)void 0===i[n[r]]?i[n[r]]=[t.children[r]]:i[n[r]].push(t.children[r]);for(const r of oe(i))i[r].length>1&&(this.setModified(),this.mergeNodes(t,i[r]))}}class dYe extends U5{constructor(t){super(),this.requiresSelectionId=t&&T5(t)}run(t){t instanceof rf&&(this.requiresSelectionId&&(V5(t.parent)||t.parent instanceof Ga||t.parent instanceof Ar)||(this.setModified(),t.remove()))}}class fYe extends H5{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let i=new Set;t instanceof ou&&(i=t.producedFields(),tj(i,n)&&(this.setModified(),t.removeFormulas(n),0===t.producedFields.length&&t.remove()));for(const r of t.children)this.run(r,new Set([...n,...i]))}}class hYe extends U5{constructor(){super()}run(t){t instanceof ns&&!t.isRequired()&&(this.setModified(),t.remove())}}class pYe extends np{run(t){if(!(V5(t)||t.numChildren()>1))for(const n of t.children)if(n instanceof Ar)if(t instanceof Ar)this.setModified(),t.merge(n);else{if(ij(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}class gYe extends np{run(t){const n=[...t.children],i=t.children.filter(r=>r instanceof Ar);if(t.numChildren()>1&&i.length>=1){const r={},s=new Set;for(const o of i){const a=o.parse;for(const l of oe(a))l in r?r[l]!==a[l]&&s.add(l):r[l]=a[l]}for(const o of s)delete r[o];if(!nn(r)){this.setModified();const o=new Ar(t,r);for(const a of n){if(a instanceof Ar)for(const l of oe(r))delete a.parse[l];t.removeChild(a),a.parent=o,a instanceof Ar&&0===oe(a.parse).length&&a.remove()}}}}}class mYe extends np{run(t){t instanceof ns||t.numChildren()>0||t instanceof u0||t instanceof tp||(this.setModified(),t.remove())}}class _Ye extends np{run(t){const n=t.children.filter(r=>r instanceof ou),i=n.pop();for(const r of n)this.setModified(),i.merge(r)}}class yYe extends np{run(t){const n=t.children.filter(r=>r instanceof Ga),i={};for(const r of n){const s=wt(r.groupBy);s in i||(i[s]=[]),i[s].push(r)}for(const r of oe(i)){const s=i[r];if(s.length>1){const o=s.pop();for(const a of s)o.merge(a)&&(t.removeChild(a),a.parent=o,a.remove(),this.setModified())}}}}class vYe extends np{constructor(t){super(),this.model=t}run(t){const n=!(V5(t)||t instanceof s0||t instanceof Ar||t instanceof rf),i=[],r=[];for(const s of t.children)s instanceof au&&(n&&!ij(t.producedFields(),s.dependentFields())?i.push(s):r.push(s));if(i.length>0){const s=i.pop();for(const o of i)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof au?t.merge(s,this.model.renameSignal.bind(this.model)):s.swapWithParent()}if(r.length>1){const s=r.pop();for(const o of r)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified()}}}class bYe extends np{run(t){const n=[...t.children];if(!$h(n,o=>o instanceof ns)||t.numChildren()<=1)return;const r=[];let s;for(const o of n)if(o instanceof ns){let a=o;for(;1===a.numChildren();){const[l]=a.children;if(!(l instanceof ns))break;a=l}r.push(...a.children),s?(t.removeChild(o),o.parent=s.parent,s.parent.removeChild(s),s.parent=a,this.setModified()):s=a}else r.push(o);if(r.length){this.setModified();for(const o of r)o.parent.removeChild(o),o.parent=s}}}class ip extends rn{constructor(t,n){super(t),this.transform=n}clone(){return new ip(null,nt(this.transform))}addDimensions(t){this.transform.groupby=zl(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>void 0!==n).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return null!==(n=t.as)&&void 0!==n?n:_e(t)}hash(){return`JoinAggregateTransform ${wt(this.transform)}`}assemble(){const t=[],n=[],i=[];for(const s of this.transform.joinaggregate)n.push(s.op),i.push(this.getDefaultName(s)),t.push(void 0===s.field?null:s.field);const r=this.transform.groupby;return Object.assign({type:"joinaggregate",as:i,ops:n,fields:t},void 0!==r?{groupby:r}:{})}}class hc extends rn{constructor(t,n){super(t),this._stack=n}clone(){return new hc(null,nt(this._stack))}static makeFromTransform(t,n){const{stack:i,groupby:r,as:s,offset:o="zero"}=n,a=[],l=[];if(void 0!==n.sort)for(const d of n.sort)a.push(d.field),l.push(hi(d.order,"ascending"));const u={field:a,order:l};let c;return c=function DYe(e){return ne(e)&&e.every(t=>be(t))&&e.length>1}(s)?s:be(s)?[s,`${s}_end`]:[`${n.stack}_start`,`${n.stack}_end`],new hc(t,{dimensionFieldDefs:[],stackField:i,groupby:r,offset:o,sort:u,facetby:[],as:c})}static makeFromEncoding(t,n){const i=n.stack,{encoding:r}=n;if(!i)return null;const{groupbyChannels:s,fieldChannel:o,offset:a,impute:l}=i,u=s.map(h=>iu(r[h])).filter(h=>!!h),c=function wYe(e){return e.stack.stackBy.reduce((t,n)=>{const r=_e(n.fieldDef);return r&&t.push(r),t},[])}(n),d=n.encoding.order;let f;return f=ne(d)||ge(d)?Nre(d):c.reduce((h,p)=>(h.field.push(p),h.order.push("y"===o?"descending":"ascending"),h),{field:[],order:[]}),new hc(t,{dimensionFieldDefs:u,stackField:n.vgField(o),facetby:[],stackby:c,sort:f,offset:a,impute:l,as:[n.vgField(o,{suffix:"start",forAs:!0}),n.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${wt(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:t,impute:n,groupby:i}=this._stack;return t.length>0?t.map(r=>r.bin?n?[_e(r,{binSuffix:"mid"})]:[_e(r,{}),_e(r,{binSuffix:"end"})]:[_e(r)]).flat():null!=i?i:[]}assemble(){const t=[],{facetby:n,dimensionFieldDefs:i,stackField:r,stackby:s,sort:o,offset:a,impute:l,as:u}=this._stack;if(l)for(const c of i){const{bandPosition:d=.5,bin:f}=c;if(f){const h=_e(c,{expr:"datum"}),p=_e(c,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:`${d}*${h}+${1-d}*${p}`,as:_e(c,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:r,groupby:[...s,...n],key:_e(c,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:r,sort:o,as:u,offset:a}),t}}class c0 extends rn{constructor(t,n){super(t),this.transform=n}clone(){return new c0(null,nt(this.transform))}addDimensions(t){this.transform.groupby=zl(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const i=new Set;return(null!==(t=this.transform.groupby)&&void 0!==t?t:[]).forEach(i.add,i),(null!==(n=this.transform.sort)&&void 0!==n?n:[]).forEach(r=>i.add(r.field)),this.transform.window.map(r=>r.field).filter(r=>void 0!==r).forEach(i.add,i),i}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return null!==(n=t.as)&&void 0!==n?n:_e(t)}hash(){return`WindowTransform ${wt(this.transform)}`}assemble(){var t;const n=[],i=[],r=[],s=[];for(const f of this.transform.window)i.push(f.op),r.push(this.getDefaultName(f)),s.push(void 0===f.param?null:f.param),n.push(void 0===f.field?null:f.field);const o=this.transform.frame,a=this.transform.groupby;if(o&&null===o[0]&&null===o[1]&&i.every(f=>hj(f)))return Object.assign({type:"joinaggregate",as:r,ops:i,fields:n},void 0!==a?{groupby:a}:{});const l=[],u=[];if(void 0!==this.transform.sort)for(const f of this.transform.sort)l.push(f.field),u.push(null!==(t=f.order)&&void 0!==t?t:"ascending");const d=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:s,as:r,ops:i,fields:n,sort:{field:l,order:u}},void 0!==d?{ignorePeers:d}:{}),void 0!==a?{groupby:a}:{}),void 0!==o?{frame:o}:{})}}function z5(e){if(e instanceof u0)if(1!==e.numChildren()||e.children[0]instanceof ns){const t=e.model.component.data.main;Xae(t);const n=function CYe(e){return function t(n){if(!(n instanceof u0)){const i=n.clone();if(i instanceof ns){const r=q5+i.getSource();i.setSource(r),e.model.component.data.outputNodes[r]=i}else(i instanceof Ga||i instanceof hc||i instanceof c0||i instanceof ip)&&i.addDimensions(e.fields);for(const r of n.children.flatMap(t))r.parent=i;return[i]}return n.children.flatMap(t)}}(e),i=e.children.map(n).flat();for(const r of i)r.parent=t}else{const t=e.children[0];(t instanceof Ga||t instanceof hc||t instanceof c0||t instanceof ip)&&t.addDimensions(e.fields),t.swapWithParent(),z5(e)}else e.children.map(z5)}function Xae(e){if(e instanceof ns&&e.type===hn.Main&&1===e.numChildren()){const t=e.children[0];t instanceof u0||(t.swapWithParent(),Xae(e))}}const q5="scale_";function G5(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!G5(t.children))return!1}return!0}function Wa(e,t){let n=!1;for(const i of t)n=e.optimize(i)||n;return n}function Qae(e,t,n){let i=e.sources,r=!1;return r=Wa(new hYe,i)||r,r=Wa(new dYe(t),i)||r,i=i.filter(s=>s.numChildren()>0),r=Wa(new mYe,i)||r,i=i.filter(s=>s.numChildren()>0),n||(r=Wa(new pYe,i)||r,r=Wa(new vYe(t),i)||r,r=Wa(new fYe,i)||r,r=Wa(new gYe,i)||r,r=Wa(new yYe,i)||r,r=Wa(new _Ye,i)||r,r=Wa(new cYe,i)||r,r=Wa(new bYe,i)||r),e.sources=i,r}class Ms{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Ms(()=>t(n))}}function Zae(e){pi(e)?function xYe(e){const t=e.component.scales;for(const n of oe(t)){const i=TYe(e,n);if(t[n].setWithExplicit("domains",i),NYe(e,n),e.component.data.isFaceted){let s=e;for(;!Ya(s)&&s.parent;)s=s.parent;if("shared"===s.component.resolve.scale[n])for(const a of i.value)lc(a)&&(a.data=q5+a.data.replace(q5,""))}}}(e):function AYe(e){for(const n of e.children)Zae(n);const t=e.component.scales;for(const n of oe(t)){let i,r=null;for(const s of e.children){const o=s.component.scales[n];if(o){i=void 0===i?o.getWithExplicit("domains"):Qd(i,o.getWithExplicit("domains"),"domains","scale",K5);const a=o.get("selectionExtent");r&&a&&r.param!==a.param&&ce("The same selection must be used to override scale domains in a layered view."),r=a}}t[n].setWithExplicit("domains",i),r&&t[n].set("selectionExtent",r,!0)}}(e)}function TYe(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:i}=e,r=function MYe(e,t,n,i){if("unaggregated"===e){const{valid:r,reason:s}=ele(t,n);if(!r)return void ce(s)}else if(void 0===e&&i.useUnaggregatedDomain){const{valid:r}=ele(t,n);if(r)return"unaggregated"}return e}(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:r})),"x"===t&&Ai(i.x2)?Ai(i.x)?Qd(sf(n,r,e,"x"),sf(n,r,e,"x2"),"domain","scale",K5):sf(n,r,e,"x2"):"y"===t&&Ai(i.y2)?Ai(i.y)?Qd(sf(n,r,e,"y"),sf(n,r,e,"y2"),"domain","scale",K5):sf(n,r,e,"y2"):sf(n,r,e,t)}function W5(e,t,n){var i;const r=null===(i=ts(n))||void 0===i?void 0:i.unit;return"temporal"===t||r?function OYe(e,t,n){return e.map(i=>({signal:`{data: ${yx(i,{timeUnit:n,type:t})}}`}))}(e,t,r):[e]}function sf(e,t,n,i){const{encoding:r}=n,s=Ai(r[i]),{type:o}=s,a=s.timeUnit;if(function ZUe(e){return e&&e.unionWith}(t)){const d=sf(e,void 0,n,i),f=W5(t.unionWith,o,a);return su([...d.value,...f])}if(Re(t))return su([t]);if(t&&"unaggregated"!==t&&!dse(t))return su(W5(t,o,a));const l=n.stack;if(l&&i===l.fieldChannel){if("normalize"===l.offset)return uo([[0,1]]);const d=n.requestDataName(hn.Main);return uo([{data:d,field:n.vgField(i,{suffix:"start"})},{data:d,field:n.vgField(i,{suffix:"end"})}])}const u=zd(i)&&ge(s)?function kYe(e,t,n){if(!Hi(n))return;const i=e.fieldDef(t),r=i.sort;if(Ose(r))return{op:"min",field:a0(i,t),order:"ascending"};const{stack:s}=e,o=s?new Set([...s.groupbyFields,...s.stackBy.map(a=>a.fieldDef.field)]):void 0;if(eu(r))return Y5(r,s&&!o.has(r.field));if(Tse(r)){const{encoding:a,order:l}=r,u=e.fieldDef(a),{aggregate:c,field:d}=u,f=s&&!o.has(d);if(ac(c)||qd(c))return Y5({field:_e(u),order:l},f);if(hj(c)||!c)return Y5({op:c,field:d,order:l},f)}else{if("descending"===r)return{op:"min",field:e.vgField(t),order:"descending"};if(Dt(["ascending",void 0],r))return!0}}(n,i,e):void 0;if(tu(s))return uo(W5([s.datum],o,a));const c=s;if("unaggregated"===t){const d=n.requestDataName(hn.Main),{field:f}=s;return uo([{data:d,field:_e({field:f,aggregate:"min"})},{data:d,field:_e({field:f,aggregate:"max"})}])}if(_n(c.bin)){if(Hi(e))return uo("bin-ordinal"===e?[]:[{data:Qv(u)?n.requestDataName(hn.Main):n.requestDataName(hn.Raw),field:n.vgField(i,f1(c,i)?{binSuffix:"range"}:{}),sort:!0!==u&&Se(u)?u:{field:n.vgField(i,{}),op:"min"}}]);{const{bin:d}=c;if(_n(d)){const f=$5(n,c.field,d);return uo([new Ms(()=>{const h=n.getSignalName(f);return`[${h}.start, ${h}.stop]`})])}return uo([{data:n.requestDataName(hn.Main),field:n.vgField(i,{})}])}}if(c.timeUnit&&Dt(["time","utc"],e)&&Rse(c,pi(n)?n.encoding[oc(i)]:void 0,n.markDef,n.config)){const d=n.requestDataName(hn.Main);return uo([{data:d,field:n.vgField(i)},{data:d,field:n.vgField(i,{suffix:"end"})}])}return uo(u?[{data:Qv(u)?n.requestDataName(hn.Main):n.requestDataName(hn.Raw),field:n.vgField(i),sort:u}]:[{data:n.requestDataName(hn.Main),field:n.vgField(i)}])}function Y5(e,t){const{op:n,field:i,order:r}=e;return Object.assign(Object.assign({op:null!=n?n:t?"sum":lx},i?{field:Uo(i)}:{}),r?{order:r}:{})}function NYe(e,t){var n;const i=e.component.scales[t],r=e.specifiedScales[t].domain,s=null===(n=e.fieldDef(t))||void 0===n?void 0:n.bin,o=dse(r)&&r,a=qh(s)&&JS(s.extent)&&s.extent;(o||a)&&i.set("selectionExtent",null!=o?o:a,!0)}function ele(e,t){const{aggregate:n,type:i}=e;return n?be(n)&&!d9e.has(n)?{valid:!1,reason:tUe(n)}:"quantitative"===i&&"log"===t?{valid:!1,reason:nUe(e)}:{valid:!0}:{valid:!1,reason:eUe(e)}}function K5(e,t,n,i){return e.explicit&&t.explicit&&ce(function aUe(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${mn(n)} and ${mn(i)}). Using the union of the two domains.`}(n,i,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function J5(e){if(lc(e)&&be(e.field))return e.field;if(function h9e(e){return!ne(e)&&"fields"in e&&!("data"in e)}(e)){let t;for(const n of e.fields)if(lc(n)&&be(n.field))if(t){if(t!==n.field)return ce("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),t}else t=n.field;return ce("Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect."),t}if(function p9e(e){return!ne(e)&&"fields"in e&&"data"in e}(e)){ce("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");const t=e.fields[0];return be(t)?t:void 0}}function $x(e,t){return function IYe(e){const t=zl(e.map(o=>lc(o)?function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(o,["sort"]):o),wt),n=zl(e.map(o=>{if(lc(o)){const a=o.sort;return void 0!==a&&!Qv(a)&&("op"in a&&"count"===a.op&&delete a.field,"ascending"===a.order&&delete a.order),a}}).filter(o=>void 0!==o),wt);if(0===t.length)return;if(1===t.length){const o=e[0];if(lc(o)&&n.length>0){let a=n[0];return n.length>1?(ce(Wre),a=!0):Se(a)&&"field"in a&&o.field===a.field&&(a=!a.order||{order:a.order}),Object.assign(Object.assign({},o),{sort:a})}return o}const i=zl(n.map(o=>Qv(o)||!("op"in o)||be(o.op)&&o.op in a9e?o:(ce(function uUe(e){return`Dropping sort property ${mn(e)} as unioned domains only support boolean or op "count", "min", and "max".`}(o)),!0)),wt);let r;1===i.length?r=i[0]:i.length>1&&(ce(Wre),r=!0);const s=zl(e.map(o=>lc(o)?o.data:null),o=>o);return Object.assign(1===s.length&&null!==s[0]?{data:s[0],fields:t.map(a=>a.field)}:{fields:t},r?{sort:r}:{})}(e.component.scales[t].get("domains").map(r=>(lc(r)&&(r.data=e.lookupDataSource(r.data)),r)))}function tle(e){return d0(e)||Z5(e)?e.children.reduce((t,n)=>t.concat(tle(n)),nle(e)):nle(e)}function nle(e){return oe(e.component.scales).reduce((t,n)=>{const i=e.component.scales[n];if(i.merged)return t;const r=i.combine(),{name:s,type:o,selectionExtent:a,reverse:c}=r,d=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(r,["name","type","selectionExtent","domains","range","reverse"]),f=function FYe(e,t,n,i){if(Zi(n)){if(Wd(e))return{step:{signal:`${t}_step`}}}else if(Se(e)&&lc(e))return Object.assign(Object.assign({},e),{data:i.lookupDataSource(e.data)});return e}(r.range,s,n,e),h=$x(e,n),p=a?function EGe(e,t,n,i){const r=vae(e,t.param,t);return{signal:lo(n.get("type"))&&ne(i)&&i[0]>i[1]?`isValid(${r}) && reverse(${r})`:r}}(e,a,i,h):null;return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:s,type:o},h?{domain:h}:{}),p?{domainRaw:p}:{}),{range:f}),void 0!==c?{reverse:c}:{}),d)),t},[])}class ile extends fc{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||$h(this.get("domains"),t=>ne(t)&&2===t.length&&t[0]<=0&&t[1]>=0)}}const PYe=["range","scheme"];function rle(e,t){const n=e.fieldDef(t);if(null==n?void 0:n.bin){const{bin:i,field:r}=n,s=Ss(t),o=e.getName(s);if(Se(i)&&i.binned&&void 0!==i.step)return new Ms(()=>{const a=e.scaleName(t),l=`(domain("${a}")[1] - domain("${a}")[0]) / ${i.step}`;return`${e.getSignalName(o)} / (${l})`});if(_n(i)){const a=$5(e,r,i);return new Ms(()=>{const l=e.getSignalName(a),u=`(${l}.stop - ${l}.start) / ${l}.step`;return`${e.getSignalName(o)} / (${u})`})}}}function jYe(e,t){const n=t.specifiedScales[e],{size:i}=t,s=t.getScaleComponent(e).get("type");for(const d of PYe)if(void 0!==n[d]){const f=Fj(s,d),h=fse(e,d);if(f)if(h)ce(h);else switch(d){case"range":{const p=n.range;if(ne(p)){if(Zi(e))return su(p.map(g=>{if("width"===g||"height"===g){const m=t.getName(g),_=t.getSignalName.bind(t);return Ms.fromName(_,m)}return g}))}else if(Se(p))return su({data:t.requestDataName(hn.Main),field:p.field,sort:{op:"min",field:t.vgField(e)}});return su(p)}case"scheme":return su(BYe(n[d]))}else ce(qre(s,d,e))}const o=e===Bn||"xOffset"===e?"width":"height",a=i[o];if(ru(a))if(Zi(e))if(Hi(s)){const d=sle(a,t,e);if(d)return su({step:d})}else ce(Gre(o));else if(zm(e)&&"band"===t.getScaleComponent(e===jd?"x":"y").get("type")){const p=ole(a,s);if(p)return su(p)}const{rangeMin:l,rangeMax:u}=n,c=function $Ye(e,t){const{size:n,config:i,mark:r,encoding:s}=t,o=t.getSignalName.bind(t),{type:a}=Ai(s[e]),u=t.getScaleComponent(e).get("type"),{domain:c,domainMid:d}=t.specifiedScales[e];switch(e){case Bn:case Vi:{if(Dt(["point","band"],u)){const p=ale(e,n,i.view);if(ru(p))return{step:sle(p,t,e)}}const f=Ss(e),h=t.getName(f);return e===Vi&&lo(u)?[Ms.fromName(o,h),0]:[0,Ms.fromName(o,h)]}case jd:case Hm:return function VYe(e,t,n){const i=e===jd?"x":"y",s=t.getScaleComponent(i).get("type"),o=t.scaleName(i);if("band"===s){const a=ale(i,t.size,t.config.view);if(ru(a)){const l=ole(a,n);if(l)return l}return[0,{signal:`bandwidth('${o}')`}]}return rre(`Cannot use ${e} scale if ${i} scale is not discrete.`)}(e,t,u);case rc:{const h=lle(r,t.component.scales[e].get("zero"),i),p=function zYe(e,t,n,i){const r={x:rle(n,"x"),y:rle(n,"y")};switch(e){case"bar":case"tick":{if(void 0!==i.scale.maxBandSize)return i.scale.maxBandSize;const s=cle(t,r,i.view);return en(s)?s-1:new Ms(()=>`${s.signal} - 1`)}case"line":case"trail":case"rule":return i.scale.maxStrokeWidth;case"text":return i.scale.maxFontSize;case"point":case"square":case"circle":{if(i.scale.maxSize)return i.scale.maxSize;const s=cle(t,r,i.view);return en(s)?Math.pow(.95*s,2):new Ms(()=>`pow(0.95 * ${s.signal}, 2)`)}}throw new Error(QS("size",e))}(r,n,t,i);return Wm(u)?function UYe(e,t,n){const i=()=>{const r=uc(t),s=uc(e),o=`(${r} - ${s}) / (${n} - 1)`;return`sequence(${s}, ${r} + ${o}, ${o})`};return Re(t)?new Ms(i):{signal:i()}}(h,p,function HYe(e,t,n,i){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return void 0!==n&&ne(n)?n.length+1:(ce(function wUe(e){return`Domain for ${e} is required for threshold scale.`}(i)),3)}}(u,i,c,e)):[h,p]}case Va:return[0,2*Math.PI];case Hh:return[0,360];case Gl:return[0,new Ms(()=>`min(${t.getSignalName("width")},${t.getSignalName("height")})/2`)];case Vd:return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case Hd:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case Es:return"symbol";case Cs:case Kl:case Jl:return"ordinal"===u?"nominal"===a?"category":"ordinal":void 0!==d?"diverging":"rect"===r||"geoshape"===r?"heatmap":"ramp";case sc:case Bd:case $d:return[i.scale.minOpacity,i.scale.maxOpacity]}}(e,t);return(void 0!==l||void 0!==u)&&Fj(s,"rangeMin")&&ne(c)&&2===c.length?su([null!=l?l:c[0],null!=u?u:c[1]]):uo(c)}function BYe(e){return function QUe(e){return!be(e)&&!!e.name}(e)?Object.assign({scheme:e.name},oo(e,["name"])):{scheme:e}}function sle(e,t,n){var i,r,s,o,a;const{encoding:l}=t,u=t.getScaleComponent(n),c=yre(n),d=l[c];if("offset"===goe({step:e,offsetIsDiscrete:Ke(d)&&sse(d.type)})&&Yse(l,c)){const h=t.getScaleComponent(c);let g=`domain('${t.scaleName(c)}').length`;"band"===h.get("type")&&(g=`bandspace(${g}, ${null!==(r=null!==(i=h.get("paddingInner"))&&void 0!==i?i:h.get("padding"))&&void 0!==r?r:0}, ${null!==(o=null!==(s=h.get("paddingOuter"))&&void 0!==s?s:h.get("padding"))&&void 0!==o?o:0})`);const m=null!==(a=u.get("paddingInner"))&&void 0!==a?a:u.get("padding");return{signal:`${e.step} * ${g} / (1-${_9e(m)})`}}return e.step}function ole(e,t){if("offset"===goe({step:e,offsetIsDiscrete:Hi(t)}))return{step:e.step}}function ale(e,t,n){const i=e===Bn?"width":"height";return t[i]||xx(n,i)}function lle(e,t,n){if(t)return Re(t)?{signal:`${t.signal} ? 0 : ${lle(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(QS("size",e))}function cle(e,t,n){const i=ru(e.width)?e.width.step:Sx(n,"width"),r=ru(e.height)?e.height.step:Sx(n,"height");return t.x||t.y?new Ms(()=>`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(", ")})`):Math.min(i,r)}function dle(e,t){pi(e)?function qYe(e,t){const n=e.component.scales,{config:i,encoding:r,markDef:s,specifiedScales:o}=e;for(const a of oe(n)){const l=o[a],u=n[a],c=e.getScaleComponent(a),d=Ai(r[a]),f=l[t],h=c.get("type"),p=c.get("padding"),g=c.get("paddingInner"),m=Fj(h,t),_=fse(a,t);if(void 0!==f&&(m?_&&ce(_):ce(qre(h,t,a))),m&&void 0===_)if(void 0!==f){const y=d.timeUnit,v=d.type;switch(t){case"domainMax":case"domainMin":Wh(l[t])||"temporal"===v||y?u.set(t,{signal:yx(l[t],{type:v,timeUnit:y})},!0):u.set(t,l[t],!0);break;default:u.copyKeyFromObject(t,l)}}else{const y=t in fle?fle[t]({model:e,channel:a,fieldOrDatumDef:d,scaleType:h,scalePadding:p,scalePaddingInner:g,domain:l.domain,domainMin:l.domainMin,domainMax:l.domainMax,markDef:s,config:i,hasNestedOffsetScale:Xj(r,a)}):i.scale[t];void 0!==y&&u.set(t,y,!1)}}}(e,t):ple(e,t)}const fle={bins:({model:e,fieldOrDatumDef:t})=>ge(t)?function GYe(e,t){const n=t.bin;if(_n(n)){const i=$5(e,t.field,n);return new Ms(()=>e.getSignalName(i))}if(es(n)&&qh(n)&&void 0!==n.step)return{step:n.step}}(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>function WYe(e,t){if(Dt([Cs,Kl,Jl],e)&&"nominal"!==t)return"hcl"}(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:i,domainMax:r,fieldOrDatumDef:s})=>function YYe(e,t,n,i,r,s){var o;if(!((null===(o=iu(s))||void 0===o?void 0:o.bin)||ne(n)||null!=r||null!=i||Dt(["time","utc"],e)))return!!Zi(t)||void 0}(e,t,n,i,r,s),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>function KYe(e,t,n,i,r,s){if(Zi(e)){if(Ua(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:o,orient:a}=r;if("bar"===o&&(!ge(i)||!i.bin&&!i.timeUnit)&&("vertical"===a&&"x"===e||"horizontal"===a&&"y"===e))return s.continuousBandSize}if("point"===t)return n.pointPadding}}(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:i,config:r,hasNestedOffsetScale:s})=>function JYe(e,t,n,i,r,s=!1){if(void 0===e){if(Zi(t)){const{bandPaddingInner:o,barBandPaddingInner:a,rectBandPaddingInner:l,bandWithNestedOffsetPaddingInner:u}=r;return s?u:hi(o,"bar"===n?a:l)}if(zm(t)&&"band"===i)return r.offsetBandPaddingInner}}(e,t,n.type,i,r.scale,s),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:i,config:r,hasNestedOffsetScale:s})=>function XYe(e,t,n,i,r,s=!1){if(void 0===e)if(Zi(t)){const{bandPaddingOuter:o,bandWithNestedOffsetPaddingOuter:a}=r;if(s)return a;if("band"===n)return hi(o,Re(i)?{signal:`${i.signal}/2`}:i/2)}else if(zm(t)){if("point"===n)return.5;if("band"===n)return r.offsetBandPaddingOuter}}(e,t,n,i,r.scale,s),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>function QYe(e,t,n,i){return"x"===n&&void 0!==i.xReverse?lo(e)&&"descending"===t?Re(i.xReverse)?{signal:`!${i.xReverse.signal}`}:!i.xReverse:i.xReverse:!(!lo(e)||"descending"!==t)||void 0}(t,ge(e)?e.sort:void 0,n,i.scale),zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:i,scaleType:r})=>function ZYe(e,t,n,i,r){if(n&&"unaggregated"!==n&&lo(r)){if(ne(n)){const a=n[n.length-1];if(n[0]<=0&&a>=0)return!0}return!1}if("size"===e&&"quantitative"===t.type&&!Wm(r))return!0;if((!ge(t)||!t.bin)&&Dt([...Xl,...ZHe],e)){const{orient:o,type:a}=i;return!(Dt(["bar","area","line","trail"],a)&&("horizontal"===o&&"y"===e||"vertical"===o&&"x"===e))}return!1}(e,t,n,i,r)};function hle(e){pi(e)?function LYe(e){const t=e.component.scales;for(const n of KS){const i=t[n];if(!i)continue;const r=jYe(n,e);i.setWithExplicit("range",r)}}(e):ple(e,"range")}function ple(e,t){const n=e.component.scales;for(const i of e.children)"range"===t?hle(i):dle(i,t);for(const i of oe(n)){let r;for(const s of e.children){const o=s.component.scales[i];o&&(r=Qd(r,o.getWithExplicit(t),t,"scale",Hoe((l,u)=>"range"===t&&l.step&&u.step?l.step-u.step:0)))}n[i].setWithExplicit(t,r)}}function eKe(e,t,n,i,r=!1){const s=function tKe(e,t,n,i){var r;switch(t.type){case"nominal":case"ordinal":if(Um(e)||"discrete"===fj(e))return"shape"===e&&"ordinal"===t.type&&ce(vj(e,"ordinal")),"ordinal";if(Zi(e)||zm(e)){if(Dt(["rect","bar","image","rule"],n.type)||i)return"band"}else if("arc"===n.type&&e in uj)return"band";return Ym(n[Ss(e)])||Wj(t)&&(null===(r=t.axis)||void 0===r?void 0:r.tickBand)?"band":"point";case"temporal":return Um(e)?"time":"discrete"===fj(e)?(ce(vj(e,"temporal")),"ordinal"):ge(t)&&t.timeUnit&&ts(t.timeUnit).utc?"utc":"time";case"quantitative":return Um(e)?ge(t)&&_n(t.bin)?"bin-ordinal":"linear":"discrete"===fj(e)?(ce(vj(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(Ure(t.type))}(t,n,i,r),{type:o}=e;return zd(t)?void 0!==o?function rze(e,t,n=!1){if(!zd(e))return!1;switch(e){case Bn:case Vi:case jd:case Hm:case Va:case Gl:return!(!Ua(t)&&"band"!==t)||"point"===t&&!n;case rc:case Vd:case sc:case Bd:case $d:case Hh:return Ua(t)||Wm(t)||Dt(["band","point","ordinal"],t);case Cs:case Kl:case Jl:return"band"!==t;case Hd:case Es:return"ordinal"===t||Wm(t)}}(t,o)?ge(n)&&!function ize(e,t){return Dt([kj,Ij],t)?void 0===e||Hi(e):t===qm?Dt(["time","utc",void 0],e):t!==Kh||use(e)||Wm(e)||void 0===e}(o,n.type)?(ce(function sUe(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}(o,s)),s):o:(ce(function rUe(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}(t,o,s)),s):s:null}function gle(e){e.component.scales=pi(e)?function iKe(e){const{encoding:t,mark:n,markDef:i}=e,r={};for(const s of KS){const o=Ai(t[s]);if(o&&n===gse&&s===Es&&o.type===Gm)continue;let a=o&&o.scale;if(!zm(s)||Xj(t,vre(s))){if(o&&null!==a&&!1!==a){null!=a||(a={});const u=eKe(a,s,o,i,Xj(t,s));r[s]=new ile(e.scaleName(`${s}`,!0),{value:u,explicit:a.type===u})}}else a&&ce(z9e(s))}return r}(e):function sKe(e){var t,n;const i=e.component.scales={},r={},s=e.component.resolve;for(const o of e.children){gle(o);for(const a of oe(o.component.scales))if(null!==(t=(n=s.scale)[a])&&void 0!==t||(n[a]=Iae(a,e)),"shared"===s.scale[a]){const l=r[a],u=o.component.scales[a].getWithExplicit("type");l?WUe(l.value,u.value)?r[a]=Qd(l,u,"type","scale",rKe):(s.scale[a]="independent",delete r[a]):r[a]=u}}for(const o of oe(r)){const a=e.scaleName(o,!0);i[o]=new ile(a,r[o]);for(const u of e.children){const c=u.component.scales[o];c&&(u.renameScale(c.get("name"),a),c.merged=!0)}}return i}(e)}const rKe=Hoe((e,t)=>ose(e)-ose(t));var X5=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};class Q5{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return void 0!==this.nameMap[t]}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function pi(e){return"unit"===(null==e?void 0:e.type)}function Ya(e){return"facet"===(null==e?void 0:e.type)}function Z5(e){return"concat"===(null==e?void 0:e.type)}function d0(e){return"layer"===(null==e?void 0:e.type)}class eB{constructor(t,n,i,r,s,o,a){var l,u;this.type=n,this.parent=i,this.config=s,this.correctDataNames=c=>{var d,f,h;return(null===(d=c.from)||void 0===d?void 0:d.data)&&(c.from.data=this.lookupDataSource(c.from.data)),(null===(h=null===(f=c.from)||void 0===f?void 0:f.facet)||void 0===h?void 0:h.data)&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c},this.parent=i,this.config=s,this.view=xs(a),this.name=null!==(l=t.name)&&void 0!==l?l:r,this.title=Gd(t.title)?{text:t.title}:t.title?xs(t.title):void 0,this.scaleNameMap=i?i.scaleNameMap:new Q5,this.projectionNameMap=i?i.projectionNameMap:new Q5,this.signalNameMap=i?i.signalNameMap:new Q5,this.data=t.data,this.description=t.description,this.transforms=function aGe(e){return e.map(t=>_5(t)?{filter:Bm(t.filter,UUe)}:t)}(null!==(u=t.transform)&&void 0!==u?u:[]),this.layout="layer"===n||"unit"===n?{}:function hqe(e,t,n){var i,r;const s=n[t],o={},{spacing:a,columns:l}=s;void 0!==a&&(o.spacing=a),void 0!==l&&(ux(e)&&!c1(e.facet)||c5(e))&&(o.columns=l),Ex(e)&&(o.columns=1);for(const u of fqe)if(void 0!==e[u])if("spacing"===u){const c=e[u];o[u]=en(c)?c:{row:null!==(i=c.row)&&void 0!==i?i:a,column:null!==(r=c.column)&&void 0!==r?r:a}}else o[u]=e[u];return o}(t,n,s),this.component={data:{sources:i?i.component.data.sources:[],outputNodes:i?i.component.data.outputNodes:{},outputNodeRefCounts:i?i.component.data.outputNodeRefCounts:{},isFaceted:ux(t)||(null==i?void 0:i.component.data.isFaceted)&&void 0===t.data},layoutSize:new fc,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?nt(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){!function nKe(e,{ignoreRange:t}={}){gle(e),Zae(e);for(const n of nze)dle(e,n);t||hle(e)}(this)}parseProjection(){Gae(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){Vae(this)}assembleEncodeFromView(t){const i=X5(t,["style"]),r={};for(const s of oe(i)){const o=i[s];void 0!==o&&(r[s]=Cn(o))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),t||(this.description&&(n.description=Cn(this.description)),"unit"!==this.type&&"layer"!==this.type)?nn(n)?void 0:n:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},null!=n?n:{})}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,i=X5(t,["spacing"]),{component:r,config:s}=this,o=function DWe(e,t){const n={};for(const i of qo){const r=e[i];if(null==r?void 0:r.facetFieldDef){const{titleAnchor:s,titleOrient:o}=Lx(["titleAnchor","titleOrient"],r.facetFieldDef.header,t,i),a=Px(i,o),l=wWe(s,a);void 0!==l&&(n[a]=l)}}return nn(n)?void 0:n}(r.layoutHeaders,s);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),i),o?{titleBand:o}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const i of qo)t[i].title&&n.push(mWe(this,i));for(const i of R5)n=n.concat(_We(this,i));return n}assembleAxes(){return function rWe(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(r=>v1(r,"grid",t)),...i.map(r=>v1(r,"grid",t)),...n.map(r=>v1(r,"main",t)),...i.map(r=>v1(r,"main",t))].filter(r=>r)}(this.component.axes,this.config)}assembleLegends(){return Uae(this)}assembleProjections(){return function GWe(e){return d0(e)||Z5(e)?function WWe(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),zae(e))}(e):zae(e)}(this)}assembleTitle(){var t,n,i;const r=null!==(t=this.title)&&void 0!==t?t:{},{encoding:s}=r,o=X5(r,["encoding"]),a=Object.assign(Object.assign(Object.assign({},Sre(this.config.title).nonMarkTitleProperties),o),s?{encode:{update:s}}:{});if(a.text)return Dt(["unit","layer"],this.type)?Dt(["middle",void 0],a.anchor)&&(null!==(n=a.frame)&&void 0!==n||(a.frame="group")):null!==(i=a.anchor)&&void 0!==i||(a.anchor="start"),nn(a)?void 0:a}assembleGroup(t=[]){const n={};(t=t.concat(this.assembleSignals())).length>0&&(n.signals=t);const i=this.assembleLayout();i&&(n.layout=i),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||Ya(this.parent)?tle(this):[];r.length>0&&(n.scales=r);const s=this.assembleAxes();s.length>0&&(n.axes=s);const o=this.assembleLegends();return o.length>0&&(n.legends=o),n}getName(t){return Fn((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(hn[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),i=this.component.data.outputNodeRefCounts;return i[n]=(i[n]||0)+1,n}getSizeSignalRef(t){if(Ya(this.parent)){const i=YS(Nae(t)),r=this.component.scales[i];if(r&&!r.merged){const s=r.get("type"),o=r.get("range");if(Hi(s)&&Wd(o)){const a=r.get("name"),u=J5($x(this,i));return u?{signal:Oae(a,r,_e({aggregate:"distinct",field:u},{expr:"datum"}))}:(ce(_j(i)),null)}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){return n?this.getName(t):mre(t)&&zd(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t))?this.scaleNameMap.get(this.getName(t)):void 0}projectionName(t){return t?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let i=this.component.selection[t];if(!i&&this.parent&&(i=this.parent.getSelectionComponent(t,n)),!i)throw new Error(function D9e(e){return`Cannot find a selection named "${e}".`}(n));return i}hasAxisOrientSignalRef(){var t,n;return(null===(t=this.component.axes.x)||void 0===t?void 0:t.some(i=>i.hasOrientSignalRef()))||(null===(n=this.component.axes.y)||void 0===n?void 0:n.some(i=>i.hasOrientSignalRef()))}}class mle extends eB{vgField(t,n={}){const i=this.fieldDef(t);if(i)return _e(i,n)}reduceFieldDef(t,n){return function zze(e,t,n,i){return e?oe(e).reduce((r,s)=>{const o=e[s];return ne(o)?o.reduce((a,l)=>t.call(i,a,l,s),r):t.call(i,r,o,s)},n):n}(this.getMapping(),(i,r,s)=>{const o=iu(r);return o?t(i,o,s):i},n)}forEachFieldDef(t,n){Zj(this.getMapping(),(i,r)=>{const s=iu(i);s&&t(s,r)},n)}}class Vx extends rn{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=nt(n);const o=null!==(i=this.transform.as)&&void 0!==i?i:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"value",null!==(s=o[1])&&void 0!==s?s:"density"]}clone(){return new Vx(null,nt(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${wt(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,i=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["density"]);return Object.assign({type:"kde",field:n},i)}}class C1 extends rn{constructor(t,n){super(t),this.filter=n}clone(){return new C1(null,Object.assign({},this.filter))}static make(t,n){const{config:i,mark:r,markDef:s}=n;if("filter"!==Wt("invalid",s,i))return null;const a=n.reduceFieldDef((l,u,c)=>{const d=zd(c)&&n.getScaleComponent(c);return d&&lo(d.get("type"))&&"count"!==u.aggregate&&!Kd(r)&&(l[u.field]=u),l},{});return oe(a).length?new C1(t,a):null}dependentFields(){return new Set(oe(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${wt(this.filter)}`}assemble(){const t=oe(this.filter).reduce((n,i)=>{const r=this.filter[i],s=_e(r,{expr:"datum"});return null!==r&&("temporal"===r.type?n.push(`(isDate(${s}) || (isValid(${s}) && isFinite(+${s})))`):"quantitative"===r.type&&(n.push(`isValid(${s})`),n.push(`isFinite(+${s})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class Hx extends rn{constructor(t,n){super(t),this.transform=n,this.transform=nt(n);const{flatten:i,as:r=[]}=this.transform;this.transform.as=i.map((s,o)=>{var a;return null!==(a=r[o])&&void 0!==a?a:s})}clone(){return new Hx(this.parent,nt(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${wt(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class Ux extends rn{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=nt(n);const o=null!==(i=this.transform.as)&&void 0!==i?i:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"key",null!==(s=o[1])&&void 0!==s?s:"value"]}clone(){return new Ux(null,nt(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${wt(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class f0 extends rn{constructor(t,n,i,r){super(t),this.fields=n,this.geojson=i,this.signal=r}clone(){return new f0(null,nt(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let i=0;for(const r of[[Yl,Wl],[zo,Ha]]){const s=r.map(o=>{const a=Ai(n.encoding[o]);return ge(a)?a.field:tu(a)?{expr:`${a.datum}`}:qa(a)?{expr:`${a.value}`}:void 0});(s[0]||s[1])&&(t=new f0(t,s,null,n.getName("geojson_"+i++)))}if(n.channelHasField(Es)){const r=n.typedFieldDef(Es);r.type===Gm&&(t=new f0(t,null,r.field,n.getName("geojson_"+i++)))}return t}dependentFields(){var t;const n=(null!==(t=this.fields)&&void 0!==t?t:[]).filter(be);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${wt(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})]}}class E1 extends rn{constructor(t,n,i,r){super(t),this.projection=n,this.fields=i,this.as=r}clone(){return new E1(null,this.projection,nt(this.fields),nt(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const i of[[Yl,Wl],[zo,Ha]]){const r=i.map(o=>{const a=Ai(n.encoding[o]);return ge(a)?a.field:tu(a)?{expr:`${a.datum}`}:qa(a)?{expr:`${a.value}`}:void 0}),s=i[0]===zo?"2":"";(r[0]||r[1])&&(t=new E1(t,n.projectionName(),r,[n.getName(`x${s}`),n.getName(`y${s}`)]))}return t}dependentFields(){return new Set(this.fields.filter(be))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${wt(this.fields)} ${wt(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class rp extends rn{constructor(t,n){super(t),this.transform=n}clone(){return new rp(null,nt(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:i,step:r}=t;return{signal:`sequence(${[n,i,...r?[r]:[]].join(",")})`}}static makeFromTransform(t,n){return new rp(t,n)}static makeFromEncoding(t,n){const i=n.encoding,r=i.x,s=i.y;if(ge(r)&&ge(s)){const o=r.impute?r:s.impute?s:void 0;if(void 0===o)return;const a=r.impute?s:s.impute?r:void 0,{method:l,value:u,frame:c,keyvals:d}=o.impute,f=Jse(n.mark,i);return new rp(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:a.field},l?{method:l}:{}),void 0!==u?{value:u}:{}),c?{frame:c}:{}),void 0!==d?{keyvals:d}:{}),f.length?{groupby:f}:{}))}return null}hash(){return`Impute ${wt(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:i,method:r,groupby:s,value:o,frame:a=[null,null]}=this.transform,l=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},i?{keyvals:Uqe(i)?this.processSequence(i):i}:{}),{method:"value"}),s?{groupby:s}:{}),{value:r&&"value"!==r?null:o});return r&&"value"!==r?[l,Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[r],fields:[t],frame:a,ignorePeers:!1},s?{groupby:s}:{}),{type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t}]:[l]}}class zx extends rn{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=nt(n);const o=null!==(i=this.transform.as)&&void 0!==i?i:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:n.on,null!==(s=o[1])&&void 0!==s?s:n.loess]}clone(){return new zx(null,nt(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${wt(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:i}=t,r=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["loess","on"]);return Object.assign({type:"loess",x:i,y:n},r)}}class S1 extends rn{constructor(t,n,i){super(t),this.transform=n,this.secondary=i}clone(){return new S1(null,nt(this.transform),this.secondary)}static make(t,n,i,r){const s=n.component.data.sources,{from:o}=i;let a=null;if(function zqe(e){return"data"in e}(o)){let l=ble(o.data,s);l||(l=new tp(o.data),s.push(l));const u=n.getName(`lookup_${r}`);a=new ns(l,u,hn.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[u]=a}else if(function qqe(e){return"param"in e}(o)){const l=o.param;let u;i=Object.assign({as:l},i);try{u=n.getSelectionComponent(Fn(l),l)}catch(c){throw new Error(function S9e(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}(l))}if(a=u.materialized,!a)throw new Error(function x9e(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}(l))}return new S1(t,i,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?we(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${wt({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:we(this.transform.as)}:{});else{let n=this.transform.as;be(n)||(ce('If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.'),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}class qx extends rn{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=nt(n);const o=null!==(i=this.transform.as)&&void 0!==i?i:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"prob",null!==(s=o[1])&&void 0!==s?s:"value"]}clone(){return new qx(null,nt(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${wt(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,i=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["quantile"]);return Object.assign({type:"quantile",field:n},i)}}class Gx extends rn{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=nt(n);const o=null!==(i=this.transform.as)&&void 0!==i?i:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:n.on,null!==(s=o[1])&&void 0!==s?s:n.regression]}clone(){return new Gx(null,nt(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${wt(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:i}=t,r=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["regression","on"]);return Object.assign({type:"regression",x:i,y:n},r)}}class Wx extends rn{constructor(t,n){super(t),this.transform=n}clone(){return new Wx(null,nt(this.transform))}addDimensions(t){var n;this.transform.groupby=zl((null!==(n=this.transform.groupby)&&void 0!==n?n:[]).concat(t),i=>i)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}hash(){return`PivotTransform ${wt(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:i,limit:r,op:s}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},void 0!==r?{limit:r}:{}),void 0!==s?{op:s}:{}),void 0!==i?{groupby:i}:{})}}class Yx extends rn{constructor(t,n){super(t),this.transform=n}clone(){return new Yx(null,nt(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${wt(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function _le(e){let t=0;return function n(i,r){var s;if(i instanceof tp&&!i.isGenerator&&!Zm(i.data)&&(e.push(r),r={name:null,source:r.name,transform:[]}),i instanceof Ar&&(i.parent instanceof tp&&!r.source?(r.format=Object.assign(Object.assign({},null!==(s=r.format)&&void 0!==s?s:{}),{parse:i.assembleFormatParse()}),r.transform.push(...i.assembleTransforms(!0))):r.transform.push(...i.assembleTransforms())),i instanceof u0)return r.name||(r.name="data_"+t++),!r.source||r.transform.length>0?(e.push(r),i.data=r.name):i.data=r.source,void e.push(...i.assemble());switch((i instanceof b1||i instanceof w1||i instanceof C1||i instanceof s0||i instanceof o0||i instanceof E1||i instanceof Ga||i instanceof S1||i instanceof c0||i instanceof ip||i instanceof Ux||i instanceof Hx||i instanceof Vx||i instanceof zx||i instanceof qx||i instanceof Gx||i instanceof rf||i instanceof Yx||i instanceof Wx)&&r.transform.push(i.assemble()),(i instanceof au||i instanceof ou||i instanceof rp||i instanceof hc||i instanceof f0)&&r.transform.push(...i.assemble()),i instanceof ns&&(r.source&&0===r.transform.length?i.setSource(r.source):i.parent instanceof ns?i.setSource(r.name):(r.name||(r.name="data_"+t++),i.setSource(r.name),1===i.numChildren()&&(e.push(r),r={name:null,source:r.name,transform:[]}))),i.numChildren()){case 0:i instanceof ns&&(!r.source||r.transform.length>0)&&e.push(r);break;case 1:n(i.children[0],r);break;default:{r.name||(r.name="data_"+t++);let o=r.name;!r.source||r.transform.length>0?e.push(r):o=r.source;for(const a of i.children)n(a,{name:null,source:o,transform:[]});break}}}}function fKe(e){return"top"===e||"left"===e||Re(e)?"header":"footer"}function pKe(e,t){var n;const{facet:i,config:r,child:s,component:o}=e;if(e.channelHasField(t)){const a=i[t],l=l0("title",null,r,t);let u=Km(a,r,{allowDisabling:!0,includeDefault:void 0===l||!!l});s.component.layoutHeaders[t].title&&(u=ne(u)?u.join(", "):u,u+=` / ${s.component.layoutHeaders[t].title}`,s.component.layoutHeaders[t].title=null);const c=l0("labelOrient",a.header,r,t),d=null!==a.header&&hi(null===(n=a.header)||void 0===n?void 0:n.labels,r.header.labels,!0),f=Dt(["bottom","right"],c)?"footer":"header";o.layoutHeaders[t]={title:null!==a.header?u:null,facetFieldDef:a,[f]:"facet"===t?[]:[yle(e,t,d)]}}}function yle(e,t,n){const i="row"===t?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function vle(e,t){var n;const{child:i}=e;if(i.component.axes[t]){const{layoutHeaders:r,resolve:s}=e.component;if(s.axis[t]=j5(s,t),"shared"===s.axis[t]){const o="x"===t?"column":"row",a=r[o];for(const l of i.component.axes[t]){const u=fKe(l.get("orient"));null!==(n=a[u])&&void 0!==n||(a[u]=[yle(e,o,!1)]);const c=v1(l,"main",e.config,{header:!0});c&&a[u][0].axes.push(c),l.mainExtracted=!0}}}}function tB(e){for(const t of e.children)t.parseLayoutSize()}function Kx(e,t){var n;const i=Nae(t),r=YS(i),s=e.component.resolve,o=e.component.layoutSize;let a;for(const l of e.children){const u=l.component.layoutSize.getWithExplicit(i),c=null!==(n=s.scale[r])&&void 0!==n?n:Iae(r,e);if("independent"===c&&"step"===u.value){a=void 0;break}if(a){if("independent"===c&&a.value!==u.value){a=void 0;break}a=Qd(a,u,i,"")}else a=u}if(a){for(const l of e.children)e.renameSignal(l.getName(i),e.getName(t)),l.component.layoutSize.set(i,"merged",!1);o.setWithExplicit(t,a)}else o.setWithExplicit(t,{explicit:!1,value:void 0})}function yKe(e,t){const i=e.config,r=e.getScaleComponent("width"===t?"x":"y");if(r){const s=r.get("type"),o=r.get("range");if(Hi(s)){const a=xx(i.view,t);return Wd(o)||ru(a)?"step":a}return f5(i.view,t)}if(e.hasProjection||"arc"===e.mark)return f5(i.view,t);{const s=xx(i.view,t);return ru(s)?s.step:s}}function nB(e,t,n){return _e(t,Object.assign({suffix:`by_${_e(e)}`},null!=n?n:{}))}class x1 extends mle{constructor(t,n,i,r){super(t,"facet",n,i,r,t.resolve),this.child=aB(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!c1(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=oe(t),i={};for(const r of n){if(![ec,tc].includes(r)){ce(QS(r,"facet"));break}const s=t[r];if(void 0===s.field){ce(yj(s,r));break}i[r]=this.initFacetFieldDef(s,r)}return i}initFacetFieldDef(t,n){const i=Jj(t,n);return i.header?i.header=xs(i.header):null===i.header&&(i.header=null),i}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=Jx(this),this.child.parseData()}parseLayoutSize(){tB(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function hKe(e){for(const t of qo)pKe(e,t);vle(e,"x"),vle(e,"y")}(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,i;const r={};for(const s of qo)for(const o of F5){const a=this.component.layoutHeaders[s],l=a[o],{facetFieldDef:u}=a;if(u){const c=l0("titleOrient",u.header,this.config,s);if(["right","bottom"].includes(c)){const d=Px(s,c);null!==(t=r.titleAnchor)&&void 0!==t||(r.titleAnchor={}),r.titleAnchor[d]="end"}}if(null==l?void 0:l[0]){const c="row"===s?"height":"width",d="header"===o?"headerBand":"footerBand";"facet"!==s&&!this.child.component.layoutSize.get(c)&&(null!==(n=r[d])&&void 0!==n||(r[d]={}),r[d][s]=.5),a.title&&(null!==(i=r.offset)&&void 0!==i||(r.offset={}),r.offset["row"===s?"rowTitle":"columnTitle"]=10)}}return r}assembleDefaultLayout(){const{column:t,row:n}=this.facet,i=t?this.columnDistinctSignal():n?1:void 0;let r="all";return(!n&&"independent"===this.component.resolve.scale.x||!t&&"independent"===this.component.resolve.scale.y)&&(r="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),i?{columns:i}:{}),{bounds:"full",align:r})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof x1))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof x1?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:_e(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],i=[];if(this.child instanceof x1){if(this.child.channelHasField("column")){const r=_e(this.child.facet.column);t.push(r),n.push("distinct"),i.push(`distinct_${r}`)}}else for(const r of Xl){const s=this.child.component.scales[r];if(s&&!s.merged){const o=s.get("type"),a=s.get("range");if(Hi(o)&&Wd(a)){const u=J5($x(this.child,r));u?(t.push(u),n.push("distinct"),i.push(`distinct_${u}`)):ce(_j(r))}}}return{fields:t,ops:n,as:i}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:i,column:r}=this.facet,{fields:s,ops:o,as:a}=this.getCardinalityAggregateForChild(),l=[];for(const c of qo){const d=this.facet[c];if(d){l.push(_e(d));const{bin:f,sort:h}=d;if(_n(f)&&l.push(_e(d,{binSuffix:"end"})),eu(h)){const{field:p,op:g=lx}=h,m=nB(d,h);i&&r?(s.push(m),o.push("max"),a.push(m)):(s.push(p),o.push(g),a.push(m))}else if(ne(h)){const p=a0(d,c);s.push(p),o.push("max"),a.push(p)}}}const u=!!i&&!!r;return Object.assign({name:t,data:n,groupby:l},u||s.length>0?{aggregate:Object.assign(Object.assign({},u?{cross:u}:{}),s.length?{fields:s,ops:o,as:a}:{})}:{})}facetSortFields(t){const{facet:n}=this,i=n[t];return i?eu(i.sort)?[nB(i,i.sort,{expr:"datum"})]:ne(i.sort)?[a0(i,t,{expr:"datum"})]:[_e(i,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,i=n[t];if(i){const{sort:r}=i;return[(eu(r)?r.order:!ne(r)&&r)||"ascending"]}return[]}assembleLabelTitle(){var t;const{facet:n,config:i}=this;if(n.facet)return P5(n.facet,"facet",i);const r={row:["top","bottom"],column:["left","right"]};for(const s of R5)if(n[s]){const o=l0("labelOrient",null===(t=n[s])||void 0===t?void 0:t.header,i,s);if(r[s].includes(o))return P5(n[s],s,i)}}assembleMarks(){const{child:t}=this,i=function cKe(e){const t=[],n=_le(t);for(const i of e.children)n(i,{source:e.name,name:null,transform:[]});return t}(this.component.data.facetRoot),r=t.assembleGroupEncodeEntry(!1),s=this.assembleLabelTitle()||t.assembleTitle(),o=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},s?{title:s}:{}),o?{style:o}:{}),{from:{facet:this.assembleFacet()},sort:{field:qo.map(l=>this.facetSortFields(l)).flat(),order:qo.map(l=>this.facetSortOrder(l)).flat()}}),i.length>0?{data:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup(bGe(this,[])))]}getMapping(){return this.facet}}function ble(e,t){var n,i,r,s;for(const o of t){const a=o.data;if(e.name&&o.hasName()&&e.name!==o.dataName)continue;const l=null===(n=e.format)||void 0===n?void 0:n.mesh,u=null===(i=a.format)||void 0===i?void 0:i.feature;if(l&&u)continue;const c=null===(r=e.format)||void 0===r?void 0:r.feature;if((c||u)&&c!==u)continue;const d=null===(s=a.format)||void 0===s?void 0:s.mesh;if(!l&&!d||l===d)if(g1(e)&&g1(a)){if(Ul(e.values,a.values))return o}else if(Zm(e)&&Zm(a)){if(e.url===a.url)return o}else if(Uoe(e)&&e.name===o.dataName)return o}return null}function Jx(e){var t,n,i,r,s,o,a,l,u,c;let d=function bKe(e,t){if(e.data||!e.parent){if(null===e.data){const i=new tp({values:[]});return t.push(i),i}const n=ble(e.data,t);if(n)return Zd(e.data)||(n.data.format=sre({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const i=new tp(e.data);return t.push(i),i}}return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}(e,e.component.data.sources);const{outputNodes:f,outputNodeRefCounts:h}=e.component.data,p=e.data,m=p&&(Zd(p)||Zm(p)||g1(p))||!e.parent?new _Ge:e.parent.component.data.ancestorParse.clone();Zd(p)?(zoe(p)?d=new w1(d,p.sequence):b5(p)&&(d=new b1(d,p.graticule)),m.parseNothing=!0):null===(null===(t=null==p?void 0:p.format)||void 0===t?void 0:t.parse)&&(m.parseNothing=!0),d=null!==(n=Ar.makeExplicit(d,e,m))&&void 0!==n?n:d,d=new rf(d);const _=e.parent&&d0(e.parent);(pi(e)||Ya(e))&&_&&(d=null!==(i=au.makeFromEncoding(d,e))&&void 0!==i?i:d),e.transforms.length>0&&(d=function wKe(e,t,n){var i,r;let s=0;for(const o of t.transforms){let a,l;if(tGe(o))l=e=new o0(e,o),a="derived";else if(_5(o)){const u=oYe(o);l=e=null!==(i=Ar.makeWithAncestors(e,{},u,n))&&void 0!==i?i:e,e=new s0(e,t,o.filter)}else if(Roe(o))l=e=au.makeFromTransform(e,o,t),a="number";else if(iGe(o))a="date",void 0===n.getWithExplicit(o.field).value&&(e=new Ar(e,{[o.field]:a}),n.set(o.field,a,!1)),l=e=ou.makeFromTransform(e,o);else if(rGe(o))l=e=Ga.makeFromTransform(e,o),a="number",T5(t)&&(e=new rf(e));else if(Ioe(o))l=e=S1.make(e,t,o,s++),a="derived";else if(Qqe(o))l=e=new c0(e,o),a="number";else if(Zqe(o))l=e=new ip(e,o),a="number";else if(sGe(o))l=e=hc.makeFromTransform(e,o),a="derived";else if(oGe(o))l=e=new Ux(e,o),a="derived";else if(eGe(o))l=e=new Hx(e,o),a="derived";else if(Gqe(o))l=e=new Wx(e,o),a="derived";else if(Xqe(o))e=new Yx(e,o);else if(nGe(o))l=e=rp.makeFromTransform(e,o),a="derived";else if(Wqe(o))l=e=new Vx(e,o),a="derived";else if(Yqe(o))l=e=new qx(e,o),a="derived";else if(Kqe(o))l=e=new Gx(e,o),a="derived";else{if(!Jqe(o)){ce(I9e(o));continue}l=e=new zx(e,o),a="derived"}if(l&&void 0!==a)for(const u of null!==(r=l.producedFields())&&void 0!==r?r:[])n.set(u,a,!1)}return e}(d,e,m));const y=function lYe(e){const t={};if(pi(e)&&e.component.selection)for(const n of oe(e.component.selection)){const i=e.component.selection[n];for(const r of i.project.items)!r.channel&&Vm(r.field)>1&&(t[r.field]="flatten")}return t}(e),v=function aYe(e){const t={};function n(i){Xm(i)?t[i.field]="date":"quantitative"===i.type&&function u9e(e){return be(e)&&Dt(["min","max"],e)}(i.aggregate)?t[i.field]="number":Vm(i.field)>1?i.field in t||(t[i.field]="flatten"):Qh(i)&&eu(i.sort)&&Vm(i.sort.field)>1&&(i.sort.field in t||(t[i.sort.field]="flatten"))}if((pi(e)||Ya(e))&&e.forEachFieldDef((i,r)=>{if(Go(i))n(i);else{const s=zh(r),o=e.fieldDef(s);n(Object.assign(Object.assign({},i),{type:o.type}))}}),pi(e)){const{mark:i,markDef:r,encoding:s}=e;if(Kd(i)&&!e.encoding.order){const a=s["horizontal"===r.orient?"y":"x"];ge(a)&&"quantitative"===a.type&&!(a.field in t)&&(t[a.field]="number")}}return t}(e);d=null!==(r=Ar.makeWithAncestors(d,{},Object.assign(Object.assign({},y),v),m))&&void 0!==r?r:d,pi(e)&&(d=f0.parseAll(d,e),d=E1.parseAll(d,e)),(pi(e)||Ya(e))&&(_||(d=null!==(s=au.makeFromEncoding(d,e))&&void 0!==s?s:d),d=null!==(o=ou.makeFromEncoding(d,e))&&void 0!==o?o:d,d=o0.parseAllForSortIndex(d,e));const b=e.getDataName(hn.Raw),D=new ns(d,b,hn.Raw,h);if(f[b]=D,d=D,pi(e)){const T=Ga.makeFromEncoding(d,e);T&&(d=T,T5(e)&&(d=new rf(d))),d=null!==(a=rp.makeFromEncoding(d,e))&&void 0!==a?a:d,d=null!==(l=hc.makeFromEncoding(d,e))&&void 0!==l?l:d}pi(e)&&(d=null!==(u=C1.make(d,e))&&void 0!==u?u:d);const C=e.getDataName(hn.Main),w=new ns(d,C,hn.Main,h);f[C]=w,d=w,pi(e)&&function nWe(e,t){var n;for(const[i,r]of Ld(null!==(n=e.component.selection)&&void 0!==n?n:{})){const s=e.getName(`lookup_${i}`);e.component.data.outputNodes[s]=r.materialized=new ns(new s0(t,e,{param:i}),s,hn.Lookup,e.component.data.outputNodeRefCounts)}}(e,w);let E=null;if(Ya(e)){const T=e.getName("facet");d=null!==(c=function vKe(e,t){const{row:n,column:i}=t;if(n&&i){let r=null;for(const s of[n,i])if(eu(s.sort)){const{field:o,op:a=lx}=s.sort;e=r=new ip(e,{joinaggregate:[{op:a,field:o,as:nB(s,s.sort,{forAs:!0})}],groupby:[_e(s)]})}return r}return null}(d,e.facet))&&void 0!==c?c:d,E=new u0(d,e,T,w.getSource()),f[T]=E}return Object.assign(Object.assign({},e.component.data),{outputNodes:f,outputNodeRefCounts:h,raw:D,main:w,facetRoot:E,ancestorParse:m})}class DKe extends eB{constructor(t,n,i,r){var s,o,a,l;super(t,"concat",n,i,r,t.resolve),("shared"===(null===(o=null===(s=t.resolve)||void 0===s?void 0:s.axis)||void 0===o?void 0:o.x)||"shared"===(null===(l=null===(a=t.resolve)||void 0===a?void 0:a.axis)||void 0===l?void 0:l.y))&&ce("Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415)."),this.children=this.getChildren(t).map((u,c)=>aB(u,this,this.getName(`concat_${c}`),void 0,r))}parseData(){this.component.data=Jx(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of oe(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return Ex(t)?t.vconcat:d5(t)?t.hconcat:t.concat}parseLayoutSize(){!function mKe(e){tB(e);const n=void 0===e.layout.columns?"height":"childHeight";Kx(e,1===e.layout.columns?"width":"childWidth"),Kx(e,n)}(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=L5(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),i=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),i?{style:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup())})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},null!=t?{columns:t}:{}),{bounds:"full",align:"each"})}}const EKe=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},zse),{labelExpr:1,encode:1}),wle=oe(EKe);class iB extends fc{constructor(t={},n={},i=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=i}clone(){return new iB(nt(this.explicit),nt(this.implicit),this.mainExtracted)}hasAxisPart(t){return"axis"===t||("grid"===t||"title"===t?!!this.get(t):!function CKe(e){return!1===e||null===e}(this.get(t)))}hasOrientSignalRef(){return Re(this.explicit.orient)}}const AKe={bottom:"top",top:"bottom",left:"right",right:"left"};function TKe(e,t){if(!e)return t.map(n=>n.clone());{if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const r=e[i],s=t[i];if(!!r!=!!s)return;if(r&&s){const o=r.getWithExplicit("orient"),a=s.getWithExplicit("orient");if(o.explicit&&a.explicit&&o.value!==a.value)return;e[i]=OKe(r,s)}}}return e}function OKe(e,t){for(const n of wle){const i=Qd(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(r,s)=>{switch(n){case"title":return Rre(r,s);case"gridScale":return{explicit:r.explicit,value:hi(r.value,s.value)}}return Mx(r,s,n,"axis")});e.setWithExplicit(n,i)}return e}function NKe(e,t,n,i,r){if("disable"===t)return void 0!==n;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(Re(n.labelAngle)?n.labelAngle:t1(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===Sae(i,r))return!0}return e===n[t]}const kKe=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function IKe(e,t){var n,i,r;let s=t.axis(e);const o=new iB,a=Ai(t.encoding[e]),{mark:l,config:u}=t,c=(null==s?void 0:s.orient)||(null===(n=u["x"===e?"axisX":"axisY"])||void 0===n?void 0:n.orient)||(null===(i=u.axis)||void 0===i?void 0:i.orient)||function fWe(e){return"x"===e?"bottom":"left"}(e),d=t.getScaleComponent(e).get("type"),f=function sWe(e,t,n,i){const r="band"===t?["axisDiscrete","axisBand"]:"point"===t?["axisDiscrete","axisPoint"]:use(t)?["axisQuantitative"]:"time"===t||"utc"===t?["axisTemporal"]:[],s="x"===e?"axisX":"axisY",o=Re(n)?"axisOrient":`axis${e1(n)}`,a=[...r,...r.map(u=>s+u.substr(4))],l=["axis",o,s];return{vlOnlyAxisConfig:wae(a,i,e,n),vgAxisConfig:wae(l,i,e,n),axisConfigStyle:oWe([...l,...a],i)}}(e,d,c,t.config),h=void 0!==s?!s:k5("disable",u.style,null==s?void 0:s.style,f).configValue;if(o.set("disable",h,void 0!==s),h)return o;s=s||{};const p=function uWe(e,t,n,i,r){const s=null==t?void 0:t.labelAngle;if(void 0!==s)return Re(s)?s:t1(s);{const{configValue:o}=k5("labelAngle",i,null==t?void 0:t.style,r);return void 0!==o?t1(o):n!==Bn||!Dt([Ij,kj],e.type)||ge(e)&&e.timeUnit?void 0:270}}(a,s,e,u.style,f),g={fieldOrDatumDef:a,axis:s,channel:e,model:t,scaleType:d,orient:c,labelAngle:p,mark:l,config:u};for(const y of wle){const v=y in Dae?Dae[y](g):Gse(y)?s[y]:void 0,b=void 0!==v,D=NKe(v,y,s,t,e);if(b&&D)o.set(y,v,D);else{const{configValue:C,configFrom:w}=Gse(y)&&"values"!==y?k5(y,u.style,s.style,f):{},E=void 0!==C;b&&!E?o.set(y,v,D):("vgAxisConfig"!==w||kKe.has(y)&&E||h1(C)||Re(C))&&o.set(y,C,!1)}}const m=null!==(r=s.encoding)&&void 0!==r?r:{},_=Use.reduce((y,v)=>{var b;if(!o.hasAxisPart(v))return y;const D=kae(null!==(b=m[v])&&void 0!==b?b:{},t),C="labels"===v?function SKe(e,t,n){var i;const{encoding:r,config:s}=e,o=null!==(i=Ai(r[t]))&&void 0!==i?i:Ai(r[oc(t)]),a=e.axis(t)||{},{format:l,formatType:u}=a;return Xh(u)?Object.assign({text:Uj({fieldOrDatumDef:o,field:"datum.value",format:l,formatType:u,config:s})},n):n}(t,e,D):D;return void 0!==C&&!nn(C)&&(y[v]={update:C}),y},{});return nn(_)||o.set("encode",_,!!s.encoding||void 0!==s.labelAngle),o}const $Ke={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Wo(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),xr("x",e,{defaultPos:"mid"})),xr("y",e,{defaultPos:"mid"})),tf(e,"radius")),tf(e,"theta"))},VKe={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Wo(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),Ox("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===e.markDef.orient})),Ox("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===e.markDef.orient})),A5(e))},HKe={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Wo(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),tf(e,"x")),tf(e,"y"))},UKe={vgMark:"shape",encodeEntry:e=>Object.assign({},Wo(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&ge(n)&&n.type===Gm?{field:_e(n,{expr:"datum"})}:{})]}},zKe={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Wo(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),tf(e,"x")),tf(e,"y")),S5(e,"url"))},qKe={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Wo(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),xr("x",e,{defaultPos:"mid"})),xr("y",e,{defaultPos:"mid"})),Ui("size",e,{vgChannel:"strokeWidth"})),A5(e))},GKe={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Wo(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),xr("x",e,{defaultPos:"mid"})),xr("y",e,{defaultPos:"mid"})),Ui("size",e)),A5(e))};function rB(e,t){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Wo(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),xr("x",e,{defaultPos:"mid"})),xr("y",e,{defaultPos:"mid"})),Ui("size",e)),Ui("angle",e)),function WKe(e,t,n){return n?{shape:{value:n}}:Ui("shape",e)}(e,0,t))}const YKe={vgMark:"symbol",encodeEntry:e=>rB(e)},KKe={vgMark:"symbol",encodeEntry:e=>rB(e,"circle")},JKe={vgMark:"symbol",encodeEntry:e=>rB(e,"square")},XKe={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Wo(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),tf(e,"x")),tf(e,"y"))},QKe={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},Wo(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Ox("x",e,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n})),Ox("y",e,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n})),Ui("size",e,{vgChannel:"strokeWidth"})):{}}},ZKe={vgMark:"text",encodeEntry:e=>{const{config:t}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Wo(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),xr("x",e,{defaultPos:"mid"})),xr("y",e,{defaultPos:"mid"})),S5(e)),Ui("size",e,{vgChannel:"fontSize"})),Ui("angle",e)),iae("align",function eJe(e,t,n){if(void 0===Wt("align",e,n))return"center"}(e.markDef,0,t))),iae("baseline",function tJe(e,t,n){if(void 0===Wt("baseline",e,n))return"middle"}(e.markDef,0,t))),xr("radius",e,{defaultPos:null})),xr("theta",e,{defaultPos:null}))}},nJe={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r="horizontal"===i?"width":"height",s="horizontal"===i?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Wo(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),xr("x",e,{defaultPos:"mid",vgChannel:"xc"})),xr("y",e,{defaultPos:"mid",vgChannel:"yc"})),Ui("size",e,{defaultValue:iJe(e),vgChannel:r})),{[s]:Cn(Wt("thickness",n,t))})}};function iJe(e){var t;const{config:n,markDef:i}=e,{orient:r}=i,s="horizontal"===r?"width":"height",o=e.getScaleComponent("horizontal"===r?"x":"y"),a=null!==(t=Wt("size",i,n,{vgChannel:s}))&&void 0!==t?t:n.tick.bandSize;if(void 0!==a)return a;{const l=o?o.get("range"):void 0;return l&&Wd(l)&&en(l.step)?3*l.step/4:3*Sx(n.view,s)/4}}const Xx={arc:$Ke,area:VKe,bar:HKe,circle:KKe,geoshape:UKe,image:zKe,line:qKe,point:YKe,rect:XKe,rule:QKe,square:JKe,text:ZKe,tick:nJe,trail:GKe};const Dle="faceted_path_",Cle="stack_group_";function sB(e,t={fromPrefix:""}){const{mark:n,markDef:i,encoding:r,config:s}=e,o=hi(i.clip,function lJe(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return!(!(null==t?void 0:t.get("selectionExtent"))&&!(null==n?void 0:n.get("selectionExtent")))||void 0}(e),function uJe(e){const t=e.component.projection;return!(!t||t.isFit)||void 0}(e)),a=Tre(i),l=r.key,u=function aJe(e){var t;const{encoding:n,stack:i,mark:r,markDef:s,config:o}=e,a=n.order;if(!(!ne(a)&&qa(a)&&ZL(a.value)||!a&&ZL(Wt("order",s,o)))){if((ne(a)||ge(a))&&!i)return Nre(a,{expr:"datum"});if(Kd(r)){const l="horizontal"===s.orient?"y":"x",u=n[l];if(ge(u)){const c=u.sort;return ne(c)?{field:_e(u,{prefix:l,suffix:"sort_index",expr:"datum"})}:eu(c)?{field:_e({aggregate:Qj(e.encoding)?c.op:void 0,field:c.field},{expr:"datum"})}:Tse(c)?{field:_e(e.fieldDef(c.encoding),{expr:"datum"}),order:c.order}:null===c?void 0:{field:_e(u,{binSuffix:(null===(t=e.stack)||void 0===t?void 0:t.impute)?"mid":void 0,expr:"datum"})}}return}}}(e),c=function cJe(e){if(!e.component.selection)return null;const t=oe(e.component.selection).length;let n=t,i=e.parent;for(;i&&0===n;)n=oe(i.component.selection).length,i=i.parent;return n?{interactive:t>0||!!e.encoding.tooltip}:null}(e),d=Wt("aria",i,s),f=Xx[n].postEncodingTransform?Xx[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:Xx[n].vgMark},o?{clip:!0}:{}),a?{style:a}:{}),l?{key:l.field}:{}),u?{sort:u}:{}),c||{}),!1===d?{aria:d}:{}),{from:{data:t.fromPrefix+e.requestDataName(hn.Main)},encode:{update:Xx[n].encodeEntry(e)}}),f?{transform:f}:{})]}class Ele extends mle{constructor(t,n,i,r={},s){var o;super(t,"unit",n,i,s,void 0,moe(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const a=za(t.mark)?Object.assign({},t.mark):{type:t.mark},l=a.type;void 0===a.filled&&(a.filled=function jKe(e,t,{graticule:n}){if(n)return!1;const i=Gh("filled",e,t),r=e.type;return hi(i,r!==rx&&r!==ix&&r!==sx)}(a,s,{graticule:t.data&&b5(t.data)}));const u=this.encoding=function Hze(e,t,n,i){const r={};for(const s of oe(e))mre(s)||ce(q9e(s));for(let s of XHe){if(!e[s])continue;const o=e[s];if(zm(s)){const a=vre(s),l=r[a];if(ge(l)){if(zUe(l.type)&&ge(o)){ce(L9e(a));continue}}else s=a,ce(j9e(a))}if("angle"===s&&"arc"===t&&!e.theta&&(ce("Arc marks uses theta channel rather than angle, replacing angle with theta."),s=Va),Vze(e,s,t)){if(s===rc&&"line"===t){const a=iu(e[s]);if(null==a?void 0:a.aggregate){ce("Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.");continue}}if(s===Cs&&(n?"fill"in e:"stroke"in e))ce(zre("encoding",{fill:"fill"in e,stroke:"stroke"in e}));else if(s===s1||s===r1&&!ne(o)&&!qa(o)||s===Uh&&ne(o))o&&(r[s]=we(o).reduce((a,l)=>(ge(l)?a.push(Jj(l,s)):ce(yj(l,s)),a),[]));else{if(s===Uh&&null===o)r[s]=null;else if(!(ge(o)||tu(o)||qa(o)||cx(o)||Re(o))){ce(yj(o,s));continue}r[s]=$se(o,s,i)}}else ce(QS(s,t))}return r}(t.encoding||{},l,a.filled,s);this.markDef=function FKe(e,t,n){const i=xs(e),r=Wt("orient",i,n);if(i.orient=function BKe(e,t,n){switch(e){case rx:case Lj:case jj:case pse:case oze:case sze:return}const{x:i,y:r,x2:s,y2:o}=t;switch(e){case nx:if(ge(i)&&(es(i.bin)||ge(r)&&r.aggregate&&!i.aggregate))return"vertical";if(ge(r)&&(es(r.bin)||ge(i)&&i.aggregate&&!r.aggregate))return"horizontal";if(o||s){if(n)return n;if(!s&&(ge(i)&&i.type===Kh&&!_n(i.bin)||hx(i)))return"horizontal";if(!o&&(ge(r)&&r.type===Kh&&!_n(r.bin)||hx(r)))return"vertical"}case sx:if(s&&(!ge(i)||!es(i.bin))&&o&&(!ge(r)||!es(r.bin)))return;case tx:if(o)return ge(r)&&es(r.bin)?"horizontal":"vertical";if(s)return ge(i)&&es(i.bin)?"vertical":"horizontal";if(e===sx){if(i&&!r)return"vertical";if(r&&!i)return"horizontal"}case ix:case Pj:{const a=nu(i),l=nu(r);if(n)return n;if(a&&!l)return"tick"!==e?"horizontal":"vertical";if(!a&&l)return"tick"!==e?"vertical":"horizontal";if(a&&l){const u=i,c=r,d=u.type===qm,f=c.type===qm;return d&&!f?"tick"!==e?"vertical":"horizontal":!d&&f?"tick"!==e?"horizontal":"vertical":!u.aggregate&&c.aggregate?"tick"!==e?"vertical":"horizontal":u.aggregate&&!c.aggregate&&"tick"!==e?"horizontal":"vertical"}return}}return"vertical"}(i.type,t,r),void 0!==r&&r!==i.orient&&ce(function X9e(e,t){return`Specified orient "${e}" overridden with "${t}".`}(i.orient,r)),"bar"===i.type&&i.orient){const a=Wt("cornerRadiusEnd",i,n);if(void 0!==a){const l="horizontal"===i.orient&&t.x2||"vertical"===i.orient&&t.y2?["cornerRadius"]:hze[i.orient];for(const u of l)i[u]=a;void 0!==i.cornerRadiusEnd&&delete i.cornerRadiusEnd}}return void 0===Wt("opacity",i,n)&&(i.opacity=function LKe(e,t){if(Dt([rx,Pj,Lj,jj],e)&&!Qj(t))return.7}(i.type,t)),void 0===Wt("cursor",i,n)&&(i.cursor=function PKe(e,t,n){return t.href||e.href||Wt("href",e,n)?"pointer":e.cursor}(i,t,n)),i}(a,u,s),this.size=function RKe({encoding:e,size:t}){for(const n of Xl){const i=Ss(n);ru(t[i])&&nu(e[n])&&(delete t[i],ce(Gre(i)))}return t}({encoding:u,size:moe(t)?Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):r}),this.stack=Eoe(l,u),this.specifiedScales=this.initScales(l,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegends(u),this.specifiedProjection=t.projection,this.selection=(null!==(o=t.params)&&void 0!==o?o:[]).filter(c=>u5(c))}get hasProjection(){const{encoding:t}=this,n=this.mark===gse,i=t&&GHe.some(r=>Ke(t[r]));return n||i}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return KS.reduce((i,r)=>{var s;const o=Ai(n[r]);return o&&(i[r]=this.initScale(null!==(s=o.scale)&&void 0!==s?s:{})),i},{})}initScale(t){const{domain:n,range:i}=t,r=xs(t);return ne(n)&&(r.domain=n.map(ao)),ne(i)&&(r.range=i.map(ao)),r}initAxes(t){return Xl.reduce((n,i)=>{const r=t[i];if(Ke(r)||i===Bn&&Ke(t.x2)||i===Vi&&Ke(t.y2)){const s=Ke(r)?r.axis:void 0;n[i]=s&&this.initAxis(Object.assign({},s))}return n},{})}initAxis(t){const n=oe(t),i={};for(const r of n){const s=t[r];i[r]=h1(s)?xre(s):ao(s)}return i}initLegends(t){return e9e.reduce((n,i)=>{const r=Ai(t[i]);if(r&&function n9e(e){switch(e){case Cs:case Kl:case Jl:case rc:case Es:case sc:case Vd:case Hd:return!0;case Bd:case $d:case Hh:return!1}}(i)){const s=r.legend;n[i]=s&&xs(s)}return n},{})}parseData(){this.component.data=Jx(this)}parseLayoutSize(){!function _Ke(e){const{size:t,component:n}=e;for(const i of Xl){const r=Ss(i);if(t[r]){const s=t[r];n.layoutSize.set(r,ru(s)?"step":s,!0)}else{const s=yKe(e,r);n.layoutSize.set(r,s,!1)}}}(this)}parseSelections(){this.component.selection=function tWe(e,t){var n;const i={},r=e.config.selection;if(!t||!t.length)return i;for(const s of t){const o=Fn(s.name),a=s.select,l=be(a)?a:a.type,u=Se(a)?nt(a):{type:l},c=r[l];for(const f in c)"fields"===f||"encodings"===f||("mark"===f&&(u[f]=Object.assign(Object.assign({},c[f]),u[f])),(void 0===u[f]||!0===u[f])&&(u[f]=null!==(n=c[f])&&void 0!==n?n:u[f]));const d=i[o]=Object.assign(Object.assign({},u),{name:o,type:l,init:s.value,bind:s.bind,events:be(u.on)?Fd(u.on,"scope"):we(nt(u.on))});for(const f of Ix)f.defined(d)&&f.parse&&f.parse(e,d,s)}return i}(this,this.selection)}parseMarkGroup(){this.component.mark=function rJe(e){if(Dt([ix,tx,aze],e.mark)){const t=Jse(e.mark,e.encoding);if(t.length>0)return function sJe(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:Dle+e.requestDataName(hn.Main),data:e.requestDataName(hn.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:sB(e,{fromPrefix:Dle})}]}(e,t)}else if(e.mark===nx){const t=pj.some(n=>Wt(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return function oJe(e){var t;const[n]=sB(e,{fromPrefix:Cle}),i=e.scaleName(e.stack.fieldChannel),r=(c={})=>e.vgField(e.stack.fieldChannel,c),s=(c,d)=>`${c}(${[r({prefix:"min",suffix:"start",expr:d}),r({prefix:"max",suffix:"start",expr:d}),r({prefix:"min",suffix:"end",expr:d}),r({prefix:"max",suffix:"end",expr:d})].map(h=>`scale('${i}',${h})`).join(",")})`;let o,a;"x"===e.stack.fieldChannel?(o=Object.assign(Object.assign({},$m(n.encode.update,["y","yc","y2","height",...pj])),{x:{signal:s("min","datum")},x2:{signal:s("max","datum")},clip:{value:!0}}),a={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},n.encode.update=Object.assign(Object.assign({},oo(n.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(o=Object.assign(Object.assign({},$m(n.encode.update,["x","xc","x2","width"])),{y:{signal:s("min","datum")},y2:{signal:s("max","datum")},clip:{value:!0}}),a={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},n.encode.update=Object.assign(Object.assign({},oo(n.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const c of pj){const d=Gh(c,e.markDef,e.config);n.encode.update[c]?(o[c]=n.encode.update[c],delete n.encode.update[c]):d&&(o[c]=Cn(d)),d&&(n.encode.update[c]={value:0})}const l=[];if((null===(t=e.stack.groupbyChannels)||void 0===t?void 0:t.length)>0)for(const c of e.stack.groupbyChannels){const d=e.fieldDef(c),f=_e(d);f&&l.push(f),((null==d?void 0:d.bin)||(null==d?void 0:d.timeUnit))&&l.push(_e(d,{binSuffix:"end"}))}return o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((c,d)=>{if(n.encode.update[d])return Object.assign(Object.assign({},c),{[d]:n.encode.update[d]});{const f=Gh(d,e.markDef,e.config);return void 0!==f?Object.assign(Object.assign({},c),{[d]:Cn(f)}):c}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(hn.Main),name:Cle+e.requestDataName(hn.Main),groupby:l,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:a},marks:[n]}]}]}(e)}return sB(e)}(this)}parseAxesAndHeaders(){this.component.axes=function xKe(e){return Xl.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[IKe(n,e)]),t),{})}(this)}assembleSelectionTopLevelSignals(t){return function wGe(e,t){var n;let i=!1;for(const r of Er(null!==(n=e.component.selection)&&void 0!==n?n:{})){const s=r.name,o=pe(s+ep);if(0===t.filter(l=>l.name===s).length){const u="point"===r.type?", true, true)":")";t.push({name:r.name,update:`${pae}(${o}, ${pe("global"===r.resolve?"union":r.resolve)}${u}`})}i=!0;for(const l of Ix)l.defined(r)&&l.topLevelSignals&&(t=l.topLevelSignals(e,r,t))}return i&&0===t.filter(s=>"unit"===s.name).length&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),w5(t)}(this,t)}assembleSignals(){return[...bae(this),...vGe(this,[])]}assembleSelectionData(t){return function DGe(e,t){var n;const i=[...t];for(const r of Er(null!==(n=e.component.selection)&&void 0!==n?n:{})){const s={name:r.name+ep};if(r.init){const a=r.project.items.map(l=>yGe(l,["signals"]));s.values=r.init.map(l=>({unit:r0(e,{escape:!1}),fields:a,values:e0(l,!1)}))}i.filter(a=>a.name===r.name+ep).length||i.push(s)}return i}(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return L5(this)}assembleMarks(){var t;let n=null!==(t=this.component.mark)&&void 0!==t?t:[];return(!this.parent||!d0(this.parent))&&(n=Goe(this,n)),n.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};return void 0!==t?t:this.encoding.x||this.encoding.y?"cell":void 0}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return Zh(this.encoding,t)}fieldDef(t){return iu(this.encoding[t])}typedFieldDef(t){const n=this.fieldDef(t);return Go(n)?n:null}}class oB extends eB{constructor(t,n,i,r,s){super(t,"layer",n,i,s,t.resolve,t.view);const o=Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((a,l)=>{if(Ax(a))return new oB(a,this,this.getName(`layer_${l}`),o,s);if(cc(a))return new Ele(a,this,this.getName(`layer_${l}`),o,s);throw new Error(mj(a))})}parseData(){this.component.data=Jx(this);for(const t of this.children)t.parseData()}parseLayoutSize(){!function gKe(e){tB(e),Kx(e,"width"),Kx(e,"height")}(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of oe(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){!function MKe(e){var t;const{axes:n,resolve:i}=e.component,r={top:0,bottom:0,right:0,left:0};for(const s of e.children){s.parseAxesAndHeaders();for(const o of oe(s.component.axes))i.axis[o]=j5(e.component.resolve,o),"shared"===i.axis[o]&&(n[o]=TKe(n[o],s.component.axes[o]),n[o]||(i.axis[o]="independent",delete n[o]))}for(const s of Xl){for(const o of e.children)if(o.component.axes[s]){if("independent"===i.axis[s]){n[s]=(null!==(t=n[s])&&void 0!==t?t:[]).concat(o.component.axes[s]);for(const a of o.component.axes[s]){const{value:l,explicit:u}=a.getWithExplicit("orient");if(!Re(l)){if(r[l]>0&&!u){const c=AKe[l];r[l]>r[c]&&a.set("orient",c,!1)}r[l]++}}}delete o.component.axes[s]}if("independent"===i.axis[s]&&n[s]&&n[s].length>1)for(const o of n[s])o.get("grid")&&!o.explicit.grid&&(o.implicit.grid=!1)}}(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),bae(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),L5(this))}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const i of this.children)for(const r of we(i.assembleGroupStyle()))t.add(r);const n=Array.from(t);return n.length>1?n:1===n.length?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return function CGe(e,t){for(const n of e.children)pi(n)&&(t=Goe(n,t));return t}(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),Uae(this))}}function aB(e,t,n,i,r){if(ux(e))return new x1(e,t,n,r);if(Ax(e))return new oB(e,t,n,i,r);if(cc(e))return new Ele(e,t,n,i,r);if(function dqe(e){return Ex(e)||d5(e)||c5(e)}(e))return new DKe(e,t,n,r);throw new Error(mj(e))}function fJe(e,t={}){t.logger&&function EUe(e){Ql=e}(t.logger),t.fieldTitle&&Bse(t.fieldTitle);try{const n=Doe(Tg(t.config,e.config)),i=Boe(e,n),r=aB(i,null,"",void 0,n);return r.parse(),function EYe(e,t){G5(e.sources);let n=0,i=0;for(let r=0;r<5&&Qae(e,t,!0);r++)n++;e.sources.map(z5);for(let r=0;r<5&&Qae(e,t,!1);r++)i++;G5(e.sources),5===Math.max(n,i)&&ce("Maximum optimization runs(5) reached.")}(r.component.data,r),{spec:pJe(r,hJe(e,i.autosize,n,r),e.datasets,e.usermeta),normalized:i}}finally{t.logger&&function Xre(){return Ql=Jre,Ql}(),t.fieldTitle&&function Rze(){Bse(Lse)}()}}function hJe(e,t,n,i){const r=i.component.layoutSize.get("width"),s=i.component.layoutSize.get("height");if(void 0===t?(t={type:"pad"},i.hasAxisOrientSignalRef()&&(t.resize=!0)):be(t)&&(t={type:t}),r&&s&&function pGe(e){return"fit"===e||"fit-x"===e||"fit-y"===e}(t.type))if("step"===r&&"step"===s)ce(Lre()),t.type="pad";else if("step"===r||"step"===s){const o="step"===r?"width":"height";ce(Lre(YS(o))),t.type=function gGe(e){return e?`fit-${YS(e)}`:"fit"}("width"===o?"height":"width")}return Object.assign(Object.assign(Object.assign({},1===oe(t).length&&t.type?"pad"===t.type?{}:{autosize:t.type}:{autosize:t}),Voe(n,!1)),Voe(e,!0))}function pJe(e,t,n={},i){const r=e.config?function Sqe(e){e=nt(e);for(const t of Cqe)delete e[t];if(e.axis)for(const t in e.axis)h1(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of sqe)delete e.legend[t];if(e.mark){for(const t of yse)delete e.mark[t];e.mark.tooltip&&Se(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(poe(e.params)),delete e.params);for(const t of Dqe){for(const i of yse)delete e[t][i];const n=Eqe[t];if(n)for(const i of n)delete e[t][i];Aqe(e,t)}for(const t of function rqe(){return oe(s5)}())delete e[t];!function xqe(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=Sre(e.title);nn(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),nn(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),nn(i)?delete e.title:e.title=i}(e);for(const t in e)Se(e[t])&&nn(e[t])&&delete e[t];return nn(e)?void 0:e}(e.config):void 0,s=[].concat(e.assembleSelectionData([]),function dKe(e,t){var n,i;const r=[],s=_le(r);let o=0;for(const l of e.sources){l.hasName()||(l.dataName="source_"+o++);const u=l.assemble();s(l,u)}for(const l of r)0===l.transform.length&&delete l.transform;let a=0;for(const[l,u]of r.entries())0===(null!==(n=u.transform)&&void 0!==n?n:[]).length&&!u.source&&r.splice(a++,0,r.splice(l,1)[0]);for(const l of r)for(const u of null!==(i=l.transform)&&void 0!==i?i:[])"lookup"===u.type&&(u.from=e.outputNodes[u.from].getSource());for(const l of r)l.name in t&&(l.values=t[l.name]);return r}(e.component.data,n)),o=e.assembleProjections(),a=e.assembleTitle(),l=e.assembleGroupStyle(),u=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter(h=>"width"!==h.name&&"height"!==h.name||void 0===h.value||(t[h.name]=+h.value,!1));const{params:d}=t,f=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["params"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),f),a?{title:a}:{}),l?{style:l}:{}),u?{encode:{update:u}}:{}),{data:s}),o.length>0?{projections:o}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...poe(d)])),r?{config:r}:{}),i?{usermeta:i}:{})}const gJe="5.2.0",Sle=function mJe(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}},h0="#fff",FJe={background:"#333",title:{color:h0,subtitleColor:h0},style:{"guide-label":{fill:h0},"guide-title":{fill:h0}},axis:{domainColor:h0,gridColor:"#888",tickColor:h0}},sp="#4572a7",PJe={background:"#fff",arc:{fill:sp},area:{fill:sp},line:{stroke:sp,strokeWidth:2},path:{stroke:sp},rect:{fill:sp},shape:{stroke:sp},symbol:{fill:sp,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},op="#30a2da",lB="#cbcbcb",BJe={arc:{fill:op},area:{fill:op},axis:{domainColor:lB,grid:!0,gridColor:lB,gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:lB,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:"#f0f0f0",group:{fill:"#f0f0f0"},legend:{labelColor:"#333",labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:"#333",titleFontSize:14,titlePadding:10},line:{stroke:op,strokeWidth:2},path:{stroke:op,strokeWidth:.5},rect:{fill:op},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:op},bar:{binSpacing:2,fill:op,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},ap="#000",$Je={group:{fill:"#e5e5e5"},arc:{fill:ap},area:{fill:ap},line:{stroke:ap},path:{stroke:ap},rect:{fill:ap},shape:{stroke:ap},symbol:{fill:ap,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},Mle="Benton Gothic, sans-serif",lp="#82c6df",uB="Benton Gothic Bold, sans-serif",A1={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},zJe={background:"#ffffff",title:{anchor:"start",color:"#000000",font:uB,fontSize:22,fontWeight:"normal"},arc:{fill:lp},area:{fill:lp},line:{stroke:lp,strokeWidth:2},path:{stroke:lp},rect:{fill:lp},shape:{stroke:lp},symbol:{fill:lp,size:30},axis:{labelFont:Mle,labelFontSize:11.5,labelFontWeight:"normal",titleFont:uB,titleFontSize:13,titleFontWeight:"normal"},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:Mle,labelFontSize:11.5,symbolType:"square",titleFont:uB,titleFontSize:13,titleFontWeight:"normal"},range:{category:A1["category-6"],diverging:A1["fireandice-6"],heatmap:A1["fire-7"],ordinal:A1["fire-7"],ramp:A1["fire-7"]}},up="#ab5787",Qx="#979797",qJe={background:"#f9f9f9",arc:{fill:up},area:{fill:up},line:{stroke:up},path:{stroke:up},rect:{fill:up},shape:{stroke:up},symbol:{fill:up,size:30},axis:{domainColor:Qx,domainWidth:.5,gridWidth:.2,labelColor:Qx,tickColor:Qx,tickWidth:.2,titleColor:Qx},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},cp="#3e5c69",GJe={background:"#fff",arc:{fill:cp},area:{fill:cp},line:{stroke:cp},path:{stroke:cp},rect:{fill:cp},shape:{stroke:cp},symbol:{fill:cp},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Yo="#1696d2",Zx="Lato",cB="Lato",M1={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},XJe={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:Zx},axisX:{domain:!0,domainColor:"#000000",domainWidth:1,grid:!1,labelFontSize:12,labelFont:cB,labelAngle:0,tickColor:"#000000",tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Zx},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:cB,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Zx,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:cB,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Zx,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:M1["six-groups-cat-1"],diverging:M1["diverging-colors"],heatmap:M1["diverging-colors"],ordinal:M1["six-groups-seq"],ramp:M1["shades-blue"]},area:{fill:Yo},rect:{fill:Yo},line:{color:Yo,stroke:Yo,strokeWidth:5},trail:{color:Yo,stroke:Yo,strokeWidth:0,size:1},path:{stroke:Yo,strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:Yo,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Yo,stroke:null}},arc:{fill:Yo},shape:{stroke:Yo},symbol:{fill:Yo,size:30}},dp="#3366CC",eA="Arial, sans-serif",QJe={arc:{fill:dp},area:{fill:dp},path:{stroke:dp},rect:{fill:dp},shape:{stroke:dp},symbol:{stroke:dp},circle:{fill:dp},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:eA,fontSize:12},"guide-title":{font:eA,fontSize:12},"group-title":{font:eA,fontSize:12}},title:{font:eA,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:"#ccc",tickColor:"#ccc",domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},ZJe="2.10.0";function Rle(e,t){return JSON.stringify(e,function DXe(e){const t=[];return function(n,i){if("object"!=typeof i||null===i)return i;const r=t.indexOf(this)+1;return t.length=r,t.length>e?"[Object]":t.indexOf(i)>=0?"[Circular]":(t.push(i),i)}}(t))}const Fle="vg-tooltip-element",EXe={offsetX:10,offsetY:10,id:Fle,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function SXe(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2,formatTooltip:function wXe(e,t,n){if(ne(e))return`[${e.map(i=>t(be(i)?i:Rle(i,n))).join(", ")}]`;if(Se(e)){let i="";const r=e,{title:s,image:o}=r,a=function bXe(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(r,["title","image"]);s&&(i+=`<h2>${t(s)}</h2>`),o&&(i+=`<img src="${t(o)}">`);const l=Object.keys(a);if(l.length>0){i+="<table>";for(const u of l){let c=a[u];void 0!==c&&(Se(c)&&(c=Rle(c,n)),i+=`<tr><td class="key">${t(u)}:</td><td class="value">${t(c)}</td></tr>`)}i+="</table>"}return i||"{}"}return t(e)}};class Ple{constructor(t){this.options=Object.assign(Object.assign({},EXe),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const i=document.createElement("style");i.setAttribute("id",this.options.styleId),i.innerHTML=function xXe(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return"#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black;\n}\n#vg-tooltip-element.visible {\n  visibility: visible;\n}\n#vg-tooltip-element h2 {\n  margin-top: 0;\n  margin-bottom: 10px;\n  font-size: 13px;\n}\n#vg-tooltip-element img {\n  max-width: 200px;\n  max-height: 200px;\n}\n#vg-tooltip-element table {\n  border-spacing: 0;\n}\n#vg-tooltip-element table tr {\n  border: none;\n}\n#vg-tooltip-element table tr td {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-top: 2px;\n  padding-bottom: 2px;\n}\n#vg-tooltip-element table tr td.key {\n  color: #808080;\n  max-width: 150px;\n  text-align: right;\n  padding-right: 4px;\n}\n#vg-tooltip-element table tr td.value {\n  display: block;\n  max-width: 300px;\n  max-height: 7em;\n  text-align: left;\n}\n#vg-tooltip-element.dark-theme {\n  background-color: rgba(32, 32, 32, 0.9);\n  border: 1px solid #f5f5f5;\n  color: white;\n}\n#vg-tooltip-element.dark-theme td.key {\n  color: #bfbfbf;\n}\n".toString().replace(Fle,e)}(n);const r=document.head;r.childNodes.length>0?r.insertBefore(i,r.childNodes[0]):r.appendChild(i)}}tooltipHandler(t,n,i,r){var s;if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),(null!==(s=document.fullscreenElement)&&void 0!==s?s:document.body).appendChild(this.el)),null==r||""===r)return void this.el.classList.remove("visible",`${this.options.theme}-theme`);this.el.innerHTML=this.options.formatTooltip(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:o,y:a}=function AXe(e,t,n,i){let r=e.clientX+n;r+t.width>window.innerWidth&&(r=+e.clientX-n-t.width);let s=e.clientY+i;return s+t.height>window.innerHeight&&(s=+e.clientY-i-t.height),{x:r,y:s}}(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${a}px; left: ${o}px`)}}function MXe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lle(e,t,n,i,r,s,o){try{var a=e[s](o),l=a.value}catch(u){return void n(u)}a.done?t(l):Promise.resolve(l).then(i,r)}function tA(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var s=e.apply(t,n);function o(l){Lle(s,i,r,o,a,"next",l)}function a(l){Lle(s,i,r,o,a,"throw",l)}o(void 0)})}}var lu,jle=Object.prototype,fp=jle.hasOwnProperty,dB="function"==typeof Symbol?Symbol:{},nA=dB.iterator||"@@iterator",TXe=dB.asyncIterator||"@@asyncIterator",iA=dB.toStringTag||"@@toStringTag";function Ble(e,t,n,i){var s=Object.create((t&&t.prototype instanceof hB?t:hB).prototype),o=new _B(i||[]);return s._invoke=function RXe(e,t,n){var i=$le;return function(s,o){if(i===Vle)throw new Error("Generator is already running");if(i===rA){if("throw"===s)throw o;return qle()}for(n.method=s,n.arg=o;;){var a=n.delegate;if(a){var l=zle(a,n);if(l){if(l===Ka)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===$le)throw i=rA,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=Vle;var u=fB(e,t,n);if("normal"===u.type){if(i=n.done?rA:OXe,u.arg===Ka)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=rA,n.method="throw",n.arg=u.arg)}}}(e,n,o),s}function fB(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(i){return{type:"throw",arg:i}}}var $le="suspendedStart",OXe="suspendedYield",Vle="executing",rA="completed",Ka={};function hB(){}function sA(){}function p0(){}var pB={};pB[nA]=function(){return this};var gB=Object.getPrototypeOf,oA=gB&&gB(gB(yB([])));oA&&oA!==jle&&fp.call(oA,nA)&&(pB=oA);var g0=p0.prototype=hB.prototype=Object.create(pB);function Hle(e){["next","throw","return"].forEach(function(t){e[t]=function(n){return this._invoke(t,n)}})}function Ule(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===sA||"GeneratorFunction"===(t.displayName||t.name))}function aA(e,t){function n(s,o,a,l){var u=fB(e[s],e,o);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==typeof d&&fp.call(d,"__await")?t.resolve(d.__await).then(function(f){n("next",f,a,l)},function(f){n("throw",f,a,l)}):t.resolve(d).then(function(f){c.value=f,a(c)},function(f){return n("throw",f,a,l)})}l(u.arg)}var i;this._invoke=function r(s,o){function a(){return new t(function(l,u){n(s,o,l,u)})}return i=i?i.then(a,a):a()}}function zle(e,t){var n=e.iterator[t.method];if(n===lu){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=lu,zle(e,t),"throw"===t.method))return Ka;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return Ka}var i=fB(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,Ka;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=lu),t.delegate=null,Ka):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,Ka)}function FXe(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function mB(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _B(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(FXe,this),this.reset(!0)}function yB(e){if(e){var t=e[nA];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(fp.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=lu,r.done=!0,r};return i.next=i}}return{next:qle}}function qle(){return{value:lu,done:!0}}sA.prototype=g0.constructor=p0,p0.constructor=sA,p0[iA]=sA.displayName="GeneratorFunction",Hle(aA.prototype),aA.prototype[TXe]=function(){return this},Hle(g0),g0[iA]="Generator",g0[nA]=function(){return this},g0.toString=function(){return"[object Generator]"},_B.prototype={constructor:_B,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=lu,this.done=!1,this.delegate=null,this.method="next",this.arg=lu,this.tryEntries.forEach(mB),!t)for(var n in this)"t"===n.charAt(0)&&fp.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=lu)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(u,c){return o.type="throw",o.arg=t,n.next=u,c&&(n.method="next",n.arg=lu),!!c}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var a=fp.call(s,"catchLoc"),l=fp.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,n){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&fp.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=n&&n<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=n,s?(this.method="next",this.next=s.finallyLoc,Ka):this.complete(o)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),Ka},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),mB(i),Ka}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc===t){var r=i.completion;if("throw"===r.type){var s=r.arg;mB(i)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:yB(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=lu),Ka}};var uu={wrap:Ble,isGeneratorFunction:Ule,AsyncIterator:aA,mark:function NXe(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p0):(e.__proto__=p0,iA in e||(e[iA]="GeneratorFunction")),e.prototype=Object.create(g0),e},awrap:function kXe(e){return{__await:e}},async:function IXe(e,t,n,i,r){void 0===r&&(r=Promise);var s=new aA(Ble(e,t,n,i),r);return Ule(t)?s:s.next().then(function(o){return o.done?o.value:s.next()})},keys:function PXe(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function i(){for(;t.length;){var r=t.pop();if(r in e)return i.value=r,i.done=!1,i}return i.done=!0,i}},values:yB},LXe=Lt;function Lt(e){var t=this;if(t instanceof Lt||(t=new Lt),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach(function(r){t.push(r)});else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);return t}function jXe(e,t,n){var i=t===e.head?new hp(n,null,t,e):new hp(n,t,t.next,e);return null===i.next&&(e.tail=i),null===i.prev&&(e.head=i),e.length++,i}function BXe(e,t){e.tail=new hp(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function $Xe(e,t){e.head=new hp(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function hp(e,t,n,i){if(!(this instanceof hp))return new hp(e,t,n,i);this.list=i,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}Lt.Node=hp,Lt.create=Lt,Lt.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},Lt.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},Lt.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},Lt.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)BXe(this,arguments[e]);return this.length},Lt.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)$Xe(this,arguments[e]);return this.length},Lt.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},Lt.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},Lt.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,i=0;null!==n;i++)e.call(t,n.value,i,this),n=n.next},Lt.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,i=this.length-1;null!==n;i--)e.call(t,n.value,i,this),n=n.prev},Lt.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},Lt.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},Lt.prototype.map=function(e,t){t=t||this;for(var n=new Lt,i=this.head;null!==i;)n.push(e.call(t,i.value,this)),i=i.next;return n},Lt.prototype.mapReverse=function(e,t){t=t||this;for(var n=new Lt,i=this.tail;null!==i;)n.push(e.call(t,i.value,this)),i=i.prev;return n},Lt.prototype.reduce=function(e,t){var n,i=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");i=this.head.next,n=this.head.value}for(var r=0;null!==i;r++)n=e(n,i.value,r),i=i.next;return n},Lt.prototype.reduceReverse=function(e,t){var n,i=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");i=this.tail.prev,n=this.tail.value}for(var r=this.length-1;null!==i;r--)n=e(n,i.value,r),i=i.prev;return n},Lt.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},Lt.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},Lt.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new Lt;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,r=this.head;null!==r&&i<e;i++)r=r.next;for(;null!==r&&i<t;i++,r=r.next)n.push(r.value);return n},Lt.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new Lt;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,r=this.tail;null!==r&&i>t;i--)r=r.prev;for(;null!==r&&i>e;i--,r=r.prev)n.push(r.value);return n},Lt.prototype.splice=function(e,t){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,i=this.head;null!==i&&n<e;n++)i=i.next;var r=[];for(n=0;i&&n<t;n++)r.push(i.value),i=this.removeNode(i);for(null===i&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev),n=0;n<(arguments.length<=2?0:arguments.length-2);n++)i=jXe(this,i,n+2<2||arguments.length<=n+2?void 0:arguments[n+2]);return r},Lt.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var i=n.prev;n.prev=n.next,n.next=i}return this.head=t,this.tail=e,this};try{Lt.prototype[Symbol.iterator]=uu.mark(function e(){var t;return uu.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:t=this.head;case 1:if(!t){i.next=7;break}return i.next=4,t.value;case 4:t=t.next,i.next=1;break;case 7:case"end":return i.stop()}},e,this)})}catch(e){}var VXe=LXe,pp=Symbol("max"),pc=Symbol("length"),m0=Symbol("lengthCalculator"),T1=Symbol("allowStale"),gp=Symbol("maxAge"),gc=Symbol("dispose"),Gle=Symbol("noDisposeOnSet"),zi=Symbol("lruList"),Ja=Symbol("cache"),Wle=Symbol("updateAgeOnGet"),vB=()=>1,bB=(e,t,n)=>{var i=e[Ja].get(t);if(i){var r=i.value;if(lA(e,r)){if(_0(e,i),!e[T1])return}else n&&(e[Wle]&&(i.value.now=Date.now()),e[zi].unshiftNode(i));return r.value}},lA=(e,t)=>{if(!t||!t.maxAge&&!e[gp])return!1;var n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[gp]&&n>e[gp]},O1=e=>{if(e[pc]>e[pp])for(var t=e[zi].tail;e[pc]>e[pp]&&null!==t;){var n=t.prev;_0(e,t),t=n}},_0=(e,t)=>{if(t){var n=t.value;e[gc]&&e[gc](n.key,n.value),e[pc]-=n.length,e[Ja].delete(n.key),e[zi].removeNode(t)}};class UXe{constructor(t,n,i,r,s){this.key=t,this.value=n,this.length=i,this.now=r,this.maxAge=s||0}}var Yle=(e,t,n,i)=>{var r=n.value;lA(e,r)&&(_0(e,n),e[T1]||(r=void 0)),r&&t.call(i,r.value,r.key,e)},qXe=["includePrerelease","loose","rtl"],wB=e=>e?"object"!=typeof e?{loose:!0}:qXe.filter(t=>e[t]).reduce((t,n)=>(t[n]=!0,t),{}):{},Xa={exports:{}},DB={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH:16},XXe="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.error("SEMVER",...t)}:()=>{},uA=XXe;!function(e,t){var n=DB.MAX_SAFE_COMPONENT_LENGTH,i=uA,r=(t=e.exports={}).re=[],s=t.src=[],o=t.t={},a=0,l=(u,c,d)=>{var f=a++;i(f,c),o[u]=f,s[f]=c,r[f]=new RegExp(c,d?"g":void 0)};l("NUMERICIDENTIFIER","0|[1-9]\\d*"),l("NUMERICIDENTIFIERLOOSE","[0-9]+"),l("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),l("MAINVERSION","(".concat(s[o.NUMERICIDENTIFIER],")\\.")+"(".concat(s[o.NUMERICIDENTIFIER],")\\.")+"(".concat(s[o.NUMERICIDENTIFIER],")")),l("MAINVERSIONLOOSE","(".concat(s[o.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(s[o.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(s[o.NUMERICIDENTIFIERLOOSE],")")),l("PRERELEASEIDENTIFIER","(?:".concat(s[o.NUMERICIDENTIFIER],"|").concat(s[o.NONNUMERICIDENTIFIER],")")),l("PRERELEASEIDENTIFIERLOOSE","(?:".concat(s[o.NUMERICIDENTIFIERLOOSE],"|").concat(s[o.NONNUMERICIDENTIFIER],")")),l("PRERELEASE","(?:-(".concat(s[o.PRERELEASEIDENTIFIER],"(?:\\.").concat(s[o.PRERELEASEIDENTIFIER],")*))")),l("PRERELEASELOOSE","(?:-?(".concat(s[o.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(s[o.PRERELEASEIDENTIFIERLOOSE],")*))")),l("BUILDIDENTIFIER","[0-9A-Za-z-]+"),l("BUILD","(?:\\+(".concat(s[o.BUILDIDENTIFIER],"(?:\\.").concat(s[o.BUILDIDENTIFIER],")*))")),l("FULLPLAIN","v?".concat(s[o.MAINVERSION]).concat(s[o.PRERELEASE],"?").concat(s[o.BUILD],"?")),l("FULL","^".concat(s[o.FULLPLAIN],"$")),l("LOOSEPLAIN","[v=\\s]*".concat(s[o.MAINVERSIONLOOSE]).concat(s[o.PRERELEASELOOSE],"?").concat(s[o.BUILD],"?")),l("LOOSE","^".concat(s[o.LOOSEPLAIN],"$")),l("GTLT","((?:<|>)?=?)"),l("XRANGEIDENTIFIERLOOSE","".concat(s[o.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),l("XRANGEIDENTIFIER","".concat(s[o.NUMERICIDENTIFIER],"|x|X|\\*")),l("XRANGEPLAIN","[v=\\s]*(".concat(s[o.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(s[o.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(s[o.XRANGEIDENTIFIER],")")+"(?:".concat(s[o.PRERELEASE],")?").concat(s[o.BUILD],"?")+")?)?"),l("XRANGEPLAINLOOSE","[v=\\s]*(".concat(s[o.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(s[o.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(s[o.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(s[o.PRERELEASELOOSE],")?").concat(s[o.BUILD],"?")+")?)?"),l("XRANGE","^".concat(s[o.GTLT],"\\s*").concat(s[o.XRANGEPLAIN],"$")),l("XRANGELOOSE","^".concat(s[o.GTLT],"\\s*").concat(s[o.XRANGEPLAINLOOSE],"$")),l("COERCE","".concat("(^|[^\\d])(\\d{1,").concat(n,"})")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:$|[^\\d])"),l("COERCERTL",s[o.COERCE],!0),l("LONETILDE","(?:~>?)"),l("TILDETRIM","(\\s*)".concat(s[o.LONETILDE],"\\s+"),!0),t.tildeTrimReplace="$1~",l("TILDE","^".concat(s[o.LONETILDE]).concat(s[o.XRANGEPLAIN],"$")),l("TILDELOOSE","^".concat(s[o.LONETILDE]).concat(s[o.XRANGEPLAINLOOSE],"$")),l("LONECARET","(?:\\^)"),l("CARETTRIM","(\\s*)".concat(s[o.LONECARET],"\\s+"),!0),t.caretTrimReplace="$1^",l("CARET","^".concat(s[o.LONECARET]).concat(s[o.XRANGEPLAIN],"$")),l("CARETLOOSE","^".concat(s[o.LONECARET]).concat(s[o.XRANGEPLAINLOOSE],"$")),l("COMPARATORLOOSE","^".concat(s[o.GTLT],"\\s*(").concat(s[o.LOOSEPLAIN],")$|^$")),l("COMPARATOR","^".concat(s[o.GTLT],"\\s*(").concat(s[o.FULLPLAIN],")$|^$")),l("COMPARATORTRIM","(\\s*)".concat(s[o.GTLT],"\\s*(").concat(s[o.LOOSEPLAIN],"|").concat(s[o.XRANGEPLAIN],")"),!0),t.comparatorTrimReplace="$1$2$3",l("HYPHENRANGE","^\\s*(".concat(s[o.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(s[o.XRANGEPLAIN],")")+"\\s*$"),l("HYPHENRANGELOOSE","^\\s*(".concat(s[o.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(s[o.XRANGEPLAINLOOSE],")")+"\\s*$"),l("STAR","(<|>)?=?\\s*\\*"),l("GTE0","^\\s*>=\\s*0.0.0\\s*$"),l("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")}(Xa,Xa.exports);var Kle=/^[0-9]+$/,cA=uA,Xle=DB.MAX_LENGTH,dA=DB.MAX_SAFE_INTEGER,Qle=Xa.exports.re,Zle=Xa.exports.t,eQe=wB,N1=(e,t)=>{var n=Kle.test(e),i=Kle.test(t);return n&&i&&(e=+e,t=+t),e===t?0:n&&!i?-1:i&&!n?1:e<t?-1:1};class Qa{constructor(t,n){if(n=eQe(n),t instanceof Qa){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if("string"!=typeof t)throw new TypeError("Invalid Version: ".concat(t));if(t.length>Xle)throw new TypeError("version is longer than ".concat(Xle," characters"));cA("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;var i=t.trim().match(n.loose?Qle[Zle.LOOSE]:Qle[Zle.FULL]);if(!i)throw new TypeError("Invalid Version: ".concat(t));if(this.raw=t,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>dA||this.major<0)throw new TypeError("Invalid major version");if(this.minor>dA||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>dA||this.patch<0)throw new TypeError("Invalid patch version");this.prerelease=i[4]?i[4].split(".").map(r=>{if(/^[0-9]+$/.test(r)){var s=+r;if(s>=0&&s<dA)return s}return r}):[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}toString(){return this.version}compare(t){if(cA("SemVer.compare",this.version,this.options,t),!(t instanceof Qa)){if("string"==typeof t&&t===this.version)return 0;t=new Qa(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof Qa||(t=new Qa(t,this.options)),N1(this.major,t.major)||N1(this.minor,t.minor)||N1(this.patch,t.patch)}comparePre(t){if(t instanceof Qa||(t=new Qa(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var n=0;do{var i=this.prerelease[n],r=t.prerelease[n];if(cA("prerelease compare",n,i,r),void 0===i&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===i)return-1;if(i!==r)return N1(i,r)}while(++n)}compareBuild(t){t instanceof Qa||(t=new Qa(t,this.options));var n=0;do{var i=this.build[n],r=t.build[n];if(cA("prerelease compare",n,i,r),void 0===i&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===i)return-1;if(i!==r)return N1(i,r)}while(++n)}inc(t,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n),this.inc("pre",n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",n),this.inc("pre",n);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var i=this.prerelease.length;--i>=0;)"number"==typeof this.prerelease[i]&&(this.prerelease[i]++,i=-2);-1===i&&this.prerelease.push(0)}n&&(this.prerelease[0]===n?isNaN(this.prerelease[1])&&(this.prerelease=[n,0]):this.prerelease=[n,0]);break;default:throw new Error("invalid increment argument: ".concat(t))}return this.format(),this.raw=this.version,this}}var CB=Qa,eue=CB,y0=(e,t,n)=>new eue(e,n).compare(new eue(t,n)),nQe=y0,sQe=y0,lQe=y0,dQe=y0,pQe=y0,_Qe=y0,bQe=(e,t,n)=>0===nQe(e,t,n),wQe=(e,t,n)=>0!==sQe(e,t,n),DQe=(e,t,n)=>lQe(e,t,n)>0,CQe=(e,t,n)=>dQe(e,t,n)>=0,EQe=(e,t,n)=>pQe(e,t,n)<0,SQe=(e,t,n)=>_Qe(e,t,n)<=0,k1=Symbol("SemVer ANY");class fA{static get ANY(){return k1}constructor(t,n){if(n=TQe(n),t instanceof fA){if(t.loose===!!n.loose)return t;t=t.value}SB("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.value=this.semver===k1?"":this.operator+this.semver.version,SB("comp",this)}parse(t){var i=t.match(this.options.loose?tue[nue.COMPARATORLOOSE]:tue[nue.COMPARATOR]);if(!i)throw new TypeError("Invalid comparator: ".concat(t));this.operator=void 0!==i[1]?i[1]:"","="===this.operator&&(this.operator=""),this.semver=i[2]?new iue(i[2],this.options.loose):k1}toString(){return this.value}test(t){if(SB("Comparator.test",t,this.options.loose),this.semver===k1||t===k1)return!0;if("string"==typeof t)try{t=new iue(t,this.options)}catch(n){return!1}return EB(t,this.operator,this.semver,this.options)}intersects(t,n){if(!(t instanceof fA))throw new TypeError("a Comparator is required");if((!n||"object"!=typeof n)&&(n={loose:!!n,includePrerelease:!1}),""===this.operator)return""===this.value||new rue(t.value,n).test(this.value);if(""===t.operator)return""===t.value||new rue(this.value,n).test(t.semver);var i=!(">="!==this.operator&&">"!==this.operator||">="!==t.operator&&">"!==t.operator),r=!("<="!==this.operator&&"<"!==this.operator||"<="!==t.operator&&"<"!==t.operator),s=this.semver.version===t.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==t.operator&&"<="!==t.operator),a=EB(this.semver,"<",t.semver,n)&&(">="===this.operator||">"===this.operator)&&("<="===t.operator||"<"===t.operator),l=EB(this.semver,">",t.semver,n)&&("<="===this.operator||"<"===this.operator)&&(">="===t.operator||">"===t.operator);return i||r||s&&o||a||l}}var MQe=fA,TQe=wB,tue=Xa.exports.re,nue=Xa.exports.t,EB=(e,t,n,i)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return bQe(e,n,i);case"!=":return wQe(e,n,i);case">":return DQe(e,n,i);case">=":return CQe(e,n,i);case"<":return EQe(e,n,i);case"<=":return SQe(e,n,i);default:throw new TypeError("Invalid operator: ".concat(t))}},SB=uA,iue=CB,rue=aue;function sue(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function OQe(e,t){if(e){if("string"==typeof e)return oue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oue(e,t)}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(u){throw u},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var u=n.next();return s=u.done,u},e:function(u){o=!0,a=u},f:function(){try{!s&&null!=n.return&&n.return()}finally{if(o)throw a}}}}function oue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}class I1{constructor(t,n){if(n=kQe(n),t instanceof I1)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new I1(t.raw,n);if(t instanceof xB)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(a=>this.parseRange(a.trim())).filter(a=>a.length),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(t));if(this.set.length>1){var i=this.set[0];if(this.set=this.set.filter(a=>!uue(a[0])),0===this.set.length)this.set=[i];else if(this.set.length>1){var s,r=sue(this.set);try{for(r.s();!(s=r.n()).done;){var o=s.value;if(1===o.length&&LQe(o[0])){this.set=[o];break}}}catch(a){r.e(a)}finally{r.f()}}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){t=t.trim();var n=Object.keys(this.options).join(","),i="parseRange:".concat(n,":").concat(t),r=lue.get(i);if(r)return r;var s=this.options.loose;t=t.replace(s?Mr[er.HYPHENRANGELOOSE]:Mr[er.HYPHENRANGE],WQe(this.options.includePrerelease)),ri("hyphen replace",t),t=t.replace(Mr[er.COMPARATORTRIM],RQe),ri("comparator trim",t,Mr[er.COMPARATORTRIM]),t=(t=(t=t.replace(Mr[er.TILDETRIM],FQe)).replace(Mr[er.CARETTRIM],PQe)).split(/\s+/).join(" ");var d,a=s?Mr[er.COMPARATORLOOSE]:Mr[er.COMPARATOR],l=t.split(" ").map(p=>jQe(p,this.options)).join(" ").split(/\s+/).map(p=>GQe(p,this.options)).filter(this.options.loose?p=>!!p.match(a):()=>!0).map(p=>new xB(p,this.options)),u=new Map,c=sue(l);try{for(c.s();!(d=c.n()).done;){var f=d.value;if(uue(f))return[f];u.set(f.value,f)}}catch(p){c.e(p)}finally{c.f()}u.size>1&&u.has("")&&u.delete("");var h=[...u.values()];return lue.set(i,h),h}intersects(t,n){if(!(t instanceof I1))throw new TypeError("a Range is required");return this.set.some(i=>cue(i,n)&&t.set.some(r=>cue(r,n)&&i.every(s=>r.every(o=>s.intersects(o,n)))))}test(t){if(!t)return!1;if("string"==typeof t)try{t=new IQe(t,this.options)}catch(i){return!1}for(var n=0;n<this.set.length;n++)if(YQe(this.set[n],t,this.options))return!0;return!1}}var aue=I1,lue=new class HXe{constructor(t){if("number"==typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!=typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[pp]=t.max||1/0;var n=t.length||vB;if(this[m0]="function"!=typeof n?vB:n,this[T1]=t.stale||!1,t.maxAge&&"number"!=typeof t.maxAge)throw new TypeError("maxAge must be a number");this[gp]=t.maxAge||0,this[gc]=t.dispose,this[Gle]=t.noDisposeOnSet||!1,this[Wle]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!=typeof t||t<0)throw new TypeError("max must be a non-negative number");this[pp]=t||1/0,O1(this)}get max(){return this[pp]}set allowStale(t){this[T1]=!!t}get allowStale(){return this[T1]}set maxAge(t){if("number"!=typeof t)throw new TypeError("maxAge must be a non-negative number");this[gp]=t,O1(this)}get maxAge(){return this[gp]}set lengthCalculator(t){"function"!=typeof t&&(t=vB),t!==this[m0]&&(this[m0]=t,this[pc]=0,this[zi].forEach(n=>{n.length=this[m0](n.value,n.key),this[pc]+=n.length})),O1(this)}get lengthCalculator(){return this[m0]}get length(){return this[pc]}get itemCount(){return this[zi].length}rforEach(t,n){n=n||this;for(var i=this[zi].tail;null!==i;){var r=i.prev;Yle(this,t,i,n),i=r}}forEach(t,n){n=n||this;for(var i=this[zi].head;null!==i;){var r=i.next;Yle(this,t,i,n),i=r}}keys(){return this[zi].toArray().map(t=>t.key)}values(){return this[zi].toArray().map(t=>t.value)}reset(){this[gc]&&this[zi]&&this[zi].length&&this[zi].forEach(t=>this[gc](t.key,t.value)),this[Ja]=new Map,this[zi]=new VXe,this[pc]=0}dump(){return this[zi].map(t=>!lA(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[zi]}set(t,n,i){if((i=i||this[gp])&&"number"!=typeof i)throw new TypeError("maxAge must be a number");var r=i?Date.now():0,s=this[m0](n,t);if(this[Ja].has(t)){if(s>this[pp])return _0(this,this[Ja].get(t)),!1;var a=this[Ja].get(t).value;return this[gc]&&(this[Gle]||this[gc](t,a.value)),a.now=r,a.maxAge=i,a.value=n,this[pc]+=s-a.length,a.length=s,this.get(t),O1(this),!0}var l=new UXe(t,n,s,r,i);return l.length>this[pp]?(this[gc]&&this[gc](t,n),!1):(this[pc]+=l.length,this[zi].unshift(l),this[Ja].set(t,this[zi].head),O1(this),!0)}has(t){if(!this[Ja].has(t))return!1;var n=this[Ja].get(t).value;return!lA(this,n)}get(t){return bB(this,t,!0)}peek(t){return bB(this,t,!1)}pop(){var t=this[zi].tail;return t?(_0(this,t),t.value):null}del(t){_0(this,this[Ja].get(t))}load(t){this.reset();for(var n=Date.now(),i=t.length-1;i>=0;i--){var r=t[i],s=r.e||0;if(0===s)this.set(r.k,r.v);else{var o=s-n;o>0&&this.set(r.k,r.v,o)}}}prune(){this[Ja].forEach((t,n)=>bB(this,n,!1))}}({max:1e3}),kQe=wB,xB=MQe,ri=uA,IQe=CB,Mr=Xa.exports.re,er=Xa.exports.t,RQe=Xa.exports.comparatorTrimReplace,FQe=Xa.exports.tildeTrimReplace,PQe=Xa.exports.caretTrimReplace,uue=e=>"<0.0.0-0"===e.value,LQe=e=>""===e.value,cue=(e,t)=>{for(var n=!0,i=e.slice(),r=i.pop();n&&i.length;)n=i.every(s=>r.intersects(s,t)),r=i.pop();return n},jQe=(e,t)=>(ri("comp",e,t),e=VQe(e,t),ri("caret",e),e=BQe(e,t),ri("tildes",e),e=UQe(e,t),ri("xrange",e),e=qQe(e,t),ri("stars",e),e),is=e=>!e||"x"===e.toLowerCase()||"*"===e,BQe=(e,t)=>e.trim().split(/\s+/).map(n=>$Qe(n,t)).join(" "),$Qe=(e,t)=>e.replace(t.loose?Mr[er.TILDELOOSE]:Mr[er.TILDE],(i,r,s,o,a)=>{var l;return ri("tilde",e,i,r,s,o,a),is(r)?l="":is(s)?l=">=".concat(r,".0.0 <").concat(+r+1,".0.0-0"):is(o)?l=">=".concat(r,".").concat(s,".0 <").concat(r,".").concat(+s+1,".0-0"):a?(ri("replaceTilde pr",a),l=">=".concat(r,".").concat(s,".").concat(o,"-").concat(a," <").concat(r,".").concat(+s+1,".0-0")):l=">=".concat(r,".").concat(s,".").concat(o," <").concat(r,".").concat(+s+1,".0-0"),ri("tilde return",l),l}),VQe=(e,t)=>e.trim().split(/\s+/).map(n=>HQe(n,t)).join(" "),HQe=(e,t)=>{ri("caret",e,t);var i=t.includePrerelease?"-0":"";return e.replace(t.loose?Mr[er.CARETLOOSE]:Mr[er.CARET],(r,s,o,a,l)=>{var u;return ri("caret",e,r,s,o,a,l),is(s)?u="":is(o)?u=">=".concat(s,".0.0").concat(i," <").concat(+s+1,".0.0-0"):is(a)?u="0"===s?">=".concat(s,".").concat(o,".0").concat(i," <").concat(s,".").concat(+o+1,".0-0"):">=".concat(s,".").concat(o,".0").concat(i," <").concat(+s+1,".0.0-0"):l?(ri("replaceCaret pr",l),u="0"===s?"0"===o?">=".concat(s,".").concat(o,".").concat(a,"-").concat(l," <").concat(s,".").concat(o,".").concat(+a+1,"-0"):">=".concat(s,".").concat(o,".").concat(a,"-").concat(l," <").concat(s,".").concat(+o+1,".0-0"):">=".concat(s,".").concat(o,".").concat(a,"-").concat(l," <").concat(+s+1,".0.0-0")):(ri("no pr"),u="0"===s?"0"===o?">=".concat(s,".").concat(o,".").concat(a).concat(i," <").concat(s,".").concat(o,".").concat(+a+1,"-0"):">=".concat(s,".").concat(o,".").concat(a).concat(i," <").concat(s,".").concat(+o+1,".0-0"):">=".concat(s,".").concat(o,".").concat(a," <").concat(+s+1,".0.0-0")),ri("caret return",u),u})},UQe=(e,t)=>(ri("replaceXRanges",e,t),e.split(/\s+/).map(n=>zQe(n,t)).join(" ")),zQe=(e,t)=>(e=e.trim()).replace(t.loose?Mr[er.XRANGELOOSE]:Mr[er.XRANGE],(i,r,s,o,a,l)=>{ri("xRange",e,i,r,s,o,a,l);var u=is(s),c=u||is(o),d=c||is(a);return"="===r&&d&&(r=""),l=t.includePrerelease?"-0":"",u?i=">"===r||"<"===r?"<0.0.0-0":"*":r&&d?(c&&(o=0),a=0,">"===r?(r=">=",c?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):"<="===r&&(r="<",c?s=+s+1:o=+o+1),"<"===r&&(l="-0"),i="".concat(r+s,".").concat(o,".").concat(a).concat(l)):c?i=">=".concat(s,".0.0").concat(l," <").concat(+s+1,".0.0-0"):d&&(i=">=".concat(s,".").concat(o,".0").concat(l," <").concat(s,".").concat(+o+1,".0-0")),ri("xRange return",i),i}),qQe=(e,t)=>(ri("replaceStars",e,t),e.trim().replace(Mr[er.STAR],"")),GQe=(e,t)=>(ri("replaceGTE0",e,t),e.trim().replace(Mr[t.includePrerelease?er.GTE0PRE:er.GTE0],"")),WQe=e=>(t,n,i,r,s,o,a,l,u,c,d,f,h)=>(n=is(i)?"":is(r)?">=".concat(i,".0.0").concat(e?"-0":""):is(s)?">=".concat(i,".").concat(r,".0").concat(e?"-0":""):o?">=".concat(n):">=".concat(n).concat(e?"-0":""),l=is(u)?"":is(c)?"<".concat(+u+1,".0.0-0"):is(d)?"<".concat(u,".").concat(+c+1,".0-0"):f?"<=".concat(u,".").concat(c,".").concat(d,"-").concat(f):e?"<".concat(u,".").concat(c,".").concat(+d+1,"-0"):"<=".concat(l),"".concat(n," ").concat(l).trim()),YQe=(e,t,n)=>{for(var i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(var r=0;r<e.length;r++)if(ri(e[r].semver),e[r].semver!==xB.ANY&&e[r].semver.prerelease.length>0){var s=e[r].semver;if(s.major===t.major&&s.minor===t.minor&&s.patch===t.patch)return!0}return!1}return!0},KQe=aue,due=(e,t,n)=>{try{t=new KQe(t,n)}catch(i){return!1}return t.test(e)};function XQe(e,t,n){var i=e.open(t),a=new URL(t).origin,l=40;e.addEventListener("message",function u(d){d.source===i&&(l=0,e.removeEventListener("message",u,!1))},!1),setTimeout(function c(){l<=0||(i.postMessage(n,a),setTimeout(c,250),l-=1)},250)}var AB,QQe='.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box;\n}\n.vega-embed.has-actions {\n  padding-right: 38px;\n}\n.vega-embed details:not([open]) > :not(summary) {\n  display: none !important;\n}\n.vega-embed summary {\n  list-style: none;\n  position: absolute;\n  top: 0;\n  right: 0;\n  padding: 6px;\n  z-index: 1000;\n  background: white;\n  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n  color: #1b1e23;\n  border: 1px solid #aaa;\n  border-radius: 999px;\n  opacity: 0.2;\n  transition: opacity 0.4s ease-in;\n  cursor: pointer;\n  line-height: 0px;\n}\n.vega-embed summary::-webkit-details-marker {\n  display: none;\n}\n.vega-embed summary:active {\n  box-shadow: #aaa 0px 0px 0px 1px inset;\n}\n.vega-embed summary svg {\n  width: 14px;\n  height: 14px;\n}\n.vega-embed details[open] summary {\n  opacity: 0.7;\n}\n.vega-embed:hover summary, .vega-embed:focus-within summary {\n  opacity: 1 !important;\n  transition: opacity 0.2s ease;\n}\n.vega-embed .vega-actions {\n  position: absolute;\n  z-index: 1001;\n  top: 35px;\n  right: -9px;\n  display: flex;\n  flex-direction: column;\n  padding-bottom: 8px;\n  padding-top: 8px;\n  border-radius: 4px;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n  border: 1px solid #d9d9d9;\n  background: white;\n  animation-duration: 0.15s;\n  animation-name: scale-in;\n  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n  text-align: left;\n}\n.vega-embed .vega-actions a {\n  padding: 8px 16px;\n  font-family: sans-serif;\n  font-size: 14px;\n  font-weight: 600;\n  white-space: nowrap;\n  color: #434a56;\n  text-decoration: none;\n}\n.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {\n  background-color: #f7f7f9;\n  color: black;\n}\n.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n  content: "";\n  display: inline-block;\n  position: absolute;\n}\n.vega-embed .vega-actions::before {\n  left: auto;\n  right: 14px;\n  top: -16px;\n  border: 8px solid #0000;\n  border-bottom-color: #d9d9d9;\n}\n.vega-embed .vega-actions::after {\n  left: auto;\n  right: 15px;\n  top: -14px;\n  border: 7px solid #0000;\n  border-bottom-color: #fff;\n}\n.vega-embed .chart-wrapper.fit-x {\n  width: 100%;\n}\n.vega-embed .chart-wrapper.fit-y {\n  height: 100%;\n}\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px;\n}\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n';function fue(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var r=0,s=n;r<s.length;r++){var o=s[r];ZQe(e,o)}return e}function ZQe(e,t){for(var n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];Og(e,r,t[r],!0)}}function hue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function af(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hue(Object(n),!0).forEach(function(i){MXe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hue(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});var lf=el,R1=tr,hA="undefined"!=typeof window?window:void 0;void 0===R1&&null!=hA&&null!==(AB=hA.vl)&&void 0!==AB&&AB.compile&&(R1=hA.vl);var DZe={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},CZe={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},F1={vega:"Vega","vega-lite":"Vega-Lite"},pA={vega:lf.version,"vega-lite":R1?R1.version:"not available"},EZe={vega:e=>e,"vega-lite":(e,t)=>R1.compile(e,{config:t}).spec},SZe='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',xZe="chart-wrapper";function AZe(e){return"function"==typeof e}function pue(e,t,n,i){var r="<html><head>".concat(t,'</head><body><pre><code class="json">'),s="</code></pre>".concat(n,"</body></html>"),o=window.open("");o.document.write(r+e+s),o.document.title="".concat(F1[i]," JSON Source")}function MZe(e,t){if(e.$schema){var i,n=Sle(e.$schema);t&&t!==n.library&&console.warn("The given visualization spec is written in ".concat(F1[n.library],", but mode argument sets ").concat(null!==(i=F1[t])&&void 0!==i?i:t,"."));var r=n.library;return due(pA[r],"^".concat(n.version.slice(1)))||console.warn("The input spec uses ".concat(F1[r]," ").concat(n.version,", but the current version of ").concat(F1[r]," is v").concat(pA[r],".")),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":null!=t?t:"vega"}function gue(e){return function TZe(e){return!(!e||!("load"in e))}(e)?e:lf.loader(e)}function OZe(e){var t,n,i=null!==(t=null===(n=e.usermeta)||void 0===n?void 0:n.embedOptions)&&void 0!==t?t:{};return be(i.defaultStyle)&&(i.defaultStyle=!1),i}function uf(e,t){return MB.apply(this,arguments)}function MB(){return MB=tA(uu.mark(function e(t,n){var i,r,s,o,a,l,u,c,d,f,h,p=arguments;return uu.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(s=p.length>2&&void 0!==p[2]?p[2]:{},!be(n)){m.next=10;break}return a=gue(s.loader),m.t0=JSON,m.next=6,a.load(n);case 6:m.t1=m.sent,o=m.t0.parse.call(m.t0,m.t1),m.next=11;break;case 10:o=n;case 11:return l=OZe(o),u=l.loader,(!a||u)&&(a=gue(null!==(c=s.loader)&&void 0!==c?c:u)),m.next=16,mue(l,a);case 16:return d=m.sent,m.next=19,mue(s,a);case 19:return h=af(af({},fue(f=m.sent,d)),{},{config:Tg(null!==(i=f.config)&&void 0!==i?i:{},null!==(r=d.config)&&void 0!==r?r:{})}),m.next=23,kZe(t,o,h,a);case 23:return m.abrupt("return",m.sent);case 24:case"end":return m.stop()}},e)})),MB.apply(this,arguments)}function mue(e,t){return TB.apply(this,arguments)}function TB(){return TB=tA(uu.mark(function e(t,n){var i,r,s;return uu.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!be(t.config)){a.next=8;break}return a.t1=JSON,a.next=4,n.load(t.config);case 4:a.t2=a.sent,a.t0=a.t1.parse.call(a.t1,a.t2),a.next=9;break;case 8:a.t0=null!==(i=t.config)&&void 0!==i?i:{};case 9:if(r=a.t0,!be(t.patch)){a.next=18;break}return a.t4=JSON,a.next=14,n.load(t.patch);case 14:a.t5=a.sent,a.t3=a.t4.parse.call(a.t4,a.t5),a.next=19;break;case 18:a.t3=t.patch;case 19:return s=a.t3,a.abrupt("return",af(af(af({},t),s?{patch:s}:{}),r?{config:r}:{}));case 21:case"end":return a.stop()}},e)})),TB.apply(this,arguments)}function NZe(e){var t,n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:null!==(t=document.head)&&void 0!==t?t:document.body}}function kZe(e,t){return OB.apply(this,arguments)}function OB(){return OB=tA(uu.mark(function e(t,n){var i,r,s,o,a,l,u,c,d,f,h,p,g,m,_,y,v,b,C,w,E,T,O,N,P,j,A,x,S,I,M,L,U,z,$,Y,ie,K,le,G,Q,te,q,he,ve,Ne,Ce=arguments;return uu.wrap(function(Je){for(;;)switch(Je.prev=Je.next){case 0:if(Ne=function(){U&&document.removeEventListener("click",U),S.finalize()},d=Ce.length>3?Ce[3]:void 0,f=(c=Ce.length>2&&void 0!==Ce[2]?Ce[2]:{}).theme?Tg(tl[c.theme],null!==(i=c.config)&&void 0!==i?i:{}):c.config,h=Uc(c.actions)?c.actions:fue({},DZe,null!==(r=c.actions)&&void 0!==r?r:{}),p=af(af({},CZe),c.i18n),g=null!==(s=c.renderer)&&void 0!==s?s:"canvas",m=null!==(o=c.logLevel)&&void 0!==o?o:lf.Warn,_=null!==(a=c.downloadFileName)&&void 0!==a?a:"visualization",y="string"==typeof t?document.querySelector(t):t){Je.next=12;break}throw new Error("".concat(t," does not exist"));case 12:return!1!==c.defaultStyle&&(v="vega-embed-style",b=NZe(y),C=b.rootContainer,b.root.getElementById(v)||((w=document.createElement("style")).id=v,w.innerHTML=void 0===c.defaultStyle||!0===c.defaultStyle?QQe.toString():c.defaultStyle,C.appendChild(w))),E=MZe(n,c.mode),T=EZe[E](n,f),"vega-lite"===E&&T.$schema&&(O=Sle(T.$schema),due(pA.vega,"^".concat(O.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(O.version,", but current version is v").concat(pA.vega,"."))),y.classList.add("vega-embed"),h&&y.classList.add("has-actions"),y.innerHTML="",N=y,h&&((P=document.createElement("div")).classList.add(xZe),y.appendChild(P),N=P),(j=c.patch)&&(T=j instanceof Function?j(T):nD(T,j,!0,!1).newDocument),c.formatLocale&&lf.formatLocale(c.formatLocale),c.timeFormatLocale&&lf.timeFormatLocale(c.timeFormatLocale),x=lf.parse(T,"vega-lite"===E?{}:f,{ast:A=c.ast}),(S=new(c.viewClass||lf.View)(x,af({loader:d,logLevel:m,renderer:g},A?{expr:null!==(l=null!==(u=lf.expressionInterpreter)&&void 0!==u?u:c.expr)&&void 0!==l?l:kHe}:{}))).addSignalListener("autosize",(Mt,et)=>{var Ve=et.type;"fit-x"==Ve?(N.classList.add("fit-x"),N.classList.remove("fit-y")):"fit-y"==Ve?(N.classList.remove("fit-x"),N.classList.add("fit-y")):"fit"==Ve?N.classList.add("fit-x","fit-y"):N.classList.remove("fit-x","fit-y")}),!1!==c.tooltip&&(I=AZe(c.tooltip)?c.tooltip:new Ple(!0===c.tooltip?{}:c.tooltip).call,S.tooltip(I)),void 0===(M=c.hover)&&(M="vega"===E),M&&S.hover((L="boolean"==typeof M?{}:M).hoverSet,L.updateSet),c&&(null!=c.width&&S.width(c.width),null!=c.height&&S.height(c.height),null!=c.padding&&S.padding(c.padding)),Je.next=36,S.initialize(N,c.bind).runAsync();case 36:if(!1!==h){if(z=y,!1!==c.defaultStyle&&(($=document.createElement("details")).title=p.CLICK_TO_VIEW_ACTIONS,y.append($),z=$,(Y=document.createElement("summary")).innerHTML=SZe,$.append(Y),U=Mt=>{$.contains(Mt.target)||$.removeAttribute("open")},document.addEventListener("click",U)),ie=document.createElement("div"),z.append(ie),ie.classList.add("vega-actions"),!0===h||!1!==h.export)for(K=function(){var et=G[le];if(!0===h||!0===h.export||h.export[et]){var Ve=p["".concat(et.toUpperCase(),"_ACTION")],se=document.createElement("a");se.text=Ve,se.href="#",se.target="_blank",se.download="".concat(_,".").concat(et),se.addEventListener("mousedown",function(){var jt=tA(uu.mark(function Mi(ho){return uu.wrap(function(Ts){for(;;)switch(Ts.prev=Ts.next){case 0:return ho.preventDefault(),Ts.next=3,S.toImageURL(et,c.scaleFactor);case 3:this.href=Ts.sent;case 5:case"end":return Ts.stop()}},Mi,this)}));return function(Mi){return jt.apply(this,arguments)}}()),ie.append(se)}},le=0,G=["svg","png"];le<G.length;le++)K();(!0===h||!1!==h.source)&&((Q=document.createElement("a")).text=p.SOURCE_ACTION,Q.href="#",Q.addEventListener("click",function(Mt){var et,Ve;pue(wN()(n),null!==(et=c.sourceHeader)&&void 0!==et?et:"",null!==(Ve=c.sourceFooter)&&void 0!==Ve?Ve:"",E),Mt.preventDefault()}),ie.append(Q)),"vega-lite"===E&&(!0===h||!1!==h.compiled)&&((te=document.createElement("a")).text=p.COMPILED_ACTION,te.href="#",te.addEventListener("click",function(Mt){var et,Ve;pue(wN()(T),null!==(et=c.sourceHeader)&&void 0!==et?et:"",null!==(Ve=c.sourceFooter)&&void 0!==Ve?Ve:"","vega"),Mt.preventDefault()}),ie.append(te)),(!0===h||!1!==h.editor)&&(he=null!==(q=c.editorUrl)&&void 0!==q?q:"https://vega.github.io/editor/",(ve=document.createElement("a")).text=p.EDITOR_ACTION,ve.href="#",ve.addEventListener("click",function(Mt){XQe(window,he,{config:f,mode:E,renderer:g,spec:wN()(n)}),Mt.preventDefault()}),ie.append(ve))}return Je.abrupt("return",{view:S,spec:n,vgSpec:T,finalize:Ne,embedOptions:c});case 38:case"end":return Je.stop()}},e)})),OB.apply(this,arguments)}let v0=(()=>{class e{constructor(){this.wikirateApiHost="https://wikirate.org"}drawPieChart(n,i,r,s,o,a,l,u){var c=JSON.parse(JSON.stringify(Gxe));return c.description=n,c.data[0].values=r,c.width=s,c.height=o,c.scales[0].range=a,c.scales[0].domain=l,uf(i,c,u)}drawPieCustomChart(n,i,r,s,o,a,l,u,c,d){let f=JSON.parse(JSON.stringify(Wxe)),h=f.data;return h.unshift({name:"answers",url:`${this.wikirateApiHost}/~${s}+answer/answer_list.json?limit=0&filter[year]=${o}`,transform:[{type:"lookup",from:"assessed",key:"company",fields:["company"],values:["value"],as:["assessed"]},{type:"filter",expr:"datum.assessed === 'Yes'"},{type:"formula",as:"value",expr:"test(/beyond tier 1/, datum.value)? 'beyond tier 1': 'direct'"}]}),h.unshift({name:"assessed",url:`${this.wikirateApiHost}/~${r}+Answer.json?view=answer_list&limit=0&filter[year]=${o}`}),f.data=h,f.description=n,f.width=a,f.height=l,f.scales[0].range=u,f.scales[0].domain=c,console.log(f),uf(i,f,d)}drawMinimumRequirementsBarChart(n,i,r,s,o,a,l,u,c){let d=JSON.parse(JSON.stringify(Rq)),f=[];f.push({name:"assessed",url:`${this.wikirateApiHost}/~${o}+Answer.json?view=answer_list&limit=0&filter[year]=${l}&filter[company_group]=${u}`,transform:[{type:"formula",as:"key",expr:"datum.company + ',' + datum.year"}]});let h=[];for(let p of a){h.push(p.short_label);let g="[";for(let m of p.filter_value)g+="'"+m+"',";g=g.substring(0,g.length-1)+"]",f.push({name:p.short_label,url:`${this.wikirateApiHost}/~${p.id}+answer/answer_list.json?limit=0&filter[year]=${l}&filter[company_group]=${u}`,transform:[{type:"formula",as:"key",expr:"datum.company + ',' + datum.year"},{type:"lookup",from:"assessed",key:"key",fields:["key"],values:["value"],as:["assessed"]},{type:"filter",expr:"datum.assessed == 'Yes'"},{type:"formula",as:"accepted_value",expr:"indexof("+g+", datum.value) >= 0"},{type:"aggregate",groupby:["accepted_value"]},{type:"impute",key:"accepted_value",keyvals:[!0],field:"count",value:0},{type:"joinaggregate",fields:["count"],ops:["sum"]},{type:"filter",expr:"datum.accepted_value == true"}]})}f.push({name:"metrics",values:a}),f.push({name:"counts",source:h,transform:[{type:"window",ops:["row_number"],as:["seq"]},{type:"lookup",from:"metrics",key:"seq",fields:["seq"],values:["label","metric","color","filter_value"],as:["title","wikirate_page","color","filter_value"]},{type:"formula",expr:"datum.count/datum.sum_count",as:"percentage"},{type:"formula",expr:"format(datum.count / datum.sum_count, '.0%')",as:"percent_label"},{type:"formula",expr:"datum.count + ' out of ' + datum.sum_count + ' statements'",as:"count_label"},{type:"formula",expr:"{ value: datum.filter_value }",as:"filter"}]}),d.description=n,d.data=f,d.width=r,d.height=s,uf(i,d,c)}drawSubgroupsBarChart(n,i,r,s,o,a,l,u,c,d){let f=JSON.parse(JSON.stringify(Kxe)),h=[];return h.push({name:"assessed",url:`${this.wikirateApiHost}/~${s}+Answer.json?view=answer_list&limit=0&filter[year]=${u}&filter[company_group]=${c}`,transform:[{type:"formula",as:"key",expr:"datum.company + ',' + datum.year"}]}),h.push({name:"answers",url:`${this.wikirateApiHost}/~${o}+Answer.json?view=answer_list&limit=0&filter[year]=${u}&filter[company_group]=${c}`,transform:[{type:"formula",as:"key",expr:"datum.company + ',' + datum.year"},{type:"lookup",from:"assessed",key:"key",fields:["key"],values:["value"],as:["assessed"]},{type:"filter",expr:"datum.value != '' && datum.assessed == 'Yes'"},{type:"formula",expr:"split(datum.value, ', ')",as:"value_array"}]}),h.push(a),h.push(l),h.push(f.data[4]),f.description=n,f.data=h,f.width=r,uf(i,f,d)}drawBarChart(n,i,r,s,o,a,l,u,c){let d=JSON.parse(JSON.stringify(Rq)),f=[];f.push({name:"assessed",url:`${this.wikirateApiHost}/~${o}+Answer.json?view=answer_list&limit=0&filter[year]=${l}&filter[company_group]=${u}`,transform:[{type:"formula",as:"key",expr:"datum.company + ',' + datum.year"}]}),f.push({name:"answers",url:`${this.wikirateApiHost}/~${a[0].id}+answer/answer_list.json?limit=0&filter[year]=${l}&filter[company_group]=${u}`});let h=[];for(let p of a){h.push(p.short_label);let g="[";for(let m of p.filter_value)g+="'"+m+"',";g=g.substring(0,g.length-1)+"]",f.push({name:p.short_label,source:["answers"],transform:[{type:"formula",as:"key",expr:"datum.company + ',' + datum.year"},{type:"lookup",from:"assessed",key:"key",fields:["key"],values:["value"],as:["assessed"]},{type:"filter",expr:"datum.assessed == 'Yes'"},{type:"formula",as:"accepted_value",expr:"indexof("+g+", datum.value) >= 0"},{type:"aggregate",groupby:["accepted_value"]},{type:"impute",key:"accepted_value",keyvals:[!0],field:"count",value:0},{type:"joinaggregate",fields:["count"],ops:["sum"]},{type:"filter",expr:"datum.accepted_value == true"}]})}return f.push({name:"metrics",values:a}),f.push({name:"counts",source:h,transform:[{type:"window",ops:["row_number"],as:["seq"]},{type:"lookup",from:"metrics",key:"seq",fields:["seq"],values:["label","metric","color","filter_value"],as:["title","wikirate_page","color","filter_value"]},{type:"formula",expr:"datum.count/datum.sum_count",as:"percentage"},{type:"formula",expr:"format(datum.count / datum.sum_count, '.0%')",as:"percent_label"},{type:"formula",expr:"datum.count + ' out of ' + datum.sum_count + ' statements'",as:"count_label"},{type:"formula",expr:"{ value: datum.filter_value }",as:"filter"}]}),d.description=n,d.data=f,d.width=r,d.height=s,uf(i,d,c)}drawPieChartGroups(n,i,r,s,o,a,l,u,c,d){var f=JSON.parse(JSON.stringify(Yxe));let h={},p="";for(let g in o)h["color_"+g]=o[g],p+="colors.color_"+g+", ";return p="["+p.substring(0,p.length-2)+"]",f.signals[0].value=h,f.description=n,f.data[0].values=a,f.data.unshift({name:"answers",url:`${this.wikirateApiHost}/~${s}+Answer.json?view=answer_list&limit=0&filter[year]=${i}`,transform:[{type:"formula",as:"key",expr:"datum.company + ',' + datum.year"},{type:"lookup",from:"assessed",key:"key",fields:["key"],values:["value"],as:["assessed"]},{type:"filter",expr:"datum.assessed == 'Yes'"}]}),f.data.unshift({name:"assessed",url:`${this.wikirateApiHost}/~${r}+Answer.json?view=answer_list&limit=0&filter[year]=${i}`,transform:[{type:"formula",as:"key",expr:"datum.company + ',' + datum.year"}]}),f.width=u,f.height=c,f.scales[0].range=o,f.scales[0].range.signal=p,uf(l,f,d)}uk_legislation_tree_map(n,i,r,s,o){var a=JSON.parse(JSON.stringify(Jxe));return a.data[0].values=n,uf(i,a,o)}both_legislations_tree_map(n,i,r,s,o){var a=JSON.parse(JSON.stringify(Xxe));return a.data[0].values=n,console.log(JSON.stringify(a)),uf(i,a,o)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();function IZe(e,t){1&e&&(k(0,"div",13)(1,"div",14)(2,"div",15)(3,"span",16),B(4,"Loading..."),F()()()())}let RZe=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartService=i,this.year="",this.legislation="both",this.isLoading=!0}ngOnInit(){this.updateData()}updateData(){if("both"==this.legislation){this.isLoading=!0;let n=0,i=0,r=0,s=0;this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new re("year",this.year),new re("value","Yes")]).subscribe(o=>{this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new re("year",this.year),new re("company_group","MSA Garment"),new re("value","Yes")]).subscribe(a=>{this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new re("year",this.year),new re("company_group","MSA Financial"),new re("value","Yes")]).subscribe(l=>{this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new re("year",this.year),new re("company_group","MSA Hospitality"),new re("value","Yes")]).subscribe(u=>{this.dataProvider.getAnswers(this.dataProvider.metrics.meet_uk_min_requirements,[new re("year",this.year),new re("value","Yes")]).subscribe(c=>{this.dataProvider.getAnswers(this.dataProvider.metrics.meet_aus_min_requirements,[new re("year",this.year),new re("value","Yes")]).subscribe(d=>{for(let h of o)(c.findIndex(p=>p.company===h.company&&p.year===h.year)>=0||d.findIndex(p=>p.company===h.company&&p.year===h.year)>=0)&&a.findIndex(p=>p.company===h.company&&p.year===h.year)>=0?n++:(c.findIndex(p=>p.company===h.company&&p.year===h.year)>=0||d.findIndex(p=>p.company===h.company&&p.year===h.year)>=0)&&l.findIndex(p=>p.company===h.company&&p.year===h.year)>=0?i++:(c.findIndex(p=>p.company===h.company&&p.year===h.year)>=0||d.findIndex(p=>p.company===h.company&&p.year===h.year)>=0)&&u.findIndex(p=>p.company===h.company&&p.year===h.year)>=0?r++:(c.findIndex(p=>p.company===h.company&&p.year===h.year)>=0||d.findIndex(p=>p.company===h.company&&p.year===h.year)>=0)&&s++;let f=[{name:"Statements",id:0},{name:"Garment Sector",id:1,parent:0},{name:"Financial Sector",id:2,parent:0},{name:"Hospitality Sector",id:3,parent:0},{name:"Other",id:4,parent:0},{id:5,name:"Meet Minimum Requirements",size:n,parent:1},{id:6,name:"Do Not Meet Minimum Requirements",size:a.length-n,parent:1},{id:7,name:"Meet Minimum Requirements",size:i,parent:2},{id:8,name:"Do Not Meet Minimum Requirements",size:l.length-i,parent:2},{id:9,name:"Meet Minimum Requirements",size:r,parent:3},{id:10,name:"Do Not Meet Minimum Requirements",size:u.length-r,parent:3},{id:11,name:"Meet Minimum Requirements",size:s,parent:4},{id:12,name:"Do Not Meet Minimum Requirements",size:o.length-a.length-l.length-u.length-s,parent:4}];console.log(JSON.stringify(f)),this.chartService.both_legislations_tree_map(f,"div#tree-map",0,0,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.isLoading=!1})})})})})})})}else if("uk"===this.legislation){this.isLoading=!0;let n=0,i=0,r=0,s=0,o=0,a=0,l=0,u=0,c=0,d=0,f=0,h=0,p=0,g=0,m=0,_=0,y=0,v=0,b=0,D=0,C=0,w=0,E=0,T=0,O=0,N=0,P=0,j=0,A=0,x=0,S=0,I=0,M=0,L=0,R=0,V=0,U=0,z=0,$=0,Y=0,ie=0,K=0,le=0,G=0,Q=0,te=0,q=0,he=0;this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new re("year",this.year),new re("value","Yes")]).subscribe(ve=>{this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new re("year",this.year),new re("company_group","MSA Garment"),new re("value","Yes")]).subscribe(Ne=>{this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new re("year",this.year),new re("company_group","MSA Financial"),new re("value","Yes")]).subscribe(Ce=>{this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new re("year",this.year),new re("company_group","MSA Hospitality"),new re("value","Yes")]).subscribe(Te=>{this.dataProvider.getAnswers(this.dataProvider.metrics.meet_uk_min_requirements,[new re("year",this.year),new re("value","Yes")]).subscribe(Je=>{this.dataProvider.getAnswers(this.dataProvider.metrics.turnover_range,[new re("year","latest")]).subscribe(Mt=>{for(let Ve of ve){let se=Mt.find(jt=>jt.company===Ve.company);Ne.findIndex(jt=>jt.company===Ve.company&&jt.year===Ve.year)>=0?Je.findIndex(jt=>jt.company===Ve.company&&jt.year===Ve.year)>=0?void 0!==se&&"Under \xa336 million"===se.value?n++:void 0!==se&&"\xa336 million to \xa360 million"===se.value?i++:void 0!==se&&"\xa360 million to \xa3100 million"===se.value?r++:void 0!==se&&"\xa3100 million to \xa3500 million"===se.value?s++:void 0!==se&&"Over \xa3500 million"===se.value?o++:a++:void 0!==se&&"Under \xa336 million"===se.value?l++:void 0!==se&&"\xa336 million to \xa360 million"===se.value?u++:void 0!==se&&"\xa360 million to \xa3100 million"===se.value?c++:void 0!==se&&"\xa3100 million to \xa3500 million"===se.value?d++:void 0!==se&&"Over \xa3500 million"===se.value?f++:h++:Ce.findIndex(jt=>jt.company===Ve.company&&jt.year===Ve.year)>=0?Je.findIndex(jt=>jt.company===Ve.company&&jt.year===Ve.year)>=0?void 0!==se&&"Under \xa336 million"===se.value?p++:void 0!==se&&"\xa336 million to \xa360 million"===se.value?g++:void 0!==se&&"\xa360 million to \xa3100 million"===se.value?m++:void 0!==se&&"\xa3100 million to \xa3500 million"===se.value?_++:void 0!==se&&"Over \xa3500 million"===se.value?y++:v++:void 0!==se&&"Under \xa336 million"===se.value?b++:void 0!==se&&"\xa336 million to \xa360 million"===se.value?D++:void 0!==se&&"\xa360 million to \xa3100 million"===se.value?C++:void 0!==se&&"\xa3100 million to \xa3500 million"===se.value?w++:void 0!==se&&"Over \xa3500 million"===se.value?E++:T++:Te.findIndex(jt=>jt.company===Ve.company&&jt.year===Ve.year)>=0?Je.findIndex(jt=>jt.company===Ve.company&&jt.year===Ve.year)>=0?void 0!==se&&"Under \xa336 million"===se.value?O++:void 0!==se&&"\xa336 million to \xa360 million"===se.value?N++:void 0!==se&&"\xa360 million to \xa3100 million"===se.value?P++:void 0!==se&&"\xa3100 million to \xa3500 million"===se.value?j++:void 0!==se&&"Over \xa3500 million"===se.value?A++:x++:void 0!==se&&"Under \xa336 million"===se.value?S++:void 0!==se&&"\xa336 million to \xa360 million"===se.value?I++:void 0!==se&&"\xa360 million to \xa3100 million"===se.value?M++:void 0!==se&&"\xa3100 million to \xa3500 million"===se.value?L++:void 0!==se&&"Over \xa3500 million"===se.value?R++:V++:Je.findIndex(jt=>jt.company===Ve.company&&jt.year===Ve.year)>=0?void 0!==se&&"Under \xa336 million"===se.value?U++:void 0!==se&&"\xa336 million to \xa360 million"===se.value?z++:void 0!==se&&"\xa360 million to \xa3100 million"===se.value?$++:void 0!==se&&"\xa3100 million to \xa3500 million"===se.value?Y++:void 0!==se&&"Over \xa3500 million"===se.value?ie++:K++:void 0!==se&&"Under \xa336 million"===se.value?le++:void 0!==se&&"\xa336 million to \xa360 million"===se.value?G++:void 0!==se&&"\xa360 million to \xa3100 million"===se.value?Q++:void 0!==se&&"\xa3100 million to \xa3500 million"===se.value?te++:void 0!==se&&"Over \xa3500 million"===se.value?q++:he++}this.chartService.uk_legislation_tree_map([{name:"Statements",id:0,alt_name:"Statements"},{name:"Garment Sector",id:1,parent:0,alt_name:"Garment Sector"},{name:"Financial Sector",id:2,parent:0,alt_name:"Financial Sector"},{name:"Hospitality Sector",id:3,parent:0,alt_name:"Hospitality Sector"},{name:"Other",id:4,parent:0,alt_name:"Other"},{id:5,name:"<\xa336M",alt_name:"<\xa336M Garment Sector",parent:1},{id:6,name:"\xa336M-\xa360M",alt_name:"\xa336M-\xa360M Garment Sector",parent:1},{id:7,name:"\xa360M-\xa3100M",alt_name:"\xa360M-\xa3100M Garment Sector",parent:1},{id:8,name:"\xa3100M-\xa3500M",alt_name:"\xa3100M-\xa3500M Garment Sector",parent:1},{id:9,name:">\xa3500M",alt_name:">\xa3500M Garment Sector",parent:1},{id:10,name:"Unknown",alt_name:"Unknown Garment Sector",parent:1},{id:11,name:"<\xa336M",alt_name:"<\xa336M Financial Sector",parent:2},{id:12,name:"\xa336M-\xa360M",alt_name:"\xa336M-\xa360M Financial Sector",parent:2},{id:13,name:"\xa360M-\xa3100M",alt_name:"\xa360M-\xa3100M Financial Sector",parent:2},{id:14,name:"\xa3100M-\xa3500M",alt_name:"\xa3100M-\xa3500M Financial Sector",parent:2},{id:15,name:">\xa3500M",alt_name:">\xa3500M Financial Sector",parent:2},{id:16,name:"Unknown",alt_name:"Unknown Financial Sector",parent:2},{id:17,name:"<\xa336M",alt_name:"<\xa336M Hospitality Sector",parent:3},{id:18,name:"\xa336M-\xa360M",alt_name:"\xa336M-\xa360M Hospitality Sector",parent:3},{id:19,name:"\xa360M-\xa3100M",alt_name:"\xa360M-\xa3100M Hospitality Sector",parent:3},{id:20,name:"\xa3100M-\xa3500M",alt_name:"\xa3100M-\xa3500M Hospitality Sector",parent:3},{id:21,name:">\xa3500M",alt_name:">\xa3500M Hospitality Sector",parent:3},{id:22,name:"Unknown",alt_name:"Unknown Hospitality Sector",parent:3},{id:23,name:"<\xa336M",alt_name:"<\xa336M Other",parent:4},{id:24,name:"\xa336M-\xa360M",alt_name:"\xa336M-\xa360M Other",parent:4},{id:25,name:"\xa360M-\xa3100M",alt_name:"\xa360M-\xa3100M Other",parent:4},{id:26,name:"\xa3100M-\xa3500M",alt_name:"\xa3100M-\xa3500M Other",parent:4},{id:27,name:">\xa3500M",alt_name:">\xa3500M Other",parent:4},{id:28,name:"Unknown",alt_name:"Unknown Other",parent:4},{id:29,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:5,size:n},{id:30,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:5,size:l},{id:31,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:6,size:i},{id:32,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:6,size:u},{id:33,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:7,size:r},{id:34,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:7,size:c},{id:35,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:8,size:s},{id:36,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:8,size:d},{id:37,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:9,size:o},{id:38,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:9,size:f},{id:39,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:10,size:a},{id:40,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:10,size:h},{id:41,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:11,size:p},{id:42,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:11,size:b},{id:43,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:12,size:g},{id:44,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:12,size:D},{id:45,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:13,size:m},{id:46,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:13,size:C},{id:47,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:14,size:_},{id:48,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:14,size:w},{id:49,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:15,size:y},{id:50,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:15,size:E},{id:51,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:16,size:v},{id:52,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:16,size:T},{id:53,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:17,size:O},{id:54,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:17,size:S},{id:55,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:18,size:N},{id:56,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:18,size:I},{id:57,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:19,size:P},{id:58,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:19,size:M},{id:59,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:20,size:j},{id:60,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:20,size:L},{id:61,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:21,size:A},{id:62,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:21,size:R},{id:63,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:22,size:x},{id:64,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:22,size:V},{id:65,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:23,size:U},{id:66,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:23,size:le},{id:67,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:24,size:z},{id:68,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:24,size:G},{id:69,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:25,size:$},{id:70,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:25,size:Q},{id:71,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:26,size:Y},{id:72,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:26,size:te},{id:73,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:27,size:ie},{id:74,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:27,size:q},{id:75,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:28,size:K},{id:76,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:28,size:he}],"div#tree-map",0,0,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.isLoading=!1})})})})})})})}else alert("Under Construction...")}}return e.\u0275fac=function(n){return new(n||e)(H(ml),H(v0))},e.\u0275cmp=bn({type:e,selectors:[["treemap"]],inputs:{sector:"sector"},decls:36,vars:16,consts:[[1,"section","mt-5","bg-neutral-orange","p-4"],[1,"row"],[1,"col-md-4"],[1,"title"],[1,"col-md-8","ms-md-auto"],[1,"row","ps-3","pe-3","pt-md-0","pt-2"],["aria-label","Default select example",1,"msa-form-select","bg-neutral-orange","ms-md-auto","me-3","mb-md-0","mb-1",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],["aria-label","Default select example",1,"msa-form-select","bg-neutral-orange",3,"ngModel","ngModelChange","change"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row","text-center","pt-4",3,"ngClass"],["id","tree-map",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(k(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),B(4,"Statements Overview"),F()(),k(5,"div",4)(6,"div",5)(7,"select",6),Fe("ngModelChange",function(s){return i.year=s})("change",function(){return i.updateData()}),k(8,"option",7),B(9,"all years"),F(),k(10,"option",7),B(11,"latest"),F(),k(12,"option",8),B(13,"2021"),F(),k(14,"option",8),B(15,"2020"),F(),k(16,"option",8),B(17,"2019"),F(),k(18,"option",8),B(19,"2018"),F(),k(20,"option",8),B(21,"2017"),F(),k(22,"option",8),B(23,"2016"),F(),k(24,"option",8),B(25,"2015"),F()(),k(26,"select",9),Fe("ngModelChange",function(s){return i.legislation=s})("change",function(){return i.updateData()}),k(27,"option",7),B(28,"Legislation"),F(),k(29,"option",8),B(30,"UK MSA"),F(),k(31,"option",8),B(32,"AUS MSA"),F()()()()(),je(33,IZe,5,0,"div",10),k(34,"div",11),dt(35,"div",12),F()()),2&n&&(W(7),X("ngModel",i.year),W(1),X("ngValue",""),W(2),X("ngValue","latest"),W(2),X("ngValue",2021),W(2),X("ngValue",2020),W(2),X("ngValue",2019),W(2),X("ngValue",2018),W(2),X("ngValue",2017),W(2),X("ngValue",2016),W(2),X("ngValue",2015),W(2),X("ngModel",i.legislation),W(1),X("ngValue","both"),W(2),X("ngValue","uk"),W(2),X("ngValue","aus"),W(2),X("ngIf",i.isLoading),W(1),X("ngClass",i.isLoading?"hide-element":"show-element"))},directives:[Iu,Ff,jc,Pf,Lf,Fr,hl],styles:[""]}),e})();const FZe=JSON.parse('[{"seq":1,"id":1831852,"metric":"Business_Human_Rights_Resource_Centre+MSA_statement_signed","label":"Signed by Appropriate Person","short_label":"signed","color":0,"filter_value":["Signed by CEO","Signed by Director","Signed by Managing Director","Signed by Chairman"]},{"seq":2,"id":1827915,"metric":"Business_Human_Rights_Resource_Centre+MSA_Statement_Approval","label":"Board Approval","short_label":"approved","color":0,"filter_value":["Approved by Board"]},{"seq":3,"id":7046195,"metric":"Walk Free+MSA statement homepage link","label":"Homepage Link","short_label":"homepage","color":0,"filter_value":["Yes"]}]'),PZe=JSON.parse('[{"seq":1,"id":1831852,"metric":"Business_Human_Rights_Resource_Centre+MSA_statement_signed","label":"Signed by Appropriate Person","short_label":"signed","color":0,"filter_value":["Signed by CEO","Signed by Director","Signed by Managing Director","Signed by Chairman"]},{"seq":2,"id":1827915,"metric":"Business_Human_Rights_Resource_Centre+MSA_Statement_Approval","label":"Board Approval","short_label":"approved","color":0,"filter_value":["Approved by Board"]},{"seq":3,"id":12621116,"metric":"Walk_Free+Australian_MSA_Registry_Submission","label":"Registry Submission","short_label":"registry_submission","color":0,"filter_value":["Yes"]},{"seq":4,"id":5454264,"metric":"Walk_Free+MSA_registry_submission","label":"Organizational Structure and Operations","short_label":"organizational_structure","color":0,"filter_value":["Yes"]},{"seq":5,"id":1831908,"metric":"Walk_Free+MSA_supply_chain_disclosure","label":"Supply Chain Disclosure","short_label":"supply_chain_disclosure","color":0,"filter_value":["Geographical","Facility/Supplier"]},{"seq":6,"id":1831932,"metric":"Walk_Free+MSA_Identification_of_risks","label":"Identification of Risks","short_label":"risk_identification","color":0,"filter_value":["Geographic","Resource","Workforce","Industry"]},{"seq":7,"id":2722223,"metric":"Walk_Free+MSA_risk_assessment","label":"Risk Assessment","short_label":"risk_assessment","color":0,"filter_value":["Risk-based questionnaires","Use of risk management tool or software","Conducting desk research"]},{"seq":8,"id":2722169,"metric":"Walk_Free+MSA_risk_management","label":"Risk Management","short_label":"risk_management","color":0,"filter_value":["Audits of suppliers (self- reporting)","Audits of suppliers (independent)","On-site visits (self- reporting)","On-site visits (independent)"]},{"seq":9,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"Incidents Remediation","short_label":"incident_remediation","color":0,"filter_value":["Worker remediation","Corrective action plan","Senior management","Cancel contracts"]},{"seq":10,"id":2722458,"metric":"Walk_Free+MSA_whistleblowing_mechanism_revised","label":"Whistleblowing mechanism","short_label":"whistleblowing_mechanism","color":0,"filter_value":["Hotline, Email, Contact Form (direct employees)","Hotline, Email, Contact Form (supply chain workers)","Whistleblower protection (direct employees)","Whistleblower protection (supply chain workers)","Focal Point (direct employees)","Focal Point (supply chain workers)"]},{"seq":11,"id":1832024,"metric":"Walk_Free+MSA_Performance_Indicators","label":"Key Performance Indicators","short_label":"kpis","color":0,"filter_value":["Yes"]},{"seq":12,"id":8772491,"metric":"Walk_Free+MSA_Consultation_Process","label":"Consultation Process","short_label":"consultation_process","color":0,"filter_value":["Yes"]}]');function LZe(e,t){1&e&&(k(0,"div",22)(1,"div",23)(2,"div",24)(3,"span",25),B(4,"Loading..."),F()()()())}let jZe=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartsService=i,this.year="",this.isLoading=!0}ngOnInit(){}updateData(){let n=this.dataProvider.getCompanyGroup(this.sector);this.isLoading=!0,this.draw_minimum_requirements_pie_chart("Meet Minimun UK Requirements","div#uk-meet-min-requirements",this.dataProvider.metrics.uk_msa_statement_assessed,this.dataProvider.metrics.meet_uk_min_requirements,n),this.chartsService.drawMinimumRequirementsBarChart("Which minimum uk requirements do these companies meet?","div#uk-requirements-bars",350,200,this.dataProvider.metrics.uk_msa_statement_assessed,FZe,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}),(this.year>=2020||""==this.year||"latest"==this.year)&&(this.draw_minimum_requirements_pie_chart("Meet Minimun Australian Requirements","div#aus-meet-min-requirements",this.dataProvider.metrics.aus_msa_statement_assessed,this.dataProvider.metrics.meet_aus_min_requirements,n),this.chartsService.drawMinimumRequirementsBarChart("Which minimum aus requirements do these companies meet?","div#aus-requirements-bars",350,670,this.dataProvider.metrics.aus_msa_statement_assessed,PZe,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}))}draw_minimum_requirements_pie_chart(n,i,r,s,o){this.dataProvider.getAnswers(r,[new re("year",this.year),new re("value","Yes"),new re("company_group",o)]).subscribe(a=>{let l=a.length;this.dataProvider.getAnswers(s,[new re("year",this.year),new re("value","Yes"),new re("company_group",o)]).subscribe(u=>{u.filter(d=>a.findIndex(f=>f.company==d.company&&f.year==d.year)>=0);let c=u.length;this.chartsService.drawPieChart(n,i,[{value:"Met",count:c,sum_count:l},{value:"Not Met",count:l-c,sum_count:l}],210,180,["#000028","#FF9300"],["Not Met","Met"],{renderer:"svg",actions:{source:!1,editor:!1}})},u=>console.log(u),()=>this.isLoading=!1)})}ngOnChanges(n){this.updateData()}}return e.\u0275fac=function(n){return new(n||e)(H(ml),H(v0))},e.\u0275cmp=bn({type:e,selectors:[["minimum-requirements-section"]],inputs:{sector:"sector"},features:[xn],decls:56,vars:14,consts:[[1,"section","mt-5","bg-neutral-grey","p-4"],[1,"row"],[1,"col-md-8"],[1,"title"],[1,"col-md-4"],["aria-label","Minimum requirements year filter",1,"msa-form-select","ms-md-auto","bg-neutral-grey",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row","mt-2","justify-items-center",3,"ngClass"],[1,"p-3",3,"ngClass"],[1,"row","text-center"],[1,"row","text-center","pt-4"],["id","uk-meet-min-requirements",1,"chart-wrapper"],["id","uk-requirements-bars",1,"chart-wrapper"],[1,"row","pt-4","justify-content-center"],[1,"col-10"],[1,"quote"],[1,"bi","bi-exclamation-diamond","pe-2"],[1,"col-md-6","p-3",3,"ngClass"],["id","aus-meet-min-requirements",1,"chart-wrapper"],["id","aus-requirements-bars",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(k(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),B(4,"Meeting Minimum Requirements"),F()(),k(5,"div",4)(6,"select",5),Fe("ngModelChange",function(s){return i.year=s})("change",function(){return i.updateData()}),k(7,"option",6),B(8,"all years"),F(),k(9,"option",7),B(10,"latest"),F(),k(11,"option",7),B(12,"2021"),F(),k(13,"option",7),B(14,"2020"),F(),k(15,"option",7),B(16,"2019"),F(),k(17,"option",7),B(18,"2018"),F(),k(19,"option",7),B(20,"2017"),F(),k(21,"option",7),B(22,"2016"),F(),k(23,"option",7),B(24,"2015"),F()()()(),k(25,"div",1)(26,"p"),B(27,"Are company statements compliant with the minimum requirements under the UK or Australian Modern Slavery Act?"),F()(),je(28,LZe,5,0,"div",8),k(29,"div",9)(30,"div",10)(31,"div",11)(32,"h4"),B(33,"UK Act"),F()(),k(34,"div",12),dt(35,"div",13),F(),k(36,"div",12),dt(37,"div",14),F(),k(38,"div",15)(39,"div",16)(40,"p",17),dt(41,"i",18),k(42,"b"),B(43,"The UK legislation only requires three criteria, none of which relate to the quality or content of the statement."),F(),B(44," While there is accompanying guidance which provides suggested categories \u2013 similar to those which appear within the Australian legislation \u2013 these are not mandatory. Therefore, arguably"),k(45,"b"),B(46," the Australian legislation is stronger"),F(),B(47,", making a direct comparison of minimum compliance difficult. "),F()()()(),k(48,"div",19)(49,"div",11)(50,"h4"),B(51,"Australian Act"),F()(),k(52,"div",12),dt(53,"div",20),F(),k(54,"div",12),dt(55,"div",21),F()()()()),2&n&&(W(6),X("ngModel",i.year),W(1),X("ngValue",""),W(2),X("ngValue","latest"),W(2),X("ngValue",2021),W(2),X("ngValue",2020),W(2),X("ngValue",2019),W(2),X("ngValue",2018),W(2),X("ngValue",2017),W(2),X("ngValue",2016),W(2),X("ngValue",2015),W(5),X("ngIf",i.isLoading),W(1),X("ngClass",i.isLoading?"hide-element":"show-element"),W(1),X("ngClass",i.year>=2020||""==i.year||"latest"==i.year?"col-md-6":"col-md-12"),W(18),X("ngClass",i.year>=2020||""==i.year||"latest"==i.year?"show-element":"hide-element"))},directives:[Iu,Ff,jc,Pf,Lf,Fr,hl],styles:[""]}),e})();const BZe=JSON.parse('[{"seq":1,"id":1831852,"metric":"Business_Human_Rights_Resource_Centre+MSA_statement_signed","label":"Signed by Appropriate Person","short_label":"signed","color":0,"filter_value":["Signed by CEO","Signed by Director","Signed by Managing Director","Signed by Chairman"],"aus_color":"bg-orange","uk_color":"bg-orange"},{"seq":2,"id":1827915,"metric":"Business_Human_Rights_Resource_Centre+MSA_Statement_Approval","label":"Board Approval","short_label":"approved","color":0,"filter_value":["Approved by Board"],"aus_color":"bg-orange","uk_color":"bg-orange"},{"seq":3,"id":12552057,"metric":"Walk_Free+MSA_Statement_Publication","label":"Statement Publication","short_label":"statement_publication","color":0,"filter_value":["Yes"],"aus_color":"bg-orange","uk_color":"bg-orange"},{"seq":4,"id":8772491,"metric":"Walk_Free+MSA_Consultation_Process","label":"Consultation Process","short_label":"consultation_process","color":0,"filter_value":["Yes"],"aus_color":"bg-orange","uk_color":"bg-deep-blue"},{"seq":5,"id":5454264,"metric":"Walk_Free+MSA_registry_submission","label":"Organizational Structure and Operations","short_label":"organizational_structure","color":0,"filter_value":["Yes"],"aus_color":"bg-orange","uk_color":"bg-deep-blue"},{"seq":6,"id":1831908,"metric":"Walk_Free+MSA_supply_chain_disclosure","label":"Supply Chain Disclosure","short_label":"supply_chain_disclosure","color":0,"filter_value":["Geographical","Facility/Supplier"],"aus_color":"bg-orange","uk_color":"bg-deep-blue"},{"seq":7,"id":2722057,"metric":"Walk Free+MSA policy (revised)","label":"Supply Chain Policies","short_label":"policies","color":0,"filter_value":["Suppliers comply with laws and company\u2019s policies (direct / tier 1)","Suppliers comply with laws and company\u2019s policies (beyond tier 1)","Prohibit use of forced labour (direct / tier 1)","Prohibit use of forced labour (beyond tier 1)","Code of conduct or supplier code includes clauses on slavery and human trafficking (direct / tier 1)","Code of conduct or supplier code includes clauses on slavery and human trafficking (beyond tier 1)","Contracts include clauses on forced labour (direct / tier 1)","Contracts include clauses on forced labour (beyond tier 1)","Suppliers produce their own statement (direct / tier 1)","Suppliers produce their own statement (beyond tier 1)","Prohibit charging of recruitment fees to employee (direct / tier 1)","Prohibit charging of recruitment fees to employee (beyond tier 1)","Prohibit use of child labour (direct / tier 1)","Prohibit use of child labour (beyond tier 1)","Suppliers protect migrant workers (direct / tier 1)","Suppliers protect migrant workers (beyond tier 1)","Suppliers respect labour rights (wages / freedom of association etc) (direct / tier 1)","Suppliers respect labour rights (wages / freedom of association etc) (beyond tier 1)"],"aus_color":"bg-deep-blue","uk_color":"bg-deep-blue"},{"seq":8,"id":2722223,"metric":"Walk_Free+MSA_risk_assessment","label":"Risk Assessment","short_label":"risk_assessment","color":0,"filter_value":["Risk-based questionnaires","Use of risk management tool or software","Conducting desk research"],"aus_color":"bg-orange","uk_color":"bg-deep-blue"},{"seq":9,"id":1831932,"metric":"Walk_Free+MSA_Identification_of_risks","label":"Identification of Risks","short_label":"risk_identification","color":0,"filter_value":["Geographic","Resource","Workforce","Industry"],"aus_color":"bg-orange","uk_color":"bg-deep-blue"},{"seq":10,"id":2722169,"metric":"Walk_Free+MSA_risk_management","label":"Risk Management","short_label":"risk_management","color":0,"filter_value":["Audits of suppliers (self- reporting)","Audits of suppliers (independent)","On-site visits (self- reporting)","On-site visits (independent)"],"aus_color":"bg-orange","uk_color":"bg-deep-blue"},{"seq":11,"id":2722458,"metric":"Walk_Free+MSA_whistleblowing_mechanism_revised","label":"Whistleblowing mechanism","short_label":"whistleblowing_mechanism","color":0,"filter_value":["Hotline, Email, Contact Form (direct employees)","Hotline, Email, Contact Form (supply chain workers)","Whistleblower protection (direct employees)","Whistleblower protection (supply chain workers)","Focal Point (direct employees)","Focal Point (supply chain workers)"],"aus_color":"bg-orange","uk_color":"bg-deep-blue"},{"seq":12,"id":1831964,"metric":"Walk Free+MSA incidents identified","label":"Incidents Identification","short_label":"incident_identification","color":0,"filter_value":["Yes"],"aus_color":"bg-deep-blue","uk_color":"bg-deep-blue"},{"seq":13,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"Incidents Remediation","short_label":"incident_remediation","color":0,"filter_value":["Worker remediation","Corrective action plan","Senior management","Cancel contracts"],"aus_color":"bg-orange","uk_color":"bg-deep-blue"},{"seq":14,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Modern Slavery Training","short_label":"training","color":0,"filter_value":["Employees (all)","Procurement / purchasing","Recruitment / HR","Leadership","Suppliers","Training provided - not specified to who"],"aus_color":"bg-deep-blue","uk_color":"bg-deep-blue"},{"seq":15,"id":1832024,"metric":"Walk_Free+MSA_Performance_Indicators","label":"Key Performance Indicators","short_label":"kpis","color":0,"filter_value":["Yes"],"aus_color":"bg-orange","uk_color":"bg-deep-blue"},{"seq":16,"id":1832012,"metric":"Walk_Free+MSA_Business_Performance_Indicators","label":"Business Performance Indicators","short_label":"business_kpis","color":0,"filter_value":["Yes"],"aus_color":"bg-deep-blue","uk_color":"bg-deep-blue"}]');function $Ze(e,t){1&e&&(k(0,"div",23)(1,"div",24)(2,"div",25)(3,"span",26),B(4,"Loading..."),F()()()())}function VZe(e,t){if(1&e){const n=Bs();k(0,"tr",27)(1,"td",28)(2,"a",29),B(3),F()(),k(4,"td",30),Fe("click",function(){const s=or(n).$implicit;return Et().openURL(s.url)}),B(5),ca(6,"percentageFormat"),F(),k(7,"td",31),Fe("click",function(){const s=or(n).$implicit;return Et().openURL(s.url)}),B(8),ca(9,"percentageFormat"),F(),k(10,"td",31),Fe("click",function(){const s=or(n).$implicit;return Et().openURL(s.url)}),B(11),ca(12,"percentageFormat"),F()()}if(2&e){const n=t.$implicit;W(2),Ef("href",n.url,Bp),W(1),Ni(n.name),W(2),Ni(da(6,11,n.total)),W(2),BT("col-2 clickable text-center ",n.uk_color,""),W(1),Ni(da(9,13,n.uk)),W(2),BT("col-2 clickable text-center ",n.aus_color,""),W(1),Ni(da(12,15,n.aus))}}const gA=function(e){return{active:e}};let HZe=(()=>{class e{constructor(n){this.dataProvider=n,this.year="",this.beyond_compliance_table_data=[],this.active="name",this.isLoading=!0,this.garment_avg_disclosure_rate=0,this.financial_avg_disclosure_rate=0,this.hospitality_avg_disclosure_rate=0}ngOnInit(){}updateBeyondComplianceTable(){this.active="name",this.beyond_compliance_table_data=[],this.isLoading=!0;let n=this.dataProvider.getCompanyGroup(this.sector);this.dataProvider.getAnswers(this.dataProvider.metrics.uk_msa_statement_assessed,[new re("year",this.year),new re("value","Yes"),new re("company_group",n)]).subscribe(i=>{let r=i.map(s=>({company:s.company,year:s.year}));this.dataProvider.getAnswers(this.dataProvider.metrics.aus_msa_statement_assessed,[new re("year",this.year),new re("value","Yes"),new re("company_group",n)]).subscribe(s=>{let o=s.map(l=>({company:l.company,year:l.year})),a=[...new Set([...r,...o])];a=a.filter((l,u,c)=>u===c.findIndex(d=>d.company===l.company&&d.year===l.year));for(let l of BZe)this.dataProvider.getAnswers(l.id,[new re("year",this.year),new re("value",l.filter_value)]).subscribe(u=>{let c=0,d=0,f=0;for(let _ of u){let y=void 0!==r.find(b=>b.company==_.company&&b.year==_.year),v=void 0!==o.find(b=>b.company==_.company&&b.year==_.year);y&&c++,v&&d++,(y||v)&&f++}let h=Math.round(100*c/r.length),p=Math.round(100*d/o.length),g=Math.round(100*f/a.length),m="";for(let _ of l.filter_value)m+="filter[value][]="+_+"&";this.beyond_compliance_table_data.push("Consultation Process"==l.label?{name:l.label,url:"https://wikirate.org/"+l.metric+"?filter[year]="+this.year+"&"+m.substring(0,m.length+1),uk:"N/A",aus:p,total:"N/A",aus_color:l.aus_color,uk_color:l.uk_color}:{name:l.label,url:"https://wikirate.org/"+l.metric+"?filter[year]="+this.year+"&"+m.substring(0,m.length+1),uk:h,aus:p,total:g,aus_color:l.aus_color,uk_color:l.uk_color})});setTimeout(()=>{this.isLoading=!1},1e3)})})}sort(n){this.beyond_compliance_table_data.sort((i,r)=>"N/A"==r[n]||i[n]>r[n]?-1:1),this.active=n}openURL(n){window.open(n,"_blank")}ngOnChanges(n){this.updateBeyondComplianceTable()}}return e.\u0275fac=function(n){return new(n||e)(H(ml))},e.\u0275cmp=bn({type:e,selectors:[["going-beyond-compliance"]],inputs:{sector:"sector"},features:[xn],decls:56,vars:25,consts:[[1,"section","mt-5","bg-neutral-orange","p-4"],[1,"row"],[1,"col-md-8"],[1,"title"],[1,"col-md-4"],["aria-label","Minimum requirements year filter",1,"msa-form-select","ms-md-auto","bg-neutral-orange",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],[1,"col-md-12"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row","p-2","row","justify-content-center",3,"ngClass"],[1,"table","table-bordered","border-light"],[1,"bg-light-orange"],["scope","col",1,"clickable-header","text-end",3,"ngClass","click"],["scope","col",1,"text-center","clickable-header","active",3,"ngClass","click"],["scope","col",1,"text-center","clickable-header",3,"ngClass","click"],["class","text-white",4,"ngFor","ngForOf"],[1,"row","ms-2"],[1,"row","p-1"],[1,"col-auto"],[1,"legend-box","bg-orange"],[1,"col-auto","no-padding"],[1,"legend-box","bg-deep-blue"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"],[1,"text-white"],[1,"col-4","text-end","bg-neutral-blue","text-deep-blue"],["target","_blank",1,"metric",3,"href"],[1,"col-2","clickable","text-center","bg-deep-blue",3,"click"],[3,"click"]],template:function(n,i){1&n&&(k(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),B(4,"Going Beyond Compliance"),F()(),k(5,"div",4)(6,"select",5),Fe("ngModelChange",function(s){return i.year=s})("change",function(){return i.updateBeyondComplianceTable()}),k(7,"option",6),B(8,"all years"),F(),k(9,"option",7),B(10,"latest"),F(),k(11,"option",7),B(12,"2021"),F(),k(13,"option",7),B(14,"2020"),F(),k(15,"option",7),B(16,"2019"),F(),k(17,"option",7),B(18,"2018"),F(),k(19,"option",7),B(20,"2017"),F(),k(21,"option",7),B(22,"2016"),F(),k(23,"option",7),B(24,"2015"),F()()(),k(25,"div",1)(26,"div",8)(27,"p"),B(28,"Beyond minimum requirements, the accompanying guidance of the MSAs outlines the measures and actions companies should take to ensure their operations and supply chains are free from exploitation. Click on a metric to find out more about what it entails. "),F()()()(),je(29,$Ze,5,0,"div",9),k(30,"div",10)(31,"div",8)(32,"table",11)(33,"thead")(34,"tr",12)(35,"th",13),Fe("click",function(){return i.sort("name")}),B(36,"Metric "),F(),k(37,"th",14),Fe("click",function(){return i.sort("total")}),B(38,"Total "),F(),k(39,"th",15),Fe("click",function(){return i.sort("uk")}),B(40,"UK "),F(),k(41,"th",15),Fe("click",function(){return i.sort("aus")}),B(42,"AUS "),F()()(),k(43,"tbody"),je(44,VZe,13,17,"tr",16),F()(),k(45,"div",17)(46,"div",18)(47,"div",19),dt(48,"div",20),F(),k(49,"div",21),B(50,"Mandatory"),F()(),k(51,"div",18)(52,"div",19),dt(53,"div",22),F(),k(54,"div",21),B(55,"Not Mandatory"),F()()()()()()),2&n&&(W(6),X("ngModel",i.year),W(1),X("ngValue",""),W(2),X("ngValue","latest"),W(2),X("ngValue",2021),W(2),X("ngValue",2020),W(2),X("ngValue",2019),W(2),X("ngValue",2018),W(2),X("ngValue",2017),W(2),X("ngValue",2016),W(2),X("ngValue",2015),W(6),X("ngIf",i.isLoading),W(1),X("ngClass",i.isLoading?"hide-element":"show-element"),W(5),X("ngClass",Oc(17,gA,"name"===i.active)),W(2),X("ngClass",Oc(19,gA,"total"===i.active)),W(2),X("ngClass",Oc(21,gA,"uk"===i.active)),W(2),X("ngClass",Oc(23,gA,"aus"===i.active)),W(3),X("ngForOf",i.beyond_compliance_table_data))},directives:[Iu,Ff,jc,Pf,Lf,Fr,hl,Mf],pipes:[Iq],styles:[".metric[_ngcontent-%COMP%]{font-size:1.2em}"]}),e})();function UZe(e,t){1&e&&(k(0,"div",15)(1,"div",16)(2,"div",17)(3,"span",18),B(4,"Loading..."),F()()()())}let zZe=(()=>{class e{constructor(n){this.dataProvider=n,this.year="",this.isLoading=!0,this.garment_avg_disclosure_rate=0,this.financial_avg_disclosure_rate=0,this.hospitality_avg_disclosure_rate=0}ngOnInit(){this.updateDisclosureRates()}updateDisclosureRates(){this.isLoading=!0,this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new re("year",this.year),new re("value","Yes"),new re("company_group","MSA Garment")]).subscribe(n=>{this.dataProvider.getAnswers(this.dataProvider.metrics.msa_disclosure_rate,[new re("year",this.year),new re("company_group","MSA Garment")]).subscribe(i=>{this.garment_avg_disclosure_rate=0,i=i.filter(r=>n.some(s=>s.company==r.company&&s.year==r.year));for(let r of i)this.garment_avg_disclosure_rate+=Number(r.value);this.garment_avg_disclosure_rate=Math.round(this.garment_avg_disclosure_rate/i.length),this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new re("year",this.year),new re("value","Yes"),new re("company_group","MSA Financial")]).subscribe(r=>{this.dataProvider.getAnswers(this.dataProvider.metrics.msa_disclosure_rate,[new re("year",this.year),new re("company_group","MSA Financial")]).subscribe(s=>{this.financial_avg_disclosure_rate=0,s=s.filter(o=>r.some(a=>a.company==o.company&&a.year==o.year));for(let o of s)this.financial_avg_disclosure_rate+=Number(o.value);this.financial_avg_disclosure_rate=Math.round(this.financial_avg_disclosure_rate/s.length)})})}),this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new re("year",this.year),new re("value","Yes"),new re("company_group","MSA Hospitality")]).subscribe(i=>{this.dataProvider.getAnswers(this.dataProvider.metrics.msa_disclosure_rate,[new re("year",this.year),new re("company_group","MSA Hospitality")]).subscribe(r=>{this.hospitality_avg_disclosure_rate=0,r=r.filter(s=>i.some(o=>o.company==s.company&&o.year==s.year));for(let s of r)this.hospitality_avg_disclosure_rate+=Number(s.value);this.hospitality_avg_disclosure_rate=Math.round(this.hospitality_avg_disclosure_rate/r.length)},r=>console.log(r),()=>this.isLoading=!1)})})}openURL(n){window.open(`${this.dataProvider.wikirateApiHost}/~${this.dataProvider.metrics.msa_disclosure_rate}?filter[company_group][]=${n}&filter[year]=${this.year}`,"_blank")}}return e.\u0275fac=function(n){return new(n||e)(H(ml))},e.\u0275cmp=bn({type:e,selectors:[["disclosure-rates"]],decls:56,vars:21,consts:[[1,"section","mt-5","bg-neutral-grey","p-4"],[1,"row"],[1,"col-md-8"],[1,"title"],[1,"col-md-4"],["aria-label","Minimum requirements year filter",1,"msa-form-select","ms-md-auto","bg-neutral-grey",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],[1,"col-md-12"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"disclosure-rates",3,"ngClass"],[1,"row","justify-content-center"],[1,"number-box","m-md-3","m-1",3,"click"],[1,"msa-primary-info-md"],[1,"highlighted-number-lg"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(k(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),B(4,"Disclosure Rates"),F()(),k(5,"div",4)(6,"select",5),Fe("ngModelChange",function(s){return i.year=s})("change",function(){return i.updateDisclosureRates()}),k(7,"option",6),B(8,"all years"),F(),k(9,"option",7),B(10,"latest"),F(),k(11,"option",7),B(12,"2021"),F(),k(13,"option",7),B(14,"2020"),F(),k(15,"option",7),B(16,"2019"),F(),k(17,"option",7),B(18,"2018"),F(),k(19,"option",7),B(20,"2017"),F(),k(21,"option",7),B(22,"2016"),F(),k(23,"option",7),B(24,"2015"),F()()()(),k(25,"div",1)(26,"div",8)(27,"p"),B(28,"Average number of measures and actions reported by companies in their modern slavery statements."),F()()(),je(29,UZe,5,0,"div",9),k(30,"div",10)(31,"div",11)(32,"div",12),Fe("click",function(){return i.openURL("MSA Garment")}),k(33,"div",13)(34,"span",14),B(35),ca(36,"numFormat"),F(),B(37,"/15 "),k(38,"h5"),B(39,"Garment Industry"),F()()(),k(40,"div",12),Fe("click",function(){return i.openURL("MSA Financial")}),k(41,"div",13)(42,"span",14),B(43),ca(44,"numFormat"),F(),B(45,"/15 "),k(46,"h5"),B(47,"Financial Industry"),F()()(),k(48,"div",12),Fe("click",function(){return i.openURL("MSA Hospitality")}),k(49,"div",13)(50,"span",14),B(51),ca(52,"numFormat"),F(),B(53,"/15 "),k(54,"h5"),B(55,"Hospitality Industry"),F()()()()()()),2&n&&(W(6),X("ngModel",i.year),W(1),X("ngValue",""),W(2),X("ngValue","latest"),W(2),X("ngValue",2021),W(2),X("ngValue",2020),W(2),X("ngValue",2019),W(2),X("ngValue",2018),W(2),X("ngValue",2017),W(2),X("ngValue",2016),W(2),X("ngValue",2015),W(6),X("ngIf",i.isLoading),W(1),X("ngClass",i.isLoading?"hide-element":"show-element"),W(5),Ni(da(36,15,i.garment_avg_disclosure_rate)),W(8),Ni(da(44,17,i.financial_avg_disclosure_rate)),W(8),Ni(da(52,19,i.hospitality_avg_disclosure_rate)))},directives:[Iu,Ff,jc,Pf,Lf,Fr,hl],pipes:[kq],styles:[""]}),e})();const qZe=JSON.parse('[{"seq":1,"id":12616892,"metric":"Walk Free+MSA policy (grouped)","label":"Direct supply chain","short_label":"direct_supply_chain","color":0,"filter_value":["Direct Supply Chain","Both"]},{"seq":2,"id":12616892,"metric":"Walk Free+MSA policy (grouped)","label":"Beyond tier 1 supply chain","short_label":"beyond_t1","color":0,"filter_value":["Beyond Tier 1 Supply Chain","Both"]},{"seq":3,"id":12616892,"metric":"Walk Free+MSA policy (grouped)","label":"Both","short_label":"both","color":3,"filter_value":["Both"]},{"seq":4,"id":12616892,"metric":"Walk Free+MSA policy (grouped)","label":"None of the above","short_label":"none_of_the_above","color":1,"filter_value":["Neither","Unknown"]}]');function GZe(e,t){1&e&&(k(0,"div",6)(1,"div",7)(2,"div",8)(3,"span",9),B(4,"Loading..."),F()()()())}let WZe=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartsService=i,this.isLoading=!0}ngOnInit(){}ngOnChanges(n){this.updateData()}updateData(){let n=this.dataProvider.getCompanyGroup(this.sector);this.isLoading=!0,this.chartsService.drawBarChart("Modern Slavery Supply Chain Policies","div#modern-slavery-supply-chain-policies-alt-two",350,250,this.dataProvider.metrics.msa_statement_assessed,qZe,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>this.isLoading=!1)}}return e.\u0275fac=function(n){return new(n||e)(H(ml),H(v0))},e.\u0275cmp=bn({type:e,selectors:[["approach-to-policies-alt-two"]],inputs:{year:"year",sector:"sector"},features:[xn],decls:10,vars:2,consts:[["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row",3,"ngClass"],[1,"col-md-12"],[1,"row"],[1,"row","text-center","pt-2"],["id","modern-slavery-supply-chain-policies-alt-two",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(je(0,GZe,5,0,"div",0),k(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5"),B(5,"MODERN SLAVERY SUPPLY CHAIN POLICIES"),F(),k(6,"p"),B(7,"specifying practices thas should be adhered to be avoid exploitation"),F()(),k(8,"div",4),dt(9,"div",5),F()()()),2&n&&(X("ngIf",i.isLoading),W(1),X("ngClass",i.isLoading?"hide-element":"show-element"))},directives:[Fr,hl],styles:[""]}),e})();const YZe=JSON.parse('[{"seq":1,"id":6948985,"metric":"Walk Free+MSA risk assessment","label":"Risk-based questionnaires","short_label":"risk_based_questionnaires","color":0,"filter_value":["Risk-based questionnaires"]},{"seq":2,"id":6948985,"metric":"Walk Free+MSA risk assessment","label":"Use of risk management tool or software","short_label":"use_of_risk_mng_tool","color":0,"filter_value":["Use of risk management tool or software"]},{"seq":3,"id":6948985,"metric":"Walk Free+MSA risk assessment","label":"Conducting desk research","short_label":"desk_research","color":0,"filter_value":["Conducting research"]},{"seq":4,"id":6948985,"metric":"Walk Free+MSA risk assessment","label":"None of the above","short_label":"none_of_the_above","color":1,"filter_value":["None"]}]'),KZe=JSON.parse('[{"seq":1,"id":6949027,"metric":"Walk_Free+MSA_Identification_of_risks","label":"Geographic/Risk Region","short_label":"geographic","color":0,"filter_value":["Geographic"]},{"seq":2,"id":6949027,"metric":"Walk_Free+MSA_Identification_of_risks","label":"Industry Risk","short_label":"industry","color":0,"filter_value":["Industry"]},{"seq":3,"id":6949027,"metric":"Walk_Free+MSA_Identification_of_risks","label":"Resource Risk","short_label":"resource","color":0,"filter_value":["Resource"]},{"seq":4,"id":6949027,"metric":"Walk_Free+MSA_Identification_of_risks","label":"Workforce Risk","short_label":"workforce_risk","color":0,"filter_value":["Workforce"]},{"seq":5,"id":6949027,"metric":"Walk_Free+MSA_Identification_of_risks","label":"None of the above","short_label":"none_of_the_above","color":1,"filter_value":["None"]}]');function JZe(e,t){1&e&&(k(0,"div",10)(1,"div",11)(2,"div",12)(3,"span",13),B(4,"Loading..."),F()()()())}let XZe=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartsService=i,this.isLoading=!0}ngOnChanges(n){this.updateData()}ngOnInit(){}updateData(){let n=this.dataProvider.getCompanyGroup(this.sector);this.isLoading=!0,this.chartsService.drawBarChart("Risk Assessment","div#risk-assessment-alt-two",350,200,this.dataProvider.metrics.msa_statement_assessed,YZe,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.chartsService.drawBarChart("Risks identified by risk category","div#risk-identification-alt-two",350,250,this.dataProvider.metrics.msa_statement_assessed,KZe,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>this.chartsService.drawSubgroupsBarChart("Risks Management","div#risk-management-alt-two",350,this.dataProvider.metrics.msa_statement_assessed,6948944,{name:"subgroups",values:[{key:"(self- reporting)",label:"Self reporting",color:0,seq:1},{key:"(independent)",label:"Independent",color:1,seq:2}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},{name:"groups",values:[{title:"Audits of suppliers",term:"Audits of suppliers",seq:1},{title:"On-site visits",term:"On-site visits",seq:2},{title:"Neither",term:"Neither",seq:3}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}})).finally(()=>this.isLoading=!1)})}}return e.\u0275fac=function(n){return new(n||e)(H(ml),H(v0))},e.\u0275cmp=bn({type:e,selectors:[["approach-to-risks-alt-two"]],inputs:{year:"year",sector:"sector"},features:[xn],decls:27,vars:3,consts:[["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row",3,"ngClass"],[1,"col-md-12"],[1,"row"],[1,"row","text-center","pt-2"],["id","risk-assessment-alt-two",1,"chart-wrapper"],[1,"row","justify-content-md-center",3,"ngClass"],[1,"col-md-12","mt-4"],["id","risk-identification-alt-two",1,"chart-wrapper"],["id","risk-management-alt-two",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(je(0,JZe,5,0,"div",0),k(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5"),B(5,"RISK ASSESSMENT TOOLS"),F(),k(6,"p"),B(7,"used to identify high risk factors in operations"),F()(),k(8,"div",4),dt(9,"div",5),F()()(),k(10,"div",6)(11,"div",7)(12,"div",3)(13,"h5"),B(14,"TYPES OF RISKS IDENTIFIED"),F(),k(15,"p"),B(16,"as likely to occur within operations"),F()(),k(17,"div",4),dt(18,"div",8),F()(),k(19,"div",7)(20,"div",3)(21,"h5"),B(22,"RISK MANAGEMENT SYSTEM"),F(),k(23,"p"),B(24,"used to keep an eye on (high risk) operations"),F()(),k(25,"div",4),dt(26,"div",9),F()()()),2&n&&(X("ngIf",i.isLoading),W(1),X("ngClass",i.isLoading?"hide-element":"show-element"),W(9),X("ngClass",i.isLoading?"hide-element":"show-element"))},directives:[Fr,hl],styles:[""]}),e})();const QZe=JSON.parse('[{"seq":1,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"Worker remediation","short_label":"worker_remediation","color":0,"filter_value":["Worker remediation"]},{"seq":2,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"Incidents remediation","short_label":"corrective_action_plan","color":0,"filter_value":["Corrective action plan"]},{"seq":3,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"Senior management","short_label":"senior_management","color":0,"filter_value":["Senior management"]},{"seq":4,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"Cancel contracts","short_label":"cancel_contracts","color":0,"filter_value":["Cancel contracts"]},{"seq":5,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"None of the Above","short_label":"none_of_the_above","color":1,"filter_value":["In Development","No"]}]'),ZZe=JSON.parse('[{"seq":1,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Employees (all)","short_label":"employees","color":0,"filter_value":["Employees (all)"]},{"seq":2,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Procurement / purchasing","short_label":"procurement","color":0,"filter_value":["Procurement / purchasing"]},{"seq":3,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Recruitment / HR","short_label":"recruitment","color":0,"filter_value":["Recruitment / HR"]},{"seq":4,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Leadership","short_label":"leadership","color":0,"filter_value":["Leadership"]},{"seq":5,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Suppliers","short_label":"suppliers","color":0,"filter_value":["Suppliers"]},{"seq":6,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Training provided - not specified to who","short_label":"training_provided","color":0,"filter_value":["Training provided - not specified"]},{"seq":7,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Any of the above","short_label":"any_of_the_above","color":3,"filter_value":["Training provided - not specified","Suppliers","Leadership","Recruitment / HR","Procurement / purchasing","Employees (all)"]}]');function eet(e,t){1&e&&(k(0,"div",10)(1,"div",11)(2,"div",12)(3,"span",13),B(4,"Loading..."),F()()()())}let tet=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartsService=i,this.isLoading=!0}ngOnInit(){}ngOnChanges(n){this.updateData()}updateData(){let n=this.dataProvider.getCompanyGroup(this.sector);this.isLoading=!0,this.chartsService.drawSubgroupsBarChart("Whistleblowing or Grievance Mechanisms","div#whistleblowing-mechanisms-alt-two",300,this.dataProvider.metrics.msa_statement_assessed,2722458,{name:"subgroups",values:[{key:"(direct employees)",label:"Direct employees",color:0,seq:1},{key:"(supply chain workers)",label:"Supply chain workers",color:1,seq:2},{key:"",label:"Direct employees",color:2,seq:3}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},{name:"groups",values:[{title:"Whistleblower protection",term:"Whistleblower protection",seq:1},{title:"Hotline, Email, Contact Form",term:"Hotline",seq:2},{title:"Focal Point",term:"Focal Point",seq:3},{title:"None of the Above",term:"No",seq:3}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.chartsService.drawBarChart("Incidents Remediation","div#incident-remediation-alt-two",350,250,this.dataProvider.metrics.msa_statement_assessed,QZe,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.chartsService.drawBarChart("Modern Slavery Training","div#training-alt-two",350,350,this.dataProvider.metrics.msa_statement_assessed,ZZe,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.isLoading=!1})})})}}return e.\u0275fac=function(n){return new(n||e)(H(ml),H(v0))},e.\u0275cmp=bn({type:e,selectors:[["approach-to-incidents-alt-two"]],inputs:{year:"year",sector:"sector"},features:[xn],decls:27,vars:3,consts:[["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row",3,"ngClass"],[1,"col-md-12"],[1,"row"],[1,"row","text-center","pt-2"],["id","training-alt-two",1,"chart-wrapper"],[1,"row","justify-content-md-center",3,"ngClass"],[1,"col-md-12","mt-4"],["id","whistleblowing-mechanisms-alt-two",1,"chart-wrapper"],["id","incident-remediation-alt-two",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(je(0,eet,5,0,"div",0),k(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5"),B(5,"MODERN SLAVERY TRAINING"),F(),k(6,"p"),B(7,"provided to increase chances of staff identifying incidents and avoiding practices that increase chances of incidents occurring "),F()(),k(8,"div",4),dt(9,"div",5),F()()(),k(10,"div",6)(11,"div",7)(12,"div",3)(13,"h5"),B(14,"GRIEVANCE MECHANISMS"),F(),k(15,"p"),B(16,"provided to increase likelihood of incidents being reported"),F()(),k(17,"div",4),dt(18,"div",8),F()(),k(19,"div",7)(20,"div",3)(21,"h5"),B(22,"REMEDIATION STRATEGY"),F(),k(23,"p"),B(24,"deployed when specific incidents are identified"),F()(),k(25,"div",4),dt(26,"div",9),F()()()),2&n&&(X("ngIf",i.isLoading),W(1),X("ngClass",i.isLoading?"hide-element":"show-element"),W(9),X("ngClass",i.isLoading?"hide-element":"show-element"))},directives:[Fr,hl],styles:[""]}),e})();function net(e,t){1&e&&(k(0,"div",30)(1,"div",31)(2,"div",32)(3,"span",33),B(4,"Loading..."),F()()()())}let iet=(()=>{class e{constructor(n){this.dataProvider=n,this.year="",this.percentage_of_companies_identified_incidents=0,this.percentage_of_companies_report_policy_beyond_t1=0,this.percentage_of_companies_identified_risks=0,this.isLoading=!0}ngOnChanges(n){this.updateData()}ngOnInit(){}updateData(){let n=this.dataProvider.getCompanyGroup(this.sector);this.isLoading=!0,this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new re("year",this.year),new re("value","Yes"),new re("company_group",n)]).subscribe(i=>{this.dataProvider.getAnswers(1831964,[new re("year",this.year),new re("value","Yes"),new re("company_group",n)]).subscribe(r=>{r=r.filter(s=>i.some(o=>o.company==s.company&&o.year==s.year)),this.percentage_of_companies_identified_incidents=Math.round(100*r.length/i.length),this.dataProvider.getAnswers(6916242,[new re("year",this.year),new re("value","Yes"),new re("company_group",n)]).subscribe(s=>{s=s.filter(o=>i.some(a=>a.company==o.company&&a.year==o.year)),this.percentage_of_companies_identified_risks=Math.round(100*s.length/i.length),this.dataProvider.getAnswers(6915846,[new re("year",this.year),new re("value","Yes"),new re("company_group",n)]).subscribe(o=>{o=o.filter(a=>i.some(l=>l.company==a.company&&l.year==a.year)),this.percentage_of_companies_report_policy_beyond_t1=Math.round(100*o.length/i.length)})})},r=>{console.log(r)},()=>this.isLoading=!1)})}}return e.\u0275fac=function(n){return new(n||e)(H(ml))},e.\u0275cmp=bn({type:e,selectors:[["further-findings-alt-two"]],inputs:{sector:"sector"},features:[xn],decls:88,vars:21,consts:[[1,"section","mt-5","bg-neutral-white","p-4"],[1,"row"],[1,"col-md-8"],[1,"title"],[1,"col-md-4"],["aria-label","Minimum requirements year filter",1,"msa-form-select","ms-md-auto","bg-neutral-white",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row","dive-deeper","mt-3",3,"ngClass"],[1,"col-lg-4","mb-lg-0","mb-3"],["id","approach_to_policies",1,"accordion"],[1,"accordion-item"],["id","approachToPoliciesTitle",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#approach-to-policies-alt-two","aria-expanded","false","aria-controls","collapseThree",1,"accordion-button-white","collapsed"],[1,"row","mt-3"],[1,"msa-primary-info"],[1,"accordion-paragraph"],[1,"blue-title"],["id","approach-to-policies-alt-two","aria-labelledby","approachToPoliciesTitle","data-bs-parent","#approach_to_policies",1,"accordion-collapse","collapse"],[1,"accordion-body"],[3,"year","sector"],["id","approach_to_risks_accordion",1,"accordion"],["id","headingThree",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#ApproachToRisksAltTwo","aria-expanded","false","aria-controls","collapseThree",1,"accordion-button-white","collapsed"],["id","ApproachToRisksAltTwo","aria-labelledby","headingThree","data-bs-parent","#approach_to_risks_accordion",1,"accordion-collapse","collapse"],["id","approach_to_incidents",1,"accordion"],["id","headingApproachToIncidents",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#collapseApproachToIncidents-alt-two","aria-expanded","false","aria-controls","collapseApproachToIncidents",1,"accordion-button-white","collapsed"],["id","collapseApproachToIncidents-alt-two","aria-labelledby","headingApproachToIncidents","data-bs-parent","#approach_to_incidents",1,"accordion-collapse","collapse"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(k(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),B(4,"Further Findings"),F()(),k(5,"div",4)(6,"select",5),Fe("ngModelChange",function(s){return i.year=s})("change",function(){return i.updateData()}),k(7,"option",6),B(8,"all years"),F(),k(9,"option",7),B(10,"latest"),F(),k(11,"option",7),B(12,"2021"),F(),k(13,"option",7),B(14,"2020"),F(),k(15,"option",7),B(16,"2019"),F(),k(17,"option",7),B(18,"2018"),F(),k(19,"option",7),B(20,"2017"),F(),k(21,"option",7),B(22,"2016"),F(),k(23,"option",7),B(24,"2015"),F()()()(),je(25,net,5,0,"div",8),k(26,"div",9)(27,"div",10)(28,"div",11)(29,"div",12)(30,"div",13)(31,"div",14)(32,"div",15)(33,"div",1)(34,"div",16),B(35),F()(),k(36,"div",1)(37,"p",17),B(38,"of companies report having a modern slavery "),k(39,"b"),B(40,"policy that applies to stakeholders beyond the 1st tier"),F(),B(41," of their supply chain"),F(),k(42,"h5",18),B(43,"Policies"),F()()()()(),k(44,"div",19)(45,"div",20),dt(46,"approach-to-policies-alt-two",21),F()()()()(),k(47,"div",10)(48,"div",22)(49,"div",12)(50,"div",23)(51,"div",24)(52,"div",15)(53,"div",1)(54,"div",16),B(55),F()(),k(56,"div",1)(57,"p",17),B(58,"of companies have "),k(59,"b"),B(60,"identified risks likely to occur"),F(),B(61," within "),dt(62,"br"),F(),k(63,"h5",18),B(64,"Risks"),F()()()()(),k(65,"div",25)(66,"div",20),dt(67,"approach-to-risks-alt-two",21),F()()()()(),k(68,"div",10)(69,"div",26)(70,"div",12)(71,"div",27)(72,"div",28)(73,"div",15)(74,"div",1)(75,"div",16),B(76),F()(),k(77,"div",1)(78,"p",17),B(79,"of companies have "),k(80,"b"),B(81,"identified a specific incident of modern slavery"),F(),B(82," in their own and/or supply chain operations"),F(),k(83,"h5",18),B(84,"Incidents"),F()()()()(),k(85,"div",29)(86,"div",20),dt(87,"approach-to-incidents-alt-two",21),F()()()()()()()),2&n&&(W(6),X("ngModel",i.year),W(1),X("ngValue",""),W(2),X("ngValue","latest"),W(2),X("ngValue",2021),W(2),X("ngValue",2020),W(2),X("ngValue",2019),W(2),X("ngValue",2018),W(2),X("ngValue",2017),W(2),X("ngValue",2016),W(2),X("ngValue",2015),W(2),X("ngIf",i.isLoading),W(1),X("ngClass",i.isLoading?"hide-element":"show-element"),W(9),ua("",i.percentage_of_companies_report_policy_beyond_t1,"%"),W(11),X("year",i.year)("sector",i.sector),W(9),ua("",i.percentage_of_companies_identified_risks,"%"),W(12),X("year",i.year)("sector",i.sector),W(9),ua("",i.percentage_of_companies_identified_incidents,"%"),W(11),X("year",i.year)("sector",i.sector))},directives:[Iu,Ff,jc,Pf,Lf,Fr,hl,WZe,XZe,tet],styles:[""]}),e})(),ret=(()=>{class e{constructor(n,i){this.route=n,this.sectorProvider=i,this.sector="all-sectors"}ngOnInit(){this.route.paramMap.subscribe(n=>{let i=n.get("sector");null!==i&&i!=this.sector&&(this.sector=i),this.sectorProvider.getSector().next(i)})}}return e.\u0275fac=function(n){return new(n||e)(H(Nf),H(g2))},e.\u0275cmp=bn({type:e,selectors:[["dashboard"]],decls:8,vars:6,consts:[[1,"container"],[3,"sector"]],template:function(n,i){1&n&&(k(0,"div",0),dt(1,"introductory-section",1)(2,"key-findings-section",1)(3,"treemap",1)(4,"minimum-requirements-section",1)(5,"going-beyond-compliance",1)(6,"disclosure-rates")(7,"further-findings-alt-two",1),F()),2&n&&(W(1),X("sector",i.sector),W(1),X("sector",i.sector),W(1),X("sector",i.sector),W(1),X("sector",i.sector),W(1),X("sector",i.sector),W(2),X("sector",i.sector))},directives:[Swe,qxe,RZe,jZe,HZe,zZe,iet],styles:[""]}),e})();const set=JSON.parse('[{"metric":"Modern Slavery Act statement","url":"https://wikirate.org/Business_Human_Rights_Resource_Centre+Modern_Slavery_Statement","description":"Did the company produce a statement in relation to any Modern Slavery Act or legislation?","requirements_guidance":"If in-scope of the legislation, update your modern slavery statement every year","requirements_guidance_color":"red","requirements_criterion":"If in-scope of the legislation, update your modern slavery statement every year (p.17)","requirements_criterion_color":"red"},{"metric":"Statement publication","url":"https://wikirate.org/Walk_Free+MSA_Statement_Publication","description":"Does the company either publish their statement on their homepage (UK Act) or provide the statement to the registry (Australian Act)?","requirements_guidance":"Publish your modern slavery statement on your UK website","requirements_guidance_color":"red","requirements_criterion":"Provide your statement to the Australian Border Force, to be published on the online central register. (pp. 64-65)","requirements_criterion_color":"red"},{"metric":"Board approval","url":"https://wikirate.org/Business_Human_Rights_Resource_Centre+MSA_Statement_Approval","description":"Was the company\'s Modern Slavery Act statement explicitly approved by the board of directors (or equivalent management body)?","requirements_guidance":"Get approval from the board of directors (or equivalent management body)","requirements_guidance_color":"red","requirements_criterion":"Get approval by principal governing body (p. 62)","requirements_criterion_color":"red"},{"metric":"Signature","url":"https://wikirate.org/Business_Human_Rights_Resource_Centre+MSA_statement_signed","description":"Was the company\u2019s Modern Slavery Act statement signed by an appropriate person?","requirements_guidance":"Get sign off from a director (or equivalent) or designated member (for LLPs)","requirements_guidance_color":"red","requirements_criterion":"Signed by a responsible member (p.62)","requirements_criterion_color":"red"},{"metric":"Organizational structure and operations","url":"https://wikirate.org/Walk_Free+MSA_Organizational_structure_and_operations","description":"Does the company disclose the ownership structure(s) and/or business model(s) of each of its brands, subsidiaries, and other businesses covered by their Modern Slavery statement?","requirements_guidance":"Organisation structure and supply chains (p. 27)","requirements_guidance_color":"yellow","requirements_criterion":"Identify the reporting entity and describe its structure, operations and supply chains (p. 32)","requirements_criterion_color":"red"},{"metric":"Supply chain disclosure","url":"https://wikirate.org/Walk_Free+MSA_supply_chain_disclosure","description":"Does the company\u2019s statement identify the suppliers in their supply chain and/or the geographic regions where their supply chain operates?","requirements_guidance":"Organisation structure and supply chains (p. 27)","requirements_guidance_color":"yellow","requirements_criterion":"Identify the reporting entity and describe its structure, operations and supply chains (p. 32)","requirements_criterion_color":"red"},{"metric":"Policy","url":"https://wikirate.org/Walk_Free+MSA_policy_revised","description":"Does the company\u2019s statement detail specific, organisational policies or actions to combat slavery in their direct (tier 1) and/or in-direct (beyond tier 1) supply chain?","requirements_guidance":"Policies in relation to slavery and human trafficking / Organisational policies (p. 29)","requirements_guidance_color":"yellow","requirements_criterion":"Pre-agreed processes or policies in place to guide actions (p.85)","requirements_criterion_color":"yellow"},{"metric":"Risk assessment","url":"https://wikirate.org/Walk_Free+MSA_risk_assessment","description":"How does the company assess the risks of modern slavery and trafficking in their supply chain?","requirements_guidance":"Due diligence processes (p. 33)","requirements_guidance_color":"yellow","requirements_criterion":"Describe the actions taken by the reporting entity and any entities that the reporting entity owns or controls to assess and address these risks, including due diligence and remediation processes (p. 46)","requirements_criterion_color":"red"},{"metric":"Risk management","url":"https://wikirate.org/Walk_Free+MSA_risk_management_revised","description":"Does the company continuously monitor suppliers to ensure that they comply with the company\u2019s policies and local laws?","requirements_guidance":"Due diligence processes (p. 33)","requirements_guidance_color":"yellow","requirements_criterion":"Describe the actions taken by the reporting entity and any entities that the reporting entity owns or controls to assess and address these risks, including due diligence and remediation processes (p. 46)","requirements_criterion_color":"red"},{"metric":"Incidents remediation","url":"https://wikirate.org/Walk_Free+MSA_incidents_remediation_revised","description":"Did the company explain the corrective steps it has taken (or would take) in response to modern slavery incidents in their own operations and/or supply chain?","requirements_guidance":"Due diligence processes (p. 33)","requirements_guidance_color":"yellow","requirements_criterion":"Describe the actions taken by the reporting entity and any entities that the reporting entity owns or controls to assess and address these risks, including due diligence and remediation processes (p. 46)","requirements_criterion_color":"red"},{"metric":"Whistleblowing mechanism","url":"https://wikirate.org/Walk_Free+MSA_whistleblowing_mechanism_revised","description":"Does the company have a grievance mechanism in place to facilitate whistle-blowing or the reporting of suspected incidents of slavery or trafficking?","requirements_guidance":"Due diligence processes (p. 33)","requirements_guidance_color":"yellow","requirements_criterion":"Describe the actions taken by the reporting entity and any entities that the reporting entity owns or controls to assess and address these risks, including due diligence and remediation processes (p. 46)","requirements_criterion_color":"red"},{"metric":"Identification of risks","url":"https://wikirate.org/Walk_Free+MSA_Identification_of_risks","description":"Does the company\u2019s statement identify specific geographic regions, industries, resources or types of workforce where the risk of modern slavery is the greatest?","requirements_guidance":"Risk assessment and management (p. 34)","requirements_guidance_color":"yellow","requirements_criterion":"Describe the risks of modern slavery practices in the operations and supply chains of the reporting entity and any entities the reporting entity owns or controls (p. 40)","requirements_criterion_color":"red"},{"metric":"Incidents identified","url":"https://wikirate.org/Walk_Free+MSA_incidents_identified","description":"Did the company identify any specific incidents related to modern slavery that require(d) remediation?","requirements_guidance":"","requirements_guidance_color":"white","requirements_criterion":"Describe the risks of modern slavery practices in the operations and supply chains of the reporting entity and any entities the reporting entity owns or controls  (p. 41)","requirements_criterion_color":"yellow"},{"metric":"Performance indicators","url":"https://wikirate.org/Walk_Free+MSA_Performance_Indicators","description":"Does the company define performance indicators that measure the effectiveness of their actions to combat slavery and trafficking?","requirements_guidance":"Key performance indicators to measure effectiveness of steps being taken (p. 36)","requirements_guidance_color":"yelow","requirements_criterion":"Describe how the reporting entity assesses the effectiveness of actions being taken to assess and address modern slavery risks (p. 54)","requirements_criterion_color":"red"},{"metric":"Business performance indicators","url":"https://wikirate.org/Walk_Free+MSA_Business_Performance_Indicators","description":"Has the company reviewed business KPIs to ensure they are not increasing risk of modern slavery?","requirements_guidance":"Key performance indicators to measure effectiveness of steps being taken (p. 36)","requirements_guidance_color":"yelow","requirements_criterion":"Describe how the reporting entity assesses the effectiveness of actions being taken to assess and address modern slavery risks (p. 54)","requirements_criterion_color":"red"},{"metric":"Training","url":"https://wikirate.org/Walk_Free+MSA_training_revised","description":"Does the statement describe training for staff that is specifically geared towards detecting signs of slavery or trafficking?","requirements_guidance":"Training on modern slavery and trafficking (p. 37)","requirements_guidance_color":"yellow","requirements_criterion":"Describe the actions taken by the reporting entity and any entities that the reporting entity owns or controls to assess and address these risks, including due diligence and remediation processes (p. 52)","requirements_criterion_color":"yellow"},{"metric":"Consultation process","url":"https://wikirate.org/Walk_Free+MSA_Consultation_Process","description":"Does the statement describe consulting with any entities that it owns or controls?","requirements_guidance":"","requirements_guidance_color":"white","requirements_criterion":"Describe the process of consultation with any entities the reporting entity owns or controls (p. 57)","requirements_criterion_color":"red"}]');function oet(e,t){if(1&e&&(k(0,"tr")(1,"td",50)(2,"a",51),B(3),F()(),k(4,"td",52),B(5),F(),k(6,"td",53),B(7),F(),k(8,"td",53),B(9),F()()),2&e){const n=t.$implicit;W(2),Ef("href",n.url,Bp),W(1),Ni(n.metric),W(2),Ni(n.description),W(1),X("ngClass","red"===n.requirements_guidance_color?"td-bg-color-red":"td-bg-color-yellow"),W(1),Ni(n.requirements_guidance),W(1),X("ngClass","red"===n.requirements_criterion_color?"td-bg-color-red":"td-bg-color-yellow"),W(1),Ni(n.requirements_criterion)}}function aet(e,t){if(1&e&&(k(0,"div",54)(1,"div",55)(2,"div",56),dt(3,"img",57),F(),k(4,"div",58),B(5),F()()()),2&e){const n=t.$implicit;W(3),Ef("src",n.logo,Bp),Ef("alt",n.contributor),W(2),ua(" ",n.contributor," ")}}function uet(e,t){1&e&&(k(0,"p"),B(1,"As the project progressed 3 more standardized metrics have been added. One resulting from the Australian Modern Slavery Act requirements assessing \u201cConsultation process\u201d (see table below) and two looking at best practices such as companies "),k(2,"a",59),B(3,"providing a historic record of previous statements"),F(),B(4," on their website, and making explicit "),k(5,"a",60),B(6,"how the legislation impacted company behavior."),F()())}const cet=[{path:"dashboard/:sector",component:ret},{path:"about",component:(()=>{class e{constructor(){this.table=[],this.currentIndex=1,this.contributors=[{contributor:"Australian National University",logo:"https://dq06ugkuram52.cloudfront.net/files/5295432/20444349-medium.png"},{contributor:"ESCP Europe",logo:"https://dq06ugkuram52.cloudfront.net/files/1779114/12602972-medium.png"},{contributor:"John Hopkins University",logo:"https://dq06ugkuram52.cloudfront.net/files/2749557/12774885-medium.jpg"},{contributor:"Lancaster University Management School",logo:"https://dq06ugkuram52.cloudfront.net/files/12639475/33117884-medium.png"},{contributor:"School of International and Public Affairs at Columbia University",logo:"https://dq06ugkuram52.cloudfront.net/files/12639482/33117897-medium.png"},{contributor:"University of Amsterdam",logo:"https://dq06ugkuram52.cloudfront.net/files/5759131/21999891-medium.png"},{contributor:"University of British Columbia",logo:"https://dq06ugkuram52.cloudfront.net/files/2877117/13099211-medium.png"},{contributor:"University of Connecticut",logo:"https://dq06ugkuram52.cloudfront.net/files/2877060/13099154-medium.png"},{contributor:"University of Nottingham",logo:"https://dq06ugkuram52.cloudfront.net/files/3149947/13561221-medium.png"},{contributor:"University of Western Australia",logo:"https://dq06ugkuram52.cloudfront.net/files/2549359/12602502-medium.jpeg"}]}ngOnInit(){this.table=JSON.parse(JSON.stringify(set))}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=bn({type:e,selectors:[["about"]],decls:180,vars:3,consts:[[1,"container"],[1,"section","row","mb-4"],[1,"title","mt-5"],[1,"subtitle","mt-3"],[1,"row"],[1,"col-md-12"],[1,"content"],["id","action",1,"row","mt-2","mb-2"],[1,"col-md-6","mb-md-0","mb-5"],[1,"bg-yellow","p-4"],[1,"call-to-action-title","mb-2"],[1,"mb-3"],[1,"note"],[1,"col-md-6"],[1,"section","bg-neutral-blue"],[1,"col-md-12","p-3","pt-4","pb-4"],["placement","top","tooltipHtml","true",1,"tooltip-item",3,"ngbPopover"],["id","methodology",1,"content","collapse"],[1,"table","table-responsive-md","table-bordered","border-light"],[1,"thead-dark"],["scope","col-3","colspan","2"],["scope","col-3"],["scope","col-2"],["scope","col-4"],[4,"ngFor","ngForOf"],[1,"row","ms-2"],[1,"row","p-1","justify-content-end"],[1,"col-auto","no-padding"],[1,"col-auto"],[1,"legend-box","td-bg-color-red"],[1,"legend-box","td-bg-color-yellow"],["id","show-more","data-bs-toggle","collapse","href","#methodology","role","button","aria-expanded","false","aria-controls","methodology",1,"collapsed"],[1,"section"],[1,"col-md-12","p-3"],[1,"bg-deep-blue","p-4"],["href","https://wikirate.org/Research_UK_Modern_Slavery_Act_Research","target","_blank",1,"button","white-button","mt-md-3","mt-3"],["href","https://wikirate.org/Add_Answers#edit_an_answer","target","_blank",1,"button","white-button","mt-md-3","mt-3"],["id","sector_focus","data-bs-spy","scroll","data-bs-target","#action","data-offset","150","tabindex","0",1,"section","bg-neutral-blue"],[1,"row","pb-4"],[1,"col-md-4"],[1,"p-2"],[1,"note","mb-3"],[1,"text-start"],["href","https://cdn.minderoo.com.au/content/uploads/2019/11/20161202/2632_MSA-statements.V8_FNL.pdf",1,"button","transparent-button","mt-md-3","mt-3"],["href","https://cdn.walkfree.org/content/uploads/2021/03/18184928/WalkFree_BeyondComplianceInTheFinanceSector_210318.pdf",1,"button","transparent-button","mt-md-3","mt-3"],["href","https://cdn.walkfree.org/content/uploads/2022/02/22150956/Walk-Free-Beyond-Compliance-Garment-Industry.pdf",1,"button","transparent-button","mt-md-3","mt-3"],[1,"slider","mt-3"],[1,"slide-track"],["class","slide",4,"ngFor","ngForOf"],["standardized_metrics_details",""],[1,"col-2"],["target","_blank",1,"link-info",3,"href"],[1,"col-4"],[1,"col-3",3,"ngClass"],[1,"slide"],[1,"row","col-12","justify-content-center"],[1,"image-box","d-flex","justify-content-center","align-items-center","m-2"],[3,"src","alt"],[1,"contributor-name","m3","text-center"],["href","https://wikirate.org/Walk_Free+MSA_historic_record","target","_blank"],["href","https://wikirate.org/Walk_Free+MSA_Impact_on_Company_Behaviour","target","_blank"]],template:function(n,i){if(1&n&&(k(0,"div",0)(1,"div",1)(2,"h1",2),B(3," Beyond Compliance Dashboard "),F(),k(4,"div",3),B(5," A living data dashboard assessing modern slavery reporting standards across business sectors "),F()(),k(6,"div",4)(7,"div",5)(8,"div",6)(9,"p"),B(10," Under Section 54 of the 2015 MSA, the UK government requires all companies with a turnover of over GB\xa336 million per annum to release an annual statement on the actions they are taking to tackle modern slavery in their direct operations and supply chains. The 2018 Australian MSA establishes a national Modern Slavery Reporting Requirement, which applies to businesses and other entities in the Australian market with an annual consolidated revenue of at least AU$100 million. These entities are required to identify and address their modern slavery risks and maintain responsible and transparent supply chains. "),F(),k(11,"p"),B(12," In 2016, when the first companies started publishing their UK Modern Slavery Act statements, Walk Free and WikiRate partnered to set up a research project that could assess their contents; were companies approaching it as another tick box exercise or were they going beyond compliance? "),F()()()(),k(13,"div",7)(14,"div",8)(15,"div",9)(16,"div",10),B(17,"Take Action"),F(),k(18,"h5",11),B(19,"We're calling policy makers to"),F(),k(20,"ul")(21,"li"),B(22,"Implement financial penalties for non-compliance with the MSAs"),F(),k(23,"li"),B(24,"Strengthen MSA legislation to go beyond mandatory reporting to include mandatory due diligence"),F(),k(25,"li"),B(26,"Provide avenues for redress for exploited workers"),F()(),k(27,"div",12),B(28,"You can find full sets of recommendations specific to sectors that have been analysed through this project within the reports linked to in the Sector Focus section. "),F()()(),k(29,"div",13)(30,"div",9)(31,"div",10),B(32,"Take Action"),F(),k(33,"h5",11),B(34,"We're calling companies reporting under MSA legislation to"),F(),k(35,"ul")(36,"li"),B(37,"Improve reporting under MSA legislations"),F(),k(38,"li"),B(39,"Improve supply chain transparency"),F(),k(40,"li"),B(41,"Implement due diligence with a focus on sector specific risk"),F(),k(42,"li"),B(43,"Establish due diligence processes that demonstrate duty of care for vulnerable workers"),F(),k(44,"li"),B(45,"Engage with industry and non-industry initiatives"),F()(),k(46,"div",12),B(47,"You can find full sets of recommendations specific to sectors that have been analysed through this project within the reports linked to in the Sector Focus section. "),F()()()()(),k(48,"div",14)(49,"div",0)(50,"div",4)(51,"div",15)(52,"h3",11),B(53,"Methodology"),F(),k(54,"p"),B(55," Drawing on Walk Free's knowledge of modern slavery due diligence and the Home Office Guidance accompanying the UK Act, the partnership developed a "),k(56,"span",16),B(57,"set of 16"),k(58,"span"),B(59,"*"),F(),B(60," standardized metrics"),F(),B(61," to assess the content of the statements. "),F(),k(62,"p"),B(63,"The following overview shows how both the UK and Australian legislation guidance and requirements map to the projects' standardized metrics."),F(),k(64,"div",17)(65,"table",18)(66,"thead",19)(67,"tr")(68,"th",20),B(69,"Walk Free metrics on WikiRate platform"),F(),k(70,"th",21),B(71,"UK MSA Requirements & Guidance"),F(),k(72,"th",21),B(73,"Australia MSA Requirements"),F()(),k(74,"tr")(75,"th",22),B(76,"Metric"),F(),k(77,"th",23),B(78,"Description"),F(),k(79,"th",21),B(80,"Requirements & Guidance"),F(),k(81,"th",21),B(82,"Requirements & Criterion"),F()()(),k(83,"tbody"),je(84,oet,10,7,"tr",24),F()(),k(85,"div",25)(86,"div",26)(87,"div",27),B(88,"Mandatory"),F(),k(89,"div",28),dt(90,"div",29),F()(),k(91,"div",26)(92,"div",27),B(93,"Not Mandatory"),F(),k(94,"div",28),dt(95,"div",30),F()()()(),dt(96,"a",31),F()()()(),k(97,"div",0)(98,"div",32)(99,"div",4)(100,"div",33)(101,"h3",11),B(102,"Collaborative Research"),F(),k(103,"div",6)(104,"p"),B(105,"On the WikiRate platform anyone interested can take part in research efforts that gather data about the actions and impacts of companies on people and planet. The data displayed in this dashboard is collected through the Modern Slavery Act research project. This project is organized by Walk Free in collaboration with the WikiRate team, but the research is conducted by a much broader community of passionate researchers. It has been a collaboration between a wide variety of groups including volunteers, University students, and experts from around the world. As the research effort is ongoing, this is a living, breathing project and the dashboard updates as and when new data is contributed to the WikiRate platform. "),F()()()(),k(106,"div",4)(107,"div",8)(108,"div",34)(109,"div",10),B(110,"Take Action"),F(),k(111,"h5",11),B(112,"Join the Research!"),F(),k(113,"p"),B(114,"Contribute to MSA research via the WikiRate platform"),F(),k(115,"a",35),B(116,"Learn More"),F()()(),k(117,"div",13)(118,"div",34)(119,"div",10),B(120,"Take Action"),F(),k(121,"h5",11),B(122,"Data Verification!"),F(),k(123,"p"),B(124,"Find some data you think might be inaccurate? Join the ongoing data verification effort and help us improve the research"),F(),k(125,"a",36),B(126,"Learn More"),F()()()()()(),k(127,"div",37)(128,"div",0)(129,"div",4)(130,"div",15)(131,"h3",11),B(132,"Sector Focus"),F(),k(133,"p"),B(134," Over the years Walk Free has analyzed and published subsets of the data collected through the Modern Slavery Act Research project on WikiRate. Since 2019 these case studies have had a sector specific focus, which so far have included: "),F()()(),k(135,"div",38)(136,"div",39)(137,"div",40)(138,"h5"),B(139,"Hotels"),F(),k(140,"p"),B(141,"The hotel sector is the section of the service industry that deals with guest accomodation. It can include branded hotels and boutique hotels. "),F(),k(142,"div",41),B(143,"Note: The hotel sector is a subset of the hospitality sector. The latter also includes consumer services such as restaurants, recreation, and tourism. This broader category is the sector filter you can apply to the data in this dashboard. "),F(),k(144,"div",42)(145,"a",43),B(146,"Learn More"),F()()()(),k(147,"div",39)(148,"div",40)(149,"h5"),B(150,"Asset Managers"),F(),k(151,"p"),B(152,"Asset owners outsource their investment decisions to investment or asset managers. Owners rely on investment managers to understand the risks that are present in portfolios including environmental, social and governance risks. They have considerable leverage through the provision of advice and can encourage owners to be active, responsible investors. "),F(),k(153,"div",41),B(154,"Note: Asset managers are a subset of the finance sector. The latter also includes banks, pension funds, insurance, real estate and financial service providers. This broader category is the sector filter you can apply to the data in this dashboard. "),F(),k(155,"div",42)(156,"a",44),B(157,"Learn More"),F()()()(),k(158,"div",39)(159,"div",40)(160,"h5"),B(161,"Garment"),F(),k(162,"p"),B(163,"The garment sector includes the manufacture of textiles, leather, and allied products for the purpose of assembling garments and footwear, by any means, for sale or exportation to garment companies and brands, and the subsequent sale of garments and footwear by these companies and brands to consumers. "),F(),k(164,"div",42)(165,"a",45),B(166,"Learn More"),F()()()()()()(),k(167,"div",0)(168,"div",32)(169,"div",4)(170,"div",33)(171,"h3",11),B(172,"Research Contributors"),F(),k(173,"p"),B(174,"This research was performed with the contribution of the following organizations"),F(),k(175,"div",46)(176,"div",47),je(177,aet,6,3,"div",48),F()()()()()(),je(178,uet,7,0,"ng-template",null,49,Co)),2&n){const r=wo(179);W(56),X("ngbPopover",r),W(28),X("ngForOf",i.table),W(93),X("ngForOf",i.contributors)}},directives:[Eq,Mf,hl],styles:['p[_ngcontent-%COMP%], li[_ngcontent-%COMP%]{font-size:18px!important;line-height:27px!important;font-weight:300!important;letter-spacing:.3px}.call-to-action-title[_ngcontent-%COMP%]{font-size:.8em;letter-spacing:.5px;text-transform:uppercase}a#show-more.collapsed[_ngcontent-%COMP%]:after{content:"+ Show More"}a#show-more[_ngcontent-%COMP%]:not(.collapsed):after{content:"- Show Less"}.img[_ngcontent-%COMP%]{width:250px!important;height:250px!important;min-width:250px!important;min-height:250px!important}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%!important;max-height:100%!important;height:auto!important}.contributor-name[_ngcontent-%COMP%]{text-transform:uppercase;font-size:.6em}.image-box[_ngcontent-%COMP%]{width:140px!important;height:140px!important}.image-box-small-screen[_ngcontent-%COMP%]{height:auto!important;max-width:200px!important}@keyframes scroll{0%{transform:translate(0)}to{transform:translate(-1750px)}}.slider[_ngcontent-%COMP%]{height:200px;margin:auto;overflow:hidden;position:relative;width:auto}.slider[_ngcontent-%COMP%]   .slide-track[_ngcontent-%COMP%]{animation:scroll 60s linear infinite;display:flex;width:3500px}.slider[_ngcontent-%COMP%]   .slide[_ngcontent-%COMP%]{height:100px;width:250px}']}),e})()},{path:"**",redirectTo:"/dashboard/all-sectors",pathMatch:"full"}];let det=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({imports:[[j9.forRoot(cet)],j9]}),e})(),fet=(()=>{class e{constructor(n){this.sectorProvider=n,this.selectedSector="All Sectors",this.selectedSection="dashboard"}ngOnInit(){this.sectorProvider.getSector().subscribe(n=>{"all-sectors"===n&&n!==this.selectedSector?this.selectedSector="All Sectors":"garment-sector"===n&&n!==this.selectedSector?this.selectedSector="Garment":"financial-sector"===n&&n!==this.selectedSector?this.selectedSector="Financial":"hospitality-sector"===n&&n!==this.selectedSector&&(this.selectedSector="Hospitality")})}onSelectSector(n){this.selectedSector=n}onSelectSection(n){this.selectedSection=n}}return e.\u0275fac=function(n){return new(n||e)(H(g2))},e.\u0275cmp=bn({type:e,selectors:[["header-component"]],decls:45,vars:1,consts:[[1,"bg-deep-blue","sticky-top"],[1,"container"],[1,"nav","navbar"],["routerLink","/dashboard",1,"navbar-brand","navbar-expand",3,"click"],["src","assets/logos/walk_free_header_logo.svg",1,"logo","ms-1","mt-1","mb-1"],[1,"navbar","me-auto"],["routerLink","/about",1,"nav-item","nav-link",3,"click"],[1,"nav-item","dropdown","col"],["type","button","id","share","data-bs-toggle","dropdown","aria-expanded","false",1,"nav-item","nav-link"],[1,"bi","bi-share-fill","ms-2"],["aria-labelledby","share",1,"dropdown-menu"],["target","_blank","href","https://www.facebook.com/sharer/sharer.php?u=",1,"dropdown-item"],[1,"bi","bi-facebook","ms-2","me-2"],["target","_blank","href","https://twitter.com/intent/tweet?url=",1,"dropdown-item"],[1,"bi","bi-twitter","ms-2","me-2"],["target","_blank","href","https://www.linkedin.com/shareArticle?mini=true&url=",1,"dropdown-item"],[1,"bi","bi-linkedin","ms-2","me-2"],["target","_blank","href","mailto:info@example.com?&subject=&cc=&bcc=&body=",1,"dropdown-item"],[1,"bi","bi-envelope-fill","ms-2","me-2"],[1,"filter-dropdown","dropdown"],["type","button","id","sector-filter","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-secondary","dropdown-toggle"],["aria-labelledby","sector-filter","data-popper-placement","bottom-start",1,"dropdown-menu"],["routerLink","dashboard/all-sectors",1,"dropdown-item",3,"click"],["routerLink","dashboard/garment-sector",1,"dropdown-item",3,"click"],["routerLink","dashboard/financial-sector",1,"dropdown-item",3,"click"],["routerLink","dashboard/hospitality-sector",1,"dropdown-item",3,"click"]],template:function(n,i){1&n&&(k(0,"div",0)(1,"div",1)(2,"nav",2)(3,"a",3),Fe("click",function(){return i.onSelectSection("dashboard")}),dt(4,"img",4),F(),k(5,"div",5)(6,"a",6),Fe("click",function(){return i.onSelectSection("about")}),B(7,"ABOUT"),F(),k(8,"div",7)(9,"a",8),B(10," SHARE "),dt(11,"i",9),F(),k(12,"ul",10)(13,"li")(14,"a",11),dt(15,"i",12),B(16,"facebook"),F()(),k(17,"li")(18,"a",13),dt(19,"i",14),B(20,"twitter"),F()(),k(21,"li")(22,"a",15),dt(23,"i",16),B(24,"linkedin"),F()(),k(25,"li")(26,"a",17),dt(27,"i",18),B(28,"mail"),F()()()()(),k(29,"div",19)(30,"a",20),B(31),F(),k(32,"ul",21)(33,"li")(34,"a",22),Fe("click",function(){return i.onSelectSector("All Sectors")}),B(35," All Sectors "),F()(),k(36,"li")(37,"a",23),Fe("click",function(){return i.onSelectSector("Garment")}),B(38," Garment "),F()(),k(39,"li")(40,"a",24),Fe("click",function(){return i.onSelectSector("Financial")}),B(41," Financial "),F()(),k(42,"li")(43,"a",25),Fe("click",function(){return i.onSelectSector("Hospitality")}),B(44," Hospitality "),F()()()()()()()),2&n&&(W(31),Ni(i.selectedSector))},directives:[dN,Tw],styles:[""]}),e})(),het=(()=>{class e{constructor(){this.current_year=2022,this.current_year=(new Date).getFullYear()}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=bn({type:e,selectors:[["footer"]],decls:18,vars:1,consts:[[1,"bg-yellow"],[1,"container","pt-5","pb-5"],[1,"row"],[1,"text-center","creators"],[1,"row","justify-content-center"],[1,"col-4","text-center"],["href","https://walkfree.org/"],["src","assets/logos/walk_free_footer_logo.svg",1,"logo"],[1,"col-4","text-center","logo-center"],["href","https://wikirate.org"],["src","assets/logos/wikirate_logo.svg",1,"logo"],[1,"bg-deep-blue"],[1,"footer-container"],[1,"col-11"],[1,"mt-3","text-light-white","mb-3"]],template:function(n,i){1&n&&(k(0,"div",0)(1,"div",1)(2,"div",2)(3,"p",3),B(4,"A collaboration between:"),F()(),k(5,"div",4)(6,"div",5)(7,"a",6),dt(8,"img",7),F()(),k(9,"div",8)(10,"a",9),dt(11,"img",10),F()()()()(),k(12,"div",11)(13,"div",12)(14,"div",2)(15,"div",13)(16,"div",14),B(17),F()()()()()),2&n&&(W(17),ua(" Copyright \xa9 ",i.current_year," Minderoo Foundation Pty Ltd. All rights reserved "))},styles:[".creators[_ngcontent-%COMP%]{font-size:.8em!important;letter-spacing:.5px!important;text-transform:uppercase}"]}),e})(),pet=(()=>{class e{constructor(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=bn({type:e,selectors:[["app-root"]],decls:3,vars:0,template:function(n,i){1&n&&dt(0,"header-component")(1,"router-outlet")(2,"footer")},directives:[fet,a2,het],styles:[""]}),e})();class _ue{}const mc="*";function yue(e,t=null){return{type:2,steps:e,options:t}}function vue(e){return{type:6,styles:e,offset:null}}function bue(e){Promise.resolve(null).then(e)}class P1{constructor(t=0,n=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+n}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){bue(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(i=>i()),n.length=0}}class wue{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let n=0,i=0,r=0;const s=this.players.length;0==s?bue(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++n==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const n=t*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,n/i.totalTime):1;i.setPosition(r)})}getPosition(){const t=this.players.reduce((n,i)=>null===n||i.totalTime>n.totalTime?i:n,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(i=>i()),n.length=0}}const vt=!1;function Due(e){return new xe(3e3,vt)}function Jet(){return"undefined"!=typeof window&&void 0!==window.document}function kB(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function cf(e){switch(e.length){case 0:return new P1;case 1:return e[0];default:return new wue(e)}}function Cue(e,t,n,i,r={},s={}){const o=[],a=[];let l=-1,u=null;if(i.forEach(c=>{const d=c.offset,f=d==l,h=f&&u||{};Object.keys(c).forEach(p=>{let g=p,m=c[p];if("offset"!==p)switch(g=t.normalizePropertyName(g,o),m){case"!":m=r[p];break;case mc:m=s[p];break;default:m=t.normalizeStyleValue(p,g,m,o)}h[g]=m}),f||a.push(h),u=h,l=d}),o.length)throw function Bet(e){return new xe(3502,vt)}();return a}function IB(e,t,n,i){switch(t){case"start":e.onStart(()=>i(n&&RB(n,"start",e)));break;case"done":e.onDone(()=>i(n&&RB(n,"done",e)));break;case"destroy":e.onDestroy(()=>i(n&&RB(n,"destroy",e)))}}function RB(e,t,n){const i=n.totalTime,s=FB(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null==i?e.totalTime:i,!!n.disabled),o=e._data;return null!=o&&(s._data=o),s}function FB(e,t,n,i,r="",s=0,o){return{element:e,triggerName:t,fromState:n,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function co(e,t,n){let i;return e instanceof Map?(i=e.get(t),i||e.set(t,i=n)):(i=e[t],i||(i=e[t]=n)),i}function Eue(e){const t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}let PB=(e,t)=>!1,Sue=(e,t,n)=>[],xue=null;function LB(e){const t=e.parentNode||e.host;return t===xue?null:t}(kB()||"undefined"!=typeof Element)&&(Jet()?(xue=(()=>document.documentElement)(),PB=(e,t)=>{for(;t;){if(t===e)return!0;t=LB(t)}return!1}):PB=(e,t)=>e.contains(t),Sue=(e,t,n)=>{if(n)return Array.from(e.querySelectorAll(t));const i=e.querySelector(t);return i?[i]:[]});let mp=null,Aue=!1;function Mue(e){mp||(mp=function Qet(){return"undefined"!=typeof document?document.body:null}()||{},Aue=!!mp.style&&"WebkitAppearance"in mp.style);let t=!0;return mp.style&&!function Xet(e){return"ebkit"==e.substring(1,6)}(e)&&(t=e in mp.style,!t&&Aue&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in mp.style)),t}const Tue=PB,Oue=Sue;let Nue=(()=>{class e{validateStyleProperty(n){return Mue(n)}matchesElement(n,i){return!1}containsElement(n,i){return Tue(n,i)}getParentElement(n){return LB(n)}query(n,i,r){return Oue(n,i,r)}computeStyle(n,i,r){return r||""}animate(n,i,r,s,o,a=[],l){return new P1(r,s)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})(),jB=(()=>{class e{}return e.NOOP=new Nue,e})();const BB="ng-enter",_A="ng-leave",yA="ng-trigger",vA=".ng-trigger",Iue="ng-animating",$B=".ng-animating";function _p(e){if("number"==typeof e)return e;const t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:VB(parseFloat(t[1]),t[2])}function VB(e,t){return"s"===t?1e3*e:e}function bA(e,t,n){return e.hasOwnProperty("duration")?e:function ttt(e,t,n){let r,s=0,o="";if("string"==typeof e){const a=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return t.push(Due()),{duration:0,delay:0,easing:""};r=VB(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(s=VB(parseFloat(l),a[4]));const u=a[5];u&&(o=u)}else r=e;if(!n){let a=!1,l=t.length;r<0&&(t.push(function met(){return new xe(3100,vt)}()),a=!0),s<0&&(t.push(function _et(){return new xe(3101,vt)}()),a=!0),a&&t.splice(l,0,Due())}return{duration:r,delay:s,easing:o}}(e,t,n)}function b0(e,t={}){return Object.keys(e).forEach(n=>{t[n]=e[n]}),t}function df(e,t,n={}){if(t)for(let i in e)n[i]=e[i];else b0(e,n);return n}function Fue(e,t,n){return n?t+":"+n+";":""}function Pue(e){let t="";for(let n=0;n<e.style.length;n++){const i=e.style.item(n);t+=Fue(0,i,e.style.getPropertyValue(i))}for(const n in e.style)e.style.hasOwnProperty(n)&&!n.startsWith("_")&&(t+=Fue(0,rtt(n),e.style[n]));e.setAttribute("style",t)}function cu(e,t,n){e.style&&(Object.keys(t).forEach(i=>{const r=UB(i);n&&!n.hasOwnProperty(i)&&(n[i]=e.style[r]),e.style[r]=t[i]}),kB()&&Pue(e))}function yp(e,t){e.style&&(Object.keys(t).forEach(n=>{const i=UB(n);e.style[i]=""}),kB()&&Pue(e))}function L1(e){return Array.isArray(e)?1==e.length?e[0]:yue(e):e}const HB=new RegExp("{{\\s*(.+?)\\s*}}","g");function Lue(e){let t=[];if("string"==typeof e){let n;for(;n=HB.exec(e);)t.push(n[1]);HB.lastIndex=0}return t}function wA(e,t,n){const i=e.toString(),r=i.replace(HB,(s,o)=>{let a=t[o];return t.hasOwnProperty(o)||(n.push(function vet(e){return new xe(3003,vt)}()),a=""),a.toString()});return r==i?e:r}function DA(e){const t=[];let n=e.next();for(;!n.done;)t.push(n.value),n=e.next();return t}const itt=/-+([a-z0-9])/g;function UB(e){return e.replace(itt,(...t)=>t[1].toUpperCase())}function rtt(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function fo(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw function bet(e){return new xe(3004,vt)}()}}function jue(e,t){return window.getComputedStyle(e)[t]}function ctt(e,t){const n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(i=>function dtt(e,t,n){if(":"==e[0]){const l=function ftt(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(n,i)=>parseFloat(i)>parseFloat(n);case":decrement":return(n,i)=>parseFloat(i)<parseFloat(n);default:return t.push(function Fet(e){return new xe(3016,vt)}()),"* => *"}}(e,n);if("function"==typeof l)return void t.push(l);e=l}const i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push(function Ret(e){return new xe(3015,vt)}()),t;const r=i[1],s=i[2],o=i[3];t.push(Bue(r,o));"<"==s[0]&&!("*"==r&&"*"==o)&&t.push(Bue(o,r))}(i,n,t)):n.push(e),n}const xA=new Set(["true","1"]),AA=new Set(["false","0"]);function Bue(e,t){const n=xA.has(e)||AA.has(e),i=xA.has(t)||AA.has(t);return(r,s)=>{let o="*"==e||e==r,a="*"==t||t==s;return!o&&n&&"boolean"==typeof r&&(o=r?xA.has(e):AA.has(e)),!a&&i&&"boolean"==typeof s&&(a=s?xA.has(t):AA.has(t)),o&&a}}const htt=new RegExp("s*:selfs*,?","g");function zB(e,t,n,i){return new ptt(e).build(t,n,i)}class ptt{constructor(t){this._driver=t}build(t,n,i){const r=new _tt(n);this._resetContextStyleTimingState(r);const s=fo(this,L1(t),r);return r.unsupportedCSSPropertiesFound.size&&r.unsupportedCSSPropertiesFound.keys(),s}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles={},t.collectedStyles[""]={},t.currentTime=0}visitTrigger(t,n){let i=n.queryCount=0,r=n.depCount=0;const s=[],o=[];return"@"==t.name.charAt(0)&&n.errors.push(function Det(){return new xe(3006,vt)}()),t.definitions.forEach(a=>{if(this._resetContextStyleTimingState(n),0==a.type){const l=a,u=l.name;u.toString().split(/\s*,\s*/).forEach(c=>{l.name=c,s.push(this.visitState(l,n))}),l.name=u}else if(1==a.type){const l=this.visitTransition(a,n);i+=l.queryCount,r+=l.depCount,o.push(l)}else n.errors.push(function Cet(){return new xe(3007,vt)}())}),{type:7,name:t.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(t,n){const i=this.visitStyle(t.styles,n),r=t.options&&t.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};i.styles.forEach(a=>{if(MA(a)){const l=a;Object.keys(l).forEach(u=>{Lue(l[u]).forEach(c=>{o.hasOwnProperty(c)||s.add(c)})})}}),s.size&&(DA(s.values()),n.errors.push(function Eet(e,t){return new xe(3008,vt)}()))}return{type:0,name:t.name,style:i,options:r?{params:r}:null}}visitTransition(t,n){n.queryCount=0,n.depCount=0;const i=fo(this,L1(t.animation),n);return{type:1,matchers:ctt(t.expr,n.errors),animation:i,queryCount:n.queryCount,depCount:n.depCount,options:vp(t.options)}}visitSequence(t,n){return{type:2,steps:t.steps.map(i=>fo(this,i,n)),options:vp(t.options)}}visitGroup(t,n){const i=n.currentTime;let r=0;const s=t.steps.map(o=>{n.currentTime=i;const a=fo(this,o,n);return r=Math.max(r,n.currentTime),a});return n.currentTime=r,{type:3,steps:s,options:vp(t.options)}}visitAnimate(t,n){const i=function vtt(e,t){if(e.hasOwnProperty("duration"))return e;if("number"==typeof e)return qB(bA(e,t).duration,0,"");const n=e;if(n.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=qB(0,0,"");return s.dynamic=!0,s.strValue=n,s}const r=bA(n,t);return qB(r.duration,r.delay,r.easing)}(t.timings,n.errors);n.currentAnimateTimings=i;let r,s=t.styles?t.styles:vue({});if(5==s.type)r=this.visitKeyframes(s,n);else{let o=t.styles,a=!1;if(!o){a=!0;const u={};i.easing&&(u.easing=i.easing),o=vue(u)}n.currentTime+=i.duration+i.delay;const l=this.visitStyle(o,n);l.isEmptyStep=a,r=l}return n.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(t,n){const i=this._makeStyleAst(t,n);return this._validateStyleAst(i,n),i}_makeStyleAst(t,n){const i=[];Array.isArray(t.styles)?t.styles.forEach(o=>{"string"==typeof o?o==mc?i.push(o):n.errors.push(function xet(e){return new xe(3002,vt)}()):i.push(o)}):i.push(t.styles);let r=!1,s=null;return i.forEach(o=>{if(MA(o)){const a=o,l=a.easing;if(l&&(s=l,delete a.easing),!r)for(let u in a)if(a[u].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:i,easing:s,offset:t.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(t,n){const i=n.currentAnimateTimings;let r=n.currentTime,s=n.currentTime;i&&s>0&&(s-=i.duration+i.delay),t.styles.forEach(o=>{"string"!=typeof o&&Object.keys(o).forEach(a=>{if(!this._driver.validateStyleProperty(a))return delete o[a],void n.unsupportedCSSPropertiesFound.add(a);const l=n.collectedStyles[n.currentQuerySelector],u=l[a];let c=!0;u&&(s!=r&&s>=u.startTime&&r<=u.endTime&&(n.errors.push(function Aet(e,t,n,i,r){return new xe(3010,vt)}()),c=!1),s=u.startTime),c&&(l[a]={startTime:s,endTime:r}),n.options&&function ntt(e,t,n){const i=t.params||{},r=Lue(e);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||n.push(function yet(e){return new xe(3001,vt)}())})}(o[a],n.options,n.errors)})})}visitKeyframes(t,n){const i={type:5,styles:[],options:null};if(!n.currentAnimateTimings)return n.errors.push(function Met(){return new xe(3011,vt)}()),i;let s=0;const o=[];let a=!1,l=!1,u=0;const c=t.steps.map(_=>{const y=this._makeStyleAst(_,n);let v=null!=y.offset?y.offset:function ytt(e){if("string"==typeof e)return null;let t=null;if(Array.isArray(e))e.forEach(n=>{if(MA(n)&&n.hasOwnProperty("offset")){const i=n;t=parseFloat(i.offset),delete i.offset}});else if(MA(e)&&e.hasOwnProperty("offset")){const n=e;t=parseFloat(n.offset),delete n.offset}return t}(y.styles),b=0;return null!=v&&(s++,b=y.offset=v),l=l||b<0||b>1,a=a||b<u,u=b,o.push(b),y});l&&n.errors.push(function Tet(){return new xe(3012,vt)}()),a&&n.errors.push(function Oet(){return new xe(3200,vt)}());const d=t.steps.length;let f=0;s>0&&s<d?n.errors.push(function Net(){return new xe(3202,vt)}()):0==s&&(f=1/(d-1));const h=d-1,p=n.currentTime,g=n.currentAnimateTimings,m=g.duration;return c.forEach((_,y)=>{const v=f>0?y==h?1:f*y:o[y],b=v*m;n.currentTime=p+g.delay+b,g.duration=b,this._validateStyleAst(_,n),_.offset=v,i.styles.push(_)}),i}visitReference(t,n){return{type:8,animation:fo(this,L1(t.animation),n),options:vp(t.options)}}visitAnimateChild(t,n){return n.depCount++,{type:9,options:vp(t.options)}}visitAnimateRef(t,n){return{type:10,animation:this.visitReference(t.animation,n),options:vp(t.options)}}visitQuery(t,n){const i=n.currentQuerySelector,r=t.options||{};n.queryCount++,n.currentQuery=t;const[s,o]=function gtt(e){const t=!!e.split(/\s*,\s*/).find(n=>":self"==n);return t&&(e=e.replace(htt,"")),e=e.replace(/@\*/g,vA).replace(/@\w+/g,n=>vA+"-"+n.substr(1)).replace(/:animating/g,$B),[e,t]}(t.selector);n.currentQuerySelector=i.length?i+" "+s:s,co(n.collectedStyles,n.currentQuerySelector,{});const a=fo(this,L1(t.animation),n);return n.currentQuery=null,n.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:t.selector,options:vp(t.options)}}visitStagger(t,n){n.currentQuery||n.errors.push(function ket(){return new xe(3013,vt)}());const i="full"===t.timings?{duration:0,delay:0,easing:"full"}:bA(t.timings,n.errors,!0);return{type:12,animation:fo(this,L1(t.animation),n),timings:i,options:null}}}class _tt{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function MA(e){return!Array.isArray(e)&&"object"==typeof e}function vp(e){return e?(e=b0(e)).params&&(e.params=function mtt(e){return e?b0(e):null}(e.params)):e={},e}function qB(e,t,n){return{duration:e,delay:t,easing:n}}function GB(e,t,n,i,r,s,o=null,a=!1){return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class TA{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,n){let i=this._map.get(t);i||this._map.set(t,i=[]),i.push(...n)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const Dtt=new RegExp(":enter","g"),Ett=new RegExp(":leave","g");function WB(e,t,n,i,r,s={},o={},a,l,u=[]){return(new Stt).buildKeyframes(e,t,n,i,r,s,o,a,l,u)}class Stt{buildKeyframes(t,n,i,r,s,o,a,l,u,c=[]){u=u||new TA;const d=new YB(t,n,u,r,s,c,[]);d.options=l,d.currentTimeline.setStyles([o],null,d.errors,l),fo(this,i,d);const f=d.timelines.filter(h=>h.containsAnimation());if(Object.keys(a).length){let h;for(let p=f.length-1;p>=0;p--){const g=f[p];if(g.element===n){h=g;break}}h&&!h.allowOnlyTimelineStyles()&&h.setStyles([a],null,d.errors,l)}return f.length?f.map(h=>h.buildKeyframes()):[GB(n,[],[],[],0,0,"",!1)]}visitTrigger(t,n){}visitState(t,n){}visitTransition(t,n){}visitAnimateChild(t,n){const i=n.subInstructions.get(n.element);if(i){const r=n.createSubContext(t.options),s=n.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&n.transformIntoNewTimeline(o)}n.previousNode=t}visitAnimateRef(t,n){const i=n.createSubContext(t.options);i.transformIntoNewTimeline(),this.visitReference(t.animation,i),n.transformIntoNewTimeline(i.currentTimeline.currentTime),n.previousNode=t}_visitSubInstructions(t,n,i){let s=n.currentTimeline.currentTime;const o=null!=i.duration?_p(i.duration):null,a=null!=i.delay?_p(i.delay):null;return 0!==o&&t.forEach(l=>{const u=n.appendInstructionToTimeline(l,o,a);s=Math.max(s,u.duration+u.delay)}),s}visitReference(t,n){n.updateOptions(t.options,!0),fo(this,t.animation,n),n.previousNode=t}visitSequence(t,n){const i=n.subContextCount;let r=n;const s=t.options;if(s&&(s.params||s.delay)&&(r=n.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=OA);const o=_p(s.delay);r.delayNextStep(o)}t.steps.length&&(t.steps.forEach(o=>fo(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),n.previousNode=t}visitGroup(t,n){const i=[];let r=n.currentTimeline.currentTime;const s=t.options&&t.options.delay?_p(t.options.delay):0;t.steps.forEach(o=>{const a=n.createSubContext(t.options);s&&a.delayNextStep(s),fo(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(o=>n.currentTimeline.mergeTimelineCollectedStyles(o)),n.transformIntoNewTimeline(r),n.previousNode=t}_visitTiming(t,n){if(t.dynamic){const i=t.strValue;return bA(n.params?wA(i,n.params,n.errors):i,n.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,n){const i=n.currentAnimateTimings=this._visitTiming(t.timings,n),r=n.currentTimeline;i.delay&&(n.incrementTime(i.delay),r.snapshotCurrentStyles());const s=t.style;5==s.type?this.visitKeyframes(s,n):(n.incrementTime(i.duration),this.visitStyle(s,n),r.applyStylesToKeyframe()),n.currentAnimateTimings=null,n.previousNode=t}visitStyle(t,n){const i=n.currentTimeline,r=n.currentAnimateTimings;!r&&i.getCurrentStyleProperties().length&&i.forwardFrame();const s=r&&r.easing||t.easing;t.isEmptyStep?i.applyEmptyStep(s):i.setStyles(t.styles,s,n.errors,n.options),n.previousNode=t}visitKeyframes(t,n){const i=n.currentAnimateTimings,r=n.currentTimeline.duration,s=i.duration,a=n.createSubContext().currentTimeline;a.easing=i.easing,t.styles.forEach(l=>{a.forwardTime((l.offset||0)*s),a.setStyles(l.styles,l.easing,n.errors,n.options),a.applyStylesToKeyframe()}),n.currentTimeline.mergeTimelineCollectedStyles(a),n.transformIntoNewTimeline(r+s),n.previousNode=t}visitQuery(t,n){const i=n.currentTimeline.currentTime,r=t.options||{},s=r.delay?_p(r.delay):0;s&&(6===n.previousNode.type||0==i&&n.currentTimeline.getCurrentStyleProperties().length)&&(n.currentTimeline.snapshotCurrentStyles(),n.previousNode=OA);let o=i;const a=n.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,n.errors);n.currentQueryTotal=a.length;let l=null;a.forEach((u,c)=>{n.currentQueryIndex=c;const d=n.createSubContext(t.options,u);s&&d.delayNextStep(s),u===n.element&&(l=d.currentTimeline),fo(this,t.animation,d),d.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,d.currentTimeline.currentTime)}),n.currentQueryIndex=0,n.currentQueryTotal=0,n.transformIntoNewTimeline(o),l&&(n.currentTimeline.mergeTimelineCollectedStyles(l),n.currentTimeline.snapshotCurrentStyles()),n.previousNode=t}visitStagger(t,n){const i=n.parentContext,r=n.currentTimeline,s=t.timings,o=Math.abs(s.duration),a=o*(n.currentQueryTotal-1);let l=o*n.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=i.currentStaggerTime}const c=n.currentTimeline;l&&c.delayNextStep(l);const d=c.currentTime;fo(this,t.animation,n),n.previousNode=t,i.currentStaggerTime=r.currentTime-d+(r.startTime-i.currentTimeline.startTime)}}const OA={};class YB{constructor(t,n,i,r,s,o,a,l){this._driver=t,this.element=n,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=OA,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new NA(this._driver,n,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,n){if(!t)return;const i=t;let r=this.options;null!=i.duration&&(r.duration=_p(i.duration)),null!=i.delay&&(r.delay=_p(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!n||!o.hasOwnProperty(a))&&(o[a]=wA(s[a],o,this.errors))})}}_copyOptions(){const t={};if(this.options){const n=this.options.params;if(n){const i=t.params={};Object.keys(n).forEach(r=>{i[r]=n[r]})}}return t}createSubContext(t=null,n,i){const r=n||this.element,s=new YB(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(t),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(t){return this.previousNode=OA,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,n,i){const r={duration:null!=n?n:t.duration,delay:this.currentTimeline.currentTime+(null!=i?i:0)+t.delay,easing:""},s=new xtt(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,n,i,r,s,o){let a=[];if(r&&a.push(this.element),t.length>0){t=(t=t.replace(Dtt,"."+this._enterClassName)).replace(Ett,"."+this._leaveClassName);let u=this._driver.query(this.element,t,1!=i);0!==i&&(u=i<0?u.slice(u.length+i,u.length):u.slice(0,i)),a.push(...u)}return!s&&0==a.length&&o.push(function Iet(e){return new xe(3014,vt)}()),a}}class NA{constructor(t,n,i,r){this._driver=t,this.element=n,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const n=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||n?(this.forwardTime(this.currentTime+t),n&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,n){return this.applyStylesToKeyframe(),new NA(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,n){this._localTimelineStyles[t]=n,this._globalTimelineStyles[t]=n,this._styleSummary[t]={time:this.currentTime,value:n}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(n=>{this._backFill[n]=this._globalTimelineStyles[n]||mc,this._currentKeyframe[n]=mc}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,n,i,r){n&&(this._previousKeyframe.easing=n);const s=r&&r.params||{},o=function Att(e,t){const n={};let i;return e.forEach(r=>{"*"===r?(i=i||Object.keys(t),i.forEach(s=>{n[s]=mc})):df(r,!1,n)}),n}(t,this._globalTimelineStyles);Object.keys(o).forEach(a=>{const l=wA(o[a],s,i);this._pendingStyles[a]=l,this._localTimelineStyles.hasOwnProperty(a)||(this._backFill[a]=this._globalTimelineStyles.hasOwnProperty(a)?this._globalTimelineStyles[a]:mc),this._updateStyle(a,l)})}applyStylesToKeyframe(){const t=this._pendingStyles,n=Object.keys(t);0!=n.length&&(this._pendingStyles={},n.forEach(i=>{this._currentKeyframe[i]=t[i]}),Object.keys(this._localTimelineStyles).forEach(i=>{this._currentKeyframe.hasOwnProperty(i)||(this._currentKeyframe[i]=this._localTimelineStyles[i])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const n=this._localTimelineStyles[t];this._pendingStyles[t]=n,this._updateStyle(t,n)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let n in this._currentKeyframe)t.push(n);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(n=>{const i=this._styleSummary[n],r=t._styleSummary[n];(!i||r.time>i.time)&&this._updateStyle(n,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,n=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const u=df(a,!0);Object.keys(u).forEach(c=>{const d=u[c];"!"==d?t.add(c):d==mc&&n.add(c)}),i||(u.offset=l/this.duration),r.push(u)});const s=t.size?DA(t.values()):[],o=n.size?DA(n.values()):[];if(i){const a=r[0],l=b0(a);a.offset=0,l.offset=1,r=[a,l]}return GB(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class xtt extends NA{constructor(t,n,i,r,s,o,a=!1){super(t,n,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:n,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&n){const s=[],o=i+n,a=n/o,l=df(t[0],!1);l.offset=0,s.push(l);const u=df(t[0],!1);u.offset=Hue(a),s.push(u);const c=t.length-1;for(let d=1;d<=c;d++){let f=df(t[d],!1);f.offset=Hue((n+f.offset*i)/o),s.push(f)}i=o,n=0,r="",t=s}return GB(this.element,t,this.preStyleProps,this.postStyleProps,i,n,r,!0)}}function Hue(e,t=3){const n=Math.pow(10,t-1);return Math.round(e*n)/n}class KB{}class Mtt extends KB{normalizePropertyName(t,n){return UB(t)}normalizeStyleValue(t,n,i,r){let s="";const o=i.toString().trim();if(Ttt[n]&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function wet(e,t){return new xe(3005,vt)}())}return o+s}}const Ttt=(()=>function Ott(e){const t={};return e.forEach(n=>t[n]=!0),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function Uue(e,t,n,i,r,s,o,a,l,u,c,d,f){return{type:0,element:e,triggerName:t,isRemovalTransition:r,fromState:n,fromStyles:s,toState:i,toStyles:o,timelines:a,queriedElements:l,preStyleProps:u,postStyleProps:c,totalTime:d,errors:f}}const JB={};class zue{constructor(t,n,i){this._triggerName=t,this.ast=n,this._stateStyles=i}match(t,n,i,r){return function Ntt(e,t,n,i,r){return e.some(s=>s(t,n,i,r))}(this.ast.matchers,t,n,i,r)}buildStyles(t,n,i){const r=this._stateStyles["*"],s=this._stateStyles[t],o=r?r.buildStyles(n,i):{};return s?s.buildStyles(n,i):o}build(t,n,i,r,s,o,a,l,u,c){const d=[],f=this.ast.options&&this.ast.options.params||JB,p=this.buildStyles(i,a&&a.params||JB,d),g=l&&l.params||JB,m=this.buildStyles(r,g,d),_=new Set,y=new Map,v=new Map,b="void"===r,D={params:Object.assign(Object.assign({},f),g)},C=c?[]:WB(t,n,this.ast.animation,s,o,p,m,D,u,d);let w=0;if(C.forEach(T=>{w=Math.max(T.duration+T.delay,w)}),d.length)return Uue(n,this._triggerName,i,r,b,p,m,[],[],y,v,w,d);C.forEach(T=>{const O=T.element,N=co(y,O,{});T.preStyleProps.forEach(j=>N[j]=!0);const P=co(v,O,{});T.postStyleProps.forEach(j=>P[j]=!0),O!==n&&_.add(O)});const E=DA(_.values());return Uue(n,this._triggerName,i,r,b,p,m,C,E,y,v,w)}}class ktt{constructor(t,n,i){this.styles=t,this.defaultParams=n,this.normalizer=i}buildStyles(t,n){const i={},r=b0(this.defaultParams);return Object.keys(t).forEach(s=>{const o=t[s];null!=o&&(r[s]=o)}),this.styles.styles.forEach(s=>{if("string"!=typeof s){const o=s;Object.keys(o).forEach(a=>{let l=o[a];l.length>1&&(l=wA(l,r,n));const u=this.normalizer.normalizePropertyName(a,n);l=this.normalizer.normalizeStyleValue(a,u,l,n),i[u]=l})}}),i}}class Rtt{constructor(t,n,i){this.name=t,this.ast=n,this._normalizer=i,this.transitionFactories=[],this.states={},n.states.forEach(r=>{this.states[r.name]=new ktt(r.style,r.options&&r.options.params||{},i)}),que(this.states,"true","1"),que(this.states,"false","0"),n.transitions.forEach(r=>{this.transitionFactories.push(new zue(t,r,this.states))}),this.fallbackTransition=function Ftt(e,t,n){return new zue(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,n,i,r){return this.transitionFactories.find(o=>o.match(t,n,i,r))||null}matchStyles(t,n,i){return this.fallbackTransition.buildStyles(t,n,i)}}function que(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}const Ptt=new TA;class Ltt{constructor(t,n,i){this.bodyNode=t,this._driver=n,this._normalizer=i,this._animations={},this._playersById={},this.players=[]}register(t,n){const i=[],s=zB(this._driver,n,i,[]);if(i.length)throw function $et(e){return new xe(3503,vt)}();this._animations[t]=s}_buildPlayer(t,n,i){const r=t.element,s=Cue(0,this._normalizer,0,t.keyframes,n,i);return this._driver.animate(r,s,t.duration,t.delay,t.easing,[],!0)}create(t,n,i={}){const r=[],s=this._animations[t];let o;const a=new Map;if(s?(o=WB(this._driver,n,s,BB,_A,{},{},i,Ptt,r),o.forEach(c=>{const d=co(a,c.element,{});c.postStyleProps.forEach(f=>d[f]=null)})):(r.push(function Vet(){return new xe(3300,vt)}()),o=[]),r.length)throw function Het(e){return new xe(3504,vt)}();a.forEach((c,d)=>{Object.keys(c).forEach(f=>{c[f]=this._driver.computeStyle(d,f,mc)})});const u=cf(o.map(c=>{const d=a.get(c.element);return this._buildPlayer(c,{},d)}));return this._playersById[t]=u,u.onDestroy(()=>this.destroy(t)),this.players.push(u),u}destroy(t){const n=this._getPlayer(t);n.destroy(),delete this._playersById[t];const i=this.players.indexOf(n);i>=0&&this.players.splice(i,1)}_getPlayer(t){const n=this._playersById[t];if(!n)throw function Uet(e){return new xe(3301,vt)}();return n}listen(t,n,i,r){const s=FB(n,"","","");return IB(this._getPlayer(t),i,s,r),()=>{}}command(t,n,i,r){if("register"==i)return void this.register(t,r[0]);if("create"==i)return void this.create(t,n,r[0]||{});const s=this._getPlayer(t);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const Gue="ng-animate-queued",XB="ng-animate-disabled",Htt=[],Wue={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Utt={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Ko="__ng_removed";class QB{constructor(t,n=""){this.namespaceId=n;const i=t&&t.hasOwnProperty("value");if(this.value=function Wtt(e){return null!=e?e:null}(i?t.value:t),i){const s=b0(t);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const n=t.params;if(n){const i=this.options.params;Object.keys(n).forEach(r=>{null==i[r]&&(i[r]=n[r])})}}}const j1="void",ZB=new QB(j1);class ztt{constructor(t,n,i){this.id=t,this.hostElement=n,this._engine=i,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Jo(n,this._hostClassName)}listen(t,n,i,r){if(!this._triggers.hasOwnProperty(n))throw function zet(e,t){return new xe(3302,vt)}();if(null==i||0==i.length)throw function qet(e){return new xe(3303,vt)}();if(!function Ytt(e){return"start"==e||"done"==e}(i))throw function Get(e,t){return new xe(3400,vt)}();const s=co(this._elementListeners,t,[]),o={name:n,phase:i,callback:r};s.push(o);const a=co(this._engine.statesByElement,t,{});return a.hasOwnProperty(n)||(Jo(t,yA),Jo(t,yA+"-"+n),a[n]=ZB),()=>{this._engine.afterFlush(()=>{const l=s.indexOf(o);l>=0&&s.splice(l,1),this._triggers[n]||delete a[n]})}}register(t,n){return!this._triggers[t]&&(this._triggers[t]=n,!0)}_getTrigger(t){const n=this._triggers[t];if(!n)throw function Wet(e){return new xe(3401,vt)}();return n}trigger(t,n,i,r=!0){const s=this._getTrigger(n),o=new e4(this.id,n,t);let a=this._engine.statesByElement.get(t);a||(Jo(t,yA),Jo(t,yA+"-"+n),this._engine.statesByElement.set(t,a={}));let l=a[n];const u=new QB(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&l&&u.absorbOptions(l.options),a[n]=u,l||(l=ZB),u.value!==j1&&l.value===u.value){if(!function Xtt(e,t){const n=Object.keys(e),i=Object.keys(t);if(n.length!=i.length)return!1;for(let r=0;r<n.length;r++){const s=n[r];if(!t.hasOwnProperty(s)||e[s]!==t[s])return!1}return!0}(l.params,u.params)){const g=[],m=s.matchStyles(l.value,l.params,g),_=s.matchStyles(u.value,u.params,g);g.length?this._engine.reportError(g):this._engine.afterFlush(()=>{yp(t,m),cu(t,_)})}return}const f=co(this._engine.playersByElement,t,[]);f.forEach(g=>{g.namespaceId==this.id&&g.triggerName==n&&g.queued&&g.destroy()});let h=s.matchTransition(l.value,u.value,t,u.params),p=!1;if(!h){if(!r)return;h=s.fallbackTransition,p=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:n,transition:h,fromState:l,toState:u,player:o,isFallbackTransition:p}),p||(Jo(t,Gue),o.onStart(()=>{w0(t,Gue)})),o.onDone(()=>{let g=this.players.indexOf(o);g>=0&&this.players.splice(g,1);const m=this._engine.playersByElement.get(t);if(m){let _=m.indexOf(o);_>=0&&m.splice(_,1)}}),this.players.push(o),f.push(o),o}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((n,i)=>{delete n[t]}),this._elementListeners.forEach((n,i)=>{this._elementListeners.set(i,n.filter(r=>r.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const n=this._engine.playersByElement.get(t);n&&(n.forEach(i=>i.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,n){const i=this._engine.driver.query(t,vA,!0);i.forEach(r=>{if(r[Ko])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,n,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(t,n,i,r){const s=this._engine.statesByElement.get(t),o=new Map;if(s){const a=[];if(Object.keys(s).forEach(l=>{if(o.set(l,s[l].value),this._triggers[l]){const u=this.trigger(t,l,j1,r);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,t,!0,n,o),i&&cf(a).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const n=this._elementListeners.get(t),i=this._engine.statesByElement.get(t);if(n&&i){const r=new Set;n.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const l=this._triggers[o].fallbackTransition,u=i[o]||ZB,c=new QB(j1),d=new e4(this.id,o,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:o,transition:l,fromState:u,toState:c,player:d,isFallbackTransition:!0})})}}removeNode(t,n){const i=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,n),this.triggerLeaveAnimation(t,n,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(t):[];if(s&&s.length)r=!0;else{let o=t;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)i.markElementAsRemoved(this.id,t,!1,n);else{const s=t[Ko];(!s||s===Wue)&&(i.afterFlush(()=>this.clearElementCache(t)),i.destroyInnerAnimations(t),i._onRemovalComplete(t,n))}}insertNode(t,n){Jo(t,this._hostClassName)}drainQueuedTransitions(t){const n=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==i.triggerName){const l=FB(s,i.triggerName,i.fromState.value,i.toState.value);l._data=t,IB(i.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):n.push(i)}),this._queue=[],n.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(t){this.players.forEach(n=>n.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let n=!1;return this._elementListeners.has(t)&&(n=!0),n=!!this._queue.find(i=>i.element===t)||n,n}}class qtt{constructor(t,n,i){this.bodyNode=t,this.driver=n,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}_onRemovalComplete(t,n){this.onRemovalComplete(t,n)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(n=>{n.players.forEach(i=>{i.queued&&t.push(i)})}),t}createNamespace(t,n){const i=new ztt(t,n,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,n)?this._balanceNamespaceList(i,n):(this.newHostElements.set(n,i),this.collectEnterElement(n)),this._namespaceLookup[t]=i}_balanceNamespaceList(t,n){const i=this._namespaceList,r=this.namespacesByHostElement,s=i.length-1;if(s>=0){let o=!1;if(void 0!==this.driver.getParentElement){let a=this.driver.getParentElement(n);for(;a;){const l=r.get(a);if(l){const u=i.indexOf(l);i.splice(u+1,0,t),o=!0;break}a=this.driver.getParentElement(a)}}else for(let a=s;a>=0;a--)if(this.driver.containsElement(i[a].hostElement,n)){i.splice(a+1,0,t),o=!0;break}o||i.unshift(t)}else i.push(t);return r.set(n,t),t}register(t,n){let i=this._namespaceLookup[t];return i||(i=this.createNamespace(t,n)),i}registerTrigger(t,n,i){let r=this._namespaceLookup[t];r&&r.register(n,i)&&this.totalAnimations++}destroy(t,n){if(!t)return;const i=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[t];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(n))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const n=new Set,i=this.statesByElement.get(t);if(i){const r=Object.keys(i);for(let s=0;s<r.length;s++){const o=i[r[s]].namespaceId;if(o){const a=this._fetchNamespace(o);a&&n.add(a)}}}return n}trigger(t,n,i,r){if(kA(n)){const s=this._fetchNamespace(t);if(s)return s.trigger(n,i,r),!0}return!1}insertNode(t,n,i,r){if(!kA(n))return;const s=n[Ko];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(n);o>=0&&this.collectedLeaveElements.splice(o,1)}if(t){const o=this._fetchNamespace(t);o&&o.insertNode(n,i)}r&&this.collectEnterElement(n)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,n){n?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Jo(t,XB)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),w0(t,XB))}removeNode(t,n,i,r){if(kA(n)){const s=t?this._fetchNamespace(t):null;if(s?s.removeNode(n,r):this.markElementAsRemoved(t,n,!1,r),i){const o=this.namespacesByHostElement.get(n);o&&o.id!==t&&o.removeNode(n,r)}}else this._onRemovalComplete(n,r)}markElementAsRemoved(t,n,i,r,s){this.collectedLeaveElements.push(n),n[Ko]={namespaceId:t,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(t,n,i,r,s){return kA(n)?this._fetchNamespace(t).listen(n,i,r,s):()=>{}}_buildInstruction(t,n,i,r,s){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,i,r,t.fromState.options,t.toState.options,n,s)}destroyInnerAnimations(t){let n=this.driver.query(t,vA,!0);n.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(n=this.driver.query(t,$B,!0),n.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(t){const n=this.playersByElement.get(t);n&&n.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(t){const n=this.playersByQueriedElement.get(t);n&&n.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return cf(this.players).onDone(()=>t());t()})}processLeaveNode(t){var n;const i=t[Ko];if(i&&i.setForRemoval){if(t[Ko]=Wue,i.namespaceId){this.destroyInnerAnimations(t);const r=this._fetchNamespace(i.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,i.setForRemoval)}(null===(n=t.classList)||void 0===n?void 0:n.contains(XB))&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(t=-1){let n=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Jo(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{n=this._flushAnimations(i,t)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],n.length?cf(n).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(t){throw function Yet(e){return new xe(3402,vt)}()}_flushAnimations(t,n){const i=new TA,r=[],s=new Map,o=[],a=new Map,l=new Map,u=new Map,c=new Set;this.disabledNodes.forEach(S=>{c.add(S);const I=this.driver.query(S,".ng-animate-queued",!0);for(let M=0;M<I.length;M++)c.add(I[M])});const d=this.bodyNode,f=Array.from(this.statesByElement.keys()),h=Jue(f,this.collectedEnterElements),p=new Map;let g=0;h.forEach((S,I)=>{const M=BB+g++;p.set(I,M),S.forEach(L=>Jo(L,M))});const m=[],_=new Set,y=new Set;for(let S=0;S<this.collectedLeaveElements.length;S++){const I=this.collectedLeaveElements[S],M=I[Ko];M&&M.setForRemoval&&(m.push(I),_.add(I),M.hasAnimation?this.driver.query(I,".ng-star-inserted",!0).forEach(L=>_.add(L)):y.add(I))}const v=new Map,b=Jue(f,Array.from(_));b.forEach((S,I)=>{const M=_A+g++;v.set(I,M),S.forEach(L=>Jo(L,M))}),t.push(()=>{h.forEach((S,I)=>{const M=p.get(I);S.forEach(L=>w0(L,M))}),b.forEach((S,I)=>{const M=v.get(I);S.forEach(L=>w0(L,M))}),m.forEach(S=>{this.processLeaveNode(S)})});const D=[],C=[];for(let S=this._namespaceList.length-1;S>=0;S--)this._namespaceList[S].drainQueuedTransitions(n).forEach(M=>{const L=M.player,R=M.element;if(D.push(L),this.collectedEnterElements.length){const K=R[Ko];if(K&&K.setForMove){if(K.previousTriggersValues&&K.previousTriggersValues.has(M.triggerName)){const le=K.previousTriggersValues.get(M.triggerName),G=this.statesByElement.get(M.element);G&&G[M.triggerName]&&(G[M.triggerName].value=le)}return void L.destroy()}}const V=!d||!this.driver.containsElement(d,R),U=v.get(R),z=p.get(R),$=this._buildInstruction(M,i,z,U,V);if($.errors&&$.errors.length)return void C.push($);if(V)return L.onStart(()=>yp(R,$.fromStyles)),L.onDestroy(()=>cu(R,$.toStyles)),void r.push(L);if(M.isFallbackTransition)return L.onStart(()=>yp(R,$.fromStyles)),L.onDestroy(()=>cu(R,$.toStyles)),void r.push(L);const Y=[];$.timelines.forEach(K=>{K.stretchStartingKeyframe=!0,this.disabledNodes.has(K.element)||Y.push(K)}),$.timelines=Y,i.append(R,$.timelines),o.push({instruction:$,player:L,element:R}),$.queriedElements.forEach(K=>co(a,K,[]).push(L)),$.preStyleProps.forEach((K,le)=>{const G=Object.keys(K);if(G.length){let Q=l.get(le);Q||l.set(le,Q=new Set),G.forEach(te=>Q.add(te))}}),$.postStyleProps.forEach((K,le)=>{const G=Object.keys(K);let Q=u.get(le);Q||u.set(le,Q=new Set),G.forEach(te=>Q.add(te))})});if(C.length){const S=[];C.forEach(I=>{S.push(function Ket(e,t){return new xe(3505,vt)}())}),D.forEach(I=>I.destroy()),this.reportError(S)}const w=new Map,E=new Map;o.forEach(S=>{const I=S.element;i.has(I)&&(E.set(I,I),this._beforeAnimationBuild(S.player.namespaceId,S.instruction,w))}),r.forEach(S=>{const I=S.element;this._getPreviousPlayers(I,!1,S.namespaceId,S.triggerName,null).forEach(L=>{co(w,I,[]).push(L),L.destroy()})});const T=m.filter(S=>Que(S,l,u)),O=new Map;Kue(O,this.driver,y,u,mc).forEach(S=>{Que(S,l,u)&&T.push(S)});const P=new Map;h.forEach((S,I)=>{Kue(P,this.driver,new Set(S),l,"!")}),T.forEach(S=>{const I=O.get(S),M=P.get(S);O.set(S,Object.assign(Object.assign({},I),M))});const j=[],A=[],x={};o.forEach(S=>{const{element:I,player:M,instruction:L}=S;if(i.has(I)){if(c.has(I))return M.onDestroy(()=>cu(I,L.toStyles)),M.disabled=!0,M.overrideTotalTime(L.totalTime),void r.push(M);let R=x;if(E.size>1){let U=I;const z=[];for(;U=U.parentNode;){const $=E.get(U);if($){R=$;break}z.push(U)}z.forEach($=>E.set($,R))}const V=this._buildAnimation(M.namespaceId,L,w,s,P,O);if(M.setRealPlayer(V),R===x)j.push(M);else{const U=this.playersByElement.get(R);U&&U.length&&(M.parentPlayer=cf(U)),r.push(M)}}else yp(I,L.fromStyles),M.onDestroy(()=>cu(I,L.toStyles)),A.push(M),c.has(I)&&r.push(M)}),A.forEach(S=>{const I=s.get(S.element);if(I&&I.length){const M=cf(I);S.setRealPlayer(M)}}),r.forEach(S=>{S.parentPlayer?S.syncPlayerEvents(S.parentPlayer):S.destroy()});for(let S=0;S<m.length;S++){const I=m[S],M=I[Ko];if(w0(I,_A),M&&M.hasAnimation)continue;let L=[];if(a.size){let V=a.get(I);V&&V.length&&L.push(...V);let U=this.driver.query(I,$B,!0);for(let z=0;z<U.length;z++){let $=a.get(U[z]);$&&$.length&&L.push(...$)}}const R=L.filter(V=>!V.destroyed);R.length?Ktt(this,I,R):this.processLeaveNode(I)}return m.length=0,j.forEach(S=>{this.players.push(S),S.onDone(()=>{S.destroy();const I=this.players.indexOf(S);this.players.splice(I,1)}),S.play()}),j}elementContainsData(t,n){let i=!1;const r=n[Ko];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(n)&&(i=!0),this.playersByQueriedElement.has(n)&&(i=!0),this.statesByElement.has(n)&&(i=!0),this._fetchNamespace(t).elementContainsData(n)||i}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,n,i,r,s){let o=[];if(n){const a=this.playersByQueriedElement.get(t);a&&(o=a)}else{const a=this.playersByElement.get(t);if(a){const l=!s||s==j1;a.forEach(u=>{u.queued||!l&&u.triggerName!=r||o.push(u)})}}return(i||r)&&(o=o.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(t,n,i){const s=n.element,o=n.isRemovalTransition?void 0:t,a=n.isRemovalTransition?void 0:n.triggerName;for(const l of n.timelines){const u=l.element,c=u!==s,d=co(i,u,[]);this._getPreviousPlayers(u,c,o,a,n.toState).forEach(h=>{const p=h.getRealPlayer();p.beforeDestroy&&p.beforeDestroy(),h.destroy(),d.push(h)})}yp(s,n.fromStyles)}_buildAnimation(t,n,i,r,s,o){const a=n.triggerName,l=n.element,u=[],c=new Set,d=new Set,f=n.timelines.map(p=>{const g=p.element;c.add(g);const m=g[Ko];if(m&&m.removedBeforeQueried)return new P1(p.duration,p.delay);const _=g!==l,y=function Jtt(e){const t=[];return Xue(e,t),t}((i.get(g)||Htt).map(w=>w.getRealPlayer())).filter(w=>!!w.element&&w.element===g),v=s.get(g),b=o.get(g),D=Cue(0,this._normalizer,0,p.keyframes,v,b),C=this._buildPlayer(p,D,y);if(p.subTimeline&&r&&d.add(g),_){const w=new e4(t,a,g);w.setRealPlayer(C),u.push(w)}return C});u.forEach(p=>{co(this.playersByQueriedElement,p.element,[]).push(p),p.onDone(()=>function Gtt(e,t,n){let i;if(e instanceof Map){if(i=e.get(t),i){if(i.length){const r=i.indexOf(n);i.splice(r,1)}0==i.length&&e.delete(t)}}else if(i=e[t],i){if(i.length){const r=i.indexOf(n);i.splice(r,1)}0==i.length&&delete e[t]}return i}(this.playersByQueriedElement,p.element,p))}),c.forEach(p=>Jo(p,Iue));const h=cf(f);return h.onDestroy(()=>{c.forEach(p=>w0(p,Iue)),cu(l,n.toStyles)}),d.forEach(p=>{co(r,p,[]).push(h)}),h}_buildPlayer(t,n,i){return n.length>0?this.driver.animate(t.element,n,t.duration,t.delay,t.easing,i):new P1(t.duration,t.delay)}}class e4{constructor(t,n,i){this.namespaceId=t,this.triggerName=n,this.element=i,this._player=new P1,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(n=>{this._queuedCallbacks[n].forEach(i=>IB(t,n,void 0,i))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const n=this._player;n.triggerCallback&&t.onStart(()=>n.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,n){co(this._queuedCallbacks,t,[]).push(n)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const n=this._player;n.triggerCallback&&n.triggerCallback(t)}}function kA(e){return e&&1===e.nodeType}function Yue(e,t){const n=e.style.display;return e.style.display=null!=t?t:"none",n}function Kue(e,t,n,i,r){const s=[];n.forEach(l=>s.push(Yue(l)));const o=[];i.forEach((l,u)=>{const c={};l.forEach(d=>{const f=c[d]=t.computeStyle(u,d,r);(!f||0==f.length)&&(u[Ko]=Utt,o.push(u))}),e.set(u,c)});let a=0;return n.forEach(l=>Yue(l,s[a++])),o}function Jue(e,t){const n=new Map;if(e.forEach(a=>n.set(a,[])),0==t.length)return n;const r=new Set(t),s=new Map;function o(a){if(!a)return 1;let l=s.get(a);if(l)return l;const u=a.parentNode;return l=n.has(u)?u:r.has(u)?1:o(u),s.set(a,l),l}return t.forEach(a=>{const l=o(a);1!==l&&n.get(l).push(a)}),n}function Jo(e,t){var n;null===(n=e.classList)||void 0===n||n.add(t)}function w0(e,t){var n;null===(n=e.classList)||void 0===n||n.remove(t)}function Ktt(e,t,n){cf(n).onDone(()=>e.processLeaveNode(t))}function Xue(e,t){for(let n=0;n<e.length;n++){const i=e[n];i instanceof wue?Xue(i.players,t):t.push(i)}}function Que(e,t,n){const i=n.get(e);if(!i)return!1;let r=t.get(e);return r?i.forEach(s=>r.add(s)):t.set(e,i),n.delete(e),!0}class IA{constructor(t,n,i){this.bodyNode=t,this._driver=n,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new qtt(t,n,i),this._timelineEngine=new Ltt(t,n,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(t,n,i,r,s){const o=t+"-"+r;let a=this._triggerCache[o];if(!a){const l=[],c=zB(this._driver,s,l,[]);if(l.length)throw function jet(e,t){return new xe(3404,vt)}();a=function Itt(e,t,n){return new Rtt(e,t,n)}(r,c,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(n,r,a)}register(t,n){this._transitionEngine.register(t,n)}destroy(t,n){this._transitionEngine.destroy(t,n)}onInsert(t,n,i,r){this._transitionEngine.insertNode(t,n,i,r)}onRemove(t,n,i,r){this._transitionEngine.removeNode(t,n,r||!1,i)}disableAnimations(t,n){this._transitionEngine.markElementAsDisabled(t,n)}process(t,n,i,r){if("@"==i.charAt(0)){const[s,o]=Eue(i);this._timelineEngine.command(s,n,o,r)}else this._transitionEngine.trigger(t,n,i,r)}listen(t,n,i,r,s){if("@"==i.charAt(0)){const[o,a]=Eue(i);return this._timelineEngine.listen(o,n,a,s)}return this._transitionEngine.listen(t,n,i,r,s)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let Ztt=(()=>{class e{constructor(n,i,r){this._element=n,this._startStyles=i,this._endStyles=r,this._state=0;let s=e.initialStylesByElement.get(n);s||e.initialStylesByElement.set(n,s={}),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&cu(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(cu(this._element,this._initialStyles),this._endStyles&&(cu(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(yp(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(yp(this._element,this._endStyles),this._endStyles=null),cu(this._element,this._initialStyles),this._state=3)}}return e.initialStylesByElement=new WeakMap,e})();function t4(e){let t=null;const n=Object.keys(e);for(let i=0;i<n.length;i++){const r=n[i];ent(r)&&(t=t||{},t[r]=e[r])}return t}function ent(e){return"display"===e||"position"===e}class Zue{constructor(t,n,i,r){this.element=t,this.keyframes=n,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,n,i){return t.animate(n,i)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};if(this.hasStarted()){const n=this._finalKeyframe;Object.keys(n).forEach(i=>{"offset"!=i&&(t[i]=this._finished?n[i]:jue(this.element,i))})}this.currentSnapshot=t}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(i=>i()),n.length=0}}class tnt{validateStyleProperty(t){return Mue(t)}matchesElement(t,n){return!1}containsElement(t,n){return Tue(t,n)}getParentElement(t){return LB(t)}query(t,n,i){return Oue(t,n,i)}computeStyle(t,n,i){return window.getComputedStyle(t)[n]}animate(t,n,i,r,s,o=[]){const l={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(l.easing=s);const u={},c=o.filter(f=>f instanceof Zue);(function stt(e,t){return 0===e||0===t})(i,r)&&c.forEach(f=>{let h=f.currentSnapshot;Object.keys(h).forEach(p=>u[p]=h[p])}),n=function ott(e,t,n){const i=Object.keys(n);if(i.length&&t.length){let s=t[0],o=[];if(i.forEach(a=>{s.hasOwnProperty(a)||o.push(a),s[a]=n[a]}),o.length)for(var r=1;r<t.length;r++){let a=t[r];o.forEach(function(l){a[l]=jue(e,l)})}}return t}(t,n=n.map(f=>df(f,!1)),u);const d=function Qtt(e,t){let n=null,i=null;return Array.isArray(t)&&t.length?(n=t4(t[0]),t.length>1&&(i=t4(t[t.length-1]))):t&&(n=t4(t)),n||i?new Ztt(e,n,i):null}(t,n);return new Zue(t,n,l,d)}}let nnt=(()=>{class e extends _ue{constructor(n,i){super(),this._nextAnimationId=0,this._renderer=n.createRenderer(i.body,{id:"0",encapsulation:ea.None,styles:[],data:{animation:[]}})}build(n){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(n)?yue(n):n;return ece(this._renderer,null,i,"register",[r]),new int(i,this._renderer)}}return e.\u0275fac=function(n){return new(n||e)(me(ug),me(ti))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();class int extends class get{}{constructor(t,n){super(),this._id=t,this._renderer=n}create(t,n){return new rnt(this._id,t,n||{},this._renderer)}}class rnt{constructor(t,n,i,r){this.id=t,this.element=n,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(t,n){return this._renderer.listen(this.element,`@@${this.id}:${t}`,n)}_command(t,...n){return ece(this._renderer,this.element,this.id,t,n)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){var t,n;return null!==(n=null===(t=this._renderer.engine.players[+this.id])||void 0===t?void 0:t.getPosition())&&void 0!==n?n:0}}function ece(e,t,n,i,r){return e.setProperty(t,`@@${n}:${i}`,r)}const tce="@.disabled";let snt=(()=>{class e{constructor(n,i,r){this.delegate=n,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(s,o)=>{const a=null==o?void 0:o.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(n,i){const s=this.delegate.createRenderer(n,i);if(!(n&&i&&i.data&&i.data.animation)){let c=this._rendererCache.get(s);return c||(c=new nce("",s,this.engine),this._rendererCache.set(s,c)),c}const o=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,n);const l=c=>{Array.isArray(c)?c.forEach(l):this.engine.registerTrigger(o,a,n,c.name,c)};return i.data.animation.forEach(l),new ont(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(n,i,r){n>=0&&n<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return e.\u0275fac=function(n){return new(n||e)(me(ug),me(IA),me(dn))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();class nce{constructor(t,n,i){this.namespaceId=t,this.delegate=n,this.engine=i,this.destroyNode=this.delegate.destroyNode?r=>n.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,n){return this.delegate.createElement(t,n)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,n){this.delegate.appendChild(t,n),this.engine.onInsert(this.namespaceId,n,t,!1)}insertBefore(t,n,i,r=!0){this.delegate.insertBefore(t,n,i),this.engine.onInsert(this.namespaceId,n,t,r)}removeChild(t,n,i){this.engine.onRemove(this.namespaceId,n,this.delegate,i)}selectRootElement(t,n){return this.delegate.selectRootElement(t,n)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,n,i,r){this.delegate.setAttribute(t,n,i,r)}removeAttribute(t,n,i){this.delegate.removeAttribute(t,n,i)}addClass(t,n){this.delegate.addClass(t,n)}removeClass(t,n){this.delegate.removeClass(t,n)}setStyle(t,n,i,r){this.delegate.setStyle(t,n,i,r)}removeStyle(t,n,i){this.delegate.removeStyle(t,n,i)}setProperty(t,n,i){"@"==n.charAt(0)&&n==tce?this.disableAnimations(t,!!i):this.delegate.setProperty(t,n,i)}setValue(t,n){this.delegate.setValue(t,n)}listen(t,n,i){return this.delegate.listen(t,n,i)}disableAnimations(t,n){this.engine.disableAnimations(t,n)}}class ont extends nce{constructor(t,n,i,r){super(n,i,r),this.factory=t,this.namespaceId=n}setProperty(t,n,i){"@"==n.charAt(0)?"."==n.charAt(1)&&n==tce?this.disableAnimations(t,i=void 0===i||!!i):this.engine.process(this.namespaceId,t,n.substr(1),i):this.delegate.setProperty(t,n,i)}listen(t,n,i){if("@"==n.charAt(0)){const r=function ant(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(t);let s=n.substr(1),o="";return"@"!=s.charAt(0)&&([s,o]=function lnt(e){const t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(t,n,i)}}let unt=(()=>{class e extends IA{constructor(n,i,r){super(n.body,i,r)}ngOnDestroy(){this.flush()}}return e.\u0275fac=function(n){return new(n||e)(me(ti),me(jB),me(KB))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac}),e})();const ice=new it("AnimationModuleType"),rce=[{provide:_ue,useClass:nnt},{provide:KB,useFactory:function cnt(){return new Mtt}},{provide:IA,useClass:unt},{provide:ug,useFactory:function dnt(e,t,n){return new snt(e,t,n)},deps:[dw,IA,dn]}],sce=[{provide:jB,useFactory:()=>new tnt},{provide:ice,useValue:"BrowserAnimations"},...rce],fnt=[{provide:jB,useClass:Nue},{provide:ice,useValue:"NoopAnimations"},...rce];let hnt=(()=>{class e{static withConfig(n){return{ngModule:e,providers:n.disableAnimations?fnt:sce}}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e}),e.\u0275inj=It({providers:sce,imports:[TH]}),e})(),pnt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=$t({type:e,bootstrap:[pet]}),e.\u0275inj=It({providers:[g2,ml,v0],imports:[[hz,Bwe,TH,hnt,$xe,det]]}),e})();(function L_e(){V7=!1})(),Kve().bootstrapModule(pnt).catch(e=>console.error(e))},559:$n=>{"use strict";$n.exports=function En(de,Bt){if(de===Bt)return!0;if(de&&Bt&&"object"==typeof de&&"object"==typeof Bt){if(de.constructor!==Bt.constructor)return!1;var Jt,Xt,sn;if(Array.isArray(de)){if((Jt=de.length)!=Bt.length)return!1;for(Xt=Jt;0!=Xt--;)if(!En(de[Xt],Bt[Xt]))return!1;return!0}if(de.constructor===RegExp)return de.source===Bt.source&&de.flags===Bt.flags;if(de.valueOf!==Object.prototype.valueOf)return de.valueOf()===Bt.valueOf();if(de.toString!==Object.prototype.toString)return de.toString()===Bt.toString();if((Jt=(sn=Object.keys(de)).length)!==Object.keys(Bt).length)return!1;for(Xt=Jt;0!=Xt--;)if(!Object.prototype.hasOwnProperty.call(Bt,sn[Xt]))return!1;for(Xt=Jt;0!=Xt--;){var ct=sn[Xt];if(!En(de[ct],Bt[ct]))return!1}return!0}return de!=de&&Bt!=Bt}},245:$n=>{"use strict";$n.exports=function(En,de){de||(de={}),"function"==typeof de&&(de={cmp:de});var sn,Bt="boolean"==typeof de.cycles&&de.cycles,Jt=de.cmp&&(sn=de.cmp,function(ct){return function(Yn,Nt){return sn({key:Yn,value:ct[Yn]},{key:Nt,value:ct[Nt]})}}),Xt=[];return function sn(ct){if(ct&&ct.toJSON&&"function"==typeof ct.toJSON&&(ct=ct.toJSON()),void 0!==ct){if("number"==typeof ct)return isFinite(ct)?""+ct:"null";if("object"!=typeof ct)return JSON.stringify(ct);var Yn,Nt;if(Array.isArray(ct)){for(Nt="[",Yn=0;Yn<ct.length;Yn++)Yn&&(Nt+=","),Nt+=sn(ct[Yn])||"null";return Nt+"]"}if(null===ct)return"null";if(-1!==Xt.indexOf(ct)){if(Bt)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var Os=Xt.push(ct)-1,Ns=Object.keys(ct).sort(Jt&&Jt(ct));for(Nt="",Yn=0;Yn<Ns.length;Yn++){var Tt=Ns[Yn],mt=sn(ct[Tt]);!mt||(Nt&&(Nt+=","),Nt+=JSON.stringify(Tt)+":"+mt)}return Xt.splice(Os,1),"{"+Nt+"}"}}(En)}},478:$n=>{var En=function(){"use strict";function de(Tt,mt){return null!=mt&&Tt instanceof mt}var Bt,Jt,Xt;try{Bt=Map}catch(Tt){Bt=function(){}}try{Jt=Set}catch(Tt){Jt=function(){}}try{Xt=Promise}catch(Tt){Xt=function(){}}function sn(Tt,mt,qi,po,Xo){"object"==typeof mt&&(qi=mt.depth,po=mt.prototype,Xo=mt.includeNonEnumerable,mt=mt.circular);var el=[],tr=[],tl="undefined"!=typeof Buffer;return void 0===mt&&(mt=!0),void 0===qi&&(qi=1/0),function Xe(We,Kn){if(null===We)return null;if(0===Kn)return We;var kt,Jn;if("object"!=typeof We)return We;if(de(We,Bt))kt=new Bt;else if(de(We,Jt))kt=new Jt;else if(de(We,Xt))kt=new Xt(function(hf,pf){We.then(function(pu){hf(Xe(pu,Kn-1))},function(pu){pf(Xe(pu,Kn-1))})});else if(sn.__isArray(We))kt=[];else if(sn.__isRegExp(We))kt=new RegExp(We.source,Ns(We)),We.lastIndex&&(kt.lastIndex=We.lastIndex);else if(sn.__isDate(We))kt=new Date(We.getTime());else{if(tl&&Buffer.isBuffer(We))return kt=Buffer.allocUnsafe?Buffer.allocUnsafe(We.length):new Buffer(We.length),We.copy(kt),kt;de(We,Error)?kt=Object.create(We):void 0===po?(Jn=Object.getPrototypeOf(We),kt=Object.create(Jn)):(kt=Object.create(po),Jn=po)}if(mt){var ff=el.indexOf(We);if(-1!=ff)return tr[ff];el.push(We),tr.push(kt)}for(var rs in de(We,Bt)&&We.forEach(function(hf,pf){var pu=Xe(pf,Kn-1),gu=Xe(hf,Kn-1);kt.set(pu,gu)}),de(We,Jt)&&We.forEach(function(hf){var pf=Xe(hf,Kn-1);kt.add(pf)}),We){var bp;Jn&&(bp=Object.getOwnPropertyDescriptor(Jn,rs)),(!bp||null!=bp.set)&&(kt[rs]=Xe(We[rs],Kn-1))}if(Object.getOwnPropertySymbols){var nl=Object.getOwnPropertySymbols(We);for(rs=0;rs<nl.length;rs++){var du=nl[rs];(fu=Object.getOwnPropertyDescriptor(We,du))&&!fu.enumerable&&!Xo||(kt[du]=Xe(We[du],Kn-1),fu.enumerable||Object.defineProperty(kt,du,{enumerable:!1}))}}if(Xo){var hu=Object.getOwnPropertyNames(We);for(rs=0;rs<hu.length;rs++){var fu,wp=hu[rs];(fu=Object.getOwnPropertyDescriptor(We,wp))&&fu.enumerable||(kt[wp]=Xe(We[wp],Kn-1),Object.defineProperty(kt,wp,{enumerable:!1}))}}return kt}(Tt,qi)}function ct(Tt){return Object.prototype.toString.call(Tt)}function Ns(Tt){var mt="";return Tt.global&&(mt+="g"),Tt.ignoreCase&&(mt+="i"),Tt.multiline&&(mt+="m"),mt}return sn.clonePrototype=function(mt){if(null===mt)return null;var qi=function(){};return qi.prototype=mt,new qi},sn.__objToStr=ct,sn.__isDate=function Yn(Tt){return"object"==typeof Tt&&"[object Date]"===ct(Tt)},sn.__isArray=function Nt(Tt){return"object"==typeof Tt&&"[object Array]"===ct(Tt)},sn.__isRegExp=function Os(Tt){return"object"==typeof Tt&&"[object RegExp]"===ct(Tt)},sn.__getRegExpFlags=Ns,sn}();$n.exports&&($n.exports=En)},564:$n=>{"use strict";var En=/("(?:[^\\"]|\\.)*")|[:,]/g;$n.exports=function(Bt,Jt){var Xt,sn,ct;return Jt=Jt||{},Xt=JSON.stringify([1],void 0,void 0===Jt.indent?2:Jt.indent).slice(2,-3),sn=""===Xt?1/0:void 0===Jt.maxLength?80:Jt.maxLength,ct=Jt.replacer,function Yn(Nt,Os,Ns){var Tt,mt,qi,po,Xo,el,tr,tl,Xe,We,Kn,kt;if(Nt&&"function"==typeof Nt.toJSON&&(Nt=Nt.toJSON()),void 0===(Kn=JSON.stringify(Nt,ct)))return Kn;if(Kn.length<=(tr=sn-Os.length-Ns)&&(Xe=Kn.replace(En,function(Jn,ff){return ff||Jn+" "})).length<=tr)return Xe;if(null!=ct&&(Nt=JSON.parse(Kn),ct=void 0),"object"==typeof Nt&&null!==Nt){if(tl=Os+Xt,qi=[],mt=0,Array.isArray(Nt))for(We="[",Tt="]",tr=Nt.length;mt<tr;mt++)qi.push(Yn(Nt[mt],tl,mt===tr-1?0:1)||"null");else for(We="{",Tt="}",tr=(el=Object.keys(Nt)).length;mt<tr;mt++)po=el[mt],Xo=JSON.stringify(po)+": ",void 0!==(kt=Yn(Nt[po],tl,Xo.length+(mt===tr-1?0:1)))&&qi.push(Xo+kt);if(qi.length>0)return[We,Xt+qi.join(",\n"+tl),Tt].join("\n"+Os)}return Kn}(Bt,"",0)}}},$n=>{$n($n.s=825)}]);