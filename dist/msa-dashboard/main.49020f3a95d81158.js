var Tnt=Object.defineProperty,Ont=Object.defineProperties,Nnt=Object.getOwnPropertyDescriptors,gce=Object.getOwnPropertySymbols,knt=Object.prototype.hasOwnProperty,Int=Object.prototype.propertyIsEnumerable,mce=($n,Sn,de)=>Sn in $n?Tnt($n,Sn,{enumerable:!0,configurable:!0,writable:!0,value:de}):$n[Sn]=de,_ce=($n,Sn)=>{for(var de in Sn||(Sn={}))knt.call(Sn,de)&&mce($n,de,Sn[de]);if(gce)for(var de of gce(Sn))Int.call(Sn,de)&&mce($n,de,Sn[de]);return $n},yce=($n,Sn)=>Ont($n,Nnt(Sn));(self.webpackChunkmsa_dashboard=self.webpackChunkmsa_dashboard||[]).push([[179],{34:($n,Sn,de)=>{"use strict";var $t={};de.r($t),de.d($t,{JsonPatchError:()=>qn,_areEquals:()=>K_,applyOperation:()=>qf,applyPatch:()=>nD,applyReducer:()=>aAe,deepClone:()=>sAe,getValueByPointer:()=>tD,validate:()=>zq,validator:()=>iD});var Qt={};de.r(Qt),de.d(Qt,{compare:()=>gAe,generate:()=>vN,observe:()=>pAe,unobserve:()=>hAe});var Zt={};de.r(Zt),de.d(Zt,{aggregate:()=>sd,bin:()=>tI,collect:()=>nI,compare:()=>MY,countpattern:()=>iI,cross:()=>rI,density:()=>sI,dotbin:()=>aI,expression:()=>FY,extent:()=>lI,facet:()=>jD,field:()=>PY,filter:()=>cI,flatten:()=>dI,fold:()=>fI,formula:()=>hI,generate:()=>LY,impute:()=>pI,joinaggregate:()=>gI,kde:()=>mI,key:()=>jY,load:()=>BY,lookup:()=>yI,multiextent:()=>$Y,multivalues:()=>VY,params:()=>HY,pivot:()=>vI,prefacet:()=>UY,project:()=>bI,proxy:()=>zY,quantile:()=>wI,relay:()=>qY,sample:()=>DI,sequence:()=>CI,sieve:()=>GY,subflow:()=>uI,timeunit:()=>EI,tupleindex:()=>YY,values:()=>KY,window:()=>SI});var an={};de.r(an),de.d(an,{interpolate:()=>dd,interpolateArray:()=>NNe,interpolateBasis:()=>RK,interpolateBasisClosed:()=>FK,interpolateCubehelix:()=>vke,interpolateCubehelixLong:()=>bke,interpolateDate:()=>$K,interpolateDiscrete:()=>nke,interpolateHcl:()=>mke,interpolateHclLong:()=>_ke,interpolateHsl:()=>fke,interpolateHslLong:()=>hke,interpolateHue:()=>ike,interpolateLab:()=>gke,interpolateNumber:()=>Oa,interpolateNumberArray:()=>VI,interpolateObject:()=>VK,interpolateRgb:()=>$I,interpolateRgbBasis:()=>TNe,interpolateRgbBasisClosed:()=>ONe,interpolateRound:()=>Ay,interpolateString:()=>HK,interpolateTransformCss:()=>oke,interpolateTransformSvg:()=>ake,interpolateZoom:()=>dke,piecewise:()=>ZI,quantize:()=>wke});var dt={};de.r(dt),de.d(dt,{bound:()=>RQ,identifier:()=>AF,mark:()=>PQ,overlap:()=>LQ,render:()=>UQ,viewlayout:()=>KQ});var Kn={};de.r(Kn),de.d(Kn,{axisticks:()=>XQ,datajoin:()=>QQ,encode:()=>ZQ,legendentries:()=>eZ,linkpath:()=>MF,pie:()=>TF,scale:()=>oZ,sortitems:()=>uZ,stack:()=>NF});var kt={};de.r(kt),de.d(kt,{contour:()=>uP,geojson:()=>fP,geopath:()=>hP,geopoint:()=>pP,geoshape:()=>gP,graticule:()=>mP,heatmap:()=>_P,isocontour:()=>oP,kde2d:()=>lP,projection:()=>See});var Is={};de.r(Is),de.d(Is,{force:()=>CP});var Rs={};de.r(Rs),de.d(Rs,{nest:()=>kP,pack:()=>RP,partition:()=>PP,stratify:()=>LP,tree:()=>BP,treelinks:()=>$P,treemap:()=>HP});var Tt={};de.r(Tt),de.d(Tt,{label:()=>QP});var mt={};de.r(mt),de.d(mt,{loess:()=>ZP,regression:()=>t3});var Wi={};de.r(Wi),de.d(Wi,{voronoi:()=>N3});var yo={};de.r(yo),de.d(yo,{wordcloud:()=>I3});var ia={};de.r(ia),de.d(ia,{crossfilter:()=>R3,resolvefilter:()=>F3});var ll={};de.r(ll),de.d(ll,{Bounds:()=>fi,CanvasHandler:()=>Yy,CanvasRenderer:()=>$C,DATE:()=>ps,DAY:()=>br,DAYOFYEAR:()=>Ml,Dataflow:()=>Hg,Debug:()=>Yq,Error:()=>DN,EventStream:()=>TD,Gradient:()=>aX,GroupItem:()=>vC,HOURS:()=>Js,Handler:()=>wd,Info:()=>Wq,Item:()=>yC,MILLISECONDS:()=>Ma,MINUTES:()=>Xs,MONTH:()=>vr,Marks:()=>Zs,MultiPulse:()=>Ok,None:()=>Gq,Operator:()=>pn,Parameters:()=>MD,Pulse:()=>rd,QUARTER:()=>hs,RenderType:()=>Cd,Renderer:()=>Ll,ResourceLoader:()=>kR,SECONDS:()=>Lo,SVGHandler:()=>aF,SVGRenderer:()=>pF,SVGStringRenderer:()=>mF,Scenegraph:()=>nF,TIME_UNITS:()=>ek,Transform:()=>Q,View:()=>sie,WEEK:()=>Ci,Warn:()=>CN,YEAR:()=>Ji,accessor:()=>cs,accessorFields:()=>gr,accessorName:()=>Gn,array:()=>we,ascending:()=>lD,bandwidthNRD:()=>jk,bin:()=>uY,bootstrapCI:()=>cY,boundClip:()=>SQ,boundContext:()=>By,boundItem:()=>tF,boundMark:()=>$X,boundStroke:()=>Ku,changeset:()=>Qf,clampRange:()=>oG,codegenExpression:()=>tne,compare:()=>MN,constant:()=>yr,cumulativeLogNormal:()=>zk,cumulativeNormal:()=>RD,cumulativeUniform:()=>Yk,dayofyear:()=>zG,debounce:()=>TN,defaultLocale:()=>mk,definition:()=>tY,densityLogNormal:()=>Uk,densityNormal:()=>Bk,densityUniform:()=>Wk,domChild:()=>_s,domClear:()=>Fa,domCreate:()=>bd,domFind:()=>iF,dotbin:()=>dY,error:()=>te,expressionFunction:()=>hi,extend:()=>ot,extent:()=>Al,extentIndex:()=>aG,falsy:()=>Gc,fastmap:()=>Og,field:()=>ds,flush:()=>lG,font:()=>NC,fontFamily:()=>zy,fontSize:()=>Pl,format:()=>wD,formatLocale:()=>vD,formats:()=>Ek,hasOwnProperty:()=>Fe,id:()=>J_,identity:()=>mr,inferType:()=>LW,inferTypes:()=>jW,ingest:()=>Ut,inherits:()=>fe,inrange:()=>Ng,interpolate:()=>bR,interpolateColors:()=>hC,interpolateRange:()=>zJ,intersect:()=>wQ,intersectBoxLine:()=>im,intersectPath:()=>BR,intersectPoint:()=>$R,intersectRule:()=>SX,isArray:()=>ie,isBoolean:()=>Wc,isDate:()=>Yc,isFunction:()=>st,isIterable:()=>uG,isNumber:()=>nn,isObject:()=>Se,isRegExp:()=>cG,isString:()=>be,isTuple:()=>SD,key:()=>ON,lerp:()=>dG,lineHeight:()=>yd,loader:()=>DD,locale:()=>RW,logger:()=>EN,lruCache:()=>fG,markup:()=>hF,merge:()=>hG,mergeConfig:()=>Mg,multiLineOffset:()=>QR,one:()=>Ag,pad:()=>pG,panLinear:()=>eG,panLog:()=>tG,panPow:()=>nG,panSymlog:()=>iG,parse:()=>x9e,parseExpression:()=>z3,parseSelector:()=>Bd,path:()=>th,pathCurves:()=>xR,pathEqual:()=>xQ,pathParse:()=>em,pathRectangle:()=>pX,pathRender:()=>Ry,pathSymbols:()=>hX,pathTrail:()=>gX,peek:()=>bt,point:()=>IC,projection:()=>sP,quantileLogNormal:()=>qk,quantileNormal:()=>FD,quantileUniform:()=>Kk,quantiles:()=>Pk,quantizeInterpolator:()=>qJ,quarter:()=>rG,quartiles:()=>Lk,random:()=>jo,randomInteger:()=>S2e,randomKDE:()=>Vk,randomLCG:()=>E2e,randomLogNormal:()=>hY,randomMixture:()=>pY,randomNormal:()=>$k,randomUniform:()=>gY,read:()=>HW,regressionExp:()=>_Y,regressionLinear:()=>Jk,regressionLoess:()=>DY,regressionLog:()=>mY,regressionPoly:()=>vY,regressionPow:()=>yY,regressionQuad:()=>Xk,renderModule:()=>zC,repeat:()=>X_,resetDefaultLocale:()=>yTe,resetSVGClipId:()=>_X,resetSVGDefIds:()=>EFe,responseType:()=>VW,runtimeContext:()=>Bne,sampleCurve:()=>LD,sampleLogNormal:()=>Hk,sampleNormal:()=>ID,sampleUniform:()=>Gk,scale:()=>Pt,sceneEqual:()=>yF,sceneFromJSON:()=>HX,scenePickVisit:()=>xC,sceneToJSON:()=>VX,sceneVisit:()=>Ia,sceneZOrder:()=>VR,scheme:()=>wR,serializeXML:()=>cQ,setRandom:()=>D2e,span:()=>Q_,splitAccessPath:()=>xl,stringValue:()=>pe,textMetrics:()=>Ra,timeBin:()=>uW,timeFloor:()=>XG,timeFormatLocale:()=>fy,timeInterval:()=>jg,timeOffset:()=>eW,timeSequence:()=>iW,timeUnitSpecifier:()=>UG,timeUnits:()=>nk,toBoolean:()=>NN,toDate:()=>kN,toNumber:()=>_r,toSet:()=>Aa,toString:()=>IN,transform:()=>nY,transforms:()=>Ug,truncate:()=>gG,truthy:()=>Fo,tupleid:()=>je,typeParsers:()=>wk,utcFloor:()=>QG,utcInterval:()=>Bg,utcOffset:()=>tW,utcSequence:()=>rW,utcdayofyear:()=>WG,utcquarter:()=>sG,utcweek:()=>YG,version:()=>A9e,visitArray:()=>Kc,week:()=>qG,writeConfig:()=>Tg,zero:()=>qc,zoomLinear:()=>SN,zoomLog:()=>xN,zoomPow:()=>aD,zoomSymlog:()=>AN});var rr={};de.r(rr),de.d(rr,{accessPathDepth:()=>$m,accessPathWithDatum:()=>rj,compile:()=>_Je,contains:()=>Dt,deepEqual:()=>Kl,deleteNestedProperty:()=>jS,duplicate:()=>it,entries:()=>Vd,every:()=>ej,fieldIntersection:()=>ij,flatAccessWithDatum:()=>fre,getFirstDefined:()=>pi,hasIntersection:()=>tj,hash:()=>wt,internalField:()=>gre,isBoolean:()=>Qv,isEmpty:()=>sn,isEqual:()=>q9e,isInternalField:()=>mre,isNullOrFalse:()=>ZL,isNumeric:()=>BS,keys:()=>oe,logicalExpr:()=>Zv,mergeDeep:()=>cre,never:()=>ure,normalize:()=>zoe,normalizeAngle:()=>t1,omit:()=>co,pick:()=>Bm,prefixGenerator:()=>nj,removePathFromField:()=>sj,replaceAll:()=>Vh,replacePathInField:()=>Yo,resetIdCounter:()=>W9e,setEqual:()=>dre,some:()=>$h,stringify:()=>yn,titleCase:()=>e1,unique:()=>Jl,uniqueId:()=>pre,vals:()=>Ar,varName:()=>Fn,version:()=>bJe});var ul={};function Qe(e){return"function"==typeof e}function Ye(e){const n=e(i=>{Error.call(i),i.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}de.r(ul),de.d(ul,{dark:()=>$Je,excel:()=>VJe,fivethirtyeight:()=>zJe,ggplot2:()=>qJe,googlecharts:()=>iXe,latimes:()=>KJe,quartz:()=>JJe,urbaninstitute:()=>nXe,version:()=>rXe,vox:()=>XJe});const Jn=Ye(e=>function(n){e(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function It(e,t){if(e){const n=e.indexOf(t);0<=n&&e.splice(n,1)}}class Xn{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const s of n)s.remove(this);else n.remove(this);const{initialTeardown:i}=this;if(Qe(i))try{i()}catch(s){t=s instanceof Jn?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{bp(s)}catch(o){t=null!=t?t:[],o instanceof Jn?t=[...t,...o.errors]:t.push(o)}}if(t)throw new Jn(t)}}add(t){var n;if(t&&t!==this)if(this.closed)bp(t);else{if(t instanceof Xn){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}}_hasParent(t){const{_parentage:n}=this;return n===t||Array.isArray(n)&&n.includes(t)}_addParent(t){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t}_removeParent(t){const{_parentage:n}=this;n===t?this._parentage=null:Array.isArray(n)&&It(n,t)}remove(t){const{_finalizers:n}=this;n&&It(n,t),t instanceof Xn&&t._removeParent(this)}}Xn.EMPTY=(()=>{const e=new Xn;return e.closed=!0,e})();const mf=Xn.EMPTY;function as(e){return e instanceof Xn||e&&"closed"in e&&Qe(e.remove)&&Qe(e.add)&&Qe(e.unsubscribe)}function bp(e){Qe(e)?e():e.unsubscribe()}const cl={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},_u={setTimeout(e,t,...n){const{delegate:i}=_u;return(null==i?void 0:i.setTimeout)?i.setTimeout(e,t,...n):setTimeout(e,t,...n)},clearTimeout(e){const{delegate:t}=_u;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function yu(e){_u.setTimeout(()=>{const{onUnhandledError:t}=cl;if(!t)throw e;t(e)})}function vu(){}const wp=bu("C",void 0,void 0);function bu(e,t,n){return{kind:e,value:t,error:n}}let wu=null;function H1(e){if(cl.useDeprecatedSynchronousErrorHandling){const t=!wu;if(t&&(wu={errorThrown:!1,error:null}),e(),t){const{errorThrown:n,error:i}=wu;if(wu=null,n)throw i}}else e()}class FA extends Xn{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,as(t)&&t.add(this)):this.destination=Cce}static create(t,n,i){return new U1(t,n,i)}next(t){this.isStopped?LA(function yf(e){return bu("N",e,void 0)}(t),this):this._next(t)}error(t){this.isStopped?LA(function _f(e){return bu("E",void 0,e)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?LA(wp,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const bce=Function.prototype.bind;function PA(e,t){return bce.call(e,t)}class wce{constructor(t){this.partialObserver=t}next(t){const{partialObserver:n}=this;if(n.next)try{n.next(t)}catch(i){z1(i)}}error(t){const{partialObserver:n}=this;if(n.error)try{n.error(t)}catch(i){z1(i)}else z1(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(n){z1(n)}}}class U1 extends FA{constructor(t,n,i){let r;if(super(),Qe(t)||!t)r={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=i?i:void 0};else{let s;this&&cl.useDeprecatedNextContext?(s=Object.create(t),s.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&PA(t.next,s),error:t.error&&PA(t.error,s),complete:t.complete&&PA(t.complete,s)}):r=t}this.destination=new wce(r)}}function z1(e){cl.useDeprecatedSynchronousErrorHandling?function vce(e){cl.useDeprecatedSynchronousErrorHandling&&wu&&(wu.errorThrown=!0,wu.error=e)}(e):yu(e)}function LA(e,t){const{onStoppedNotification:n}=cl;n&&_u.setTimeout(()=>n(e,t))}const Cce={closed:!0,next:vu,error:function Dce(e){throw e},complete:vu},jA="function"==typeof Symbol&&Symbol.observable||"@@observable";function Du(e){return e}let en=(()=>{class e{constructor(n){n&&(this._subscribe=n)}lift(n){const i=new e;return i.source=this,i.operator=n,i}subscribe(n,i,r){const s=function Sce(e){return e&&e instanceof FA||function Ece(e){return e&&Qe(e.next)&&Qe(e.error)&&Qe(e.complete)}(e)&&as(e)}(n)?n:new U1(n,i,r);return H1(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(i){n.error(i)}}forEach(n,i){return new(i=l4(i))((r,s)=>{const o=new U1({next:a=>{try{n(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(n){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(n)}[jA](){return this}pipe(...n){return function a4(e){return 0===e.length?Du:1===e.length?e[0]:function(n){return e.reduce((i,r)=>r(i),n)}}(n)(this)}toPromise(n){return new(n=l4(n))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return e.create=t=>new e(t),e})();function l4(e){var t;return null!==(t=null!=e?e:cl.Promise)&&void 0!==t?t:Promise}const xce=Ye(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Pn=(()=>{class e extends en{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const i=new u4(this,this);return i.operator=n,i}_throwIfClosed(){if(this.closed)throw new xce}next(n){H1(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(n)}})}error(n){H1(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:i}=this;for(;i.length;)i.shift().error(n)}})}complete(){H1(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:i,isStopped:r,observers:s}=this;return i||r?mf:(this.currentObservers=null,s.push(n),new Xn(()=>{this.currentObservers=null,It(s,n)}))}_checkFinalizedStatuses(n){const{hasError:i,thrownError:r,isStopped:s}=this;i?n.error(r):s&&n.complete()}asObservable(){const n=new en;return n.source=this,n}}return e.create=(t,n)=>new u4(t,n),e})();class u4 extends Pn{constructor(t,n){super(),this.destination=t,this.source=n}next(t){var n,i;null===(i=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===i||i.call(n,t)}error(t){var n,i;null===(i=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===i||i.call(n,t)}complete(){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===n||n.call(t)}_subscribe(t){var n,i;return null!==(i=null===(n=this.source)||void 0===n?void 0:n.subscribe(t))&&void 0!==i?i:mf}}function c4(e){return Qe(null==e?void 0:e.lift)}function Qn(e){return t=>{if(c4(t))return t.lift(function(n){try{return e(n,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function bn(e,t,n,i,r){return new Ace(e,t,n,i,r)}class Ace extends FA{constructor(t,n,i,r,s,o){super(t),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(l){t.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){t.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function at(e,t){return Qn((n,i)=>{let r=0;n.subscribe(bn(i,s=>{i.next(e.call(t,s,r++))}))})}function vf(e){return this instanceof vf?(this.v=e,this):new vf(e)}function Oce(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(f){i[f]&&(r[f]=function(h){return new Promise(function(p,g){s.push([f,h,p,g])>1||a(f,h)})})}function a(f,h){try{!function l(f){f.value instanceof vf?Promise.resolve(f.value.v).then(u,c):d(s[0][2],f)}(i[f](h))}catch(p){d(s[0][3],p)}}function u(f){a("next",f)}function c(f){a("throw",f)}function d(f,h){f(h),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Nce(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,t=e[Symbol.asyncIterator];return t?t.call(e):(e=function h4(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(s){n[s]=e[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(u){s({value:u,done:a})},o)}(a,l,(o=e[s](o)).done,o.value)})}}}const $A=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function p4(e){return Qe(null==e?void 0:e.then)}function g4(e){return Qe(e[jA])}function m4(e){return Symbol.asyncIterator&&Qe(null==e?void 0:e[Symbol.asyncIterator])}function _4(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const y4=function Ice(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function v4(e){return Qe(null==e?void 0:e[y4])}function b4(e){return Oce(this,arguments,function*(){const n=e.getReader();try{for(;;){const{value:i,done:r}=yield vf(n.read());if(r)return yield vf(void 0);yield yield vf(i)}}finally{n.releaseLock()}})}function w4(e){return Qe(null==e?void 0:e.getReader)}function sr(e){if(e instanceof en)return e;if(null!=e){if(g4(e))return function Rce(e){return new en(t=>{const n=e[jA]();if(Qe(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if($A(e))return function Fce(e){return new en(t=>{for(let n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(p4(e))return function Pce(e){return new en(t=>{e.then(n=>{t.closed||(t.next(n),t.complete())},n=>t.error(n)).then(null,yu)})}(e);if(m4(e))return D4(e);if(v4(e))return function Lce(e){return new en(t=>{for(const n of e)if(t.next(n),t.closed)return;t.complete()})}(e);if(w4(e))return function jce(e){return D4(b4(e))}(e)}throw _4(e)}function D4(e){return new en(t=>{(function Bce(e,t){var n,i,r,s;return function Mce(e,t,n,i){return new(n||(n=Promise))(function(s,o){function a(c){try{u(i.next(c))}catch(d){o(d)}}function l(c){try{u(i.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):function r(s){return s instanceof n?s:new n(function(o){o(s)})}(c.value).then(a,l)}u((i=i.apply(e,t||[])).next())})}(this,void 0,void 0,function*(){try{for(n=Nce(e);!(i=yield n.next()).done;)if(t.next(i.value),t.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=n.return)&&(yield s.call(n))}finally{if(r)throw r.error}}t.complete()})})(e,t).catch(n=>t.error(n))})}function Cu(e,t,n,i=0,r=!1){const s=t.schedule(function(){n(),r?e.add(this.schedule(null,i)):this.unsubscribe()},i);if(e.add(s),!r)return s}function Zn(e,t,n=1/0){return Qe(t)?Zn((i,r)=>at((s,o)=>t(i,s,r,o))(sr(e(i,r))),n):("number"==typeof t&&(n=t),Qn((i,r)=>function $ce(e,t,n,i,r,s,o,a){const l=[];let u=0,c=0,d=!1;const f=()=>{d&&!l.length&&!u&&t.complete()},h=g=>u<i?p(g):l.push(g),p=g=>{s&&t.next(g),u++;let m=!1;sr(n(g,c++)).subscribe(bn(t,_=>{null==r||r(_),s?h(_):t.next(_)},()=>{m=!0},void 0,()=>{if(m)try{for(u--;l.length&&u<i;){const _=l.shift();o?Cu(t,o,()=>p(_)):p(_)}f()}catch(_){t.error(_)}}))};return e.subscribe(bn(t,h,()=>{d=!0,f()})),()=>{null==a||a()}}(i,r,e,n)))}function b0(e=1/0){return Zn(Du,e)}const ra=new en(e=>e.complete());function C4(e){return e&&Qe(e.schedule)}function VA(e){return e[e.length-1]}function q1(e){return Qe(VA(e))?e.pop():void 0}function w0(e){return C4(VA(e))?e.pop():void 0}function E4(e,t=0){return Qn((n,i)=>{n.subscribe(bn(i,r=>Cu(i,e,()=>i.next(r),t),()=>Cu(i,e,()=>i.complete(),t),r=>Cu(i,e,()=>i.error(r),t)))})}function S4(e,t=0){return Qn((n,i)=>{i.add(e.schedule(()=>n.subscribe(i),t))})}function x4(e,t){if(!e)throw new Error("Iterable cannot be null");return new en(n=>{Cu(n,t,()=>{const i=e[Symbol.asyncIterator]();Cu(n,t,()=>{i.next().then(r=>{r.done?n.complete():n.next(r.value)})},0,!0)})})}function Oi(e,t){return t?function Yce(e,t){if(null!=e){if(g4(e))return function Uce(e,t){return sr(e).pipe(S4(t),E4(t))}(e,t);if($A(e))return function qce(e,t){return new en(n=>{let i=0;return t.schedule(function(){i===e.length?n.complete():(n.next(e[i++]),n.closed||this.schedule())})})}(e,t);if(p4(e))return function zce(e,t){return sr(e).pipe(S4(t),E4(t))}(e,t);if(m4(e))return x4(e,t);if(v4(e))return function Gce(e,t){return new en(n=>{let i;return Cu(n,t,()=>{i=e[y4](),Cu(n,t,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void n.error(o)}s?n.complete():n.next(r)},0,!0)}),()=>Qe(null==i?void 0:i.return)&&i.return()})}(e,t);if(w4(e))return function Wce(e,t){return x4(b4(e),t)}(e,t)}throw _4(e)}(e,t):sr(e)}function A4(...e){const t=w0(e),n=function Hce(e,t){return"number"==typeof VA(e)?e.pop():t}(e,1/0),i=e;return i.length?1===i.length?sr(i[0]):b0(n)(Oi(i,t)):ra}function mi(e){return e<=0?()=>ra:Qn((t,n)=>{let i=0;t.subscribe(bn(n,r=>{++i<=e&&(n.next(r),e<=i&&n.complete())}))})}function M4(e={}){const{connector:t=(()=>new Pn),resetOnError:n=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=e;return s=>{let o=null,a=null,l=null,u=0,c=!1,d=!1;const f=()=>{null==a||a.unsubscribe(),a=null},h=()=>{f(),o=l=null,c=d=!1},p=()=>{const g=o;h(),null==g||g.unsubscribe()};return Qn((g,m)=>{u++,!d&&!c&&f();const _=l=null!=l?l:t();m.add(()=>{u--,0===u&&!d&&!c&&(a=HA(p,r))}),_.subscribe(m),o||(o=new U1({next:y=>_.next(y),error:y=>{d=!0,f(),a=HA(h,n,y),_.error(y)},complete:()=>{c=!0,f(),a=HA(h,i),_.complete()}}),Oi(g).subscribe(o))})(s)}}function HA(e,t,...n){return!0===t?(e(),null):!1===t?null:t(...n).pipe(mi(1)).subscribe(()=>e())}function ln(e){for(let t in e)if(e[t]===ln)return t;throw Error("Could not find renamed property on target object.")}function UA(e,t){for(const n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function Jt(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(Jt).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function zA(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const Kce=ln({__forward_ref__:ln});function Ot(e){return e.__forward_ref__=Ot,e.toString=function(){return Jt(this())},e}function lt(e){return T4(e)?e():e}function T4(e){return"function"==typeof e&&e.hasOwnProperty(Kce)&&e.__forward_ref__===Ot}class xe extends Error{constructor(t,n){super(function qA(e,t){return`NG0${Math.abs(e)}${t?": "+t:""}`}(t,n)),this.code=t}}function Ze(e){return"string"==typeof e?e:null==e?"":String(e)}function kr(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Ze(e)}function G1(e,t){const n=t?` in ${t}`:"";throw new xe(-201,`No provider for ${kr(e)} found${n}`)}function Ps(e,t){null==e&&function wn(e,t,n,i){throw new Error(`ASSERTION ERROR: ${e}`+(null==i?"":` [Expected=> ${n} ${i} ${t} <=Actual]`))}(t,e,null,"!=")}function Ie(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Rt(e){return{providers:e.providers||[],imports:e.imports||[]}}function GA(e){return O4(e,W1)||O4(e,k4)}function O4(e,t){return e.hasOwnProperty(t)?e[t]:null}function N4(e){return e&&(e.hasOwnProperty(WA)||e.hasOwnProperty(nde))?e[WA]:null}const W1=ln({\u0275prov:ln}),WA=ln({\u0275inj:ln}),k4=ln({ngInjectableDef:ln}),nde=ln({ngInjectorDef:ln});var Ke=(()=>((Ke=Ke||{})[Ke.Default=0]="Default",Ke[Ke.Host=1]="Host",Ke[Ke.Self=2]="Self",Ke[Ke.SkipSelf=4]="SkipSelf",Ke[Ke.Optional=8]="Optional",Ke))();let YA;function Cc(e){const t=YA;return YA=e,t}function I4(e,t,n){const i=GA(e);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:n&Ke.Optional?null:void 0!==t?t:void G1(Jt(e),"Injector")}function Ec(e){return{toString:e}.toString()}var sa=(()=>((sa=sa||{})[sa.OnPush=0]="OnPush",sa[sa.Default=1]="Default",sa))(),oa=(()=>{return(e=oa||(oa={}))[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",oa;var e})();const rde="undefined"!=typeof globalThis&&globalThis,sde="undefined"!=typeof window&&window,ode="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,tn=rde||"undefined"!=typeof global&&global||sde||ode,Dp={},un=[],Y1=ln({\u0275cmp:ln}),KA=ln({\u0275dir:ln}),JA=ln({\u0275pipe:ln}),R4=ln({\u0275mod:ln}),Su=ln({\u0275fac:ln}),D0=ln({__NG_ELEMENT_ID__:ln});let ade=0;function Nt(e){return Ec(()=>{const n={},i={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===sa.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||un,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||oa.Emulated,id:"c",styles:e.styles||un,_:null,setInput:null,schemas:e.schemas||null,tView:null},r=e.directives,s=e.features,o=e.pipes;return i.id+=ade++,i.inputs=j4(e.inputs,n),i.outputs=j4(e.outputs),s&&s.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(F4):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(P4):null,i})}function F4(e){return ar(e)||function Sc(e){return e[KA]||null}(e)}function P4(e){return function bf(e){return e[JA]||null}(e)}const L4={};function Vt(e){return Ec(()=>{const t={type:e.type,bootstrap:e.bootstrap||un,declarations:e.declarations||un,imports:e.imports||un,exports:e.exports||un,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(L4[e.id]=e.type),t})}function j4(e,t){if(null==e)return Dp;const n={};for(const i in e)if(e.hasOwnProperty(i)){let r=e[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),n[r]=i,t&&(t[r]=s)}return n}const ye=Nt;function or(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function ar(e){return e[Y1]||null}function vo(e,t){const n=e[R4]||null;if(!n&&!0===t)throw new Error(`Type ${Jt(e)} does not have '\u0275mod' property.`);return n}function dl(e){return Array.isArray(e)&&"object"==typeof e[1]}function la(e){return Array.isArray(e)&&!0===e[1]}function ZA(e){return 0!=(8&e.flags)}function Q1(e){return 2==(2&e.flags)}function Z1(e){return 1==(1&e.flags)}function ua(e){return null!==e.template}function hde(e){return 0!=(512&e[2])}function Ef(e,t){return e.hasOwnProperty(Su)?e[Su]:null}class mde{constructor(t,n,i){this.previousValue=t,this.currentValue=n,this.firstChange=i}isFirstChange(){return this.firstChange}}function Ht(){return $4}function $4(e){return e.type.prototype.ngOnChanges&&(e.setInput=yde),_de}function _de(){const e=H4(this),t=null==e?void 0:e.current;if(t){const n=e.previous;if(n===Dp)e.previous=t;else for(let i in t)n[i]=t[i];e.current=null,this.ngOnChanges(t)}}function yde(e,t,n,i){const r=H4(e)||function vde(e,t){return e[V4]=t}(e,{previous:Dp,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[n],l=o[a];s[a]=new mde(l&&l.currentValue,t,o===Dp),e[i]=t}Ht.ngInherit=!0;const V4="__ngSimpleChanges__";function H4(e){return e[V4]||null}let rM;function Vn(e){return!!e.listen}const U4={createRenderer:(e,t)=>function sM(){return void 0!==rM?rM:"undefined"!=typeof document?document:void 0}()};function oi(e){for(;Array.isArray(e);)e=e[0];return e}function eb(e,t){return oi(t[e])}function Do(e,t){return oi(t[e.index])}function oM(e,t){return e.data[t]}function Ap(e,t){return e[t]}function js(e,t){const n=t[e];return dl(n)?n:n[0]}function z4(e){return 4==(4&e[2])}function aM(e){return 128==(128&e[2])}function xc(e,t){return null==t?null:e[t]}function q4(e){e[18]=0}function lM(e,t){e[5]+=t;let n=e,i=e[3];for(;null!==i&&(1===t&&1===n[5]||-1===t&&0===n[5]);)i[5]+=t,n=i,i=i[3]}const Ge={lFrame:Z4(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function G4(){return Ge.bindingsEnabled}function ae(){return Ge.lFrame.lView}function Ct(){return Ge.lFrame.tView}function ur(e){return Ge.lFrame.contextLView=e,e[8]}function _i(){let e=W4();for(;null!==e&&64===e.type;)e=e.parent;return e}function W4(){return Ge.lFrame.currentTNode}function fl(e,t){const n=Ge.lFrame;n.currentTNode=e,n.isParent=t}function uM(){return Ge.lFrame.isParent}function cM(){Ge.lFrame.isParent=!1}function tb(){return Ge.isInCheckNoChangesMode}function nb(e){Ge.isInCheckNoChangesMode=e}function Ir(){const e=Ge.lFrame;let t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function Mp(){return Ge.lFrame.bindingIndex++}function Au(e){const t=Ge.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function Pde(e,t){const n=Ge.lFrame;n.bindingIndex=n.bindingRootIndex=e,dM(t)}function dM(e){Ge.lFrame.currentDirectiveIndex=e}function J4(){return Ge.lFrame.currentQueryIndex}function hM(e){Ge.lFrame.currentQueryIndex=e}function jde(e){const t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function X4(e,t,n){if(n&Ke.SkipSelf){let r=t,s=e;for(;!(r=r.parent,null!==r||n&Ke.Host||(r=jde(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;t=r,e=s}const i=Ge.lFrame=Q4();return i.currentTNode=t,i.lView=e,!0}function ib(e){const t=Q4(),n=e[1];Ge.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function Q4(){const e=Ge.lFrame,t=null===e?null:e.child;return null===t?Z4(e):t}function Z4(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function e8(){const e=Ge.lFrame;return Ge.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const t8=e8;function rb(){const e=e8();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function Rr(){return Ge.lFrame.selectedIndex}function Ac(e){Ge.lFrame.selectedIndex=e}function Hn(){const e=Ge.lFrame;return oM(e.tView,e.selectedIndex)}function sb(e,t){for(let n=t.directiveStart,i=t.directiveEnd;n<i;n++){const s=e.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:u,ngOnDestroy:c}=s;o&&(e.contentHooks||(e.contentHooks=[])).push(-n,o),a&&((e.contentHooks||(e.contentHooks=[])).push(n,a),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,a)),l&&(e.viewHooks||(e.viewHooks=[])).push(-n,l),u&&((e.viewHooks||(e.viewHooks=[])).push(n,u),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,u)),null!=c&&(e.destroyHooks||(e.destroyHooks=[])).push(n,c)}}function ob(e,t,n){n8(e,t,3,n)}function ab(e,t,n,i){(3&e[2])===n&&n8(e,t,n,i)}function pM(e,t){let n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function n8(e,t,n,i){const s=null!=i?i:-1,o=t.length-1;let a=0;for(let l=void 0!==i?65535&e[18]:0;l<o;l++)if("number"==typeof t[l+1]){if(a=t[l],null!=i&&a>=i)break}else t[l]<0&&(e[18]+=65536),(a<s||-1==s)&&(Wde(e,n,t,l),e[18]=(4294901760&e[18])+l+2),l++}function Wde(e,t,n,i){const r=n[i]<0,s=n[i+1],a=e[r?-n[i]:n[i]];if(r){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class A0{constructor(t,n,i){this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=i}}function lb(e,t,n){const i=Vn(e);let r=0;for(;r<n.length;){const s=n[r];if("number"==typeof s){if(0!==s)break;r++;const o=n[r++],a=n[r++],l=n[r++];i?e.setAttribute(t,a,l,o):t.setAttributeNS(o,a,l)}else{const o=s,a=n[++r];mM(o)?i&&e.setProperty(t,o,a):i?e.setAttribute(t,o,a):t.setAttribute(o,a),r++}}return r}function i8(e){return 3===e||4===e||6===e}function mM(e){return 64===e.charCodeAt(0)}function ub(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else{let n=-1;for(let i=0;i<t.length;i++){const r=t[i];"number"==typeof r?n=r:0===n||r8(e,n,r,null,-1===n||2===n?t[++i]:null)}}return e}function r8(e,t,n,i,r){let s=0,o=e.length;if(-1===t)o=-1;else for(;s<e.length;){const a=e[s++];if("number"==typeof a){if(a===t){o=-1;break}if(a>t){o=s-1;break}}}for(;s<e.length;){const a=e[s];if("number"==typeof a)break;if(a===n){if(null===i)return void(null!==r&&(e[s+1]=r));if(i===e[s+1])return void(e[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(e.splice(o,0,t),s=o+1),e.splice(s++,0,n),null!==i&&e.splice(s++,0,i),null!==r&&e.splice(s++,0,r)}function s8(e){return-1!==e}function Tp(e){return 32767&e}function Op(e,t){let n=function Qde(e){return e>>16}(e),i=t;for(;n>0;)i=i[15],n--;return i}let _M=!0;function cb(e){const t=_M;return _M=e,t}let Zde=0;function T0(e,t){const n=vM(e,t);if(-1!==n)return n;const i=t[1];i.firstCreatePass&&(e.injectorIndex=t.length,yM(i.data,e),yM(t,null),yM(i.blueprint,null));const r=db(e,t),s=e.injectorIndex;if(s8(r)){const o=Tp(r),a=Op(r,t),l=a[1].data;for(let u=0;u<8;u++)t[s+u]=a[o+u]|l[o+u]}return t[s+8]=r,s}function yM(e,t){e.push(0,0,0,0,0,0,0,0,t)}function vM(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function db(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,i=null,r=t;for(;null!==r;){const s=r[1],o=s.type;if(i=2===o?s.declTNode:1===o?r[6]:null,null===i)return-1;if(n++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|n<<16}return-1}function fb(e,t,n){!function efe(e,t,n){let i;"string"==typeof n?i=n.charCodeAt(0)||0:n.hasOwnProperty(D0)&&(i=n[D0]),null==i&&(i=n[D0]=Zde++);const r=255&i;t.data[e+(r>>5)]|=1<<r}(e,t,n)}function l8(e,t,n){if(n&Ke.Optional)return e;G1(t,"NodeInjector")}function u8(e,t,n,i){if(n&Ke.Optional&&void 0===i&&(i=null),0==(n&(Ke.Self|Ke.Host))){const r=e[9],s=Cc(void 0);try{return r?r.get(t,i,n&Ke.Optional):I4(t,i,n&Ke.Optional)}finally{Cc(s)}}return l8(i,t,n)}function c8(e,t,n,i=Ke.Default,r){if(null!==e){const s=function rfe(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(D0)?e[D0]:void 0;return"number"==typeof t?t>=0?255&t:nfe:t}(n);if("function"==typeof s){if(!X4(t,e,i))return i&Ke.Host?l8(r,n,i):u8(t,n,i,r);try{const o=s(i);if(null!=o||i&Ke.Optional)return o;G1(n)}finally{t8()}}else if("number"==typeof s){let o=null,a=vM(e,t),l=-1,u=i&Ke.Host?t[16][6]:null;for((-1===a||i&Ke.SkipSelf)&&(l=-1===a?db(e,t):t[a+8],-1!==l&&h8(i,!1)?(o=t[1],a=Tp(l),t=Op(l,t)):a=-1);-1!==a;){const c=t[1];if(f8(s,a,c.data)){const d=ife(a,t,n,o,i,u);if(d!==d8)return d}l=t[a+8],-1!==l&&h8(i,t[1].data[a+8]===u)&&f8(s,a,t)?(o=c,a=Tp(l),t=Op(l,t)):a=-1}}}return u8(t,n,i,r)}const d8={};function nfe(){return new Np(_i(),ae())}function ife(e,t,n,i,r,s){const o=t[1],a=o.data[e+8],c=hb(a,o,n,null==i?Q1(a)&&_M:i!=o&&0!=(3&a.type),r&Ke.Host&&s===a);return null!==c?O0(t,o,c,a):d8}function hb(e,t,n,i,r){const s=e.providerIndexes,o=t.data,a=1048575&s,l=e.directiveStart,c=s>>20,f=r?a+c:e.directiveEnd;for(let h=i?a:a+c;h<f;h++){const p=o[h];if(h<l&&n===p||h>=l&&p.type===n)return h}if(r){const h=o[l];if(h&&ua(h)&&h.type===n)return l}return null}function O0(e,t,n,i){let r=e[n];const s=t.data;if(function Yde(e){return e instanceof A0}(r)){const o=r;o.resolving&&function Jce(e,t){const n=t?`. Dependency path: ${t.join(" > ")} > ${e}`:"";throw new xe(-200,`Circular dependency in DI detected for ${e}${n}`)}(kr(s[n]));const a=cb(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Cc(o.injectImpl):null;X4(e,i,Ke.Default);try{r=e[n]=o.factory(void 0,s,e,i),t.firstCreatePass&&n>=i.directiveStart&&function Gde(e,t,n){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=t.type.prototype;if(i){const o=$4(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,o)}r&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,r),s&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s))}(n,s[n],t)}finally{null!==l&&Cc(l),cb(a),o.resolving=!1,t8()}}return r}function f8(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function h8(e,t){return!(e&Ke.Self||e&Ke.Host&&t)}class Np{constructor(t,n){this._tNode=t,this._lView=n}get(t,n,i){return c8(this._tNode,this._lView,t,i,n)}}function cr(e){return Ec(()=>{const t=e.prototype.constructor,n=t[Su]||bM(t),i=Object.prototype;let r=Object.getPrototypeOf(e.prototype).constructor;for(;r&&r!==i;){const s=r[Su]||bM(r);if(s&&s!==n)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function bM(e){return T4(e)?()=>{const t=bM(lt(e));return t&&t()}:Ef(e)}const Ip="__parameters__";function Fp(e,t,n){return Ec(()=>{const i=function wM(e){return function(...n){if(e){const i=e(...n);for(const r in i)this[r]=i[r]}}}(t);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,u,c){const d=l.hasOwnProperty(Ip)?l[Ip]:Object.defineProperty(l,Ip,{value:[]})[Ip];for(;d.length<=c;)d.push(null);return(d[c]=d[c]||[]).push(o),l}}return n&&(r.prototype=Object.create(n.prototype)),r.prototype.ngMetadataName=e,r.annotationCls=r,r})}class rt{constructor(t,n){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Ie({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}toString(){return`InjectionToken ${this._desc}`}}const ofe=new rt("AnalyzeForEntryComponents");function Co(e,t){void 0===t&&(t=e);for(let n=0;n<e.length;n++){let i=e[n];Array.isArray(i)?(t===e&&(t=e.slice(0,n)),Co(i,t)):t!==e&&t.push(i)}return t}function hl(e,t){e.forEach(n=>Array.isArray(n)?hl(n,t):t(n))}function g8(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function pb(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function I0(e,t){const n=[];for(let i=0;i<e;i++)n.push(t);return n}function Bs(e,t,n){let i=Pp(e,t);return i>=0?e[1|i]=n:(i=~i,function ufe(e,t,n,i){let r=e.length;if(r==t)e.push(n,i);else if(1===r)e.push(i,e[0]),e[0]=n;else{for(r--,e.push(e[r-1],e[r]);r>t;)e[r]=e[r-2],r--;e[t]=n,e[t+1]=i}}(e,i,t,n)),i}function CM(e,t){const n=Pp(e,t);if(n>=0)return e[1|n]}function Pp(e,t){return function y8(e,t,n){let i=0,r=e.length>>n;for(;r!==i;){const s=i+(r-i>>1),o=e[s<<n];if(t===o)return s<<n;o>t?r=s:i=s+1}return~(r<<n)}(e,t,1)}const R0={},SM="__NG_DI_FLAG__",mb="ngTempTokenPath",mfe=/\n/gm,b8="__source",yfe=ln({provide:String,useValue:ln});let F0;function w8(e){const t=F0;return F0=e,t}function vfe(e,t=Ke.Default){if(void 0===F0)throw new xe(203,"");return null===F0?I4(e,void 0,t):F0.get(e,t&Ke.Optional?null:void 0,t)}function me(e,t=Ke.Default){return(function ide(){return YA}()||vfe)(lt(e),t)}const bfe=me;function xM(e){const t=[];for(let n=0;n<e.length;n++){const i=lt(e[n]);if(Array.isArray(i)){if(0===i.length)throw new xe(900,"");let r,s=Ke.Default;for(let o=0;o<i.length;o++){const a=i[o],l=wfe(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}t.push(me(r,s))}else t.push(me(i))}return t}function P0(e,t){return e[SM]=t,e.prototype[SM]=t,e}function wfe(e){return e[SM]}const _b=P0(Fp("Inject",e=>({token:e})),-1),Tc=P0(Fp("Optional"),8),L0=P0(Fp("SkipSelf"),4);class O8{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function Oc(e){return e instanceof O8?e.changingThisBreaksApplicationSecurity:e}const Ufe=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,zfe=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var ai=(()=>((ai=ai||{})[ai.NONE=0]="NONE",ai[ai.HTML=1]="HTML",ai[ai.STYLE=2]="STYLE",ai[ai.SCRIPT=3]="SCRIPT",ai[ai.URL=4]="URL",ai[ai.RESOURCE_URL=5]="RESOURCE_URL",ai))();function V0(e){const t=function H0(){const e=ae();return e&&e[12]}();return t?t.sanitize(ai.URL,e)||"":function B0(e,t){const n=function Bfe(e){return e instanceof O8&&e.getTypeName()||null}(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===t}(e,"URL")?Oc(e):function wb(e){return(e=String(e)).match(Ufe)||e.match(zfe)?e:"unsafe:"+e}(Ze(e))}const $8="__ngContext__";function dr(e,t){e[$8]=t}function FM(e){const t=function U0(e){return e[$8]||null}(e);return t?Array.isArray(t)?t:t.lView:null}function LM(e){return e.ngOriginalError}function hhe(e,...t){e.error(...t)}class z0{constructor(){this._console=console}handleError(t){const n=this._findOriginalError(t),i=function fhe(e){return e&&e.ngErrorLogger||hhe}(t);i(this._console,"ERROR",t),n&&i(this._console,"ORIGINAL ERROR",n)}_findOriginalError(t){let n=t&&LM(t);for(;n&&LM(n);)n=LM(n);return n||null}}const Che=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(tn))();function gl(e){return e instanceof Function?e():e}var $s=(()=>(($s=$s||{})[$s.Important=1]="Important",$s[$s.DashCase=2]="DashCase",$s))();function BM(e,t){return undefined(e,t)}function q0(e){const t=e[3];return la(t)?t[3]:t}function $M(e){return K8(e[13])}function VM(e){return K8(e[4])}function K8(e){for(;null!==e&&!la(e);)e=e[4];return e}function $p(e,t,n,i,r){if(null!=i){let s,o=!1;la(i)?s=i:dl(i)&&(o=!0,i=i[0]);const a=oi(i);0===e&&null!==n?null==r?t$(t,n,a):xf(t,n,a,r||null,!0):1===e&&null!==n?xf(t,n,a,r||null,!0):2===e?function l$(e,t,n){const i=Cb(e,t);i&&function Lhe(e,t,n,i){Vn(e)?e.removeChild(t,n,i):t.removeChild(n)}(e,i,t,n)}(t,a,o):3===e&&t.destroyNode(a),null!=s&&function $he(e,t,n,i,r){const s=n[7];s!==oi(n)&&$p(t,e,i,s,r);for(let a=10;a<n.length;a++){const l=n[a];G0(l[1],l,e,t,i,s)}}(t,e,s,n,r)}}function UM(e,t,n){if(Vn(e))return e.createElement(t,n);{const i=null!==n?function Cde(e){const t=e.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(n):null;return null===i?e.createElement(t):e.createElementNS(i,t)}}function X8(e,t){const n=e[9],i=n.indexOf(t),r=t[3];1024&t[2]&&(t[2]&=-1025,lM(r,-1)),n.splice(i,1)}function zM(e,t){if(e.length<=10)return;const n=10+t,i=e[n];if(i){const r=i[17];null!==r&&r!==e&&X8(r,i),t>0&&(e[n-1][4]=i[4]);const s=pb(e,10+t);!function The(e,t){G0(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function Q8(e,t){if(!(256&t[2])){const n=t[11];Vn(n)&&n.destroyNode&&G0(e,t,n,3,null,null),function khe(e){let t=e[13];if(!t)return qM(e[1],e);for(;t;){let n=null;if(dl(t))n=t[13];else{const i=t[10];i&&(n=i)}if(!n){for(;t&&!t[4]&&t!==e;)dl(t)&&qM(t[1],t),t=t[3];null===t&&(t=e),dl(t)&&qM(t[1],t),n=t&&t[4]}t=n}}(t)}}function qM(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function Phe(e,t){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let i=0;i<n.length;i+=2){const r=t[n[i]];if(!(r instanceof A0)){const s=n[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(e,t),function Fhe(e,t){const n=e.cleanup,i=t[7];let r=-1;if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const o=n[s+1],a="function"==typeof o?o(t):oi(t[o]),l=i[r=n[s+2]],u=n[s+3];"boolean"==typeof u?a.removeEventListener(n[s],l,u):u>=0?i[r=u]():i[r=-u].unsubscribe(),s+=2}else{const o=i[r=n[s+1]];n[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();t[7]=null}}(e,t),1===t[1].type&&Vn(t[11])&&t[11].destroy();const n=t[17];if(null!==n&&la(t[3])){n!==t[3]&&X8(n,t);const i=t[19];null!==i&&i.detachView(e)}}}function Z8(e,t,n){return function e$(e,t,n){let i=t;for(;null!==i&&40&i.type;)i=(t=i).parent;if(null===i)return n[0];if(2&i.flags){const r=e.data[i.directiveStart].encapsulation;if(r===oa.None||r===oa.Emulated)return null}return Do(i,n)}(e,t.parent,n)}function xf(e,t,n,i,r){Vn(e)?e.insertBefore(t,n,i,r):t.insertBefore(n,i,r)}function t$(e,t,n){Vn(e)?e.appendChild(t,n):t.appendChild(n)}function n$(e,t,n,i,r){null!==i?xf(e,t,n,i,r):t$(e,t,n)}function Cb(e,t){return Vn(e)?e.parentNode(t):t.parentNode}function i$(e,t,n){return s$(e,t,n)}let s$=function r$(e,t,n){return 40&e.type?Do(e,n):null};function Eb(e,t,n,i){const r=Z8(e,i,t),s=t[11],a=i$(i.parent||t[6],i,t);if(null!=r)if(Array.isArray(n))for(let l=0;l<n.length;l++)n$(s,r,n[l],a,!1);else n$(s,r,n,a,!1)}function Sb(e,t){if(null!==t){const n=t.type;if(3&n)return Do(t,e);if(4&n)return WM(-1,e[t.index]);if(8&n){const i=t.child;if(null!==i)return Sb(e,i);{const r=e[t.index];return la(r)?WM(-1,r):oi(r)}}if(32&n)return BM(t,e)()||oi(e[t.index]);{const i=a$(e,t);return null!==i?Array.isArray(i)?i[0]:Sb(q0(e[16]),i):Sb(e,t.next)}}return null}function a$(e,t){return null!==t?e[16][6].projection[t.projection]:null}function WM(e,t){const n=10+e+1;if(n<t.length){const i=t[n],r=i[1].firstChild;if(null!==r)return Sb(i,r)}return t[7]}function YM(e,t,n,i,r,s,o){for(;null!=n;){const a=i[n.index],l=n.type;if(o&&0===t&&(a&&dr(oi(a),i),n.flags|=4),64!=(64&n.flags))if(8&l)YM(e,t,n.child,i,r,s,!1),$p(t,e,r,a,s);else if(32&l){const u=BM(n,i);let c;for(;c=u();)$p(t,e,r,c,s);$p(t,e,r,a,s)}else 16&l?u$(e,t,i,n,r,s):$p(t,e,r,a,s);n=o?n.projectionNext:n.next}}function G0(e,t,n,i,r,s){YM(n,i,e.firstChild,t,r,s,!1)}function u$(e,t,n,i,r,s){const o=n[16],l=o[6].projection[i.projection];if(Array.isArray(l))for(let u=0;u<l.length;u++)$p(t,e,r,l[u],s);else YM(e,t,l,o[3],r,s,!0)}function c$(e,t,n){Vn(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function KM(e,t,n){Vn(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function d$(e,t,n){let i=e.length;for(;;){const r=e.indexOf(t,n);if(-1===r)return r;if(0===r||e.charCodeAt(r-1)<=32){const s=t.length;if(r+s===i||e.charCodeAt(r+s)<=32)return r}n=r+1}}const f$="ng-template";function Hhe(e,t,n){let i=0;for(;i<e.length;){let r=e[i++];if(n&&"class"===r){if(r=e[i],-1!==d$(r.toLowerCase(),t,0))return!0}else if(1===r){for(;i<e.length&&"string"==typeof(r=e[i++]);)if(r.toLowerCase()===t)return!0;return!1}}return!1}function h$(e){return 4===e.type&&e.value!==f$}function Uhe(e,t,n){return t===(4!==e.type||n?e.value:f$)}function zhe(e,t,n){let i=4;const r=e.attrs||[],s=function Whe(e){for(let t=0;t<e.length;t++)if(i8(e[t]))return t;return e.length}(r);let o=!1;for(let a=0;a<t.length;a++){const l=t[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!Uhe(e,l,n)||""===l&&1===t.length){if(ca(i))return!1;o=!0}}else{const u=8&i?l:t[++a];if(8&i&&null!==e.attrs){if(!Hhe(e.attrs,u,n)){if(ca(i))return!1;o=!0}continue}const d=qhe(8&i?"class":l,r,h$(e),n);if(-1===d){if(ca(i))return!1;o=!0;continue}if(""!==u){let f;f=d>s?"":r[d+1].toLowerCase();const h=8&i?f:null;if(h&&-1!==d$(h,u,0)||2&i&&u!==f){if(ca(i))return!1;o=!0}}}}else{if(!o&&!ca(i)&&!ca(l))return!1;if(o&&ca(l))continue;o=!1,i=l|1&i}}return ca(i)||o}function ca(e){return 0==(1&e)}function qhe(e,t,n,i){if(null===t)return-1;let r=0;if(i||!n){let s=!1;for(;r<t.length;){const o=t[r];if(o===e)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=t[++r];for(;"string"==typeof a;)a=t[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function Yhe(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const i=e[n];if("number"==typeof i)return-1;if(i===t)return n;n++}return-1}(t,e)}function p$(e,t,n=!1){for(let i=0;i<t.length;i++)if(zhe(e,t[i],n))return!0;return!1}function Khe(e,t){e:for(let n=0;n<t.length;n++){const i=t[n];if(e.length===i.length){for(let r=0;r<e.length;r++)if(e[r]!==i[r])continue e;return!0}}return!1}function g$(e,t){return e?":not("+t.trim()+")":t}function Jhe(e){let t=e[0],n=1,i=2,r="",s=!1;for(;n<e.length;){let o=e[n];if("string"==typeof o)if(2&i){const a=e[++n];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!ca(o)&&(t+=g$(s,r),r=""),i=o,s=s||!ca(i);n++}return""!==r&&(t+=g$(s,r)),t}const et={};function $(e){m$(Ct(),ae(),Rr()+e,tb())}function m$(e,t,n,i){if(!i)if(3==(3&t[2])){const s=e.preOrderCheckHooks;null!==s&&ob(t,s,n)}else{const s=e.preOrderHooks;null!==s&&ab(t,s,0,n)}Ac(n)}function xb(e,t){return e<<17|t<<2}function da(e){return e>>17&32767}function JM(e){return 2|e}function Mu(e){return(131068&e)>>2}function XM(e,t){return-131069&e|t<<2}function QM(e){return 1|e}function A$(e,t){const n=e.contentQueries;if(null!==n)for(let i=0;i<n.length;i+=2){const r=n[i],s=n[i+1];if(-1!==s){const o=e.data[s];hM(r),o.contentQueries(2,t[s],s)}}}function W0(e,t,n,i,r,s,o,a,l,u){const c=t.blueprint.slice();return c[0]=r,c[2]=140|i,q4(c),c[3]=c[15]=e,c[8]=n,c[10]=o||e&&e[10],c[11]=a||e&&e[11],c[12]=l||e&&e[12]||null,c[9]=u||e&&e[9]||null,c[6]=s,c[16]=2==t.type?e[16]:c,c}function Vp(e,t,n,i,r){let s=e.data[t];if(null===s)s=function aT(e,t,n,i,r){const s=W4(),o=uM(),l=e.data[t]=function ppe(e,t,n,i,r,s){return{type:n,index:i,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,t,i,r);return null===e.firstChild&&(e.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(e,t,n,i,r),function Fde(){return Ge.lFrame.inI18n}()&&(s.flags|=64);else if(64&s.type){s.type=n,s.value=i,s.attrs=r;const o=function x0(){const e=Ge.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return fl(s,!0),s}function Hp(e,t,n,i){if(0===n)return-1;const r=t.length;for(let s=0;s<n;s++)t.push(i),e.blueprint.push(i),e.data.push(null);return r}function Y0(e,t,n){ib(t);try{const i=e.viewQuery;null!==i&&mT(1,i,n);const r=e.template;null!==r&&M$(e,t,r,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&A$(e,t),e.staticViewQueries&&mT(2,e.viewQuery,n);const s=e.components;null!==s&&function dpe(e,t){for(let n=0;n<t.length;n++)kpe(e,t[n])}(t,s)}catch(i){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),i}finally{t[2]&=-5,rb()}}function Up(e,t,n,i){const r=t[2];if(256==(256&r))return;ib(t);const s=tb();try{q4(t),function Y4(e){return Ge.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&M$(e,t,n,2,i);const o=3==(3&r);if(!s)if(o){const u=e.preOrderCheckHooks;null!==u&&ob(t,u,null)}else{const u=e.preOrderHooks;null!==u&&ab(t,u,0,null),pM(t,0)}if(function Ope(e){for(let t=$M(e);null!==t;t=VM(t)){if(!t[2])continue;const n=t[9];for(let i=0;i<n.length;i++){const r=n[i],s=r[3];0==(1024&r[2])&&lM(s,1),r[2]|=1024}}}(t),function Tpe(e){for(let t=$M(e);null!==t;t=VM(t))for(let n=10;n<t.length;n++){const i=t[n],r=i[1];aM(i)&&Up(r,i,r.template,i[8])}}(t),null!==e.contentQueries&&A$(e,t),!s)if(o){const u=e.contentCheckHooks;null!==u&&ob(t,u)}else{const u=e.contentHooks;null!==u&&ab(t,u,1),pM(t,1)}!function upe(e,t){const n=e.hostBindingOpCodes;if(null!==n)try{for(let i=0;i<n.length;i++){const r=n[i];if(r<0)Ac(~r);else{const s=r,o=n[++i],a=n[++i];Pde(o,s),a(2,t[s])}}}finally{Ac(-1)}}(e,t);const a=e.components;null!==a&&function cpe(e,t){for(let n=0;n<t.length;n++)Npe(e,t[n])}(t,a);const l=e.viewQuery;if(null!==l&&mT(2,l,i),!s)if(o){const u=e.viewCheckHooks;null!==u&&ob(t,u)}else{const u=e.viewHooks;null!==u&&ab(t,u,2),pM(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),s||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,lM(t[3],-1))}finally{rb()}}function fpe(e,t,n,i){const r=t[10],s=!tb(),o=z4(t);try{s&&!o&&r.begin&&r.begin(),o&&Y0(e,t,i),Up(e,t,n,i)}finally{s&&!o&&r.end&&r.end()}}function M$(e,t,n,i,r){const s=Rr(),o=2&i;try{Ac(-1),o&&t.length>20&&m$(e,t,20,tb()),n(i,r)}finally{Ac(s)}}function lT(e,t,n){!G4()||(function wpe(e,t,n,i){const r=n.directiveStart,s=n.directiveEnd;e.firstCreatePass||T0(n,t),dr(i,t);const o=n.initialInputs;for(let a=r;a<s;a++){const l=e.data[a],u=ua(l);u&&xpe(t,n,l);const c=O0(t,e,a,n);dr(c,t),null!==o&&Ape(0,a-r,c,l,0,o),u&&(js(n.index,t)[8]=c)}}(e,t,n,Do(n,t)),128==(128&n.flags)&&function Dpe(e,t,n){const i=n.directiveStart,r=n.directiveEnd,o=n.index,a=function Lde(){return Ge.lFrame.currentDirectiveIndex}();try{Ac(o);for(let l=i;l<r;l++){const u=e.data[l],c=t[l];dM(l),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&L$(u,c)}}finally{Ac(-1),dM(a)}}(e,t,n))}function uT(e,t,n=Do){const i=t.localNames;if(null!==i){let r=t.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?n(t,e):e[o];e[r++]=a}}}function O$(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Tb(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function Tb(e,t,n,i,r,s,o,a,l,u){const c=20+i,d=c+r,f=function hpe(e,t){const n=[];for(let i=0;i<t;i++)n.push(i<e?null:et);return n}(c,d),h="function"==typeof u?u():u;return f[1]={type:e,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:t,data:f.slice().fill(null,c),bindingStartIndex:c,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:h,incompleteFirstPass:!1}}function I$(e,t,n,i){const r=U$(t);null===n?r.push(i):(r.push(n),e.firstCreatePass&&z$(e).push(i,r.length-1))}function R$(e,t,n){for(let i in e)if(e.hasOwnProperty(i)){const r=e[i];(n=null===n?{}:n).hasOwnProperty(i)?n[i].push(t,r):n[i]=[t,r]}return n}function Vs(e,t,n,i,r,s,o,a){const l=Do(t,n);let c,u=t.inputs;!a&&null!=u&&(c=u[i])?(W$(e,n,c,i,r),Q1(t)&&function _pe(e,t){const n=js(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(i=function mpe(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(i),r=null!=o?o(r,t.value||"",i):r,Vn(s)?s.setProperty(l,i,r):mM(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function cT(e,t,n,i){let r=!1;if(G4()){const s=function Cpe(e,t,n){const i=e.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];p$(n,o.selectors,!1)&&(r||(r=[]),fb(T0(n,t),e,o.type),ua(o)?(j$(e,n),r.unshift(o)):r.push(o))}return r}(e,t,n),o=null===i?null:{"":-1};if(null!==s){r=!0,B$(n,e.data.length,s.length);for(let c=0;c<s.length;c++){const d=s[c];d.providersResolver&&d.providersResolver(d)}let a=!1,l=!1,u=Hp(e,t,s.length,null);for(let c=0;c<s.length;c++){const d=s[c];n.mergedAttrs=ub(n.mergedAttrs,d.hostAttrs),$$(e,n,t,u,d),Spe(u,d,o),null!==d.contentQueries&&(n.flags|=8),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(n.flags|=128);const f=d.type.prototype;!a&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),a=!0),!l&&(f.ngOnChanges||f.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),l=!0),u++}!function gpe(e,t){const i=t.directiveEnd,r=e.data,s=t.attrs,o=[];let a=null,l=null;for(let u=t.directiveStart;u<i;u++){const c=r[u],d=c.inputs,f=null===s||h$(t)?null:Mpe(d,s);o.push(f),a=R$(d,u,a),l=R$(c.outputs,u,l)}null!==a&&(a.hasOwnProperty("class")&&(t.flags|=16),a.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=o,t.inputs=a,t.outputs=l}(e,n)}o&&function Epe(e,t,n){if(t){const i=e.localNames=[];for(let r=0;r<t.length;r+=2){const s=n[t[r+1]];if(null==s)throw new xe(-301,!1);i.push(t[r],s)}}}(n,i,o)}return n.mergedAttrs=ub(n.mergedAttrs,n.attrs),r}function P$(e,t,n,i,r,s){const o=s.hostBindings;if(o){let a=e.hostBindingOpCodes;null===a&&(a=e.hostBindingOpCodes=[]);const l=~t.index;(function bpe(e){let t=e.length;for(;t>0;){const n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(a)!=l&&a.push(l),a.push(i,r,o)}}function L$(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function j$(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function Spe(e,t,n){if(n){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)n[t.exportAs[i]]=e;ua(t)&&(n[""]=e)}}function B$(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function $$(e,t,n,i,r){e.data[i]=r;const s=r.factory||(r.factory=Ef(r.type)),o=new A0(s,ua(r),null);e.blueprint[i]=o,n[i]=o,P$(e,t,0,i,Hp(e,n,r.hostVars,et),r)}function xpe(e,t,n){const i=Do(t,e),r=O$(n),s=e[10],o=Ob(e,W0(e,r,null,n.onPush?64:16,i,t,s,s.createRenderer(i,n),null,null));e[t.index]=o}function ml(e,t,n,i,r,s){const o=Do(e,t);!function dT(e,t,n,i,r,s,o){if(null==s)Vn(e)?e.removeAttribute(t,r,n):t.removeAttribute(r);else{const a=null==o?Ze(s):o(s,i||"",r);Vn(e)?e.setAttribute(t,r,a,n):n?t.setAttributeNS(n,r,a):t.setAttribute(r,a)}}(t[11],o,s,e.value,n,i,r)}function Ape(e,t,n,i,r,s){const o=s[t];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const u=o[l++],c=o[l++],d=o[l++];null!==a?i.setInput(n,d,u,c):n[c]=d}}}function Mpe(e,t){let n=null,i=0;for(;i<t.length;){const r=t[i];if(0!==r)if(5!==r){if("number"==typeof r)break;e.hasOwnProperty(r)&&(null===n&&(n=[]),n.push(r,e[r],t[i+1])),i+=2}else i+=2;else i+=4}return n}function V$(e,t,n,i){return new Array(e,!0,!1,t,null,0,i,n,null,null)}function Npe(e,t){const n=js(t,e);if(aM(n)){const i=n[1];80&n[2]?Up(i,n,i.template,n[8]):n[5]>0&&fT(n)}}function fT(e){for(let i=$M(e);null!==i;i=VM(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const o=s[1];Up(o,s,o.template,s[8])}else s[5]>0&&fT(s)}const n=e[1].components;if(null!==n)for(let i=0;i<n.length;i++){const r=js(n[i],e);aM(r)&&r[5]>0&&fT(r)}}function kpe(e,t){const n=js(t,e),i=n[1];(function Ipe(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])})(i,n),Y0(i,n,n[8])}function Ob(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function hT(e){for(;e;){e[2]|=64;const t=q0(e);if(hde(e)&&!t)return e;e=t}return null}function gT(e,t,n){const i=t[10];i.begin&&i.begin();try{Up(e,t,e.template,n)}catch(r){throw G$(t,r),r}finally{i.end&&i.end()}}function H$(e){!function pT(e){for(let t=0;t<e.components.length;t++){const n=e.components[t],i=FM(n),r=i[1];fpe(r,i,r.template,n)}}(e[8])}function mT(e,t,n){hM(0),t(e,n)}const Lpe=(()=>Promise.resolve(null))();function U$(e){return e[7]||(e[7]=[])}function z$(e){return e.cleanup||(e.cleanup=[])}function G$(e,t){const n=e[9],i=n?n.get(z0,null):null;i&&i.handleError(t)}function W$(e,t,n,i,r){for(let s=0;s<n.length;){const o=n[s++],a=n[s++],l=t[o],u=e.data[o];null!==u.setInput?u.setInput(l,r,i,a):l[a]=r}}function Tu(e,t,n){const i=eb(t,e);!function J8(e,t,n){Vn(e)?e.setValue(t,n):t.textContent=n}(e[11],i,n)}function Nb(e,t,n){let i=n?e.styles:null,r=n?e.classes:null,s=0;if(null!==t)for(let o=0;o<t.length;o++){const a=t[o];"number"==typeof a?s=a:1==s?r=zA(r,a):2==s&&(i=zA(i,a+": "+t[++o]+";"))}n?e.styles=i:e.stylesWithoutHost=i,n?e.classes=r:e.classesWithoutHost=r}const _T=new rt("INJECTOR",-1);class Y${get(t,n=R0){if(n===R0){const i=new Error(`NullInjectorError: No provider for ${Jt(t)}!`);throw i.name="NullInjectorError",i}return n}}const yT=new rt("Set Injector scope."),K0={},$pe={};let vT;function K$(){return void 0===vT&&(vT=new Y$),vT}function J$(e,t=null,n=null,i){const r=X$(e,t,n,i);return r._resolveInjectorDefTypes(),r}function X$(e,t=null,n=null,i){return new Vpe(e,n,t||K$(),i)}class Vpe{constructor(t,n,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];n&&hl(n,a=>this.processProvider(a,t,n)),hl([t],a=>this.processInjectorType(a,[],s)),this.records.set(_T,zp(void 0,this));const o=this.records.get(yT);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof t?null:Jt(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,n=R0,i=Ke.Default){this.assertNotDestroyed();const r=w8(this),s=Cc(void 0);try{if(!(i&Ke.SkipSelf)){let a=this.records.get(t);if(void 0===a){const l=function Kpe(e){return"function"==typeof e||"object"==typeof e&&e instanceof rt}(t)&&GA(t);a=l&&this.injectableDefInScope(l)?zp(bT(t),K0):null,this.records.set(t,a)}if(null!=a)return this.hydrate(t,a)}return(i&Ke.Self?K$():this.parent).get(t,n=i&Ke.Optional&&n===R0?null:n)}catch(o){if("NullInjectorError"===o.name){if((o[mb]=o[mb]||[]).unshift(Jt(t)),r)throw o;return function Dfe(e,t,n,i){const r=e[mb];throw t[b8]&&r.unshift(t[b8]),e.message=function Cfe(e,t,n,i=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;let r=Jt(t);if(Array.isArray(t))r=t.map(Jt).join(" -> ");else if("object"==typeof t){let s=[];for(let o in t)if(t.hasOwnProperty(o)){let a=t[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Jt(a)))}r=`{${s.join(", ")}}`}return`${n}${i?"("+i+")":""}[${r}]: ${e.replace(mfe,"\n  ")}`}("\n"+e.message,r,n,i),e.ngTokenPath=r,e[mb]=null,e}(o,t,"R3InjectorError",this.source)}throw o}finally{Cc(s),w8(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((i,r)=>t.push(Jt(r))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new xe(205,!1)}processInjectorType(t,n,i){if(!(t=lt(t)))return!1;let r=N4(t);const s=null==r&&t.ngModule||void 0,o=void 0===s?t:s,a=-1!==i.indexOf(o);if(void 0!==s&&(r=N4(s)),null==r)return!1;if(null!=r.imports&&!a){let c;i.push(o);try{hl(r.imports,d=>{this.processInjectorType(d,n,i)&&(void 0===c&&(c=[]),c.push(d))})}finally{}if(void 0!==c)for(let d=0;d<c.length;d++){const{ngModule:f,providers:h}=c[d];hl(h,p=>this.processProvider(p,f,h||un))}}this.injectorDefTypes.add(o);const l=Ef(o)||(()=>new o);this.records.set(o,zp(l,K0));const u=r.providers;if(null!=u&&!a){const c=t;hl(u,d=>this.processProvider(d,c,u))}return void 0!==s&&void 0!==t.providers}processProvider(t,n,i){let r=qp(t=lt(t))?t:lt(t&&t.provide);const s=function Upe(e,t,n){return Z$(e)?zp(void 0,e.useValue):zp(Q$(e),K0)}(t);if(qp(t)||!0!==t.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=zp(void 0,K0,!0),o.factory=()=>xM(o.multi),this.records.set(r,o)),r=t,o.multi.push(t)}this.records.set(r,s)}hydrate(t,n){return n.value===K0&&(n.value=$pe,n.value=n.factory()),"object"==typeof n.value&&n.value&&function Ype(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(n.value)&&this.onDestroy.add(n.value),n.value}injectableDefInScope(t){if(!t.providedIn)return!1;const n=lt(t.providedIn);return"string"==typeof n?"any"===n||n===this.scope:this.injectorDefTypes.has(n)}}function bT(e){const t=GA(e),n=null!==t?t.factory:Ef(e);if(null!==n)return n;if(e instanceof rt)throw new xe(204,!1);if(e instanceof Function)return function Hpe(e){const t=e.length;if(t>0)throw I0(t,"?"),new xe(204,!1);const n=function ede(e){const t=e&&(e[W1]||e[k4]);if(t){const n=function tde(e){if(e.hasOwnProperty("name"))return e.name;const t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),t}return null}(e);return null!==n?()=>n.factory(e):()=>new e}(e);throw new xe(204,!1)}function Q$(e,t,n){let i;if(qp(e)){const r=lt(e);return Ef(r)||bT(r)}if(Z$(e))i=()=>lt(e.useValue);else if(function qpe(e){return!(!e||!e.useFactory)}(e))i=()=>e.useFactory(...xM(e.deps||[]));else if(function zpe(e){return!(!e||!e.useExisting)}(e))i=()=>me(lt(e.useExisting));else{const r=lt(e&&(e.useClass||e.provide));if(!function Wpe(e){return!!e.deps}(e))return Ef(r)||bT(r);i=()=>new r(...xM(e.deps))}return i}function zp(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function Z$(e){return null!==e&&"object"==typeof e&&yfe in e}function qp(e){return"function"==typeof e}let li=(()=>{class e{static create(n,i){var r;if(Array.isArray(n))return J$({name:""},i,n,"");{const s=null!==(r=n.name)&&void 0!==r?r:"";return J$({name:s},n.parent,n.providers,s)}}}return e.THROW_IF_NOT_FOUND=R0,e.NULL=new Y$,e.\u0275prov=Ie({token:e,providedIn:"any",factory:()=>me(_T)}),e.__NG_ELEMENT_ID__=-1,e})();function ige(e,t){sb(FM(e)[1],_i())}function zt(e){let t=function d6(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0;const i=[e];for(;t;){let r;if(ua(e))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new xe(903,"");r=t.\u0275dir}if(r){if(n){i.push(r);const o=e;o.inputs=CT(e.inputs),o.declaredInputs=CT(e.declaredInputs),o.outputs=CT(e.outputs);const a=r.hostBindings;a&&age(e,a);const l=r.viewQuery,u=r.contentQueries;if(l&&sge(e,l),u&&oge(e,u),UA(e.inputs,r.inputs),UA(e.declaredInputs,r.declaredInputs),UA(e.outputs,r.outputs),ua(r)&&r.data.animation){const c=e.data;c.animation=(c.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(e),a===zt&&(n=!1)}}t=Object.getPrototypeOf(t)}!function rge(e){let t=0,n=null;for(let i=e.length-1;i>=0;i--){const r=e[i];r.hostVars=t+=r.hostVars,r.hostAttrs=ub(r.hostAttrs,n=ub(n,r.hostAttrs))}}(i)}function CT(e){return e===Dp?{}:e===un?[]:e}function sge(e,t){const n=e.viewQuery;e.viewQuery=n?(i,r)=>{t(i,r),n(i,r)}:t}function oge(e,t){const n=e.contentQueries;e.contentQueries=n?(i,r,s)=>{t(i,r,s),n(i,r,s)}:t}function age(e,t){const n=e.hostBindings;e.hostBindings=n?(i,r)=>{t(i,r),n(i,r)}:t}let kb=null;function Gp(){if(!kb){const e=tn.Symbol;if(e&&e.iterator)kb=e.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let n=0;n<t.length;++n){const i=t[n];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(kb=i)}}}return kb}function J0(e){return!!ET(e)&&(Array.isArray(e)||!(e instanceof Map)&&Gp()in e)}function ET(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function fr(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function cn(e,t,n,i){const r=ae();return fr(r,Mp(),t)&&(Ct(),ml(Hn(),r,e,t,n,i)),cn}function Yp(e,t,n,i){return fr(e,Mp(),n)?t+Ze(n)+i:et}function Ne(e,t,n,i,r,s,o,a){const l=ae(),u=Ct(),c=e+20,d=u.firstCreatePass?function pge(e,t,n,i,r,s,o,a,l){const u=t.consts,c=Vp(t,e,4,o||null,xc(u,a));cT(t,n,c,xc(u,l)),sb(t,c);const d=c.tViews=Tb(2,c,i,r,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,u);return null!==t.queries&&(t.queries.template(t,c),d.queries=t.queries.embeddedTView(c)),c}(c,u,l,t,n,i,r,s,o):u.data[c];fl(d,!1);const f=l[11].createComment("");Eb(u,l,f,d),dr(f,l),Ob(l,l[c]=V$(f,l,f,d)),Z1(d)&&lT(u,l,d),null!=o&&uT(l,d,a)}function So(e){return Ap(function Rde(){return Ge.lFrame.contextLView}(),20+e)}function H(e,t=Ke.Default){const n=ae();return null===n?me(e,t):c8(_i(),n,lt(e),t)}function TT(){throw new Error("invalid")}function U(e,t,n){const i=ae();return fr(i,Mp(),t)&&Vs(Ct(),Hn(),i,e,t,i[11],n,!1),U}function OT(e,t,n,i,r){const o=r?"class":"style";W$(e,n,t.inputs[o],o,i)}function S(e,t,n,i){const r=ae(),s=Ct(),o=20+e,a=r[11],l=r[o]=UM(a,t,function qde(){return Ge.lFrame.currentNamespace}()),u=s.firstCreatePass?function Fge(e,t,n,i,r,s,o){const a=t.consts,u=Vp(t,e,2,r,xc(a,s));return cT(t,n,u,xc(a,o)),null!==u.attrs&&Nb(u,u.attrs,!1),null!==u.mergedAttrs&&Nb(u,u.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,u),u}(o,s,r,0,t,n,i):s.data[o];fl(u,!0);const c=u.mergedAttrs;null!==c&&lb(a,l,c);const d=u.classes;null!==d&&KM(a,l,d);const f=u.styles;return null!==f&&c$(a,l,f),64!=(64&u.flags)&&Eb(s,r,l,u),0===function Tde(){return Ge.lFrame.elementDepthCount}()&&dr(l,r),function Ode(){Ge.lFrame.elementDepthCount++}(),Z1(u)&&(lT(s,r,u),function T$(e,t,n){if(ZA(t)){const r=t.directiveEnd;for(let s=t.directiveStart;s<r;s++){const o=e.data[s];o.contentQueries&&o.contentQueries(1,n[s],s)}}}(s,u,r)),null!==i&&uT(r,u),S}function M(){let e=_i();uM()?cM():(e=e.parent,fl(e,!1));const t=e;!function Nde(){Ge.lFrame.elementDepthCount--}();const n=Ct();return n.firstCreatePass&&(sb(n,e),ZA(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function Jde(e){return 0!=(16&e.flags)}(t)&&OT(n,t,ae(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function Xde(e){return 0!=(32&e.flags)}(t)&&OT(n,t,ae(),t.stylesWithoutHost,!1),M}function Me(e,t,n,i){return S(e,t,n,i),M(),Me}function Hs(){return ae()}function Q0(e){return!!e&&"function"==typeof e.then}const IT=function k6(e){return!!e&&"function"==typeof e.subscribe};function ke(e,t,n,i){const r=ae(),s=Ct(),o=_i();return function R6(e,t,n,i,r,s,o,a){const l=Z1(i),c=e.firstCreatePass&&z$(e),d=t[8],f=U$(t);let h=!0;if(3&i.type||a){const m=Do(i,t),_=a?a(m):m,y=f.length,v=a?b=>a(oi(b[i.index])):i.index;if(Vn(n)){let b=null;if(!a&&l&&(b=function Lge(e,t,n,i){const r=e.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===n&&r[s+1]===i){const a=t[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(e,t,r,i.index)),null!==b)(b.__ngLastListenerFn__||b).__ngNextListenerFn__=s,b.__ngLastListenerFn__=s,h=!1;else{s=RT(i,t,d,s,!1);const D=n.listen(_,r,s);f.push(s,D),c&&c.push(r,v,y,y+1)}}else s=RT(i,t,d,s,!0),_.addEventListener(r,s,o),f.push(s),c&&c.push(r,v,y,o)}else s=RT(i,t,d,s,!1);const p=i.outputs;let g;if(h&&null!==p&&(g=p[r])){const m=g.length;if(m)for(let _=0;_<m;_+=2){const C=t[g[_]][g[_+1]].subscribe(s),w=f.length;f.push(s,C),c&&c.push(r,i.index,w,-(w+1))}}}(s,r,r[11],o,e,t,!!n,i),ke}function F6(e,t,n,i){try{return!1!==n(i)}catch(r){return G$(e,r),!1}}function RT(e,t,n,i,r){return function s(o){if(o===Function)return i;const a=2&e.flags?js(e.index,t):t;0==(32&t[2])&&hT(a);let l=F6(t,0,i,o),u=s.__ngNextListenerFn__;for(;u;)l=F6(t,0,u,o)&&l,u=u.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function Et(e=1){return function Bde(e){return(Ge.lFrame.contextLView=function $de(e,t){for(;e>0;)t=t[15],e--;return t}(e,Ge.lFrame.contextLView))[8]}(e)}function jge(e,t){let n=null;const i=function Ghe(e){const t=e.attrs;if(null!=t){const n=t.indexOf(5);if(0==(1&n))return t[n+1]}return null}(e);for(let r=0;r<t.length;r++){const s=t[r];if("*"!==s){if(null===i?p$(e,s,!0):Khe(i,s))return r}else n=r}return n}function FT(e){const t=ae()[16][6];if(!t.projection){const i=t.projection=I0(e?e.length:1,null),r=i.slice();let s=t.child;for(;null!==s;){const o=e?jge(s,e):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function PT(e,t=0,n){const i=ae(),r=Ct(),s=Vp(r,20+e,16,null,n||null);null===s.projection&&(s.projection=t),cM(),64!=(64&s.flags)&&function Bhe(e,t,n){u$(t[11],0,t,n,Z8(e,n,t),i$(n.parent||t[6],n,t))}(r,i,s)}function Z0(e,t,n){return Fb(e,"",t,"",n),Z0}function Fb(e,t,n,i,r){const s=ae(),o=Yp(s,t,n,i);return o!==et&&Vs(Ct(),Hn(),s,e,o,s[11],r,!1),Fb}function z6(e,t,n,i,r){const s=e[n+1],o=null===t;let a=i?da(s):Mu(s),l=!1;for(;0!==a&&(!1===l||o);){const c=e[a+1];Vge(e[a],t)&&(l=!0,e[a+1]=i?QM(c):JM(c)),a=i?da(c):Mu(c)}l&&(e[n+1]=i?JM(s):QM(s))}function Vge(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&Pp(e,t)>=0}const vi={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function q6(e){return e.substring(vi.key,vi.keyEnd)}function G6(e,t){const n=vi.textEnd;return n===t?-1:(t=vi.keyEnd=function qge(e,t,n){for(;t<n&&e.charCodeAt(t)>32;)t++;return t}(e,vi.key=t,n),ig(e,t,n))}function ig(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function An(e,t){return function ha(e,t,n,i){const r=ae(),s=Ct(),o=Au(2);s.firstUpdatePass&&Q6(s,e,o,i),t!==et&&fr(r,o,t)&&eV(s,s.data[Rr()],r,r[11],e,r[o+1]=function tme(e,t){return null==e||("string"==typeof t?e+=t:"object"==typeof e&&(e=Jt(Oc(e)))),e}(t,n),i,o)}(e,t,null,!0),An}function Ic(e){pa(Bs,vl,e,!0)}function vl(e,t){for(let n=function Uge(e){return function Y6(e){vi.key=0,vi.keyEnd=0,vi.value=0,vi.valueEnd=0,vi.textEnd=e.length}(e),G6(e,ig(e,0,vi.textEnd))}(t);n>=0;n=G6(t,n))Bs(e,q6(t),!0)}function pa(e,t,n,i){const r=Ct(),s=Au(2);r.firstUpdatePass&&Q6(r,null,s,i);const o=ae();if(n!==et&&fr(o,s,n)){const a=r.data[Rr()];if(nV(a,i)&&!X6(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(n=zA(l,n||"")),OT(r,a,o,n,i)}else!function eme(e,t,n,i,r,s,o,a){r===et&&(r=un);let l=0,u=0,c=0<r.length?r[0]:null,d=0<s.length?s[0]:null;for(;null!==c||null!==d;){const f=l<r.length?r[l+1]:void 0,h=u<s.length?s[u+1]:void 0;let g,p=null;c===d?(l+=2,u+=2,f!==h&&(p=d,g=h)):null===d||null!==c&&c<d?(l+=2,p=c):(u+=2,p=d,g=h),null!==p&&eV(e,t,n,i,p,g,o,a),c=l<r.length?r[l]:null,d=u<s.length?s[u]:null}}(r,a,o,o[11],o[s+1],o[s+1]=function Zge(e,t,n){if(null==n||""===n)return un;const i=[],r=Oc(n);if(Array.isArray(r))for(let s=0;s<r.length;s++)e(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&e(i,s,r[s]);else"string"==typeof r&&t(i,r);return i}(e,t,n),i,s)}}function X6(e,t){return t>=e.expandoStartIndex}function Q6(e,t,n,i){const r=e.data;if(null===r[n+1]){const s=r[Rr()],o=X6(e,n);nV(s,i)&&null===t&&!o&&(t=!1),t=function Kge(e,t,n,i){const r=function fM(e){const t=Ge.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e);let s=i?t.residualClasses:t.residualStyles;if(null===r)0===(i?t.classBindings:t.styleBindings)&&(n=e_(n=jT(null,e,t,n,i),t.attrs,i),s=null);else{const o=t.directiveStylingLast;if(-1===o||e[o]!==r)if(n=jT(r,e,t,n,i),null===s){let l=function Jge(e,t,n){const i=n?t.classBindings:t.styleBindings;if(0!==Mu(i))return e[da(i)]}(e,t,i);void 0!==l&&Array.isArray(l)&&(l=jT(null,e,t,l[1],i),l=e_(l,t.attrs,i),function Xge(e,t,n,i){e[da(n?t.classBindings:t.styleBindings)]=i}(e,t,i,l))}else s=function Qge(e,t,n){let i;const r=t.directiveEnd;for(let s=1+t.directiveStylingLast;s<r;s++)i=e_(i,e[s].hostAttrs,n);return e_(i,t.attrs,n)}(e,t,i)}return void 0!==s&&(i?t.residualClasses=s:t.residualStyles=s),n}(r,s,t,i),function Bge(e,t,n,i,r,s){let o=s?t.classBindings:t.styleBindings,a=da(o),l=Mu(o);e[i]=n;let c,u=!1;if(Array.isArray(n)){const d=n;c=d[1],(null===c||Pp(d,c)>0)&&(u=!0)}else c=n;if(r)if(0!==l){const f=da(e[a+1]);e[i+1]=xb(f,a),0!==f&&(e[f+1]=XM(e[f+1],i)),e[a+1]=function Zhe(e,t){return 131071&e|t<<17}(e[a+1],i)}else e[i+1]=xb(a,0),0!==a&&(e[a+1]=XM(e[a+1],i)),a=i;else e[i+1]=xb(l,0),0===a?a=i:e[l+1]=XM(e[l+1],i),l=i;u&&(e[i+1]=JM(e[i+1])),z6(e,c,i,!0),z6(e,c,i,!1),function $ge(e,t,n,i,r){const s=r?e.residualClasses:e.residualStyles;null!=s&&"string"==typeof t&&Pp(s,t)>=0&&(n[i+1]=QM(n[i+1]))}(t,c,e,i,s),o=xb(a,l),s?t.classBindings=o:t.styleBindings=o}(r,s,t,n,o,i)}}function jT(e,t,n,i,r){let s=null;const o=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<o&&(s=t[a],i=e_(i,s.hostAttrs,r),s!==e);)a++;return null!==e&&(n.directiveStylingLast=a),i}function e_(e,t,n){const i=n?1:2;let r=-1;if(null!==t)for(let s=0;s<t.length;s++){const o=t[s];"number"==typeof o?r=o:r===i&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),Bs(e,o,!!n||t[++s]))}return void 0===e?null:e}function eV(e,t,n,i,r,s,o,a){if(!(3&t.type))return;const l=e.data,u=l[a+1];Pb(function v$(e){return 1==(1&e)}(u)?tV(l,t,n,r,Mu(u),o):void 0)||(Pb(s)||function y$(e){return 2==(2&e)}(u)&&(s=tV(l,null,n,r,a,o)),function Vhe(e,t,n,i,r){const s=Vn(e);if(t)r?s?e.addClass(n,i):n.classList.add(i):s?e.removeClass(n,i):n.classList.remove(i);else{let o=-1===i.indexOf("-")?void 0:$s.DashCase;if(null==r)s?e.removeStyle(n,i,o):n.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=$s.Important),s?e.setStyle(n,i,r,o):n.style.setProperty(i,r,a?"important":"")}}}(i,o,eb(Rr(),n),r,s))}function tV(e,t,n,i,r,s){const o=null===t;let a;for(;r>0;){const l=e[r],u=Array.isArray(l),c=u?l[1]:l,d=null===c;let f=n[r+1];f===et&&(f=d?un:void 0);let h=d?CM(f,i):c===i?f:void 0;if(u&&!Pb(h)&&(h=CM(l,i)),Pb(h)&&(a=h,o))return a;const p=e[r+1];r=o?da(p):Mu(p)}if(null!==t){let l=s?t.residualClasses:t.residualStyles;null!=l&&(a=CM(l,i))}return a}function Pb(e){return void 0!==e}function nV(e,t){return 0!=(e.flags&(t?16:32))}function R(e,t=""){const n=ae(),i=Ct(),r=e+20,s=i.firstCreatePass?Vp(i,r,1,t,null):i.data[r],o=n[r]=function HM(e,t){return Vn(e)?e.createText(t):e.createTextNode(t)}(n[11],t);Eb(i,n,o,s),fl(s,!1)}function ki(e){return Pr("",e,""),ki}function Pr(e,t,n){const i=ae(),r=Yp(i,e,t,n);return r!==et&&Tu(i,Rr(),r),Pr}function BT(e,t,n){pa(Bs,vl,Yp(ae(),e,t,n),!0)}function Ou(e,t,n){const i=ae();return fr(i,Mp(),t)&&Vs(Ct(),Hn(),i,e,t,i[11],n,!0),Ou}const Lb="en-US";let CV=Lb;function UT(e,t,n,i,r){if(e=lt(e),Array.isArray(e))for(let s=0;s<e.length;s++)UT(e[s],t,n,i,r);else{const s=Ct(),o=ae();let a=qp(e)?e:lt(e.provide),l=Q$(e);const u=_i(),c=1048575&u.providerIndexes,d=u.directiveStart,f=u.providerIndexes>>20;if(qp(e)||!e.multi){const h=new A0(l,r,H),p=qT(a,t,r?c:c+f,d);-1===p?(fb(T0(u,o),s,a),zT(s,e,t.length),t.push(a),u.directiveStart++,u.directiveEnd++,r&&(u.providerIndexes+=1048576),n.push(h),o.push(h)):(n[p]=h,o[p]=h)}else{const h=qT(a,t,c+f,d),p=qT(a,t,c,c+f),g=h>=0&&n[h],m=p>=0&&n[p];if(r&&!m||!r&&!g){fb(T0(u,o),s,a);const _=function _0e(e,t,n,i,r){const s=new A0(e,n,H);return s.multi=[],s.index=t,s.componentProviders=0,WV(s,r,i&&!n),s}(r?m0e:g0e,n.length,r,i,l);!r&&m&&(n[p].providerFactory=_),zT(s,e,t.length,0),t.push(a),u.directiveStart++,u.directiveEnd++,r&&(u.providerIndexes+=1048576),n.push(_),o.push(_)}else zT(s,e,h>-1?h:p,WV(n[r?p:h],l,!r&&i));!r&&i&&m&&n[p].componentProviders++}}}function zT(e,t,n,i){const r=qp(t),s=function Gpe(e){return!!e.useClass}(t);if(r||s){const l=(s?lt(t.useClass):t).prototype.ngOnDestroy;if(l){const u=e.destroyHooks||(e.destroyHooks=[]);if(!r&&t.multi){const c=u.indexOf(n);-1===c?u.push(n,[i,l]):u[c+1].push(i,l)}else u.push(n,l)}}}function WV(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function qT(e,t,n,i){for(let r=n;r<i;r++)if(t[r]===e)return r;return-1}function g0e(e,t,n,i){return GT(this.multi,[])}function m0e(e,t,n,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=O0(n,n[1],this.providerFactory.index,i);s=a.slice(0,o),GT(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],GT(r,s);return s}function GT(e,t){for(let n=0;n<e.length;n++)t.push((0,e[n])());return t}function dn(e,t=[]){return n=>{n.providersResolver=(i,r)=>function p0e(e,t,n){const i=Ct();if(i.firstCreatePass){const r=ua(e);UT(n,i.data,i.blueprint,r,!0),UT(t,i.data,i.blueprint,r,!1)}}(i,r?r(e):e,t)}}class YV{}class b0e{resolveComponentFactory(t){throw function v0e(e){const t=Error(`No component factory found for ${Jt(e)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=e,t}(t)}}let og=(()=>{class e{}return e.NULL=new b0e,e})();function w0e(){return ag(_i(),ae())}function ag(e,t){return new fn(Do(e,t))}let fn=(()=>{class e{constructor(n){this.nativeElement=n}}return e.__NG_ELEMENT_ID__=w0e,e})();function D0e(e){return e instanceof fn?e.nativeElement:e}class lg{}let Us=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>function E0e(){const e=ae(),n=js(_i().index,e);return function C0e(e){return e[11]}(dl(n)?n:e)}(),e})(),S0e=(()=>{class e{}return e.\u0275prov=Ie({token:e,providedIn:"root",factory:()=>null}),e})();class s_{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const x0e=new s_("13.3.2"),WT={};function Hb(e,t,n,i,r=!1){for(;null!==n;){const s=t[n.index];if(null!==s&&i.push(oi(s)),la(s))for(let a=10;a<s.length;a++){const l=s[a],u=l[1].firstChild;null!==u&&Hb(l[1],l,u,i)}const o=n.type;if(8&o)Hb(e,t,n.child,i);else if(32&o){const a=BM(n,t);let l;for(;l=a();)i.push(l)}else if(16&o){const a=a$(t,n);if(Array.isArray(a))i.push(...a);else{const l=q0(t[16]);Hb(l[1],l,a,i,!0)}}n=r?n.projectionNext:n.next}return i}class o_{constructor(t,n){this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,n=t[1];return Hb(n,t,n.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(la(t)){const n=t[8],i=n?n.indexOf(this):-1;i>-1&&(zM(t,i),pb(n,i))}this._attachedToViewContainer=!1}Q8(this._lView[1],this._lView)}onDestroy(t){I$(this._lView[1],this._lView,null,t)}markForCheck(){hT(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){gT(this._lView[1],this._lView,this.context)}checkNoChanges(){!function Fpe(e,t,n){nb(!0);try{gT(e,t,n)}finally{nb(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new xe(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Nhe(e,t){G0(e,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new xe(902,"");this._appRef=t}}class A0e extends o_{constructor(t){super(t),this._view=t}detectChanges(){H$(this._view)}checkNoChanges(){!function Ppe(e){nb(!0);try{H$(e)}finally{nb(!1)}}(this._view)}get context(){return null}}class JV extends og{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const n=ar(t);return new YT(n,this.ngModule)}}function XV(e){const t=[];for(let n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}class YT extends YV{constructor(t,n){super(),this.componentDef=t,this.ngModule=n,this.componentType=t.type,this.selector=function Xhe(e){return e.map(Jhe).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!n}get inputs(){return XV(this.componentDef.inputs)}get outputs(){return XV(this.componentDef.outputs)}create(t,n,i,r){const s=(r=r||this.ngModule)?function T0e(e,t){return{get:(n,i,r)=>{const s=e.get(n,WT,r);return s!==WT||i===WT?s:t.get(n,i,r)}}}(t,r.injector):t,o=s.get(lg,U4),a=s.get(S0e,null),l=o.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",c=i?function k$(e,t,n){if(Vn(e))return e.selectRootElement(t,n===oa.ShadowDom);let i="string"==typeof t?e.querySelector(t):t;return i.textContent="",i}(l,i,this.componentDef.encapsulation):UM(o.createRenderer(null,this.componentDef),u,function M0e(e){const t=e.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(u)),d=this.componentDef.onPush?576:528,f=function c6(e,t){return{components:[],scheduler:e||Che,clean:Lpe,playerHandler:t||null,flags:0}}(),h=Tb(0,null,null,1,0,null,null,null,null,null),p=W0(null,h,f,d,null,null,o,l,a,s);let g,m;ib(p);try{const _=function l6(e,t,n,i,r,s){const o=n[1];n[20]=e;const l=Vp(o,20,2,"#host",null),u=l.mergedAttrs=t.hostAttrs;null!==u&&(Nb(l,u,!0),null!==e&&(lb(r,e,u),null!==l.classes&&KM(r,e,l.classes),null!==l.styles&&c$(r,e,l.styles)));const c=i.createRenderer(e,t),d=W0(n,O$(t),null,t.onPush?64:16,n[20],l,i,c,s||null,null);return o.firstCreatePass&&(fb(T0(l,n),o,t.type),j$(o,l),B$(l,n.length,1)),Ob(n,d),n[20]=d}(c,this.componentDef,p,o,l);if(c)if(i)lb(l,c,["ng-version",x0e.full]);else{const{attrs:y,classes:v}=function Qhe(e){const t=[],n=[];let i=1,r=2;for(;i<e.length;){let s=e[i];if("string"==typeof s)2===r?""!==s&&t.push(s,e[++i]):8===r&&n.push(s);else{if(!ca(r))break;r=s}i++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]);y&&lb(l,c,y),v&&v.length>0&&KM(l,c,v.join(" "))}if(m=oM(h,20),void 0!==n){const y=m.projection=[];for(let v=0;v<this.ngContentSelectors.length;v++){const b=n[v];y.push(null!=b?Array.from(b):null)}}g=function u6(e,t,n,i,r){const s=n[1],o=function vpe(e,t,n){const i=_i();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),$$(e,i,t,Hp(e,t,1,null),n));const r=O0(t,e,i.directiveStart,i);dr(r,t);const s=Do(i,t);return s&&dr(s,t),r}(s,n,t);if(i.components.push(o),e[8]=o,r&&r.forEach(l=>l(o,t)),t.contentQueries){const l=_i();t.contentQueries(1,o,l.directiveStart)}const a=_i();return!s.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(Ac(a.index),P$(n[1],a,0,a.directiveStart,a.directiveEnd,t),L$(t,o)),o}(_,this.componentDef,p,f,[ige]),Y0(h,p,null)}finally{rb()}return new N0e(this.componentType,g,ag(m,p),p,m)}}class N0e extends class y0e{}{constructor(t,n,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=n,this.hostView=this.changeDetectorRef=new A0e(r),this.componentType=t}get injector(){return new Np(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}class Nu{}class QV{}const ug=new Map;class t7 extends Nu{constructor(t,n){super(),this._parent=n,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new JV(this);const i=vo(t);this._bootstrapComponents=gl(i.bootstrap),this._r3Injector=X$(t,n,[{provide:Nu,useValue:this},{provide:og,useValue:this.componentFactoryResolver}],Jt(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,n=li.THROW_IF_NOT_FOUND,i=Ke.Default){return t===li||t===Nu||t===_T?this:this._r3Injector.get(t,n,i)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class KT extends QV{constructor(t){super(),this.moduleType=t,null!==vo(t)&&function I0e(e){const t=new Set;!function n(i){const r=vo(i,!0),s=r.id;null!==s&&(function ZV(e,t,n){if(t&&t!==n)throw new Error(`Duplicate module registered for ${e} - ${Jt(t)} vs ${Jt(t.name)}`)}(s,ug.get(s),i),ug.set(s,i));const o=gl(r.imports);for(const a of o)t.has(a)||(t.add(a),n(a))}(e)}(t)}create(t){return new t7(this.moduleType,t)}}function Fc(e,t,n,i){return n7(ae(),Ir(),e,t,n,i)}function n7(e,t,n,i,r,s){const o=t+n;return fr(e,o,r)?function _l(e,t,n){return e[t]=n}(e,o+1,s?i.call(s,r):i(r)):function l_(e,t){const n=e[t];return n===et?void 0:n}(e,o+1)}function ga(e,t){const n=Ct();let i;const r=e+20;n.firstCreatePass?(i=function V0e(e,t){if(t)for(let n=t.length-1;n>=0;n--){const i=t[n];if(e===i.name)return i}}(t,n.pipeRegistry),n.data[r]=i,i.onDestroy&&(n.destroyHooks||(n.destroyHooks=[])).push(r,i.onDestroy)):i=n.data[r];const s=i.factory||(i.factory=Ef(i.type)),o=Cc(H);try{const a=cb(!1),l=s();return cb(a),function gge(e,t,n,i){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=i}(n,ae(),r,l),l}finally{Cc(o)}}function ma(e,t,n){const i=e+20,r=ae(),s=Ap(r,i);return function u_(e,t){return e[1].data[t].pure}(r,i)?n7(r,Ir(),t,s.transform,n,s):s.transform(n)}function XT(e){return t=>{setTimeout(e,void 0,t)}}const nt=class G0e extends Pn{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,n,i){var r,s,o;let a=t,l=n||(()=>null),u=i;if(t&&"object"==typeof t){const d=t;a=null===(r=d.next)||void 0===r?void 0:r.bind(d),l=null===(s=d.error)||void 0===s?void 0:s.bind(d),u=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}this.__isAsync&&(l=XT(l),a&&(a=XT(a)),u&&(u=XT(u)));const c=super.subscribe({next:a,error:l,complete:u});return t instanceof Xn&&t.add(c),c}};function W0e(){return this._results[Gp()]()}class QT{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const n=Gp(),i=QT.prototype;i[n]||(i[n]=W0e)}get changes(){return this._changes||(this._changes=new nt)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,n){return this._results.reduce(t,n)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,n){const i=this;i.dirty=!1;const r=Co(t);(this._changesDetected=!function afe(e,t,n){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],s=t[i];if(n&&(r=n(r),s=n(s)),s!==r)return!1}return!0}(i._results,r,n))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Mn=(()=>{class e{}return e.__NG_ELEMENT_ID__=J0e,e})();const Y0e=Mn,K0e=class extends Y0e{constructor(t,n,i){super(),this._declarationLView=t,this._declarationTContainer=n,this.elementRef=i}createEmbeddedView(t){const n=this._declarationTContainer.tViews,i=W0(this._declarationLView,n,t,16,null,n.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(n)),Y0(n,i,t),new o_(i)}};function J0e(){return Ub(_i(),ae())}function Ub(e,t){return 4&e.type?new K0e(t,e,ag(e,t)):null}let xo=(()=>{class e{}return e.__NG_ELEMENT_ID__=X0e,e})();function X0e(){return u7(_i(),ae())}const Q0e=xo,a7=class extends Q0e{constructor(t,n,i){super(),this._lContainer=t,this._hostTNode=n,this._hostLView=i}get element(){return ag(this._hostTNode,this._hostLView)}get injector(){return new Np(this._hostTNode,this._hostLView)}get parentInjector(){const t=db(this._hostTNode,this._hostLView);if(s8(t)){const n=Op(t,this._hostLView),i=Tp(t);return new Np(n[1].data[i+8],n)}return new Np(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const n=l7(this._lContainer);return null!==n&&n[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,n,i){const r=t.createEmbeddedView(n||{});return this.insert(r,i),r}createComponent(t,n,i,r,s){const o=t&&!function k0(e){return"function"==typeof e}(t);let a;if(o)a=n;else{const d=n||{};a=d.index,i=d.injector,r=d.projectableNodes,s=d.ngModuleRef}const l=o?t:new YT(ar(t)),u=i||this.parentInjector;if(!s&&null==l.ngModule){const f=(o?u:this.parentInjector).get(Nu,null);f&&(s=f)}const c=l.create(u,r,void 0,s);return this.insert(c.hostView,a),c}insert(t,n){const i=t._lView,r=i[1];if(function Mde(e){return la(e[3])}(i)){const c=this.indexOf(t);if(-1!==c)this.detach(c);else{const d=i[3],f=new a7(d,d[6],d[3]);f.detach(f.indexOf(t))}}const s=this._adjustIndex(n),o=this._lContainer;!function Ihe(e,t,n,i){const r=10+i,s=n.length;i>0&&(n[r-1][4]=t),i<s-10?(t[4]=n[r],g8(n,10+i,t)):(n.push(t),t[4]=null),t[3]=n;const o=t[17];null!==o&&n!==o&&function Rhe(e,t){const n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(o,t);const a=t[19];null!==a&&a.insertView(e),t[2]|=128}(r,i,o,s);const a=WM(s,o),l=i[11],u=Cb(l,o[7]);return null!==u&&function Ohe(e,t,n,i,r,s){i[0]=r,i[6]=t,G0(e,i,n,1,r,s)}(r,o[6],l,i,u,a),t.attachToViewContainerRef(),g8(ZT(o),s,t),t}move(t,n){return this.insert(t,n)}indexOf(t){const n=l7(this._lContainer);return null!==n?n.indexOf(t):-1}remove(t){const n=this._adjustIndex(t,-1),i=zM(this._lContainer,n);i&&(pb(ZT(this._lContainer),n),Q8(i[1],i))}detach(t){const n=this._adjustIndex(t,-1),i=zM(this._lContainer,n);return i&&null!=pb(ZT(this._lContainer),n)?new o_(i):null}_adjustIndex(t,n=0){return null==t?this.length+n:t}};function l7(e){return e[8]}function ZT(e){return e[8]||(e[8]=[])}function u7(e,t){let n;const i=t[e.index];if(la(i))n=i;else{let r;if(8&e.type)r=oi(i);else{const s=t[11];r=s.createComment("");const o=Do(e,t);xf(s,Cb(s,o),r,function jhe(e,t){return Vn(e)?e.nextSibling(t):t.nextSibling}(s,o),!1)}t[e.index]=n=V$(i,t,r,e),Ob(t,n)}return new a7(n,e,t)}class e2{constructor(t){this.queryList=t,this.matches=null}clone(){return new e2(this.queryList)}setDirty(){this.queryList.setDirty()}}class t2{constructor(t=[]){this.queries=t}createEmbeddedView(t){const n=t.queries;if(null!==n){const i=null!==t.contentQueries?t.contentQueries[0]:n.length,r=[];for(let s=0;s<i;s++){const o=n.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new t2(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let n=0;n<this.queries.length;n++)null!==p7(t,n).matches&&this.queries[n].setDirty()}}class c7{constructor(t,n,i=null){this.predicate=t,this.flags=n,this.read=i}}class n2{constructor(t=[]){this.queries=t}elementStart(t,n){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(t,n)}elementEnd(t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(t)}embeddedTView(t){let n=null;for(let i=0;i<this.length;i++){const r=null!==n?n.length:0,s=this.getByIndex(i).embeddedTView(t,r);s&&(s.indexInDeclarationView=i,null!==n?n.push(s):n=[s])}return null!==n?new n2(n):null}template(t,n){for(let i=0;i<this.queries.length;i++)this.queries[i].template(t,n)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class r2{constructor(t,n=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(t,n){this.isApplyingToNode(n)&&this.matchTNode(t,n)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,n){this.elementStart(t,n)}embeddedTView(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new r2(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const n=this._declarationNodeIndex;let i=t.parent;for(;null!==i&&8&i.type&&i.index!==n;)i=i.parent;return n===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(t,n){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(t,n,t_e(n,s)),this.matchTNodeWithReadOption(t,n,hb(n,t,s,!1,!1))}else i===Mn?4&n.type&&this.matchTNodeWithReadOption(t,n,-1):this.matchTNodeWithReadOption(t,n,hb(n,t,i,!1,!1))}matchTNodeWithReadOption(t,n,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===fn||r===xo||r===Mn&&4&n.type)this.addMatch(n.index,-2);else{const s=hb(n,t,r,!1,!1);null!==s&&this.addMatch(n.index,s)}else this.addMatch(n.index,i)}}addMatch(t,n){null===this.matches?this.matches=[t,n]:this.matches.push(t,n)}}function t_e(e,t){const n=e.localNames;if(null!==n)for(let i=0;i<n.length;i+=2)if(n[i]===t)return n[i+1];return null}function i_e(e,t,n,i){return-1===n?function n_e(e,t){return 11&e.type?ag(e,t):4&e.type?Ub(e,t):null}(t,e):-2===n?function r_e(e,t,n){return n===fn?ag(t,e):n===Mn?Ub(t,e):n===xo?u7(t,e):void 0}(e,t,i):O0(e,e[1],n,t)}function d7(e,t,n,i){const r=t[19].queries[i];if(null===r.matches){const s=e.data,o=n.matches,a=[];for(let l=0;l<o.length;l+=2){const u=o[l];a.push(u<0?null:i_e(t,s[u],o[l+1],n.metadata.read))}r.matches=a}return r.matches}function s2(e,t,n,i){const r=e.queries.getByIndex(n),s=r.matches;if(null!==s){const o=d7(e,t,r,n);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const u=s[a+1],c=t[-l];for(let d=10;d<c.length;d++){const f=c[d];f[17]===f[3]&&s2(f[1],f,u,i)}if(null!==c[9]){const d=c[9];for(let f=0;f<d.length;f++){const h=d[f];s2(h[1],h,u,i)}}}}}return i}function Tn(e){const t=ae(),n=Ct(),i=J4();hM(i+1);const r=p7(n,i);if(e.dirty&&z4(t)===(2==(2&r.metadata.flags))){if(null===r.matches)e.reset([]);else{const s=r.crossesNgTemplate?s2(n,t,i,[]):d7(n,t,r,i);e.reset(s,D0e),e.notifyOnChanges()}return!0}return!1}function zb(e,t,n){const i=Ct();i.firstCreatePass&&(function h7(e,t,n){null===e.queries&&(e.queries=new n2),e.queries.track(new r2(t,n))}(i,new c7(e,t,n),-1),2==(2&t)&&(i.staticViewQueries=!0)),function f7(e,t,n){const i=new QT(4==(4&n));I$(e,t,i,i.destroy),null===t[19]&&(t[19]=new t2),t[19].queries.push(new e2(i))}(i,ae(),t)}function On(){return function s_e(e,t){return e[19].queries[t].queryList}(ae(),J4())}function p7(e,t){return e.queries.getByIndex(t)}function Ao(e,t){return Ub(e,t)}function Wb(...e){}const d2=new rt("Application Initializer");let f2=(()=>{class e{constructor(n){this.appInits=n,this.resolve=Wb,this.reject=Wb,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const n=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(Q0(s))n.push(s);else if(IT(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});n.push(o)}}Promise.all(n).then(()=>{i()}).catch(r=>{this.reject(r)}),0===n.length&&i(),this.initialized=!0}}return e.\u0275fac=function(n){return new(n||e)(me(d2,8))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const d_=new rt("AppId",{providedIn:"root",factory:function N7(){return`${h2()}${h2()}${h2()}`}});function h2(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const k7=new rt("Platform Initializer"),f_=new rt("Platform ID"),I7=new rt("appBootstrapListener");let R7=(()=>{class e{log(n){console.log(n)}warn(n){console.warn(n)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();const Pc=new rt("LocaleId",{providedIn:"root",factory:()=>bfe(Pc,Ke.Optional|Ke.SkipSelf)||function C_e(){return"undefined"!=typeof $localize&&$localize.locale||Lb}()});class S_e{constructor(t,n){this.ngModuleFactory=t,this.componentFactories=n}}let F7=(()=>{class e{compileModuleSync(n){return new KT(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const i=this.compileModuleSync(n),s=gl(vo(n).declarations).reduce((o,a)=>{const l=ar(a);return l&&o.push(new YT(l)),o},[]);return new S_e(i,s)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ie({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const A_e=(()=>Promise.resolve(0))();function p2(e){"undefined"==typeof Zone?A_e.then(()=>{e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}class hn{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new nt(!1),this.onMicrotaskEmpty=new nt(!1),this.onStable=new nt(!1),this.onError=new nt(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&n,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function M_e(){let e=tn.requestAnimationFrame,t=tn.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function N_e(e){const t=()=>{!function O_e(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(tn,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,m2(e),e.isCheckStableRunning=!0,g2(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),m2(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,i,r,s,o,a)=>{try{return P7(e),n.invokeTask(r,s,o,a)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||e.shouldCoalesceRunChangeDetection)&&t(),L7(e)}},onInvoke:(n,i,r,s,o,a,l)=>{try{return P7(e),n.invoke(r,s,o,a,l)}finally{e.shouldCoalesceRunChangeDetection&&t(),L7(e)}},onHasTask:(n,i,r,s)=>{n.hasTask(r,s),i===r&&("microTask"==s.change?(e._hasPendingMicrotasks=s.microTask,m2(e),g2(e)):"macroTask"==s.change&&(e.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,i,r,s)=>(n.handleError(r,s),e.runOutsideAngular(()=>e.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!hn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(hn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,n,i){return this._inner.run(t,n,i)}runTask(t,n,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,t,T_e,Wb,Wb);try{return s.runTask(o,n,i)}finally{s.cancelTask(o)}}runGuarded(t,n,i){return this._inner.runGuarded(t,n,i)}runOutsideAngular(t){return this._outer.run(t)}}const T_e={};function g2(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function m2(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function P7(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function L7(e){e._nesting--,g2(e)}class k_e{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new nt,this.onMicrotaskEmpty=new nt,this.onStable=new nt,this.onError=new nt}run(t,n,i){return t.apply(n,i)}runGuarded(t,n,i){return t.apply(n,i)}runOutsideAngular(t){return t()}runTask(t,n,i,r){return t.apply(n,i)}}let _2=(()=>{class e{constructor(n){this._ngZone=n,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{hn.assertNotInAngularZone(),p2(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())p2(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(n)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),n(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:n,timeoutId:s,updateCb:r})}whenStable(n,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(n,i,r){return[]}}return e.\u0275fac=function(n){return new(n||e)(me(hn))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})(),j7=(()=>{class e{constructor(){this._applications=new Map,y2.addToWindow(this)}registerApplication(n,i){this._applications.set(n,i)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,i=!0){return y2.findTestabilityInTree(this,n,i)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();class I_e{addToWindow(t){}findTestabilityInTree(t,n,i){return null}}let _a,y2=new I_e;const B7=new rt("AllowMultipleToken");class $7{constructor(t,n){this.name=t,this.token=n}}function V7(e,t,n=[]){const i=`Platform: ${t}`,r=new rt(i);return(s=[])=>{let o=H7();if(!o||o.injector.get(B7,!1))if(e)e(n.concat(s).concat({provide:r,useValue:!0}));else{const a=n.concat(s).concat({provide:r,useValue:!0},{provide:yT,useValue:"platform"});!function L_e(e){if(_a&&!_a.destroyed&&!_a.injector.get(B7,!1))throw new xe(400,"");_a=e.get(U7);const t=e.get(k7,null);t&&t.forEach(n=>n())}(li.create({providers:a,name:i}))}return function j_e(e){const t=H7();if(!t)throw new xe(401,"");return t}()}}function H7(){return _a&&!_a.destroyed?_a:null}let U7=(()=>{class e{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,i){const a=function B_e(e,t){let n;return n="noop"===e?new k_e:("zone.js"===e?void 0:e)||new hn({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),n}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),l=[{provide:hn,useValue:a}];return a.run(()=>{const u=li.create({providers:l,parent:this.injector,name:n.moduleType.name}),c=n.create(u),d=c.injector.get(z0,null);if(!d)throw new xe(402,"");return a.runOutsideAngular(()=>{const f=a.onError.subscribe({next:h=>{d.handleError(h)}});c.onDestroy(()=>{v2(this._modules,c),f.unsubscribe()})}),function $_e(e,t,n){try{const i=n();return Q0(i)?i.catch(r=>{throw t.runOutsideAngular(()=>e.handleError(r)),r}):i}catch(i){throw t.runOutsideAngular(()=>e.handleError(i)),i}}(d,a,()=>{const f=c.injector.get(f2);return f.runInitializers(),f.donePromise.then(()=>(function Sme(e){Ps(e,"Expected localeId to be defined"),"string"==typeof e&&(CV=e.toLowerCase().replace(/_/g,"-"))}(c.injector.get(Pc,Lb)||Lb),this._moduleDoBootstrap(c),c))})})}bootstrapModule(n,i=[]){const r=z7({},i);return function F_e(e,t,n){const i=new KT(n);return Promise.resolve(i)}(0,0,n).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(n){const i=n.injector.get(h_);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!n.instance.ngDoBootstrap)throw new xe(403,"");n.instance.ngDoBootstrap(i)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new xe(404,"");this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n()),this._destroyed=!0}get destroyed(){return this._destroyed}}return e.\u0275fac=function(n){return new(n||e)(me(li))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();function z7(e,t){return Array.isArray(t)?t.reduce(z7,e):Object.assign(Object.assign({},e),t)}let h_=(()=>{class e{constructor(n,i,r,s,o){this._zone=n,this._injector=i,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new en(u=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{u.next(this._stable),u.complete()})}),l=new en(u=>{let c;this._zone.runOutsideAngular(()=>{c=this._zone.onStable.subscribe(()=>{hn.assertNotInAngularZone(),p2(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,u.next(!0))})})});const d=this._zone.onUnstable.subscribe(()=>{hn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{u.next(!1)}))});return()=>{c.unsubscribe(),d.unsubscribe()}});this.isStable=A4(a,l.pipe(M4()))}bootstrap(n,i){if(!this._initStatus.done)throw new xe(405,"");let r;r=n instanceof YV?n:this._componentFactoryResolver.resolveComponentFactory(n),this.componentTypes.push(r.componentType);const s=function P_e(e){return e.isBoundToModule}(r)?void 0:this._injector.get(Nu),a=r.create(li.NULL,[],i||r.selector,s),l=a.location.nativeElement,u=a.injector.get(_2,null),c=u&&a.injector.get(j7);return u&&c&&c.registerApplication(l,u),a.onDestroy(()=>{this.detachView(a.hostView),v2(this.components,a),c&&c.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new xe(101,"");try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(n))}finally{this._runningTick=!1}}attachView(n){const i=n;this._views.push(i),i.attachToAppRef(this)}detachView(n){const i=n;v2(this._views,i),i.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(I7,[]).concat(this._bootstrapListeners).forEach(r=>r(n))}ngOnDestroy(){this._views.slice().forEach(n=>n.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return e.\u0275fac=function(n){return new(n||e)(me(hn),me(li),me(z0),me(og),me(f2))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function v2(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}let G7=!0,Mo=(()=>{class e{}return e.__NG_ELEMENT_ID__=U_e,e})();function U_e(e){return function z_e(e,t,n){if(Q1(e)&&!n){const i=js(e.index,t);return new o_(i,i)}return 47&e.type?new o_(t[16],t):null}(_i(),ae(),16==(16&e))}class X7{constructor(){}supports(t){return J0(t)}create(t){return new J_e(t)}}const K_e=(e,t)=>t;class J_e{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||K_e}forEachItem(t){let n;for(n=this._itHead;null!==n;n=n._next)t(n)}forEachOperation(t){let n=this._itHead,i=this._removalsHead,r=0,s=null;for(;n||i;){const o=!i||n&&n.currentIndex<Z7(i,r,s)?n:i,a=Z7(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(n=n._next,null==o.previousIndex)r++;else{s||(s=[]);const u=a-r,c=l-r;if(u!=c){for(let f=0;f<u;f++){const h=f<s.length?s[f]:s[f]=0,p=h+f;c<=p&&p<u&&(s[f]=h+1)}s[o.previousIndex]=c-u}}a!==l&&t(o,a,l)}}forEachPreviousItem(t){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachMovedItem(t){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}forEachIdentityChange(t){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)t(n)}diff(t){if(null==t&&(t=[]),!J0(t))throw new xe(900,"");return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let r,s,o,n=this._itHead,i=!1;if(Array.isArray(t)){this.length=t.length;for(let a=0;a<this.length;a++)s=t[a],o=this._trackByFn(a,s),null!==n&&Object.is(n.trackById,o)?(i&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)):(n=this._mismatch(n,s,o,a),i=!0),n=n._next}else r=0,function hge(e,t){if(Array.isArray(e))for(let n=0;n<e.length;n++)t(e[n]);else{const n=e[Gp()]();let i;for(;!(i=n.next()).done;)t(i.value)}}(t,a=>{o=this._trackByFn(r,a),null!==n&&Object.is(n.trackById,o)?(i&&(n=this._verifyReinsertion(n,a,o,r)),Object.is(n.item,a)||this._addIdentityChange(n,a)):(n=this._mismatch(n,a,o,r),i=!0),n=n._next,r++}),this.length=r;return this._truncate(n),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,n,i,r){let s;return null===t?s=this._itTail:(s=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._reinsertAfter(t,s,r)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._moveAfter(t,s,r)):t=this._addAfter(new X_e(n,i),s,r),t}_verifyReinsertion(t,n,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?t=this._reinsertAfter(s,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const n=t._next;this._addToRemovals(this._unlink(t)),t=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,n,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,s=t._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(t,n,i),this._addToMoves(t,i),t}_moveAfter(t,n,i){return this._unlink(t),this._insertAfter(t,n,i),this._addToMoves(t,i),t}_addAfter(t,n,i){return this._insertAfter(t,n,i),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,n,i){const r=null===n?this._itHead:n._next;return t._next=r,t._prev=n,null===r?this._itTail=t:r._prev=t,null===n?this._itHead=t:n._next=t,null===this._linkedRecords&&(this._linkedRecords=new Q7),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const n=t._prev,i=t._next;return null===n?this._itHead=i:n._next=i,null===i?this._itTail=n:i._prev=n,t}_addToMoves(t,n){return t.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Q7),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,n){return t.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class X_e{constructor(t,n){this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Q_e{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,n){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===n||n<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){const n=t._prevDup,i=t._nextDup;return null===n?this._head=i:n._nextDup=i,null===i?this._tail=n:i._prevDup=n,null===this._head}}class Q7{constructor(){this.map=new Map}put(t){const n=t.trackById;let i=this.map.get(n);i||(i=new Q_e,this.map.set(n,i)),i.add(t)}get(t,n){const r=this.map.get(t);return r?r.get(t,n):null}remove(t){const n=t.trackById;return this.map.get(n).remove(t)&&this.map.delete(n),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Z7(e,t,n){const i=e.previousIndex;if(null===i)return i;let r=0;return n&&i<n.length&&(r=n[i]),i+t+r}class e9{constructor(){}supports(t){return t instanceof Map||ET(t)}create(){return new Z_e}}class Z_e{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let n;for(n=this._mapHead;null!==n;n=n._next)t(n)}forEachPreviousItem(t){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)t(n)}forEachChangedItem(t){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}diff(t){if(t){if(!(t instanceof Map||ET(t)))throw new xe(900,"")}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(t,(i,r)=>{if(n&&n.key===r)this._maybeAddToChanges(n,i),this._appendAfter=n,n=n._next;else{const s=this._getOrCreateRecordForKey(r,i);n=this._insertBeforeOrAppend(n,s)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let i=n;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,n){if(t){const i=t._prev;return n._next=t,n._prev=i,t._prev=n,i&&(i._next=n),t===this._mapHead&&(this._mapHead=n),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(t,n){if(this._records.has(t)){const r=this._records.get(t);this._maybeAddToChanges(r,n);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new eye(t);return this._records.set(t,i),i.currentValue=n,this._addToAdditions(i),i}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,n){Object.is(n,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=n,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,n){t instanceof Map?t.forEach(n):Object.keys(t).forEach(i=>n(t[i],i))}}class eye{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function t9(){return new Jb([new X7])}let Jb=(()=>{class e{constructor(n){this.factories=n}static create(n,i){if(null!=i){const r=i.factories.slice();n=n.concat(r)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||t9()),deps:[[e,new L0,new Tc]]}}find(n){const i=this.factories.find(r=>r.supports(n));if(null!=i)return i;throw new xe(901,"")}}return e.\u0275prov=Ie({token:e,providedIn:"root",factory:t9}),e})();function n9(){return new p_([new e9])}let p_=(()=>{class e{constructor(n){this.factories=n}static create(n,i){if(i){const r=i.factories.slice();n=n.concat(r)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||n9()),deps:[[e,new L0,new Tc]]}}find(n){const i=this.factories.find(s=>s.supports(n));if(i)return i;throw new xe(901,"")}}return e.\u0275prov=Ie({token:e,providedIn:"root",factory:n9}),e})();const iye=V7(null,"core",[{provide:f_,useValue:"unknown"},{provide:U7,deps:[li]},{provide:j7,deps:[]},{provide:R7,deps:[]}]);let rye=(()=>{class e{constructor(n){}}return e.\u0275fac=function(n){return new(n||e)(me(h_))},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({}),e})(),Xb=null;function bl(){return Xb}const ni=new rt("DocumentToken");let Of=(()=>{class e{historyGo(n){throw new Error("Not implemented")}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ie({token:e,factory:function(){return function lye(){return me(i9)}()},providedIn:"platform"}),e})();const uye=new rt("Location Initialized");let i9=(()=>{class e extends Of{constructor(n){super(),this._doc=n,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return bl().getBaseHref(this._doc)}onPopState(n){const i=bl().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",n,!1),()=>i.removeEventListener("popstate",n)}onHashChange(n){const i=bl().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",n,!1),()=>i.removeEventListener("hashchange",n)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(n){this.location.pathname=n}pushState(n,i,r){r9()?this._history.pushState(n,i,r):this.location.hash=r}replaceState(n,i,r){r9()?this._history.replaceState(n,i,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return e.\u0275fac=function(n){return new(n||e)(me(ni))},e.\u0275prov=Ie({token:e,factory:function(){return function cye(){return new i9(me(ni))}()},providedIn:"platform"}),e})();function r9(){return!!window.history.pushState}function E2(e,t){if(0==e.length)return t;if(0==t.length)return e;let n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function s9(e){const t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function ku(e){return e&&"?"!==e[0]?"?"+e:e}let dg=(()=>{class e{historyGo(n){throw new Error("Not implemented")}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ie({token:e,factory:function(){return function dye(e){const t=me(ni).location;return new o9(me(Of),t&&t.origin||"")}()},providedIn:"root"}),e})();const S2=new rt("appBaseHref");let o9=(()=>{class e extends dg{constructor(n,i){if(super(),this._platformLocation=n,this._removeListenerFns=[],null==i&&(i=this._platformLocation.getBaseHrefFromDOM()),null==i)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=i}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return E2(this._baseHref,n)}path(n=!1){const i=this._platformLocation.pathname+ku(this._platformLocation.search),r=this._platformLocation.hash;return r&&n?`${i}${r}`:i}pushState(n,i,r,s){const o=this.prepareExternalUrl(r+ku(s));this._platformLocation.pushState(n,i,o)}replaceState(n,i,r,s){const o=this.prepareExternalUrl(r+ku(s));this._platformLocation.replaceState(n,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,n)}}return e.\u0275fac=function(n){return new(n||e)(me(Of),me(S2,8))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})(),fye=(()=>{class e extends dg{constructor(n,i){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(n){const i=E2(this._baseHref,n);return i.length>0?"#"+i:i}pushState(n,i,r,s){let o=this.prepareExternalUrl(r+ku(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(n,i,o)}replaceState(n,i,r,s){let o=this.prepareExternalUrl(r+ku(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(n,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,n)}}return e.\u0275fac=function(n){return new(n||e)(me(Of),me(S2,8))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})(),x2=(()=>{class e{constructor(n,i){this._subject=new nt,this._urlChangeListeners=[],this._platformStrategy=n;const r=this._platformStrategy.getBaseHref();this._platformLocation=i,this._baseHref=s9(a9(r)),this._platformStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}path(n=!1){return this.normalize(this._platformStrategy.path(n))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(n,i=""){return this.path()==this.normalize(n+ku(i))}normalize(n){return e.stripTrailingSlash(function pye(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,a9(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._platformStrategy.prepareExternalUrl(n)}go(n,i="",r=null){this._platformStrategy.pushState(r,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+ku(i)),r)}replaceState(n,i="",r=null){this._platformStrategy.replaceState(r,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+ku(i)),r)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(n=0){var i,r;null===(r=(i=this._platformStrategy).historyGo)||void 0===r||r.call(i,n)}onUrlChange(n){this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}))}_notifyUrlChangeListeners(n="",i){this._urlChangeListeners.forEach(r=>r(n,i))}subscribe(n,i,r){return this._subject.subscribe({next:n,error:i,complete:r})}}return e.normalizeQueryParams=ku,e.joinWithSlash=E2,e.stripTrailingSlash=s9,e.\u0275fac=function(n){return new(n||e)(me(dg),me(Of))},e.\u0275prov=Ie({token:e,factory:function(){return function hye(){return new x2(me(dg),me(Of))}()},providedIn:"root"}),e})();function a9(e){return e.replace(/\/index.html$/,"")}function m9(e,t){t=encodeURIComponent(t);for(const n of e.split(";")){const i=n.indexOf("="),[r,s]=-1==i?[n,""]:[n.slice(0,i),n.slice(i+1)];if(r.trim()===t)return decodeURIComponent(s)}return null}let Yi=(()=>{class e{constructor(n,i,r,s){this._iterableDiffers=n,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(n){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof n?n.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(n){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof n?n.split(/\s+/):n,this._rawClass&&(J0(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const n=this._iterableDiffer.diff(this._rawClass);n&&this._applyIterableChanges(n)}else if(this._keyValueDiffer){const n=this._keyValueDiffer.diff(this._rawClass);n&&this._applyKeyValueChanges(n)}}_applyKeyValueChanges(n){n.forEachAddedItem(i=>this._toggleClass(i.key,i.currentValue)),n.forEachChangedItem(i=>this._toggleClass(i.key,i.currentValue)),n.forEachRemovedItem(i=>{i.previousValue&&this._toggleClass(i.key,!1)})}_applyIterableChanges(n){n.forEachAddedItem(i=>{if("string"!=typeof i.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Jt(i.item)}`);this._toggleClass(i.item,!0)}),n.forEachRemovedItem(i=>this._toggleClass(i.item,!1))}_applyClasses(n){n&&(Array.isArray(n)||n instanceof Set?n.forEach(i=>this._toggleClass(i,!0)):Object.keys(n).forEach(i=>this._toggleClass(i,!!n[i])))}_removeClasses(n){n&&(Array.isArray(n)||n instanceof Set?n.forEach(i=>this._toggleClass(i,!1)):Object.keys(n).forEach(i=>this._toggleClass(i,!1)))}_toggleClass(n,i){(n=n.trim())&&n.split(/\s+/g).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return e.\u0275fac=function(n){return new(n||e)(H(Jb),H(p_),H(fn),H(Us))},e.\u0275dir=ye({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e})();class Qye{constructor(t,n,i,r){this.$implicit=t,this.ngForOf=n,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Nf=(()=>{class e{constructor(n,i,r){this._viewContainer=n,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const i=this._viewContainer;n.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new Qye(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),_9(a,r)}});for(let r=0,s=i.length;r<s;r++){const a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}n.forEachIdentityChange(r=>{_9(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(n,i){return!0}}return e.\u0275fac=function(n){return new(n||e)(H(xo),H(Mn),H(Jb))},e.\u0275dir=ye({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e})();function _9(e,t){e.context.$implicit=t.item}let zn=(()=>{class e{constructor(n,i){this._viewContainer=n,this._context=new Zye,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){y9("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){y9("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,i){return!0}}return e.\u0275fac=function(n){return new(n||e)(H(xo),H(Mn))},e.\u0275dir=ye({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e})();class Zye{constructor(){this.$implicit=null,this.ngIf=null}}function y9(e,t){if(t&&!t.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${Jt(t)}'.`)}let fg=(()=>{class e{constructor(n){this._viewContainerRef=n,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(n){if(n.ngTemplateOutlet){const i=this._viewContainerRef;this._viewRef&&i.remove(i.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?i.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&n.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return e.\u0275fac=function(n){return new(n||e)(H(xo))},e.\u0275dir=ye({type:e,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[Ht]}),e})(),zs=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({}),e})();let Tve=(()=>{class e{}return e.\u0275prov=Ie({token:e,providedIn:"root",factory:()=>new Ove(me(ni),window)}),e})();class Ove{constructor(t,n){this.document=t,this.window=n,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const n=function Nve(e,t){const n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow)){const i=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(t)||s.querySelector(`[name="${t}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,t);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const n=this.window.history;n&&n.scrollRestoration&&(n.scrollRestoration=t)}}scrollToElement(t){const n=t.getBoundingClientRect(),i=n.left+this.window.pageXOffset,r=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=D9(this.window.history)||D9(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch(t){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(t){return!1}}}function D9(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}class C9{}class $2 extends class kve extends class aye{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function oye(e){Xb||(Xb=e)}(new $2)}onAndCancel(t,n,i){return t.addEventListener(n,i,!1),()=>{t.removeEventListener(n,i,!1)}}dispatchEvent(t,n){t.dispatchEvent(n)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,n){return(n=n||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,n){return"window"===n?window:"document"===n?t:"body"===n?t.body:null}getBaseHref(t){const n=function Ive(){return __=__||document.querySelector("base"),__?__.getAttribute("href"):null}();return null==n?null:function Rve(e){aw=aw||document.createElement("a"),aw.setAttribute("href",e);const t=aw.pathname;return"/"===t.charAt(0)?t:`/${t}`}(n)}resetBaseElement(){__=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return m9(document.cookie,t)}}let aw,__=null;const E9=new rt("TRANSITION_ID"),Pve=[{provide:d2,useFactory:function Fve(e,t,n){return()=>{n.get(f2).donePromise.then(()=>{const i=bl(),r=t.querySelectorAll(`style[ng-transition="${e}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[E9,ni,li],multi:!0}];class V2{static init(){!function R_e(e){y2=e}(new V2)}addToWindow(t){tn.getAngularTestability=(i,r=!0)=>{const s=t.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},tn.getAllAngularTestabilities=()=>t.getAllTestabilities(),tn.getAllAngularRootElements=()=>t.getAllRootElements(),tn.frameworkStabilizers||(tn.frameworkStabilizers=[]),tn.frameworkStabilizers.push(i=>{const r=tn.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(t,n,i){if(null==n)return null;const r=t.getTestability(n);return null!=r?r:i?bl().isShadowRoot(n)?this.findTestabilityInTree(t,n.host,!0):this.findTestabilityInTree(t,n.parentElement,!0):null}}let Lve=(()=>{class e{build(){return new XMLHttpRequest}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();const lw=new rt("EventManagerPlugins");let uw=(()=>{class e{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(r=>r.manager=this),this._plugins=n.slice().reverse()}addEventListener(n,i,r){return this._findPluginFor(i).addEventListener(n,i,r)}addGlobalEventListener(n,i,r){return this._findPluginFor(i).addGlobalEventListener(n,i,r)}getZone(){return this._zone}_findPluginFor(n){const i=this._eventNameToPlugin.get(n);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(n))return this._eventNameToPlugin.set(n,o),o}throw new Error(`No event manager plugin found for event ${n}`)}}return e.\u0275fac=function(n){return new(n||e)(me(lw),me(hn))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();class S9{constructor(t){this._doc=t}addGlobalEventListener(t,n,i){const r=bl().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${n}`);return this.addEventListener(r,n,i)}}let x9=(()=>{class e{constructor(){this._stylesSet=new Set}addStyles(n){const i=new Set;n.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(n){}getAllStyles(){return Array.from(this._stylesSet)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})(),y_=(()=>{class e extends x9{constructor(n){super(),this._doc=n,this._hostNodes=new Map,this._hostNodes.set(n.head,[])}_addStylesToHost(n,i,r){n.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(n){const i=[];this._addStylesToHost(this._stylesSet,n,i),this._hostNodes.set(n,i)}removeHost(n){const i=this._hostNodes.get(n);i&&i.forEach(A9),this._hostNodes.delete(n)}onStylesAdded(n){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(n,r,i)})}ngOnDestroy(){this._hostNodes.forEach(n=>n.forEach(A9))}}return e.\u0275fac=function(n){return new(n||e)(me(ni))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();function A9(e){bl().remove(e)}const H2={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},U2=/%COMP%/g;function cw(e,t,n){for(let i=0;i<t.length;i++){let r=t[i];Array.isArray(r)?cw(e,r,n):(r=r.replace(U2,e),n.push(r))}return n}function O9(e){return t=>{if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}let dw=(()=>{class e{constructor(n,i,r){this.eventManager=n,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new z2(n)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;switch(i.encapsulation){case oa.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new Uve(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(n),r}case 1:case oa.ShadowDom:return new zve(this.eventManager,this.sharedStylesHost,n,i);default:if(!this.rendererByCompId.has(i.id)){const r=cw(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return e.\u0275fac=function(n){return new(n||e)(me(uw),me(y_),me(d_))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();class z2{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,n){return n?document.createElementNS(H2[n]||n,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,n){t.appendChild(n)}insertBefore(t,n,i){t&&t.insertBefore(n,i)}removeChild(t,n){t&&t.removeChild(n)}selectRootElement(t,n){let i="string"==typeof t?document.querySelector(t):t;if(!i)throw new Error(`The selector "${t}" did not match any elements`);return n||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,n,i,r){if(r){n=r+":"+n;const s=H2[r];s?t.setAttributeNS(s,n,i):t.setAttribute(n,i)}else t.setAttribute(n,i)}removeAttribute(t,n,i){if(i){const r=H2[i];r?t.removeAttributeNS(r,n):t.removeAttribute(`${i}:${n}`)}else t.removeAttribute(n)}addClass(t,n){t.classList.add(n)}removeClass(t,n){t.classList.remove(n)}setStyle(t,n,i,r){r&($s.DashCase|$s.Important)?t.style.setProperty(n,i,r&$s.Important?"important":""):t.style[n]=i}removeStyle(t,n,i){i&$s.DashCase?t.style.removeProperty(n):t.style[n]=""}setProperty(t,n,i){t[n]=i}setValue(t,n){t.nodeValue=n}listen(t,n,i){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,n,O9(i)):this.eventManager.addEventListener(t,n,O9(i))}}class Uve extends z2{constructor(t,n,i,r){super(t),this.component=i;const s=cw(r+"-"+i.id,i.styles,[]);n.addStyles(s),this.contentAttr=function $ve(e){return"_ngcontent-%COMP%".replace(U2,e)}(r+"-"+i.id),this.hostAttr=function Vve(e){return"_nghost-%COMP%".replace(U2,e)}(r+"-"+i.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,n){const i=super.createElement(t,n);return super.setAttribute(i,this.contentAttr,""),i}}class zve extends z2{constructor(t,n,i,r){super(t),this.sharedStylesHost=n,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=cw(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,n){return super.appendChild(this.nodeOrShadowRoot(t),n)}insertBefore(t,n,i){return super.insertBefore(this.nodeOrShadowRoot(t),n,i)}removeChild(t,n){return super.removeChild(this.nodeOrShadowRoot(t),n)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let qve=(()=>{class e extends S9{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,r){return n.addEventListener(i,r,!1),()=>this.removeEventListener(n,i,r)}removeEventListener(n,i,r){return n.removeEventListener(i,r)}}return e.\u0275fac=function(n){return new(n||e)(me(ni))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();const k9=["alt","control","meta","shift"],Wve={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},I9={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Yve={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let Kve=(()=>{class e extends S9{constructor(n){super(n)}supports(n){return null!=e.parseEventName(n)}addEventListener(n,i,r){const s=e.parseEventName(i),o=e.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>bl().onAndCancel(n,s.domEventName,o))}static parseEventName(n){const i=n.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=e._normalizeKey(i.pop());let o="";if(k9.forEach(l=>{const u=i.indexOf(l);u>-1&&(i.splice(u,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(n){let i="",r=function Jve(e){let t=e.key;if(null==t){if(t=e.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&I9.hasOwnProperty(t)&&(t=I9[t]))}return Wve[t]||t}(n);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),k9.forEach(s=>{s!=r&&Yve[s](n)&&(i+=s+".")}),i+=r,i}static eventCallback(n,i,r){return s=>{e.getEventFullKey(s)===n&&r.runGuarded(()=>i(s))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return e.\u0275fac=function(n){return new(n||e)(me(ni))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();const e1e=V7(iye,"browser",[{provide:f_,useValue:"browser"},{provide:k7,useValue:function Xve(){$2.makeCurrent(),V2.init()},multi:!0},{provide:ni,useFactory:function Zve(){return function Ede(e){rM=e}(document),document},deps:[]}]),t1e=[{provide:yT,useValue:"root"},{provide:z0,useFactory:function Qve(){return new z0},deps:[]},{provide:lw,useClass:qve,multi:!0,deps:[ni,hn,f_]},{provide:lw,useClass:Kve,multi:!0,deps:[ni]},{provide:dw,useClass:dw,deps:[uw,y_,d_]},{provide:lg,useExisting:dw},{provide:x9,useExisting:y_},{provide:y_,useClass:y_,deps:[ni]},{provide:_2,useClass:_2,deps:[hn]},{provide:uw,useClass:uw,deps:[lw,hn]},{provide:C9,useClass:Lve,deps:[]}];let R9=(()=>{class e{constructor(n){if(n)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(n){return{ngModule:e,providers:[{provide:d_,useValue:n.appId},{provide:E9,useExisting:d_},Pve]}}}return e.\u0275fac=function(n){return new(n||e)(me(e,12))},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({providers:t1e,imports:[zs,rye]}),e})();function We(...e){return Oi(e,w0(e))}"undefined"!=typeof window&&window;class Ii extends Pn{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const n=super._subscribe(t);return!n.closed&&t.next(this._value),n}getValue(){const{hasError:t,thrownError:n,_value:i}=this;if(t)throw n;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}}const{isArray:f1e}=Array,{getPrototypeOf:h1e,prototype:p1e,keys:g1e}=Object;function L9(e){if(1===e.length){const t=e[0];if(f1e(t))return{args:t,keys:null};if(function m1e(e){return e&&"object"==typeof e&&h1e(e)===p1e}(t)){const n=g1e(t);return{args:n.map(i=>t[i]),keys:n}}}return{args:e,keys:null}}const{isArray:_1e}=Array;function G2(e){return at(t=>function y1e(e,t){return _1e(t)?e(...t):e(t)}(e,t))}function j9(e,t){return e.reduce((n,i,r)=>(n[i]=t[r],n),{})}function B9(e,t,n){e?Cu(n,e,t):t()}function fw(e,t){const n=Qe(e)?e:()=>e,i=r=>r.error(n());return new en(t?r=>t.schedule(i,0,r):i)}const hw=Ye(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function v_(...e){return function b1e(){return b0(1)}()(Oi(e,w0(e)))}function $9(e){return new en(t=>{sr(e()).subscribe(t)})}function V9(){return Qn((e,t)=>{let n=null;e._refCount++;const i=bn(t,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(n=null);const r=e._connection,s=n;n=null,r&&(!s||r===s)&&r.unsubscribe(),t.unsubscribe()});e.subscribe(i),i.closed||(n=e.connect())})}class w1e extends en{constructor(t,n){super(),this.source=t,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,c4(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,null==t||t.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new Xn;const n=this.getSubject();t.add(this.source.subscribe(bn(n,void 0,()=>{this._teardown(),n.complete()},i=>{this._teardown(),n.error(i)},()=>this._teardown()))),t.closed&&(this._connection=null,t=Xn.EMPTY)}return t}refCount(){return V9()(this)}}function Ru(e,t){return Qn((n,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();n.subscribe(bn(i,l=>{null==r||r.unsubscribe();let u=0;const c=s++;sr(e(l,c)).subscribe(r=bn(i,d=>i.next(t?t(l,d,c,u++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function D1e(e,t,n,i,r){return(s,o)=>{let a=n,l=t,u=0;s.subscribe(bn(o,c=>{const d=u++;l=a?e(l,c,d):(a=!0,c),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}function H9(e,t){return Qn(D1e(e,t,arguments.length>=2,!0))}function Ri(e,t){return Qn((n,i)=>{let r=0;n.subscribe(bn(i,s=>e.call(t,s,r++)&&i.next(s)))})}function jc(e){return Qn((t,n)=>{let s,i=null,r=!1;i=t.subscribe(bn(n,void 0,void 0,o=>{s=sr(e(o,jc(e)(t))),i?(i.unsubscribe(),i=null,s.subscribe(n)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(n))})}function hg(e,t){return Qe(t)?Zn(e,t,1):Zn(e,1)}function Y2(e){return e<=0?()=>ra:Qn((t,n)=>{let i=[];t.subscribe(bn(n,r=>{i.push(r),e<i.length&&i.shift()},()=>{for(const r of i)n.next(r);n.complete()},void 0,()=>{i=null}))})}function U9(e=C1e){return Qn((t,n)=>{let i=!1;t.subscribe(bn(n,r=>{i=!0,n.next(r)},()=>i?n.complete():n.error(e())))})}function C1e(){return new hw}function z9(e){return Qn((t,n)=>{let i=!1;t.subscribe(bn(n,r=>{i=!0,n.next(r)},()=>{i||n.next(e),n.complete()}))})}function pg(e,t){const n=arguments.length>=2;return i=>i.pipe(e?Ri((r,s)=>e(r,s,i)):Du,mi(1),n?z9(t):U9(()=>new hw))}function hr(e,t,n){const i=Qe(e)||t||n?{next:e,error:t,complete:n}:e;return i?Qn((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(bn(s,l=>{var u;null===(u=i.next)||void 0===u||u.call(i,l),s.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),s.complete()},l=>{var u;a=!1,null===(u=i.error)||void 0===u||u.call(i,l),s.error(l)},()=>{var l,u;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(u=i.finalize)||void 0===u||u.call(i)}))}):Du}class Fu{constructor(t,n){this.id=t,this.url=n}}class K2 extends Fu{constructor(t,n,i="imperative",r=null){super(t,n),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class b_ extends Fu{constructor(t,n,i){super(t,n),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class q9 extends Fu{constructor(t,n,i){super(t,n),this.reason=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class x1e extends Fu{constructor(t,n,i){super(t,n),this.error=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class A1e extends Fu{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class M1e extends Fu{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class T1e extends Fu{constructor(t,n,i,r,s){super(t,n),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class O1e extends Fu{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class N1e extends Fu{constructor(t,n,i,r){super(t,n),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class G9{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class W9{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class k1e{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class I1e{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class R1e{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class F1e{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Y9{constructor(t,n,i){this.routerEvent=t,this.position=n,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const gt="primary";class P1e{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n[0]:n}return null}getAll(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function gg(e){return new P1e(e)}const K9="ngNavigationCancelingError";function J2(e){const t=Error("NavigationCancelingError: "+e);return t[K9]=!0,t}function j1e(e,t,n){const i=n.path.split("/");if(i.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||i.length<e.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=e[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:e.slice(0,i.length),posParams:r}}function wl(e,t){const n=e?Object.keys(e):void 0,i=t?Object.keys(t):void 0;if(!n||!i||n.length!=i.length)return!1;let r;for(let s=0;s<n.length;s++)if(r=n[s],!J9(e[r],t[r]))return!1;return!0}function J9(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;const n=[...e].sort(),i=[...t].sort();return n.every((r,s)=>i[s]===r)}return e===t}function X9(e){return Array.prototype.concat.apply([],e)}function Q9(e){return e.length>0?e[e.length-1]:null}function Ki(e,t){for(const n in e)e.hasOwnProperty(n)&&t(e[n],n)}function Dl(e){return IT(e)?e:Q0(e)?Oi(Promise.resolve(e)):We(e)}const V1e={exact:function tH(e,t,n){if(!If(e.segments,t.segments)||!gw(e.segments,t.segments,n)||e.numberOfChildren!==t.numberOfChildren)return!1;for(const i in t.children)if(!e.children[i]||!tH(e.children[i],t.children[i],n))return!1;return!0},subset:nH},Z9={exact:function H1e(e,t){return wl(e,t)},subset:function U1e(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(n=>J9(e[n],t[n]))},ignored:()=>!0};function eH(e,t,n){return V1e[n.paths](e.root,t.root,n.matrixParams)&&Z9[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function nH(e,t,n){return iH(e,t,t.segments,n)}function iH(e,t,n,i){if(e.segments.length>n.length){const r=e.segments.slice(0,n.length);return!(!If(r,n)||t.hasChildren()||!gw(r,n,i))}if(e.segments.length===n.length){if(!If(e.segments,n)||!gw(e.segments,n,i))return!1;for(const r in t.children)if(!e.children[r]||!nH(e.children[r],t.children[r],i))return!1;return!0}{const r=n.slice(0,e.segments.length),s=n.slice(e.segments.length);return!!(If(e.segments,r)&&gw(e.segments,r,i)&&e.children[gt])&&iH(e.children[gt],t,s,i)}}function gw(e,t,n){return t.every((i,r)=>Z9[n](e[r].parameters,i.parameters))}class kf{constructor(t,n,i){this.root=t,this.queryParams=n,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=gg(this.queryParams)),this._queryParamMap}toString(){return G1e.serialize(this)}}class yt{constructor(t,n){this.segments=t,this.children=n,this.parent=null,Ki(n,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return mw(this)}}class w_{constructor(t,n){this.path=t,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=gg(this.parameters)),this._parameterMap}toString(){return lH(this)}}function If(e,t){return e.length===t.length&&e.every((n,i)=>n.path===t[i].path)}class rH{}class sH{parse(t){const n=new tbe(t);return new kf(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(t){const n=`/${D_(t.root,!0)}`,i=function K1e(e){const t=Object.keys(e).map(n=>{const i=e[n];return Array.isArray(i)?i.map(r=>`${_w(n)}=${_w(r)}`).join("&"):`${_w(n)}=${_w(i)}`}).filter(n=>!!n);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${n}${i}${"string"==typeof t.fragment?`#${function W1e(e){return encodeURI(e)}(t.fragment)}`:""}`}}const G1e=new sH;function mw(e){return e.segments.map(t=>lH(t)).join("/")}function D_(e,t){if(!e.hasChildren())return mw(e);if(t){const n=e.children[gt]?D_(e.children[gt],!1):"",i=[];return Ki(e.children,(r,s)=>{s!==gt&&i.push(`${s}:${D_(r,!1)}`)}),i.length>0?`${n}(${i.join("//")})`:n}{const n=function q1e(e,t){let n=[];return Ki(e.children,(i,r)=>{r===gt&&(n=n.concat(t(i,r)))}),Ki(e.children,(i,r)=>{r!==gt&&(n=n.concat(t(i,r)))}),n}(e,(i,r)=>r===gt?[D_(e.children[gt],!1)]:[`${r}:${D_(i,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[gt]?`${mw(e)}/${n[0]}`:`${mw(e)}/(${n.join("//")})`}}function oH(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function _w(e){return oH(e).replace(/%3B/gi,";")}function X2(e){return oH(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function yw(e){return decodeURIComponent(e)}function aH(e){return yw(e.replace(/\+/g,"%20"))}function lH(e){return`${X2(e.path)}${function Y1e(e){return Object.keys(e).map(t=>`;${X2(t)}=${X2(e[t])}`).join("")}(e.parameters)}`}const J1e=/^[^\/()?;=#]+/;function vw(e){const t=e.match(J1e);return t?t[0]:""}const X1e=/^[^=?&#]+/,Z1e=/^[^&#]+/;class tbe{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new yt([],{}):new yt([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(t.length>0||Object.keys(n).length>0)&&(i[gt]=new yt(t,n)),i}parseSegment(){const t=vw(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new w_(yw(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const n=vw(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){const r=vw(this.remaining);r&&(i=r,this.capture(i))}t[yw(n)]=yw(i)}parseQueryParam(t){const n=function Q1e(e){const t=e.match(X1e);return t?t[0]:""}(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){const o=function ebe(e){const t=e.match(Z1e);return t?t[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=aH(n),s=aH(i);if(t.hasOwnProperty(r)){let o=t[r];Array.isArray(o)||(o=[o],t[r]=o),o.push(s)}else t[r]=s}parseParens(t){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=vw(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let s;i.indexOf(":")>-1?(s=i.substr(0,i.indexOf(":")),this.capture(s),this.capture(":")):t&&(s=gt);const o=this.parseChildren();n[s]=1===Object.keys(o).length?o[gt]:new yt([],o),this.consumeOptional("//")}return n}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class uH{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const n=this.pathFromRoot(t);return n.length>1?n[n.length-2]:null}children(t){const n=Q2(t,this._root);return n?n.children.map(i=>i.value):[]}firstChild(t){const n=Q2(t,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(t){const n=Z2(t,this._root);return n.length<2?[]:n[n.length-2].children.map(r=>r.value).filter(r=>r!==t)}pathFromRoot(t){return Z2(t,this._root).map(n=>n.value)}}function Q2(e,t){if(e===t.value)return t;for(const n of t.children){const i=Q2(e,n);if(i)return i}return null}function Z2(e,t){if(e===t.value)return[t];for(const n of t.children){const i=Z2(e,n);if(i.length)return i.unshift(t),i}return[]}class Pu{constructor(t,n){this.value=t,this.children=n}toString(){return`TreeNode(${this.value})`}}function mg(e){const t={};return e&&e.children.forEach(n=>t[n.value.outlet]=n),t}class cH extends uH{constructor(t,n){super(t),this.snapshot=n,eO(this,t)}toString(){return this.snapshot.toString()}}function dH(e,t){const n=function nbe(e,t){const o=new bw([],{},{},"",{},gt,t,null,e.root,-1,{});return new hH("",new Pu(o,[]))}(e,t),i=new Ii([new w_("",{})]),r=new Ii({}),s=new Ii({}),o=new Ii({}),a=new Ii(""),l=new Rf(i,r,o,a,s,gt,t,n.root);return l.snapshot=n.root,new cH(new Pu(l,[]),n)}class Rf{constructor(t,n,i,r,s,o,a,l){this.url=t,this.params=n,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(at(t=>gg(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(at(t=>gg(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function fH(e,t="emptyOnly"){const n=e.pathFromRoot;let i=0;if("always"!==t)for(i=n.length-1;i>=1;){const r=n[i],s=n[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function ibe(e){return e.reduce((t,n)=>({params:Object.assign(Object.assign({},t.params),n.params),data:Object.assign(Object.assign({},t.data),n.data),resolve:Object.assign(Object.assign({},t.resolve),n._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(i))}class bw{constructor(t,n,i,r,s,o,a,l,u,c,d){this.url=t,this.params=n,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=u,this._lastPathIndex=c,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=gg(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=gg(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class hH extends uH{constructor(t,n){super(n),this.url=t,eO(this,n)}toString(){return pH(this._root)}}function eO(e,t){t.value._routerState=e,t.children.forEach(n=>eO(e,n))}function pH(e){const t=e.children.length>0?` { ${e.children.map(pH).join(", ")} } `:"";return`${e.value}${t}`}function tO(e){if(e.snapshot){const t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,wl(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),wl(t.params,n.params)||e.params.next(n.params),function B1e(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!wl(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),wl(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function nO(e,t){const n=wl(e.params,t.params)&&function z1e(e,t){return If(e,t)&&e.every((n,i)=>wl(n.parameters,t[i].parameters))}(e.url,t.url);return n&&!(!e.parent!=!t.parent)&&(!e.parent||nO(e.parent,t.parent))}function C_(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){const i=n.value;i._futureSnapshot=t.value;const r=function sbe(e,t,n){return t.children.map(i=>{for(const r of n.children)if(e.shouldReuseRoute(i.value,r.value.snapshot))return C_(e,i,r);return C_(e,i)})}(e,t,n);return new Pu(i,r)}{if(e.shouldAttach(t.value)){const s=e.retrieve(t.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=t.value,o.children=t.children.map(a=>C_(e,a)),o}}const i=function obe(e){return new Rf(new Ii(e.url),new Ii(e.params),new Ii(e.queryParams),new Ii(e.fragment),new Ii(e.data),e.outlet,e.component,e)}(t.value),r=t.children.map(s=>C_(e,s));return new Pu(i,r)}}function ww(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function E_(e){return"object"==typeof e&&null!=e&&e.outlets}function iO(e,t,n,i,r){let s={};if(i&&Ki(i,(a,l)=>{s[l]=Array.isArray(a)?a.map(u=>`${u}`):`${a}`}),e===t)return new kf(n,s,r);const o=gH(e,t,n);return new kf(o,s,r)}function gH(e,t,n){const i={};return Ki(e.children,(r,s)=>{i[s]=r===t?n:gH(r,t,n)}),new yt(e.segments,i)}class mH{constructor(t,n,i){if(this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=i,t&&i.length>0&&ww(i[0]))throw new Error("Root segment cannot have matrix parameters");const r=i.find(E_);if(r&&r!==Q9(i))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class rO{constructor(t,n,i){this.segmentGroup=t,this.processChildren=n,this.index=i}}function _H(e,t,n){if(e||(e=new yt([],{})),0===e.segments.length&&e.hasChildren())return Dw(e,t,n);const i=function fbe(e,t,n){let i=0,r=t;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<e.segments.length;){if(i>=n.length)return s;const o=e.segments[r],a=n[i];if(E_(a))break;const l=`${a}`,u=i<n.length-1?n[i+1]:null;if(r>0&&void 0===l)break;if(l&&u&&"object"==typeof u&&void 0===u.outlets){if(!vH(l,u,o))return s;i+=2}else{if(!vH(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(e,t,n),r=n.slice(i.commandIndex);if(i.match&&i.pathIndex<e.segments.length){const s=new yt(e.segments.slice(0,i.pathIndex),{});return s.children[gt]=new yt(e.segments.slice(i.pathIndex),e.children),Dw(s,0,r)}return i.match&&0===r.length?new yt(e.segments,{}):i.match&&!e.hasChildren()?sO(e,t,n):i.match?Dw(e,0,r):sO(e,t,n)}function Dw(e,t,n){if(0===n.length)return new yt(e.segments,{});{const i=function dbe(e){return E_(e[0])?e[0].outlets:{[gt]:e}}(n),r={};return Ki(i,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=_H(e.children[o],t,s))}),Ki(e.children,(s,o)=>{void 0===i[o]&&(r[o]=s)}),new yt(e.segments,r)}}function sO(e,t,n){const i=e.segments.slice(0,t);let r=0;for(;r<n.length;){const s=n[r];if(E_(s)){const l=hbe(s.outlets);return new yt(i,l)}if(0===r&&ww(n[0])){i.push(new w_(e.segments[t].path,yH(n[0]))),r++;continue}const o=E_(s)?s.outlets[gt]:`${s}`,a=r<n.length-1?n[r+1]:null;o&&a&&ww(a)?(i.push(new w_(o,yH(a))),r+=2):(i.push(new w_(o,{})),r++)}return new yt(i,{})}function hbe(e){const t={};return Ki(e,(n,i)=>{"string"==typeof n&&(n=[n]),null!==n&&(t[i]=sO(new yt([],{}),0,n))}),t}function yH(e){const t={};return Ki(e,(n,i)=>t[i]=`${n}`),t}function vH(e,t,n){return e==n.path&&wl(t,n.parameters)}class gbe{constructor(t,n,i,r){this.routeReuseStrategy=t,this.futureState=n,this.currState=i,this.forwardEvent=r}activate(t){const n=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,i,t),tO(this.futureState.root),this.activateChildRoutes(n,i,t)}deactivateChildRoutes(t,n,i){const r=mg(n);t.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Ki(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(t,n,i){const r=t.value,s=n?n.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(t,n,o.children)}else this.deactivateChildRoutes(t,n,i);else s&&this.deactivateRouteAndItsChildren(n,i)}deactivateRouteAndItsChildren(t,n){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,n):this.deactivateRouteAndOutlet(t,n)}detachAndStoreRouteSubtree(t,n){const i=n.getContext(t.value.outlet),r=i&&t.value.component?i.children:n,s=mg(t);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:o,route:t,contexts:a})}}deactivateRouteAndOutlet(t,n){const i=n.getContext(t.value.outlet),r=i&&t.value.component?i.children:n,s=mg(t);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(t,n,i){const r=mg(n);t.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new F1e(s.value.snapshot))}),t.children.length&&this.forwardEvent(new I1e(t.value.snapshot))}activateRoutes(t,n,i){const r=t.value,s=n?n.value:null;if(tO(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(t,n,o.children)}else this.activateChildRoutes(t,n,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),tO(a.route.value),this.activateChildRoutes(t,null,o.children)}else{const a=function mbe(e){for(let t=e.parent;t;t=t.parent){const n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),l=a?a.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=l,o.outlet&&o.outlet.activateWith(r,l),this.activateChildRoutes(t,null,o.children)}}else this.activateChildRoutes(t,null,i)}}class oO{constructor(t,n){this.routes=t,this.module=n}}function Bc(e){return"function"==typeof e}function Ff(e){return e instanceof kf}const S_=Symbol("INITIAL_VALUE");function x_(){return Ru(e=>function W2(...e){const t=w0(e),n=q1(e),{args:i,keys:r}=L9(e);if(0===i.length)return Oi([],t);const s=new en(function v1e(e,t,n=Du){return i=>{B9(t,()=>{const{length:r}=e,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)B9(t,()=>{const u=Oi(e[l],t);let c=!1;u.subscribe(bn(i,d=>{s[l]=d,c||(c=!0,a--),a||i.next(n(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,t,r?o=>j9(r,o):Du));return n?s.pipe(G2(n)):s}(e.map(t=>t.pipe(mi(1),function pw(...e){const t=w0(e);return Qn((n,i)=>{(t?v_(e,n,t):v_(e,n)).subscribe(i)})}(S_)))).pipe(H9((t,n)=>{let i=!1;return n.reduce((r,s,o)=>r!==S_?r:(s===S_&&(i=!0),i||!1!==s&&o!==n.length-1&&!Ff(s)?r:s),t)},S_),Ri(t=>t!==S_),at(t=>Ff(t)?t:!0===t),mi(1)))}class Dbe{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new A_,this.attachRef=null}}class A_{constructor(){this.contexts=new Map}onChildOutletCreated(t,n){const i=this.getOrCreateContext(t);i.outlet=n,this.contexts.set(t,i)}onChildOutletDestroyed(t){const n=this.getContext(t);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let n=this.getContext(t);return n||(n=new Dbe,this.contexts.set(t,n)),n}getContext(t){return this.contexts.get(t)||null}}let aO=(()=>{class e{constructor(n,i,r,s,o){this.parentContexts=n,this.location=i,this.resolver=r,this.changeDetector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new nt,this.deactivateEvents=new nt,this.attachEvents=new nt,this.detachEvents=new nt,this.name=s||gt,n.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const n=this.parentContexts.getContext(this.name);n&&n.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=n;const o=(i=i||this.resolver).resolveComponentFactory(n._futureSnapshot.routeConfig.component),a=this.parentContexts.getOrCreateContext(this.name).children,l=new Cbe(n,a,this.location.injector);this.activated=this.location.createComponent(o,this.location.length,l),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return e.\u0275fac=function(n){return new(n||e)(H(A_),H(xo),H(og),function Sf(e){return function tfe(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;const n=e.attrs;if(n){const i=n.length;let r=0;for(;r<i;){const s=n[r];if(i8(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof n[r];)r++;else{if(s===t)return n[r+1];r+=2}}}return null}(_i(),e)}("name"),H(Mo))},e.\u0275dir=ye({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),e})();class Cbe{constructor(t,n,i){this.route=t,this.childContexts=n,this.parent=i}get(t,n){return t===Rf?this.route:t===A_?this.childContexts:this.parent.get(t,n)}}let bH=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Nt({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(n,i){1&n&&Me(0,"router-outlet")},directives:[aO],encapsulation:2}),e})();function wH(e,t=""){for(let n=0;n<e.length;n++){const i=e[n];Ebe(i,Sbe(t,i))}}function Ebe(e,t){e.children&&wH(e.children,t)}function Sbe(e,t){return t?e||t.path?e&&!t.path?`${e}/`:!e&&t.path?t.path:`${e}/${t.path}`:"":e}function lO(e){const t=e.children&&e.children.map(lO),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==gt&&(n.component=bH),n}function No(e){return e.outlet||gt}function DH(e,t){const n=e.filter(i=>No(i)===t);return n.push(...e.filter(i=>No(i)!==t)),n}const CH={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Cw(e,t,n){var i;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?Object.assign({},CH):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};const s=(t.matcher||j1e)(n,e,t);if(!s)return Object.assign({},CH);const o={};Ki(s.posParams,(l,u)=>{o[u]=l.path});const a=s.consumed.length>0?Object.assign(Object.assign({},o),s.consumed[s.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:s.consumed,remainingSegments:n.slice(s.consumed.length),parameters:a,positionalParamSegments:null!==(i=s.posParams)&&void 0!==i?i:{}}}function Ew(e,t,n,i,r="corrected"){if(n.length>0&&function Mbe(e,t,n){return n.some(i=>Sw(e,t,i)&&No(i)!==gt)}(e,n,i)){const o=new yt(t,function Abe(e,t,n,i){const r={};r[gt]=i,i._sourceSegment=e,i._segmentIndexShift=t.length;for(const s of n)if(""===s.path&&No(s)!==gt){const o=new yt([],{});o._sourceSegment=e,o._segmentIndexShift=t.length,r[No(s)]=o}return r}(e,t,i,new yt(n,e.children)));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:[]}}if(0===n.length&&function Tbe(e,t,n){return n.some(i=>Sw(e,t,i))}(e,n,i)){const o=new yt(e.segments,function xbe(e,t,n,i,r,s){const o={};for(const a of i)if(Sw(e,n,a)&&!r[No(a)]){const l=new yt([],{});l._sourceSegment=e,l._segmentIndexShift="legacy"===s?e.segments.length:t.length,o[No(a)]=l}return Object.assign(Object.assign({},r),o)}(e,t,n,i,e.children,r));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:n}}const s=new yt(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function Sw(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function EH(e,t,n,i){return!!(No(e)===i||i!==gt&&Sw(t,n,e))&&("**"===e.path||Cw(t,e,n).matched)}function SH(e,t,n){return 0===t.length&&!e.children[n]}class xw{constructor(t){this.segmentGroup=t||null}}class xH{constructor(t){this.urlTree=t}}function M_(e){return fw(new xw(e))}function AH(e){return fw(new xH(e))}class Ibe{constructor(t,n,i,r,s){this.configLoader=n,this.urlSerializer=i,this.urlTree=r,this.config=s,this.allowRedirects=!0,this.ngModule=t.get(Nu)}apply(){const t=Ew(this.urlTree.root,[],[],this.config).segmentGroup,n=new yt(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,n,gt).pipe(at(s=>this.createUrlTree(uO(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(jc(s=>{if(s instanceof xH)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof xw?this.noMatchError(s):s}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,gt).pipe(at(r=>this.createUrlTree(uO(r),t.queryParams,t.fragment))).pipe(jc(r=>{throw r instanceof xw?this.noMatchError(r):r}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,n,i){const r=t.segments.length>0?new yt([],{[gt]:t}):t;return new kf(r,n,i)}expandSegmentGroup(t,n,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(t,n,i).pipe(at(s=>new yt([],s))):this.expandSegment(t,i,n,i.segments,r,!0)}expandChildren(t,n,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return Oi(r).pipe(hg(s=>{const o=i.children[s],a=DH(n,s);return this.expandSegmentGroup(t,a,o,s).pipe(at(l=>({segment:l,outlet:s})))}),H9((s,o)=>(s[o.outlet]=o.segment,s),{}),function E1e(e,t){const n=arguments.length>=2;return i=>i.pipe(e?Ri((r,s)=>e(r,s,i)):Du,Y2(1),n?z9(t):U9(()=>new hw))}())}expandSegment(t,n,i,r,s,o){return Oi(i).pipe(hg(a=>this.expandSegmentAgainstRoute(t,n,i,a,r,s,o).pipe(jc(u=>{if(u instanceof xw)return We(null);throw u}))),pg(a=>!!a),jc((a,l)=>{if(a instanceof hw||"EmptyError"===a.name)return SH(n,r,s)?We(new yt([],{})):M_(n);throw a}))}expandSegmentAgainstRoute(t,n,i,r,s,o,a){return EH(r,n,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,n,r,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,n,i,r,s,o):M_(n):M_(n)}expandSegmentAgainstRouteUsingRedirect(t,n,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,n,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,i,r){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?AH(s):this.lineralizeSegments(i,s).pipe(Zn(o=>{const a=new yt(o,{});return this.expandSegment(t,a,n,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,n,i,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:u,positionalParamSegments:c}=Cw(n,r,s);if(!a)return M_(n);const d=this.applyRedirectCommands(l,r.redirectTo,c);return r.redirectTo.startsWith("/")?AH(d):this.lineralizeSegments(r,d).pipe(Zn(f=>this.expandSegment(t,n,i,f.concat(u),o,!1)))}matchSegmentAgainstRoute(t,n,i,r,s){if("**"===i.path)return i.loadChildren?(i._loadedConfig?We(i._loadedConfig):this.configLoader.load(t.injector,i)).pipe(at(d=>(i._loadedConfig=d,new yt(r,{})))):We(new yt(r,{}));const{matched:o,consumedSegments:a,remainingSegments:l}=Cw(n,i,r);return o?this.getChildConfig(t,i,r).pipe(Zn(c=>{const d=c.module,f=c.routes,{segmentGroup:h,slicedSegments:p}=Ew(n,a,l,f),g=new yt(h.segments,h.children);if(0===p.length&&g.hasChildren())return this.expandChildren(d,f,g).pipe(at(v=>new yt(a,v)));if(0===f.length&&0===p.length)return We(new yt(a,{}));const m=No(i)===s;return this.expandSegment(d,g,f,p,m?gt:s,!0).pipe(at(y=>new yt(a.concat(y.segments),y.children)))})):M_(n)}getChildConfig(t,n,i){return n.children?We(new oO(n.children,t)):n.loadChildren?void 0!==n._loadedConfig?We(n._loadedConfig):this.runCanLoadGuards(t.injector,n,i).pipe(Zn(r=>r?this.configLoader.load(t.injector,n).pipe(at(s=>(n._loadedConfig=s,s))):function Nbe(e){return fw(J2(`Cannot load children because the guard of the route "path: '${e.path}'" returned false`))}(n))):We(new oO([],t))}runCanLoadGuards(t,n,i){const r=n.canLoad;return r&&0!==r.length?We(r.map(o=>{const a=t.get(o);let l;if(function ybe(e){return e&&Bc(e.canLoad)}(a))l=a.canLoad(n,i);else{if(!Bc(a))throw new Error("Invalid CanLoad guard");l=a(n,i)}return Dl(l)})).pipe(x_(),hr(o=>{if(!Ff(o))return;const a=J2(`Redirecting to "${this.urlSerializer.serialize(o)}"`);throw a.url=o,a}),at(o=>!0===o)):We(!0)}lineralizeSegments(t,n){let i=[],r=n.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return We(i);if(r.numberOfChildren>1||!r.children[gt])return fw(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t.redirectTo}'`));r=r.children[gt]}}applyRedirectCommands(t,n,i){return this.applyRedirectCreatreUrlTree(n,this.urlSerializer.parse(n),t,i)}applyRedirectCreatreUrlTree(t,n,i,r){const s=this.createSegmentGroup(t,n.root,i,r);return new kf(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(t,n){const i={};return Ki(t,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const a=r.substring(1);i[s]=n[a]}else i[s]=r}),i}createSegmentGroup(t,n,i,r){const s=this.createSegments(t,n.segments,i,r);let o={};return Ki(n.children,(a,l)=>{o[l]=this.createSegmentGroup(t,a,i,r)}),new yt(s,o)}createSegments(t,n,i,r){return n.map(s=>s.path.startsWith(":")?this.findPosParam(t,s,r):this.findOrReturn(s,i))}findPosParam(t,n,i){const r=i[n.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${t}'. Cannot find '${n.path}'.`);return r}findOrReturn(t,n){let i=0;for(const r of n){if(r.path===t.path)return n.splice(i),r;i++}return t}}function uO(e){const t={};for(const i of Object.keys(e.children)){const s=uO(e.children[i]);(s.segments.length>0||s.hasChildren())&&(t[i]=s)}return function Rbe(e){if(1===e.numberOfChildren&&e.children[gt]){const t=e.children[gt];return new yt(e.segments.concat(t.segments),t.children)}return e}(new yt(e.segments,t))}class MH{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Aw{constructor(t,n){this.component=t,this.route=n}}function Pbe(e,t,n){const i=e._root;return T_(i,t?t._root:null,n,[i.value])}function Mw(e,t,n){const i=function jbe(e){if(!e)return null;for(let t=e.parent;t;t=t.parent){const n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(i?i.module.injector:n).get(e)}function T_(e,t,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=mg(t);return e.children.forEach(o=>{(function Bbe(e,t,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=e.value,o=t?t.value:null,a=n?n.getContext(e.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function $be(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!If(e.url,t.url);case"pathParamsOrQueryParamsChange":return!If(e.url,t.url)||!wl(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!nO(e,t)||!wl(e.queryParams,t.queryParams);default:return!nO(e,t)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new MH(i)):(s.data=o.data,s._resolvedData=o._resolvedData),T_(e,t,s.component?a?a.children:null:n,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Aw(a.outlet.component,o))}else o&&O_(t,a,r),r.canActivateChecks.push(new MH(i)),T_(e,null,s.component?a?a.children:null:n,i,r)})(o,s[o.value.outlet],n,i.concat([o.value]),r),delete s[o.value.outlet]}),Ki(s,(o,a)=>O_(o,n.getContext(a),r)),r}function O_(e,t,n){const i=mg(e),r=e.value;Ki(i,(s,o)=>{O_(s,r.component?t?t.children.getContext(o):null:t,n)}),n.canDeactivateChecks.push(new Aw(r.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,r))}class Kbe{}function TH(e){return new en(t=>t.error(e))}class Xbe{constructor(t,n,i,r,s,o){this.rootComponentType=t,this.config=n,this.urlTree=i,this.url=r,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=o}recognize(){const t=Ew(this.urlTree.root,[],[],this.config.filter(o=>void 0===o.redirectTo),this.relativeLinkResolution).segmentGroup,n=this.processSegmentGroup(this.config,t,gt);if(null===n)return null;const i=new bw([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},gt,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Pu(i,n),s=new hH(this.url,r);return this.inheritParamsAndData(s._root),s}inheritParamsAndData(t){const n=t.value,i=fH(n,this.paramsInheritanceStrategy);n.params=Object.freeze(i.params),n.data=Object.freeze(i.data),t.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(t,n,i){return 0===n.segments.length&&n.hasChildren()?this.processChildren(t,n):this.processSegment(t,n,n.segments,i)}processChildren(t,n){const i=[];for(const s of Object.keys(n.children)){const o=n.children[s],a=DH(t,s),l=this.processSegmentGroup(a,o,s);if(null===l)return null;i.push(...l)}const r=OH(i);return function Qbe(e){e.sort((t,n)=>t.value.outlet===gt?-1:n.value.outlet===gt?1:t.value.outlet.localeCompare(n.value.outlet))}(r),r}processSegment(t,n,i,r){for(const s of t){const o=this.processSegmentAgainstRoute(s,n,i,r);if(null!==o)return o}return SH(n,i,r)?[]:null}processSegmentAgainstRoute(t,n,i,r){if(t.redirectTo||!EH(t,n,i,r))return null;let s,o=[],a=[];if("**"===t.path){const h=i.length>0?Q9(i).parameters:{};s=new bw(i,h,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,IH(t),No(t),t.component,t,NH(n),kH(n)+i.length,RH(t))}else{const h=Cw(n,t,i);if(!h.matched)return null;o=h.consumedSegments,a=h.remainingSegments,s=new bw(o,h.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,IH(t),No(t),t.component,t,NH(n),kH(n)+o.length,RH(t))}const l=function Zbe(e){return e.children?e.children:e.loadChildren?e._loadedConfig.routes:[]}(t),{segmentGroup:u,slicedSegments:c}=Ew(n,o,a,l.filter(h=>void 0===h.redirectTo),this.relativeLinkResolution);if(0===c.length&&u.hasChildren()){const h=this.processChildren(l,u);return null===h?null:[new Pu(s,h)]}if(0===l.length&&0===c.length)return[new Pu(s,[])];const d=No(t)===r,f=this.processSegment(l,u,c,d?gt:r);return null===f?null:[new Pu(s,f)]}}function ewe(e){const t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function OH(e){const t=[],n=new Set;for(const i of e){if(!ewe(i)){t.push(i);continue}const r=t.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),n.add(r)):t.push(i)}for(const i of n){const r=OH(i.children);t.push(new Pu(i.value,r))}return t.filter(i=>!n.has(i))}function NH(e){let t=e;for(;t._sourceSegment;)t=t._sourceSegment;return t}function kH(e){let t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;for(;t._sourceSegment;)t=t._sourceSegment,n+=t._segmentIndexShift?t._segmentIndexShift:0;return n-1}function IH(e){return e.data||{}}function RH(e){return e.resolve||{}}function FH(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}function cO(e){return Ru(t=>{const n=e(t);return n?Oi(n).pipe(at(()=>t)):We(t)})}class lwe extends class awe{shouldDetach(t){return!1}store(t,n){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,n){return t.routeConfig===n.routeConfig}}{}const dO=new rt("ROUTES");class PH{constructor(t,n,i,r){this.injector=t,this.compiler=n,this.onLoadStartListener=i,this.onLoadEndListener=r}load(t,n){if(n._loader$)return n._loader$;this.onLoadStartListener&&this.onLoadStartListener(n);const r=this.loadModuleFactory(n.loadChildren).pipe(at(s=>{this.onLoadEndListener&&this.onLoadEndListener(n);const o=s.create(t);return new oO(X9(o.injector.get(dO,void 0,Ke.Self|Ke.Optional)).map(lO),o)}),jc(s=>{throw n._loader$=void 0,s}));return n._loader$=new w1e(r,()=>new Pn).pipe(V9()),n._loader$}loadModuleFactory(t){return Dl(t()).pipe(Zn(n=>n instanceof QV?We(n):Oi(this.compiler.compileModuleAsync(n))))}}class cwe{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,n){return t}}function dwe(e){throw e}function fwe(e,t,n){return t.parse("/")}function LH(e,t){return We(null)}const hwe={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},pwe={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let qs=(()=>{class e{constructor(n,i,r,s,o,a,l){this.rootComponentType=n,this.urlSerializer=i,this.rootContexts=r,this.location=s,this.config=l,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Pn,this.errorHandler=dwe,this.malformedUriErrorHandler=fwe,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:LH,afterPreactivation:LH},this.urlHandlingStrategy=new cwe,this.routeReuseStrategy=new lwe,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=o.get(Nu),this.console=o.get(R7);const d=o.get(hn);this.isNgZoneEnabled=d instanceof hn&&hn.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=function $1e(){return new kf(new yt([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new PH(o,a,f=>this.triggerEvent(new G9(f)),f=>this.triggerEvent(new W9(f))),this.routerState=dH(this.currentUrlTree,this.rootComponentType),this.transitions=new Ii({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var n;return null===(n=this.location.getState())||void 0===n?void 0:n.\u0275routerPageId}setupNavigations(n){const i=this.events;return n.pipe(Ri(r=>0!==r.id),at(r=>Object.assign(Object.assign({},r),{extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),Ru(r=>{let s=!1,o=!1;return We(r).pipe(hr(a=>{this.currentNavigation={id:a.id,initialUrl:a.currentRawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Ru(a=>{const l=this.browserUrlTree.toString(),u=!this.navigated||a.extractedUrl.toString()!==l||l!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||u)&&this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return jH(a.source)&&(this.browserUrlTree=a.extractedUrl),We(a).pipe(Ru(d=>{const f=this.transitions.getValue();return i.next(new K2(d.id,this.serializeUrl(d.extractedUrl),d.source,d.restoredState)),f!==this.transitions.getValue()?ra:Promise.resolve(d)}),function Fbe(e,t,n,i){return Ru(r=>function kbe(e,t,n,i,r){return new Ibe(e,t,n,i,r).apply()}(e,t,n,r.extractedUrl,i).pipe(at(s=>Object.assign(Object.assign({},r),{urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),hr(d=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:d.urlAfterRedirects})}),function twe(e,t,n,i,r){return Zn(s=>function Jbe(e,t,n,i,r="emptyOnly",s="legacy"){try{const o=new Xbe(e,t,n,i,r,s).recognize();return null===o?TH(new Kbe):We(o)}catch(o){return TH(o)}}(e,t,s.urlAfterRedirects,n(s.urlAfterRedirects),i,r).pipe(at(o=>Object.assign(Object.assign({},s),{targetSnapshot:o}))))}(this.rootComponentType,this.config,d=>this.serializeUrl(d),this.paramsInheritanceStrategy,this.relativeLinkResolution),hr(d=>{if("eager"===this.urlUpdateStrategy){if(!d.extras.skipLocationChange){const h=this.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl);this.setBrowserUrl(h,d)}this.browserUrlTree=d.urlAfterRedirects}const f=new A1e(d.id,this.serializeUrl(d.extractedUrl),this.serializeUrl(d.urlAfterRedirects),d.targetSnapshot);i.next(f)}));if(u&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:f,extractedUrl:h,source:p,restoredState:g,extras:m}=a,_=new K2(f,this.serializeUrl(h),p,g);i.next(_);const y=dH(h,this.rootComponentType).snapshot;return We(Object.assign(Object.assign({},a),{targetSnapshot:y,urlAfterRedirects:h,extras:Object.assign(Object.assign({},m),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=a.rawUrl,a.resolve(null),ra}),cO(a=>{const{targetSnapshot:l,id:u,extractedUrl:c,rawUrl:d,extras:{skipLocationChange:f,replaceUrl:h}}=a;return this.hooks.beforePreactivation(l,{navigationId:u,appliedUrlTree:c,rawUrlTree:d,skipLocationChange:!!f,replaceUrl:!!h})}),hr(a=>{const l=new M1e(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.triggerEvent(l)}),at(a=>Object.assign(Object.assign({},a),{guards:Pbe(a.targetSnapshot,a.currentSnapshot,this.rootContexts)})),function Vbe(e,t){return Zn(n=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return 0===o.length&&0===s.length?We(Object.assign(Object.assign({},n),{guardsResult:!0})):function Hbe(e,t,n,i){return Oi(e).pipe(Zn(r=>function Ybe(e,t,n,i,r){const s=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return s&&0!==s.length?We(s.map(a=>{const l=Mw(a,t,r);let u;if(function wbe(e){return e&&Bc(e.canDeactivate)}(l))u=Dl(l.canDeactivate(e,t,n,i));else{if(!Bc(l))throw new Error("Invalid CanDeactivate guard");u=Dl(l(e,t,n,i))}return u.pipe(pg())})).pipe(x_()):We(!0)}(r.component,r.route,n,t,i)),pg(r=>!0!==r,!0))}(o,i,r,e).pipe(Zn(a=>a&&function _be(e){return"boolean"==typeof e}(a)?function Ube(e,t,n,i){return Oi(t).pipe(hg(r=>v_(function qbe(e,t){return null!==e&&t&&t(new k1e(e)),We(!0)}(r.route.parent,i),function zbe(e,t){return null!==e&&t&&t(new R1e(e)),We(!0)}(r.route,i),function Wbe(e,t,n){const i=t[t.length-1],s=t.slice(0,t.length-1).reverse().map(o=>function Lbe(e){const t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(o)).filter(o=>null!==o).map(o=>$9(()=>We(o.guards.map(l=>{const u=Mw(l,o.node,n);let c;if(function bbe(e){return e&&Bc(e.canActivateChild)}(u))c=Dl(u.canActivateChild(i,e));else{if(!Bc(u))throw new Error("Invalid CanActivateChild guard");c=Dl(u(i,e))}return c.pipe(pg())})).pipe(x_())));return We(s).pipe(x_())}(e,r.path,n),function Gbe(e,t,n){const i=t.routeConfig?t.routeConfig.canActivate:null;if(!i||0===i.length)return We(!0);const r=i.map(s=>$9(()=>{const o=Mw(s,t,n);let a;if(function vbe(e){return e&&Bc(e.canActivate)}(o))a=Dl(o.canActivate(t,e));else{if(!Bc(o))throw new Error("Invalid CanActivate guard");a=Dl(o(t,e))}return a.pipe(pg())}));return We(r).pipe(x_())}(e,r.route,n))),pg(r=>!0!==r,!0))}(i,s,e,t):We(a)),at(a=>Object.assign(Object.assign({},n),{guardsResult:a})))})}(this.ngModule.injector,a=>this.triggerEvent(a)),hr(a=>{if(Ff(a.guardsResult)){const u=J2(`Redirecting to "${this.serializeUrl(a.guardsResult)}"`);throw u.url=a.guardsResult,u}const l=new T1e(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.triggerEvent(l)}),Ri(a=>!!a.guardsResult||(this.restoreHistory(a),this.cancelNavigationTransition(a,""),!1)),cO(a=>{if(a.guards.canActivateChecks.length)return We(a).pipe(hr(l=>{const u=new O1e(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(u)}),Ru(l=>{let u=!1;return We(l).pipe(function nwe(e,t){return Zn(n=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=n;if(!r.length)return We(n);let s=0;return Oi(r).pipe(hg(o=>function iwe(e,t,n,i){return function rwe(e,t,n,i){const r=FH(e);if(0===r.length)return We({});const s={};return Oi(r).pipe(Zn(o=>function swe(e,t,n,i){const r=Mw(e,t,i);return Dl(r.resolve?r.resolve(t,n):r(t,n))}(e[o],t,n,i).pipe(hr(a=>{s[o]=a}))),Y2(1),Zn(()=>FH(s).length===r.length?We(s):ra))}(e._resolve,e,t,i).pipe(at(s=>(e._resolvedData=s,e.data=Object.assign(Object.assign({},e.data),fH(e,n).resolve),null)))}(o.route,i,e,t)),hr(()=>s++),Y2(1),Zn(o=>s===r.length?We(n):ra))})}(this.paramsInheritanceStrategy,this.ngModule.injector),hr({next:()=>u=!0,complete:()=>{u||(this.restoreHistory(l),this.cancelNavigationTransition(l,"At least one route resolver didn't emit any value."))}}))}),hr(l=>{const u=new N1e(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(u)}))}),cO(a=>{const{targetSnapshot:l,id:u,extractedUrl:c,rawUrl:d,extras:{skipLocationChange:f,replaceUrl:h}}=a;return this.hooks.afterPreactivation(l,{navigationId:u,appliedUrlTree:c,rawUrlTree:d,skipLocationChange:!!f,replaceUrl:!!h})}),at(a=>{const l=function rbe(e,t,n){const i=C_(e,t._root,n?n._root:void 0);return new cH(i,t)}(this.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return Object.assign(Object.assign({},a),{targetRouterState:l})}),hr(a=>{this.currentUrlTree=a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a),this.browserUrlTree=a.urlAfterRedirects)}),((e,t,n)=>at(i=>(new gbe(t,i.targetRouterState,i.currentRouterState,n).activate(e),i)))(this.rootContexts,this.routeReuseStrategy,a=>this.triggerEvent(a)),hr({next(){s=!0},complete(){s=!0}}),function S1e(e){return Qn((t,n)=>{try{t.subscribe(n)}finally{n.add(e)}})}(()=>{var a;s||o||this.cancelNavigationTransition(r,`Navigation ID ${r.id} is not equal to the current navigation id ${this.navigationId}`),(null===(a=this.currentNavigation)||void 0===a?void 0:a.id)===r.id&&(this.currentNavigation=null)}),jc(a=>{if(o=!0,function L1e(e){return e&&e[K9]}(a)){const l=Ff(a.url);l||(this.navigated=!0,this.restoreHistory(r,!0));const u=new q9(r.id,this.serializeUrl(r.extractedUrl),a.message);i.next(u),l?setTimeout(()=>{const c=this.urlHandlingStrategy.merge(a.url,this.rawUrlTree),d={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||jH(r.source)};this.scheduleNavigation(c,"imperative",null,d,{resolve:r.resolve,reject:r.reject,promise:r.promise})},0):r.resolve(!1)}else{this.restoreHistory(r,!0);const l=new x1e(r.id,this.serializeUrl(r.extractedUrl),a);i.next(l);try{r.resolve(this.errorHandler(a))}catch(u){r.reject(u)}}return ra}))}))}resetRootComponentType(n){this.rootComponentType=n,this.routerState.root.component=this.rootComponentType}setTransition(n){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),n))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const i="popstate"===n.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{var r;const s={replaceUrl:!0},o=(null===(r=n.state)||void 0===r?void 0:r.navigationId)?n.state:null;if(o){const l=Object.assign({},o);delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(n.url);this.scheduleNavigation(a,i,o,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(n){this.events.next(n)}resetConfig(n){wH(n),this.config=n.map(lO),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(n,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,u=r||this.routerState.root,c=l?this.currentUrlTree.fragment:o;let d=null;switch(a){case"merge":d=Object.assign(Object.assign({},this.currentUrlTree.queryParams),s);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}return null!==d&&(d=this.removeEmptyProps(d)),function abe(e,t,n,i,r){if(0===n.length)return iO(t.root,t.root,t.root,i,r);const s=function lbe(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new mH(!0,0,e);let t=0,n=!1;const i=e.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Ki(s.outlets,(l,u)=>{a[u]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?n=!0:".."===a?t++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new mH(n,t,i)}(n);if(s.toRoot())return iO(t.root,t.root,new yt([],{}),i,r);const o=function ube(e,t,n){if(e.isAbsolute)return new rO(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){const s=n.snapshot._urlSegment;return new rO(s,s===t.root,0)}const i=ww(e.commands[0])?0:1;return function cbe(e,t,n){let i=e,r=t,s=n;for(;s>r;){if(s-=r,i=i.parent,!i)throw new Error("Invalid number of '../'");r=i.segments.length}return new rO(i,!1,r-s)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,e.numberOfDoubleDots)}(s,t,e),a=o.processChildren?Dw(o.segmentGroup,o.index,s.commands):_H(o.segmentGroup,o.index,s.commands);return iO(t.root,o.segmentGroup,a,i,r)}(u,this.currentUrlTree,n,d,null!=c?c:null)}navigateByUrl(n,i={skipLocationChange:!1}){const r=Ff(n)?n:this.parseUrl(n),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,i)}navigate(n,i={skipLocationChange:!1}){return function gwe(e){for(let t=0;t<e.length;t++){const n=e[t];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${t}`)}}(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let i;try{i=this.urlSerializer.parse(n)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,n)}return i}isActive(n,i){let r;if(r=!0===i?Object.assign({},hwe):!1===i?Object.assign({},pwe):i,Ff(n))return eH(this.currentUrlTree,n,r);const s=this.parseUrl(n);return eH(this.currentUrlTree,s,r)}removeEmptyProps(n){return Object.keys(n).reduce((i,r)=>{const s=n[r];return null!=s&&(i[r]=s),i},{})}processNavigations(){this.navigations.subscribe(n=>{this.navigated=!0,this.lastSuccessfulId=n.id,this.currentPageId=n.targetPageId,this.events.next(new b_(n.id,this.serializeUrl(n.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,n.resolve(!0)},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)})}scheduleNavigation(n,i,r,s,o){var a,l;if(this.disposed)return Promise.resolve(!1);let u,c,d;o?(u=o.resolve,c=o.reject,d=o.promise):d=new Promise((p,g)=>{u=p,c=g});const f=++this.navigationId;let h;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),h=r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?null!==(a=this.browserPageId)&&void 0!==a?a:0:(null!==(l=this.browserPageId)&&void 0!==l?l:0)+1):h=0,this.setTransition({id:f,targetPageId:h,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:n,extras:s,resolve:u,reject:c,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(p=>Promise.reject(p))}setBrowserUrl(n,i){const r=this.urlSerializer.serialize(n),s=Object.assign(Object.assign({},i.extras.state),this.generateNgRouterState(i.id,i.targetPageId));this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(n,i=!1){var r,s;if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-n.targetPageId;"popstate"!==n.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(r=this.currentNavigation)||void 0===r?void 0:r.finalUrl)||0===o?this.currentUrlTree===(null===(s=this.currentNavigation)||void 0===s?void 0:s.finalUrl)&&0===o&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(o)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(n,i){const r=new q9(n.id,this.serializeUrl(n.extractedUrl),i);this.triggerEvent(r),n.resolve(!1)}generateNgRouterState(n,i){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}}return e.\u0275fac=function(n){TT()},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();function jH(e){return"imperative"!==e}let Tw=(()=>{class e{constructor(n,i,r){this.router=n,this.route=i,this.locationStrategy=r,this.commands=null,this.href=null,this.onChanges=new Pn,this.subscription=n.events.subscribe(s=>{s instanceof b_&&this.updateTargetUrlAndHref()})}set routerLink(n){this.commands=null!=n?Array.isArray(n)?n:[n]:null}ngOnChanges(n){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(n,i,r,s,o){if(0!==n||i||r||s||o||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const a={skipLocationChange:_g(this.skipLocationChange),replaceUrl:_g(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,a),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:_g(this.preserveFragment)})}}return e.\u0275fac=function(n){return new(n||e)(H(qs),H(Rf),H(dg))},e.\u0275dir=ye({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(n,i){1&n&&ke("click",function(s){return i.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&n&&cn("target",i.target)("href",i.href,V0)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[Ht]}),e})();function _g(e){return""===e||!!e}class BH{}class $H{preload(t,n){return We(null)}}let VH=(()=>{class e{constructor(n,i,r,s){this.router=n,this.injector=r,this.preloadingStrategy=s,this.loader=new PH(r,i,l=>n.triggerEvent(new G9(l)),l=>n.triggerEvent(new W9(l)))}setUpPreloading(){this.subscription=this.router.events.pipe(Ri(n=>n instanceof b_),hg(()=>this.preload())).subscribe(()=>{})}preload(){const n=this.injector.get(Nu);return this.processRoutes(n,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,i){const r=[];for(const s of i)if(s.loadChildren&&!s.canLoad&&s._loadedConfig){const o=s._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else s.loadChildren&&!s.canLoad?r.push(this.preloadConfig(n,s)):s.children&&r.push(this.processRoutes(n,s.children));return Oi(r).pipe(b0(),at(s=>{}))}preloadConfig(n,i){return this.preloadingStrategy.preload(i,()=>(i._loadedConfig?We(i._loadedConfig):this.loader.load(n.injector,i)).pipe(Zn(s=>(i._loadedConfig=s,this.processRoutes(s.module,s.routes)))))}}return e.\u0275fac=function(n){return new(n||e)(me(qs),me(F7),me(li),me(BH))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})(),hO=(()=>{class e{constructor(n,i,r={}){this.router=n,this.viewportScroller=i,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(n=>{n instanceof K2?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof b_&&(this.lastId=n.id,this.scheduleScrollEvent(n,this.router.parseUrl(n.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(n=>{n instanceof Y9&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,i){this.router.triggerEvent(new Y9(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return e.\u0275fac=function(n){TT()},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();const Pf=new rt("ROUTER_CONFIGURATION"),HH=new rt("ROUTER_FORROOT_GUARD"),vwe=[x2,{provide:rH,useClass:sH},{provide:qs,useFactory:function Ewe(e,t,n,i,r,s,o={},a,l){const u=new qs(null,e,t,n,i,r,X9(s));return a&&(u.urlHandlingStrategy=a),l&&(u.routeReuseStrategy=l),function Swe(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy),e.canceledNavigationResolution&&(t.canceledNavigationResolution=e.canceledNavigationResolution)}(o,u),o.enableTracing&&u.events.subscribe(c=>{var d,f;null===(d=console.group)||void 0===d||d.call(console,`Router Event: ${c.constructor.name}`),console.log(c.toString()),console.log(c),null===(f=console.groupEnd)||void 0===f||f.call(console)}),u},deps:[rH,A_,x2,li,F7,dO,Pf,[class uwe{},new Tc],[class owe{},new Tc]]},A_,{provide:Rf,useFactory:function xwe(e){return e.routerState.root},deps:[qs]},VH,$H,class ywe{preload(t,n){return n().pipe(jc(()=>We(null)))}},{provide:Pf,useValue:{enableTracing:!1}}];function bwe(){return new $7("Router",qs)}let UH=(()=>{class e{constructor(n,i){}static forRoot(n,i){return{ngModule:e,providers:[vwe,zH(n),{provide:HH,useFactory:Cwe,deps:[[qs,new Tc,new L0]]},{provide:Pf,useValue:i||{}},{provide:dg,useFactory:Dwe,deps:[Of,[new _b(S2),new Tc],Pf]},{provide:hO,useFactory:wwe,deps:[qs,Tve,Pf]},{provide:BH,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:$H},{provide:$7,multi:!0,useFactory:bwe},[pO,{provide:d2,multi:!0,useFactory:Awe,deps:[pO]},{provide:qH,useFactory:Mwe,deps:[pO]},{provide:I7,multi:!0,useExisting:qH}]]}}static forChild(n){return{ngModule:e,providers:[zH(n)]}}}return e.\u0275fac=function(n){return new(n||e)(me(HH,8),me(qs,8))},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({}),e})();function wwe(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new hO(e,t,n)}function Dwe(e,t,n={}){return n.useHash?new fye(e,t):new o9(e,t)}function Cwe(e){return"guarded"}function zH(e){return[{provide:ofe,multi:!0,useValue:e},{provide:dO,multi:!0,useValue:e}]}let pO=(()=>{class e{constructor(n){this.injector=n,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Pn}appInitializer(){return this.injector.get(uye,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let i=null;const r=new Promise(a=>i=a),s=this.injector.get(qs),o=this.injector.get(Pf);return"disabled"===o.initialNavigation?(s.setUpLocationChangeListener(),i(!0)):"enabled"===o.initialNavigation||"enabledBlocking"===o.initialNavigation?(s.hooks.afterPreactivation=()=>this.initNavigation?We(null):(this.initNavigation=!0,i(!0),this.resultOfPreactivationDone),s.initialNavigation()):i(!0),r})}bootstrapListener(n){const i=this.injector.get(Pf),r=this.injector.get(VH),s=this.injector.get(hO),o=this.injector.get(qs),a=this.injector.get(h_);n===a.components[0]&&(("enabledNonBlocking"===i.initialNavigation||void 0===i.initialNavigation)&&o.initialNavigation(),r.setUpPreloading(),s.init(),o.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return e.\u0275fac=function(n){return new(n||e)(me(li))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();function Awe(e){return e.appInitializer.bind(e)}function Mwe(e){return e.bootstrapListener.bind(e)}const qH=new rt("Router Initializer");let gO=(()=>{class e{constructor(){this.sector=new Pn,this.sector.next("all-sectors")}getSector(){return this.sector}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})(),Owe=(()=>{class e{constructor(){}ngOnInit(){}ngOnChanges(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Nt({type:e,selectors:[["introductory-section"]],inputs:{sector:"sector"},features:[Ht],decls:10,vars:0,consts:[[1,"section","mt-5"],[1,"title"],[1,"subtitle","mt-4"],[1,"mt-4","mb-5"],[1,"button","orange-button"],[1,"button","transparent-button","mt-md-0","mt-3"]],template:function(n,i){1&n&&(S(0,"div",0)(1,"h1",1),R(2,"Beyond Compliance"),M(),S(3,"div",2),R(4," A review of statements produced by companies under the UK and Australian Modern Slavery Acts (MSAs). "),M(),S(5,"div",3)(6,"a",4),R(7,"Contribute Research"),M(),S(8,"a",5),R(9,"Download Dataset"),M()()())},styles:[""]}),e})();class J{constructor(t,n){this.name=t,this.value=n}}class mO{constructor(t,n){this.from=t,this.to=n}}class GH{}class WH{}class Lu{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(n=>{const i=n.indexOf(":");if(i>0){const r=n.slice(0,i),s=r.toLowerCase(),o=n.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(n=>{let i=t[n];const r=n.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(r,i),this.maybeSetNormalizedName(n,r))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const n=this.headers.get(t.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,n){return this.clone({name:t,value:n,op:"a"})}set(t,n){return this.clone({name:t,value:n,op:"s"})}delete(t,n){return this.clone({name:t,value:n,op:"d"})}maybeSetNormalizedName(t,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,t)}init(){this.lazyInit&&(this.lazyInit instanceof Lu?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(n=>{this.headers.set(n,t.headers.get(n)),this.normalizedNames.set(n,t.normalizedNames.get(n))})}clone(t){const n=new Lu;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof Lu?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}applyUpdate(t){const n=t.name.toLowerCase();switch(t.op){case"a":case"s":let i=t.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(t.name,n);const r=("a"===t.op?this.headers.get(n):void 0)||[];r.push(...i),this.headers.set(n,r);break;case"d":const s=t.value;if(s){let o=this.headers.get(n);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,o)}else this.headers.delete(n),this.normalizedNames.delete(n)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>t(this.normalizedNames.get(n),this.headers.get(n)))}}class Nwe{encodeKey(t){return YH(t)}encodeValue(t){return YH(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const Iwe=/%(\d[a-f0-9])/gi,Rwe={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function YH(e){return encodeURIComponent(e).replace(Iwe,(t,n)=>{var i;return null!==(i=Rwe[n])&&void 0!==i?i:t})}function KH(e){return`${e}`}class ju{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new Nwe,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function kwe(e,t){const n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[t.decodeKey(r),""]:[t.decodeKey(r.slice(0,s)),t.decodeValue(r.slice(s+1))],l=n.get(o)||[];l.push(a),n.set(o,l)}),n}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(n=>{const i=t.fromObject[n];this.map.set(n,Array.isArray(i)?i:[i])})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const n=this.map.get(t);return n?n[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,n){return this.clone({param:t,value:n,op:"a"})}appendAll(t){const n=[];return Object.keys(t).forEach(i=>{const r=t[i];Array.isArray(r)?r.forEach(s=>{n.push({param:i,value:s,op:"a"})}):n.push({param:i,value:r,op:"a"})}),this.clone(n)}set(t,n){return this.clone({param:t,value:n,op:"s"})}delete(t,n){return this.clone({param:t,value:n,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const n=this.encoder.encodeKey(t);return this.map.get(t).map(i=>n+"="+this.encoder.encodeValue(i)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const n=new ju({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(t),n}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const n=("a"===t.op?this.map.get(t.param):void 0)||[];n.push(KH(t.value)),this.map.set(t.param,n);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let i=this.map.get(t.param)||[];const r=i.indexOf(KH(t.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(t.param,i):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class Fwe{constructor(){this.map=new Map}set(t,n){return this.map.set(t,n),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function JH(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function XH(e){return"undefined"!=typeof Blob&&e instanceof Blob}function QH(e){return"undefined"!=typeof FormData&&e instanceof FormData}class N_{constructor(t,n,i,r){let s;if(this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function Pwe(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new Lu),this.context||(this.context=new Fwe),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=n;else{const a=n.indexOf("?");this.urlWithParams=n+(-1===a?"?":a<n.length-1?"&":"")+o}}else this.params=new ju,this.urlWithParams=n}serializeBody(){return null===this.body?null:JH(this.body)||XH(this.body)||QH(this.body)||function Lwe(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof ju?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||QH(this.body)?null:XH(this.body)?this.body.type||null:JH(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof ju?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){var n;const i=t.method||this.method,r=t.url||this.url,s=t.responseType||this.responseType,o=void 0!==t.body?t.body:this.body,a=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,l=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let u=t.headers||this.headers,c=t.params||this.params;const d=null!==(n=t.context)&&void 0!==n?n:this.context;return void 0!==t.setHeaders&&(u=Object.keys(t.setHeaders).reduce((f,h)=>f.set(h,t.setHeaders[h]),u)),t.setParams&&(c=Object.keys(t.setParams).reduce((f,h)=>f.set(h,t.setParams[h]),c)),new N_(i,r,o,{params:c,headers:u,context:d,reportProgress:l,responseType:s,withCredentials:a})}}var di=(()=>((di=di||{})[di.Sent=0]="Sent",di[di.UploadProgress=1]="UploadProgress",di[di.ResponseHeader=2]="ResponseHeader",di[di.DownloadProgress=3]="DownloadProgress",di[di.Response=4]="Response",di[di.User=5]="User",di))();class _O{constructor(t,n=200,i="OK"){this.headers=t.headers||new Lu,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||i,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class yO extends _O{constructor(t={}){super(t),this.type=di.ResponseHeader}clone(t={}){return new yO({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Ow extends _O{constructor(t={}){super(t),this.type=di.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new Ow({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class ZH extends _O{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function vO(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let eU=(()=>{class e{constructor(n){this.handler=n}request(n,i,r={}){let s;if(n instanceof N_)s=n;else{let l,u;l=r.headers instanceof Lu?r.headers:new Lu(r.headers),r.params&&(u=r.params instanceof ju?r.params:new ju({fromObject:r.params})),s=new N_(n,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:u,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=We(s).pipe(hg(l=>this.handler.handle(l)));if(n instanceof N_||"events"===r.observe)return o;const a=o.pipe(Ri(l=>l instanceof Ow));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(at(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(at(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(at(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(at(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(n,i={}){return this.request("DELETE",n,i)}get(n,i={}){return this.request("GET",n,i)}head(n,i={}){return this.request("HEAD",n,i)}jsonp(n,i){return this.request("JSONP",n,{params:(new ju).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,i={}){return this.request("OPTIONS",n,i)}patch(n,i,r={}){return this.request("PATCH",n,vO(r,i))}post(n,i,r={}){return this.request("POST",n,vO(r,i))}put(n,i,r={}){return this.request("PUT",n,vO(r,i))}}return e.\u0275fac=function(n){return new(n||e)(me(GH))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();class tU{constructor(t,n){this.next=t,this.interceptor=n}handle(t){return this.interceptor.intercept(t,this.next)}}const nU=new rt("HTTP_INTERCEPTORS");let jwe=(()=>{class e{intercept(n,i){return i.handle(n)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();const Bwe=/^\)\]\}',?\n/;let iU=(()=>{class e{constructor(n){this.xhrFactory=n}handle(n){if("JSONP"===n.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new en(i=>{const r=this.xhrFactory.build();if(r.open(n.method,n.urlWithParams),n.withCredentials&&(r.withCredentials=!0),n.headers.forEach((h,p)=>r.setRequestHeader(h,p.join(","))),n.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){const h=n.detectContentTypeHeader();null!==h&&r.setRequestHeader("Content-Type",h)}if(n.responseType){const h=n.responseType.toLowerCase();r.responseType="json"!==h?h:"text"}const s=n.serializeBody();let o=null;const a=()=>{if(null!==o)return o;const h=r.statusText||"OK",p=new Lu(r.getAllResponseHeaders()),g=function $we(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(r)||n.url;return o=new yO({headers:p,status:r.status,statusText:h,url:g}),o},l=()=>{let{headers:h,status:p,statusText:g,url:m}=a(),_=null;204!==p&&(_=void 0===r.response?r.responseText:r.response),0===p&&(p=_?200:0);let y=p>=200&&p<300;if("json"===n.responseType&&"string"==typeof _){const v=_;_=_.replace(Bwe,"");try{_=""!==_?JSON.parse(_):null}catch(b){_=v,y&&(y=!1,_={error:b,text:_})}}y?(i.next(new Ow({body:_,headers:h,status:p,statusText:g,url:m||void 0})),i.complete()):i.error(new ZH({error:_,headers:h,status:p,statusText:g,url:m||void 0}))},u=h=>{const{url:p}=a(),g=new ZH({error:h,status:r.status||0,statusText:r.statusText||"Unknown Error",url:p||void 0});i.error(g)};let c=!1;const d=h=>{c||(i.next(a()),c=!0);let p={type:di.DownloadProgress,loaded:h.loaded};h.lengthComputable&&(p.total=h.total),"text"===n.responseType&&!!r.responseText&&(p.partialText=r.responseText),i.next(p)},f=h=>{let p={type:di.UploadProgress,loaded:h.loaded};h.lengthComputable&&(p.total=h.total),i.next(p)};return r.addEventListener("load",l),r.addEventListener("error",u),r.addEventListener("timeout",u),r.addEventListener("abort",u),n.reportProgress&&(r.addEventListener("progress",d),null!==s&&r.upload&&r.upload.addEventListener("progress",f)),r.send(s),i.next({type:di.Sent}),()=>{r.removeEventListener("error",u),r.removeEventListener("abort",u),r.removeEventListener("load",l),r.removeEventListener("timeout",u),n.reportProgress&&(r.removeEventListener("progress",d),null!==s&&r.upload&&r.upload.removeEventListener("progress",f)),r.readyState!==r.DONE&&r.abort()}})}}return e.\u0275fac=function(n){return new(n||e)(me(C9))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();const bO=new rt("XSRF_COOKIE_NAME"),wO=new rt("XSRF_HEADER_NAME");class rU{}let Vwe=(()=>{class e{constructor(n,i,r){this.doc=n,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=m9(n,this.cookieName),this.lastCookieString=n),this.lastToken}}return e.\u0275fac=function(n){return new(n||e)(me(ni),me(f_),me(bO))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})(),DO=(()=>{class e{constructor(n,i){this.tokenService=n,this.headerName=i}intercept(n,i){const r=n.url.toLowerCase();if("GET"===n.method||"HEAD"===n.method||r.startsWith("http://")||r.startsWith("https://"))return i.handle(n);const s=this.tokenService.getToken();return null!==s&&!n.headers.has(this.headerName)&&(n=n.clone({headers:n.headers.set(this.headerName,s)})),i.handle(n)}}return e.\u0275fac=function(n){return new(n||e)(me(rU),me(wO))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})(),Hwe=(()=>{class e{constructor(n,i){this.backend=n,this.injector=i,this.chain=null}handle(n){if(null===this.chain){const i=this.injector.get(nU,[]);this.chain=i.reduceRight((r,s)=>new tU(r,s),this.backend)}return this.chain.handle(n)}}return e.\u0275fac=function(n){return new(n||e)(me(WH),me(li))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})(),Uwe=(()=>{class e{static disable(){return{ngModule:e,providers:[{provide:DO,useClass:jwe}]}}static withOptions(n={}){return{ngModule:e,providers:[n.cookieName?{provide:bO,useValue:n.cookieName}:[],n.headerName?{provide:wO,useValue:n.headerName}:[]]}}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({providers:[DO,{provide:nU,useExisting:DO,multi:!0},{provide:rU,useClass:Vwe},{provide:bO,useValue:"XSRF-TOKEN"},{provide:wO,useValue:"X-XSRF-TOKEN"}]}),e})(),zwe=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({providers:[eU,{provide:GH,useClass:Hwe},iU,{provide:WH,useExisting:iU}],imports:[[Uwe.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e})(),Fi=(()=>{class e{constructor(n){this.httpClient=n,this.wikirateApiHost="https://wikirate.org",this.metrics={msa_registry_submission:12536930,modern_slavery_statement:1827651,msa_statement_assessed:12621772,aus_msa_statement_assessed:12602630,uk_msa_statement_assessed:12602618,meet_uk_min_requirements:6901749,meet_aus_min_requirements:12601871,aus_beyond_compliance_disclosure_rate:12620676,uk_beyond_compliance_disclosure_rate:6899063,msa_beyond_compliance:12620974,msa_disclosure_rate:12602527,turnover_range:8218724}}getAnswers(n,i){let r=`${this.wikirateApiHost}/~${n}+Answer.json`,s=new ju;for(let o of i)if(Array.isArray(o.value))for(let a of o.value)s=s.append("filter["+o.name+"][]",a);else o.value instanceof mO?(s=s.append("filter["+o.name+"][from]",o.value.from),s=s.append("filter["+o.name+"][to]",o.value.to)):s=s.append("filter["+o.name+"]",o.value);return s=s.append("limit",0),s=s.append("view","answer_list"),this.httpClient.get(r,{params:s})}getCompanyGroup(n){return"garment-sector"===n?"MSA Garments":"hospitality-sector"===n?"MSA Hospitality":"financial-sector"===n?"MSA Financial":""}}return e.\u0275fac=function(n){return new(n||e)(me(eU))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();const qwe=["addListener","removeListener"],Gwe=["addEventListener","removeEventListener"],Wwe=["on","off"];function Br(e,t,n,i){if(Qe(n)&&(i=n,n=void 0),i)return Br(e,t,n).pipe(G2(i));const[r,s]=function Jwe(e){return Qe(e.addEventListener)&&Qe(e.removeEventListener)}(e)?Gwe.map(o=>a=>e[o](t,a,n)):function Ywe(e){return Qe(e.addListener)&&Qe(e.removeListener)}(e)?qwe.map(sU(e,t)):function Kwe(e){return Qe(e.on)&&Qe(e.off)}(e)?Wwe.map(sU(e,t)):[];if(!r&&$A(e))return Zn(o=>Br(o,t,n))(sr(e));if(!r)throw new TypeError("Invalid event target");return new en(o=>{const a=(...l)=>o.next(1<l.length?l:l[0]);return r(a),()=>s(a)})}function sU(e,t){return n=>i=>e[n](t,i)}class Xwe extends Xn{constructor(t,n){super()}schedule(t,n=0){return this}}const Nw={setInterval(e,t,...n){const{delegate:i}=Nw;return(null==i?void 0:i.setInterval)?i.setInterval(e,t,...n):setInterval(e,t,...n)},clearInterval(e){const{delegate:t}=Nw;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},oU={now:()=>(oU.delegate||Date).now(),delegate:void 0};class k_{constructor(t,n=k_.now){this.schedulerActionCtor=t,this.now=n}schedule(t,n=0,i){return new this.schedulerActionCtor(this,t).schedule(i,n)}}k_.now=oU.now;const aU=new class Zwe extends k_{constructor(t,n=k_.now){super(t,n),this.actions=[],this._active=!1,this._scheduled=void 0}flush(t){const{actions:n}=this;if(this._active)return void n.push(t);let i;this._active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=n.shift());if(this._active=!1,i){for(;t=n.shift();)t.unsubscribe();throw i}}}(class Qwe extends Xwe{constructor(t,n){super(t,n),this.scheduler=t,this.work=n,this.pending=!1}schedule(t,n=0){if(this.closed)return this;this.state=t;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,n)),this.pending=!0,this.delay=n,this.id=this.id||this.requestAsyncId(r,this.id,n),this}requestAsyncId(t,n,i=0){return Nw.setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,n,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return n;Nw.clearInterval(n)}execute(t,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,n);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,n){let r,i=!1;try{this.work(t)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:t,scheduler:n}=this,{actions:i}=n;this.work=this.state=this.scheduler=null,this.pending=!1,It(i,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,super.unsubscribe()}}}),eDe=aU;function CO(e=0,t,n=eDe){let i=-1;return null!=t&&(C4(t)?n=t:i=t),new en(r=>{let s=function tDe(e){return e instanceof Date&&!isNaN(e)}(e)?+e-n.now():e;s<0&&(s=0);let o=0;return n.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}const{isArray:nDe}=Array;function lU(e){return 1===e.length&&nDe(e[0])?e[0]:e}function uU(...e){return 1===(e=lU(e)).length?sr(e[0]):new en(function iDe(e){return t=>{let n=[];for(let i=0;n&&!t.closed&&i<e.length;i++)n.push(sr(e[i]).subscribe(bn(t,r=>{if(n){for(let s=0;s<n.length;s++)s!==i&&n[s].unsubscribe();n=null}t.next(r)})))}}(e))}function kw(...e){const t=q1(e),n=lU(e);return n.length?new en(i=>{let r=n.map(()=>[]),s=n.map(()=>!1);i.add(()=>{r=s=null});for(let o=0;!i.closed&&o<n.length;o++)sr(n[o]).subscribe(bn(i,a=>{if(r[o].push(a),r.every(l=>l.length)){const l=r.map(u=>u.shift());i.next(t?t(...l):l),r.some((u,c)=>!u.length&&s[c])&&i.complete()}},()=>{s[o]=!0,!r[o].length&&i.complete()}));return()=>{r=s=null}}):ra}function wi(e){return Qn((t,n)=>{sr(e).subscribe(bn(n,()=>n.complete(),vu)),!n.closed&&t.subscribe(n)})}function SO(...e){const t=q1(e);return Qn((n,i)=>{const r=e.length,s=new Array(r);let o=e.map(()=>!1),a=!1;for(let l=0;l<r;l++)sr(e[l]).subscribe(bn(i,u=>{s[l]=u,!a&&!o[l]&&(o[l]=!0,(a=o.every(Du))&&(o=null))},vu));n.subscribe(bn(i,l=>{if(a){const u=[l,...s];i.next(t?t(...u):u)}}))})}function dU(e,t){return t?n=>v_(t.pipe(mi(1),function oDe(){return Qn((e,t)=>{e.subscribe(bn(t,vu))})}()),n.pipe(dU(e))):Zn((n,i)=>e(n,i).pipe(mi(1),function aDe(e){return at(()=>e)}(n)))}function fU(e,t=aU){const n=CO(e,t);return dU(()=>n)}new en(vu);let hU=(()=>{class e{constructor(n,i){this._renderer=n,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(n,i){this._renderer.setProperty(this._elementRef.nativeElement,n,i)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}}return e.\u0275fac=function(n){return new(n||e)(H(Us),H(fn))},e.\u0275dir=ye({type:e}),e})(),Lf=(()=>{class e extends hU{}return e.\u0275fac=function(){let t;return function(i){return(t||(t=cr(e)))(i||e)}}(),e.\u0275dir=ye({type:e,features:[zt]}),e})();const ko=new rt("NgValueAccessor"),dDe={provide:ko,useExisting:Ot(()=>xO),multi:!0},hDe=new rt("CompositionEventMode");let xO=(()=>{class e extends hU{constructor(n,i,r){super(n,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function fDe(){const e=bl()?bl().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(n){this.setProperty("value",null==n?"":n)}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}}return e.\u0275fac=function(n){return new(n||e)(H(Us),H(fn),H(hDe,8))},e.\u0275dir=ye({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,i){1&n&&ke("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[dn([dDe]),zt]}),e})();const pr=new rt("NgValidators"),Vc=new rt("NgAsyncValidators");function EU(e){return null!=e}function SU(e){const t=Q0(e)?Oi(e):e;return IT(t),t}function xU(e){let t={};return e.forEach(n=>{t=null!=n?Object.assign(Object.assign({},t),n):t}),0===Object.keys(t).length?null:t}function AU(e,t){return t.map(n=>n(e))}function MU(e){return e.map(t=>function gDe(e){return!e.validate}(t)?t:n=>t.validate(n))}function AO(e){return null!=e?function TU(e){if(!e)return null;const t=e.filter(EU);return 0==t.length?null:function(n){return xU(AU(n,t))}}(MU(e)):null}function MO(e){return null!=e?function OU(e){if(!e)return null;const t=e.filter(EU);return 0==t.length?null:function(n){return function uDe(...e){const t=q1(e),{args:n,keys:i}=L9(e),r=new en(s=>{const{length:o}=n;if(!o)return void s.complete();const a=new Array(o);let l=o,u=o;for(let c=0;c<o;c++){let d=!1;sr(n[c]).subscribe(bn(s,f=>{d||(d=!0,u--),a[c]=f},()=>l--,void 0,()=>{(!l||!d)&&(u||s.next(i?j9(i,a):a),s.complete())}))}});return t?r.pipe(G2(t)):r}(AU(n,t).map(SU)).pipe(at(xU))}}(MU(e)):null}function NU(e,t){return null===e?[t]:Array.isArray(e)?[...e,t]:[e,t]}function TO(e){return e?Array.isArray(e)?e:[e]:[]}function Rw(e,t){return Array.isArray(e)?e.includes(t):e===t}function RU(e,t){const n=TO(t);return TO(e).forEach(r=>{Rw(n,r)||n.push(r)}),n}function FU(e,t){return TO(t).filter(n=>!Rw(e,n))}class PU{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=AO(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=MO(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,n){return!!this.control&&this.control.hasError(t,n)}getError(t,n){return this.control?this.control.getError(t,n):null}}class Hc extends PU{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class $r extends PU{get formDirective(){return null}get path(){return null}}let ba=(()=>{class e extends class LU{constructor(t){this._cd=t}is(t){var n,i,r;return"submitted"===t?!!(null===(n=this._cd)||void 0===n?void 0:n.submitted):!!(null===(r=null===(i=this._cd)||void 0===i?void 0:i.control)||void 0===r?void 0:r[t])}}{constructor(n){super(n)}}return e.\u0275fac=function(n){return new(n||e)(H(Hc,2))},e.\u0275dir=ye({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,i){2&n&&An("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))},features:[zt]}),e})();function I_(e,t){(function kO(e,t){const n=function kU(e){return e._rawValidators}(e);null!==t.validator?e.setValidators(NU(n,t.validator)):"function"==typeof n&&e.setValidators([n]);const i=function IU(e){return e._rawAsyncValidators}(e);null!==t.asyncValidator?e.setAsyncValidators(NU(i,t.asyncValidator)):"function"==typeof i&&e.setAsyncValidators([i]);const r=()=>e.updateValueAndValidity();jw(t._rawValidators,r),jw(t._rawAsyncValidators,r)})(e,t),t.valueAccessor.writeValue(e.value),function EDe(e,t){t.valueAccessor.registerOnChange(n=>{e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&BU(e,t)})}(e,t),function xDe(e,t){const n=(i,r)=>{t.valueAccessor.writeValue(i),r&&t.viewToModelUpdate(i)};e.registerOnChange(n),t._registerOnDestroy(()=>{e._unregisterOnChange(n)})}(e,t),function SDe(e,t){t.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&BU(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function CDe(e,t){if(t.valueAccessor.setDisabledState){const n=i=>{t.valueAccessor.setDisabledState(i)};e.registerOnDisabledChange(n),t._registerOnDestroy(()=>{e._unregisterOnDisabledChange(n)})}}(e,t)}function jw(e,t){e.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(t)})}function BU(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function FO(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const R_="VALID",$w="INVALID",yg="PENDING",F_="DISABLED";function LO(e){return(Vw(e)?e.validators:e)||null}function UU(e){return Array.isArray(e)?AO(e):e||null}function jO(e,t){return(Vw(t)?t.asyncValidators:e)||null}function zU(e){return Array.isArray(e)?MO(e):e||null}function Vw(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}const BO=e=>e instanceof VO;function GU(e){return(e=>e instanceof KU)(e)?e.value:e.getRawValue()}function WU(e,t){const n=BO(e),i=e.controls;if(!(n?Object.keys(i):i).length)throw new xe(1e3,"");if(!i[t])throw new xe(1001,"")}function YU(e,t){BO(e),e._forEachChild((i,r)=>{if(void 0===t[r])throw new xe(1002,"")})}class $O{constructor(t,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=n,this._composedValidatorFn=UU(this._rawValidators),this._composedAsyncValidatorFn=zU(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===R_}get invalid(){return this.status===$w}get pending(){return this.status==yg}get disabled(){return this.status===F_}get enabled(){return this.status!==F_}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=UU(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=zU(t)}addValidators(t){this.setValidators(RU(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(RU(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(FU(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(FU(t,this._rawAsyncValidators))}hasValidator(t){return Rw(this._rawValidators,t)}hasAsyncValidator(t){return Rw(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=yg,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const n=this._parentMarkedDirty(t.onlySelf);this.status=F_,this.errors=null,this._forEachChild(i=>{i.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:n})),this._onDisabledChange.forEach(i=>i(!0))}enable(t={}){const n=this._parentMarkedDirty(t.onlySelf);this.status=R_,this._forEachChild(i=>{i.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:n})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===R_||this.status===yg)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?F_:R_}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=yg,this._hasOwnPendingAsyncValidator=!0;const n=SU(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,n={}){this.errors=t,this._updateControlsErrors(!1!==n.emitEvent)}get(t){return function ODe(e,t,n){if(null==t||(Array.isArray(t)||(t=t.split(n)),Array.isArray(t)&&0===t.length))return null;let i=e;return t.forEach(r=>{i=BO(i)?i.controls.hasOwnProperty(r)?i.controls[r]:null:(e=>e instanceof kDe)(i)&&i.at(r)||null}),i}(this,t,".")}getError(t,n){const i=n?this.get(n):this;return i&&i.errors?i.errors[t]:null}hasError(t,n){return!!this.getError(t,n)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new nt,this.statusChanges=new nt}_calculateStatus(){return this._allControlsDisabled()?F_:this.errors?$w:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(yg)?yg:this._anyControlsHaveStatus($w)?$w:R_}_anyControlsHaveStatus(t){return this._anyControls(n=>n.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Vw(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class KU extends $O{constructor(t=null,n,i){super(LO(n),jO(i,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Vw(n)&&n.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(t)?t.value:t)}setValue(t,n={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==n.emitViewToModelChange)),this.updateValueAndValidity(n)}patchValue(t,n={}){this.setValue(t,n)}reset(t=this.defaultValue,n={}){this._applyFormState(t),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){FO(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){FO(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class VO extends $O{constructor(t,n,i){super(LO(n),jO(i,n)),this.controls=t,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,n){return this.controls[t]?this.controls[t]:(this.controls[t]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(t,n,i={}){this.registerControl(t,n),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(t,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(t,n,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],n&&this.registerControl(t,n),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,n={}){YU(this,t),Object.keys(t).forEach(i=>{WU(this,i),this.controls[i].setValue(t[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(t,n={}){null!=t&&(Object.keys(t).forEach(i=>{this.controls[i]&&this.controls[i].patchValue(t[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(t={},n={}){this._forEachChild((i,r)=>{i.reset(t[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(t,n,i)=>(t[i]=GU(n),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(n,i)=>!!i._syncPendingControls()||n);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(n=>{const i=this.controls[n];i&&t(i,n)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const n of Object.keys(this.controls)){const i=this.controls[n];if(this.contains(n)&&t(i))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,n,i)=>((n.enabled||this.disabled)&&(t[i]=n.value),t))}_reduceChildren(t,n){let i=t;return this._forEachChild((r,s)=>{i=n(i,r,s)}),i}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class kDe extends $O{constructor(t,n,i){super(LO(n),jO(i,n)),this.controls=t,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[t]}push(t,n={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}insert(t,n,i={}){this.controls.splice(t,0,n),this._registerControl(n),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(t,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity({emitEvent:n.emitEvent})}setControl(t,n,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),n&&(this.controls.splice(t,0,n),this._registerControl(n)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,n={}){YU(this,t),t.forEach((i,r)=>{WU(this,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(t,n={}){null!=t&&(t.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(t=[],n={}){this._forEachChild((i,r)=>{i.reset(t[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this.controls.map(t=>GU(t))}clear(t={}){this.controls.length<1||(this._forEachChild(n=>n._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_syncPendingControls(){let t=this.controls.reduce((n,i)=>!!i._syncPendingControls()||n,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((n,i)=>{t(n,i)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(n=>n.enabled&&t(n))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const FDe={provide:Hc,useExisting:Ot(()=>Io)},QU=(()=>Promise.resolve(null))();let Io=(()=>{class e extends Hc{constructor(n,i,r,s,o){super(),this._changeDetectorRef=o,this.control=new KU,this._registered=!1,this.update=new nt,this._parent=n,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function RO(e,t){if(!t)return null;let n,i,r;return Array.isArray(t),t.forEach(s=>{s.constructor===xO?n=s:function TDe(e){return Object.getPrototypeOf(e.constructor)===Lf}(s)?i=s:r=s}),r||i||n||null}(0,s)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){const i=n.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),function IO(e,t){if(!e.hasOwnProperty("model"))return!1;const n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){I_(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(n){QU.then(()=>{var i;this.control.setValue(n,{emitViewToModelChange:!1}),null===(i=this._changeDetectorRef)||void 0===i||i.markForCheck()})}_updateDisabled(n){const i=n.isDisabled.currentValue,r=""===i||i&&"false"!==i;QU.then(()=>{var s;r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),null===(s=this._changeDetectorRef)||void 0===s||s.markForCheck()})}_getPath(n){return this._parent?function Pw(e,t){return[...t.path,e]}(n,this._parent):[n]}}return e.\u0275fac=function(n){return new(n||e)(H($r,9),H(pr,10),H(Vc,10),H(ko,10),H(Mo,8))},e.\u0275dir=ye({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[dn([FDe]),zt,Ht]}),e})(),ez=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({}),e})();const GDe={provide:ko,useExisting:Ot(()=>Gs),multi:!0};function az(e,t){return null==e?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let Gs=(()=>{class e extends Lf{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){this.value=n;const r=az(this._getOptionId(n),n);this.setProperty("value",r)}registerOnChange(n){this.onChange=i=>{this.value=this._getOptionValue(i),n(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(n){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i),n))return i;return null}_getOptionValue(n){const i=function WDe(e){return e.split(":")[0]}(n);return this._optionMap.has(i)?this._optionMap.get(i):n}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=cr(e)))(i||e)}}(),e.\u0275dir=ye({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,i){1&n&&ke("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[dn([GDe]),zt]}),e})(),wa=(()=>{class e{constructor(n,i,r){this._element=n,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(n){null!=this._select&&(this._select._optionMap.set(this.id,n),this._setElementValue(az(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._setElementValue(n),this._select&&this._select.writeValue(this._select.value)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return e.\u0275fac=function(n){return new(n||e)(H(fn),H(Us),H(Gs,9))},e.\u0275dir=ye({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();const YDe={provide:ko,useExisting:Ot(()=>GO),multi:!0};function lz(e,t){return null==e?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let GO=(()=>{class e extends Lf{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){let i;if(this.value=n,Array.isArray(n)){const r=n.map(s=>this._getOptionId(s));i=(s,o)=>{s._setSelected(r.indexOf(o.toString())>-1)}}else i=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(n){this.onChange=i=>{const r=[],s=i.selectedOptions;if(void 0!==s){const o=s;for(let a=0;a<o.length;a++){const u=this._getOptionValue(o[a].value);r.push(u)}}else{const o=i.options;for(let a=0;a<o.length;a++){const l=o[a];if(l.selected){const u=this._getOptionValue(l.value);r.push(u)}}}this.value=r,n(r)}}_registerOption(n){const i=(this._idCounter++).toString();return this._optionMap.set(i,n),i}_getOptionId(n){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i)._value,n))return i;return null}_getOptionValue(n){const i=function KDe(e){return e.split(":")[0]}(n);return this._optionMap.has(i)?this._optionMap.get(i)._value:n}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=cr(e)))(i||e)}}(),e.\u0275dir=ye({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,i){1&n&&ke("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[dn([YDe]),zt]}),e})(),Da=(()=>{class e{constructor(n,i,r){this._element=n,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(n){null!=this._select&&(this._value=n,this._setElementValue(lz(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._select?(this._value=n,this._setElementValue(lz(this.id,n)),this._select.writeValue(this._select.value)):this._setElementValue(n)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}_setSelected(n){this._renderer.setProperty(this._element.nativeElement,"selected",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return e.\u0275fac=function(n){return new(n||e)(H(fn),H(Us),H(GO,9))},e.\u0275dir=ye({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})(),sCe=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({imports:[[ez]]}),e})(),yz=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({imports:[sCe]}),e})();var oCe={left:"right",right:"left",bottom:"top",top:"bottom"};function Hw(e){return e.replace(/left|right|bottom|top/g,function(t){return oCe[t]})}function Cl(e){return e.split("-")[0]}var aCe={start:"end",end:"start"};function vz(e){return e.replace(/start|end/g,function(t){return aCe[t]})}var Ws="top",Ca="bottom",Ea="right",Ys="left",YO="auto",L_=[Ws,Ca,Ea,Ys],vg="start",j_="end",bz="viewport",B_="popper",wz=L_.reduce(function(e,t){return e.concat([t+"-"+vg,t+"-"+j_])},[]),Dz=[].concat(L_,[YO]).reduce(function(e,t){return e.concat([t,t+"-"+vg,t+"-"+j_])},[]),vCe=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Sa(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function bg(e){return e instanceof Sa(e).Element||e instanceof Element}function Ro(e){return e instanceof Sa(e).HTMLElement||e instanceof HTMLElement}function KO(e){return"undefined"!=typeof ShadowRoot&&(e instanceof Sa(e).ShadowRoot||e instanceof ShadowRoot)}function Uc(e){return((bg(e)?e.ownerDocument:e.document)||window.document).documentElement}var Bf=Math.max,Uw=Math.min,wg=Math.round;function Dg(e,t){void 0===t&&(t=!1);var n=e.getBoundingClientRect(),i=1,r=1;if(Ro(e)&&t){var s=e.offsetHeight,o=e.offsetWidth;o>0&&(i=wg(n.width)/o||1),s>0&&(r=wg(n.height)/s||1)}return{width:n.width/i,height:n.height/r,top:n.top/r,right:n.right/i,bottom:n.bottom/r,left:n.left/i,x:n.left/i,y:n.top/r}}function JO(e){var t=Sa(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function XO(e){return Dg(Uc(e)).left+JO(e).scrollLeft}function Bu(e){return Sa(e).getComputedStyle(e)}function El(e){return e?(e.nodeName||"").toLowerCase():null}function zw(e){return"html"===El(e)?e:e.assignedSlot||e.parentNode||(KO(e)?e.host:null)||Uc(e)}function QO(e){var t=Bu(e);return/auto|scroll|overlay|hidden/.test(t.overflow+t.overflowY+t.overflowX)}function Cz(e){return["html","body","#document"].indexOf(El(e))>=0?e.ownerDocument.body:Ro(e)&&QO(e)?e:Cz(zw(e))}function $_(e,t){var n;void 0===t&&(t=[]);var i=Cz(e),r=i===(null==(n=e.ownerDocument)?void 0:n.body),s=Sa(i),o=r?[s].concat(s.visualViewport||[],QO(i)?i:[]):i,a=t.concat(o);return r?a:a.concat($_(zw(o)))}function DCe(e){return["table","td","th"].indexOf(El(e))>=0}function Ez(e){return Ro(e)&&"fixed"!==Bu(e).position?e.offsetParent:null}function V_(e){for(var t=Sa(e),n=Ez(e);n&&DCe(n)&&"static"===Bu(n).position;)n=Ez(n);return n&&("html"===El(n)||"body"===El(n)&&"static"===Bu(n).position)?t:n||function CCe(e){var t=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&Ro(e)&&"fixed"===Bu(e).position)return null;var r=zw(e);for(KO(r)&&(r=r.host);Ro(r)&&["html","body"].indexOf(El(r))<0;){var s=Bu(r);if("none"!==s.transform||"none"!==s.perspective||"paint"===s.contain||-1!==["transform","perspective"].indexOf(s.willChange)||t&&"filter"===s.willChange||t&&s.filter&&"none"!==s.filter)return r;r=r.parentNode}return null}(e)||t}function Sz(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&KO(n)){var i=t;do{if(i&&e.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function ZO(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function xz(e,t){return t===bz?ZO(function bCe(e){var t=Sa(e),n=Uc(e),i=t.visualViewport,r=n.clientWidth,s=n.clientHeight,o=0,a=0;return i&&(r=i.width,s=i.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(o=i.offsetLeft,a=i.offsetTop)),{width:r,height:s,x:o+XO(e),y:a}}(e)):bg(t)?function ECe(e){var t=Dg(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}(t):ZO(function wCe(e){var t,n=Uc(e),i=JO(e),r=null==(t=e.ownerDocument)?void 0:t.body,s=Bf(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=Bf(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-i.scrollLeft+XO(e),l=-i.scrollTop;return"rtl"===Bu(r||n).direction&&(a+=Bf(n.clientWidth,r?r.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}(Uc(e)))}function Cg(e){return e.split("-")[1]}function eN(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Az(e){var l,t=e.reference,n=e.element,i=e.placement,r=i?Cl(i):null,s=i?Cg(i):null,o=t.x+t.width/2-n.width/2,a=t.y+t.height/2-n.height/2;switch(r){case Ws:l={x:o,y:t.y-n.height};break;case Ca:l={x:o,y:t.y+t.height};break;case Ea:l={x:t.x+t.width,y:a};break;case Ys:l={x:t.x-n.width,y:a};break;default:l={x:t.x,y:t.y}}var u=r?eN(r):null;if(null!=u){var c="y"===u?"height":"width";switch(s){case vg:l[u]=l[u]-(t[c]/2-n[c]/2);break;case j_:l[u]=l[u]+(t[c]/2-n[c]/2)}}return l}function Tz(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function Oz(e,t){return t.reduce(function(n,i){return n[i]=e,n},{})}function tN(e,t){void 0===t&&(t={});var i=t.placement,r=void 0===i?e.placement:i,s=t.boundary,o=void 0===s?"clippingParents":s,a=t.rootBoundary,l=void 0===a?bz:a,u=t.elementContext,c=void 0===u?B_:u,d=t.altBoundary,f=void 0!==d&&d,h=t.padding,p=void 0===h?0:h,g=Tz("number"!=typeof p?p:Oz(p,L_)),_=e.rects.popper,y=e.elements[f?c===B_?"reference":B_:c],v=function xCe(e,t,n){var i="clippingParents"===t?function SCe(e){var t=$_(zw(e)),i=["absolute","fixed"].indexOf(Bu(e).position)>=0&&Ro(e)?V_(e):e;return bg(i)?t.filter(function(r){return bg(r)&&Sz(r,i)&&"body"!==El(r)}):[]}(e):[].concat(t),r=[].concat(i,[n]),o=r.reduce(function(a,l){var u=xz(e,l);return a.top=Bf(u.top,a.top),a.right=Uw(u.right,a.right),a.bottom=Uw(u.bottom,a.bottom),a.left=Bf(u.left,a.left),a},xz(e,r[0]));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}(bg(y)?y:y.contextElement||Uc(e.elements.popper),o,l),b=Dg(e.elements.reference),D=Az({reference:b,element:_,strategy:"absolute",placement:r}),C=ZO(Object.assign({},_,D)),w=c===B_?C:b,E={top:v.top-w.top+g.top,bottom:w.bottom-v.bottom+g.bottom,left:v.left-w.left+g.left,right:w.right-v.right+g.right},N=e.modifiersData.offset;if(c===B_&&N){var k=N[r];Object.keys(E).forEach(function(I){var L=[Ea,Ca].indexOf(I)>=0?1:-1,B=[Ws,Ca].indexOf(I)>=0?"y":"x";E[I]+=k[B]*L})}return E}const OCe={name:"flip",enabled:!0,phase:"main",fn:function TCe(e){var t=e.state,n=e.options,i=e.name;if(!t.modifiersData[i]._skip){for(var r=n.mainAxis,s=void 0===r||r,o=n.altAxis,a=void 0===o||o,l=n.fallbackPlacements,u=n.padding,c=n.boundary,d=n.rootBoundary,f=n.altBoundary,h=n.flipVariations,p=void 0===h||h,g=n.allowedAutoPlacements,m=t.options.placement,_=Cl(m),v=l||(_!==m&&p?function MCe(e){if(Cl(e)===YO)return[];var t=Hw(e);return[vz(e),t,vz(t)]}(m):[Hw(m)]),b=[m].concat(v).reduce(function(V,K){return V.concat(Cl(K)===YO?function ACe(e,t){void 0===t&&(t={});var r=t.boundary,s=t.rootBoundary,o=t.padding,a=t.flipVariations,l=t.allowedAutoPlacements,u=void 0===l?Dz:l,c=Cg(t.placement),d=c?a?wz:wz.filter(function(p){return Cg(p)===c}):L_,f=d.filter(function(p){return u.indexOf(p)>=0});0===f.length&&(f=d);var h=f.reduce(function(p,g){return p[g]=tN(e,{placement:g,boundary:r,rootBoundary:s,padding:o})[Cl(g)],p},{});return Object.keys(h).sort(function(p,g){return h[p]-h[g]})}(t,{placement:K,boundary:c,rootBoundary:d,padding:u,flipVariations:p,allowedAutoPlacements:g}):K)},[]),D=t.rects.reference,C=t.rects.popper,w=new Map,E=!0,N=b[0],k=0;k<b.length;k++){var I=b[k],L=Cl(I),B=Cg(I)===vg,T=[Ws,Ca].indexOf(L)>=0,A=T?"width":"height",x=tN(t,{placement:I,boundary:c,rootBoundary:d,altBoundary:f,padding:u}),F=T?B?Ea:Ys:B?Ca:Ws;D[A]>C[A]&&(F=Hw(F));var O=Hw(F),j=[];if(s&&j.push(x[L]<=0),a&&j.push(x[F]<=0,x[O]<=0),j.every(function(V){return V})){N=I,E=!1;break}w.set(I,j)}if(E)for(var z=function(K){var re=b.find(function(X){var le=w.get(X);if(le)return le.slice(0,K).every(function(Y){return Y})});if(re)return N=re,"break"},q=p?3:1;q>0&&"break"!==z(q);q--);t.placement!==N&&(t.modifiersData[i]._skip=!0,t.placement=N,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function H_(e,t,n){return Bf(e,Uw(t,n))}function nN(e){var t=Dg(e),n=e.offsetWidth,i=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:i}}const RCe={name:"preventOverflow",enabled:!0,phase:"main",fn:function ICe(e){var t=e.state,n=e.options,i=e.name,r=n.mainAxis,s=void 0===r||r,o=n.altAxis,a=void 0!==o&&o,f=n.tether,h=void 0===f||f,p=n.tetherOffset,g=void 0===p?0:p,m=tN(t,{boundary:n.boundary,rootBoundary:n.rootBoundary,padding:n.padding,altBoundary:n.altBoundary}),_=Cl(t.placement),y=Cg(t.placement),v=!y,b=eN(_),D=function NCe(e){return"x"===e?"y":"x"}(b),C=t.modifiersData.popperOffsets,w=t.rects.reference,E=t.rects.popper,N="function"==typeof g?g(Object.assign({},t.rects,{placement:t.placement})):g,k="number"==typeof N?{mainAxis:N,altAxis:N}:Object.assign({mainAxis:0,altAxis:0},N),I=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,L={x:0,y:0};if(C){if(s){var B,T="y"===b?Ws:Ys,A="y"===b?Ca:Ea,x="y"===b?"height":"width",F=C[b],O=F+m[T],j=F-m[A],P=h?-E[x]/2:0,z=y===vg?w[x]:E[x],q=y===vg?-E[x]:-w[x],G=t.elements.arrow,V=h&&G?nN(G):{width:0,height:0},K=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},re=K[T],X=K[A],le=H_(0,w[x],V[x]),Y=v?w[x]/2-P-le-re-k.mainAxis:z-le-re-k.mainAxis,Z=v?-w[x]/2+P+le+X+k.mainAxis:q+le+X+k.mainAxis,ne=t.elements.arrow&&V_(t.elements.arrow),he=null!=(B=null==I?void 0:I[b])?B:0,Re=F+Z-he,Ce=H_(h?Uw(O,F+Y-he-(ne?"y"===b?ne.clientTop||0:ne.clientLeft||0:0)):O,F,h?Bf(j,Re):j);C[b]=Ce,L[b]=Ce-F}if(a){var Oe,tt=C[D],He="y"===D?"height":"width",se=tt+m["x"===b?Ws:Ys],Bt=tt-m["x"===b?Ca:Ea],Ti=-1!==[Ws,Ys].indexOf(_),_o=null!=(Oe=null==I?void 0:I[D])?Oe:0,al=Ti?se:tt-w[He]-E[He]-_o+k.altAxis,Dc=Ti?tt+w[He]+E[He]-_o-k.altAxis:Bt,ks=h&&Ti?function kCe(e,t,n){var i=H_(e,t,n);return i>n?n:i}(al,tt,Dc):H_(h?al:se,tt,h?Dc:Bt);C[D]=ks,L[D]=ks-tt}t.modifiersData[i]=L}},requiresIfExists:["offset"]},jCe={name:"arrow",enabled:!0,phase:"main",fn:function PCe(e){var t,n=e.state,i=e.name,r=e.options,s=n.elements.arrow,o=n.modifiersData.popperOffsets,a=Cl(n.placement),l=eN(a),c=[Ys,Ea].indexOf(a)>=0?"height":"width";if(s&&o){var d=function(t,n){return Tz("number"!=typeof(t="function"==typeof t?t(Object.assign({},n.rects,{placement:n.placement})):t)?t:Oz(t,L_))}(r.padding,n),f=nN(s),h="y"===l?Ws:Ys,p="y"===l?Ca:Ea,g=n.rects.reference[c]+n.rects.reference[l]-o[l]-n.rects.popper[c],m=o[l]-n.rects.reference[l],_=V_(s),y=_?"y"===l?_.clientHeight||0:_.clientWidth||0:0,C=y/2-f[c]/2+(g/2-m/2),w=H_(d[h],C,y-f[c]-d[p]);n.modifiersData[i]=((t={})[l]=w,t.centerOffset=w-C,t)}},effect:function LCe(e){var t=e.state,i=e.options.element,r=void 0===i?"[data-popper-arrow]":i;null!=r&&("string"==typeof r&&!(r=t.elements.popper.querySelector(r))||!Sz(t.elements.popper,r)||(t.elements.arrow=r))},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function HCe(e,t,n){void 0===n&&(n=!1);var i=Ro(t),r=Ro(t)&&function VCe(e){var t=e.getBoundingClientRect(),n=wg(t.width)/e.offsetWidth||1,i=wg(t.height)/e.offsetHeight||1;return 1!==n||1!==i}(t),s=Uc(t),o=Dg(e,r),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(i||!i&&!n)&&(("body"!==El(t)||QO(s))&&(a=function $Ce(e){return e!==Sa(e)&&Ro(e)?function BCe(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}(e):JO(e)}(t)),Ro(t)?((l=Dg(t,!0)).x+=t.clientLeft,l.y+=t.clientTop):s&&(l.x=XO(s))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function UCe(e){var t=new Map,n=new Set,i=[];function r(s){n.add(s.name),[].concat(s.requires||[],s.requiresIfExists||[]).forEach(function(a){if(!n.has(a)){var l=t.get(a);l&&r(l)}}),i.push(s)}return e.forEach(function(s){t.set(s.name,s)}),e.forEach(function(s){n.has(s.name)||r(s)}),i}function qCe(e){var t;return function(){return t||(t=new Promise(function(n){Promise.resolve().then(function(){t=void 0,n(e())})})),t}}var Nz={placement:"bottom",modifiers:[],strategy:"absolute"};function kz(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(i){return!(i&&"function"==typeof i.getBoundingClientRect)})}function WCe(e){void 0===e&&(e={});var n=e.defaultModifiers,i=void 0===n?[]:n,r=e.defaultOptions,s=void 0===r?Nz:r;return function(a,l,u){void 0===u&&(u=s);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},Nz,s),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},d=[],f=!1,h={state:c,setOptions:function(_){var y="function"==typeof _?_(c.options):_;g(),c.options=Object.assign({},s,c.options,y),c.scrollParents={reference:bg(a)?$_(a):a.contextElement?$_(a.contextElement):[],popper:$_(l)};var v=function zCe(e){var t=UCe(e);return vCe.reduce(function(n,i){return n.concat(t.filter(function(r){return r.phase===i}))},[])}(function GCe(e){var t=e.reduce(function(n,i){var r=n[i.name];return n[i.name]=r?Object.assign({},r,i,{options:Object.assign({},r.options,i.options),data:Object.assign({},r.data,i.data)}):i,n},{});return Object.keys(t).map(function(n){return t[n]})}([].concat(i,c.options.modifiers)));return c.orderedModifiers=v.filter(function(I){return I.enabled}),function p(){c.orderedModifiers.forEach(function(m){var y=m.options,b=m.effect;if("function"==typeof b){var D=b({state:c,name:m.name,instance:h,options:void 0===y?{}:y});d.push(D||function(){})}})}(),h.update()},forceUpdate:function(){if(!f){var _=c.elements,y=_.reference,v=_.popper;if(kz(y,v)){c.rects={reference:HCe(y,V_(v),"fixed"===c.options.strategy),popper:nN(v)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(I){return c.modifiersData[I.name]=Object.assign({},I.data)});for(var D=0;D<c.orderedModifiers.length;D++)if(!0!==c.reset){var C=c.orderedModifiers[D],w=C.fn,E=C.options;"function"==typeof w&&(c=w({state:c,options:void 0===E?{}:E,name:C.name,instance:h})||c)}else c.reset=!1,D=-1}}},update:qCe(function(){return new Promise(function(m){h.forceUpdate(),m(c)})}),destroy:function(){g(),f=!0}};if(!kz(a,l))return h;function g(){d.forEach(function(m){return m()}),d=[]}return h.setOptions(u).then(function(m){!f&&u.onFirstUpdate&&u.onFirstUpdate(m)}),h}}var qw={passive:!0};const KCe={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function YCe(e){var t=e.state,n=e.instance,i=e.options,r=i.scroll,s=void 0===r||r,o=i.resize,a=void 0===o||o,l=Sa(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&u.forEach(function(c){c.addEventListener("scroll",n.update,qw)}),a&&l.addEventListener("resize",n.update,qw),function(){s&&u.forEach(function(c){c.removeEventListener("scroll",n.update,qw)}),a&&l.removeEventListener("resize",n.update,qw)}},data:{}},XCe={name:"popperOffsets",enabled:!0,phase:"read",fn:function JCe(e){var t=e.state;t.modifiersData[e.name]=Az({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}};var QCe={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Iz(e){var t,n=e.popper,i=e.popperRect,r=e.placement,s=e.variation,o=e.offsets,a=e.position,l=e.gpuAcceleration,u=e.adaptive,c=e.roundOffsets,d=e.isFixed,f=o.x,h=void 0===f?0:f,p=o.y,g=void 0===p?0:p,m="function"==typeof c?c({x:h,y:g}):{x:h,y:g};h=m.x,g=m.y;var _=o.hasOwnProperty("x"),y=o.hasOwnProperty("y"),v=Ys,b=Ws,D=window;if(u){var C=V_(n),w="clientHeight",E="clientWidth";C===Sa(n)&&"static"!==Bu(C=Uc(n)).position&&"absolute"===a&&(w="scrollHeight",E="scrollWidth"),C=C,(r===Ws||(r===Ys||r===Ea)&&s===j_)&&(b=Ca,g-=(d&&C===D&&D.visualViewport?D.visualViewport.height:C[w])-i.height,g*=l?1:-1),r!==Ys&&(r!==Ws&&r!==Ca||s!==j_)||(v=Ea,h-=(d&&C===D&&D.visualViewport?D.visualViewport.width:C[E])-i.width,h*=l?1:-1)}var B,I=Object.assign({position:a},u&&QCe),L=!0===c?function ZCe(e){var n=e.y,r=window.devicePixelRatio||1;return{x:wg(e.x*r)/r||0,y:wg(n*r)/r||0}}({x:h,y:g}):{x:h,y:g};return h=L.x,g=L.y,Object.assign({},I,l?((B={})[b]=y?"0":"",B[v]=_?"0":"",B.transform=(D.devicePixelRatio||1)<=1?"translate("+h+"px, "+g+"px)":"translate3d("+h+"px, "+g+"px, 0)",B):((t={})[b]=y?g+"px":"",t[v]=_?h+"px":"",t.transform="",t))}const tEe={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function eEe(e){var t=e.state,n=e.options,i=n.gpuAcceleration,r=void 0===i||i,s=n.adaptive,o=void 0===s||s,a=n.roundOffsets,l=void 0===a||a,c={placement:Cl(t.placement),variation:Cg(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,Iz(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,Iz(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}};var rEe=[KCe,XCe,tEe,{name:"applyStyles",enabled:!0,phase:"write",fn:function nEe(e){var t=e.state;Object.keys(t.elements).forEach(function(n){var i=t.styles[n]||{},r=t.attributes[n]||{},s=t.elements[n];!Ro(s)||!El(s)||(Object.assign(s.style,i),Object.keys(r).forEach(function(o){var a=r[o];!1===a?s.removeAttribute(o):s.setAttribute(o,!0===a?"":a)}))})},effect:function iEe(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(i){var r=t.elements[i],s=t.attributes[i]||{},a=Object.keys(t.styles.hasOwnProperty(i)?t.styles[i]:n[i]).reduce(function(l,u){return l[u]="",l},{});!Ro(r)||!El(r)||(Object.assign(r.style,a),Object.keys(s).forEach(function(l){r.removeAttribute(l)}))})}},requires:["computeStyles"]}],sEe=WCe({defaultModifiers:rEe});const lEe={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function aEe(e){var t=e.state,i=e.name,r=e.options.offset,s=void 0===r?[0,0]:r,o=Dz.reduce(function(c,d){return c[d]=function oEe(e,t,n){var i=Cl(e),r=[Ys,Ws].indexOf(i)>=0?-1:1,s="function"==typeof n?n(Object.assign({},t,{placement:e})):n,o=s[0],a=s[1];return o=o||0,a=(a||0)*r,[Ys,Ea].indexOf(i)>=0?{x:a,y:o}:{x:o,y:a}}(d,t.rects,s),c},{}),a=o[t.placement],u=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=a.x,t.modifiersData.popperOffsets.y+=u),t.modifiersData[i]=o}},Rz=["*"],IEe=["dialog"];function dSe(e,t){1&e&&R(0),2&e&&ki(Et(2).title)}function fSe(e,t){}function hSe(e,t){if(1&e&&(S(0,"h3",3),Ne(1,dSe,1,1,"ng-template",null,4,Ao),Ne(3,fSe,0,0,"ng-template",5),M()),2&e){const n=So(2),i=Et();$(3),U("ngTemplateOutlet",i.isTitleTemplate()?i.title:n)("ngTemplateOutletContext",i.context)}}function $f(e){return null!=e}function Eg(e){return(e||document.body).getBoundingClientRect()}const Pz={animation:!0,transitionTimerDelayMs:5},TSe=()=>{},{transitionTimerDelayMs:OSe}=Pz,U_=new Map,Vr=(e,t,n,i)=>{let r=i.context||{};const s=U_.get(t);if(s)switch(i.runningTransition){case"continue":return ra;case"stop":e.run(()=>s.transition$.complete()),r=Object.assign(s.context,r),U_.delete(t)}const o=n(t,i.animation,r)||TSe;if(!i.animation||"none"===window.getComputedStyle(t).transitionProperty)return e.run(()=>o()),We(void 0).pipe(function ASe(e){return t=>new en(n=>t.subscribe({next:o=>e.run(()=>n.next(o)),error:o=>e.run(()=>n.error(o)),complete:()=>e.run(()=>n.complete())}))}(e));const a=new Pn,l=new Pn,u=a.pipe(function rDe(...e){return t=>v_(t,We(...e))}(!0));U_.set(t,{transition$:a,complete:()=>{l.next(),l.complete()},context:r});const c=function MSe(e){const{transitionDelay:t,transitionDuration:n}=window.getComputedStyle(e);return 1e3*(parseFloat(t)+parseFloat(n))}(t);return e.runOutsideAngular(()=>{const d=Br(t,"transitionend").pipe(wi(u),Ri(({target:h})=>h===t));uU(CO(c+OSe).pipe(wi(u)),d,l).pipe(wi(u)).subscribe(()=>{U_.delete(t),e.run(()=>{o(),a.next(),a.complete()})})}),a.asObservable()};let z_=(()=>{class e{constructor(){this.animation=Pz.animation}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ie({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Hz=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({imports:[[zs]]}),e})(),Uz=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({imports:[[zs]]}),e})(),qz=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({}),e})(),Yz=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({imports:[[zs]]}),e})(),Kz=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({}),e})();var Di=(()=>{return(e=Di||(Di={}))[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.ArrowLeft=37]="ArrowLeft",e[e.ArrowUp=38]="ArrowUp",e[e.ArrowRight=39]="ArrowRight",e[e.ArrowDown=40]="ArrowDown",Di;var e})();const Yw=(e,t)=>!!t&&t.some(n=>n.contains(e)),Jz=(e,t)=>!t||null!=function xSe(e,t){return t&&void 0!==e.closest?e.closest(t):null}(e,t),KSe="undefined"!=typeof navigator&&!!navigator.userAgent&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2||/Android/.test(navigator.userAgent));const Qz=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");function Zz(e){const t=Array.from(e.querySelectorAll(Qz)).filter(n=>-1!==n.tabIndex);return[t[0],t[t.length-1]]}const QSe=/\s+/,ZSe=/  +/gi,exe=/^start/,txe=/^end/,nxe=/-(top|left)$/,ixe=/-(bottom|right)$/,sxe=/^left/,oxe=/^right/,axe=/^start/,lxe=/^end/;function eq({placement:e,baseClass:t}){let n=Array.isArray(e)?e:e.split(QSe),r=n.findIndex(l=>"auto"===l);r>=0&&["top","bottom","start","end","top-start","top-end","bottom-start","bottom-end","start-top","start-bottom","end-top","end-bottom"].forEach(function(l){null==n.find(u=>-1!==u.search("^"+l))&&n.splice(r++,1,l)});const s=n.map(l=>function rxe(e){return e.replace(exe,"left").replace(txe,"right").replace(nxe,"-start").replace(ixe,"-end")}(l));return{placement:s.shift(),modifiers:[{name:"bootstrapClasses",enabled:!!t,phase:"write",fn({state:l}){const u=new RegExp(t+"-[a-z]+","gi"),c=l.elements.popper,d=l.placement;let f=c.className;f=f.replace(u,""),f+=` ${function uxe(e,t){let[n,i]=t.split("-");const r=n.replace(sxe,"start").replace(oxe,"end");let s=[r];if(i){let o=i;("left"===n||"right"===n)&&(o=o.replace(axe,"top").replace(lxe,"bottom")),s.push(`${r}-${o}`)}return e&&(s=s.map(o=>`${e}-${o}`)),s.join(" ")}(t,d)}`,f=f.trim().replace(ZSe," "),c.className=f}},OCe,RCe,jCe,{enabled:!0,name:"flip",options:{fallbackPlacements:s}},{enabled:!0,name:"preventOverflow",phase:"main",fn:function(){}}]}}function tq(e){return e}function iq(e){return t=>(t.modifiers.push(lEe,{name:"offset",options:{offset:()=>e}}),t)}new Date(1882,10,12),new Date(2174,10,25);let uq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({imports:[[zs,yz]]}),e})(),dN=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275dir=ye({type:e,selectors:[["",8,"navbar"]]}),e})(),fq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({}),e})();class zf{constructor(t,n,i){this.nodes=t,this.viewRef=n,this.componentRef=i}}class bxe{constructor(t,n,i,r,s,o){this._type=t,this._injector=n,this._viewContainerRef=i,this._renderer=r,this._ngZone=s,this._applicationRef=o,this._windowRef=null,this._contentRef=null}open(t,n,i=!1){this._windowRef||(this._contentRef=this._getContentRef(t,n),this._windowRef=this._viewContainerRef.createComponent(this._type,{index:this._viewContainerRef.length,injector:this._injector,projectableNodes:this._contentRef.nodes}));const{nativeElement:r}=this._windowRef.location,s=this._ngZone.onStable.pipe(mi(1),Zn(()=>Vr(this._ngZone,r,({classList:o})=>o.add("show"),{animation:i,runningTransition:"continue"})));return{windowRef:this._windowRef,transition$:s}}close(t=!1){return this._windowRef?Vr(this._ngZone,this._windowRef.location.nativeElement,({classList:n})=>n.remove("show"),{animation:t,runningTransition:"stop"}).pipe(hr(()=>{var n;this._windowRef&&(this._viewContainerRef.remove(this._viewContainerRef.indexOf(this._windowRef.hostView)),this._windowRef=null),(null===(n=this._contentRef)||void 0===n?void 0:n.viewRef)&&(this._applicationRef.detachView(this._contentRef.viewRef),this._contentRef.viewRef.destroy(),this._contentRef=null)})):We(void 0)}_getContentRef(t,n){if(t){if(t instanceof Mn){const i=t.createEmbeddedView(n);return this._applicationRef.attachView(i),new zf([i.rootNodes],i)}return new zf([[this._renderer.createText(`${t}`)]])}return new zf([])}}let wxe=(()=>{class e{constructor(n,i){this._el=n,this._zone=i}ngOnInit(){this._zone.onStable.asObservable().pipe(mi(1)).subscribe(()=>{Vr(this._zone,this._el.nativeElement,(n,i)=>{i&&Eg(n),n.classList.add("show")},{animation:this.animation,runningTransition:"continue"})})}hide(){return Vr(this._zone,this._el.nativeElement,({classList:n})=>n.remove("show"),{animation:this.animation,runningTransition:"stop"})}}return e.\u0275fac=function(n){return new(n||e)(H(fn),H(hn))},e.\u0275cmp=Nt({type:e,selectors:[["ngb-modal-backdrop"]],hostAttrs:[2,"z-index","1055"],hostVars:6,hostBindings:function(n,i){2&n&&(Ic("modal-backdrop"+(i.backdropClass?" "+i.backdropClass:"")),An("show",!i.animation)("fade",i.animation))},inputs:{animation:"animation",backdropClass:"backdropClass"},decls:0,vars:0,template:function(n,i){},encapsulation:2}),e})();class hq{close(t){}dismiss(t){}}class Dxe{constructor(t,n,i,r){this._windowCmptRef=t,this._contentRef=n,this._backdropCmptRef=i,this._beforeDismiss=r,this._closed=new Pn,this._dismissed=new Pn,this._hidden=new Pn,t.instance.dismissEvent.subscribe(s=>{this.dismiss(s)}),this.result=new Promise((s,o)=>{this._resolve=s,this._reject=o}),this.result.then(null,()=>{})}get componentInstance(){if(this._contentRef&&this._contentRef.componentRef)return this._contentRef.componentRef.instance}get closed(){return this._closed.asObservable().pipe(wi(this._hidden))}get dismissed(){return this._dismissed.asObservable().pipe(wi(this._hidden))}get hidden(){return this._hidden.asObservable()}get shown(){return this._windowCmptRef.instance.shown.asObservable()}close(t){this._windowCmptRef&&(this._closed.next(t),this._resolve(t),this._removeModalElements())}_dismiss(t){this._dismissed.next(t),this._reject(t),this._removeModalElements()}dismiss(t){if(this._windowCmptRef)if(this._beforeDismiss){const n=this._beforeDismiss();!function SSe(e){return e&&e.then}(n)?!1!==n&&this._dismiss(t):n.then(i=>{!1!==i&&this._dismiss(t)},()=>{})}else this._dismiss(t)}_removeModalElements(){const t=this._windowCmptRef.instance.hide(),n=this._backdropCmptRef?this._backdropCmptRef.instance.hide():We(void 0);t.subscribe(()=>{const{nativeElement:i}=this._windowCmptRef.location;i.parentNode.removeChild(i),this._windowCmptRef.destroy(),this._contentRef&&this._contentRef.viewRef&&this._contentRef.viewRef.destroy(),this._windowCmptRef=null,this._contentRef=null}),n.subscribe(()=>{if(this._backdropCmptRef){const{nativeElement:i}=this._backdropCmptRef.location;i.parentNode.removeChild(i),this._backdropCmptRef.destroy(),this._backdropCmptRef=null}}),kw(t,n).subscribe(()=>{this._hidden.next(),this._hidden.complete()})}}var Y_=(()=>{return(e=Y_||(Y_={}))[e.BACKDROP_CLICK=0]="BACKDROP_CLICK",e[e.ESC=1]="ESC",Y_;var e})();let Cxe=(()=>{class e{constructor(n,i,r){this._document=n,this._elRef=i,this._zone=r,this._closed$=new Pn,this._elWithFocus=null,this.backdrop=!0,this.keyboard=!0,this.dismissEvent=new nt,this.shown=new Pn,this.hidden=new Pn}dismiss(n){this.dismissEvent.emit(n)}ngOnInit(){this._elWithFocus=this._document.activeElement,this._zone.onStable.asObservable().pipe(mi(1)).subscribe(()=>{this._show()})}ngOnDestroy(){this._disableEventHandling()}hide(){const{nativeElement:n}=this._elRef,i={animation:this.animation,runningTransition:"stop"},o=kw(Vr(this._zone,n,()=>n.classList.remove("show"),i),Vr(this._zone,this._dialogEl.nativeElement,()=>{},i));return o.subscribe(()=>{this.hidden.next(),this.hidden.complete()}),this._disableEventHandling(),this._restoreFocus(),o}_show(){const n={animation:this.animation,runningTransition:"continue"};kw(Vr(this._zone,this._elRef.nativeElement,(s,o)=>{o&&Eg(s),s.classList.add("show")},n),Vr(this._zone,this._dialogEl.nativeElement,()=>{},n)).subscribe(()=>{this.shown.next(),this.shown.complete()}),this._enableEventHandling(),this._setFocus()}_enableEventHandling(){const{nativeElement:n}=this._elRef;this._zone.runOutsideAngular(()=>{Br(n,"keydown").pipe(wi(this._closed$),Ri(r=>r.which===Di.Escape)).subscribe(r=>{this.keyboard?requestAnimationFrame(()=>{r.defaultPrevented||this._zone.run(()=>this.dismiss(Y_.ESC))}):"static"===this.backdrop&&this._bumpBackdrop()});let i=!1;Br(this._dialogEl.nativeElement,"mousedown").pipe(wi(this._closed$),hr(()=>i=!1),Ru(()=>Br(n,"mouseup").pipe(wi(this._closed$),mi(1))),Ri(({target:r})=>n===r)).subscribe(()=>{i=!0}),Br(n,"click").pipe(wi(this._closed$)).subscribe(({target:r})=>{n===r&&("static"===this.backdrop?this._bumpBackdrop():!0===this.backdrop&&!i&&this._zone.run(()=>this.dismiss(Y_.BACKDROP_CLICK))),i=!1})})}_disableEventHandling(){this._closed$.next()}_setFocus(){const{nativeElement:n}=this._elRef;if(!n.contains(document.activeElement)){const i=n.querySelector("[ngbAutofocus]"),r=Zz(n)[0];(i||r||n).focus()}}_restoreFocus(){const n=this._document.body,i=this._elWithFocus;let r;r=i&&i.focus&&n.contains(i)?i:n,this._zone.runOutsideAngular(()=>{setTimeout(()=>r.focus()),this._elWithFocus=null})}_bumpBackdrop(){"static"===this.backdrop&&Vr(this._zone,this._elRef.nativeElement,({classList:n})=>(n.add("modal-static"),()=>n.remove("modal-static")),{animation:this.animation,runningTransition:"continue"})}}return e.\u0275fac=function(n){return new(n||e)(H(ni),H(fn),H(hn))},e.\u0275cmp=Nt({type:e,selectors:[["ngb-modal-window"]],viewQuery:function(n,i){if(1&n&&zb(IEe,7),2&n){let r;Tn(r=On())&&(i._dialogEl=r.first)}},hostAttrs:["role","dialog","tabindex","-1"],hostVars:7,hostBindings:function(n,i){2&n&&(cn("aria-modal",!0)("aria-labelledby",i.ariaLabelledBy)("aria-describedby",i.ariaDescribedBy),Ic("modal d-block"+(i.windowClass?" "+i.windowClass:"")),An("fade",i.animation))},inputs:{animation:"animation",ariaLabelledBy:"ariaLabelledBy",ariaDescribedBy:"ariaDescribedBy",backdrop:"backdrop",centered:"centered",keyboard:"keyboard",scrollable:"scrollable",size:"size",windowClass:"windowClass",modalDialogClass:"modalDialogClass"},outputs:{dismissEvent:"dismiss"},ngContentSelectors:Rz,decls:4,vars:2,consts:[["role","document"],["dialog",""],[1,"modal-content"]],template:function(n,i){1&n&&(FT(),S(0,"div",0,1)(2,"div",2),PT(3),M()()),2&n&&Ic("modal-dialog"+(i.size?" modal-"+i.size:"")+(i.centered?" modal-dialog-centered":"")+(i.scrollable?" modal-dialog-scrollable":"")+(i.modalDialogClass?" "+i.modalDialogClass:""))},styles:["ngb-modal-window .component-host-scrollable{display:flex;flex-direction:column;overflow:hidden}\n"],encapsulation:2}),e})(),Exe=(()=>{class e{constructor(n){this._document=n}hide(){const n=Math.abs(window.innerWidth-this._document.documentElement.clientWidth),i=this._document.body,r=i.style,{overflow:s,paddingRight:o}=r;if(n>0){const a=parseFloat(window.getComputedStyle(i).paddingRight);r.paddingRight=`${a+n}px`}return r.overflow="hidden",()=>{n>0&&(r.paddingRight=o),r.overflow=s}}}return e.\u0275fac=function(n){return new(n||e)(me(ni))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Sxe=(()=>{class e{constructor(n,i,r,s,o,a){this._applicationRef=n,this._injector=i,this._document=r,this._scrollBar=s,this._rendererFactory=o,this._ngZone=a,this._activeWindowCmptHasChanged=new Pn,this._ariaHiddenValues=new Map,this._scrollBarRestoreFn=null,this._backdropAttributes=["animation","backdropClass"],this._modalRefs=[],this._windowAttributes=["animation","ariaLabelledBy","ariaDescribedBy","backdrop","centered","keyboard","scrollable","size","windowClass","modalDialogClass"],this._windowCmpts=[],this._activeInstances=new nt,this._activeWindowCmptHasChanged.subscribe(()=>{if(this._windowCmpts.length){const l=this._windowCmpts[this._windowCmpts.length-1];((e,t,n,i=!1)=>{this._ngZone.runOutsideAngular(()=>{const r=Br(t,"focusin").pipe(wi(n),at(s=>s.target));Br(t,"keydown").pipe(wi(n),Ri(s=>s.which===Di.Tab),SO(r)).subscribe(([s,o])=>{const[a,l]=Zz(t);(o===a||o===t)&&s.shiftKey&&(l.focus(),s.preventDefault()),o===l&&!s.shiftKey&&(a.focus(),s.preventDefault())}),i&&Br(t,"click").pipe(wi(n),SO(r),at(s=>s[1])).subscribe(s=>s.focus())})})(0,l.location.nativeElement,this._activeWindowCmptHasChanged),this._revertAriaHidden(),this._setAriaHidden(l.location.nativeElement)}})}_restoreScrollBar(){const n=this._scrollBarRestoreFn;n&&(this._scrollBarRestoreFn=null,n())}_hideScrollBar(){this._scrollBarRestoreFn||(this._scrollBarRestoreFn=this._scrollBar.hide())}open(n,i,r,s){const o=s.container instanceof HTMLElement?s.container:$f(s.container)?this._document.querySelector(s.container):this._document.body,a=this._rendererFactory.createRenderer(null,null);if(!o)throw new Error(`The specified modal container "${s.container||"body"}" was not found in the DOM.`);this._hideScrollBar();const l=new hq,u=this._getContentRef(n,s.injector||i,r,l,s);let c=!1!==s.backdrop?this._attachBackdrop(n,o):void 0,d=this._attachWindowComponent(n,o,u),f=new Dxe(d,u,c,s.beforeDismiss);return this._registerModalRef(f),this._registerWindowCmpt(d),f.hidden.pipe(mi(1)).subscribe(()=>Promise.resolve(!0).then(()=>{this._modalRefs.length||(a.removeClass(this._document.body,"modal-open"),this._restoreScrollBar(),this._revertAriaHidden())})),l.close=h=>{f.close(h)},l.dismiss=h=>{f.dismiss(h)},this._applyWindowOptions(d.instance,s),1===this._modalRefs.length&&a.addClass(this._document.body,"modal-open"),c&&c.instance&&(this._applyBackdropOptions(c.instance,s),c.changeDetectorRef.detectChanges()),d.changeDetectorRef.detectChanges(),f}get activeInstances(){return this._activeInstances}dismissAll(n){this._modalRefs.forEach(i=>i.dismiss(n))}hasOpenModals(){return this._modalRefs.length>0}_attachBackdrop(n,i){let s=n.resolveComponentFactory(wxe).create(this._injector);return this._applicationRef.attachView(s.hostView),i.appendChild(s.location.nativeElement),s}_attachWindowComponent(n,i,r){let o=n.resolveComponentFactory(Cxe).create(this._injector,r.nodes);return this._applicationRef.attachView(o.hostView),i.appendChild(o.location.nativeElement),o}_applyWindowOptions(n,i){this._windowAttributes.forEach(r=>{$f(i[r])&&(n[r]=i[r])})}_applyBackdropOptions(n,i){this._backdropAttributes.forEach(r=>{$f(i[r])&&(n[r]=i[r])})}_getContentRef(n,i,r,s,o){return r?r instanceof Mn?this._createFromTemplateRef(r,s):function Fz(e){return"string"==typeof e}(r)?this._createFromString(r):this._createFromComponent(n,i,r,s,o):new zf([])}_createFromTemplateRef(n,i){const s=n.createEmbeddedView({$implicit:i,close(o){i.close(o)},dismiss(o){i.dismiss(o)}});return this._applicationRef.attachView(s),new zf([s.rootNodes],s)}_createFromString(n){const i=this._document.createTextNode(`${n}`);return new zf([[i]])}_createFromComponent(n,i,r,s,o){const a=n.resolveComponentFactory(r),l=li.create({providers:[{provide:hq,useValue:s}],parent:i}),u=a.create(l),c=u.location.nativeElement;return o.scrollable&&c.classList.add("component-host-scrollable"),this._applicationRef.attachView(u.hostView),new zf([[c]],u.hostView,u)}_setAriaHidden(n){const i=n.parentElement;i&&n!==this._document.body&&(Array.from(i.children).forEach(r=>{r!==n&&"SCRIPT"!==r.nodeName&&(this._ariaHiddenValues.set(r,r.getAttribute("aria-hidden")),r.setAttribute("aria-hidden","true"))}),this._setAriaHidden(i))}_revertAriaHidden(){this._ariaHiddenValues.forEach((n,i)=>{n?i.setAttribute("aria-hidden",n):i.removeAttribute("aria-hidden")}),this._ariaHiddenValues.clear()}_registerModalRef(n){const i=()=>{const r=this._modalRefs.indexOf(n);r>-1&&(this._modalRefs.splice(r,1),this._activeInstances.emit(this._modalRefs))};this._modalRefs.push(n),this._activeInstances.emit(this._modalRefs),n.result.then(i,i)}_registerWindowCmpt(n){this._windowCmpts.push(n),this._activeWindowCmptHasChanged.next(),n.onDestroy(()=>{const i=this._windowCmpts.indexOf(n);i>-1&&(this._windowCmpts.splice(i,1),this._activeWindowCmptHasChanged.next())})}}return e.\u0275fac=function(n){return new(n||e)(me(h_),me(li),me(ni),me(Exe),me(lg),me(hn))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),xxe=(()=>{class e{constructor(n){this._ngbConfig=n,this.backdrop=!0,this.keyboard=!0}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(n){this._animation=n}}return e.\u0275fac=function(n){return new(n||e)(me(z_))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),pq=(()=>{class e{constructor(n,i,r,s){this._moduleCFR=n,this._injector=i,this._modalStack=r,this._config=s}open(n,i={}){const r=Object.assign(Object.assign(Object.assign({},this._config),{animation:this._config.animation}),i);return this._modalStack.open(this._moduleCFR,this._injector,n,r)}get activeInstances(){return this._modalStack.activeInstances}dismissAll(n){this._modalStack.dismissAll(n)}hasOpenModals(){return this._modalStack.hasOpenModals()}}return e.\u0275fac=function(n){return new(n||e)(me(og),me(li),me(Sxe),me(xxe))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),gq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({providers:[pq]}),e})(),vq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({imports:[[zs]]}),e})(),Aq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({imports:[[zs]]}),e})();class kxe{constructor(t,n){this.open=t,this.close=n,n||(this.close=t)}isManual(){return"manual"===this.open||"manual"===this.close}}const Ixe={hover:["mouseenter","mouseleave"],focus:["focusin","focusout"]},Mq=e=>e>0?fU(e):t=>t;let jxe=(()=>{class e{constructor(n){this._ngbConfig=n,this.autoClose=!0,this.placement="auto",this.triggers="click",this.disablePopover=!1,this.openDelay=0,this.closeDelay=0}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(n){this._animation=n}}return e.\u0275fac=function(n){return new(n||e)(me(z_))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Bxe=0,$xe=(()=>{class e{isTitleTemplate(){return this.title instanceof Mn}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Nt({type:e,selectors:[["ngb-popover-window"]],hostAttrs:["role","tooltip"],hostVars:5,hostBindings:function(n,i){2&n&&(Ou("id",i.id),Ic("popover"+(i.popoverClass?" "+i.popoverClass:"")),An("fade",i.animation))},inputs:{animation:"animation",title:"title",id:"id",popoverClass:"popoverClass",context:"context"},ngContentSelectors:Rz,decls:4,vars:1,consts:[["data-popper-arrow","",1,"popover-arrow"],["class","popover-header",4,"ngIf"],[1,"popover-body"],[1,"popover-header"],["simpleTitle",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(n,i){1&n&&(FT(),Me(0,"div",0),Ne(1,hSe,4,2,"h3",1),S(2,"div",2),PT(3),M()),2&n&&($(1),U("ngIf",i.title))},directives:[zn,fg],encapsulation:2,changeDetection:0}),e})(),Tq=(()=>{class e{constructor(n,i,r,s,o,a,l,u,c){this._elementRef=n,this._renderer=i,this._ngZone=a,this._document=l,this._changeDetector=u,this.shown=new nt,this.hidden=new nt,this._ngbPopoverWindowId="ngb-popover-"+Bxe++,this._windowRef=null,this._positioning=function nq(){let e=null;return{createPopper(t){if(!e){let i=(t.updatePopperOptions||tq)(eq(t));e=sEe(t.hostElement,t.targetElement,i)}},update(){e&&e.update()},setOptions(t){if(e){let i=(t.updatePopperOptions||tq)(eq(t));e.setOptions(i)}},destroy(){e&&(e.destroy(),e=null)}}}(),this.animation=o.animation,this.autoClose=o.autoClose,this.placement=o.placement,this.triggers=o.triggers,this.container=o.container,this.disablePopover=o.disablePopover,this.popoverClass=o.popoverClass,this.openDelay=o.openDelay,this.closeDelay=o.closeDelay,this._popupService=new bxe($xe,r,s,i,this._ngZone,c),this._zoneSubscription=a.onStable.subscribe(()=>{this._positioning.update()})}_isDisabled(){return!(!this.disablePopover&&(this.ngbPopover||this.popoverTitle))}open(n){if(!this._windowRef&&!this._isDisabled()){const{windowRef:i,transition$:r}=this._popupService.open(this.ngbPopover,n,this.animation);this._windowRef=i,this._windowRef.instance.animation=this.animation,this._windowRef.instance.title=this.popoverTitle,this._windowRef.instance.context=n,this._windowRef.instance.popoverClass=this.popoverClass,this._windowRef.instance.id=this._ngbPopoverWindowId,this._renderer.setAttribute(this._elementRef.nativeElement,"aria-describedby",this._ngbPopoverWindowId),"body"===this.container&&this._document.querySelector(this.container).appendChild(this._windowRef.location.nativeElement),this._windowRef.changeDetectorRef.detectChanges(),this._windowRef.changeDetectorRef.markForCheck(),this._ngZone.onStable.pipe(mi(1)).subscribe(()=>{this._positioning.createPopper({hostElement:this._elementRef.nativeElement,targetElement:this._windowRef.location.nativeElement,placement:this.placement,appendToBody:"body"===this.container,baseClass:"bs-popover",updatePopperOptions:iq([0,8])})}),function Xz(e,t,n,i,r,s,o,a){n&&e.runOutsideAngular((e=>KSe?()=>setTimeout(()=>e(),100):e)(()=>{const u=Br(t,"keydown").pipe(wi(r),Ri(f=>f.which===Di.Escape),hr(f=>f.preventDefault())),c=Br(t,"mousedown").pipe(at(f=>{const h=f.target;return 2!==f.button&&!Yw(h,o)&&("inside"===n?Yw(h,s)&&Jz(h,a):"outside"===n?!Yw(h,s):Jz(h,a)||!Yw(h,s))}),wi(r)),d=Br(t,"mouseup").pipe(SO(c),Ri(([f,h])=>h),fU(0),wi(r));uU([u.pipe(at(f=>0)),d.pipe(at(f=>1))]).subscribe(f=>e.run(()=>i(f)))}))}(this._ngZone,this._document,this.autoClose,()=>this.close(),this.hidden,[this._windowRef.location.nativeElement]),r.subscribe(()=>this.shown.emit())}}close(){this._windowRef&&(this._renderer.removeAttribute(this._elementRef.nativeElement,"aria-describedby"),this._popupService.close(this.animation).subscribe(()=>{this._windowRef=null,this._positioning.destroy(),this.hidden.emit(),this._changeDetector.markForCheck()}))}toggle(){this._windowRef?this.close():this.open()}isOpen(){return null!=this._windowRef}ngOnInit(){this._unregisterListenersFn=function Lxe(e,t,n,i,r,s,o=0,a=0){const l=function Rxe(e,t=Ixe){const n=(e||"").trim();if(0===n.length)return[];const i=n.split(/\s+/).map(s=>s.split(":")).map(s=>{let o=t[s[0]]||s;return new kxe(o[0],o[1])}),r=i.filter(s=>s.isManual());if(r.length>1)throw"Triggers parse error: only one manual trigger is allowed";if(1===r.length&&i.length>1)throw"Triggers parse error: manual trigger can't be mixed with other triggers";return i}(n);if(1===l.length&&l[0].isManual())return()=>{};const u=function Fxe(e,t,n,i){return new en(r=>{const s=[],o=()=>r.next(!0),a=()=>r.next(!1),l=()=>r.next(!i());return n.forEach(u=>{u.open===u.close?s.push(e.listen(t,u.open,l)):s.push(e.listen(t,u.open,o),e.listen(t,u.close,a))}),()=>{s.forEach(u=>u())}})}(e,t,l,i).pipe(function Pxe(e,t,n){return i=>{let r=null;const s=i.pipe(at(l=>({open:l})),Ri(l=>{const u=n();return u===l.open||r&&r.open!==u?(r&&r.open!==l.open&&(r=null),!1):(r=l,!0)}),M4());return A4(s.pipe(Ri(l=>l.open),Mq(e)),s.pipe(Ri(l=>!l.open),Mq(t))).pipe(Ri(l=>l===r&&(r=null,l.open!==n())),at(l=>l.open))}}(o,a,i)).subscribe(c=>c?r():s());return()=>u.unsubscribe()}(this._renderer,this._elementRef.nativeElement,this.triggers,this.isOpen.bind(this),this.open.bind(this),this.close.bind(this),+this.openDelay,+this.closeDelay)}ngOnChanges({ngbPopover:n,popoverTitle:i,disablePopover:r,popoverClass:s}){s&&this.isOpen()&&(this._windowRef.instance.popoverClass=s.currentValue),(n||i||r)&&this._isDisabled()&&this.close()}ngOnDestroy(){this.close(),this._unregisterListenersFn&&this._unregisterListenersFn(),this._zoneSubscription.unsubscribe()}}return e.\u0275fac=function(n){return new(n||e)(H(fn),H(Us),H(li),H(xo),H(jxe),H(hn),H(ni),H(Mo),H(h_))},e.\u0275dir=ye({type:e,selectors:[["","ngbPopover",""]],inputs:{animation:"animation",autoClose:"autoClose",ngbPopover:"ngbPopover",popoverTitle:"popoverTitle",placement:"placement",triggers:"triggers",container:"container",disablePopover:"disablePopover",popoverClass:"popoverClass",openDelay:"openDelay",closeDelay:"closeDelay"},outputs:{shown:"shown",hidden:"hidden"},exportAs:["ngbPopover"],features:[Ht]}),e})(),Oq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({imports:[[zs]]}),e})(),Nq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({imports:[[zs]]}),e})(),kq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({imports:[[zs]]}),e})(),Iq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({imports:[[zs]]}),e})(),Rq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({imports:[[zs]]}),e})(),Fq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({}),e})();new rt("live announcer delay",{providedIn:"root",factory:function Uxe(){return 100}});let Pq=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({imports:[[zs]]}),e})();const zxe=[Hz,Uz,qz,Yz,Kz,uq,fq,gq,vq,Aq,Oq,Nq,kq,Iq,Rq,Fq,Pq];let qxe=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({imports:[zxe,Hz,Uz,qz,Yz,Kz,uq,fq,gq,vq,Aq,Oq,Nq,kq,Iq,Rq,Fq,Pq]}),e})(),Lq=(()=>{class e{transform(n,i){if(void 0===n)return n;if("string"!=typeof n||Number.isNaN(Number(n))){if("string"==typeof n)return n}else n=Number(n);return Number.isNaN(n)?"-":n<1e3?n:n.toString().slice(0,n.toString().length-3)+","+n.toString().slice(-3)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275pipe=or({name:"numFormat",type:e,pure:!0}),e})(),jq=(()=>{class e{transform(n,i){if(void 0===n)return"-";if("string"!=typeof n||Number.isNaN(Number(n))){if("string"==typeof n)return n;if(Number.isNaN(n))return"-"}else n=Number(n)+"%";return n+"%"}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275pipe=or({name:"percentageFormat",type:e,pure:!0}),e})();const Gxe=["content"];function Wxe(e,t){1&e&&(S(0,"div",32)(1,"div",33)(2,"div",34)(3,"span",35),R(4,"Loading..."),M()()()())}function Yxe(e,t){if(1&e&&(S(0,"div",36)(1,"div",37)(2,"div",1)(3,"div",38),R(4),ga(5,"numFormat"),M()(),S(6,"div",1)(7,"p"),R(8,"company statements found under MSA"),M()()(),S(9,"div",39)(10,"div",1)(11,"div",38),R(12),ga(13,"numFormat"),M()(),S(14,"div",1)(15,"p"),R(16,"MSA statements assessed by "),S(17,"span",40),R(18,"Researchers"),M()()()(),S(19,"div",37)(20,"div",1)(21,"div",38),R(22),ga(23,"percentageFormat"),M()(),S(24,"div",1)(25,"p"),R(26,"of the assessed statements meet all minimum requirements of the corresponding MSA legislation"),M()()(),S(27,"div",39)(28,"div",1)(29,"div",38),R(30),ga(31,"percentageFormat"),M()(),S(32,"div",1)(33,"p"),R(34,"of the assessed statements go beyond compliance and report additional guidelines"),M()()()()),2&e){const n=Et();$(4),ki(ma(5,4,n.numOfCompaniesUnderMSA)),$(8),ki(ma(13,6,n.numOfAssessedMSAStatements)),$(10),ki(ma(23,8,n.meetsMinRequirements)),$(8),Pr(" ",ma(31,10,n.go_beyond_compliance)," ")}}function Kxe(e,t){if(1&e){const n=Hs();S(0,"div",25)(1,"h4",41),R(2,"The Australian Modern Slavery Act"),M(),S(3,"button",42),ke("click",function(){return ur(n).$implicit.dismiss("Cross click")}),M()(),S(4,"div",28)(5,"p"),R(6,"The Australian Modern Slavery Act was passed in 2018 and required companies to produce their first statement for financial year 2019. These needed to be submitted within 3 months after year's end (in 2020) but for this first year the government provided companies with an extension due to the impact of the covid pandemic. As a result, most companies submitted statements under the Australian Act from the financial year 2020 onward."),M()(),S(7,"div",29)(8,"button",43),ke("click",function(){return ur(n).$implicit.close("Close click")}),R(9,"Close"),M()()}}let Jxe=(()=>{class e{constructor(n,i){this.dataProvider=n,this.modalService=i,this.year="",this.legislation="both",this.isLoading=!0}ngOnInit(){}ngOnChanges(){this.updateData(this.year)}updateData(n){let i=this.dataProvider.getCompanyGroup(this.sector);return this.isLoading=!0,this.numOfAssessedMSAStatements=0,"both"===this.legislation?(this.dataProvider.getAnswers(this.dataProvider.metrics.modern_slavery_statement,[new J("year",this.year),new J("company_group",i),new J("value",["Yes - UK Modern Slavery Act","Yes - Australian Modern Slavery Act"])]).subscribe(r=>{this.numOfCompaniesUnderMSA=r.length,this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new J("year",this.year),new J("value","Yes"),new J("company_group",i)]).subscribe(s=>{this.numOfAssessedMSAStatements=s.length,this.dataProvider.getAnswers(this.dataProvider.metrics.meet_aus_min_requirements,[new J("year",this.year),new J("value","Yes"),new J("company_group",i)]).subscribe(o=>{o=o.filter(a=>s.findIndex(l=>l.company==a.company&&l.year==a.year)>=0),this.meetsMinRequirements=o.length,this.dataProvider.getAnswers(this.dataProvider.metrics.meet_uk_min_requirements,[new J("year",this.year),new J("value","Yes"),new J("company_group",i)]).subscribe(a=>{a=a.filter(l=>s.findIndex(u=>u.company==l.company&&u.year==l.year)>=0&&o.findIndex(u=>u.company==l.company&&u.year==l.year)<0),this.meetsMinRequirements=Math.round(100*(this.meetsMinRequirements+a.length)/this.numOfAssessedMSAStatements),this.dataProvider.getAnswers(this.dataProvider.metrics.msa_beyond_compliance,[new J("year",this.year),new J("value","Yes"),new J("company_group",i)]).subscribe(l=>{l=l.filter(u=>s.findIndex(c=>c.company==u.company&&c.year==u.year)>=0),this.go_beyond_compliance=Math.round(100*l.length/this.numOfAssessedMSAStatements)},l=>console.log(l),()=>this.isLoading=!1)})})})}),n):"uk"===this.legislation?(this.dataProvider.getAnswers(this.dataProvider.metrics.modern_slavery_statement,[new J("year",this.year),new J("value",["Yes - UK Modern Slavery Act"]),new J("company_group",i)]).subscribe(r=>{this.numOfCompaniesUnderMSA=r.length,this.dataProvider.getAnswers(this.dataProvider.metrics.uk_msa_statement_assessed,[new J("year",this.year),new J("value","Yes"),new J("company_group",i)]).subscribe(s=>{this.numOfAssessedMSAStatements=s.length,this.dataProvider.getAnswers(this.dataProvider.metrics.meet_uk_min_requirements,[new J("year",this.year),new J("value","Yes"),new J("company_group",i)]).subscribe(o=>{o=o.filter(a=>s.findIndex(l=>l.company==a.company&&l.year==a.year)>=0),this.meetsMinRequirements=Math.round(o.length/this.numOfAssessedMSAStatements*100),this.dataProvider.getAnswers(this.dataProvider.metrics.uk_beyond_compliance_disclosure_rate,[new J("year",this.year),new J("value",new mO(1,"")),new J("company_group",i)]).subscribe(a=>{a=a.filter(l=>s.findIndex(u=>u.company==l.company&&u.year==l.year)>=0),this.go_beyond_compliance=Math.round(100*a.length/this.numOfAssessedMSAStatements)},a=>console.log(a),()=>this.isLoading=!1)})})}),n):(""!==this.year&&"latest"!==this.year&&Number(this.year)<2020&&(this.openMessage(),this.year=2020),this.dataProvider.getAnswers(this.dataProvider.metrics.modern_slavery_statement,[new J("year",this.year),new J("value",["Yes - Australian Modern Slavery Act"]),new J("company_group",i)]).subscribe(r=>{this.numOfCompaniesUnderMSA=r.length,this.dataProvider.getAnswers(this.dataProvider.metrics.aus_msa_statement_assessed,[new J("year",this.year),new J("value","Yes"),new J("company_group",i)]).subscribe(s=>{this.numOfAssessedMSAStatements=s.length,this.dataProvider.getAnswers(this.dataProvider.metrics.meet_aus_min_requirements,[new J("year",this.year),new J("value","Yes"),new J("company_group",i)]).subscribe(o=>{o=o.filter(a=>s.findIndex(l=>l.company==a.company&&l.year==a.year)>=0),this.meetsMinRequirements=Math.round(o.length/this.numOfAssessedMSAStatements*100),this.dataProvider.getAnswers(this.dataProvider.metrics.aus_beyond_compliance_disclosure_rate,[new J("year",this.year),new J("value",new mO(1,"")),new J("company_group",i)]).subscribe(a=>{a=a.filter(l=>s.findIndex(u=>u.company==l.company&&u.year==l.year)>=0),this.go_beyond_compliance=Math.round(100*a.length/this.numOfAssessedMSAStatements)},a=>console.log(a),()=>this.isLoading=!1)})})}),this.year)}openMessage(){this.modalService.open(this.content,{centered:!0})}}return e.\u0275fac=function(n){return new(n||e)(H(Fi),H(pq))},e.\u0275cmp=Nt({type:e,selectors:[["key-findings-section"]],viewQuery:function(n,i){if(1&n&&zb(Gxe,5),2&n){let r;Tn(r=On())&&(i.content=r.first)}},inputs:{sector:"sector"},features:[Ht],decls:50,vars:7,consts:[[1,"section","mt-5","bg-neutral-grey","p-4"],[1,"row"],[1,"col-md-4"],[1,"title"],[1,"col-md-8","ms-md-auto"],[1,"row","ps-3","pe-3","pt-md-0","pt-2"],["aria-label","Default select example",1,"msa-form-select","bg-neutral-grey","ms-md-auto","me-3","mb-md-0","mb-1",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange"],["select",""],["value","","selected",""],["value","latest"],["value","2021"],["value","2020"],["value","2019"],["value","2018"],["value","2017"],["value","2016"],["value","2015"],["aria-label","Default select example",1,"msa-form-select","bg-neutral-grey",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],["class","row mt-3","style","height: 150px",4,"ngIf"],["class","row mt-3 mb-3",4,"ngIf"],["id","AUS-MSA","tabindex","-1","aria-labelledby","AUS-MSA-Label","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","AUS-MSA-Label",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary"],["content",""],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"],[1,"row","mt-3","mb-3"],[1,"col-md-6","pe-md-2"],[1,"msa-primary-info"],[1,"col-md-6"],["placement","top","ngbPopover","As the research effort is ongoing, this is a living project and the dashboard updates as and when new data is contributed to WikiRate.",1,"tooltip-item"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],["type","button",1,"btn","btn-light",3,"click"]],template:function(n,i){if(1&n){const r=Hs();S(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),R(4,"Key Findings"),M()(),S(5,"div",4)(6,"div",5)(7,"select",6,7),ke("ngModelChange",function(o){return i.year=o})("ngModelChange",function(o){return ur(r),So(8).value=i.updateData(o)}),S(9,"option",8),R(10,"all years"),M(),S(11,"option",9),R(12,"latest"),M(),S(13,"option",10),R(14,"2021"),M(),S(15,"option",11),R(16,"2020"),M(),S(17,"option",12),R(18,"2019"),M(),S(19,"option",13),R(20,"2018"),M(),S(21,"option",14),R(22,"2017"),M(),S(23,"option",15),R(24,"2016"),M(),S(25,"option",16),R(26,"2015"),M()(),S(27,"select",17),ke("ngModelChange",function(o){return i.legislation=o})("change",function(){return i.updateData(i.year)}),S(28,"option",18),R(29,"Legislation"),M(),S(30,"option",19),R(31,"UK MSA"),M(),S(32,"option",19),R(33,"AUS MSA"),M()()()()(),Ne(34,Wxe,5,0,"div",20),Ne(35,Yxe,35,12,"div",21),M(),S(36,"div",22)(37,"div",23)(38,"div",24)(39,"div",25)(40,"h5",26),R(41,"Australian Modern Slavery Act"),M(),Me(42,"button",27),M(),S(43,"div",28),R(44," The Australian Modern Slavery Act was passed in 2018 and required companies to produce their first statement for financial year 2019. These needed to be submitted within 3 months after year's end (in 2020) but for this first year the government provided companies with an extension due to the impact of the covid pandemic. As a result, most companies submitted statements under the Australian Act from the financial year 2020 onward. "),M(),S(45,"div",29)(46,"button",30),R(47,"OK"),M()()()()(),Ne(48,Kxe,10,0,"ng-template",null,31,Ao)}2&n&&($(7),U("ngModel",i.year),$(20),U("ngModel",i.legislation),$(1),U("ngValue","both"),$(2),U("ngValue","uk"),$(2),U("ngValue","aus"),$(2),U("ngIf",i.isLoading),$(1),U("ngIf",!i.isLoading))},directives:[Gs,ba,Io,wa,Da,zn,Tq],pipes:[Lq,jq],styles:[""]}),e})();const Xxe=JSON.parse('{"$schema":"https://vega.github.io/schema/vega/v5.json","description":"Companies meeting minimum requirements","width":190,"height":180,"padding":10,"signals":[{"name":"hoverValue","value":null,"on":[{"events":"arc:mouseover, @legendLabel:mouseover, @legendSymbol:mouseover","update":"datum.value"},{"events":"arc:mouseout, @legendLabel:mouseout, @legendSymbol:mouseout","update":"null"}]},{"name":"hoverOpacity","update":"if(hoverValue, 0.5, 1)","value":1}],"data":[{"name":"counts","values":[{"value":"Met","count":100,"sum_count":147},{"value":"Not Met","count":143,"sum_count":147}],"transform":[{"type":"pie","field":"count","sort":false},{"type":"formula","as":"filter","expr":"{ value: [datum.value] }"},{"type":"window","ops":["sum"],"fields":["count"],"frame":[null,null]},{"type":"formula","as":"percentage","expr":"format(datum.count / datum.sum_count, \'.0%\')"},{"type":"collect","sort":{"field":"value"}},{"type":"formula","expr":"datum.count + \' out of \' + datum.sum_count + \' statements\'","as":"count_label"}]}],"marks":[{"type":"arc","from":{"data":"counts"},"encode":{"enter":{"fill":{"scale":"color","field":"value"},"x":{"value":100},"y":{"value":100},"tooltip":{"field":"count_label"}},"update":{"startAngle":{"field":"startAngle"},"endAngle":{"field":"endAngle"},"padAngle":{"value":0},"innerRadius":{"value":0},"outerRadius":{"value":120},"cornerRadius":{"value":0},"opacity":{"signal":"if(hoverValue == datum.value, 1, hoverOpacity)"}},"hover":{"opacity":{"value":1},"cursor":{"value":"pointer"}}}},{"type":"text","from":{"data":"counts"},"encode":{"enter":{"x":{"value":100},"y":{"value":100},"radius":{"value":50},"fontWeight":{"value":"bold"},"fontSize":{"value":15},"theta":{"signal":"(datum.startAngle + datum.endAngle)/2"},"fill":{"value":"white"},"align":{"value":"center"},"baseline":{"value":"middle"},"text":{"field":"percentage"}}}}],"legends":[{"fill":"color","type":"symbol","encode":{"labels":{"name":"legendLabel","interactive":true,"update":{"fontSize":{"value":9},"fontWeight":[{"test":"hoverValue == datum.label","value":"bold"},{"value":400}]}},"symbols":{"name":"legendSymbol","interactive":true}}}],"scales":[{"name":"color","type":"ordinal","range":["#000028","#FF9300"],"domain":["Not Met","Met"]}]}'),Qxe=JSON.parse('{"$schema":"https://vega.github.io/schema/vega/v5.json","description":"Modern Slavery Supply Chain Policies","width":250,"height":220,"padding":10,"signals":[{"name":"hoverValue","value":null,"on":[{"events":"arc:mouseover, @legendLabel:mouseover, @legendSymbol:mouseover","update":"datum.value"},{"events":"arc:mouseout, @legendLabel:mouseout, @legendSymbol:mouseout","update":"null"}]},{"name":"hoverOpacity","update":"if(hoverValue, 0.5, 1)","value":1}],"data":[{"name":"counts","source":"answers","transform":[{"type":"aggregate","groupby":["value"],"ops":["count"],"fields":["count"],"as":["count"]},{"type":"pie","field":"count","sort":false},{"type":"formula","as":"filter","expr":"{ value: [datum.value] }"},{"type":"window","ops":["sum"],"fields":["count"],"frame":[null,null]},{"type":"formula","as":"percentage","expr":"format(datum.count / datum.sum_count, \'.0%\')"},{"type":"collect","sort":{"field":"value"}},{"type":"formula","expr":"datum.count + \' out of \' + datum.sum_count + \' statements\'","as":"count_label"}]}],"marks":[{"type":"arc","from":{"data":"counts"},"encode":{"enter":{"fill":{"scale":"color","field":"value"},"x":{"value":100},"y":{"value":100},"tooltip":{"field":"count_label"}},"update":{"startAngle":{"field":"startAngle"},"endAngle":{"field":"endAngle"},"padAngle":{"value":0},"innerRadius":{"value":0},"outerRadius":{"value":120},"cornerRadius":{"value":0},"opacity":{"signal":"if(hoverValue == datum.value, 1, hoverOpacity)"}},"hover":{"opacity":{"value":1},"cursor":{"value":"pointer"}}}},{"type":"text","from":{"data":"counts"},"encode":{"enter":{"x":{"value":100},"y":{"value":100},"radius":{"value":50},"fontWeight":{"value":"bold"},"fontSize":{"value":15},"theta":{"signal":"(datum.startAngle + datum.endAngle)/2"},"fill":{"value":"white"},"align":{"value":"center"},"baseline":{"value":"middle"},"text":{"field":"percentage"}}}}],"legends":[{"fill":"color","type":"symbol","encode":{"labels":{"name":"legendLabel","interactive":true,"update":{"fontSize":{"value":13},"fontWeight":[{"test":"hoverValue == datum.label","value":"bold"},{"value":400}]}},"symbols":{"name":"legendSymbol","interactive":true}}}],"scales":[{"name":"color","type":"ordinal","range":["#000028","#FF9300"],"domain":["direct","beyond tier 1"]}]}'),Zxe=JSON.parse('{"$schema":"https://vega.github.io/schema/vega/v5.json","description":"Risk assessment tool and risks identified","width":250,"height":180,"signals":[{"name":"colors","value":{"orange":"#FF9300","purple":"#932191","orange_purple":"#ad3d6f","dark_orange":"#c7594b","deep_orange":"#e17327"}},{"name":"hoverValue","value":null,"on":[{"events":"arc:mouseover, @legendLabel:mouseover, @legendSymbol:mouseover","update":"datum.value"},{"events":"arc:mouseout, @legendLabel:mouseout, @legendSymbol:mouseout","update":"null"}]},{"name":"hoverOpacity","update":"if(hoverValue, 0.5, 1)","value":1}],"data":[{"name":"groups","values":[{"name":"Performs assessment and identifies risks"},{"name":"Performs assessment but does not identify risks"},{"name":"Does not perform assessment but identifies risks"},{"name":"Does not perform assessment or identify risks"}],"transform":[{"type":"window","ops":["row_number"],"as":["seq"]}]},{"name":"counts","source":"answers","transform":[{"type":"aggregate","groupby":["value"],"ops":["count"],"fields":["count"],"as":["count"]},{"type":"lookup","from":"groups","key":"name","fields":["value"],"values":["seq"]},{"type":"collect","sort":{"field":"seq"}},{"type":"pie","field":"count","sort":false},{"type":"formula","as":"filter","expr":"{ value: [datum.value] }"},{"type":"window","ops":["sum"],"fields":["count"],"frame":[null,null]},{"type":"formula","as":"percentage","expr":"format(datum.count / datum.sum_count, \'.0%\')"},{"type":"formula","expr":"datum.count + \' out of \' + datum.sum_count + \' statements\'","as":"count_label"},{"type":"formula","as":"filter","expr":"{ value: [datum.value] }"}]}],"marks":[{"type":"arc","from":{"data":"counts"},"encode":{"enter":{"fill":{"scale":"color","field":"value"},"x":{"value":125},"y":{"value":100},"tooltip":{"field":"count_label"}},"update":{"startAngle":{"field":"startAngle"},"endAngle":{"field":"endAngle"},"padAngle":{"value":0},"innerRadius":{"value":0},"outerRadius":{"value":100},"cornerRadius":{"value":0},"opacity":{"signal":"if(hoverValue == datum.value, 1, hoverOpacity)"}},"hover":{"opacity":{"value":1},"cursor":{"value":"pointer"}}}},{"type":"text","from":{"data":"counts"},"encode":{"enter":{"x":{"value":125},"y":{"value":100},"radius":{"value":50},"theta":{"signal":"(datum.startAngle + datum.endAngle)/2"},"fill":{"value":"white"},"fontWeight":{"value":"bold"},"fontSize":{"value":15},"align":{"value":"center"},"baseline":{"value":"middle"},"text":{"field":"percentage"}}}}],"legends":[{"fill":"color","type":"symbol","orient":"top","encode":{"labels":{"name":"legendLabel","interactive":true,"update":{"limit":{"value":0},"fontSize":{"value":12},"fontWeight":[{"test":"hoverValue == datum.label","value":"bold"},{"value":400}]}},"symbols":{"name":"legendSymbol","interactive":true}}}],"scales":[{"name":"color","type":"ordinal","range":{"signal":"[colors.orange, colors.deep_orange, colors.orange_purple, colors.purple]"},"domain":{"signal":"pluck(data(\'groups\'), \'name\')"}}]}'),Bq=JSON.parse('{"$schema":"https://vega.github.io/schema/vega/v5.json","description":"A nested bar chart example, with bars grouped by category.","width":350,"height":200,"signals":[{"name":"barHeight","value":"15"},{"name":"colors","value":{"orange":"#FF9300","red":"#FE0000","blue":"#4169e1","navy":"#000028","yellow":"#FFDC00"}},{"name":"barTitle","value":null,"on":[{"events":"rect:mouseover, text:mouseover","update":"datum.title"},{"events":"rect:mouseout, text:mouseout","update":"null"}]}],"data":[{"name":"assessed","url":"https://wikirate.org/~12602618+Answer.json?limit=0&filter[value]=Yes&filter[year]=latest&view=answer_list"},{"name":"signed","url":"https://wikirate.org/Business_Human_Rights_Resource_Centre+MSA_statement_signed_binary+answer/answer_list.json?limit=0&filter[status]=known&filter[year]=latest","transform":[{"type":"lookup","from":"assessed","key":"company","fields":["company"],"values":["value"],"as":["assessed"]},{"type":"filter","expr":"datum.assessed == \'Yes\'"},{"type":"aggregate","groupby":["value"]},{"type":"impute","key":"value","keyvals":["Yes"],"field":"count","value":0},{"type":"joinaggregate","fields":["count"],"ops":["sum"]},{"type":"filter","expr":"datum.value == \'Yes\'"}]},{"name":"approved","url":"https://wikirate.org/Business_Human_Rights_Resource_Centre+MSA_Statement_Approval+answer/answer_list.json?limit=0&filter[year]=latest","transform":[{"type":"lookup","from":"assessed","key":"company","fields":["company"],"values":["value"],"as":["assessed"]},{"type":"filter","expr":"datum.assessed == \'Yes\'"},{"type":"aggregate","groupby":["value"]},{"type":"impute","key":"value","keyvals":["Approved by Board"],"field":"count","value":0},{"type":"joinaggregate","fields":["count"],"ops":["sum"]},{"type":"filter","expr":"datum.value == \'Approved by Board\'"}]},{"name":"homepage","url":"https://wikirate.org/Business_Human_Rights_Resource_Centre+MSA_homepage_link_archived+answer/answer_list.json?limit=0&filter[year]=latest","transform":[{"type":"lookup","from":"assessed","key":"company","fields":["company"],"values":["value"],"as":["assessed"]},{"type":"filter","expr":"datum.assessed == \'Yes\'"},{"type":"aggregate","groupby":["value"]},{"type":"impute","key":"value","keyvals":["Yes"],"field":"count","value":0},{"type":"joinaggregate","fields":["count"],"ops":["sum"]},{"type":"filter","expr":"datum.value == \'Yes\'"}]},{"name":"all","url":"https://wikirate.org/Walk_Free+Meets_Minimum_UK_MSA_Requirements+answer/answer_list.json?limit=0&filter[company_group][]=MSA_Asset_Managers&filter[year]=latest","transform":[{"type":"aggregate","groupby":["value"]},{"type":"impute","key":"value","keyvals":["Yes"],"field":"count","value":0},{"type":"joinaggregate","fields":["count"],"ops":["sum"]},{"type":"filter","expr":"datum.value == \'Yes\'"}]},{"name":"metrics","values":[{"seq":1,"metric":"Business_Human_Rights_Resource_Centre+MSA_statement_signed","label":"Signed by Appropriate Person","short_label":"signed","color":0,"filter_value":["Signed by CEO","Signed by Director","Signed by Managing Director","Signed by Chairman"]},{"seq":2,"metric":"Business_Human_Rights_Resource_Centre+MSA_Statement_Approval","label":"Board Approval","short_label":"approved","color":0,"filter_value":["Approved by Board"]},{"seq":3,"metric":"Walk_Free+MSA_statement_homepage_link","label":"Homepage Link","short_label":"homepage","color":0,"filter_value":["Yes"]}]},{"name":"counts","source":["signed","approved","homepage"],"transform":[{"type":"window","ops":["row_number"],"as":["seq"]},{"type":"lookup","from":"metrics","key":"seq","fields":["seq"],"values":["label","metric","color","filter_value"],"as":["title","wikirate_page","color","filter_value"]},{"type":"formula","expr":"datum.count/datum.sum_count","as":"percentage"},{"type":"formula","expr":"format(datum.count / datum.sum_count, \'.0%\')","as":"percent_label"},{"type":"formula","expr":"datum.count + \' out of \' + datum.sum_count + \' statements\'","as":"count_label"},{"type":"formula","expr":"{ value: datum.filter_value }","as":"filter"}]}],"scales":[{"name":"xscale","domain":[0,1],"zero":true,"type":"linear","range":"width"},{"name":"yscale","range":"height","domain":{"data":"counts","field":"title"},"type":"band","padding":0.4},{"name":"color","type":"linear","domain":[0,3],"range":{"signal":"[colors.orange, colors.yellow, colors.navy, colors.blue]"}}],"marks":[{"type":"rect","from":{"data":"counts"},"encode":{"update":{"x":{"value":0},"x2":{"scale":"xscale","value":1},"y":{"scale":"yscale","field":"title"},"height":{"signal":"barHeight"},"fill":{"signal":"colors.navy"},"tooltip":{"field":"count_label"},"opacity":{"signal":"if(barTitle == datum.title, 0.5, 1)"}},"hover":{"cursor":{"value":"pointer"}}}},{"type":"rect","from":{"data":"counts"},"encode":{"update":{"x":{"value":0},"x2":{"scale":"xscale","field":"percentage"},"y":{"scale":"yscale","field":"title"},"height":{"signal":"barHeight"},"fill":{"scale":"color","field":"color"},"tooltip":{"field":"count_label"}},"hover":{"cursor":{"value":"pointer"}}}},{"type":"text","from":{"data":"counts"},"encode":{"update":{"fontSize":{"value":15},"font":{"value":"GothamNarrow"},"x":{"scale":"xscale","value":1},"y":{"scale":"yscale","field":"title","offset":-3},"baseline":{"value":"bottom"},"align":{"value":"right"},"text":{"field":"percent_label"},"fontWeight":{"value":"bold"},"fill":{"scale":"color","signal":"if(barTitle == datum.title, datum.color, 2)"}},"hover":{"cursor":{"value":"pointer"}}}},{"type":"text","from":{"data":"counts"},"encode":{"update":{"fontSize":{"value":15},"font":{"value":"GothamNarrow"},"x":{"value":0},"y":{"scale":"yscale","field":"title","offset":-3},"text":{"field":"title"},"baseline":{"value":"bottom"},"fontWeight":{"value":"bold"},"fill":{"signal":"colors.navy"}},"hover":{"cursor":{"value":"pointer"}}}}]}'),eAe=JSON.parse('{"$schema":"https://vega.github.io/schema/vega/v5.json","description":"Risk Management","width":300,"padding":{"right":5},"signals":[{"name":"totalAnswers","update":"data(\'answers\').length"},{"name":"numGroups","update":"data(\'groups\').length"},{"name":"barHeight","value":15},{"name":"height","update":"numGroups * (barHeight + 15)+ 200"},{"name":"colors","value":{"orange":"#FF9300","red":"#FE0000","blue":"#0037F1","navy":"#000028","yellow":"#FFDC00","orange_purple":"#c7594b"}},{"name":"barOver","value":{},"on":[{"events":"rect:mouseover, text:mouseover","update":"datum"},{"events":"rect:mouseout, text:mouseout","update":"{}"}]}],"data":[{"name":"assessed","url":"https://wikirate.org/Walk_Free+UK_MSA_statement_assessed+Answer.json?filter%5Bnot_ids%5D=&filter%5Bcompany_name%5D=&view=answer_list&filter[value][]=Yes&limit=0&filter[year]=latest"},{"name":"answers","url":"https://wikirate.org/Walk_Free+MSA_risk_management_revised+answer/answer_list.json?limit=0&filter[year]=latest","transform":[{"type":"lookup","from":"assessed","key":"company","fields":["company"],"values":["value"],"as":["assessed"]},{"type":"filter","expr":"datum.value != \'\' && datum.assessed == \'Yes\'"},{"type":"formula","expr":"split(datum.value, \', \')","as":"value_array"}]},{"name":"subgroups","values":[{"key":"(self- reporting)","label":"Self reporting","color":0,"seq":1},{"key":"(independent)","label":"Independent","color":1,"seq":2}],"transform":[{"type":"window","ops":["row_number"],"as":["seq"]}]},{"name":"groups","values":[{"title":"Audits of suppliers","term":"Audits of suppliers","seq":1},{"title":"On-site visits","term":"On-site visits","seq":2}],"transform":[{"type":"window","ops":["row_number"],"as":["seq"]}]},{"name":"counts","source":"answers","transform":[{"type":"flatten","fields":["value_array"],"as":["value"]},{"type":"aggregate","ops":["count"],"groupby":["value"]},{"type":"formula","as":"term","expr":"replace(datum.value, / \\\\(.*/, \'\')"},{"type":"formula","as":"parens","expr":"replace(datum.value, /^[^\\\\(]*/, \'\')"},{"type":"formula","expr":"if(datum.count, datum.count, 0)","as":"count"},{"type":"lookup","from":"groups","key":"term","fields":["term"],"values":["seq"],"as":["group_seq"]},{"type":"filter","expr":"datum.group_seq != null"},{"type":"lookup","from":"subgroups","key":"key","fields":["parens"],"values":["seq","label","color"],"as":["subgroup_seq","subgroup_label","color"]},{"type":"collect","sort":{"field":["group_seq","subgroup_seq"]}},{"type":"formula","expr":"datum.count + \' out of \' + totalAnswers + \' statements\'","as":"count_label"},{"type":"formula","expr":"format(datum.count / totalAnswers, \'.0%\')","as":"percent_label"},{"type":"formula","expr":"datum.term + \' \' + datum.parens","as":"title"},{"type":"formula","as":"filter","expr":"{ value: [datum.value] }"}]}],"scales":[{"name":"xscale","domain":[0,{"signal":"totalAnswers"}],"zero":true,"type":"linear","range":"width"},{"name":"ygroupscale","range":"height","domain":{"data":"counts","field":"term"},"type":"band","padding":0.4},{"name":"color","type":"ordinal","domain":{"data":"counts","field":"subgroup_label"},"range":{"signal":"[colors.orange, colors.orange_purple, colors.yellow, colors.navy]"}},{"name":"textColor","type":"linear","domain":[0,3],"range":{"signal":"[colors.orange, colors.orange_purple, colors.yellow, colors.navy]"}}],"marks":[{"type":"group","from":{"facet":{"name":"faceted_counts","groupby":"term","data":"counts"}},"encode":{"enter":{"fill":{"value":"grey"},"y":{"scale":"ygroupscale","field":"term"}}},"scales":[{"name":"yscale","type":"band","range":"height","domain":{"data":"faceted_counts","field":"title"},"padding":0.1}],"signals":[{"name":"height","update":"bandwidth(\'ygroupscale\')"}],"marks":[{"type":"rect","from":{"data":"faceted_counts"},"encode":{"update":{"x":{"value":0},"x2":{"scale":"xscale","signal":"totalAnswers"},"y":{"scale":"yscale","field":"title"},"height":{"signal":"barHeight"},"fill":{"signal":"colors.navy"},"tooltip":{"field":"count_label"},"opacity":{"signal":"if(barOver.title == datum.title, 0.5, 1)"}},"hover":{"cursor":{"value":"pointer"}}}},{"type":"rect","from":{"data":"faceted_counts"},"encode":{"update":{"x":{"value":0},"x2":{"scale":"xscale","field":"count"},"y":{"scale":"yscale","field":"title"},"height":{"signal":"barHeight"},"fill":{"scale":"textColor","field":"color"},"tooltip":{"field":"percent_label"}},"hover":{"cursor":{"value":"pointer"}}}},{"name":"nocounts","type":"text","from":{"data":"faceted_counts"},"encode":{"update":{"x":{"value":5},"y":{"scale":"yscale","field":"title","offset":2},"baseline":{"value":"top"},"text":{"signal":"if(datum.count == 0, \'None\', \'\')"},"fill":{"value":"white"},"fontStyle":{"value":"italic"}}}},{"type":"text","from":{"data":"faceted_counts"},"encode":{"update":{"fontSize":{"value":15},"font":{"value":"GothamNarrow"},"x":{"scale":"xscale","signal":"totalAnswers","offset":4},"y":{"scale":"yscale","field":"title","offset":2},"baseline":{"value":"top"},"text":{"field":"percent_label"},"fontWeight":{"value":"bold"},"fill":{"scale":"textColor","signal":"if(barOver.title == datum.title, datum.color, 3)"}},"hover":{"cursor":{"value":"pointer"}}}}]},{"type":"text","from":{"data":"groups"},"encode":{"update":{"fontSize":{"value":15},"font":{"value":"GothamNarrow"},"x":{"value":0},"y":{"scale":"ygroupscale","field":"term","offset":-2},"text":{"field":"title"},"baseline":{"value":"bottom"},"fontWeight":{"value":"bold"},"fill":{"signal":"colors.navy"}}}}],"legends":[{"fill":"color","type":"symbol","orient":"none","direction":"horizontal","columnPadding":20,"rowPadding":20,"labelFontSize":{"value":25},"encode":{"legend":{"update":{"fontSize":{"value":13},"x":{"value":0},"y":{"offset":-10}}},"labels":{"update":{"fontSize":{"value":13}}}}}]}'),tAe=JSON.parse('{"$schema":"https://vega.github.io/schema/vega/v5.json","description":"An example of treemap layout for hierarchical data.","width":960,"height":500,"padding":2.5,"autosize":"none","data":[{"name":"tree","values":[],"transform":[{"type":"stratify","key":"id","parentKey":"parent"},{"type":"treemap","field":"size","sort":{"field":"value"},"round":true,"method":"squarify","ratio":5,"size":[{"signal":"width"},{"signal":"height"}]}]},{"name":"nodes","source":"tree","transform":[{"type":"filter","expr":"datum.children"},{"type":"lookup","from":"tree","key":"id","fields":["id"],"values":["alt_name"],"as":["alt_name"]}]},{"name":"leaves","source":"tree","transform":[{"type":"filter","expr":"!datum.children"},{"type":"lookup","from":"tree","key":"id","fields":["parent"],"values":["name"],"as":["parent_name"]}]}],"scales":[{"name":"color","type":"ordinal","domain":{"data":"nodes","field":"alt_name"},"range":["#FF9300","#7f7f93","#ffc97f","#DDDDE3"]},{"name":"size","type":"ordinal","domain":[0,1,2,3],"range":[150,28,0,9]},{"name":"opacity","type":"ordinal","domain":[0,1,2,3],"range":[0.15,0.5,0.8,1]}],"marks":[{"type":"rect","from":{"data":"nodes"},"interactive":false,"encode":{"enter":{"fill":{"scale":"color","field":"name"}},"update":{"x":{"field":"x0"},"y":{"field":"y0"},"x2":{"field":"x1"},"y2":{"field":"y1"}}}},{"type":"rect","from":{"data":"leaves"},"encode":{"enter":{"stroke":{"value":"#fff"}},"update":{"x":{"field":"x0"},"y":{"field":"y0"},"x2":{"field":"x1"},"y2":{"field":"y1"},"fill":{"value":"transparent"},"tooltip":{"signal":"{\'title\': datum.name, \'Turnover Range\': datum.parent_name,\'No. of statements\': datum.size}"}},"hover":{"fill":{"value":"yellow"}}}},{"type":"text","from":{"data":"nodes"},"interactive":false,"encode":{"enter":{"font":{"value":"GothamNarrow"},"align":{"value":"center"},"baseline":{"value":"middle"},"fill":{"value":"#000"},"text":{"field":"name"},"fontSize":{"scale":"size","field":"depth"},"fillOpacity":{"scale":"opacity","field":"depth"}},"update":{"x":{"signal":"0.5 * (datum.x0 + datum.x1)"},"y":{"signal":"0.5 * (datum.y0 + datum.y1)"}}}}]}'),nAe=JSON.parse('{"$schema":"https://vega.github.io/schema/vega/v5.json","description":"An example of treemap layout for hierarchical data.","width":960,"height":500,"padding":2.5,"autosize":"none","data":[{"name":"tree","values":[],"transform":[{"type":"stratify","key":"id","parentKey":"parent"},{"type":"treemap","field":"size","sort":{"field":"value"},"round":true,"method":"binary","ratio":1.6,"size":[{"signal":"width"},{"signal":"height"}]}]},{"name":"nodes","source":"tree","transform":[{"type":"filter","expr":"datum.children"}]},{"name":"leaves","source":"tree","transform":[{"type":"filter","expr":"!datum.children"}]}],"scales":[{"name":"color","type":"ordinal","domain":{"data":"nodes","field":"name"},"range":["#FF9300","#7f7f93","#ffc97f","#DDDDE3"]},{"name":"size","type":"ordinal","domain":[0,1,2,3],"range":[150,28,20,14]},{"name":"opacity","type":"ordinal","domain":[0,1,2,3],"range":[0.15,0.5,0.8,1]}],"marks":[{"type":"rect","from":{"data":"nodes"},"interactive":false,"encode":{"enter":{"fill":{"scale":"color","field":"name"}},"update":{"x":{"field":"x0"},"y":{"field":"y0"},"x2":{"field":"x1"},"y2":{"field":"y1"}}}},{"type":"rect","from":{"data":"leaves"},"encode":{"enter":{"stroke":{"value":"#fff"}},"update":{"x":{"field":"x0"},"y":{"field":"y0"},"x2":{"field":"x1"},"y2":{"field":"y1"},"fill":{"value":"transparent"},"tooltip":{"signal":"{\'title\': datum.name,\'No. of statements\': datum.size}"}},"hover":{"fill":{"value":"yellow"}}}},{"type":"text","from":{"data":"nodes"},"interactive":false,"encode":{"enter":{"font":{"value":"GothamNarrow"},"align":{"value":"center"},"baseline":{"value":"middle"},"fill":{"value":"#000"},"text":{"field":"name"},"fontSize":{"scale":"size","field":"depth"},"fillOpacity":{"scale":"opacity","field":"depth"}},"update":{"x":{"signal":"0.5 * (datum.x0 + datum.x1)"},"y":{"signal":"0.5 * (datum.y0 + datum.y1)"}}}}]}');var e,iAe=(e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])})(t,n)},function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),rAe=Object.prototype.hasOwnProperty;function eD(e,t){return rAe.call(e,t)}function gN(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var i=[];for(var r in e)eD(e,r)&&i.push(r);return i}function Ks(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function mN(e){for(var i,t=0,n=e.length;t<n;){if(!((i=e.charCodeAt(t))>=48&&i<=57))return!1;t++}return!0}function Vu(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function $q(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function _N(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(_N(e[t]))return!0}else if("object"==typeof e)for(var i=gN(e),r=i.length,s=0;s<r;s++)if(_N(e[i[s]]))return!0;return!1}function Hq(e,t){var n=[e];for(var i in t){var r="object"==typeof t[i]?JSON.stringify(t[i],null,2):t[i];void 0!==r&&n.push(i+": "+r)}return n.join("\n")}var Uq=function(e){function t(n,i,r,s,o){var a=this.constructor,l=e.call(this,Hq(n,{name:i,index:r,operation:s,tree:o}))||this;return l.name=i,l.index=r,l.operation=s,l.tree=o,Object.setPrototypeOf(l,a.prototype),l.message=Hq(n,{name:i,index:r,operation:s,tree:o}),l}return iAe(t,e),t}(Error),qn=Uq,sAe=Ks,xg={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=tD(n,this.path);i&&(i=Ks(i));var r=qf(n,{op:"remove",path:this.from}).removed;return qf(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=tD(n,this.from);return qf(n,{op:"add",path:this.path,value:Ks(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:K_(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},oAe={add:function(e,t,n){return mN(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:xg.move,copy:xg.copy,test:xg.test,_get:xg._get};function tD(e,t){if(""==t)return e;var n={op:"_get",path:t};return qf(e,n),n.value}function qf(e,t,n,i,r,s){if(void 0===n&&(n=!1),void 0===i&&(i=!0),void 0===r&&(r=!0),void 0===s&&(s=0),n&&("function"==typeof n?n(t,0,e,t.path):iD(t,0)),""===t.path){var o={newDocument:e};if("add"===t.op)return o.newDocument=t.value,o;if("replace"===t.op)return o.newDocument=t.value,o.removed=e,o;if("move"===t.op||"copy"===t.op)return o.newDocument=tD(e,t.from),"move"===t.op&&(o.removed=e),o;if("test"===t.op){if(o.test=K_(e,t.value),!1===o.test)throw new qn("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o.newDocument=e,o}if("remove"===t.op)return o.removed=e,o.newDocument=null,o;if("_get"===t.op)return t.value=e,o;if(n)throw new qn("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,t,e);return o}i||(e=Ks(e));var l=(t.path||"").split("/"),u=e,c=1,d=l.length,f=void 0,h=void 0,p=void 0;for(p="function"==typeof n?n:iD;;){if((h=l[c])&&-1!=h.indexOf("~")&&(h=$q(h)),r&&("__proto__"==h||"prototype"==h&&c>0&&"constructor"==l[c-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===f&&(void 0===u[h]?f=l.slice(0,c).join("/"):c==d-1&&(f=t.path),void 0!==f&&p(t,0,e,f)),c++,Array.isArray(u)){if("-"===h)h=u.length;else{if(n&&!mN(h))throw new qn("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,t,e);mN(h)&&(h=~~h)}if(c>=d){if(n&&"add"===t.op&&h>u.length)throw new qn("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,t,e);if(!1===(o=oAe[t.op].call(t,u,h,e)).test)throw new qn("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}}else if(c>=d){if(!1===(o=xg[t.op].call(t,u,h,e)).test)throw new qn("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}if(u=u[h],n&&c<d&&(!u||"object"!=typeof u))throw new qn("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,t,e)}}function nD(e,t,n,i,r){if(void 0===i&&(i=!0),void 0===r&&(r=!0),n&&!Array.isArray(t))throw new qn("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=Ks(e));for(var s=new Array(t.length),o=0,a=t.length;o<a;o++)s[o]=qf(e,t[o],n,!0,r,o),e=s[o].newDocument;return s.newDocument=e,s}function aAe(e,t,n){var i=qf(e,t);if(!1===i.test)throw new qn("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function iD(e,t,n,i){if("object"!=typeof e||null===e||Array.isArray(e))throw new qn("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!xg[e.op])throw new qn("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!=typeof e.path)throw new qn("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new qn('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new qn("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new qn("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&_N(e.value))throw new qn("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var r=e.path.split("/").length,s=i.split("/").length;if(r!==s+1&&r!==s)throw new qn("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==i)throw new qn("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var a=zq([{op:"_get",path:e.from,value:void 0}],n);if(a&&"OPERATION_PATH_UNRESOLVABLE"===a.name)throw new qn("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function zq(e,t,n){try{if(!Array.isArray(e))throw new qn("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)nD(Ks(t),Ks(e),n||!0);else{n=n||iD;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(r){if(r instanceof qn)return r;throw r}}function K_(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var r,s,o,n=Array.isArray(e),i=Array.isArray(t);if(n&&i){if((s=e.length)!=t.length)return!1;for(r=s;0!=r--;)if(!K_(e[r],t[r]))return!1;return!0}if(n!=i)return!1;var a=Object.keys(e);if((s=a.length)!==Object.keys(t).length)return!1;for(r=s;0!=r--;)if(!t.hasOwnProperty(a[r]))return!1;for(r=s;0!=r--;)if(!K_(e[o=a[r]],t[o]))return!1;return!0}return e!=e&&t!=t}var yN=new WeakMap,lAe=function e(t){this.observers=new Map,this.obj=t},uAe=function e(t,n){this.callback=t,this.observer=n};function hAe(e,t){t.unobserve()}function pAe(e,t){var i,r=function cAe(e){return yN.get(e)}(e);if(r){var s=function dAe(e,t){return e.observers.get(t)}(r,t);i=s&&s.observer}else r=new lAe(e),yN.set(e,r);if(i)return i;if(i={},r.value=Ks(e),t){i.callback=t,i.next=null;var o=function(){vN(i)},a=function(){clearTimeout(i.next),i.next=setTimeout(o)};"undefined"!=typeof window&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return i.patches=[],i.object=e,i.unobserve=function(){vN(i),clearTimeout(i.next),function fAe(e,t){e.observers.delete(t.callback)}(r,i),"undefined"!=typeof window&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},r.observers.set(t,new uAe(t,i)),i}function vN(e,t){void 0===t&&(t=!1);var n=yN.get(e.object);bN(n.value,e.object,e.patches,"",t),e.patches.length&&nD(n.value,e.patches);var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function bN(e,t,n,i,r){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var s=gN(t),o=gN(e),l=!1,u=o.length-1;u>=0;u--){var d=e[c=o[u]];if(!eD(t,c)||void 0===t[c]&&void 0!==d&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:"test",path:i+"/"+Vu(c),value:Ks(d)}),n.push({op:"remove",path:i+"/"+Vu(c)}),l=!0):(r&&n.push({op:"test",path:i,value:e}),n.push({op:"replace",path:i,value:t}));else{var f=t[c];"object"==typeof d&&null!=d&&"object"==typeof f&&null!=f&&Array.isArray(d)===Array.isArray(f)?bN(d,f,n,i+"/"+Vu(c),r):d!==f&&(r&&n.push({op:"test",path:i+"/"+Vu(c),value:Ks(d)}),n.push({op:"replace",path:i+"/"+Vu(c),value:Ks(f)}))}}if(l||s.length!=o.length)for(u=0;u<s.length;u++){var c;!eD(e,c=s[u])&&void 0!==t[c]&&n.push({op:"add",path:i+"/"+Vu(c),value:Ks(t[c])})}}}function gAe(e,t,n){void 0===n&&(n=!1);var i=[];return bN(e,t,i,"",n),i}Object.assign({},$t,Qt,{JsonPatchError:Uq,deepClone:Ks,escapePathComponent:Vu,unescapePathComponent:$q});var mAe=de(564),wN=de.n(mAe);function cs(e,t,n){return e.fields=t||[],e.fname=n,e}function Gn(e){return null==e?null:e.fname}function gr(e){return null==e?null:e.fields}function qq(e){return 1===e.length?_Ae(e[0]):yAe(e)}const _Ae=e=>function(t){return t[e]},yAe=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function te(e){throw Error(e)}function xl(e){const t=[],n=e.length;let o,a,l,i=null,r=0,s="";function u(){t.push(s+e.substring(o,a)),s="",o=a+1}for(e+="",o=a=0;a<n;++a)if(l=e[a],"\\"===l)s+=e.substring(o,a),s+=e.substring(++a,++a),o=a;else if(l===i)u(),i=null,r=-1;else{if(i)continue;o===r&&'"'===l||o===r&&"'"===l?(o=a+1,i=l):"."!==l||r?"["===l?(a>o&&u(),r=o=a+1):"]"===l&&(r||te("Access path missing open bracket: "+e),r>0&&u(),r=0,o=a+1):a>o?u():o=a+1}return r&&te("Access path missing closing bracket: "+e),i&&te("Access path missing closing quote: "+e),a>o&&(a++,u()),t}function ds(e,t,n){const i=xl(e);return e=1===i.length?i[0]:e,cs((n&&n.get||qq)(i),[e],t||e)}const J_=ds("id"),mr=cs(e=>e,[],"identity"),qc=cs(()=>0,[],"zero"),Ag=cs(()=>1,[],"one"),Fo=cs(()=>!0,[],"true"),Gc=cs(()=>!1,[],"false");function vAe(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const Gq=0,DN=1,CN=2,Wq=3,Yq=4;function EN(e,t,n=vAe){let i=e||Gq;return{level(r){return arguments.length?(i=+r,this):i},error(){return i>=DN&&n(t||"error","ERROR",arguments),this},warn(){return i>=CN&&n(t||"warn","WARN",arguments),this},info(){return i>=Wq&&n(t||"log","INFO",arguments),this},debug(){return i>=Yq&&n(t||"log","DEBUG",arguments),this}}}var ie=Array.isArray;function Se(e){return e===Object(e)}const Kq=e=>"__proto__"!==e;function Mg(...e){return e.reduce((t,n)=>{for(const i in n)"signals"===i?t.signals=bAe(t.signals,n.signals):Tg(t,i,n[i],"legend"===i?{layout:1}:"style"===i||null);return t},{})}function Tg(e,t,n,i){if(!Kq(t))return;let r,s;if(Se(n)&&!ie(n))for(r in s=Se(e[t])?e[t]:e[t]={},n)i&&(!0===i||i[r])?Tg(s,r,n[r]):Kq(r)&&(s[r]=n[r]);else e[t]=n}function bAe(e,t){if(null==e)return t;const n={},i=[];function r(s){n[s.name]||(n[s.name]=1,i.push(s))}return t.forEach(r),e.forEach(r),i}function bt(e){return e[e.length-1]}function _r(e){return null==e||""===e?null:+e}const Jq=e=>t=>e*Math.exp(t),Xq=e=>t=>Math.log(e*t),Qq=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),Zq=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,rD=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function sD(e,t,n,i){const r=n(e[0]),s=n(bt(e)),o=(s-r)*t;return[i(r-o),i(s-o)]}function eG(e,t){return sD(e,t,_r,mr)}function tG(e,t){var n=Math.sign(e[0]);return sD(e,t,Xq(n),Jq(n))}function nG(e,t,n){return sD(e,t,rD(n),rD(1/n))}function iG(e,t,n){return sD(e,t,Qq(n),Zq(n))}function oD(e,t,n,i,r){const s=i(e[0]),o=i(bt(e)),a=null!=t?i(t):(s+o)/2;return[r(a+(s-a)*n),r(a+(o-a)*n)]}function SN(e,t,n){return oD(e,t,n,_r,mr)}function xN(e,t,n){const i=Math.sign(e[0]);return oD(e,t,n,Xq(i),Jq(i))}function aD(e,t,n,i){return oD(e,t,n,rD(i),rD(1/i))}function AN(e,t,n,i){return oD(e,t,n,Qq(i),Zq(i))}function rG(e){return 1+~~(new Date(e).getMonth()/3)}function sG(e){return 1+~~(new Date(e).getUTCMonth()/3)}function we(e){return null!=e?ie(e)?e:[e]:[]}function oG(e,t,n){let s,i=e[0],r=e[1];return r<i&&(s=r,r=i,i=s),s=r-i,s>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-s),i+s]}function st(e){return"function"==typeof e}function MN(e,t,n){n=n||{},t=we(t)||[];const i=[],r=[],s={},o=n.comparator||DAe;return we(e).forEach((a,l)=>{null!=a&&(i.push("descending"===t[l]?-1:1),r.push(a=st(a)?a:ds(a,null,n)),(gr(a)||[]).forEach(u=>s[u]=1))}),0===r.length?null:cs(o(r,i),Object.keys(s))}const lD=(e,t)=>(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t==t?-1:t!=t&&e==e?1:0),DAe=(e,t)=>1===e.length?CAe(e[0],t[0]):EAe(e,t,e.length),CAe=(e,t)=>function(n,i){return lD(e(n),e(i))*t},EAe=(e,t,n)=>(t.push(0),function(i,r){let s,o=0,a=-1;for(;0===o&&++a<n;)s=e[a],o=lD(s(i),s(r));return o*t[a]});function yr(e){return st(e)?e:()=>e}function TN(e,t){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(t(i),n=null),e)}}function ot(e){for(let t,n,i=1,r=arguments.length;i<r;++i)for(n in t=arguments[i],t)e[n]=t[n];return e}function Al(e,t){let i,r,s,o,n=0;if(e&&(i=e.length))if(null==t){for(r=e[n];n<i&&(null==r||r!=r);r=e[++n]);for(s=o=r;n<i;++n)r=e[n],null!=r&&(r<s&&(s=r),r>o&&(o=r))}else{for(r=t(e[n]);n<i&&(null==r||r!=r);r=t(e[++n]));for(s=o=r;n<i;++n)r=t(e[n]),null!=r&&(r<s&&(s=r),r>o&&(o=r))}return[s,o]}function aG(e,t){const n=e.length;let r,s,o,a,l,i=-1;if(null==t){for(;++i<n;)if(s=e[i],null!=s&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=l=i;++i<n;)s=e[i],null!=s&&(r>s&&(r=s,a=i),o<s&&(o=s,l=i))}else{for(;++i<n;)if(s=t(e[i],i,e),null!=s&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=l=i;++i<n;)s=t(e[i],i,e),null!=s&&(r>s&&(r=s,a=i),o<s&&(o=s,l=i))}return[a,l]}const SAe=Object.prototype.hasOwnProperty;function Fe(e,t){return SAe.call(e,t)}const uD={};function Og(e){let n,t={};function i(s){return Fe(t,s)&&t[s]!==uD}const r={size:0,empty:0,object:t,has:i,get:s=>i(s)?t[s]:void 0,set(s,o){return i(s)||(++r.size,t[s]===uD&&--r.empty),t[s]=o,this},delete(s){return i(s)&&(--r.size,++r.empty,t[s]=uD),this},clear(){r.size=r.empty=0,r.object=t={}},test(s){return arguments.length?(n=s,r):n},clean(){const s={};let o=0;for(const a in t){const l=t[a];l!==uD&&(!n||!n(l))&&(s[a]=l,++o)}r.size=o,r.empty=0,r.object=t=s}};return e&&Object.keys(e).forEach(s=>{r.set(s,e[s])}),r}function lG(e,t,n,i,r,s){if(!n&&0!==n)return s;const o=+n;let u,a=e[0],l=bt(e);l<a&&(u=a,a=l,l=u),u=Math.abs(t-a);const c=Math.abs(l-t);return u<c&&u<=o?i:c<=o?r:s}function fe(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),ot(i,n)}function Ng(e,t,n,i){let o,r=t[0],s=t[t.length-1];return r>s&&(o=r,r=s,s=o),i=void 0===i||i,((n=void 0===n||n)?r<=e:r<e)&&(i?e<=s:e<s)}function Wc(e){return"boolean"==typeof e}function Yc(e){return"[object Date]"===Object.prototype.toString.call(e)}function uG(e){return e&&st(e[Symbol.iterator])}function nn(e){return"number"==typeof e}function cG(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function be(e){return"string"==typeof e}function ON(e,t,n){e&&(e=t?we(e).map(a=>a.replace(/\\(.)/g,"$1")):we(e));const i=e&&e.length,r=n&&n.get||qq,s=a=>r(t?[a]:xl(a));let o;if(i)if(1===i){const a=s(e[0]);o=function(l){return""+a(l)}}else{const a=e.map(s);o=function(l){let u=""+a[0](l),c=0;for(;++c<i;)u+="|"+a[c](l);return u}}else o=function(){return""};return cs(o,e,"key")}function dG(e,t){const n=e[0],i=bt(e),r=+t;return r?1===r?i:n+r*(i-n):n}function fG(e){let t,n,i;e=+e||1e4;const r=()=>{t={},n={},i=0},s=(o,a)=>(++i>e&&(n=t,t={},i=1),t[o]=a);return r(),{clear:r,has:o=>Fe(t,o)||Fe(n,o),get:o=>Fe(t,o)?t[o]:Fe(n,o)?s(o,n[o]):void 0,set:(o,a)=>Fe(t,o)?t[o]=a:s(o,a)}}function hG(e,t,n,i){const r=t.length,s=n.length;if(!s)return t;if(!r)return n;const o=i||new t.constructor(r+s);let a=0,l=0,u=0;for(;a<r&&l<s;++u)o[u]=e(t[a],n[l])>0?n[l++]:t[a++];for(;a<r;++a,++u)o[u]=t[a];for(;l<s;++l,++u)o[u]=n[l];return o}function X_(e,t){let n="";for(;--t>=0;)n+=e;return n}function pG(e,t,n,i){const r=n||" ",s=e+"",o=t-s.length;return o<=0?s:"left"===i?X_(r,o)+s:"center"===i?X_(r,~~(o/2))+s+X_(r,Math.ceil(o/2)):s+X_(r,o)}function Q_(e){return e&&bt(e)-e[0]||0}function pe(e){return ie(e)?"["+e.map(pe)+"]":Se(e)||be(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function NN(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e||!e)}const AAe=e=>nn(e)||Yc(e)?e:Date.parse(e);function kN(e,t){return t=t||AAe,null==e||""===e?null:t(e)}function IN(e){return null==e||""===e?null:e+""}function Aa(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function gG(e,t,n,i){const r=null!=i?i:"\u2026",s=e+"",o=s.length,a=Math.max(0,t-r.length);return o<=t?s:"left"===n?r+s.slice(o-a):"center"===n?s.slice(0,Math.ceil(a/2))+r+s.slice(o-~~(a/2)):s.slice(0,a)+r}function Kc(e,t,n){if(e)if(t){const i=e.length;for(let r=0;r<i;++r){const s=t(e[r]);s&&n(s,r,e)}}else e.forEach(n)}function mG(e,t,n,i,r,s,o){try{var a=e[s](o),l=a.value}catch(u){return void n(u)}a.done?t(l):Promise.resolve(l).then(i,r)}function Hr(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var s=e.apply(t,n);function o(l){mG(s,i,r,o,a,"next",l)}function a(l){mG(s,i,r,o,a,"throw",l)}o(void 0)})}}var _G={},RN={};function yG(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function vG(e){var t=Object.create(null),n=[];return e.forEach(function(i){for(var r in i)r in t||n.push(t[r]=r)}),n}function fs(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function NAe(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(d,f){var _,h=[],p=d.length,g=0,m=0,y=p<=0,v=!1;function b(){if(y)return RN;if(v)return v=!1,_G;var C,E,w=g;if(34===d.charCodeAt(w)){for(;g++<p&&34!==d.charCodeAt(g)||34===d.charCodeAt(++g););return(C=g)>=p?y=!0:10===(E=d.charCodeAt(g++))?v=!0:13===E&&(v=!0,10===d.charCodeAt(g)&&++g),d.slice(w+1,C-1).replace(/""/g,'"')}for(;g<p;){if(10===(E=d.charCodeAt(C=g++)))v=!0;else if(13===E)v=!0,10===d.charCodeAt(g)&&++g;else if(E!==n)continue;return d.slice(w,C)}return y=!0,d.slice(w,p)}for(10===d.charCodeAt(p-1)&&--p,13===d.charCodeAt(p-1)&&--p;(_=b())!==RN;){for(var D=[];_!==_G&&_!==RN;)D.push(_),_=b();f&&null==(D=f(D,m++))||h.push(D)}return h}function s(d,f){return d.map(function(h){return f.map(function(p){return c(h[p])}).join(e)})}function u(d){return d.map(c).join(e)}function c(d){return null==d?"":d instanceof Date?function OAe(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":function TAe(e){return e<0?"-"+fs(-e,6):e>9999?"+"+fs(e,6):fs(e,4)}(e.getUTCFullYear())+"-"+fs(e.getUTCMonth()+1,2)+"-"+fs(e.getUTCDate(),2)+(r?"T"+fs(t,2)+":"+fs(n,2)+":"+fs(i,2)+"."+fs(r,3)+"Z":i?"T"+fs(t,2)+":"+fs(n,2)+":"+fs(i,2)+"Z":n||t?"T"+fs(t,2)+":"+fs(n,2)+"Z":"")}(d):t.test(d+="")?'"'+d.replace(/"/g,'""')+'"':d}return{parse:function i(d,f){var h,p,g=r(d,function(m,_){if(h)return h(m,_-1);p=m,h=f?function MAe(e,t){var n=yG(e);return function(i,r){return t(n(i),r,e)}}(m,f):yG(m)});return g.columns=p||[],g},parseRows:r,format:function o(d,f){return null==f&&(f=vG(d)),[f.map(c).join(e)].concat(s(d,f)).join("\n")},formatBody:function a(d,f){return null==f&&(f=vG(d)),s(d,f).join("\n")},formatRows:function l(d){return d.map(u).join("\n")},formatRow:u,formatValue:c}}function IAe(e){return e}function FAe(e,t){return"string"==typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(n){return bG(e,n)})}:bG(e,t)}function bG(e,t){var n=t.id,i=t.bbox,r=null==t.properties?{}:t.properties,s=wG(e,t);return null==n&&null==i?{type:"Feature",properties:r,geometry:s}:null==i?{type:"Feature",id:n,properties:r,geometry:s}:{type:"Feature",id:n,bbox:i,properties:r,geometry:s}}function wG(e,t){var n=function RAe(e){if(null==e)return IAe;var t,n,i=e.scale[0],r=e.scale[1],s=e.translate[0],o=e.translate[1];return function(a,l){l||(t=n=0);var u=2,c=a.length,d=new Array(c);for(d[0]=(t+=a[0])*i+s,d[1]=(n+=a[1])*r+o;u<c;)d[u]=a[u],++u;return d}}(e.transform),i=e.arcs;function r(c,d){d.length&&d.pop();for(var f=i[c<0?~c:c],h=0,p=f.length;h<p;++h)d.push(n(f[h],h));c<0&&function kAe(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}(d,p)}function s(c){return n(c)}function o(c){for(var d=[],f=0,h=c.length;f<h;++f)r(c[f],d);return d.length<2&&d.push(d[0]),d}function a(c){for(var d=o(c);d.length<4;)d.push(d[0]);return d}function l(c){return c.map(a)}return function u(c){var f,d=c.type;switch(d){case"GeometryCollection":return{type:d,geometries:c.geometries.map(u)};case"Point":f=s(c.coordinates);break;case"MultiPoint":f=c.coordinates.map(s);break;case"LineString":f=o(c.arcs);break;case"MultiLineString":f=c.arcs.map(o);break;case"Polygon":f=l(c.arcs);break;case"MultiPolygon":f=c.arcs.map(l);break;default:return null}return{type:d,coordinates:f}}(t)}function PAe(e,t){var n={},i={},r={},s=[],o=-1;function l(u,c){for(var d in u){var f=u[d];delete c[f.start],delete f.start,delete f.end,f.forEach(function(h){n[h<0?~h:h]=1}),s.push(f)}}return t.forEach(function(u,c){var f,d=e.arcs[u<0?~u:u];d.length<3&&!d[1][0]&&!d[1][1]&&(f=t[++o],t[o]=u,t[c]=f)}),t.forEach(function(u){var h,p,c=function a(u){var f,c=e.arcs[u<0?~u:u],d=c[0];return e.transform?(f=[0,0],c.forEach(function(h){f[0]+=h[0],f[1]+=h[1]})):f=c[c.length-1],u<0?[f,d]:[d,f]}(u),d=c[0],f=c[1];if(h=r[d])if(delete r[h.end],h.push(u),h.end=f,p=i[f]){delete i[p.start];var g=p===h?h:h.concat(p);i[g.start=h.start]=r[g.end=p.end]=g}else i[h.start]=r[h.end]=h;else if(h=i[f])if(delete i[h.start],h.unshift(u),h.start=d,p=r[d]){delete r[p.end];var m=p===h?h:p.concat(h);i[m.start=p.start]=r[m.end=h.end]=m}else i[h.start]=r[h.end]=h;else i[(h=[u]).start=d]=r[h.end=f]=h}),l(r,i),l(i,r),t.forEach(function(u){n[u<0?~u:u]||s.push([u])}),s}function LAe(e){return wG(e,jAe.apply(this,arguments))}function jAe(e,t,n){var i,r,s;if(arguments.length>1)i=BAe(0,t,n);else for(r=0,i=new Array(s=e.arcs.length);r<s;++r)i[r]=r;return{type:"MultiLineString",arcs:PAe(e,i)}}function BAe(e,t,n){var s,i=[],r=[];function o(d){var f=d<0?~d:d;(r[f]||(r[f]=[])).push({i:d,g:s})}function a(d){d.forEach(o)}function l(d){d.forEach(a)}return function c(d){switch(s=d,d.type){case"GeometryCollection":d.geometries.forEach(c);break;case"LineString":a(d.arcs);break;case"MultiLineString":case"Polygon":l(d.arcs);break;case"MultiPolygon":!function u(d){d.forEach(l)}(d.arcs)}}(t),r.forEach(null==n?function(d){i.push(d[0].i)}:function(d){n(d[0].g,d[d.length-1].g)&&i.push(d[0].i)}),i}var LN=Math.sqrt(50),jN=Math.sqrt(10),BN=Math.sqrt(2);function $N(e,t,n){var i,s,o,a,r=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((i=t<e)&&(s=e,e=t,t=s),0===(a=DG(e,t,n))||!isFinite(a))return[];if(a>0){let l=Math.round(e/a),u=Math.round(t/a);for(l*a<e&&++l,u*a>t&&--u,o=new Array(s=u-l+1);++r<s;)o[r]=(l+r)*a}else{a=-a;let l=Math.round(e*a),u=Math.round(t*a);for(l/a<e&&++l,u/a>t&&--u,o=new Array(s=u-l+1);++r<s;)o[r]=(l+r)/a}return i&&o.reverse(),o}function DG(e,t,n){var i=(t-e)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),s=i/Math.pow(10,r);return r>=0?(s>=LN?10:s>=jN?5:s>=BN?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(s>=LN?10:s>=jN?5:s>=BN?2:1)}function Jc(e,t,n){var i=Math.abs(t-e)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),s=i/r;return s>=LN?r*=10:s>=jN?r*=5:s>=BN&&(r*=2),t<e?-r:r}var xG,$Ae=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Gf(e){if(!(t=$Ae.exec(e)))throw new Error("invalid format: "+e);var t;return new VN({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function VN(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function cD(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function kg(e){return(e=cD(Math.abs(e)))?e[1]:NaN}function CG(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(kg(t)/3)))-kg(Math.abs(e)))}function EG(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,kg(t)-kg(e))+1}function SG(e){return Math.max(0,-kg(Math.abs(e)))}function AG(e,t){var n=cD(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}Gf.prototype=VN.prototype,VN.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const MG={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function VAe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>AG(100*e,t),r:AG,s:function qAe(e,t){var n=cD(e,t);if(!n)return e+"";var i=n[0],r=n[1],s=r-(xG=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+cD(e,Math.max(0,t+s-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function TG(e){return e}var dD,fD,HN,OG=Array.prototype.map,NG=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function kG(e){var t=void 0===e.grouping||void 0===e.thousands?TG:function HAe(e,t){return function(n,i){for(var r=n.length,s=[],o=0,a=e[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),s.push(n.substring(r-=a,r+a)),!((l+=a+1)>i));)a=e[o=(o+1)%e.length];return s.reverse().join(t)}}(OG.call(e.grouping,Number),e.thousands+""),n=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",r=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?TG:function UAe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}(OG.call(e.numerals,String)),o=void 0===e.percent?"%":e.percent+"",a=void 0===e.minus?"\u2212":e.minus+"",l=void 0===e.nan?"NaN":e.nan+"";function u(d){var f=(d=Gf(d)).fill,h=d.align,p=d.sign,g=d.symbol,m=d.zero,_=d.width,y=d.comma,v=d.precision,b=d.trim,D=d.type;"n"===D?(y=!0,D="g"):MG[D]||(void 0===v&&(v=12),b=!0,D="g"),(m||"0"===f&&"="===h)&&(m=!0,f="0",h="=");var C="$"===g?n:"#"===g&&/[boxX]/.test(D)?"0"+D.toLowerCase():"",w="$"===g?i:/[%p]/.test(D)?o:"",E=MG[D],N=/[defgprs%]/.test(D);function k(I){var T,A,x,L=C,B=w;if("c"===D)B=E(I)+B,I="";else{var F=(I=+I)<0||1/I<0;if(I=isNaN(I)?l:E(Math.abs(I),v),b&&(I=function zAe(e){e:for(var r,t=e.length,n=1,i=-1;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":0===i&&(i=n),r=n;break;default:if(!+e[n])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(r+1):e}(I)),F&&0==+I&&"+"!==p&&(F=!1),L=(F?"("===p?p:a:"-"===p||"("===p?"":p)+L,B=("s"===D?NG[8+xG/3]:"")+B+(F&&"("===p?")":""),N)for(T=-1,A=I.length;++T<A;)if(48>(x=I.charCodeAt(T))||x>57){B=(46===x?r+I.slice(T+1):I.slice(T))+B,I=I.slice(0,T);break}}y&&!m&&(I=t(I,1/0));var O=L.length+I.length+B.length,j=O<_?new Array(_-O+1).join(f):"";switch(y&&m&&(I=t(j+I,j.length?_-B.length:1/0),j=""),h){case"<":I=L+I+B+j;break;case"=":I=L+j+I+B;break;case"^":I=j.slice(0,O=j.length>>1)+L+I+B+j.slice(O);break;default:I=j+L+I+B}return s(I)}return v=void 0===v?6:/[gprs]/.test(D)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),k.toString=function(){return d+""},k}return{format:u,formatPrefix:function c(d,f){var h=u(((d=Gf(d)).type="f",d)),p=3*Math.max(-8,Math.min(8,Math.floor(kg(f)/3))),g=Math.pow(10,-p),m=NG[8+p/3];return function(_){return h(g*_)+m}}}}!function GAe(e){dD=kG(e),fD=dD.format,HN=dD.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});var UN=new Date,zN=new Date;function Pi(e,t,n,i){function r(s){return e(s=0===arguments.length?new Date:new Date(+s)),s}return r.floor=function(s){return e(s=new Date(+s)),s},r.ceil=function(s){return e(s=new Date(s-1)),t(s,1),e(s),s},r.round=function(s){var o=r(s),a=r.ceil(s);return s-o<a-s?o:a},r.offset=function(s,o){return t(s=new Date(+s),null==o?1:Math.floor(o)),s},r.range=function(s,o,a){var u,l=[];if(s=r.ceil(s),a=null==a?1:Math.floor(a),!(s<o&&a>0))return l;do{l.push(u=new Date(+s)),t(s,a),e(s)}while(u<s&&s<o);return l},r.filter=function(s){return Pi(function(o){if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},function(o,a){if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!s(o););else for(;--a>=0;)for(;t(o,1),!s(o););})},n&&(r.count=function(s,o){return UN.setTime(+s),zN.setTime(+o),e(UN),e(zN),Math.floor(n(UN,zN))},r.every=function(s){return s=Math.floor(s),isFinite(s)&&s>0?s>1?r.filter(i?function(o){return i(o)%s==0}:function(o){return r.count(0,o)%s==0}):r:null}),r}const Hu=1e3,Po=6e4,Uu=60*Po,Wf=24*Uu,qN=7*Wf,IG=30*Wf,GN=365*Wf;var RG=Pi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Po)/Wf,e=>e.getDate()-1);const Xc=RG;function Yf(e){return Pi(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+7*n)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Po)/qN})}var Ig=Yf(0),hD=Yf(1),Rg=(Yf(2),Yf(3),Yf(4)),FG=(Yf(5),Yf(6),Pi(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/Wf},function(e){return e.getUTCDate()-1}));const Qc=FG;function Kf(e){return Pi(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+7*n)},function(t,n){return(n-t)/qN})}var Fg=Kf(0),pD=Kf(1),Pg=(Kf(2),Kf(3),Kf(4)),WN=(Kf(5),Kf(6),Pi(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()}));WN.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Pi(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)}):null};const Zc=WN;var PG=Pi(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()});const gD=PG;var LG=Pi(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Hu-e.getMinutes()*Po)},function(e,t){e.setTime(+e+t*Uu)},function(e,t){return(t-e)/Uu},function(e){return e.getHours()});const YN=LG;var jG=Pi(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Hu)},function(e,t){e.setTime(+e+t*Po)},function(e,t){return(t-e)/Po},function(e){return e.getMinutes()});const KN=jG;var BG=Pi(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*Hu)},function(e,t){return(t-e)/Hu},function(e){return e.getUTCSeconds()});const ed=BG;var mD=Pi(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});mD.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?Pi(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):mD:null};const JN=mD;var XN=Pi(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});XN.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Pi(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null};const td=XN;var $G=Pi(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()});const _D=$G;var VG=Pi(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*Uu)},function(e,t){return(t-e)/Uu},function(e){return e.getUTCHours()});const QN=VG;var HG=Pi(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*Po)},function(e,t){return(t-e)/Po},function(e){return e.getUTCMinutes()});const ZN=HG;function zu(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function tMe(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ey(e){let t,n,i;function r(a,l,u=0,c=a.length){if(u<c){if(0!==t(l,l))return c;do{const d=u+c>>>1;n(a[d],l)<0?u=d+1:c=d}while(u<c)}return u}return 2!==e.length?(t=zu,n=(a,l)=>zu(e(a),l),i=(a,l)=>e(a)-l):(t=e===zu||e===tMe?e:nMe,n=e,i=e),{left:r,center:function o(a,l,u=0,c=a.length){const d=r(a,l,u,c-1);return d>u&&i(a[d-1],l)>-i(a[d],l)?d-1:d},right:function s(a,l,u=0,c=a.length){if(u<c){if(0!==t(l,l))return c;do{const d=u+c>>>1;n(a[d],l)<=0?u=d+1:c=d}while(u<c)}return u}}}function nMe(){return 0}const Ji="year",hs="quarter",vr="month",Ci="week",ps="date",br="day",Ml="dayofyear",Js="hours",Xs="minutes",Lo="seconds",Ma="milliseconds",ek=[Ji,hs,vr,Ci,ps,br,Ml,Js,Xs,Lo,Ma],tk=ek.reduce((e,t,n)=>(e[t]=1+n,e),{});function nk(e){const t=we(e).slice(),n={};return t.length||te("Missing time unit."),t.forEach(r=>{Fe(tk,r)?n[r]=1:te("Invalid time unit: ".concat(r,"."))}),(n[Ci]||n[br]?1:0)+(n[hs]||n[vr]||n[ps]?1:0)+(n[Ml]?1:0)>1&&te("Incompatible time units: ".concat(e)),t.sort((r,s)=>tk[r]-tk[s]),t}const iMe={[Ji]:"%Y ",[hs]:"Q%q ",[vr]:"%b ",[ps]:"%d ",[Ci]:"W%U ",[br]:"%a ",[Ml]:"%j ",[Js]:"%H:00",[Xs]:"00:%M",[Lo]:":%S",[Ma]:".%L",["".concat(Ji,"-").concat(vr)]:"%Y-%m ",["".concat(Ji,"-").concat(vr,"-").concat(ps)]:"%Y-%m-%d ",["".concat(Js,"-").concat(Xs)]:"%H:%M"};function UG(e,t){const n=ot({},iMe,t),i=nk(e),r=i.length;let a,l,s="",o=0;for(o=0;o<r;)for(a=i.length;a>o;--a)if(l=i.slice(o,a).join("-"),null!=n[l]){s+=n[l],o=a;break}return s.trim()}const Jf=new Date;function ik(e){return Jf.setFullYear(e),Jf.setMonth(0),Jf.setDate(1),Jf.setHours(0,0,0,0),Jf}function zG(e){return GG(new Date(e))}function qG(e){return rk(new Date(e))}function GG(e){return Xc.count(ik(e.getFullYear())-1,e)}function rk(e){return Ig.count(ik(e.getFullYear())-1,e)}function sk(e){return ik(e).getDay()}function rMe(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(-1,t,n,i,r,s,o);return a.setFullYear(e),a}return new Date(e,t,n,i,r,s,o)}function WG(e){return KG(new Date(e))}function YG(e){return ok(new Date(e))}function KG(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Qc.count(t-1,e)}function ok(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Fg.count(t-1,e)}function ak(e){return Jf.setTime(Date.UTC(e,0,1)),Jf.getUTCDay()}function sMe(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(Date.UTC(-1,t,n,i,r,s,o));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,i,r,s,o))}function JG(e,t,n,i,r){const s=t||1,o=bt(e),a=(_,y,v)=>function oMe(e,t,n,i){const r=n<=1?e:i?(s,o)=>i+n*Math.floor((e(s,o)-i)/n):(s,o)=>n*Math.floor(e(s,o)/n);return t?(s,o)=>t(r(s,o),o):r}(n[v=v||_],i[v],_===o&&s,y),l=new Date,u=Aa(e),c=u[Ji]?a(Ji):yr(2012),d=u[vr]?a(vr):u[hs]?a(hs):qc,f=u[Ci]&&u[br]?a(br,1,Ci+br):u[Ci]?a(Ci,1):u[br]?a(br,1):u[ps]?a(ps,1):u[Ml]?a(Ml,1):Ag,h=u[Js]?a(Js):qc,p=u[Xs]?a(Xs):qc,g=u[Lo]?a(Lo):qc,m=u[Ma]?a(Ma):qc;return function(_){l.setTime(+_);const y=c(l);return r(y,d(l),f(l,y),h(l),p(l),g(l),m(l))}}function Lg(e,t,n){return t+7*e-(n+6)%7}const aMe={[Ji]:e=>e.getFullYear(),[hs]:e=>Math.floor(e.getMonth()/3),[vr]:e=>e.getMonth(),[ps]:e=>e.getDate(),[Js]:e=>e.getHours(),[Xs]:e=>e.getMinutes(),[Lo]:e=>e.getSeconds(),[Ma]:e=>e.getMilliseconds(),[Ml]:e=>GG(e),[Ci]:e=>rk(e),[Ci+br]:(e,t)=>Lg(rk(e),e.getDay(),sk(t)),[br]:(e,t)=>Lg(1,e.getDay(),sk(t))},lMe={[hs]:e=>3*e,[Ci]:(e,t)=>Lg(e,0,sk(t))};function XG(e,t){return JG(e,t||1,aMe,lMe,rMe)}const uMe={[Ji]:e=>e.getUTCFullYear(),[hs]:e=>Math.floor(e.getUTCMonth()/3),[vr]:e=>e.getUTCMonth(),[ps]:e=>e.getUTCDate(),[Js]:e=>e.getUTCHours(),[Xs]:e=>e.getUTCMinutes(),[Lo]:e=>e.getUTCSeconds(),[Ma]:e=>e.getUTCMilliseconds(),[Ml]:e=>KG(e),[Ci]:e=>ok(e),[br]:(e,t)=>Lg(1,e.getUTCDay(),ak(t)),[Ci+br]:(e,t)=>Lg(ok(e),e.getUTCDay(),ak(t))},cMe={[hs]:e=>3*e,[Ci]:(e,t)=>Lg(e,0,ak(t))};function QG(e,t){return JG(e,t||1,uMe,cMe,sMe)}const dMe={[Ji]:Zc,[hs]:gD.every(3),[vr]:gD,[Ci]:Ig,[ps]:Xc,[br]:Xc,[Ml]:Xc,[Js]:YN,[Xs]:KN,[Lo]:ed,[Ma]:JN},fMe={[Ji]:td,[hs]:_D.every(3),[vr]:_D,[Ci]:Fg,[ps]:Qc,[br]:Qc,[Ml]:Qc,[Js]:QN,[Xs]:ZN,[Lo]:ed,[Ma]:JN};function jg(e){return dMe[e]}function Bg(e){return fMe[e]}function ZG(e,t,n){return e?e.offset(t,n):void 0}function eW(e,t,n){return ZG(jg(e),t,n)}function tW(e,t,n){return ZG(Bg(e),t,n)}function nW(e,t,n,i){return e?e.range(t,n,i):void 0}function iW(e,t,n,i){return nW(jg(e),t,n,i)}function rW(e,t,n,i){return nW(Bg(e),t,n,i)}const ny=6e4,iy=60*ny,yD=24*iy,sW=30*yD,lk=365*yD,oW=[Ji,vr,ps,Js,Xs,Lo,Ma],ry=oW.slice(0,-1),sy=ry.slice(0,-1),oy=sy.slice(0,-1),pMe=oy.slice(0,-1),aW=[Ji,vr],lW=[Ji],ay=[[ry,1,1e3],[ry,5,5e3],[ry,15,15e3],[ry,30,3e4],[sy,1,ny],[sy,5,5*ny],[sy,15,15*ny],[sy,30,30*ny],[oy,1,iy],[oy,3,3*iy],[oy,6,6*iy],[oy,12,12*iy],[pMe,1,yD],[[Ji,Ci],1,6048e5],[aW,1,sW],[aW,3,3*sW],[lW,1,lk]];function uW(e){const t=e.extent,n=e.maxbins||40,i=Math.abs(Q_(t))/n;let s,o,r=ey(a=>a[2]).right(ay,i);return r===ay.length?(s=lW,o=Jc(t[0]/lk,t[1]/lk,n)):r?(r=ay[i/ay[r-1][2]<ay[r][2]/i?r-1:r],s=r[0],o=r[1]):(s=oW,o=Math.max(Jc(t[0],t[1],n),1)),{units:s,step:o}}function uk(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function ck(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ly(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function cW(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,s=e.days,o=e.shortDays,a=e.months,l=e.shortMonths,u=uy(r),c=cy(r),d=uy(s),f=cy(s),h=uy(o),p=cy(o),g=uy(a),m=cy(a),_=uy(l),y=cy(l),v={a:function F(Y){return o[Y.getDay()]},A:function O(Y){return s[Y.getDay()]},b:function j(Y){return l[Y.getMonth()]},B:function P(Y){return a[Y.getMonth()]},c:null,d:mW,e:mW,f:jMe,g:YMe,G:JMe,H:FMe,I:PMe,j:LMe,L:_W,m:BMe,M:$Me,p:function z(Y){return r[+(Y.getHours()>=12)]},q:function q(Y){return 1+~~(Y.getMonth()/3)},Q:CW,s:EW,S:VMe,u:HMe,U:UMe,V:zMe,w:qMe,W:GMe,x:null,X:null,y:WMe,Y:KMe,Z:XMe,"%":DW},b={a:function G(Y){return o[Y.getUTCDay()]},A:function V(Y){return s[Y.getUTCDay()]},b:function K(Y){return l[Y.getUTCMonth()]},B:function re(Y){return a[Y.getUTCMonth()]},c:null,d:vW,e:vW,f:tTe,g:dTe,G:hTe,H:QMe,I:ZMe,j:eTe,L:bW,m:nTe,M:iTe,p:function X(Y){return r[+(Y.getUTCHours()>=12)]},q:function le(Y){return 1+~~(Y.getUTCMonth()/3)},Q:CW,s:EW,S:rTe,u:sTe,U:oTe,V:aTe,w:lTe,W:uTe,x:null,X:null,y:cTe,Y:fTe,Z:pTe,"%":DW},D={a:function k(Y,Z,ne){var W=h.exec(Z.slice(ne));return W?(Y.w=p.get(W[0].toLowerCase()),ne+W[0].length):-1},A:function I(Y,Z,ne){var W=d.exec(Z.slice(ne));return W?(Y.w=f.get(W[0].toLowerCase()),ne+W[0].length):-1},b:function L(Y,Z,ne){var W=_.exec(Z.slice(ne));return W?(Y.m=y.get(W[0].toLowerCase()),ne+W[0].length):-1},B:function B(Y,Z,ne){var W=g.exec(Z.slice(ne));return W?(Y.m=m.get(W[0].toLowerCase()),ne+W[0].length):-1},c:function T(Y,Z,ne){return E(Y,t,Z,ne)},d:pW,e:pW,f:NMe,g:hW,G:fW,H:gW,I:gW,j:AMe,L:OMe,m:xMe,M:MMe,p:function N(Y,Z,ne){var W=u.exec(Z.slice(ne));return W?(Y.p=c.get(W[0].toLowerCase()),ne+W[0].length):-1},q:SMe,Q:IMe,s:RMe,S:TMe,u:bMe,U:wMe,V:DMe,w:vMe,W:CMe,x:function A(Y,Z,ne){return E(Y,n,Z,ne)},X:function x(Y,Z,ne){return E(Y,i,Z,ne)},y:hW,Y:fW,Z:EMe,"%":kMe};function C(Y,Z){return function(ne){var Ce,Oe,Xe,W=[],he=-1,ve=0,Re=Y.length;for(ne instanceof Date||(ne=new Date(+ne));++he<Re;)37===Y.charCodeAt(he)&&(W.push(Y.slice(ve,he)),null!=(Oe=dW[Ce=Y.charAt(++he)])?Ce=Y.charAt(++he):Oe="e"===Ce?" ":"0",(Xe=Z[Ce])&&(Ce=Xe(ne,Oe)),W.push(Ce),ve=he+1);return W.push(Y.slice(ve,he)),W.join("")}}function w(Y,Z){return function(ne){var ve,Re,W=ly(1900,void 0,1);if(E(W,Y,ne+="",0)!=ne.length)return null;if("Q"in W)return new Date(W.Q);if("s"in W)return new Date(1e3*W.s+("L"in W?W.L:0));if(Z&&!("Z"in W)&&(W.Z=0),"p"in W&&(W.H=W.H%12+12*W.p),void 0===W.m&&(W.m="q"in W?W.q:0),"V"in W){if(W.V<1||W.V>53)return null;"w"in W||(W.w=1),"Z"in W?(Re=(ve=ck(ly(W.y,0,1))).getUTCDay(),ve=Re>4||0===Re?pD.ceil(ve):pD(ve),ve=Qc.offset(ve,7*(W.V-1)),W.y=ve.getUTCFullYear(),W.m=ve.getUTCMonth(),W.d=ve.getUTCDate()+(W.w+6)%7):(Re=(ve=uk(ly(W.y,0,1))).getDay(),ve=Re>4||0===Re?hD.ceil(ve):hD(ve),ve=Xc.offset(ve,7*(W.V-1)),W.y=ve.getFullYear(),W.m=ve.getMonth(),W.d=ve.getDate()+(W.w+6)%7)}else("W"in W||"U"in W)&&("w"in W||(W.w="u"in W?W.u%7:"W"in W?1:0),Re="Z"in W?ck(ly(W.y,0,1)).getUTCDay():uk(ly(W.y,0,1)).getDay(),W.m=0,W.d="W"in W?(W.w+6)%7+7*W.W-(Re+5)%7:W.w+7*W.U-(Re+6)%7);return"Z"in W?(W.H+=W.Z/100|0,W.M+=W.Z%100,ck(W)):uk(W)}}function E(Y,Z,ne,W){for(var Ce,Oe,he=0,ve=Z.length,Re=ne.length;he<ve;){if(W>=Re)return-1;if(37===(Ce=Z.charCodeAt(he++))){if(Ce=Z.charAt(he++),!(Oe=D[Ce in dW?Z.charAt(he++):Ce])||(W=Oe(Y,ne,W))<0)return-1}else if(Ce!=ne.charCodeAt(W++))return-1}return W}return v.x=C(n,v),v.X=C(i,v),v.c=C(t,v),b.x=C(n,b),b.X=C(i,b),b.c=C(t,b),{format:function(Y){var Z=C(Y+="",v);return Z.toString=function(){return Y},Z},parse:function(Y){var Z=w(Y+="",!1);return Z.toString=function(){return Y},Z},utcFormat:function(Y){var Z=C(Y+="",b);return Z.toString=function(){return Y},Z},utcParse:function(Y){var Z=w(Y+="",!0);return Z.toString=function(){return Y},Z}}}var $g,dk,SW,fk,xW,dW={"-":"",_:" ",0:"0"},Li=/^\s*\d+/,mMe=/^%/,_Me=/[\\^$*+?|[\]().{}]/g;function Ft(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(t)+r:r)}function yMe(e){return e.replace(_Me,"\\$&")}function uy(e){return new RegExp("^(?:"+e.map(yMe).join("|")+")","i")}function cy(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function vMe(e,t,n){var i=Li.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function bMe(e,t,n){var i=Li.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function wMe(e,t,n){var i=Li.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function DMe(e,t,n){var i=Li.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function CMe(e,t,n){var i=Li.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function fW(e,t,n){var i=Li.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function hW(e,t,n){var i=Li.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function EMe(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function SMe(e,t,n){var i=Li.exec(t.slice(n,n+1));return i?(e.q=3*i[0]-3,n+i[0].length):-1}function xMe(e,t,n){var i=Li.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function pW(e,t,n){var i=Li.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function AMe(e,t,n){var i=Li.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function gW(e,t,n){var i=Li.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function MMe(e,t,n){var i=Li.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function TMe(e,t,n){var i=Li.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function OMe(e,t,n){var i=Li.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function NMe(e,t,n){var i=Li.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function kMe(e,t,n){var i=mMe.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function IMe(e,t,n){var i=Li.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function RMe(e,t,n){var i=Li.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function mW(e,t){return Ft(e.getDate(),t,2)}function FMe(e,t){return Ft(e.getHours(),t,2)}function PMe(e,t){return Ft(e.getHours()%12||12,t,2)}function LMe(e,t){return Ft(1+Xc.count(Zc(e),e),t,3)}function _W(e,t){return Ft(e.getMilliseconds(),t,3)}function jMe(e,t){return _W(e,t)+"000"}function BMe(e,t){return Ft(e.getMonth()+1,t,2)}function $Me(e,t){return Ft(e.getMinutes(),t,2)}function VMe(e,t){return Ft(e.getSeconds(),t,2)}function HMe(e){var t=e.getDay();return 0===t?7:t}function UMe(e,t){return Ft(Ig.count(Zc(e)-1,e),t,2)}function yW(e){var t=e.getDay();return t>=4||0===t?Rg(e):Rg.ceil(e)}function zMe(e,t){return e=yW(e),Ft(Rg.count(Zc(e),e)+(4===Zc(e).getDay()),t,2)}function qMe(e){return e.getDay()}function GMe(e,t){return Ft(hD.count(Zc(e)-1,e),t,2)}function WMe(e,t){return Ft(e.getFullYear()%100,t,2)}function YMe(e,t){return Ft((e=yW(e)).getFullYear()%100,t,2)}function KMe(e,t){return Ft(e.getFullYear()%1e4,t,4)}function JMe(e,t){var n=e.getDay();return Ft((e=n>=4||0===n?Rg(e):Rg.ceil(e)).getFullYear()%1e4,t,4)}function XMe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ft(t/60|0,"0",2)+Ft(t%60,"0",2)}function vW(e,t){return Ft(e.getUTCDate(),t,2)}function QMe(e,t){return Ft(e.getUTCHours(),t,2)}function ZMe(e,t){return Ft(e.getUTCHours()%12||12,t,2)}function eTe(e,t){return Ft(1+Qc.count(td(e),e),t,3)}function bW(e,t){return Ft(e.getUTCMilliseconds(),t,3)}function tTe(e,t){return bW(e,t)+"000"}function nTe(e,t){return Ft(e.getUTCMonth()+1,t,2)}function iTe(e,t){return Ft(e.getUTCMinutes(),t,2)}function rTe(e,t){return Ft(e.getUTCSeconds(),t,2)}function sTe(e){var t=e.getUTCDay();return 0===t?7:t}function oTe(e,t){return Ft(Fg.count(td(e)-1,e),t,2)}function wW(e){var t=e.getUTCDay();return t>=4||0===t?Pg(e):Pg.ceil(e)}function aTe(e,t){return e=wW(e),Ft(Pg.count(td(e),e)+(4===td(e).getUTCDay()),t,2)}function lTe(e){return e.getUTCDay()}function uTe(e,t){return Ft(pD.count(td(e)-1,e),t,2)}function cTe(e,t){return Ft(e.getUTCFullYear()%100,t,2)}function dTe(e,t){return Ft((e=wW(e)).getUTCFullYear()%100,t,2)}function fTe(e,t){return Ft(e.getUTCFullYear()%1e4,t,4)}function hTe(e,t){var n=e.getUTCDay();return Ft((e=n>=4||0===n?Pg(e):Pg.ceil(e)).getUTCFullYear()%1e4,t,4)}function pTe(){return"+0000"}function DW(){return"%"}function CW(e){return+e}function EW(e){return Math.floor(+e/1e3)}function dy(e){const t={};return n=>t[n]||(t[n]=e(n))}function AW(e){const t=dy(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(i){const r=Gf(i||",");if(null==r.precision){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1}return function mTe(e,t){return n=>{const i=e(n),r=i.indexOf(t);if(r<0)return i;let s=function _Te(e,t){let i,n=e.lastIndexOf("e");if(n>0)return n;for(n=e.length;--n>t;)if(i=e.charCodeAt(n),i>=48&&i<=57)return n+1}(i,r);const o=s<i.length?i.slice(s):"";for(;--s>r;)if("0"!==i[s]){++s;break}return i.slice(0,s)+o}}(t(r),t(".1f")(1)[1])}return t(r)},formatSpan(i,r,s,o){o=Gf(null==o?",f":o);const a=Jc(i,r,s),l=Math.max(Math.abs(i),Math.abs(r));let u;if(null==o.precision)switch(o.type){case"s":return isNaN(u=CG(a,l))||(o.precision=u),n(o,l);case"":case"e":case"g":case"p":case"r":isNaN(u=EG(a,l))||(o.precision=u-("e"===o.type));break;case"f":case"%":isNaN(u=SG(a))||(o.precision=u-2*("%"===o.type))}return t(o)}}}let hk,pk;function MW(){return hk=AW({format:fD,formatPrefix:HN})}function TW(e){return AW(kG(e))}function vD(e){return arguments.length?hk=TW(e):hk}function OW(e,t,n){Se(n=n||{})||te("Invalid time multi-format specifier: ".concat(n));const i=t(Lo),r=t(Xs),s=t(Js),o=t(ps),a=t(Ci),l=t(vr),u=t(hs),c=t(Ji),d=e(n[Ma]||".%L"),f=e(n[Lo]||":%S"),h=e(n[Xs]||"%I:%M"),p=e(n[Js]||"%I %p"),g=e(n[ps]||n[br]||"%a %d"),m=e(n[Ci]||"%b %d"),_=e(n[vr]||"%B"),y=e(n[hs]||"%B"),v=e(n[Ji]||"%Y");return b=>(i(b)<b?d:r(b)<b?f:s(b)<b?h:o(b)<b?p:l(b)<b?a(b)<b?g:m:c(b)<b?u(b)<b?_:y:v)(b)}function NW(e){const t=dy(e.format),n=dy(e.utcFormat);return{timeFormat:i=>be(i)?t(i):OW(t,jg,i),utcFormat:i=>be(i)?n(i):OW(n,Bg,i),timeParse:dy(e.parse),utcParse:dy(e.utcParse)}}function kW(){return pk=NW({format:dk,parse:SW,utcFormat:fk,utcParse:xW})}function IW(e){return NW(cW(e))}function fy(e){return arguments.length?pk=IW(e):pk}!function gTe(e){$g=cW(e),dk=$g.format,SW=$g.parse,fk=$g.utcFormat,xW=$g.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),MW(),kW();const gk=(e,t)=>ot({},e,t);function RW(e,t){const n=e?TW(e):vD(),i=t?IW(t):fy();return gk(n,i)}function mk(e,t){const n=arguments.length;return n&&2!==n&&te("defaultLocale expects either zero or two arguments."),n?gk(vD(e),fy(t)):gk(vD(),fy())}function yTe(){return MW(),kW(),mk()}const vTe=/^(data:|([A-Za-z]+:)?\/\/)/,bTe=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,wTe=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,FW="file://";function CTe(e,t){return _k.apply(this,arguments)}function _k(){return _k=Hr(function*(e,t){const n=yield this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}),_k.apply(this,arguments)}function ETe(e,t){return yk.apply(this,arguments)}function yk(){return yk=Hr(function*(e,t){t=ot({},this.options,t);const n=this.fileAccess,i={href:null};let r,s,o;const a=bTe.test(e.replace(wTe,""));(null==e||"string"!=typeof e||!a)&&te("Sanitize failure, invalid URI: "+pe(e));const l=vTe.test(e);return(o=t.baseURL)&&!l&&(!e.startsWith("/")&&!o.endsWith("/")&&(e="/"+e),e=o+e),s=(r=e.startsWith(FW))||"file"===t.mode||"http"!==t.mode&&!l&&n,r?e=e.slice(FW.length):e.startsWith("//")&&("file"===t.defaultProtocol?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!s}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),"image"===t.context&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}),yk.apply(this,arguments)}function STe(e){return e?t=>new Promise((n,i)=>{e.readFile(t,(r,s)=>{r?i(r):n(s)})}):xTe}function xTe(){return vk.apply(this,arguments)}function vk(){return(vk=Hr(function*(){te("No file system access.")})).apply(this,arguments)}function ATe(e){return e?function(){var t=Hr(function*(n,i){const r=ot({},this.options.http,i),s=i&&i.response,o=yield e(n,r);return o.ok?st(o[s])?o[s]():o.text():te(o.status+""+o.statusText)});return function(n,i){return t.apply(this,arguments)}}():MTe}function MTe(){return bk.apply(this,arguments)}function bk(){return(bk=Hr(function*(){te("No HTTP fetch method available.")})).apply(this,arguments)}const TTe=e=>null!=e&&e==e,PW=e=>!(Number.isNaN(+e)||e instanceof Date),wk={boolean:NN,integer:_r,number:_r,date:kN,string:IN,unknown:mr},bD=[e=>"true"===e||"false"===e||!0===e||!1===e,e=>PW(e)&&Number.isInteger(+e),PW,e=>!Number.isNaN(Date.parse(e))],ITe=["boolean","integer","number","date"];function LW(e,t){if(!e||!e.length)return"unknown";const n=e.length,i=bD.length,r=bD.map((s,o)=>o+1);for(let a,l,s=0,o=0;s<n;++s)for(l=t?e[s][t]:e[s],a=0;a<i;++a)if(r[a]&&TTe(l)&&!bD[a](l)&&(r[a]=0,++o,o===bD.length))return"string";return ITe[r.reduce((s,o)=>0===s?o:s,0)-1]}function jW(e,t){return t.reduce((n,i)=>(n[i]=LW(e,i),n),{})}function BW(e){const t=function(n,i){const r={delimiter:e};return Dk(n,i?ot(i,r):r)};return t.responseType="text",t}function Dk(e,t){return t.header&&(e=t.header.map(pe).join(t.delimiter)+"\n"+e),NAe(t.delimiter).parse(e+"")}function Ck(e,t){const n=t&&t.property?ds(t.property):mr;return Se(e)&&!function RTe(e){return!("function"!=typeof Buffer||!st(Buffer.isBuffer))&&Buffer.isBuffer(e)}(e)?function FTe(e,t){return!ie(e)&&uG(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}(n(e),t):n(JSON.parse(e))}Dk.responseType="text",Ck.responseType="json";const PTe={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function $W(e,t){let n,i,r,s;return e=Ck(e,t),t&&t.feature?(n=FAe,r=t.feature):t&&t.mesh?(n=LAe,r=t.mesh,s=PTe[t.filter]):te("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,s):te("Invalid TopoJSON object: "+r),i&&i.features||[i]}$W.responseType="json";const wD={dsv:Dk,csv:BW(","),tsv:BW("\t"),json:Ck,topojson:$W};function Ek(e,t){return arguments.length>1?(wD[e]=t,this):Fe(wD,e)?wD[e]:null}function VW(e){const t=Ek(e);return t&&t.responseType||"text"}function HW(e,t,n,i){const r=Ek((t=t||{}).type||"json");return r||te("Unknown data format type: "+t.type),e=r(e,t),t.parse&&function LTe(e,t,n,i){if(!e.length)return;const r=fy();n=n||r.timeParse,i=i||r.utcParse;let o,a,l,u,c,d,s=e.columns||Object.keys(e[0]);"auto"===t&&(t=jW(e,s)),s=Object.keys(t);const f=s.map(h=>{const p=t[h];let g,m;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),m=g[1],("'"===m[0]&&"'"===m[m.length-1]||'"'===m[0]&&'"'===m[m.length-1])&&(m=m.slice(1,-1)),("utc"===g[0]?i:n)(m);if(!wk[p])throw Error("Illegal format pattern: "+h+":"+p);return wk[p]});for(l=0,c=e.length,d=s.length;l<c;++l)for(o=e[l],u=0;u<d;++u)a=s[u],o[a]=f[u](o[a])}(e,t.parse,n,i),Fe(e,"columns")&&delete e.columns,e}const DD=function DTe(e,t){return n=>({options:n||{},sanitize:ETe,load:CTe,fileAccess:!!t,file:STe(t),http:ATe(e)})}("undefined"!=typeof fetch&&fetch,null);function CD(e){const t=e||mr,n=[],i={};return n.add=r=>{const s=t(r);return i[s]||(i[s]=1,n.push(r)),n},n.remove=r=>{const s=t(r);if(i[s]){i[s]=0;const o=n.indexOf(r);o>=0&&n.splice(o,1)}return n},n}function ED(e,t){return Sk.apply(this,arguments)}function Sk(){return Sk=Hr(function*(e,t){try{yield t(e)}catch(n){e.error(n)}}),Sk.apply(this,arguments)}const UW=Symbol("vega_id");let jTe=1;function SD(e){return!(!e||!je(e))}function je(e){return e[UW]}function zW(e,t){return e[UW]=t,e}function Ut(e){const t=e===Object(e)?e:{data:e};return je(t)?t:zW(t,jTe++)}function xk(e){return xD(e,Ut({}))}function xD(e,t){for(const n in e)t[n]=e[n];return t}function qW(e,t){return zW(t,je(e))}function Xf(e,t){return e?t?(n,i)=>e(n,i)||je(t(n))-je(t(i)):(n,i)=>e(n,i)||je(n)-je(i):null}function GW(e){return e&&e.constructor===Qf}function Qf(){const e=[],t=[],n=[],i=[],r=[];let s=null,o=!1;return{constructor:Qf,insert(a){const l=we(a),u=l.length;for(let c=0;c<u;++c)e.push(l[c]);return this},remove(a){const l=st(a)?i:t,u=we(a),c=u.length;for(let d=0;d<c;++d)l.push(u[d]);return this},modify(a,l,u){const c={field:l,value:yr(u)};return st(a)?(c.filter=a,r.push(c)):(c.tuple=a,n.push(c)),this},encode(a,l){return st(a)?r.push({filter:a,field:l}):n.push({tuple:a,field:l}),this},clean(a){return s=a,this},reflow(){return o=!0,this},pulse(a,l){const u={},c={};let d,f,h,p,g,m;for(d=0,f=l.length;d<f;++d)u[je(l[d])]=1;for(d=0,f=t.length;d<f;++d)g=t[d],u[je(g)]=-1;for(d=0,f=i.length;d<f;++d)p=i[d],l.forEach(y=>{p(y)&&(u[je(y)]=-1)});for(d=0,f=e.length;d<f;++d)g=e[d],m=je(g),u[m]?u[m]=1:a.add.push(Ut(e[d]));for(d=0,f=l.length;d<f;++d)g=l[d],u[je(g)]<0&&a.rem.push(g);function _(y,v,b){b?y[v]=b(y):a.encode=v,o||(c[je(y)]=y)}for(d=0,f=n.length;d<f;++d)h=n[d],g=h.tuple,p=h.field,m=u[je(g)],m>0&&(_(g,p,h.value),a.modifies(p));for(d=0,f=r.length;d<f;++d)h=r[d],p=h.filter,l.forEach(y=>{p(y)&&u[je(y)]>0&&_(y,h.field,h.value)}),a.modifies(h.field);if(o)a.mod=t.length||i.length?l.filter(y=>u[je(y)]>0):l.slice();else for(m in c)a.mod.push(c[m]);return(s||null==s&&(t.length||i.length))&&a.clean(!0),a}}}const AD="_:mod:_";function MD(){Object.defineProperty(this,AD,{writable:!0,value:{}})}MD.prototype={set(e,t,n,i){const r=this,s=r[e],o=r[AD];return null!=t&&t>=0?(s[t]!==n||i)&&(s[t]=n,o[t+":"+e]=-1,o[e]=-1):(s!==n||i)&&(r[e]=n,o[e]=ie(n)?1+n.length:-1),r},modified(e,t){const n=this[AD];if(!arguments.length){for(const i in n)if(n[i])return!0;return!1}if(ie(e)){for(let i=0;i<e.length;++i)if(n[e[i]])return!0;return!1}return null!=t&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[AD]={},this}};let BTe=0;const VTe=new MD;function pn(e,t,n,i){this.id=++BTe,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,i)}function WW(e){return function(t){const n=this.flags;return 0===arguments.length?!!(n&e):(this.flags=t?n|e:n&~e,this)}}pn.prototype={targets(){return this._targets||(this._targets=CD(J_))},set(e){return this.value!==e?(this.value=e,1):0},skip:WW(1),modified:WW(2),parameters(e,t,n){t=!1!==t;const i=this._argval=this._argval||new MD,r=this._argops=this._argops||[],s=[];let o,a,l,u;const c=(d,f,h)=>{h instanceof pn?(h!==this&&(t&&h.targets().add(this),s.push(h)),r.push({op:h,name:d,index:f})):i.set(d,f,h)};for(o in e)if(a=e[o],"pulse"===o)we(a).forEach(d=>{d instanceof pn?d!==this&&(d.targets().add(this),s.push(d)):te("Pulse parameters must be operator instances.")}),this.source=a;else if(ie(a))for(i.set(o,-1,Array(l=a.length)),u=0;u<l;++u)c(o,u,a[u]);else c(o,-1,a);return this.marshall().clear(),n&&(r.initonly=!0),s},marshall(e){const t=this._argval||VTe,n=this._argops;let i,r,s,o;if(n){const a=n.length;for(r=0;r<a;++r)i=n[r],s=i.op,o=s.modified()&&s.stamp===e,t.set(i.name,i.index,s.value,o);if(n.initonly){for(r=0;r<a;++r)i=n[r],i.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,i,r;if(e)for(t=0,n=e.length;t<n;++t)i=e[t],r=i.op,r._targets&&r._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),i=t.call(this,n,e);if(n.clear(),i!==this.value)this.value=i;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};let GTe=0;function TD(e,t,n){this.id=++GTe,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function nd(e,t,n){return new TD(e,t,n)}function Ak(){return Ak=Hr(function*(e,t){const n=this;let r,i=0;try{r=yield n.loader().load(e,{context:"dataflow",response:VW(t&&t.type)});try{r=n.parse(r,t)}catch(s){i=-2,n.warn("Data ingestion failed",e,s)}}catch(s){i=-1,n.warn("Loading failed",e,s)}return{data:r,status:i}}),Ak.apply(this,arguments)}function Mk(){return Mk=Hr(function*(e,t,n){const i=this,r=i._pending||QTe(i);r.requests+=1;const s=yield i.request(t,n);return i.pulse(e,i.changeset().remove(Fo).insert(s.data||[])),r.done(),s}),Mk.apply(this,arguments)}function QTe(e){let t;const n=new Promise(i=>t=i);return n.requests=0,n.done=()=>{0==--n.requests&&(e._pending=null,t(e))},e._pending=n}TD.prototype={_filter:Fo,_apply:mr,targets(){return this._targets||(this._targets=CD(J_))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,i=n?n.length:0;for(let r=0;r<i;++r)n[r].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=nd(e);return this.targets().add(t),t},apply(e){const t=nd(null,e);return this.targets().add(t),t},merge(){const e=nd();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=nd();return this.targets().add(nd(null,null,TN(e,n=>{const i=n.dataflow;t.receive(n),i&&i.run&&i.run()}))),t},between(e,t){let n=!1;return e.targets().add(nd(null,null,()=>n=!0)),t.targets().add(nd(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=Fo,this._targets=null}};const ZTe={skip:!0};function t2e(e,t,n,i,r,s){const o=ot({},s,ZTe);let a,l;st(n)||(n=yr(n)),void 0===i?a=u=>e.touch(n(u)):st(i)?(l=new pn(null,i,r,!1),a=u=>{l.evaluate(u);const c=n(u),d=l.value;GW(d)?e.pulse(c,d,s):e.update(c,d,o)}):a=u=>e.update(n(u),i,o),t.apply(a)}function n2e(e,t,n,i,r,s){if(void 0===i)t.targets().add(n);else{const o=s||{},a=new pn(null,function i2e(e,t){return t=st(t)?t:yr(t),e?function(n,i){const r=t(n,i);return e.skip()||(e.skip(r!==this.value).value=r),r}:t}(n,i),r,!1);a.modified(o.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}const OD={};function rd(e,t,n){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Tk(e,t){const n=[];return Kc(e,t,i=>n.push(i)),n}function QW(e,t){const n={};return e.visit(t,i=>{n[je(i)]=1}),i=>n[je(i)]?null:i}function ND(e,t){return e?(n,i)=>e(n,i)&&t(n,i):t}function Ok(e,t,n,i){const r=this,s=n.length;let o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=i||null,this.pulses=n;for(let a=0;a<s;++a){const l=n[a];if(l.stamp===t){if(l.fields){const u=r.fields||(r.fields={});for(const c in l.fields)u[c]=1}l.changed(r.ADD)&&(o|=r.ADD),l.changed(r.REM)&&(o|=r.REM),l.changed(r.MOD)&&(o|=r.MOD)}}this.changes=o}function Nk(){return Nk=Hr(function*(e,t,n){const i=this,r=[];if(i._pulse)return ZW(i);if(i._pending&&(yield i._pending),t&&(yield ED(i,t)),!i._touched.length)return i.debug("Dataflow invoked, but nothing to do."),i;const s=++i._clock;i._pulse=new rd(i,s,e),i._touched.forEach(c=>i._enqueue(c,!0)),i._touched=CD(J_);let a,l,u,o=0;try{for(;i._heap.size()>0;)a=i._heap.pop(),a.rank===a.qrank?(l=a.run(i._getPulse(a,e)),l.then?l=yield l:l.async&&(r.push(l.async),l=OD),l!==OD&&a._targets&&a._targets.forEach(c=>i._enqueue(c)),++o):i._enqueue(a,!0)}catch(c){i._heap.clear(),u=c}if(i._input={},i._pulse=null,i.debug(`Pulse ${s}: ${o} operators`),u&&(i._postrun=[],i.error(u)),i._postrun.length){const c=i._postrun.sort((d,f)=>f.priority-d.priority);i._postrun=[];for(let d=0;d<c.length;++d)yield ED(i,c[d].callback)}return n&&(yield ED(i,n)),r.length&&Promise.all(r).then(c=>i.runAsync(null,()=>{c.forEach(d=>{try{d(i)}catch(f){i.error(f)}})})),i}),Nk.apply(this,arguments)}function kk(){return kk=Hr(function*(e,t,n){for(;this._running;)yield this._running;const i=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(i,i),this._running}),kk.apply(this,arguments)}function ZW(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}rd.prototype={StopPropagation:OD,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(e){return new rd(this.dataflow).init(this,e)},clone(){const e=this.fork(7);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(23)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new rd(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(64&t)&&(n.fields=e.fields),1&t?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),2&t?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),4&t?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),32&t?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||7;return 1&t&&this.add.length||2&t&&this.rem.length||4&t&&this.mod.length},reflow(e){if(e)return this.fork(7).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(4,QW(this,1))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return ie(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return!(!t&&!this.mod.length||!n)&&(arguments.length?ie(e)?e.some(i=>n[i]):n[e]:!!n)},filter(e,t){const n=this;return 1&e&&(n.addF=ND(n.addF,t)),2&e&&(n.remF=ND(n.remF,t)),4&e&&(n.modF=ND(n.modF,t)),16&e&&(n.srcF=ND(n.srcF,t)),n},materialize(e){const t=this;return 1&(e=e||7)&&t.addF&&(t.add=Tk(t.add,t.addF),t.addF=null),2&e&&t.remF&&(t.rem=Tk(t.rem,t.remF),t.remF=null),4&e&&t.modF&&(t.mod=Tk(t.mod,t.modF),t.modF=null),16&e&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,i=t;if(16&e)return Kc(n.source,n.srcF,i),n;1&e&&Kc(n.add,n.addF,i),2&e&&Kc(n.rem,n.remF,i),4&e&&Kc(n.mod,n.modF,i);const r=n.source;if(8&e&&r){const s=n.add.length+n.mod.length;s===r.length||Kc(r,s?QW(n,5):n.srcF,i)}return n}},fe(Ok,rd,{fork(e){const t=new rd(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?ie(e)?e.some(i=>n[i]):n[e]:0},filter(){te("MultiPulse does not support filtering.")},materialize(){te("MultiPulse does not support materialization.")},visit(e,t){const n=this,i=n.pulses,r=i.length;let s=0;if(e&n.SOURCE)for(;s<r;++s)i[s].visit(e,t);else for(;s<r;++s)i[s].stamp===n.stamp&&i[s].visit(e,t);return n}});const Ik={skip:!1,force:!1};function eY(e,t,n,i){let r,s;const o=e[n];for(;n>t&&(s=n-1>>1,r=e[s],i(o,r)<0);)e[n]=r,n=s;return e[n]=o}function Hg(){this.logger(EN()),this.logLevel(DN),this._clock=0,this._rank=0,this._locale=mk();try{this._loader=DD()}catch(e){}this._touched=CD(J_),this._input={},this._pulse=null,this._heap=function _2e(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),eY(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let i;return t.length?(i=t[0],t[0]=n,function y2e(e,t,n){const i=t,r=e.length,s=e[t];let a,o=1+(t<<1);for(;o<r;)a=o+1,a<r&&n(e[o],e[a])>=0&&(o=a),e[t]=e[o],o=1+((t=o)<<1);e[t]=s,eY(e,i,t,n)}(t,0,e)):i=n,i}}}((e,t)=>e.qrank-t.qrank),this._postrun=[]}function py(e){return function(){return this._log[e].apply(this,arguments)}}function Q(e,t){pn.call(this,e,null,t)}Hg.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:py("error"),warn:py("warn"),info:py("info"),debug:py("debug"),logLevel:py("level"),cleanThreshold:1e4,add:function zTe(e,t,n,i){let s,r=1;return e instanceof pn?s=e:e&&e.prototype instanceof pn?s=new e:st(e)?s=new pn(null,e):(r=0,s=new pn(e,t)),this.rank(s),r&&(i=n,n=t),n&&this.connect(s,s.parameters(n,i)),this.touch(s),s},connect:function qTe(e,t){const n=e.rank,i=t.length;for(let r=0;r<i;++r)if(n<t[r].rank)return void this.rerank(e)},rank:function r2e(e){e.rank=++this._rank},rerank:function s2e(e){const t=[e];let n,i,r;for(;t.length;)if(this.rank(n=t.pop()),i=n._targets)for(r=i.length;--r>=0;)t.push(n=i[r]),n===e&&te("Cycle detected in dataflow graph.")},pulse:function m2e(e,t,n){this.touch(e,n||Ik);const i=new rd(this,this._clock+(this._pulse?0:1)),r=e.pulse&&e.pulse.source||[];return i.target=e,this._input[e.id]=t.pulse(i,r),this},touch:function p2e(e,t){const n=t||Ik;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this},update:function g2e(e,t,n){const i=n||Ik;return(e.set(t)||i.force)&&this.touch(e,i),this},changeset:Qf,ingest:function KTe(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))},parse:function YTe(e,t){const n=this.locale();return HW(e,t,n.timeParse,n.utcParse)},preload:function XTe(e,t,n){return Mk.apply(this,arguments)},request:function JTe(e,t){return Ak.apply(this,arguments)},events:function WTe(e,t,n,i){const r=this,s=nd(n,i),o=function(u){u.dataflow=r;try{s.receive(u)}catch(c){r.error(c)}finally{r.run()}};let a;a="string"==typeof e&&"undefined"!=typeof document?document.querySelectorAll(e):we(e);const l=a.length;for(let u=0;u<l;++u)a[u].addEventListener(t,o);return s},on:function e2e(e,t,n,i,r){return(e instanceof pn?n2e:t2e)(this,e,t,n,i,r),this},evaluate:function a2e(e,t,n){return Nk.apply(this,arguments)},run:function u2e(e,t,n){return this._pulse?ZW(this):(this.evaluate(e,t,n),this)},runAsync:function l2e(e,t,n){return kk.apply(this,arguments)},runAfter:function c2e(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(i){this.error(i)}},_enqueue:function d2e(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))},_getPulse:function f2e(e,t){const n=e.source,i=this._clock;return n&&ie(n)?new Ok(this,i,n.map(r=>r.pulse),t):this._input[e.id]||function h2e(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==OD&&(e.source=t.source),e)}(this._pulse,n&&n.pulse)}},fe(Q,pn,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Ug={};function tY(e){const t=nY(e);return t&&t.Definition||null}function nY(e){return e=e&&e.toLowerCase(),Fe(Ug,e)?Ug[e]:null}function Zf(e,t){let n;if(void 0===t)for(const i of e)null!=i&&(n<i||void 0===n&&i>=i)&&(n=i);else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}function Rk(e,t){let n;if(void 0===t)for(const i of e)null!=i&&(n>i||void 0===n&&i>=i)&&(n=i);else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(n>r||void 0===n&&r>=r)&&(n=r)}return n}function kD(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}function rY(e,t,n=0,i=e.length-1,r){for(r=void 0===r?kD:function iY(e=zu){if(e===zu)return kD;if("function"!=typeof e)throw new TypeError("compare is not a function");return(t,n)=>{const i=e(t,n);return i||0===i?i:(0===e(n,n))-(0===e(t,t))}}(r);i>n;){if(i-n>600){const l=i-n+1,u=t-n+1,c=Math.log(l),d=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*d*(l-d)/l)*(u-l/2<0?-1:1);rY(e,t,Math.max(n,Math.floor(t-u*d/l+f)),Math.min(i,Math.floor(t+(l-u)*d/l+f)),r)}const s=e[t];let o=n,a=i;for(gy(e,n,t),r(e[i],s)>0&&gy(e,n,i);o<a;){for(gy(e,o,a),++o,--a;r(e[o],s)<0;)++o;for(;r(e[a],s)>0;)--a}0===r(e[n],s)?gy(e,n,a):(++a,gy(e,a,i)),a<=t&&(n=a+1),t<=a&&(i=a-1)}return e}function gy(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function sY(e){return null===e?NaN:+e}function Fk(e,t,n){if(e=Float64Array.from(function*v2e(e,t){if(void 0===t)for(let n of e)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)null!=(i=t(i,++n,e))&&(i=+i)>=i&&(yield i)}}(e,n)),i=e.length){if((t=+t)<=0||i<2)return Rk(e);if(t>=1)return Zf(e);var i,r=(i-1)*t,s=Math.floor(r),o=Zf(rY(e,s).subarray(0,s+1));return o+(Rk(e.subarray(s+1))-o)*(r-s)}}function oY(e,t,n=sY){if(i=e.length){if((t=+t)<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,s=Math.floor(r),o=+n(e[s],s,e);return o+(+n(e[s+1],s+1,e)-o)*(r-s)}}function aY(e,t){return Fk(e,.5,t)}function*lY(e,t){if(null==t)for(let n of e)null!=n&&""!==n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)i=t(i,++n,e),null!=i&&""!==i&&(i=+i)>=i&&(yield i)}}function Pk(e,t,n){const i=Float64Array.from(lY(e,n));return i.sort(zu),t.map(r=>oY(i,r))}function Lk(e,t){return Pk(e,[.25,.5,.75],t)}function jk(e,t){const n=e.length,i=function w2e(e,t){const n=function b2e(e,t){let i,n=0,r=0,s=0;if(void 0===t)for(let o of e)null!=o&&(o=+o)>=o&&(i=o-r,r+=i/++n,s+=i*(o-r));else{let o=-1;for(let a of e)null!=(a=t(a,++o,e))&&(a=+a)>=a&&(i=a-r,r+=i/++n,s+=i*(a-r))}if(n>1)return s/(n-1)}(e,t);return n&&Math.sqrt(n)}(e,t),r=Lk(e,t);return 1.06*(Math.min(i,(r[2]-r[0])/1.34)||i||Math.abs(r[0])||1)*Math.pow(n,-.2)}function uY(e){const t=e.maxbins||20,n=e.base||10,i=Math.log(n),r=e.divide||[5,2];let a,l,u,c,d,f,s=e.extent[0],o=e.extent[1];const h=e.span||o-s||Math.abs(s)||1;if(e.step)a=e.step;else if(e.steps){for(c=h/t,d=0,f=e.steps.length;d<f&&e.steps[d]<c;++d);a=e.steps[Math.max(0,d-1)]}else{for(l=Math.ceil(Math.log(t)/i),u=e.minstep||0,a=Math.max(u,Math.pow(n,Math.round(Math.log(h)/i)-l));Math.ceil(h/a)>t;)a*=n;for(d=0,f=r.length;d<f;++d)c=a/r[d],c>=u&&h/c<=t&&(a=c)}c=Math.log(a);const g=Math.pow(n,-(c>=0?0:1+~~(-c/i))-1);return(e.nice||void 0===e.nice)&&(c=Math.floor(s/a+g)*a,s=s<c?c-a:c,o=Math.ceil(o/a)*a),{start:s,stop:o===s?s+a:o,step:a}}var jo=Math.random;function D2e(e){jo=e}function cY(e,t,n,i){if(!e.length)return[void 0,void 0];const r=Float64Array.from(lY(e,i)),s=r.length,o=t;let a,l,u,c;for(u=0,c=Array(o);u<o;++u){for(a=0,l=0;l<s;++l)a+=r[~~(jo()*s)];c[u]=a/s}return c.sort(zu),[Fk(c,n/2),Fk(c,1-n/2)]}function dY(e,t,n,i){i=i||(f=>f);const r=e.length,s=new Float64Array(r);let d,o=0,a=1,l=i(e[0]),u=l,c=l+t;for(;a<r;++a){if(d=i(e[a]),d>=c){for(u=(l+u)/2;o<a;++o)s[o]=u;c=d+t,l=d}u=d}for(u=(l+u)/2;o<a;++o)s[o]=u;return n?function C2e(e,t){const n=e.length;let s,o,i=0,r=1;for(;e[i]===e[r];)++r;for(;r<n;){for(s=r+1;e[r]===e[s];)++s;if(e[r]-e[r-1]<t){for(o=r+(i+s-r-r>>1);o<r;)e[o++]=e[r];for(;o>r;)e[o--]=e[i]}i=r,r=s}return e}(s,t+t/4):s}function E2e(e){return function(){return(e=(1103515245*e+12345)%2147483647)/2147483647}}function S2e(e,t){let n,i,r;null==t&&(t=e,e=0);const s={min(o){return arguments.length?(n=o||0,r=i-n,s):n},max(o){return arguments.length?(i=o||0,r=i-n,s):i},sample:()=>n+Math.floor(r*jo()),pdf:o=>o===Math.floor(o)&&o>=n&&o<i?1/r:0,cdf(o){const a=Math.floor(o);return a<n?0:a>=i?1:(a-n+1)/r},icdf:o=>o>=0&&o<=1?n-1+Math.floor(o*r):NaN};return s.min(e).max(t)}const fY=Math.sqrt(2*Math.PI),x2e=Math.SQRT2;let my=NaN;function ID(e,t){e=e||0,t=null==t?1:t;let r,s,n=0,i=0;if(my==my)n=my,my=NaN;else{do{n=2*jo()-1,i=2*jo()-1,r=n*n+i*i}while(0===r||r>1);s=Math.sqrt(-2*Math.log(r)/r),n*=s,my=i*s}return e+n*t}function Bk(e,t,n){const i=(e-(t||0))/(n=null==n?1:n);return Math.exp(-.5*i*i)/(n*fY)}function RD(e,t,n){const i=(e-(t=t||0))/(n=null==n?1:n),r=Math.abs(i);let s;if(r>37)s=0;else{const o=Math.exp(-r*r/2);let a;r<7.07106781186547?(a=.0352624965998911*r+.700383064443688,a=a*r+6.37396220353165,a=a*r+33.912866078383,a=a*r+112.079291497871,a=a*r+221.213596169931,a=a*r+220.206867912376,s=o*a,a=.0883883476483184*r+1.75566716318264,a=a*r+16.064177579207,a=a*r+86.7807322029461,a=a*r+296.564248779674,a=a*r+637.333633378831,a=a*r+793.826512519948,a=a*r+440.413735824752,s/=a):(a=r+.65,a=r+4/a,a=r+3/a,a=r+2/a,a=r+1/a,s=o/a/2.506628274631)}return i>0?1-s:s}function FD(e,t,n){return e<0||e>1?NaN:(t||0)+(null==n?1:n)*x2e*function A2e(e){let n,t=-Math.log((1-e)*(1+e));return t<6.25?(t-=3.125,n=-364441206401782e-35,n=n*t-16850591381820166e-35,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=n*t-1333171662854621e-31,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=n*t-4054566272975207e-29,n=n*t-8151934197605472e-29,n=26335093153082323e-28+n*t,n=n*t-12975133253453532e-27,n=n*t-5415412054294628e-26,n=1.0512122733215323e-9+n*t,n=n*t-4.112633980346984e-9,n=n*t-2.9070369957882005e-8,n=4.2347877827932404e-7+n*t,n=n*t-13654692000834679e-22,n=n*t-13882523362786469e-21,n=.00018673420803405714+n*t,n=n*t-.000740702534166267,n=n*t-.006033670871430149,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=2.2137376921775787e-9,n=9.075656193888539e-8+n*t,n=n*t-2.7517406297064545e-7,n=1.8239629214389228e-8+n*t,n=15027403968909828e-22+n*t,n=n*t-4013867526981546e-21,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=n*t-47318229009055734e-21,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=n*t-.0003550375203628475,n=.0009532893797373805+n*t,n=n*t-.0016882755560235047,n=.002491442096107851+n*t,n=n*t-.003751208507569241,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=n*t-2.555641816996525e-10,n=1.5076572693500548e-9+n*t,n=n*t-3.789465440126737e-9,n=7.61570120807834e-9+n*t,n=n*t-1.496002662714924e-8,n=2.914795345090108e-8+n*t,n=n*t-6.771199775845234e-8,n=2.2900482228026655e-7+n*t,n=n*t-9.9298272942317e-7,n=4526062597223154e-21+n*t,n=n*t-1968177810553167e-20,n=7599527703001776e-20+n*t,n=n*t-.00021503011930044477,n=n*t-.00013871931833623122,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}(2*e-1)}function $k(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=null==s?1:s,r):i},sample:()=>ID(n,i),pdf:s=>Bk(s,n,i),cdf:s=>RD(s,n,i),icdf:s=>FD(s,n,i)};return r.mean(e).stdev(t)}function Vk(e,t){const n=$k();let i=0;const r={data(s){return arguments.length?(e=s,i=s?s.length:0,r.bandwidth(t)):e},bandwidth(s){return arguments.length?(!(t=s)&&e&&(t=jk(e)),r):t},sample:()=>e[~~(jo()*i)]+t*n.sample(),pdf(s){let o=0,a=0;for(;a<i;++a)o+=n.pdf((s-e[a])/t);return o/t/i},cdf(s){let o=0,a=0;for(;a<i;++a)o+=n.cdf((s-e[a])/t);return o/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(e)}function Hk(e,t){return e=e||0,t=null==t?1:t,Math.exp(e+ID()*t)}function Uk(e,t,n){if(e<=0)return 0;t=t||0,n=null==n?1:n;const i=(Math.log(e)-t)/n;return Math.exp(-.5*i*i)/(n*fY*e)}function zk(e,t,n){return RD(Math.log(e),t,n)}function qk(e,t,n){return Math.exp(FD(e,t,n))}function hY(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=null==s?1:s,r):i},sample:()=>Hk(n,i),pdf:s=>Uk(s,n,i),cdf:s=>zk(s,n,i),icdf:s=>qk(s,n,i)};return r.mean(e).stdev(t)}function pY(e,t){let i,n=0;const s={weights(o){return arguments.length?(i=function r(o){const a=[];let u,l=0;for(u=0;u<n;++u)l+=a[u]=null==o[u]?1:+o[u];for(u=0;u<n;++u)a[u]/=l;return a}(t=o||[]),s):t},distributions(o){return arguments.length?(o?(n=o.length,e=o):(n=0,e=[]),s.weights(t)):e},sample(){const o=jo();let a=e[n-1],l=i[0],u=0;for(;u<n-1;l+=i[++u])if(o<l){a=e[u];break}return a.sample()},pdf(o){let a=0,l=0;for(;l<n;++l)a+=i[l]*e[l].pdf(o);return a},cdf(o){let a=0,l=0;for(;l<n;++l)a+=i[l]*e[l].cdf(o);return a},icdf(){throw Error("Mixture icdf not supported.")}};return s.distributions(e).weights(t)}function Gk(e,t){return null==t&&(t=null==e?1:e,e=0),e+(t-e)*jo()}function Wk(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function Yk(e,t,n){return null==n&&(n=null==t?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function Kk(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function gY(e,t){let n,i;const r={min(s){return arguments.length?(n=s||0,r):n},max(s){return arguments.length?(i=null==s?1:s,r):i},sample:()=>Gk(n,i),pdf:s=>Wk(s,n,i),cdf:s=>Yk(s,n,i),icdf:s=>Kk(s,n,i)};return null==t&&(t=null==e?1:e,e=0),r.min(e).max(t)}function _y(e,t,n,i){const r=i-e*e,s=Math.abs(r)<1e-24?0:(n-e*t)/r;return[t-s*e,s]}function PD(e,t,n,i){e=e.filter(h=>{let p=t(h),g=n(h);return null!=p&&(p=+p)>=p&&null!=g&&(g=+g)>=g}),i&&e.sort((h,p)=>t(h)-t(p));const r=e.length,s=new Float64Array(r),o=new Float64Array(r);let c,d,f,a=0,l=0,u=0;for(f of e)s[a]=c=+t(f),o[a]=d=+n(f),++a,l+=(c-l)/a,u+=(d-u)/a;for(a=0;a<r;++a)s[a]-=l,o[a]-=u;return[s,o,l,u]}function yy(e,t,n,i){let s,o,r=-1;for(const a of e)s=t(a),o=n(a),null!=s&&(s=+s)>=s&&null!=o&&(o=+o)>=o&&i(s,o,++r)}function zg(e,t,n,i,r){let s=0,o=0;return yy(e,t,n,(a,l)=>{const u=l-r(a),c=l-i;s+=u*u,o+=c*c}),1-s/o}function Jk(e,t,n){let i=0,r=0,s=0,o=0,a=0;yy(e,t,n,(c,d)=>{++a,i+=(c-i)/a,r+=(d-r)/a,s+=(c*d-s)/a,o+=(c*c-o)/a});const l=_y(i,r,s,o),u=c=>l[0]+l[1]*c;return{coef:l,predict:u,rSquared:zg(e,t,n,r,u)}}function mY(e,t,n){let i=0,r=0,s=0,o=0,a=0;yy(e,t,n,(c,d)=>{++a,c=Math.log(c),i+=(c-i)/a,r+=(d-r)/a,s+=(c*d-s)/a,o+=(c*c-o)/a});const l=_y(i,r,s,o),u=c=>l[0]+l[1]*Math.log(c);return{coef:l,predict:u,rSquared:zg(e,t,n,r,u)}}function _Y(e,t,n){const[i,r,s,o]=PD(e,t,n);let f,h,p,a=0,l=0,u=0,c=0,d=0;yy(e,t,n,(y,v)=>{f=i[d++],h=Math.log(v),p=f*v,a+=(v*h-a)/d,l+=(p-l)/d,u+=(p*h-u)/d,c+=(f*p-c)/d});const[g,m]=_y(l/o,a/o,u/o,c/o),_=y=>Math.exp(g+m*(y-s));return{coef:[Math.exp(g-m*s),m],predict:_,rSquared:zg(e,t,n,o,_)}}function yY(e,t,n){let i=0,r=0,s=0,o=0,a=0,l=0;yy(e,t,n,(d,f)=>{const h=Math.log(d),p=Math.log(f);++l,i+=(h-i)/l,r+=(p-r)/l,s+=(h*p-s)/l,o+=(h*h-o)/l,a+=(f-a)/l});const u=_y(i,r,s,o),c=d=>u[0]*Math.pow(d,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:c,rSquared:zg(e,t,n,a,c)}}function Xk(e,t,n){const[i,r,s,o]=PD(e,t,n),a=i.length;let h,p,g,m,l=0,u=0,c=0,d=0,f=0;for(h=0;h<a;)p=i[h],g=r[h++],m=p*p,l+=(m-l)/h,u+=(m*p-u)/h,c+=(m*m-c)/h,d+=(p*g-d)/h,f+=(m*g-f)/h;const _=c-l*l,y=l*_-u*u,v=(f*l-d*u)/y,b=(d*_-f*u)/y,D=-v*l,C=w=>v*(w-=s)*w+b*w+D+o;return{coef:[D-b*s+v*s*s+o,b-2*v*s,v],predict:C,rSquared:zg(e,t,n,o,C)}}function vY(e,t,n,i){if(1===i)return Jk(e,t,n);if(2===i)return Xk(e,t,n);const[r,s,o,a]=PD(e,t,n),l=r.length,u=[],c=[],d=i+1;let f,h,p,g,m;for(f=0;f<d;++f){for(p=0,g=0;p<l;++p)g+=Math.pow(r[p],f)*s[p];for(u.push(g),m=new Float64Array(d),h=0;h<d;++h){for(p=0,g=0;p<l;++p)g+=Math.pow(r[p],f+h);m[h]=g}c.push(m)}c.push(u);const _=function T2e(e){const t=e.length-1,n=[];let i,r,s,o,a;for(i=0;i<t;++i){for(o=i,r=i+1;r<t;++r)Math.abs(e[i][r])>Math.abs(e[i][o])&&(o=r);for(s=i;s<t+1;++s)a=e[s][i],e[s][i]=e[s][o],e[s][o]=a;for(r=i+1;r<t;++r)for(s=t;s>=i;s--)e[s][r]-=e[s][i]*e[i][r]/e[i][i]}for(r=t-1;r>=0;--r){for(a=0,s=r+1;s<t;++s)a+=e[s][r]*n[s];n[r]=(e[t][r]-a)/e[r][r]}return n}(c),y=v=>{let b=a+_[0]+_[1]*(v-=o)+_[2]*v*v;for(f=3;f<d;++f)b+=_[f]*Math.pow(v,f);return b};return{coef:M2e(d,_,-o,a),predict:y,rSquared:zg(e,t,n,a,y)}}function M2e(e,t,n,i){const r=Array(e);let s,o,a,l;for(s=0;s<e;++s)r[s]=0;for(s=e-1;s>=0;--s)for(a=t[s],l=1,r[s]+=a,o=1;o<=s;++o)l*=(s+1-o)/o,r[s-o]+=a*Math.pow(n,o)*l;return r[0]+=i,r}function DY(e,t,n,i){const[r,s,o,a]=PD(e,t,n,!0),l=r.length,u=Math.max(2,~~(i*l)),c=new Float64Array(l),d=new Float64Array(l),f=new Float64Array(l).fill(1);for(let h=-1;++h<=2;){const p=[0,u-1];for(let m=0;m<l;++m){const _=r[m],y=p[0],v=p[1];let D=0,C=0,w=0,E=0,N=0;const k=1/Math.abs(r[_-r[y]>r[v]-_?y:v]-_||1);for(let B=y;B<=v;++B){const T=r[B],A=s[B],x=O2e(Math.abs(_-T)*k)*f[B],F=T*x;D+=x,C+=F,w+=A*x,E+=A*F,N+=T*F}const[I,L]=_y(C/D,w/D,E/D,N/D);c[m]=I+L*_,d[m]=Math.abs(s[m]-c[m]),N2e(r,m+1,p)}if(2===h)break;const g=aY(d);if(Math.abs(g)<1e-12)break;for(let _,y,m=0;m<l;++m)_=d[m]/(6*g),f[m]=_>=1?1e-12:(y=1-_*_)*y}return function k2e(e,t,n,i){const r=e.length,s=[];let u,o=0,a=0,l=[];for(;o<r;++o)u=e[o]+n,l[0]===u?l[1]+=(t[o]-l[1])/++a:(a=0,l[1]+=i,l=[u,t[o]],s.push(l));return l[1]+=i,s}(r,c,o,a)}function O2e(e){return(e=1-e*e*e)*e*e}function N2e(e,t,n){const i=e[t];let r=n[0],s=n[1]+1;if(!(s>=e.length))for(;t>r&&e[s]-i<=i-e[r];)n[0]=++r,n[1]=s,++s}const I2e=.5*Math.PI/180;function LD(e,t,n,i){n=n||25,i=Math.max(n,i||200);const r=g=>[g,e(g)],s=t[0],o=t[1],a=o-s,l=a/i,u=[r(s)],c=[];if(n===i){for(let g=1;g<i;++g)u.push(r(s+g/n*a));return u.push(r(o)),u}c.push(r(o));for(let g=n;--g>0;)c.push(r(s+g/n*a));let d=u[0],f=c[c.length-1];const h=1/a,p=function R2e(e,t){let n=e,i=e;const r=t.length;for(let s=0;s<r;++s){const o=t[s][1];o<n&&(n=o),o>i&&(i=o)}return 1/(i-n)}(d[1],c);for(;f;){const g=r((d[0]+f[0])/2);g[0]-d[0]>=l&&F2e(d,g,f,h,p)>I2e?c.push(g):(d=f,u.push(f),c.pop()),f=c[c.length-1]}return u}function F2e(e,t,n,i,r){const s=Math.atan2(r*(n[1]-e[1]),i*(n[0]-e[0])),o=Math.atan2(r*(t[1]-e[1]),i*(t[0]-e[0]));return Math.abs(s-o)}function Qs(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((t-e)/n)),s=new Array(r);++i<r;)s[i]=e+i*n;return s}function Qk(e){return e&&e.length?1===e.length?e[0]:function L2e(e){return t=>{const n=e.length;let i=1,r=String(e[0](t));for(;i<n;++i)r+="|"+e[i](t);return r}}(e):function(){return""}}function CY(e,t,n){return n||e+(t?"_"+t:"")}const Zk=()=>{},j2e={init:Zk,add:Zk,rem:Zk,idx:0},vy={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||void 0===e.min)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||void 0===e.max)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},by=Object.keys(vy);function EY(e,t){return vy[e](t)}function SY(e,t){return e.idx-t.idx}function V2e(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function H2e(e,t){null!=e&&""!==e?e==e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t))):++this.missing}function U2e(e,t){null!=e&&""!==e?e==e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t))):--this.missing}function z2e(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function xY(e,t){const n=t||mr,i=function $2e(e){const t={};e.forEach(i=>t[i.name]=i);const n=i=>{!i.req||i.req.forEach(r=>{t[r]||n(t[r]=vy[r]())})};return e.forEach(n),Object.values(t).sort(SY)}(e),r=e.slice().sort(SY);function s(o){this._ops=i,this._out=r,this.cell=o,this.init()}return s.prototype.init=V2e,s.prototype.add=H2e,s.prototype.rem=U2e,s.prototype.set=z2e,s.prototype.get=n,s.fields=e.map(o=>o.out),s}function eI(e){this._key=e?ds(e):je,this.reset()}by.forEach(e=>{vy[e]=function B2e(e,t){return n=>ot({name:e,out:n||e},j2e,t)}(e,vy[e])});const Xi=eI.prototype;function sd(e){Q.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}function tI(e){Q.call(this,null,e)}function AY(e,t,n){const i=e;let r=t||[],s=n||[],o={},a=0;return{add:l=>s.push(l),remove:l=>o[i(l)]=++a,size:()=>r.length,data:(l,u)=>(a&&(r=r.filter(c=>!o[i(c)]),o={},a=0),u&&l&&r.sort(l),s.length&&(r=l?hG(l,r,s.sort(l)):r.concat(s),s=[]),r)}}function nI(e){Q.call(this,[],e)}function MY(e){pn.call(this,null,G2e,e)}function G2e(e){return this.value&&!e.modified()?this.value:MN(e.fields,e.orders)}function iI(e){Q.call(this,null,e)}function rI(e){Q.call(this,null,e)}Xi.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},Xi.add=function(e){this._add.push(e)},Xi.rem=function(e){this._rem.push(e)},Xi.values=function(){if(this._get=null,0===this._rem.length)return this._add;const e=this._add,t=this._rem,n=this._key,i=e.length,r=t.length,s=Array(i-r),o={};let a,l,u;for(a=0;a<r;++a)o[n(t[a])]=1;for(a=0,l=0;a<i;++a)o[n(u=e[a])]?o[n(u)]=0:s[l++]=u;return this._rem=[],this._add=s},Xi.distinct=function(e){const t=this.values(),n={};let s,i=t.length,r=0;for(;--i>=0;)s=e(t[i])+"",Fe(n,s)||(n[s]=1,++r);return r},Xi.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=aG(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},Xi.argmin=function(e){return this.extent(e)[0]||{}},Xi.argmax=function(e){return this.extent(e)[1]||{}},Xi.min=function(e){const t=this.extent(e)[0];return null!=t?e(t):void 0},Xi.max=function(e){const t=this.extent(e)[1];return null!=t?e(t):void 0},Xi.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=Lk(this.values(),e),this._get=e),this._q},Xi.q1=function(e){return this.quartile(e)[0]},Xi.q2=function(e){return this.quartile(e)[1]},Xi.q3=function(e){return this.quartile(e)[2]},Xi.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=cY(this.values(),1e3,.05,e),this._get=e),this._ci},Xi.ci0=function(e){return this.ci(e)[0]},Xi.ci1=function(e){return this.ci(e)[1]},sd.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:by},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},fe(sd,Q,{transform(e,t){const n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.modified();return n.stamp=i.stamp,n.value&&(r||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(n.value=n.value||n.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),i.modifies(n._outputs),n._drop=!1!==e.drop,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},cross(){const e=this,t=e.value,n=e._dnames,i=n.map(()=>({})),r=n.length;function s(a){let l,u,c,d;for(l in a)for(c=a[l].tuple,u=0;u<r;++u)i[u][d=c[n[u]]]=d}s(e._prev),s(t),function o(a,l,u){const c=n[u],d=i[u++];for(const f in d){const h=a?a+"|"+f:f;l[c]=d[f],u<r?o(h,l,u):t[h]||e.cell(h,l)}}("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],i={};function r(m){const _=we(gr(m)),y=_.length;let b,v=0;for(;v<y;++v)i[b=_[v]]||(i[b]=1,t.push(b))}this._dims=we(e.groupby),this._dnames=this._dims.map(m=>{const _=Gn(m);return r(m),n.push(_),_}),this.cellkey=e.key?e.key:Qk(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const s=e.fields||[null],o=e.ops||["count"],a=e.as||[],l=s.length,u={};let c,d,f,h,p,g;for(l!==o.length&&te("Unmatched number of fields and aggregate ops."),g=0;g<l;++g)c=s[g],d=o[g],null==c&&"count"!==d&&te("Null aggregate field specified."),h=Gn(c),p=CY(d,h,a[g]),n.push(p),"count"!==d?(f=u[h],f||(r(c),f=u[h]=[],f.field=c,this._measures.push(f)),"count"!==d&&(this._countOnly=!1),f.push(EY(d,p))):this._counts.push(p);return this._measures=this._measures.map(m=>xY(m,m.field)),{}},cellkey:Qk(),cell(e,t){let n=this.value[e];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const i=this._measures,r=i.length;n.agg=Array(r);for(let s=0;s<r;++s)n.agg[s]=new i[s](n)}return n.store&&(n.data=new eI),n},newtuple(e,t){const n=this._dnames,i=this._dims,r=i.length,s={};for(let o=0;o<r;++o)s[n[o]]=i[o](e);return t?qW(t.tuple,s):Ut(s)},clean(){const e=this.value;for(const t in e)0===e[t].num&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].add(i[r].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].rem(i[r].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let i=0,r=n.length;i<r;++i)t[n[i]]=e.num;if(!this._countOnly){const i=e.agg;for(let r=0,s=i.length;r<s;++r)i[r].set(t)}return t},changes(e){const t=this._adds,n=this._mods,i=this._prev,r=this._drop,s=e.add,o=e.rem,a=e.mod;let l,u,c,d;if(i)for(u in i)l=i[u],(!r||l.num)&&o.push(l.tuple);for(c=0,d=this._alen;c<d;++c)s.push(this.celltuple(t[c])),t[c]=null;for(c=0,d=this._mlen;c<d;++c)l=n[c],(0===l.num&&r?o:a).push(this.celltuple(l)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}}),tI.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},fe(tI,Q,{transform(e,t){const n=!1!==e.interval,i=this._bins(e),r=i.start,s=i.step,o=e.as||["bin0","bin1"],a=o[0],l=o[1];let u;return u=e.modified()?(t=t.reflow(!0)).SOURCE:t.modified(gr(e.field))?t.ADD_MOD:t.ADD,t.visit(u,n?c=>{const d=i(c);c[a]=d,c[l]=null==d?null:r+s*(1+(d-r)/s)}:c=>c[a]=i(c)),t.modifies(n?o:a)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=uY(e),i=n.step;let o,a,r=n.start,s=r+Math.ceil((n.stop-r)/i)*i;null!=(o=e.anchor)&&(a=o-(r+i*Math.floor((o-r)/i)),r+=a,s+=a);const l=function(u){let c=_r(t(u));return null==c?null:c<r?-1/0:c>s?1/0:(c=Math.max(r,Math.min(c,s-i)),r+i*Math.floor(1e-14+(c-r)/i))};return l.start=r,l.stop=n.stop,l.step=i,this.value=cs(l,gr(t),e.name||"bin_"+Gn(t))}}),nI.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},fe(nI,Q,{transform(e,t){const n=t.fork(t.ALL),i=AY(je,this.value,n.materialize(n.ADD).add),r=e.sort,s=t.changed()||r&&(e.modified("sort")||t.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(s),this.value=n.source=i.data(Xf(r),s),t.source&&t.source.root&&(this.value.root=t.source.root),n}}),fe(MY,pn),iI.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},fe(iI,Q,{transform(e,t){const n=d=>f=>{for(var p,h=function W2e(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase()}return e.match(n)}(a(f),e.case,s)||[],g=0,m=h.length;g<m;++g)o.test(p=h[g])||d(p)},i=this._parameterCheck(e,t),r=this._counts,s=this._match,o=this._stop,a=e.field,l=e.as||["text","count"],u=n(d=>r[d]=1+(r[d]||0)),c=n(d=>r[d]-=1);return i?t.visit(t.SOURCE,u):(t.visit(t.ADD,u),t.visit(t.REM,c)),this._finish(t,l)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,i=this._tuples||(this._tuples={}),r=t[0],s=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS);let a,l,u;for(a in n)l=i[a],u=n[a]||0,!l&&u?(i[a]=l=Ut({}),l[r]=a,l[s]=u,o.add.push(l)):0===u?(l&&o.rem.push(l),n[a]=null,i[a]=null):l[s]!==u&&(l[s]=u,o.mod.push(l));return o.modifies(t)}}),rI.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},fe(rI,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.as||["a","b"],r=i[0],s=i[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let a=this.value;return o?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=function Y2e(e,t,n,i){for(var l,u,r=[],s={},o=e.length,a=0;a<o;++a)for(s[t]=u=e[a],l=0;l<o;++l)s[n]=e[l],i(s)&&(r.push(Ut(s)),(s={})[t]=u);return r}(a,r,s,e.filter||Fo)):n.mod=a,n.source=this.value,n.modifies(i)}});const TY={kde:Vk,mixture:pY,normal:$k,lognormal:hY,uniform:gY},OY="function";function NY(e,t){const n=e[OY];Fe(TY,n)||te("Unknown distribution function: "+n);const i=TY[n]();for(const r in e)"field"===r?i.data((e.from||t()).map(e[r])):"distributions"===r?i[r](e[r].map(s=>NY(s,t))):typeof i[r]===OY&&i[r](e[r]);return i}function sI(e){Q.call(this,null,e)}const kY=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}];function IY(e,t){return e?e.map((n,i)=>t[i]||Gn(n)):null}function oI(e,t,n){const i=[],r=d=>d(l);let s,o,a,l,u,c;if(null==t)i.push(e.map(n));else for(s={},o=0,a=e.length;o<a;++o)l=e[o],u=t.map(r),c=s[u],c||(s[u]=c=[],c.dims=u,i.push(c)),c.push(n(l));return i}function aI(e){Q.call(this,null,e)}function FY(e){pn.call(this,null,eOe,e),this.modified(!0)}function eOe(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:cs(n=>t(n,e),gr(t),Gn(t))}function lI(e){Q.call(this,[void 0,void 0],e)}function uI(e,t){pn.call(this,e),this.parent=t,this.count=0}function jD(e){Q.call(this,{},e),this._keys=Og();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let i=0,r=t.active;i<r;++i)n(t[i],i,t)}}function PY(e){pn.call(this,null,tOe,e)}function tOe(e){return this.value&&!e.modified()?this.value:ie(e.name)?we(e.name).map(t=>ds(t)):ds(e.name,e.as)}function cI(e){Q.call(this,Og(),e)}function dI(e){Q.call(this,[],e)}function fI(e){Q.call(this,[],e)}function hI(e){Q.call(this,null,e)}function LY(e){Q.call(this,[],e)}sI.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:kY.concat({key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:kY},{name:"weights",type:"number",array:!0}]})},{name:"as",type:"string",array:!0,default:["value","density"]}]},fe(sI,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=NY(e.distribution,function Q2e(e){return()=>e.materialize(e.SOURCE).source}(t)),r=e.steps||e.minsteps||25,s=e.steps||e.maxsteps||200;let o=e.method||"pdf";"pdf"!==o&&"cdf"!==o&&te("Invalid density method: "+o),!e.extent&&!i.data&&te("Missing density extent parameter."),o=i[o];const a=e.as||["value","density"],u=LD(o,e.extent||Al(i.data()),r,s).map(c=>{const d={};return d[a[0]]=c[0],d[a[1]]=c[1],Ut(d)});this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}}),aI.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]},fe(aI,Q,{transform(e,t){if(this.value&&!e.modified()&&!t.changed())return t;const n=t.materialize(t.SOURCE).source,i=oI(t.source,e.groupby,mr),r=e.smooth||!1,s=e.field,o=e.step||((e,t)=>Q_(Al(e,t))/30)(n,s),a=Xf((p,g)=>s(p)-s(g)),l=e.as||"bin",u=i.length;let h,c=1/0,d=-1/0,f=0;for(;f<u;++f){const p=i[f].sort(a);h=-1;for(const g of dY(p,o,r,s))g<c&&(c=g),g>d&&(d=g),p[++h][l]=g}return this.value={start:c,stop:d,step:o},t.reflow(!0).modifies(l)}}),fe(FY,pn),lI.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},fe(lI,Q,{transform(e,t){const n=this.value,i=e.field,r=t.changed()||t.modified(i.fields)||e.modified("field");let s=n[0],o=n[1];if((r||null==s)&&(s=1/0,o=-1/0),t.visit(r?t.SOURCE:t.ADD,a=>{const l=_r(i(a));null!=l&&(l<s&&(s=l),l>o&&(o=l))}),!Number.isFinite(s)||!Number.isFinite(o)){let a=Gn(i);a&&(a=' for field "'.concat(a,'"')),t.dataflow.warn("Infinite extent".concat(a,": [").concat(s,", ").concat(o,"]")),s=o=void 0}this.value=[s,o]}}),fe(uI,pn,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}}),fe(jD,Q,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,i){const r=this.value;let o,a,s=Fe(r,e)&&r[e];return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=i||(a=this._group[e])&&a.tuple,o=n.dataflow,s=new uI(n.fork(n.NO_SOURCE),this),o.add(s).connect(t(o,e,a)),r[e]=s,this.activate(s)),s},clean(){const e=this.value;let t=0;for(const n in e)if(0===e[n].count){const i=e[n].detachSubflow;i&&i(),delete e[n],++t}if(t){const n=this._targets.filter(i=>i&&i.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,i=e?e.length:0;let r=0;for(;r<i;++r)t[r]=e[r];for(;r<n&&null!=t[r];++r)t[r]=null;t.active=i},transform(e,t){const n=t.dataflow,i=e.key,r=e.subflow,s=this._keys,o=e.modified("key"),a=l=>this.subflow(l,r,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,l=>{const u=je(l),c=s.get(u);void 0!==c&&(s.delete(u),a(c).rem(l))}),t.visit(t.ADD,l=>{const u=i(l);s.set(je(l),u),a(u).add(l)}),o||t.modified(i.fields)?t.visit(t.MOD,l=>{const u=je(l),c=s.get(u),d=i(l);c===d?a(d).mod(l):(s.set(u,d),a(c).rem(l),a(d).add(l))}):t.changed(t.MOD)&&t.visit(t.MOD,l=>{a(s.get(je(l))).mod(l)}),o&&t.visit(t.REFLOW,l=>{const u=je(l),c=s.get(u),d=i(l);c!==d&&(s.set(u,d),a(c).rem(l),a(d).add(l))}),t.clean()?n.runAfter(()=>{this.clean(),s.clean()}):s.empty>n.cleanThreshold&&n.runAfter(s.clean),t}}),fe(PY,pn),cI.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},fe(cI,Q,{transform(e,t){const n=t.dataflow,i=this.value,r=t.fork(),s=r.add,o=r.rem,a=r.mod,l=e.expr;let u=!0;function c(d){const f=je(d),h=l(d,e),p=i.get(f);h&&p?(i.delete(f),s.push(d)):h||p?u&&h&&!p&&a.push(d):(i.set(f,1),o.push(d))}return t.visit(t.REM,d=>{const f=je(d);i.has(f)?i.delete(f):o.push(d)}),t.visit(t.ADD,d=>{l(d,e)?s.push(d):i.set(je(d),1)}),t.visit(t.MOD,c),e.modified()&&(u=!1,t.visit(t.REFLOW,c)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),r}}),dI.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},fe(dI,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=IY(i,e.as||[]),s=e.index||null,o=r.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{const l=i.map(p=>p(a)),u=l.reduce((p,g)=>Math.max(p,g.length),0);let d,f,h,c=0;for(;c<u;++c){for(f=xk(a),d=0;d<o;++d)f[r[d]]=null==(h=l[d][c])?null:h;s&&(f[s]=c),n.add.push(f)}}),this.value=n.source=n.add,s&&n.modifies(s),n.modifies(r)}}),fI.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},fe(fI,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=i.map(Gn),s=e.as||["key","value"],o=s[0],a=s[1],l=i.length;return n.rem=this.value,t.visit(t.SOURCE,u=>{for(let d,c=0;c<l;++c)d=xk(u),d[o]=r[c],d[a]=i[c](u),n.add.push(d)}),this.value=n.source=n.add,n.modifies(s)}}),hI.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},fe(hI,Q,{transform(e,t){const n=e.expr,i=e.as,r=e.modified(),s=e.initonly?t.ADD:r?t.SOURCE:t.modified(n.fields)||t.modified(i)?t.ADD_MOD:t.ADD;return r&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(i),t.visit(s,o=>o[i]=n(o,e))}}),fe(LY,Q,{transform(e,t){const n=t.fork(t.ALL),i=e.generator;let o,a,l,r=this.value,s=e.size-r.length;if(s>0){for(o=[];--s>=0;)o.push(l=Ut(i(e))),r.push(l);n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else a=r.slice(0,-s),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,r=r.slice(-s);return n.source=this.value=r,n}});const BD={value:"value",median:aY,mean:function P2e(e,t){let n=0,i=0;if(void 0===t)for(let r of e)null!=r&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let s of e)null!=(s=t(s,++r,e))&&(s=+s)>=s&&(++n,i+=s)}if(n)return i/n},min:Rk,max:Zf},nOe=[];function pI(e){Q.call(this,[],e)}function gI(e){sd.call(this,e)}function mI(e){Q.call(this,null,e)}function jY(e){pn.call(this,null,oOe,e)}function oOe(e){return this.value&&!e.modified()?this.value:ON(e.fields,e.flat)}function BY(e){Q.call(this,[],e),this._pending=null}function _I(e,t,n){n.forEach(Ut);const i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i}function yI(e){Q.call(this,{},e)}function $Y(e){pn.call(this,null,lOe,e)}function lOe(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let s,o,i=1/0,r=-1/0;for(s=0;s<n;++s)o=t[s],o[0]<i&&(i=o[0]),o[1]>r&&(r=o[1]);return[i,r]}function VY(e){pn.call(this,null,uOe,e)}function uOe(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function HY(e){Q.call(this,null,e)}function vI(e){sd.call(this,e)}function UY(e){jD.call(this,e)}function bI(e){Q.call(this,null,e)}function zY(e){Q.call(this,null,e)}function wI(e){Q.call(this,null,e)}function qY(e){Q.call(this,null,e)}function DI(e){Q.call(this,[],e),this.count=0}function CI(e){Q.call(this,null,e)}function GY(e){Q.call(this,null,e),this.modified(!0)}function EI(e){Q.call(this,null,e)}pI.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},fe(pI,Q,{transform(e,t){var f,h,p,g,m,_,y,v,b,D,n=t.fork(t.ALL),i=function iOe(e){var n,t=e.method||BD.value;if(null!=BD[t])return t===BD.value?(n=void 0!==e.value?e.value:0,()=>n):BD[t];te("Unrecognized imputation method: "+t)}(e),r=function rOe(e){const t=e.field;return n=>n?t(n):NaN}(e),s=Gn(e.field),o=Gn(e.key),a=(e.groupby||[]).map(Gn),l=function sOe(e,t,n,i){var u,c,d,f,h,p,g,m,r=_=>_(m),s=[],o=i?i.slice():[],a={},l={};for(o.forEach((_,y)=>a[_]=y+1),f=0,g=e.length;f<g;++f)p=n(m=e[f]),h=a[p]||(a[p]=o.push(p)),(d=l[c=(u=t?t.map(r):nOe)+""])||(d=l[c]=[],s.push(d),d.values=u),d[h-1]=m;return s.domain=o,s}(t.source,e.groupby,e.key,e.keyvals),u=[],c=this.value,d=l.domain.length;for(m=0,v=l.length;m<v;++m)for(p=(f=l[m]).values,h=NaN,y=0;y<d;++y)if(null==f[y]){for(g=l.domain[y],D={_impute:!0},_=0,b=p.length;_<b;++_)D[a[_]]=p[_];D[o]=g,D[s]=Number.isNaN(h)?h=i(f,r):h,u.push(Ut(D))}return u.length&&(n.add=n.materialize(n.ADD).add.concat(u)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=u,n}}),gI.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:by},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},fe(gI,sd,{transform(e,t){const n=this,i=e.modified();let r;return n.value&&(i||t.modified(n._inputs,!0))?(r=n.value=i?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(r=n.value=n.value||this.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),n.changes(),t.visit(t.SOURCE,s=>{ot(s,r[n.cellkey(s)].tuple)}),t.reflow(i).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n)this.celltuple(e[n]),e[n]=null;for(n=0,i=this._mlen;n<i;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}}),mI.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},fe(mI,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=oI(i,e.groupby,e.field),s=(e.groupby||[]).map(Gn),o=e.bandwidth,a=e.cumulative?"cdf":"pdf",l=e.as||["value","density"],u=[];let c=e.extent,d=e.steps||e.minsteps||25,f=e.steps||e.maxsteps||200;"pdf"!==a&&"cdf"!==a&&te("Invalid density method: "+a),"shared"===e.resolve&&(c||(c=Al(i,e.field)),d=f=e.steps||f),r.forEach(h=>{const p=Vk(h,o)[a],g=e.counts?h.length:1;LD(p,c||Al(h),d,f).forEach(_=>{const y={};for(let v=0;v<s.length;++v)y[s[v]]=h.dims[v];y[l[0]]=_[0],y[l[1]]=_[1]*g,u.push(Ut(y))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}}),fe(jY,pn),fe(BY,Q,{transform(e,t){const n=t.dataflow;return this._pending?_I(this,t,this._pending):function aOe(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}(e)?t.StopPropagation:e.values?_I(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(r=>(this._pending=we(r.data),s=>s.touch(this)))}:n.request(e.url,e.format).then(i=>_I(this,t,we(i.data)))}}),yI.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},fe(yI,Q,{transform(e,t){const n=e.fields,i=e.index,r=e.values,s=null==e.default?null:e.default,o=e.modified(),a=n.length;let d,f,h,l=o?t.SOURCE:t.ADD,u=t,c=e.as;return r?(f=r.length,a>1&&!c&&te('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==a*f&&te('The "as" parameter has too few output field names.'),c=c||r.map(Gn),d=function(p){for(var _,y,g=0,m=0;g<a;++g)if(null==(y=i.get(n[g](p))))for(_=0;_<f;++_,++m)p[c[m]]=s;else for(_=0;_<f;++_,++m)p[c[m]]=r[_](y)}):(c||te("Missing output field names."),d=function(p){for(var m,g=0;g<a;++g)m=i.get(n[g](p)),p[c[g]]=null==m?s:m}),o?u=t.reflow(!0):(h=n.some(p=>t.modified(p.fields)),l|=h?t.MOD:0),t.visit(l,d),u.modifies(c)}}),fe($Y,pn),fe(VY,pn),fe(HY,Q,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),vI.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:by,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},fe(vI,sd,{_transform:sd.prototype.transform,transform(e,t){return this._transform(function cOe(e,t){const n=e.field,i=e.value,r=("count"===e.op?"__count__":e.op)||"sum",s=gr(n).concat(gr(i)),o=function fOe(e,t,n){const i={},r=[];return n.visit(n.SOURCE,s=>{const o=e(s);i[o]||(i[o]=1,r.push(o))}),r.sort(lD),t?r.slice(0,t):r}(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:o.map(()=>r),fields:o.map(a=>function dOe(e,t,n,i){return cs(r=>t(r)===e?n(r):NaN,i,e+"")}(a,n,i,s)),as:o.map(a=>a+""),modified:e.modified.bind(e)}}(e,t),t)}}),fe(UY,jD,{transform(e,t){const n=e.subflow,i=e.field,r=s=>this.subflow(je(s),n,t,s);return(e.modified("field")||i&&t.modified(gr(i)))&&te("PreFacet does not support field modification."),this.initTargets(),i?(t.visit(t.MOD,s=>{const o=r(s);i(s).forEach(a=>o.mod(a))}),t.visit(t.ADD,s=>{const o=r(s);i(s).forEach(a=>o.add(Ut(a)))}),t.visit(t.REM,s=>{const o=r(s);i(s).forEach(a=>o.rem(a))})):(t.visit(t.MOD,s=>r(s).mod(s)),t.visit(t.ADD,s=>r(s).add(s)),t.visit(t.REM,s=>r(s).rem(s))),t.clean()&&t.runAfter(()=>this.clean()),t}}),bI.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},fe(bI,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=IY(e.fields,e.as||[]),s=i?(a,l)=>function hOe(e,t,n,i){for(let r=0,s=n.length;r<s;++r)t[i[r]]=n[r](e);return t}(a,l,i,r):xD;let o;return this.value?o=this.value:(t=t.addAll(),o=this.value={}),t.visit(t.REM,a=>{const l=je(a);n.rem.push(o[l]),o[l]=null}),t.visit(t.ADD,a=>{const l=s(a,Ut({}));o[je(a)]=l,n.add.push(l)}),t.visit(t.MOD,a=>{n.mod.push(s(a,o[je(a)]))}),n}}),fe(zY,Q,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}}),wI.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]},fe(wI,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const s=oI(t.materialize(t.SOURCE).source,e.groupby,e.field),o=(e.groupby||[]).map(Gn),a=[],l=e.step||.01,u=e.probs||Qs(l/2,1-1e-14,l),c=u.length;return s.forEach(d=>{const f=Pk(d,u);for(let h=0;h<c;++h){const p={};for(let g=0;g<o.length;++g)p[o[g]]=d.dims[g];p[i[0]]=u[h],p[i[1]]=f[h],a.push(Ut(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}}),fe(qY,Q,{transform(e,t){let n,i;return this.value?i=this.value:(n=t=t.addAll(),i=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,r=>{const s=je(r);n.rem.push(i[s]),i[s]=null}),t.visit(t.ADD,r=>{const s=xk(r);i[je(r)]=s,n.add.push(s)}),t.visit(t.MOD,r=>{const s=i[je(r)];for(const o in r)s[o]=r[o],n.modifies(o);n.mod.push(s)})),n}}),DI.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},fe(DI,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.modified("size"),r=e.size,s=this.value.reduce((c,d)=>(c[je(d)]=1,c),{});let o=this.value,a=this.count,l=0;function u(c){let d,f;o.length<r?o.push(c):(f=~~((a+1)*jo()),f<o.length&&f>=l&&(d=o[f],s[je(d)]&&n.rem.push(d),o[f]=c)),++a}if(t.rem.length&&(t.visit(t.REM,c=>{const d=je(c);s[d]&&(s[d]=-1,n.rem.push(c)),--a}),o=o.filter(c=>-1!==s[je(c)])),(t.rem.length||i)&&o.length<r&&t.source&&(l=a=o.length,t.visit(t.SOURCE,c=>{s[je(c)]||u(c)}),l=-1),i&&o.length>r){const c=o.length-r;for(let d=0;d<c;++d)s[je(o[d])]=-1,n.rem.push(o[d]);o=o.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{s[je(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,u),(t.add.length||l<0)&&(n.add=o.filter(c=>!s[je(c)])),this.count=a,this.value=n.source=o,n}}),CI.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},fe(CI,Q,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),i=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Qs(e.start,e.stop,e.step||1).map(r=>{const s={};return s[i]=r,Ut(s)}),n.add=t.add.concat(this.value),n}}),fe(GY,Q,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});const WY=["unit0","unit1"];function YY(e){Q.call(this,Og(),e)}function KY(e){Q.call(this,null,e)}EI.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:ek,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:WY}]},fe(EI,Q,{transform(e,t){const n=e.field,i=!1!==e.interval,r="utc"===e.timezone,s=this._floor(e,t),o=(r?Bg:jg)(s.unit).offset,a=e.as||WY,l=a[0],u=a[1],c=s.step;let d=s.start||1/0,f=s.stop||-1/0,h=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(gr(n)))&&(h=(t=t.reflow(!0)).SOURCE,d=1/0,f=-1/0),t.visit(h,p=>{const g=n(p);let m,_;null==g?(p[l]=null,i&&(p[u]=null)):(p[l]=m=_=s(g),i&&(p[u]=_=o(m,c)),m<d&&(d=m),_>f&&(f=_))}),s.start=d,s.stop=f,t.modifies(i?a:l)},_floor(e,t){const n="utc"===e.timezone,{units:i,step:r}=e.units?{units:e.units,step:e.step||1}:uW({extent:e.extent||Al(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),s=nk(i),o=this.value||{},a=(n?QG:XG)(s,r);return a.unit=bt(s),a.units=s,a.step=r,a.start=o.start,a.stop=o.stop,this.value=a}}),fe(YY,Q,{transform(e,t){const n=t.dataflow,i=e.field,r=this.value,s=a=>r.set(i(a),a);let o=!0;return e.modified("field")||t.modified(i.fields)?(r.clear(),t.visit(t.SOURCE,s)):t.changed()?(t.visit(t.REM,a=>r.delete(i(a))),t.visit(t.ADD,s)):o=!1,this.modified(o),r.empty>n.cleanThreshold&&n.runAfter(r.clean),t.fork()}}),fe(KY,Q,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(Xf(e.sort)):t.source).map(e.field))}});const wy={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?++e:e}}},percent_rank:function(){const e=wy.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,i=t.compare;let r=t.index;if(e<r){for(;r+1<n.length&&!i(n[r],n[r+1]);)++r;e=r}return(1+e)/n.length}}},ntile:function(e,t){(t=+t)>0||te("ntile num must be greater than zero.");const n=wy.cume_dist(),i=n.next;return{init:n.init,next:r=>Math.ceil(t*i(r))}},lag:function(e,t){return t=+t||1,{next:n=>{const i=n.index-t;return i>=0?e(n.data[i]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const i=n.index+t,r=n.data;return i<r.length?e(r[i]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return(t=+t)>0||te("nth_value nth must be greater than zero."),{next:n=>{const i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const i=e(n.data[n.index]);return null!=i?t=i:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:i=>{const r=i.data;return i.index<=n?t:(n=function mOe(e,t,n){for(let i=t.length;n<i;++n)if(null!=e(t[n]))return n;return-1}(e,r,i.index))<0?(n=r.length,t=null):t=e(r[n])}}}},_Oe=Object.keys(wy);function JY(e){const t=we(e.ops),n=we(e.fields),i=we(e.params),r=we(e.as),s=this.outputs=[],o=this.windows=[],a={},l={},u=[],c=[];let d=!0;function f(h){we(gr(h)).forEach(p=>a[p]=1)}f(e.sort),t.forEach((h,p)=>{const g=n[p],m=Gn(g),_=CY(h,m,r[p]);if(f(g),s.push(_),Fe(wy,h))o.push(function gOe(e,t,n,i){const r=wy[e](t,n);return{init:r.init||qc,update:function(s,o){o[i]=r.next(s)}}}(h,n[p],i[p],_));else{if(null==g&&"count"!==h&&te("Null aggregate field specified."),"count"===h)return void u.push(_);d=!1;let y=l[m];y||(y=l[m]=[],y.field=g,c.push(y)),y.push(EY(h,_))}}),(u.length||c.length)&&(this.cell=function yOe(e,t,n){e=e.map(l=>xY(l,l.field));const i={num:0,agg:null,store:!1,count:t};if(!n)for(var r=e.length,s=i.agg=Array(r),o=0;o<r;++o)s[o]=new e[o](i);if(i.store)var a=i.data=new eI;return i.add=function(l){if(i.num+=1,!n){a&&a.add(l);for(let u=0;u<r;++u)s[u].add(s[u].get(l),l)}},i.rem=function(l){if(i.num-=1,!n){a&&a.rem(l);for(let u=0;u<r;++u)s[u].rem(s[u].get(l),l)}},i.set=function(l){let u,c;for(a&&a.values(),u=0,c=t.length;u<c;++u)l[t[u]]=i.num;if(!n)for(u=0,c=s.length;u<c;++u)s[u].set(l)},i.init=function(){i.num=0,a&&a.reset();for(let l=0;l<r;++l)s[l].init()},i}(c,u,d)),this.inputs=Object.keys(a)}const XY=JY.prototype;function SI(e){Q.call(this,{},e),this._mlen=0,this._mods=[]}function vOe(e,t,n,i){const r=i.sort,s=r&&!i.ignorePeers,o=i.frame||[null,0],a=e.data(n),l=a.length,u=s?ey(r):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:r||yr(-1)};t.init();for(let d=0;d<l;++d)bOe(c,o,d,l),s&&wOe(c,u),t.update(c,a[d])}function bOe(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=null==t[0]?0:Math.max(0,n-Math.abs(t[0])),e.i1=null==t[1]?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n}function wOe(e,t){const n=e.i0,i=e.i1-1,r=e.compare,s=e.data,o=s.length-1;n>0&&!r(s[n],s[n-1])&&(e.i0=t.left(s,s[n])),i<o&&!r(s[i],s[i+1])&&(e.i1=t.right(s,s[i]))}function $D(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function VD(e){this._context=e}function od(){}function QY(e){this._context=e}function ZY(e){this._context=e}function eK(e,t){this._basis=new VD(e),this._beta=t}XY.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()},XY.update=function(e,t){const n=this.cell,i=this.windows,r=e.data,s=i&&i.length;let o;if(n){for(o=e.p0;o<e.i0;++o)n.rem(r[o]);for(o=e.p1;o<e.i1;++o)n.add(r[o]);n.set(t)}for(o=0;o<s;++o)i[o].update(e,t)},SI.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:_Oe.concat(by)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},fe(SI,Q,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),i=Xf(e.sort),r=Qk(e.groupby),s=a=>this.group(r(a));let o=this.state;(!o||n)&&(o=this.state=new JY(e)),n||t.modified(o.inputs)?(this.value={},t.visit(t.SOURCE,a=>s(a).add(a))):(t.visit(t.REM,a=>s(a).remove(a)),t.visit(t.ADD,a=>s(a).add(a)));for(let a=0,l=this._mlen;a<l;++a)vOe(this._mods[a],o,i,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(o.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=AY(je),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}}),VD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:$D(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:$D(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},QY.prototype={areaStart:od,areaEnd:od,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:$D(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},ZY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:$D(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},eK.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var l,i=e[0],r=t[0],s=e[n]-i,o=t[n]-r,a=-1;++a<=n;)this._basis.point(this._beta*e[a]+(1-this._beta)*(i+(l=a/n)*s),this._beta*t[a]+(1-this._beta)*(r+l*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const SOe=function e(t){function n(i){return 1===t?new VD(i):new eK(i,t)}return n.beta=function(i){return e(+i)},n}(.85);function HD(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function xI(e,t){this._context=e,this._k=(1-t)/6}xI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:HD(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:HD(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const xOe=function e(t){function n(i){return new xI(i,t)}return n.tension=function(i){return e(+i)},n}(0);function AI(e,t){this._context=e,this._k=(1-t)/6}AI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:HD(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const AOe=function e(t){function n(i){return new AI(i,t)}return n.tension=function(i){return e(+i)},n}(0);function MI(e,t){this._context=e,this._k=(1-t)/6}MI.prototype={areaStart:od,areaEnd:od,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:HD(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const MOe=function e(t){function n(i){return new MI(i,t)}return n.tension=function(i){return e(+i)},n}(0),tK=Math.abs,wr=Math.atan2,Gu=Math.cos,TOe=Math.max,qg=Math.min,gs=Math.sin,Dn=Math.sqrt,Dr=1e-12,ad=Math.PI,UD=ad/2,Dy=2*ad;function OOe(e){return e>1?0:e<-1?ad:Math.acos(e)}function nK(e){return e>=1?UD:e<=-1?-UD:Math.asin(e)}function TI(e,t,n){var i=e._x1,r=e._y1,s=e._x2,o=e._y2;if(e._l01_a>Dr){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,r=(r*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>Dr){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*u+e._x1*e._l23_2a-t*e._l12_2a)/c,o=(o*u+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(i,r,s,o,e._x2,e._y2)}function iK(e,t){this._context=e,this._alpha=t}iK.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:TI(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const NOe=function e(t){function n(i){return t?new iK(i,t):new xI(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function rK(e,t){this._context=e,this._alpha=t}rK.prototype={areaStart:od,areaEnd:od,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:TI(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const kOe=function e(t){function n(i){return t?new rK(i,t):new MI(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function sK(e,t){this._context=e,this._alpha=t}sK.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:TI(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const IOe=function e(t){function n(i){return t?new sK(i,t):new AI(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function oK(e){this._context=e}function OI(e){return new oK(e)}function aK(e){this._context=e}function lK(e){return e<0?-1:1}function uK(e,t,n){var i=e._x1-e._x0,r=t-e._x1,s=(e._y1-e._y0)/(i||r<0&&-0),o=(n-e._y1)/(r||i<0&&-0),a=(s*r+o*i)/(i+r);return(lK(s)+lK(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function cK(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function NI(e,t,n){var i=e._x0,s=e._x1,o=e._y1,a=(s-i)/3;e._context.bezierCurveTo(i+a,e._y0+a*t,s-a,o-a*n,s,o)}function zD(e){this._context=e}function dK(e){this._context=new fK(e)}function fK(e){this._context=e}function hK(e){this._context=e}function pK(e){var t,i,n=e.length-1,r=new Array(n),s=new Array(n),o=new Array(n);for(r[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)r[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(r[n-1]=2,s[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)s[t]-=i=r[t]/s[t-1],o[t]-=i*o[t-1];for(r[n-1]=o[n-1]/s[n-1],t=n-2;t>=0;--t)r[t]=(o[t]-r[t+1])/s[t];for(s[n-1]=(e[n]+r[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-r[t+1];return[r,s]}function qD(e,t){this._context=e,this._t=t}oK.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},aK.prototype={areaStart:od,areaEnd:od,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},zD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:NI(this,this._t0,cK(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,NI(this,cK(this,n=uK(this,e,t)),n);break;default:NI(this,this._t0,n=uK(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(dK.prototype=Object.create(zD.prototype)).point=function(e,t){zD.prototype.point.call(this,t,e)},fK.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,s){this._context.bezierCurveTo(t,e,i,n,s,r)}},hK.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var i=pK(e),r=pK(t),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(i[0][s],r[0][s],i[1][s],r[1][s],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},qD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};const kI=Math.PI,II=2*kI,eh=1e-6,VOe=II-eh;function RI(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function gK(){return new RI}RI.prototype=gK.prototype={constructor:RI,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,i){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(e,t,n,i,r,s){this._+="C"+ +e+","+ +t+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+s)},arcTo:function(e,t,n,i,r){var s=this._x1,o=this._y1,a=(n=+n)-(e=+e),l=(i=+i)-(t=+t),u=s-e,c=o-t,d=u*u+c*c;if((r=+r)<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(d>eh)if(Math.abs(c*a-l*u)>eh&&r){var f=n-s,h=i-o,p=a*a+l*l,g=f*f+h*h,m=Math.sqrt(p),_=Math.sqrt(d),y=r*Math.tan((kI-Math.acos((p+d-g)/(2*m*_)))/2),v=y/_,b=y/m;Math.abs(v-1)>eh&&(this._+="L"+(e+v*u)+","+(t+v*c)),this._+="A"+r+","+r+",0,0,"+ +(c*f>u*h)+","+(this._x1=e+b*a)+","+(this._y1=t+b*l)}else this._+="L"+(this._x1=e)+","+(this._y1=t)},arc:function(e,t,n,i,r,s){e=+e,t=+t,s=!!s;var o=(n=+n)*Math.cos(i),a=n*Math.sin(i),l=e+o,u=t+a,c=1^s,d=s?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+u:(Math.abs(this._x1-l)>eh||Math.abs(this._y1-u)>eh)&&(this._+="L"+l+","+u),n&&(d<0&&(d=d%II+II),d>VOe?this._+="A"+n+","+n+",0,1,"+c+","+(e-o)+","+(t-a)+"A"+n+","+n+",0,1,"+c+","+(this._x1=l)+","+(this._y1=u):d>eh&&(this._+="A"+n+","+n+",0,"+ +(d>=kI)+","+c+","+(this._x1=e+n*Math.cos(r))+","+(this._y1=t+n*Math.sin(r))))},rect:function(e,t,n,i){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};const th=gK;function qt(e){return function(){return e}}function HOe(e){return e.innerRadius}function UOe(e){return e.outerRadius}function zOe(e){return e.startAngle}function qOe(e){return e.endAngle}function GOe(e){return e&&e.padAngle}function WOe(e,t,n,i,r,s,o,a){var l=n-e,u=i-t,c=o-r,d=a-s,f=d*l-c*u;if(!(f*f<Dr))return[e+(f=(c*(t-s)-d*(e-r))/f)*l,t+f*u]}function GD(e,t,n,i,r,s,o){var a=e-n,l=t-i,u=(o?s:-s)/Dn(a*a+l*l),c=u*l,d=-u*a,f=e+c,h=t+d,p=n+c,g=i+d,m=(f+p)/2,_=(h+g)/2,y=p-f,v=g-h,b=y*y+v*v,D=r-s,C=f*g-p*h,w=(v<0?-1:1)*Dn(TOe(0,D*D*b-C*C)),E=(C*v-y*w)/b,N=(-C*y-v*w)/b,k=(C*v+y*w)/b,I=(-C*y+v*w)/b,L=E-m,B=N-_,T=k-m,A=I-_;return L*L+B*B>T*T+A*A&&(E=k,N=I),{cx:E,cy:N,x01:-c,y01:-d,x11:E*(r/D-1),y11:N*(r/D-1)}}function mK(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function _K(e){return e[0]}function yK(e){return e[1]}function vK(e,t){var n=qt(!0),i=null,r=OI,s=null;function o(a){var l,c,f,u=(a=mK(a)).length,d=!1;for(null==i&&(s=r(f=th())),l=0;l<=u;++l)!(l<u&&n(c=a[l],l,a))===d&&((d=!d)?s.lineStart():s.lineEnd()),d&&s.point(+e(c,l,a),+t(c,l,a));if(f)return s=null,f+""||null}return e="function"==typeof e?e:void 0===e?_K:qt(e),t="function"==typeof t?t:void 0===t?yK:qt(t),o.x=function(a){return arguments.length?(e="function"==typeof a?a:qt(+a),o):e},o.y=function(a){return arguments.length?(t="function"==typeof a?a:qt(+a),o):t},o.defined=function(a){return arguments.length?(n="function"==typeof a?a:qt(!!a),o):n},o.curve=function(a){return arguments.length?(r=a,null!=i&&(s=r(i)),o):r},o.context=function(a){return arguments.length?(null==a?i=s=null:s=r(i=a),o):i},o}function bK(e,t,n){var i=null,r=qt(!0),s=null,o=OI,a=null;function l(c){var d,f,h,g,_,p=(c=mK(c)).length,m=!1,y=new Array(p),v=new Array(p);for(null==s&&(a=o(_=th())),d=0;d<=p;++d){if(!(d<p&&r(g=c[d],d,c))===m)if(m=!m)f=d,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),h=d-1;h>=f;--h)a.point(y[h],v[h]);a.lineEnd(),a.areaEnd()}m&&(y[d]=+e(g,d,c),v[d]=+t(g,d,c),a.point(i?+i(g,d,c):y[d],n?+n(g,d,c):v[d]))}if(_)return a=null,_+""||null}function u(){return vK().defined(r).curve(o).context(s)}return e="function"==typeof e?e:void 0===e?_K:qt(+e),t="function"==typeof t?t:qt(void 0===t?0:+t),n="function"==typeof n?n:void 0===n?yK:qt(+n),l.x=function(c){return arguments.length?(e="function"==typeof c?c:qt(+c),i=null,l):e},l.x0=function(c){return arguments.length?(e="function"==typeof c?c:qt(+c),l):e},l.x1=function(c){return arguments.length?(i=null==c?null:"function"==typeof c?c:qt(+c),l):i},l.y=function(c){return arguments.length?(t="function"==typeof c?c:qt(+c),n=null,l):t},l.y0=function(c){return arguments.length?(t="function"==typeof c?c:qt(+c),l):t},l.y1=function(c){return arguments.length?(n=null==c?null:"function"==typeof c?c:qt(+c),l):n},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(n)},l.lineX1=function(){return u().x(i).y(t)},l.defined=function(c){return arguments.length?(r="function"==typeof c?c:qt(!!c),l):r},l.curve=function(c){return arguments.length?(o=c,null!=s&&(a=o(s)),l):o},l.context=function(c){return arguments.length?(null==c?s=a=null:a=o(s=c),l):s},l}Dn(3);const FI={draw(e,t){const n=Dn(t/ad);e.moveTo(n,0),e.arc(0,0,n,0,Dy)}};Dn(1/3),gs(ad/10),gs(7*ad/10);function ld(e,t){if("undefined"!=typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}gs(Dy/10),Gu(Dy/10),Dn(3),Dn(3),Dn(3),Dn(12);const CK=ey(zu),WD=CK.right,mNe=CK.left,Cy=(ey(sY),WD);function Gg(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ey(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function ud(){}var Wg=1/.7,Yg="\\s*([+-]?\\d+)\\s*",Sy="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ol="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",_Ne=/^#([0-9a-f]{3,8})$/,yNe=new RegExp(`^rgb\\(${Yg},${Yg},${Yg}\\)$`),vNe=new RegExp(`^rgb\\(${Ol},${Ol},${Ol}\\)$`),bNe=new RegExp(`^rgba\\(${Yg},${Yg},${Yg},${Sy}\\)$`),wNe=new RegExp(`^rgba\\(${Ol},${Ol},${Ol},${Sy}\\)$`),DNe=new RegExp(`^hsl\\(${Sy},${Ol},${Ol}\\)$`),CNe=new RegExp(`^hsla\\(${Sy},${Ol},${Ol},${Sy}\\)$`),EK={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function SK(){return this.rgb().formatHex()}function xK(){return this.rgb().formatRgb()}function xy(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=_Ne.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?AK(t):3===n?new ji(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?YD(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?YD(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=yNe.exec(e))?new ji(t[1],t[2],t[3],1):(t=vNe.exec(e))?new ji(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=bNe.exec(e))?YD(t[1],t[2],t[3],t[4]):(t=wNe.exec(e))?YD(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=DNe.exec(e))?OK(t[1],t[2]/100,t[3]/100,1):(t=CNe.exec(e))?OK(t[1],t[2]/100,t[3]/100,t[4]):EK.hasOwnProperty(e)?AK(EK[e]):"transparent"===e?new ji(NaN,NaN,NaN,0):null}function AK(e){return new ji(e>>16&255,e>>8&255,255&e,1)}function YD(e,t,n,i){return i<=0&&(e=t=n=NaN),new ji(e,t,n,i)}function jI(e){return e instanceof ud||(e=xy(e)),e?new ji((e=e.rgb()).r,e.g,e.b,e.opacity):new ji}function cd(e,t,n,i){return 1===arguments.length?jI(e):new ji(e,t,n,null==i?1:i)}function ji(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}function MK(){return`#${rh(this.r)}${rh(this.g)}${rh(this.b)}`}function TK(){const e=KD(this.opacity);return`${1===e?"rgb(":"rgba("}${ih(this.r)}, ${ih(this.g)}, ${ih(this.b)}${1===e?")":`, ${e})`}`}function KD(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ih(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function rh(e){return((e=ih(e))<16?"0":"")+e.toString(16)}function OK(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ta(e,t,n,i)}function NK(e){if(e instanceof Ta)return new Ta(e.h,e.s,e.l,e.opacity);if(e instanceof ud||(e=xy(e)),!e)return new Ta;if(e instanceof Ta)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),s=Math.max(t,n,i),o=NaN,a=s-r,l=(s+r)/2;return a?(o=t===s?(n-i)/a+6*(n<i):n===s?(i-t)/a+2:(t-n)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new Ta(o,a,l,e.opacity)}function JD(e,t,n,i){return 1===arguments.length?NK(e):new Ta(e,t,n,null==i?1:i)}function Ta(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function kK(e){return(e=(e||0)%360)<0?e+360:e}function XD(e){return Math.max(0,Math.min(1,e||0))}function BI(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function IK(e,t,n,i,r){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*i+o*r)/6}function RK(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],s=e[i+1];return IK((n-i/t)*t,i>0?e[i-1]:2*r-s,r,s,i<t-1?e[i+2]:2*s-r)}}function FK(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t);return IK((n-i/t)*t,e[(i+t-1)%t],e[i%t],e[(i+1)%t],e[(i+2)%t])}}Gg(ud,xy,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:SK,formatHex:SK,formatHex8:function ENe(){return this.rgb().formatHex8()},formatHsl:function SNe(){return NK(this).formatHsl()},formatRgb:xK,toString:xK}),Gg(ji,cd,Ey(ud,{brighter(e){return e=null==e?Wg:Math.pow(Wg,e),new ji(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new ji(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ji(ih(this.r),ih(this.g),ih(this.b),KD(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:MK,formatHex:MK,formatHex8:function xNe(){return`#${rh(this.r)}${rh(this.g)}${rh(this.b)}${rh(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:TK,toString:TK})),Gg(Ta,JD,Ey(ud,{brighter(e){return e=null==e?Wg:Math.pow(Wg,e),new Ta(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new Ta(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new ji(BI(e>=240?e-240:e+120,r,i),BI(e,r,i),BI(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new Ta(kK(this.h),XD(this.s),XD(this.l),KD(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=KD(this.opacity);return`${1===e?"hsl(":"hsla("}${kK(this.h)}, ${100*XD(this.s)}%, ${100*XD(this.l)}%${1===e?")":`, ${e})`}`}}));const QD=e=>()=>e;function PK(e,t){return function(n){return e+n*t}}function ZD(e,t){var n=t-e;return n?PK(e,n>180||n<-180?n-360*Math.round(n/360):n):QD(isNaN(e)?t:e)}function Bi(e,t){var n=t-e;return n?PK(e,n):QD(isNaN(e)?t:e)}const $I=function e(t){var n=function MNe(e){return 1==(e=+e)?Bi:function(t,n){return n-t?function ANe(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}(t,n,e):QD(isNaN(t)?n:t)}}(t);function i(r,s){var o=n((r=cd(r)).r,(s=cd(s)).r),a=n(r.g,s.g),l=n(r.b,s.b),u=Bi(r.opacity,s.opacity);return function(c){return r.r=o(c),r.g=a(c),r.b=l(c),r.opacity=u(c),r+""}}return i.gamma=e,i}(1);function LK(e){return function(t){var o,a,n=t.length,i=new Array(n),r=new Array(n),s=new Array(n);for(o=0;o<n;++o)a=cd(t[o]),i[o]=a.r||0,r[o]=a.g||0,s[o]=a.b||0;return i=e(i),r=e(r),s=e(s),a.opacity=1,function(l){return a.r=i(l),a.g=r(l),a.b=s(l),a+""}}}var TNe=LK(RK),ONe=LK(FK);function VI(e,t){t||(t=[]);var r,n=e?Math.min(t.length,e.length):0,i=t.slice();return function(s){for(r=0;r<n;++r)i[r]=e[r]*(1-s)+t[r]*s;return i}}function jK(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function NNe(e,t){return(jK(t)?VI:BK)(e,t)}function BK(e,t){var o,n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),s=new Array(n);for(o=0;o<i;++o)r[o]=dd(e[o],t[o]);for(;o<n;++o)s[o]=t[o];return function(a){for(o=0;o<i;++o)s[o]=r[o](a);return s}}function $K(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function Oa(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function VK(e,t){var r,n={},i={};for(r in(null===e||"object"!=typeof e)&&(e={}),(null===t||"object"!=typeof t)&&(t={}),t)r in e?n[r]=dd(e[r],t[r]):i[r]=t[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var HI=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,UI=new RegExp(HI.source,"g");function HK(e,t){var i,r,s,n=HI.lastIndex=UI.lastIndex=0,o=-1,a=[],l=[];for(e+="",t+="";(i=HI.exec(e))&&(r=UI.exec(t));)(s=r.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,l.push({i:o,x:Oa(i,r)})),n=UI.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?function INe(e){return function(t){return e(t)+""}}(l[0].x):function kNe(e){return function(){return e}}(t):(t=l.length,function(u){for(var d,c=0;c<t;++c)a[(d=l[c]).i]=d.x(u);return a.join("")})}function dd(e,t){var i,n=typeof t;return null==t||"boolean"===n?QD(t):("number"===n?Oa:"string"===n?(i=xy(t))?(t=i,$I):HK:t instanceof xy?$I:t instanceof Date?$K:jK(t)?VI:Array.isArray(t)?BK:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?VK:Oa)(e,t)}function Ay(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function zI(e){return+e}var UK=[0,1];function ms(e){return e}function qI(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function RNe(e){return function(){return e}}(isNaN(t)?NaN:.5)}function PNe(e,t,n){var i=e[0],r=e[1],s=t[0],o=t[1];return r<i?(i=qI(r,i),s=n(o,s)):(i=qI(i,r),s=n(s,o)),function(a){return s(i(a))}}function LNe(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),s=new Array(i),o=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<i;)r[o]=qI(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(a){var l=Cy(e,a,1,i)-1;return s[l](r[l](a))}}function My(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function eC(){var i,r,s,a,l,u,e=UK,t=UK,n=dd,o=ms;function c(){var f=Math.min(e.length,t.length);return o!==ms&&(o=function FNe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}(e[0],e[f-1])),a=f>2?LNe:PNe,l=u=null,d}function d(f){return null==f||isNaN(f=+f)?s:(l||(l=a(e.map(i),t,n)))(i(o(f)))}return d.invert=function(f){return o(r((u||(u=a(t,e.map(i),Oa)))(f)))},d.domain=function(f){return arguments.length?(e=Array.from(f,zI),c()):e.slice()},d.range=function(f){return arguments.length?(t=Array.from(f),c()):t.slice()},d.rangeRound=function(f){return t=Array.from(f),n=Ay,c()},d.clamp=function(f){return arguments.length?(o=!!f||ms,c()):o!==ms},d.interpolate=function(f){return arguments.length?(n=f,c()):n},d.unknown=function(f){return arguments.length?(s=f,d):s},function(f,h){return i=f,r=h,c()}}function zK(){return eC()(ms,ms)}function Nl(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function fd(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}function qK(e,t,n,i){var s,r=Jc(e,t,n);switch((i=Gf(null==i?",f":i)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null==i.precision&&!isNaN(s=CG(r,o))&&(i.precision=s),HN(i,o);case"":case"e":case"g":case"p":case"r":null==i.precision&&!isNaN(s=EG(r,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=s-("e"===i.type));break;case"f":case"%":null==i.precision&&!isNaN(s=SG(r))&&(i.precision=s-2*("%"===i.type))}return fD(i)}function sh(e){var t=e.domain;return e.ticks=function(n){var i=t();return $N(i[0],i[i.length-1],null==n?10:n)},e.tickFormat=function(n,i){var r=t();return qK(r[0],r[r.length-1],null==n?10:n,i)},e.nice=function(n){null==n&&(n=10);var l,u,i=t(),r=0,s=i.length-1,o=i[r],a=i[s],c=10;for(a<o&&(u=o,o=a,a=u,u=r,r=s,s=u);c-- >0;){if((u=DG(o,a,n))===l)return i[r]=o,i[s]=a,t(i);if(u>0)o=Math.floor(o/u)*u,a=Math.ceil(a/u)*u;else{if(!(u<0))break;o=Math.ceil(o*u)/u,a=Math.floor(a*u)/u}l=u}return e},e}function YK(e,t){var o,n=0,i=(e=e.slice()).length-1,r=e[n],s=e[i];return s<r&&(o=n,n=i,i=o,o=r,r=s,s=o),e[n]=t.floor(r),e[i]=t.ceil(s),e}function KK(e){return Math.log(e)}function JK(e){return Math.exp(e)}function jNe(e){return-Math.log(-e)}function BNe(e){return-Math.exp(-e)}function $Ne(e){return isFinite(e)?+("1e"+e):e<0?0:e}function XK(e){return(t,n)=>-e(-t,n)}function GI(e){const t=e(KK,JK),n=t.domain;let r,s,i=10;function o(){return r=function HNe(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(i),s=function VNe(e){return 10===e?$Ne:e===Math.E?Math.exp:t=>Math.pow(e,t)}(i),n()[0]<0?(r=XK(r),s=XK(s),e(jNe,BNe)):e(KK,JK),t}return t.base=function(a){return arguments.length?(i=+a,o()):i},t.domain=function(a){return arguments.length?(n(a),o()):n()},t.ticks=a=>{const l=n();let u=l[0],c=l[l.length-1];const d=c<u;d&&([u,c]=[c,u]);let p,g,f=r(u),h=r(c);const m=null==a?10:+a;let _=[];if(!(i%1)&&h-f<m){if(f=Math.floor(f),h=Math.ceil(h),u>0){for(;f<=h;++f)for(p=1;p<i;++p)if(g=f<0?p/s(-f):p*s(f),!(g<u)){if(g>c)break;_.push(g)}}else for(;f<=h;++f)for(p=i-1;p>=1;--p)if(g=f>0?p/s(-f):p*s(f),!(g<u)){if(g>c)break;_.push(g)}2*_.length<m&&(_=$N(u,c,m))}else _=$N(f,h,Math.min(h-f,m)).map(s);return d?_.reverse():_},t.tickFormat=(a,l)=>{if(null==a&&(a=10),null==l&&(l=10===i?"s":","),"function"!=typeof l&&(!(i%1)&&null==(l=Gf(l)).precision&&(l.trim=!0),l=fD(l)),a===1/0)return l;const u=Math.max(1,i*a/t.ticks().length);return c=>{let d=c/s(Math.round(r(c)));return d*i<i-.5&&(d*=i),d<=u?l(c):""}},t.nice=()=>n(YK(n(),{floor:a=>s(Math.floor(r(a))),ceil:a=>s(Math.ceil(r(a)))})),t}function ZK(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function UNe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function zNe(e){return e<0?-e*e:e*e}function WI(e){var t=e(ms,ms),n=1;function i(){return 1===n?e(ms,ms):.5===n?e(UNe,zNe):e(ZK(n),ZK(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,i()):n},sh(t)}function YI(){var e=WI(eC());return e.copy=function(){return My(e,YI()).exponent(e.exponent())},Nl.apply(e,arguments),e}function eJ(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function tJ(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function KI(e){var t=1,n=e(eJ(t),tJ(t));return n.constant=function(i){return arguments.length?e(eJ(t=+i),tJ(t)):t},sh(n)}function iJ(e,t,n,i,r,s){const o=[[ed,1,Hu],[ed,5,5e3],[ed,15,15e3],[ed,30,3e4],[s,1,Po],[s,5,5*Po],[s,15,15*Po],[s,30,30*Po],[r,1,Uu],[r,3,3*Uu],[r,6,6*Uu],[r,12,12*Uu],[i,1,Wf],[i,2,2*Wf],[n,1,qN],[t,1,IG],[t,3,3*IG],[e,1,GN]];function l(u,c,d){const f=Math.abs(c-u)/d,h=ey(([,,m])=>m).right(o,f);if(h===o.length)return e.every(Jc(u/GN,c/GN,d));if(0===h)return JN.every(Math.max(Jc(u,c,d),1));const[p,g]=o[f/o[h-1][2]<o[h][2]/f?h-1:h];return p.every(g)}return[function a(u,c,d){const f=c<u;f&&([u,c]=[c,u]);const h=d&&"function"==typeof d.range?d:l(u,c,d),p=h?h.range(u,+c+1):[];return f?p.reverse():p},l]}const[GNe,WNe]=iJ(td,_D,Fg,Qc,QN,ZN),[YNe,KNe]=iJ(Zc,gD,Ig,Xc,YN,KN);function JNe(e){return new Date(e)}function XNe(e){return e instanceof Date?+e:+new Date(+e)}function JI(e,t,n,i,r,s,o,a,l,u){var c=zK(),d=c.invert,f=c.domain,h=u(".%L"),p=u(":%S"),g=u("%I:%M"),m=u("%I %p"),_=u("%a %d"),y=u("%b %d"),v=u("%B"),b=u("%Y");function D(C){return(l(C)<C?h:a(C)<C?p:o(C)<C?g:s(C)<C?m:i(C)<C?r(C)<C?_:y:n(C)<C?v:b)(C)}return c.invert=function(C){return new Date(d(C))},c.domain=function(C){return arguments.length?f(Array.from(C,XNe)):f().map(JNe)},c.ticks=function(C){var w=f();return e(w[0],w[w.length-1],null==C?10:C)},c.tickFormat=function(C,w){return null==w?D:u(w)},c.nice=function(C){var w=f();return(!C||"function"!=typeof C.range)&&(C=t(w[0],w[w.length-1],null==C?10:C)),C?f(YK(w,C)):c},c.copy=function(){return My(c,JI(e,t,n,i,r,s,o,a,l,u))},c}function tC(){var n,i,r,s,l,e=0,t=1,o=ms,a=!1;function u(d){return null==d||isNaN(d=+d)?l:o(0===r?.5:(d=(s(d)-n)*r,a?Math.max(0,Math.min(1,d)):d))}function c(d){return function(f){var h,p;return arguments.length?([h,p]=f,o=d(h,p),u):[o(0),o(1)]}}return u.domain=function(d){return arguments.length?([e,t]=d,n=s(e=+e),i=s(t=+t),r=n===i?0:1/(i-n),u):[e,t]},u.clamp=function(d){return arguments.length?(a=!!d,u):a},u.interpolator=function(d){return arguments.length?(o=d,u):o},u.range=c(dd),u.rangeRound=c(Ay),u.unknown=function(d){return arguments.length?(l=d,u):l},function(d){return s=d,n=d(e),i=d(t),r=n===i?0:1/(i-n),u}}function hd(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function XI(){var e=sh(tC()(ms));return e.copy=function(){return hd(e,XI())},fd.apply(e,arguments)}function QI(){var e=WI(tC());return e.copy=function(){return hd(e,QI()).exponent(e.exponent())},fd.apply(e,arguments)}function ZI(e,t){void 0===t&&(t=e,e=dd);for(var n=0,i=t.length-1,r=t[0],s=new Array(i<0?0:i);n<i;)s[n]=e(r,r=t[++n]);return function(o){var a=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return s[a](o-a)}}function nC(){var r,s,o,a,l,c,f,e=0,t=.5,n=1,i=1,u=ms,d=!1;function h(g){return isNaN(g=+g)?f:(g=.5+((g=+c(g))-s)*(i*g<i*s?a:l),u(d?Math.max(0,Math.min(1,g)):g))}function p(g){return function(m){var _,y,v;return arguments.length?([_,y,v]=m,u=ZI(g,[_,y,v]),h):[u(0),u(.5),u(1)]}}return h.domain=function(g){return arguments.length?([e,t,n]=g,r=c(e=+e),s=c(t=+t),o=c(n=+n),a=r===s?0:.5/(s-r),l=s===o?0:.5/(o-s),i=s<r?-1:1,h):[e,t,n]},h.clamp=function(g){return arguments.length?(d=!!g,h):d},h.interpolator=function(g){return arguments.length?(u=g,h):u},h.range=p(dd),h.rangeRound=p(Ay),h.unknown=function(g){return arguments.length?(f=g,h):f},function(g){return c=g,r=g(e),s=g(t),o=g(n),a=r===s?0:.5/(s-r),l=s===o?0:.5/(o-s),i=s<r?-1:1,h}}function eR(){var e=WI(nC());return e.copy=function(){return hd(e,eR()).exponent(e.exponent())},fd.apply(e,arguments)}class fJ extends Map{constructor(t,n=gJ){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),null!=t)for(const[i,r]of t)this.set(i,r)}get(t){return super.get(tR(this,t))}has(t){return super.has(tR(this,t))}set(t,n){return super.set(hJ(this,t),n)}delete(t){return super.delete(pJ(this,t))}}class iC extends Set{constructor(t,n=gJ){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),null!=t)for(const i of t)this.add(i)}has(t){return super.has(tR(this,t))}add(t){return super.add(hJ(this,t))}delete(t){return super.delete(pJ(this,t))}}function tR({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function hJ({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function pJ({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}function gJ(e){return null!==e&&"object"==typeof e?e.valueOf():e}const nR=Symbol("implicit");function iR(){var e=new fJ,t=[],n=[],i=nR;function r(s){let o=e.get(s);if(void 0===o){if(i!==nR)return i;e.set(s,o=t.push(s)-1)}return n[o%n.length]}return r.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new fJ;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return r},r.range=function(s){return arguments.length?(n=Array.from(s),r):n.slice()},r.unknown=function(s){return arguments.length?(i=s,r):i},r.copy=function(){return iR(t,n).unknown(i)},Nl.apply(r,arguments),r}function nke(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function ike(e,t){var n=ZD(+e,+t);return function(i){var r=n(i);return r-360*Math.floor(r/360)}}var rC,mJ=180/Math.PI,rR={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function _J(e,t,n,i,r,s){var o,a,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*i)&&(n-=e*l,i-=t*l),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,l/=a),e*i<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(t,e)*mJ,skewX:Math.atan(l)*mJ,scaleX:o,scaleY:a}}function yJ(e,t,n,i){function r(u){return u.length?u.pop()+" ":""}return function(u,c){var d=[],f=[];return u=e(u),c=e(c),function s(u,c,d,f,h,p){if(u!==d||c!==f){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:Oa(u,d)},{i:g-2,x:Oa(c,f)})}else(d||f)&&h.push("translate("+d+t+f+n)}(u.translateX,u.translateY,c.translateX,c.translateY,d,f),function o(u,c,d,f){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),f.push({i:d.push(r(d)+"rotate(",null,i)-2,x:Oa(u,c)})):c&&d.push(r(d)+"rotate("+c+i)}(u.rotate,c.rotate,d,f),function a(u,c,d,f){u!==c?f.push({i:d.push(r(d)+"skewX(",null,i)-2,x:Oa(u,c)}):c&&d.push(r(d)+"skewX("+c+i)}(u.skewX,c.skewX,d,f),function l(u,c,d,f,h,p){if(u!==d||c!==f){var g=h.push(r(h)+"scale(",null,",",null,")");p.push({i:g-4,x:Oa(u,d)},{i:g-2,x:Oa(c,f)})}else(1!==d||1!==f)&&h.push(r(h)+"scale("+d+","+f+")")}(u.scaleX,u.scaleY,c.scaleX,c.scaleY,d,f),u=c=null,function(h){for(var m,p=-1,g=f.length;++p<g;)d[(m=f[p]).i]=m.x(h);return d.join("")}}}var oke=yJ(function rke(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?rR:_J(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),ake=yJ(function ske(e){return null!=e&&(rC||(rC=document.createElementNS("http://www.w3.org/2000/svg","g")),rC.setAttribute("transform",e),e=rC.transform.baseVal.consolidate())?_J((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):rR},", ",")",")");function vJ(e){return((e=Math.exp(e))+1/e)/2}const dke=function e(t,n,i){function r(s,o){var m,_,a=s[0],l=s[1],u=s[2],f=o[2],h=o[0]-a,p=o[1]-l,g=h*h+p*p;if(g<1e-12)_=Math.log(f/u)/t,m=function(w){return[a+w*h,l+w*p,u*Math.exp(t*w*_)]};else{var y=Math.sqrt(g),v=(f*f-u*u+i*g)/(2*u*n*y),b=(f*f-u*u-i*g)/(2*f*n*y),D=Math.log(Math.sqrt(v*v+1)-v),C=Math.log(Math.sqrt(b*b+1)-b);_=(C-D)/t,m=function(w){var E=w*_,N=vJ(D),k=u/(n*y)*(N*function cke(e){return((e=Math.exp(2*e))-1)/(e+1)}(t*E+D)-function uke(e){return((e=Math.exp(e))-1/e)/2}(D));return[a+k*h,l+k*p,u*N/vJ(t*E+D)]}}return m.duration=1e3*_*t/Math.SQRT2,m}return r.rho=function(s){var o=Math.max(.001,+s),a=o*o;return e(o,a,a*a)},r}(Math.SQRT2,2,4);function bJ(e){return function(t,n){var i=e((t=JD(t)).h,(n=JD(n)).h),r=Bi(t.s,n.s),s=Bi(t.l,n.l),o=Bi(t.opacity,n.opacity);return function(a){return t.h=i(a),t.s=r(a),t.l=s(a),t.opacity=o(a),t+""}}}const fke=bJ(ZD);var hke=bJ(Bi);const wJ=Math.PI/180,DJ=180/Math.PI,xJ=4/29,Kg=6/29,AJ=3*Kg*Kg;function MJ(e){if(e instanceof Na)return new Na(e.l,e.a,e.b,e.opacity);if(e instanceof kl)return OJ(e);e instanceof ji||(e=jI(e));var s,o,t=lR(e.r),n=lR(e.g),i=lR(e.b),r=sR((.2225045*t+.7168786*n+.0606169*i)/1);return t===n&&n===i?s=o=r:(s=sR((.4360747*t+.3850649*n+.1430804*i)/.96422),o=sR((.0139322*t+.0971045*n+.7141733*i)/.82521)),new Na(116*r-16,500*(s-r),200*(r-o),e.opacity)}function oC(e,t,n,i){return 1===arguments.length?MJ(e):new Na(e,t,n,null==i?1:i)}function Na(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}function sR(e){return e>.008856451679035631?Math.pow(e,1/3):e/AJ+xJ}function oR(e){return e>Kg?e*e*e:AJ*(e-xJ)}function aR(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function lR(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function TJ(e){if(e instanceof kl)return new kl(e.h,e.c,e.l,e.opacity);if(e instanceof Na||(e=MJ(e)),0===e.a&&0===e.b)return new kl(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*DJ;return new kl(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function aC(e,t,n,i){return 1===arguments.length?TJ(e):new kl(e,t,n,null==i?1:i)}function kl(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function OJ(e){if(isNaN(e.h))return new Na(e.l,0,0,e.opacity);var t=e.h*wJ;return new Na(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}function gke(e,t){var n=Bi((e=oC(e)).l,(t=oC(t)).l),i=Bi(e.a,t.a),r=Bi(e.b,t.b),s=Bi(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=i(o),e.b=r(o),e.opacity=s(o),e+""}}function NJ(e){return function(t,n){var i=e((t=aC(t)).h,(n=aC(n)).h),r=Bi(t.c,n.c),s=Bi(t.l,n.l),o=Bi(t.opacity,n.opacity);return function(a){return t.h=i(a),t.c=r(a),t.l=s(a),t.opacity=o(a),t+""}}}Gg(Na,oC,Ey(ud,{brighter(e){return new Na(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker(e){return new Na(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new ji(aR(3.1338561*(t=.96422*oR(t))-1.6168667*(e=1*oR(e))-.4906146*(n=.82521*oR(n))),aR(-.9787684*t+1.9161415*e+.033454*n),aR(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),Gg(kl,aC,Ey(ud,{brighter(e){return new kl(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker(e){return new kl(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb(){return OJ(this).rgb()}}));const mke=NJ(ZD);var _ke=NJ(Bi),uR=1.78277,cR=-.29227,lC=-.90649,Ty=1.97294,IJ=Ty*lC,RJ=Ty*uR,FJ=uR*cR- -.14861*lC;function yke(e){if(e instanceof oh)return new oh(e.h,e.s,e.l,e.opacity);e instanceof ji||(e=jI(e));var n=e.g/255,i=e.b/255,r=(FJ*i+IJ*(e.r/255)-RJ*n)/(FJ+IJ-RJ),s=i-r,o=(Ty*(n-r)-cR*s)/lC,a=Math.sqrt(o*o+s*s)/(Ty*r*(1-r)),l=a?Math.atan2(o,s)*DJ-120:NaN;return new oh(l<0?l+360:l,a,r,e.opacity)}function dR(e,t,n,i){return 1===arguments.length?yke(e):new oh(e,t,n,null==i?1:i)}function oh(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function PJ(e){return function t(n){function i(r,s){var o=e((r=dR(r)).h,(s=dR(s)).h),a=Bi(r.s,s.s),l=Bi(r.l,s.l),u=Bi(r.opacity,s.opacity);return function(c){return r.h=o(c),r.s=a(c),r.l=l(Math.pow(c,n)),r.opacity=u(c),r+""}}return n=+n,i.gamma=t,i}(1)}Gg(oh,dR,Ey(ud,{brighter(e){return e=null==e?Wg:Math.pow(Wg,e),new oh(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new oh(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*wJ,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new ji(255*(t+n*(-.14861*i+uR*r)),255*(t+n*(cR*i+lC*r)),255*(t+n*(Ty*i)),this.opacity)}}));const vke=PJ(ZD);var bke=PJ(Bi);function wke(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}function fR(e,t,n){const i=e-t+2*n;return e?i>0?i:1:0}const Jg="linear",Wu="log",Oy="pow",Ny="sqrt",uC="symlog",ah="time",lh="utc",Il="sequential",Xg="diverging",Qg="quantile",cC="quantize",dC="threshold",hR="ordinal",pR="point",gR="bin-ordinal",Ei="continuous",ky="discrete",Iy="discretizing",Vo="interpolating",mR="temporal";function _R(){const e=iR().unknown(void 0),t=e.domain,n=e.range;let r,s,i=[0,1],o=!1,a=0,l=0,u=.5;function c(){const d=t().length,f=i[1]<i[0],h=i[1-f],p=fR(d,a,l);let g=i[f-0];r=(h-g)/(p||1),o&&(r=Math.floor(r)),g+=(h-g-r*(d-a))*u,s=r*(1-a),o&&(g=Math.round(g),s=Math.round(s));const m=Qs(d).map(_=>g+r*_);return n(f?m.reverse():m)}return delete e.unknown,e.domain=function(d){return arguments.length?(t(d),c()):t()},e.range=function(d){return arguments.length?(i=[+d[0],+d[1]],c()):i.slice()},e.rangeRound=function(d){return i=[+d[0],+d[1]],o=!0,c()},e.bandwidth=function(){return s},e.step=function(){return r},e.round=function(d){return arguments.length?(o=!!d,c()):o},e.padding=function(d){return arguments.length?(l=Math.max(0,Math.min(1,d)),a=l,c()):a},e.paddingInner=function(d){return arguments.length?(a=Math.max(0,Math.min(1,d)),c()):a},e.paddingOuter=function(d){return arguments.length?(l=Math.max(0,Math.min(1,d)),c()):l},e.align=function(d){return arguments.length?(u=Math.max(0,Math.min(1,d)),c()):u},e.invertRange=function(d){if(null==d[0]||null==d[1])return;const f=i[1]<i[0],h=f?n().reverse():n(),p=h.length-1;let _,y,v,g=+d[0],m=+d[1];return g!=g||m!=m||(m<g&&(v=g,g=m,m=v),m<h[0]||g>i[1-f])?void 0:(_=Math.max(0,WD(h,g)-1),y=g===m?_:WD(h,m)-1,g-h[_]>s+1e-10&&++_,f&&(v=_,_=p-y,y=p-v),_>y?void 0:t().slice(_,y+1))},e.invert=function(d){const f=e.invertRange([d,d]);return f&&f[0]},e.copy=function(){return _R().domain(t()).range(i).round(o).paddingInner(a).paddingOuter(l).align(u)},c()}function jJ(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return jJ(t())},e}var xke=Array.prototype.map;function Ake(e){return xke.call(e,_r)}const Mke=Array.prototype.slice,fC={};function Tke(e,t,n){const i=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?function Cke(e){return function(t){let r,n=t[0],i=t[1];return i<n&&(r=n,n=i,i=r),[e.invert(n),e.invert(i)]}}(s):s.invertExtent?function Eke(e){return function(t){const n=e.range();let o,a,l,u,i=t[0],r=t[1],s=-1;for(r<i&&(a=i,i=r,r=a),l=0,u=n.length;l<u;++l)n[l]>=i&&n[l]<=r&&(s<0&&(s=l),o=l);if(!(s<0))return i=e.invertExtent(n[s]),r=e.invertExtent(n[o]),[void 0===i[0]?i[1]:i[0],void 0===r[1]?r[0]:r[1]]}}(s):void 0),s.type=e,s};return i.metadata=Aa(we(n)),i}function Pt(e,t,n){return arguments.length>1?(fC[e]=Tke(e,t,n),this):$J(e)?fC[e]:void 0}function $J(e){return Fe(fC,e)}function uh(e,t){const n=fC[e];return n&&n.metadata[t]}function yR(e){return uh(e,Ei)}function Zg(e){return uh(e,ky)}function vR(e){return uh(e,Iy)}function VJ(e){return uh(e,Wu)}function HJ(e){return uh(e,Vo)}function UJ(e){return uh(e,Qg)}Pt("identity",function WK(e){var t;function n(i){return null==i||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,zI),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return WK(e).unknown(t)},e=arguments.length?Array.from(e,zI):[0,1],sh(n)}),Pt(Jg,function GK(){var e=zK();return e.copy=function(){return My(e,GK())},Nl.apply(e,arguments),sh(e)},Ei),Pt(Wu,function QK(){const e=GI(eC()).domain([1,10]);return e.copy=()=>My(e,QK()).base(e.base()),Nl.apply(e,arguments),e},[Ei,Wu]),Pt(Oy,YI,Ei),Pt(Ny,function qNe(){return YI.apply(null,arguments).exponent(.5)},Ei),Pt(uC,function nJ(){var e=KI(eC());return e.copy=function(){return My(e,nJ()).constant(e.constant())},Nl.apply(e,arguments)},Ei),Pt(ah,function QNe(){return Nl.apply(JI(YNe,KNe,Zc,gD,Ig,Xc,YN,KN,ed,dk).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},[Ei,mR]),Pt(lh,function ZNe(){return Nl.apply(JI(GNe,WNe,td,_D,Fg,Qc,QN,ZN,ed,fk).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},[Ei,mR]),Pt(Il,XI,[Ei,Vo]),Pt("".concat(Il,"-").concat(Jg),XI,[Ei,Vo]),Pt("".concat(Il,"-").concat(Wu),function rJ(){var e=GI(tC()).domain([1,10]);return e.copy=function(){return hd(e,rJ()).base(e.base())},fd.apply(e,arguments)},[Ei,Vo,Wu]),Pt("".concat(Il,"-").concat(Oy),QI,[Ei,Vo]),Pt("".concat(Il,"-").concat(Ny),function eke(){return QI.apply(null,arguments).exponent(.5)},[Ei,Vo]),Pt("".concat(Il,"-").concat(uC),function sJ(){var e=KI(tC());return e.copy=function(){return hd(e,sJ()).constant(e.constant())},fd.apply(e,arguments)},[Ei,Vo]),Pt("".concat(Xg,"-").concat(Jg),function oJ(){var e=sh(nC()(ms));return e.copy=function(){return hd(e,oJ())},fd.apply(e,arguments)},[Ei,Vo]),Pt("".concat(Xg,"-").concat(Wu),function aJ(){var e=GI(nC()).domain([.1,1,10]);return e.copy=function(){return hd(e,aJ()).base(e.base())},fd.apply(e,arguments)},[Ei,Vo,Wu]),Pt("".concat(Xg,"-").concat(Oy),eR,[Ei,Vo]),Pt("".concat(Xg,"-").concat(Ny),function tke(){return eR.apply(null,arguments).exponent(.5)},[Ei,Vo]),Pt("".concat(Xg,"-").concat(uC),function lJ(){var e=KI(nC());return e.copy=function(){return hd(e,lJ()).constant(e.constant())},fd.apply(e,arguments)},[Ei,Vo]),Pt(Qg,function uJ(){var i,e=[],t=[],n=[];function r(){var o=0,a=Math.max(1,t.length);for(n=new Array(a-1);++o<a;)n[o-1]=oY(e,o/a);return s}function s(o){return null==o||isNaN(o=+o)?i:t[Cy(n,o)]}return s.invertExtent=function(o){var a=t.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let a of o)null!=a&&!isNaN(a=+a)&&e.push(a);return e.sort(zu),r()},s.range=function(o){return arguments.length?(t=Array.from(o),r()):t.slice()},s.unknown=function(o){return arguments.length?(i=o,s):i},s.quantiles=function(){return n.slice()},s.copy=function(){return uJ().domain(e).range(t).unknown(i)},Nl.apply(s,arguments)},[Iy,Qg]),Pt(cC,function cJ(){var s,e=0,t=1,n=1,i=[.5],r=[0,1];function o(l){return null!=l&&l<=l?r[Cy(i,l,0,n)]:s}function a(){var l=-1;for(i=new Array(n);++l<n;)i[l]=((l+1)*t-(l-n)*e)/(n+1);return o}return o.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,a()):[e,t]},o.range=function(l){return arguments.length?(n=(r=Array.from(l)).length-1,a()):r.slice()},o.invertExtent=function(l){var u=r.indexOf(l);return u<0?[NaN,NaN]:u<1?[e,i[0]]:u>=n?[i[n-1],t]:[i[u-1],i[u]]},o.unknown=function(l){return arguments.length&&(s=l),o},o.thresholds=function(){return i.slice()},o.copy=function(){return cJ().domain([e,t]).range(r).unknown(s)},Nl.apply(sh(o),arguments)},Iy),Pt(dC,function dJ(){var n,e=[.5],t=[0,1],i=1;function r(s){return null!=s&&s<=s?t[Cy(e,s,0,i)]:n}return r.domain=function(s){return arguments.length?(e=Array.from(s),i=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(s){return arguments.length?(t=Array.from(s),i=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},r.unknown=function(s){return arguments.length?(n=s,r):n},r.copy=function(){return dJ().domain(e).range(t).unknown(n)},Nl.apply(r,arguments)},Iy),Pt(gR,function BJ(){let e=[],t=[];function n(i){return null==i||i!=i?void 0:t[(Cy(e,i)-1)%t.length]}return n.domain=function(i){return arguments.length?(e=Ake(i),n):e.slice()},n.range=function(i){return arguments.length?(t=Mke.call(i),n):t.slice()},n.tickFormat=function(i,r){return qK(e[0],bt(e),null==i?10:i,r)},n.copy=function(){return BJ().domain(n.domain()).range(n.range())},n},[ky,Iy]),Pt(hR,iR,ky),Pt("band",_R,ky),Pt(pR,function Ske(){return jJ(_R().paddingInner(1))},ky);const Nke=["clamp","base","constant","exponent"];function zJ(e,t){const n=t[0],i=bt(t)-n;return function(r){return e(n+r*i)}}function hC(e,t,n){return ZI(bR(t||"rgb",n),e)}function qJ(e,t){const n=new Array(t),i=t+1;for(let r=0;r<t;)n[r]=e(++r/i);return n}function GJ(e,t,n){const i=n-t;let r,s,o;return i&&Number.isFinite(i)?(r=(s=e.type).indexOf("-"),s=r<0?s:s.slice(r+1),o=Pt(s)().domain([t,n]).range([0,1]),Nke.forEach(a=>e[a]?o[a](e[a]()):0),o):yr(.5)}function bR(e,t){const n=an[function kke(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}function WJ(e){const t=e.length/6|0,n=new Array(t);for(let i=0;i<t;)n[i]="#"+e.slice(6*i,6*++i);return n}function YJ(e,t){for(const n in e)wR(n,t(e[n]))}const KJ={};function wR(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(KJ[e]=t,this):KJ[e]}YJ({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},WJ),YJ({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},e=>hC(WJ(e)));const pC="symbol",Lke=e=>ie(e)?e.map(t=>String(t)):String(e),jke=(e,t)=>e[1]-t[1],Bke=(e,t)=>t[1]-e[1];function DR(e,t,n){let i;return nn(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),null!=n&&(t=Math.min(t,Math.floor(Q_(e.domain())/n||1)))),Se(t)&&(i=t.step,t=t.interval),be(t)&&(t=e.type===ah?jg(t):e.type==lh?Bg(t):te("Only time and utc scales accept interval strings."),i&&(t=t.every(i))),t}function JJ(e,t,n){let i=e.range(),r=i[0],s=bt(i),o=jke;if(r>s&&(i=s,s=r,r=i,o=Bke),r=Math.floor(r),s=Math.ceil(s),t=t.map(a=>[a,e(a)]).filter(a=>r<=a[1]&&a[1]<=s).sort(o).map(a=>a[0]),n>0&&t.length>1){const a=[t[0],bt(t)];for(;t.length>n&&t.length>=3;)t=t.filter((l,u)=>!(u%2));t.length<3&&(t=a)}return t}function CR(e,t){return e.bins?JJ(e,e.bins):e.ticks?e.ticks(t):e.domain()}function XJ(e,t,n,i,r,s){const o=t.type;let a=Lke;if(o===ah||r===ah)a=e.timeFormat(i);else if(o===lh||r===lh)a=e.utcFormat(i);else if(VJ(o)){const l=e.formatFloat(i);if(s||t.bins)a=l;else{const u=QJ(t,n,!1);a=c=>u(c)?l(c):""}}else if(t.tickFormat){const l=t.domain();a=e.formatSpan(l[0],l[l.length-1],n,i)}else i&&(a=e.format(i));return a}function QJ(e,t,n){const i=CR(e,t),r=e.base(),s=Math.log(r),o=Math.max(1,r*t/i.length),a=l=>{let u=l/Math.pow(r,Math.round(Math.log(l)/s));return u*r<r-.5&&(u*=r),u<=o};return n?i.filter(a):a}const ER={[Qg]:"quantiles",[cC]:"thresholds",[dC]:"domain"},ZJ={[Qg]:"quantiles",[cC]:"domain"};function eX(e,t){return e.bins?function Hke(e){const t=e.slice(0,-1);return t.max=bt(e),t}(e.bins):e.type===Wu?QJ(e,t,!0):ER[e.type]?function Vke(e){const t=[-1/0].concat(e);return t.max=1/0,t}(e[ER[e.type]]()):CR(e,t)}function tX(e,t,n,i,r,s,o){const a=ZJ[t.type]&&s!==ah&&s!==lh?function $ke(e,t,n){const i=t[ZJ[t.type]](),r=i.length;let o,s=r>1?i[1]-i[0]:i[0];for(o=1;o<r;++o)s=Math.min(s,i[o]-i[o-1]);return e.formatSpan(0,s,30,n)}(e,t,r):XJ(e,t,n,r,s,o);return i===pC&&(e=>ER[e.type]||e.bins)(t)?zke(a):"discrete"===i?qke(a):Gke(a)}const zke=e=>(t,n,i)=>{const r=nX(i[n+1],nX(i.max,1/0)),s=iX(t,e),o=iX(r,e);return s&&o?s+" \u2013 "+o:o?"< "+o:"\u2265 "+s},nX=(e,t)=>null!=e?e:t,qke=e=>(t,n)=>n?e(t):null,Gke=e=>t=>e(t),iX=(e,t)=>Number.isFinite(e)?t(e):null;function rX(e,t,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=function Yke(e,t,n,i){const r=i||t.type;return be(n)&&function Oke(e){return uh(e,mR)}(r)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||r!==ah?n||r!==lh?tX(e,t,5,null,n,i,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X")}(e,t,n.format,n.formatType);if(vR(t.type)){const s=eX(t).slice(1).map(r),o=s.length;return"".concat(o," boundar").concat(1===o?"y":"ies",": ").concat(s.join(", "))}if(Zg(t.type)){const s=t.domain(),o=s.length,a=o>i?s.slice(0,i-2).map(r).join(", ")+", ending with "+s.slice(-1).map(r):s.map(r).join(", ");return"".concat(o," value").concat(1===o?"":"s",": ").concat(a)}{const s=t.domain();return"values from ".concat(r(s[0])," to ").concat(r(bt(s)))}}let sX=0;function SR(e){return e&&e.gradient}function oX(e,t,n){const i=e.gradient;let r=e.id,s="radial"===i?"p_":"";return r||(r=e.id="gradient_"+sX++,"radial"===i?(e.x1=Rl(e.x1,.5),e.y1=Rl(e.y1,.5),e.r1=Rl(e.r1,0),e.x2=Rl(e.x2,.5),e.y2=Rl(e.y2,.5),e.r2=Rl(e.r2,.5),s="p_"):(e.x1=Rl(e.x1,0),e.y1=Rl(e.y1,0),e.x2=Rl(e.x2,1),e.y2=Rl(e.y2,0))),t[r]=e,"url("+(n||"")+"#"+s+r+")"}function Rl(e,t){return null!=e?e:t}function aX(e,t){var i,n=[];return i={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(r,s){return n.push({offset:r,color:s}),i}}}const lX={basis:{curve:function DOe(e){return new VD(e)}},"basis-closed":{curve:function COe(e){return new QY(e)}},"basis-open":{curve:function EOe(e){return new ZY(e)}},bundle:{curve:SOe,tension:"beta",value:.85},cardinal:{curve:xOe,tension:"tension",value:0},"cardinal-open":{curve:AOe,tension:"tension",value:0},"cardinal-closed":{curve:MOe,tension:"tension",value:0},"catmull-rom":{curve:NOe,tension:"alpha",value:.5},"catmull-rom-closed":{curve:kOe,tension:"alpha",value:.5},"catmull-rom-open":{curve:IOe,tension:"alpha",value:.5},linear:{curve:OI},"linear-closed":{curve:function ROe(e){return new aK(e)}},monotone:{horizontal:function POe(e){return new dK(e)},vertical:function FOe(e){return new zD(e)}},natural:{curve:function LOe(e){return new hK(e)}},step:{curve:function jOe(e){return new qD(e,.5)}},"step-after":{curve:function $Oe(e){return new qD(e,1)}},"step-before":{curve:function BOe(e){return new qD(e,0)}}};function xR(e,t,n){var i=Fe(lX,e)&&lX[e],r=null;return i&&(r=i.curve||i[t||"vertical"],i.tension&&null!=n&&(r=r[i.tension](n))),r}const Jke={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},Xke=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,Qke=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,Zke=/^((\s+,?\s*)|(,\s*))/,eIe=/^[01]/;function em(e){const t=[];return(e.match(Xke)||[]).forEach(i=>{let r=i[0];const s=r.toLowerCase(),o=Jke[s],a=function tIe(e,t,n){const i=[];for(let r=0;t&&r<n.length;)for(let s=0;s<t;++s){const o="a"!==e||3!==s&&4!==s?Qke:eIe,a=n.slice(r).match(o);if(null===a)throw Error("Invalid SVG path, incorrect parameter type");r+=a[0].length,i.push(+a[0]);const l=n.slice(r).match(Zke);null!==l&&(r+=l[0].length)}return i}(s,o,i.slice(1).trim()),l=a.length;if(l<o||l&&l%o!=0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([r,...a.slice(0,o)]),l!==o){"m"===s&&(r="M"===r?"L":"l");for(let u=o;u<l;u+=o)t.push([r,...a.slice(u,u+o)])}}),t}const pd=Math.PI/180,ch=Math.PI/2,Fl=2*Math.PI,tm=Math.sqrt(3)/2;var AR={},MR={},uX=[].join;function rIe(e){const t=uX.call(e);if(MR[t])return MR[t];var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7];const c=u*o,d=-l*a,f=l*o,h=u*a,p=Math.cos(r),g=Math.sin(r),m=Math.cos(s),_=Math.sin(s),y=.5*(s-r),v=Math.sin(.5*y),b=8/3*v*v/Math.sin(y),D=n+p-b*g,C=i+g+b*p,w=n+m,E=i+_,N=w+b*_,k=E-b*m;return MR[t]=[c*D+d*C,f*D+h*C,c*N+d*k,f*N+h*k,c*w+d*E,f*w+h*E]}const Ho=["l",0,0,0,0,0,0,0];function sIe(e,t,n){const i=Ho[0]=e[0];if("a"===i||"A"===i)Ho[1]=t*e[1],Ho[2]=n*e[2],Ho[3]=e[3],Ho[4]=e[4],Ho[5]=e[5],Ho[6]=t*e[6],Ho[7]=n*e[7];else if("h"===i||"H"===i)Ho[1]=t*e[1];else if("v"===i||"V"===i)Ho[1]=n*e[1];else for(var r=1,s=e.length;r<s;++r)Ho[r]=(r%2==1?t:n)*e[r];return Ho}function Ry(e,t,n,i,r,s){var o,f,h,p,g,a=null,l=0,u=0,c=0,d=0,m=0,_=0;null==n&&(n=0),null==i&&(i=0),null==r&&(r=1),null==s&&(s=r),e.beginPath&&e.beginPath();for(var y=0,v=t.length;y<v;++y){switch(o=t[y],(1!==r||1!==s)&&(o=sIe(o,r,s)),o[0]){case"l":e.lineTo((l+=o[1])+n,(u+=o[2])+i);break;case"L":e.lineTo((l=o[1])+n,(u=o[2])+i);break;case"h":e.lineTo((l+=o[1])+n,u+i);break;case"H":e.lineTo((l=o[1])+n,u+i);break;case"v":e.lineTo(l+n,(u+=o[1])+i);break;case"V":e.lineTo(l+n,(u=o[1])+i);break;case"m":m=l+=o[1],_=u+=o[2],e.moveTo(l+n,u+i);break;case"M":m=l=o[1],_=u=o[2],e.moveTo(l+n,u+i);break;case"c":e.bezierCurveTo(l+o[1]+n,u+o[2]+i,(c=l+o[3])+n,(d=u+o[4])+i,(f=l+o[5])+n,(h=u+o[6])+i),l=f,u=h;break;case"C":e.bezierCurveTo(o[1]+n,o[2]+i,(c=o[3])+n,(d=o[4])+i,(l=o[5])+n,(u=o[6])+i);break;case"s":e.bezierCurveTo((c=2*l-c)+n,(d=2*u-d)+i,l+o[1]+n,u+o[2]+i,(f=l+o[3])+n,(h=u+o[4])+i),c=l+o[1],d=u+o[2],l=f,u=h;break;case"S":e.bezierCurveTo((c=2*l-c)+n,(d=2*u-d)+i,o[1]+n,o[2]+i,(f=o[3])+n,(h=o[4])+i),l=f,u=h,c=o[1],d=o[2];break;case"q":e.quadraticCurveTo((c=l+o[1])+n,(d=u+o[2])+i,(f=l+o[3])+n,(h=u+o[4])+i),l=f,u=h;break;case"Q":e.quadraticCurveTo(o[1]+n,o[2]+i,(f=o[3])+n,(h=o[4])+i),l=f,u=h,c=o[1],d=o[2];break;case"t":f=l+o[1],h=u+o[2],null===a[0].match(/[QqTt]/)?(c=l,d=u):"t"===a[0]?(c=2*l-p,d=2*u-g):"q"===a[0]&&(c=2*l-c,d=2*u-d),p=c,g=d,e.quadraticCurveTo(c+n,d+i,f+n,h+i),c=(l=f)+o[1],d=(u=h)+o[2];break;case"T":e.quadraticCurveTo((c=2*l-c)+n,(d=2*u-d)+i,(f=o[1])+n,(h=o[2])+i),l=f,u=h;break;case"a":cX(e,l+n,u+i,[o[1],o[2],o[3],o[4],o[5],o[6]+l+n,o[7]+u+i]),l+=o[6],u+=o[7];break;case"A":cX(e,l+n,u+i,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+i]),l=o[6],u=o[7];break;case"z":case"Z":l=m,u=_,e.closePath()}a=o}}function cX(e,t,n,i){const r=function iIe(e,t,n,i,r,s,o,a,l){const u=uX.call(arguments);if(AR[u])return AR[u];const c=o*pd,d=Math.sin(c),f=Math.cos(c),h=f*(a-e)*.5+d*(l-t)*.5,p=f*(l-t)*.5-d*(a-e)*.5;let g=h*h/((n=Math.abs(n))*n)+p*p/((i=Math.abs(i))*i);g>1&&(g=Math.sqrt(g),n*=g,i*=g);const m=f/n,_=d/n,y=-d/i,v=f/i,b=m*a+_*l,D=y*a+v*l,C=m*e+_*t,w=y*e+v*t;let N=1/((C-b)*(C-b)+(w-D)*(w-D))-.25;N<0&&(N=0);let k=Math.sqrt(N);s==r&&(k=-k);const I=.5*(b+C)-k*(w-D),L=.5*(D+w)+k*(C-b),B=Math.atan2(D-L,b-I);let A=Math.atan2(w-L,C-I)-B;A<0&&1===s?A+=Fl:A>0&&0===s&&(A-=Fl);const x=Math.ceil(Math.abs(A/(ch+.001))),F=[];for(let O=0;O<x;++O)F[O]=[I,L,B+O*A/x,B+(O+1)*A/x,n,i,d,f];return AR[u]=F}(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n);for(let s=0;s<r.length;++s){const o=rIe(r[s]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const dX=.5773502691896257,fX={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Fl)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,s=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-s),e.lineTo(r,-s),e.lineTo(0,-n),e.lineTo(-r,-s),e.lineTo(-i,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=tm*n,r=i-n*dX,s=n/4;e.moveTo(0,-i-r),e.lineTo(-s,i-r),e.lineTo(s,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=tm*n,r=i-n*dX;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,i=tm*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,i=tm*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,i=tm*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,i=tm*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function hX(e){return Fe(fX,e)?fX[e]:function oIe(e){if(!Fe(TR,e)){const t=em(e);TR[e]={draw:function(n,i){Ry(n,t,0,0,Math.sqrt(i)/2)}}}return TR[e]}(e)}var TR={};const gd=.448084975506;function aIe(e){return e.x}function lIe(e){return e.y}function uIe(e){return e.width}function cIe(e){return e.height}function Yu(e){return"function"==typeof e?e:()=>+e}function mC(e,t,n){return Math.max(t,Math.min(e,n))}function pX(){var e=aIe,t=lIe,n=uIe,i=cIe,r=Yu(0),s=r,o=r,a=r,l=null;function u(c,d,f){var h,p=null!=d?d:+e.call(this,c),g=null!=f?f:+t.call(this,c),m=+n.call(this,c),_=+i.call(this,c),y=Math.min(m,_)/2,v=mC(+r.call(this,c),0,y),b=mC(+s.call(this,c),0,y),D=mC(+o.call(this,c),0,y),C=mC(+a.call(this,c),0,y);if(l||(l=h=th()),v<=0&&b<=0&&D<=0&&C<=0)l.rect(p,g,m,_);else{var w=p+m,E=g+_;l.moveTo(p+v,g),l.lineTo(w-b,g),l.bezierCurveTo(w-gd*b,g,w,g+gd*b,w,g+b),l.lineTo(w,E-C),l.bezierCurveTo(w,E-gd*C,w-gd*C,E,w-C,E),l.lineTo(p+D,E),l.bezierCurveTo(p+gd*D,E,p,E-gd*D,p,E-D),l.lineTo(p,g+v),l.bezierCurveTo(p,g+gd*v,p+gd*v,g,p+v,g),l.closePath()}if(h)return l=null,h+""||null}return u.x=function(c){return arguments.length?(e=Yu(c),u):e},u.y=function(c){return arguments.length?(t=Yu(c),u):t},u.width=function(c){return arguments.length?(n=Yu(c),u):n},u.height=function(c){return arguments.length?(i=Yu(c),u):i},u.cornerRadius=function(c,d,f,h){return arguments.length?(r=Yu(c),s=null!=d?Yu(d):r,a=null!=f?Yu(f):r,o=null!=h?Yu(h):s,u):r},u.context=function(c){return arguments.length?(l=null==c?null:c,u):l},u}function gX(){var e,t,n,i,s,o,a,l,r=null;function u(d,f,h){const p=h/2;if(s){var g=a-f,m=d-o;if(g||m){var _=Math.sqrt(g*g+m*m),y=(g/=_)*l,v=(m/=_)*l,b=Math.atan2(m,g);r.moveTo(o-y,a-v),r.lineTo(d-g*p,f-m*p),r.arc(d,f,p,b-Math.PI,b),r.lineTo(o+y,a+v),r.arc(o,a,l,b,b+Math.PI)}else r.arc(d,f,p,0,Fl);r.closePath()}else s=1;o=d,a=f,l=p}function c(d){var f,p,m,h=d.length,g=!1;for(null==r&&(r=m=th()),f=0;f<=h;++f)!(f<h&&i(p=d[f],f,d))===g&&(g=!g)&&(s=0),g&&u(+e(p,f,d),+t(p,f,d),+n(p,f,d));if(m)return r=null,m+""||null}return c.x=function(d){return arguments.length?(e=d,c):e},c.y=function(d){return arguments.length?(t=d,c):t},c.size=function(d){return arguments.length?(n=d,c):n},c.defined=function(d){return arguments.length?(i=d,c):i},c.context=function(d){return arguments.length?(r=null==d?null:d,c):r},c}function Fy(e,t){return null!=e?e:t}const Py=e=>e.x||0,Ly=e=>e.y||0,_C=e=>!1!==e.defined,MIe=function YOe(){var e=HOe,t=UOe,n=qt(0),i=null,r=zOe,s=qOe,o=GOe,a=null;function l(){var u,c,d=+e.apply(this,arguments),f=+t.apply(this,arguments),h=r.apply(this,arguments)-UD,p=s.apply(this,arguments)-UD,g=tK(p-h),m=p>h;if(a||(a=u=th()),f<d&&(c=f,f=d,d=c),f>Dr)if(g>Dy-Dr)a.moveTo(f*Gu(h),f*gs(h)),a.arc(0,0,f,h,p,!m),d>Dr&&(a.moveTo(d*Gu(p),d*gs(p)),a.arc(0,0,d,p,h,m));else{var L,B,_=h,y=p,v=h,b=p,D=g,C=g,w=o.apply(this,arguments)/2,E=w>Dr&&(i?+i.apply(this,arguments):Dn(d*d+f*f)),N=qg(tK(f-d)/2,+n.apply(this,arguments)),k=N,I=N;if(E>Dr){var T=nK(E/d*gs(w)),A=nK(E/f*gs(w));(D-=2*T)>Dr?(v+=T*=m?1:-1,b-=T):(D=0,v=b=(h+p)/2),(C-=2*A)>Dr?(_+=A*=m?1:-1,y-=A):(C=0,_=y=(h+p)/2)}var x=f*Gu(_),F=f*gs(_),O=d*Gu(b),j=d*gs(b);if(N>Dr){var V,P=f*Gu(y),z=f*gs(y),q=d*Gu(v),G=d*gs(v);if(g<ad&&(V=WOe(x,F,q,G,P,z,O,j))){var K=x-V[0],re=F-V[1],X=P-V[0],le=z-V[1],Y=1/gs(OOe((K*X+re*le)/(Dn(K*K+re*re)*Dn(X*X+le*le)))/2),Z=Dn(V[0]*V[0]+V[1]*V[1]);k=qg(N,(d-Z)/(Y-1)),I=qg(N,(f-Z)/(Y+1))}}C>Dr?I>Dr?(L=GD(q,G,x,F,f,I,m),B=GD(P,z,O,j,f,I,m),a.moveTo(L.cx+L.x01,L.cy+L.y01),I<N?a.arc(L.cx,L.cy,I,wr(L.y01,L.x01),wr(B.y01,B.x01),!m):(a.arc(L.cx,L.cy,I,wr(L.y01,L.x01),wr(L.y11,L.x11),!m),a.arc(0,0,f,wr(L.cy+L.y11,L.cx+L.x11),wr(B.cy+B.y11,B.cx+B.x11),!m),a.arc(B.cx,B.cy,I,wr(B.y11,B.x11),wr(B.y01,B.x01),!m))):(a.moveTo(x,F),a.arc(0,0,f,_,y,!m)):a.moveTo(x,F),d>Dr&&D>Dr?k>Dr?(L=GD(O,j,P,z,d,-k,m),B=GD(x,F,q,G,d,-k,m),a.lineTo(L.cx+L.x01,L.cy+L.y01),k<N?a.arc(L.cx,L.cy,k,wr(L.y01,L.x01),wr(B.y01,B.x01),!m):(a.arc(L.cx,L.cy,k,wr(L.y01,L.x01),wr(L.y11,L.x11),!m),a.arc(0,0,d,wr(L.cy+L.y11,L.cx+L.x11),wr(B.cy+B.y11,B.cx+B.x11),m),a.arc(B.cx,B.cy,k,wr(B.y11,B.x11),wr(B.y01,B.x01),!m))):a.arc(0,0,d,b,v,m):a.lineTo(O,j)}else a.moveTo(0,0);if(a.closePath(),u)return a=null,u+""||null}return l.centroid=function(){var u=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-ad/2;return[Gu(c)*u,gs(c)*u]},l.innerRadius=function(u){return arguments.length?(e="function"==typeof u?u:qt(+u),l):e},l.outerRadius=function(u){return arguments.length?(t="function"==typeof u?u:qt(+u),l):t},l.cornerRadius=function(u){return arguments.length?(n="function"==typeof u?u:qt(+u),l):n},l.padRadius=function(u){return arguments.length?(i=null==u?null:"function"==typeof u?u:qt(+u),l):i},l.startAngle=function(u){return arguments.length?(r="function"==typeof u?u:qt(+u),l):r},l.endAngle=function(u){return arguments.length?(s="function"==typeof u?u:qt(+u),l):s},l.padAngle=function(u){return arguments.length?(o="function"==typeof u?u:qt(+u),l):o},l.context=function(u){return arguments.length?(a=null==u?null:u,l):a},l}().startAngle(e=>e.startAngle||0).endAngle(e=>e.endAngle||0).padAngle(e=>e.padAngle||0).innerRadius(e=>e.innerRadius||0).outerRadius(e=>e.outerRadius||0).cornerRadius(e=>e.cornerRadius||0),TIe=bK().x(Py).y1(Ly).y0(e=>(e.y||0)+(e.height||0)).defined(_C),OIe=bK().y(Ly).x1(Py).x0(e=>(e.x||0)+(e.width||0)).defined(_C),NIe=vK().x(Py).y(Ly).defined(_C),kIe=pX().x(Py).y(Ly).width(e=>e.width||0).height(e=>e.height||0).cornerRadius(e=>Fy(e.cornerRadiusTopLeft,e.cornerRadius)||0,e=>Fy(e.cornerRadiusTopRight,e.cornerRadius)||0,e=>Fy(e.cornerRadiusBottomRight,e.cornerRadius)||0,e=>Fy(e.cornerRadiusBottomLeft,e.cornerRadius)||0),IIe=function pNe(e,t){let n=null;function i(){let r;if(n||(n=r=th()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return e="function"==typeof e?e:qt(e||FI),t="function"==typeof t?t:qt(void 0===t?64:+t),i.type=function(r){return arguments.length?(e="function"==typeof r?r:qt(r),i):e},i.size=function(r){return arguments.length?(t="function"==typeof r?r:qt(+r),i):t},i.context=function(r){return arguments.length?(n=null==r?null:r,i):n},i}().type(e=>hX(e.shape||"circle")).size(e=>Fy(e.size,64)),RIe=gX().x(Py).y(Ly).defined(_C).size(e=>e.size||1);function OR(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function nm(e,t,n,i){return kIe.context(e)(t,n,i)}var mX=1;function _X(){mX=1}function NR(e,t,n){var i=t.clip,r=e._defs,s=t.clip_id||(t.clip_id="clip"+mX++),o=r.clipping[s]||(r.clipping[s]={id:s});return st(i)?o.path=i(null):OR(n)?o.path=nm(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+s+")"}function fi(e){this.clear(),e&&this.union(e)}function yC(e){this.mark=e,this.bounds=this.bounds||new fi}function vC(e){yC.call(this,e),this.items=this.items||[]}function kR(e){this._pending=0,this._loader=e||DD()}function yX(e){e._pending+=1}function jy(e){e._pending-=1}function Ku(e,t,n){if(t.stroke&&0!==t.opacity&&0!==t.strokeOpacity){const i=null!=t.strokeWidth?+t.strokeWidth:1;e.expand(i+(n?function VIe(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}(t,i):0))}return e}fi.prototype={clone(){return new fi(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(e,t,n){var{x1:i,y1:r,x2:s,y2:o}=this,a=Math.cos(e),l=Math.sin(e),u=t-t*a+n*l,c=n-t*l-n*a;return[a*i-l*r+u,l*i+a*r+c,a*i-l*o+u,l*i+a*o+c,a*s-l*r+u,l*s+a*r+c,a*s-l*o+u,l*s+a*o+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},fe(vC,yC),kR.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return yX(t),t._loader.sanitize(e,{context:"href"}).then(n=>(jy(t),n)).catch(()=>(jy(t),null))},loadImage(e){const t=this,n="undefined"!=typeof Image?Image:null;return yX(t),t._loader.sanitize(e,{context:"image"}).then(i=>{const r=i.href;if(!r||!n)throw{url:r};const s=new n,o=Fe(i,"crossOrigin")?i.crossOrigin:"anonymous";return null!=o&&(s.crossOrigin=o),s.onload=()=>jy(t),s.onerror=()=>jy(t),s.src=r,s}).catch(i=>(jy(t),{complete:!1,width:0,height:0,src:i&&i.url||""}))},ready(){const e=this;return new Promise(t=>{!function n(i){e.pending()?setTimeout(()=>{n(!0)},10):t(i)}(!1)})}};const HIe=Fl-1e-8;let bC,wC,DC,dh,IR,CC,RR,FR;const md=(e,t)=>bC.add(e,t),EC=(e,t)=>md(wC=e,DC=t),vX=e=>md(e,bC.y1),bX=e=>md(bC.x1,e),fh=(e,t)=>IR*e+RR*t,hh=(e,t)=>CC*e+FR*t,PR=(e,t)=>md(fh(e,t),hh(e,t)),LR=(e,t)=>EC(fh(e,t),hh(e,t));function By(e,t){return bC=e,t?(dh=t*pd,IR=FR=Math.cos(dh),CC=Math.sin(dh),RR=-CC):(IR=FR=1,dh=CC=RR=0),UIe}const UIe={beginPath(){},closePath(){},moveTo:LR,lineTo:LR,rect(e,t,n,i){dh?(PR(e+n,t),PR(e+n,t+i),PR(e,t+i),LR(e,t)):(md(e+n,t+i),EC(e,t))},quadraticCurveTo(e,t,n,i){const r=fh(e,t),s=hh(e,t),o=fh(n,i),a=hh(n,i);wX(wC,r,o,vX),wX(DC,s,a,bX),EC(o,a)},bezierCurveTo(e,t,n,i,r,s){const o=fh(e,t),a=hh(e,t),l=fh(n,i),u=hh(n,i),c=fh(r,s),d=hh(r,s);DX(wC,o,l,c,vX),DX(DC,a,u,d,bX),EC(c,d)},arc(e,t,n,i,r,s){if(i+=dh,r+=dh,wC=n*Math.cos(r)+e,DC=n*Math.sin(r)+t,Math.abs(r-i)>HIe)md(e-n,t-n),md(e+n,t+n);else{const o=u=>md(n*Math.cos(u)+e,n*Math.sin(u)+t);let a,l;if(o(i),o(r),r!==i)if((i%=Fl)<0&&(i+=Fl),(r%=Fl)<0&&(r+=Fl),r<i&&(s=!s,a=i,i=r,r=a),s)for(r-=Fl,a=i-i%ch,l=0;l<4&&a>r;++l,a-=ch)o(a);else for(a=i-i%ch+ch,l=0;l<4&&a<r;++l,a+=ch)o(a)}}};function wX(e,t,n,i){const r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function DX(e,t,n,i,r){const s=i-e+3*t-3*n,o=e+n-2*t,a=e-t;let c,l=0,u=0;Math.abs(s)>1e-14?(c=o*o+a*s,c>=0&&(c=Math.sqrt(c),l=(-o+c)/s,u=(-o-c)/s)):l=.5*a/o,0<l&&l<1&&r(CX(l,e,t,n,i)),0<u&&u<1&&r(CX(u,e,t,n,i))}function CX(e,t,n,i,r){const s=1-e,o=s*s,a=e*e;return o*s*t+3*o*e*n+3*s*a*i+a*e*r}var _d=(_d=ld(1,1))?_d.getContext("2d"):null;const jR=new fi;function BR(e){return function(t,n){if(!_d)return!0;e(_d,t),jR.clear().union(t.bounds).intersect(n).round();const{x1:i,y1:r,x2:s,y2:o}=jR;for(let a=r;a<=o;++a)for(let l=i;l<=s;++l)if(_d.isPointInPath(l,a))return!0;return!1}}function $R(e,t){return t.contains(e.x||0,e.y||0)}function EX(e,t){const n=e.x||0,i=e.y||0;return t.intersects(jR.set(n,i,n+(e.width||0),i+(e.height||0)))}function SX(e,t){const n=e.x||0,i=e.y||0;return im(t,n,i,null!=e.x2?e.x2:n,null!=e.y2?e.y2:i)}function im(e,t,n,i,r){const{x1:s,y1:o,x2:a,y2:l}=e,u=i-t,c=r-n;let h,p,g,m,d=0,f=1;for(m=0;m<4;++m){if(0===m&&(h=-u,p=-(s-t)),1===m&&(h=u,p=a-t),2===m&&(h=-c,p=-(o-n)),3===m&&(h=c,p=l-n),Math.abs(h)<1e-10&&p<0)return!1;if(g=p/h,h<0){if(g>f)return!1;g>d&&(d=g)}else if(h>0){if(g<d)return!1;g<f&&(f=g)}}return!0}function rm(e,t){e.globalCompositeOperation=t.blend||"source-over"}function ka(e,t){return null==e?t:e}function xX(e,t){const n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}function AX(e,t,n){return SR(n)?function zIe(e,t,n){const i=n.width(),r=n.height();let s;if("radial"===t.gradient)s=e.createRadialGradient(n.x1+ka(t.x1,.5)*i,n.y1+ka(t.y1,.5)*r,Math.max(i,r)*ka(t.r1,0),n.x1+ka(t.x2,.5)*i,n.y1+ka(t.y2,.5)*r,Math.max(i,r)*ka(t.r2,.5));else{const o=ka(t.x1,0),a=ka(t.y1,0),l=ka(t.x2,1),u=ka(t.y2,0);if(o!==l&&a!==u&&i!==r){const c=ld(Math.ceil(i),Math.ceil(r)),d=c.getContext("2d");return d.scale(i,r),d.fillStyle=xX(d.createLinearGradient(o,a,l,u),t.stops),d.fillRect(0,0,i,r),e.createPattern(c,"no-repeat")}s=e.createLinearGradient(n.x1+o*i,n.y1+a*r,n.x1+l*i,n.y1+u*r)}return xX(s,t.stops)}(e,n,t.bounds):n}function SC(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=AX(e,t,t.fill),!0)}var qIe=[];function sm(e,t,n){var i=null!=(i=t.strokeWidth)?i:1;return!(i<=0)&&(n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=AX(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||qIe),e.lineDashOffset=t.strokeDashOffset||0),!0)}function GIe(e,t){return e.zindex-t.zindex||e.index-t.index}function VR(e){if(!e.zdirty)return e.zitems;var i,r,s,t=e.items,n=[];for(r=0,s=t.length;r<s;++r)(i=t[r]).index=r,i.zindex&&n.push(i);return e.zdirty=!1,e.zitems=n.sort(GIe)}function Ia(e,t){var i,r,n=e.items;if(!n||!n.length)return;const s=VR(e);if(s&&s.length){for(i=0,r=n.length;i<r;++i)n[i].zindex||t(n[i]);n=s}for(i=0,r=n.length;i<r;++i)t(n[i])}function xC(e,t){var i,r,n=e.items;if(!n||!n.length)return null;const s=VR(e);for(s&&s.length&&(n=s),r=n.length;--r>=0;)if(i=t(n[r]))return i;if(n===s)for(r=(n=e.items).length;--r>=0;)if(!n[r].zindex&&(i=t(n[r])))return i;return null}function HR(e){return function(t,n,i){Ia(n,r=>{(!i||i.intersects(r.bounds))&&MX(e,t,r,r)})}}function WIe(e){return function(t,n,i){n.items.length&&(!i||i.intersects(n.bounds))&&MX(e,t,n.items[0],n.items)}}function MX(e,t,n,i){var r=null==n.opacity?1:n.opacity;0!==r&&(e(t,i)||(rm(t,n),n.fill&&SC(t,n,r)&&t.fill(),n.stroke&&sm(t,n,r)&&t.stroke()))}function AC(e){return e=e||Fo,function(t,n,i,r,s,o){return i*=t.pixelRatio,r*=t.pixelRatio,xC(n,a=>{const l=a.bounds;if((!l||l.contains(s,o))&&l&&e(t,a,i,r,s,o))return a})}}function $y(e,t){return function(n,i,r,s){var u,c,o=Array.isArray(i)?i[0]:i,a=null==t?o.fill:t,l=o.stroke&&n.isPointInStroke;return l&&(c=o.strokeCap,n.lineWidth=null!=(u=o.strokeWidth)?u:1,n.lineCap=null!=c?c:"butt"),!e(n,i)&&(a&&n.isPointInPath(r,s)||l&&n.isPointInStroke(r,s))}}function UR(e){return AC($y(e))}function ph(e,t){return"translate("+e+","+t+")"}function zR(e){return"rotate("+e+")"}function TX(e){return ph(e.x||0,e.y||0)}function qR(e,t,n){function s(o,a){var l=a.x||0,u=a.y||0,c=a.angle||0;o.translate(l,u),c&&o.rotate(c*=pd),o.beginPath(),t(o,a),c&&o.rotate(-c),o.translate(-l,-u)}return{type:e,tag:"path",nested:!1,attr:function i(o,a){o("transform",function KIe(e){return ph(e.x||0,e.y||0)+(e.angle?" "+zR(e.angle):"")}(a)),o("d",t(null,a))},bound:function r(o,a){return t(By(o,a.angle),a),Ku(o,a).translate(a.x||0,a.y||0)},draw:HR(s),pick:UR(s),isect:n||BR(s)}}var XIe=qR("arc",function FIe(e,t){return MIe.context(e)(t)});function GR(e,t,n){function s(l,u){l.beginPath(),t(l,u)}const o=$y(s);return{type:e,tag:"path",nested:!0,attr:function i(l,u){var c=u.mark.items;c.length&&l("d",t(null,c))},bound:function r(l,u){var c=u.items;return 0===c.length?l:(t(By(l),c),Ku(l,c[0]))},draw:WIe(s),pick:function a(l,u,c,d,f,h){var p=u.items,g=u.bounds;return!p||!p.length||g&&!g.contains(f,h)?null:o(l,p,c*=l.pixelRatio,d*=l.pixelRatio)?p[0]:null},isect:$R,tip:n}}var tRe=GR("area",function PIe(e,t){const n=t[0];return("horizontal"===n.orient?OIe:TIe).curve(xR(n.interpolate||"linear",n.orient,n.tension)).context(e)(t)},function QIe(e,t){for(var o,a,n="horizontal"===e[0].orient?t[1]:t[0],i="horizontal"===e[0].orient?"y":"x",r=e.length,s=1/0;--r>=0;)!1!==e[r].defined&&(a=Math.abs(e[r][i]-n))<s&&(s=a,o=e[r]);return o});function OX(e,t){e.beginPath(),OR(t)?nm(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function NX(e){const t=ka(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function kX(e,t){const n=NX(t);e("d",nm(null,t,n,n))}function Vy(e,t,n,i){const r=NX(t);e.beginPath(),nm(e,t,(n||0)+r,(i||0)+r)}const lRe=$y(Vy),uRe=$y(Vy,!1),cRe=$y(Vy,!0);var pRe={type:"group",tag:"g",nested:!1,attr:function iRe(e,t){e("transform",TX(t))},bound:function aRe(e,t){if(!t.clip&&t.items){const n=t.items,i=n.length;for(let r=0;r<i;++r)e.union(n[r].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Ku(e,t),e.translate(t.x||0,t.y||0)},draw:function dRe(e,t,n){Ia(t,i=>{const r=i.x||0,s=i.y||0,o=i.strokeForeground,a=null==i.opacity?1:i.opacity;(i.stroke||i.fill)&&a&&(Vy(e,i,r,s),rm(e,i),i.fill&&SC(e,i,a)&&e.fill(),i.stroke&&!o&&sm(e,i,a)&&e.stroke()),e.save(),e.translate(r,s),i.clip&&OX(e,i),n&&n.translate(-r,-s),Ia(i,l=>{this.draw(e,l,n)}),n&&n.translate(r,s),e.restore(),o&&i.stroke&&a&&(Vy(e,i,r,s),rm(e,i),sm(e,i,a)&&e.stroke())})},pick:function fRe(e,t,n,i,r,s){if(t.bounds&&!t.bounds.contains(r,s)||!t.items)return null;const o=n*e.pixelRatio,a=i*e.pixelRatio;return xC(t,l=>{let u,c,d;const f=l.bounds;if(f&&!f.contains(r,s))return;c=l.x||0,d=l.y||0;const g=l.clip;if(g&&(r<c||r>c+(l.width||0)||s<d||s>d+(l.height||0)))return;if(e.save(),e.translate(c,d),c=r-c,d=s-d,g&&OR(l)&&!cRe(e,l,o,a))return e.restore(),null;const m=l.strokeForeground,_=!1!==t.interactive;return _&&m&&l.stroke&&uRe(e,l,o,a)?(e.restore(),l):(u=xC(l,y=>function hRe(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}(y,c,d)?this.pick(y,n,i,c,d):null),!u&&_&&(l.fill||!m&&l.stroke)&&lRe(e,l,o,a)&&(u=l),e.restore(),u||null)})},isect:EX,content:function oRe(e,t,n){e("clip-path",t.clip?NR(n,t,t):null)},background:function rRe(e,t){e("class","background"),e("aria-hidden",!0),kX(e,t)},foreground:function sRe(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?kX(e,t):e("d","")}},Hy={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function WR(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(i=>{e.image=i,e.image.url=e.url})),n}function YR(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function KR(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function MC(e,t){return"center"===e?t/2:"right"===e?t:0}function TC(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var yRe={type:"image",tag:"image",nested:!1,attr:function gRe(e,t,n){const i=WR(t,n),r=YR(t,i),s=KR(t,i),o=(t.x||0)-MC(t.align,r),a=(t.y||0)-TC(t.baseline,s);e("href",!i.src&&i.toDataURL?i.toDataURL():i.src||"",Hy["xmlns:xlink"],"xlink:href"),e("transform",ph(o,a)),e("width",r),e("height",s),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")},bound:function mRe(e,t){const n=t.image,i=YR(t,n),r=KR(t,n),s=(t.x||0)-MC(t.align,i),o=(t.y||0)-TC(t.baseline,r);return e.set(s,o,s+i,o+r)},draw:function _Re(e,t,n){Ia(t,i=>{if(n&&!n.intersects(i.bounds))return;const r=WR(i,this);let s=YR(i,r),o=KR(i,r);if(0===s||0===o)return;let u,c,d,f,a=(i.x||0)-MC(i.align,s),l=(i.y||0)-TC(i.baseline,o);!1!==i.aspect&&(c=r.width/r.height,d=i.width/i.height,c==c&&d==d&&c!==d&&(d<c?(f=s/c,l+=(o-f)/2,o=f):(f=o*c,a+=(s-f)/2,s=f))),(r.complete||r.toDataURL)&&(rm(e,i),e.globalAlpha=null!=(u=i.opacity)?u:1,e.imageSmoothingEnabled=!1!==i.smooth,e.drawImage(r,a,l,s,o))})},pick:AC(),isect:Fo,get:WR,xOffset:MC,yOffset:TC},vRe=GR("line",function LIe(e,t){const n=t[0];return NIe.curve(xR(n.interpolate||"linear",n.orient,n.tension)).context(e)(t)},function ZIe(e,t){for(var r,s,n=Math.pow(e[0].strokeWidth||1,2),i=e.length;--i>=0;)if(!1!==e[i].defined&&(r=e[i].x-t[0])*r+(s=e[i].y-t[1])*s<n)return e[i];return null});function OC(e,t){var n=t.path;if(null==n)return!0;var i=t.x||0,r=t.y||0,s=t.scaleX||1,o=t.scaleY||1,a=(t.angle||0)*pd,l=t.pathCache;(!l||l.path!==n)&&((t.pathCache=l=em(n)).path=n),a&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(a),Ry(e,l,0,0,s,o),e.rotate(-a),e.translate(-i,-r)):Ry(e,l,i,r,s,o)}var DRe={type:"path",tag:"path",nested:!1,attr:function bRe(e,t){(1!==(t.scaleX||1)||1!==(t.scaleY||1))&&e("vector-effect","non-scaling-stroke"),e("transform",function JIe(e){return ph(e.x||0,e.y||0)+(e.angle?" "+zR(e.angle):"")+(e.scaleX||e.scaleY?" "+function YIe(e,t){return"scale("+e+","+t+")"}(e.scaleX||1,e.scaleY||1):"")}(t)),e("d",t.path)},bound:function wRe(e,t){return OC(By(e,t.angle),t)?e.set(0,0,0,0):Ku(e,t,!0)},draw:HR(OC),pick:UR(OC),isect:BR(OC)};function IX(e,t){e.beginPath(),nm(e,t)}var SRe={type:"rect",tag:"path",nested:!1,attr:function CRe(e,t){e("d",nm(null,t))},bound:function ERe(e,t){var n,i;return Ku(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)},draw:HR(IX),pick:UR(IX),isect:EX};function RX(e,t,n){var i,r,s,o;return!(!t.stroke||!sm(e,t,n)||(i=t.x||0,r=t.y||0,s=null!=t.x2?t.x2:i,o=null!=t.y2?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(s,o),0))}var ORe={type:"rule",tag:"line",nested:!1,attr:function xRe(e,t){e("transform",TX(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function ARe(e,t){var n,i;return Ku(e.set(n=t.x||0,i=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:i),t)},draw:function MRe(e,t,n){Ia(t,i=>{if(!n||n.intersects(i.bounds)){var r=null==i.opacity?1:i.opacity;r&&RX(e,i,r)&&(rm(e,i),e.stroke())}})},pick:AC(function TRe(e,t,n,i){return!!e.isPointInStroke&&RX(e,t,1)&&e.isPointInStroke(n,i)}),isect:SX},NRe=qR("shape",function jIe(e,t){return(t.mark.shape||t.shape).context(e)(t)}),kRe=qR("symbol",function BIe(e,t){return IIe.context(e)(t)},$R);const FX=fG();var Ra={height:Pl,measureWidth:XR,estimateWidth:JR,width:JR,canvas:PX};function PX(e){Ra.width=e&&_d?XR:JR}function JR(e,t){return LX(vd(e,t),Pl(e))}function LX(e,t){return~~(.8*e.length*t)}function XR(e,t){return Pl(e)<=0||!(t=vd(e,t))?0:jX(t,NC(e))}function jX(e,t){const n="(".concat(t,") ").concat(e);let i=FX.get(n);return void 0===i&&(_d.font=t,i=_d.measureText(e).width,FX.set(n,i)),i}function Pl(e){return null!=e.fontSize?+e.fontSize||0:11}function yd(e){return null!=e.lineHeight?e.lineHeight:Pl(e)+2}function Uy(e){return function IRe(e){return ie(e)?e.length>1?e:e[0]:e}(e.lineBreak&&e.text&&!ie(e.text)?e.text.split(e.lineBreak):e.text)}function QR(e){const t=Uy(e);return(ie(t)?t.length-1:0)*yd(e)}function vd(e,t){const n=null==t?"":(t+"").trim();return e.limit>0&&n.length?function FRe(e,t){var n=+e.limit,i=function RRe(e){if(Ra.width===XR){const t=NC(e);return n=>jX(n,t)}{const t=Pl(e);return n=>LX(n,t)}}(e);if(i(t)<n)return t;var l,r=e.ellipsis||"\u2026",s="rtl"===e.dir,o=0,a=t.length;if(n-=i(r),s){for(;o<a;)i(t.slice(l=o+a>>>1))>n?o=l+1:a=l;return r+t.slice(o)}for(;o<a;)i(t.slice(0,l=1+(o+a>>>1)))<n?o=l:a=l-1;return t.slice(0,o)+r}(e,n):n}function zy(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function NC(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+Pl(e)+"px "+zy(e,t)}function ZR(e){var t=e.baseline,n=Pl(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:"line-top"===t?.29*n+.5*yd(e):"line-bottom"===t?.29*n-.5*yd(e):0)}PX(!0);const PRe={left:"start",center:"middle",right:"end"},qy=new fi;function kC(e){var r,t=e.x||0,n=e.y||0,i=e.radius||0;return i&&(r=(e.theta||0)-ch,t+=i*Math.cos(r),n+=i*Math.sin(r)),qy.x1=t,qy.y1=n,qy}function eF(e,t,n){var d,i=Ra.height(t),r=t.align,s=kC(t),o=s.x1,a=s.y1,l=t.dx||0,u=(t.dy||0)+ZR(t)-Math.round(.8*i),c=Uy(t);if(ie(c)?(i+=yd(t)*(c.length-1),d=c.reduce((f,h)=>Math.max(f,Ra.width(t,h)),0)):d=Ra.width(t,c),"center"===r?l-=d/2:"right"===r&&(l-=d),e.set(l+=o,u+=a,l+d,u+i),t.angle&&!n)e.rotate(t.angle*pd,o,a);else if(2===n)return e.rotatedPoints(t.angle*pd,o,a);return e}var VRe={type:"text",tag:"text",nested:!1,attr:function LRe(e,t){var l,n=t.dx||0,i=(t.dy||0)+ZR(t),r=kC(t),s=r.x1,o=r.y1,a=t.angle||0;e("text-anchor",PRe[t.align]||"start"),a?(l=ph(s,o)+" "+zR(a),(n||i)&&(l+=" "+ph(n,i))):l=ph(s+n,o+i),e("transform",l)},bound:eF,draw:function jRe(e,t,n){Ia(t,i=>{var s,o,a,l,u,c,d,r=null==i.opacity?1:i.opacity;if(!(n&&!n.intersects(i.bounds)||0===r||i.fontSize<=0||null==i.text||0===i.text.length)){if(e.font=NC(i),e.textAlign=i.align||"left",o=(s=kC(i)).x1,a=s.y1,i.angle&&(e.save(),e.translate(o,a),e.rotate(i.angle*pd),o=a=0),o+=i.dx||0,a+=(i.dy||0)+ZR(i),c=Uy(i),rm(e,i),ie(c))for(u=yd(i),l=0;l<c.length;++l)d=vd(i,c[l]),i.fill&&SC(e,i,r)&&e.fillText(d,o,a),i.stroke&&sm(e,i,r)&&e.strokeText(d,o,a),a+=u;else d=vd(i,c),i.fill&&SC(e,i,r)&&e.fillText(d,o,a),i.stroke&&sm(e,i,r)&&e.strokeText(d,o,a);i.angle&&e.restore()}})},pick:AC(function BRe(e,t,n,i,r,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=kC(t),a=o.x1,l=o.y1,u=eF(qy,t,1),c=-t.angle*pd,d=Math.cos(c),f=Math.sin(c);return u.contains(d*r-f*s+(a-d*a+f*l),f*r+d*s+(l-f*a-d*l))}),isect:function $Re(e,t){const n=eF(qy,e,2);return im(t,n[0],n[1],n[2],n[3])||im(t,n[0],n[1],n[4],n[5])||im(t,n[4],n[5],n[6],n[7])||im(t,n[2],n[3],n[6],n[7])}},HRe=GR("trail",function $Ie(e,t){return RIe.context(e)(t)},function eRe(e,t){for(var i,r,n=e.length;--n>=0;)if(!1!==e[n].defined&&(i=e[n].x-t[0])*i+(r=e[n].y-t[1])*r<(i=e[n].size||1)*i)return e[n];return null}),Zs={arc:XIe,area:tRe,group:pRe,image:yRe,line:vRe,path:DRe,rect:SRe,rule:ORe,shape:NRe,symbol:kRe,text:VRe,trail:HRe};function tF(e,t,n){var i=Zs[e.mark.marktype];return i.nested&&(e=e.mark),(t||i.bound)(e.bounds||(e.bounds=new fi),e,n)}var BX={mark:null};function $X(e,t,n){var a,l,u,c,i=Zs[e.marktype],r=i.bound,s=e.items,o=s&&s.length;if(i.nested)return o?u=s[0]:(BX.mark=e,u=BX),c=tF(u,r,n),t&&t.union(c)||c;if(t=t||e.bounds&&e.bounds.clear()||new fi,o)for(a=0,l=s.length;a<l;++a)t.union(tF(s[a],r,n));return e.bounds=t}const URe=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function VX(e,t){return JSON.stringify(e,URe,t)}function HX(e){return UX("string"==typeof e?JSON.parse(e):e)}function UX(e){var i,r,s,t=e.marktype,n=e.items;if(n)for(r=0,s=n.length;r<s;++r)n[r][i=t?"mark":"group"]=e,n[r].zindex&&(n[r][i].zdirty=!0),"group"===(t||i)&&UX(n[r]);return t&&$X(e),e}function nF(e){arguments.length?this.root=HX(e):(this.root=zX({marktype:"group",name:"root",role:"frame"}),this.root.items=[new vC(this.root)])}function zX(e,t){const n={bounds:new fi,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return null!=e.aria&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function bd(e,t,n){return!e&&"undefined"!=typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function iF(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function _s(e,t,n,i){var s,r=e.childNodes[t];return(!r||r.tagName.toLowerCase()!==n.toLowerCase())&&(s=r||null,r=bd(e.ownerDocument,n,i),e.insertBefore(r,s)),r}function Fa(e,t){for(var n=e.childNodes,i=n.length;i>t;)e.removeChild(n[--i]);return e}function qX(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function IC(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function wd(e,t){this._active=null,this._handlers={},this._loader=e||DD(),this._tooltip=t||qRe}function qRe(e,t,n,i){e.element().setAttribute("title",i||"")}function Ll(e){this._el=null,this._bgcolor=null,this._loader=new kR(e)}nF.prototype={toJSON(e){return VX(this.root,e||0)},mark(e,t,n){const i=zX(e,t=t||this.root.items[0]);return t.items[n]=i,i.zindex&&(i.group.zdirty=!0),i}},wd.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let i=e?e.length:0;--i>=0;)if(e[i].type===t&&(!n||e[i].handler===n))return i;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const i in t)n.push(...t[i]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(i=>{const r=new MouseEvent(e.type,e),s=bd(null,"a");for(const o in i)s.setAttribute(o,i[o]);s.dispatchEvent(r)}).catch(()=>{})},handleTooltip(e,t,n){t&&null!=t.tooltip&&(t=function zRe(e,t,n,i){var s,o,r=e&&e.mark;if(r&&(s=Zs[r.marktype]).tip){for((o=IC(t,n))[0]-=i[0],o[1]-=i[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=s.tip(r.items,o)}return e}(t,e,this.canvas(),this._origin),this._tooltip.call(this._obj,this,e,t,n&&t&&t.tooltip||null))},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),i=this._origin,r=e.bounds,s=r.width(),o=r.height();let a=r.x1+i[0]+n.left,l=r.y1+i[1]+n.top;for(;e.mark&&(e=e.mark.group);)a+=e.x||0,l+=e.y||0;return{x:a,y:l,width:s,height:o,left:a,top:l,right:a+s,bottom:l+o}}},Ll.prototype={initialize(e,t,n,i,r){return this._el=e,this.resize(t,n,i,r)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,i){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=i||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,i=n._loader[e](t);if(!n._ready){const r=n._call;n._ready=n._loader.ready().then(s=>{s&&r(),n._ready=null})}return i},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const GX="dragenter",RC="dragleave",WX="dragover",rF="mousedown",FC="mousemove",Gy="mouseout",YX="mouseover",PC="click",KX="mousewheel",LC="touchstart",jC="touchmove",BC="touchend",sF=FC,Wy=Gy,oF=PC;function Yy(e,t){wd.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}function JX(e,t){(e=>e===LC||e===jC||e===BC?[LC,jC,BC]:[e])(t).forEach(n=>function eFe(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?i=>e[t](i):i=>e.fire(t,i)))}(e,n))}function XX(e,t,n){return function(i){const r=this._active,s=this.pickEvent(i);s===r||((!r||!r.exit)&&this.fire(n,i),this._active=s,this.fire(t,i)),this.fire(e,i)}}function QX(e){return function(t){this.fire(e,t),this._active=null}}fe(Yy,wd,{initialize(e,t,n){return this._canvas=e&&iF(e,"canvas"),[PC,rF,FC,Gy,RC].forEach(i=>JX(this,i)),wd.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",GX,RC,WX,rF,"mouseup",FC,Gy,YX,PC,"dblclick","wheel",KX,LC,jC,BC],DOMMouseScroll(e){this.fire(KX,e)},mousemove:XX(FC,YX,Gy),dragover:XX(WX,GX,RC),mouseout:QX(Gy),dragleave:QX(RC),mousedown(e){this._down=this._active,this.fire(rF,e)},click(e){this._down===this._active&&(this.fire(PC,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(LC,e,!0)},touchmove(e){this.fire(jC,e,!0)},touchend(e){this.fire(BC,e,!0),this._touch=null},fire(e,t,n){const i=n?this._touch:this._active,r=this._handlers[e];if(t.vegaType=e,e===oF&&i&&i.href?this.handleHref(t,i,i.href):(e===sF||e===Wy)&&this.handleTooltip(t,i,e!==Wy),r)for(let s=0,o=r.length;s<o;++s)r[s].handler.call(this._obj,t,i)},on(e,t){const n=this.eventName(e),i=this._handlers;return this._handlerIndex(i[n],e,t)<0&&(JX(this,e),(i[n]||(i[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&i.splice(r,1),this},pickEvent(e){const t=IC(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,i,r){const s=this.context();return Zs[e.marktype].pick.call(this,s,e,t,n,i,r)}});var nFe=function tFe(){return"undefined"!=typeof window&&window.devicePixelRatio||1}();function $C(e){Ll.call(this,e),this._options={},this._redraw=!1,this._dirty=new fi,this._tempb=new fi}const ZX=Ll.prototype;function aF(e,t){wd.call(this,e,t);const n=this;n._hrefHandler=lF(n,(i,r)=>{r&&r.href&&n.handleHref(i,r,r.href)}),n._tooltipHandler=lF(n,(i,r)=>{n.handleTooltip(i,r,i.type!==Wy)})}fe($C,Ll,{initialize(e,t,n,i,r,s){return this._options=s||{},this._canvas=this._options.externalContext?null:ld(1,1),e&&this._canvas&&(Fa(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),ZX.initialize.call(this,e,t,n,i,r)},resize(e,t,n,i){if(ZX.resize.call(this,e,t,n,i),this._canvas)!function iFe(e,t,n,i,r,s){const o="undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,a=e.getContext("2d"),l=o?nFe:r;e.width=t*l,e.height=n*l;for(const u in s)a[u]=s[u];o&&1!==l&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=l,a.setTransform(l,0,0,l,l*i[0],l*i[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const r=this._options.externalContext;r||te("CanvasRenderer is missing a valid canvas or context"),r.scale(this._scale,this._scale),r.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,i=this._width,r=this._height,s=this._dirty,o=((e,t,n)=>(new fi).set(0,0,t,n).translate(-e[0],-e[1]))(n,i,r);t.save();const a=this._redraw||s.empty()?(this._redraw=!1,o.expand(1)):function sFe(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(t,o.intersect(s),n);return this.clear(-n[0],-n[1],i,r),this.draw(t,e,a),t.restore(),s.clear(),this},draw(e,t,n){const i=Zs[t.marktype];t.clip&&function nRe(e,t){var n=t.clip;e.save(),st(n)?(e.beginPath(),n(e),e.clip()):OX(e,t.group)}(e,t),i.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,i){const r=this._options,s=this.context();"pdf"!==r.type&&!r.externalContext&&s.clearRect(e,t,n,i),null!=this._bgcolor&&(s.fillStyle=this._bgcolor,s.fillRect(e,t,n,i))}});const lF=(e,t)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,t.call(e._obj,n,i)};fe(aF,wd,{initialize(e,t,n){let i=this._svg;return i&&(i.removeEventListener(oF,this._hrefHandler),i.removeEventListener(sF,this._tooltipHandler),i.removeEventListener(Wy,this._tooltipHandler)),this._svg=i=e&&iF(e,"svg"),i&&(i.addEventListener(oF,this._hrefHandler),i.addEventListener(sF,this._tooltipHandler),i.addEventListener(Wy,this._tooltipHandler)),wd.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),i=this._handlers;if(this._handlerIndex(i[n],e,t)<0){const s={type:e,handler:t,listener:lF(this,t)};(i[n]||(i[n]=[])).push(s),this._svg&&this._svg.addEventListener(n,s.listener)}return this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&(this._svg&&this._svg.removeEventListener(n,i[r].listener),i.splice(r,1)),this}});const eQ="aria-hidden",uF="aria-label",cF="role",dF="aria-roledescription",tQ="graphics-object",fF="graphics-symbol",nQ=(e,t,n)=>({[cF]:e,[dF]:t,[uF]:n||void 0}),oFe=Aa(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),iQ={axis:{desc:"axis",caption:function uFe(e){const t=e.datum,n=e.orient,i=t.title?lQ(e):null,r=e.context,s=r.scales[t.scale].value,o=r.dataflow.locale(),a=s.type;return"".concat("left"===n||"right"===n?"Y":"X","-axis")+(i?" titled '".concat(i,"'"):"")+" for a ".concat(Zg(a)?"discrete":a," scale")+" with ".concat(rX(o,s,e))}},legend:{desc:"legend",caption:function cFe(e){const t=e.datum,n=t.title?lQ(e):null,i="".concat(t.type||""," legend").trim(),r=t.scales,s=Object.keys(r),o=e.context,a=o.scales[r[s[0]]].value,l=o.dataflow.locale();return function fFe(e){return e.length?e[0].toUpperCase()+e.slice(1):e}(i)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function dFe(e){return e=e.map(t=>t+("fill"===t||"stroke"===t?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+bt(e)}(s))+" with ".concat(rX(l,a,e))}},"title-text":{desc:"title",caption:e=>"Title text '".concat(aQ(e),"'")},"title-subtitle":{desc:"subtitle",caption:e=>"Subtitle text '".concat(aQ(e),"'")}},rQ={ariaRole:cF,ariaRoleDescription:dF,description:uF};function sQ(e,t){const n=!1===t.aria;if(e(eQ,n||void 0),n||null==t.description)for(const i in rQ)e(rQ[i],void 0);else{const i=t.mark.marktype;e(uF,t.description),e(cF,t.ariaRole||("group"===i?tQ:fF)),e(dF,t.ariaRoleDescription||"".concat(i," mark"))}}function oQ(e){return!1===e.aria?{[eQ]:!0}:oFe[e.role]?null:iQ[e.role]?function lFe(e,t){try{const n=e.items[0],i=t.caption||(()=>"");return nQ(t.role||fF,t.desc,n.description||i(n))}catch(n){return null}}(e,iQ[e.role]):function aFe(e){const t=e.marktype,n="group"===t||"text"===t||e.items.some(i=>null!=i.description&&!1!==i.aria);return nQ(n?tQ:fF,"".concat(t," mark container"),e.description)}(e)}function aQ(e){return we(e.text).join(" ")}function lQ(e){try{return we(bt(e.items).items[0].text).join(" ")}catch(t){return null}}const uQ=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function hF(){let e="",t="",n="";const i=[],r=()=>t=n="",o=(l,u)=>(null!=u&&(t+=" ".concat(l,'="').concat((e=>uQ(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))(u),'"')),a),a={open(l){(l=>{t&&(e+="".concat(t,">").concat(n),r()),i.push(l)})(l),t="<"+l;for(var u=arguments.length,c=new Array(u>1?u-1:0),d=1;d<u;d++)c[d-1]=arguments[d];for(const f of c)for(const h in f)o(h,f[h]);return a},close(){const l=i.pop();return e+=t?t+(n?">".concat(n,"</").concat(l,">"):"/>"):"</".concat(l,">"),r(),a},attr:o,text:l=>(n+=uQ(l),a),toString:()=>e};return a}const cQ=e=>dQ(hF(),e)+"";function dQ(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,i=n.length;for(let r=0;r<i;++r)e.attr(n[r].name,n[r].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const i of n)3===i.nodeType?e.text(i.nodeValue):dQ(e,i)}return e.close()}const VC={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},HC={blend:"mix-blend-mode"},fQ={fill:"none","stroke-miterlimit":10},hQ="http://www.w3.org/2000/xmlns/",Si=Hy.xmlns;function pF(e){Ll.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const gF=Ll.prototype;function pQ(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function pFe(e,t,n){let i,r,s;if("radial"===t.gradient){let o=_s(e,n++,"pattern",Si);Dd(o,{id:"p_"+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o=_s(o,0,"rect",Si),Dd(o,{width:1,height:1,fill:"url(".concat(mQ(),"#").concat(t.id,")")}),Dd(e=_s(e,n++,"radialGradient",Si),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else Dd(e=_s(e,n++,"linearGradient",Si),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(i=0,r=t.stops.length;i<r;++i)s=_s(e,i,"stop",Si),s.setAttribute("offset",t.stops[i].offset),s.setAttribute("stop-color",t.stops[i].color);return Fa(e,i),n}function gFe(e,t,n){let i;return(e=_s(e,n,"clipPath",Si)).setAttribute("id",t.id),t.path?(i=_s(e,0,"path",Si),i.setAttribute("d",t.path)):(i=_s(e,0,"rect",Si),Dd(i,{x:0,y:0,width:t.width,height:t.height})),Fa(e,1),n+1}function gQ(e,t,n,i,r){let o,s=e._svg;if(!s&&(o=t.ownerDocument,s=bd(o,i,Si),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},"g"===i))){const a=bd(o,"path",Si);s.appendChild(a),a.__data__=e;const l=bd(o,"g",Si);s.appendChild(l),l.__data__=e;const u=bd(o,"path",Si);s.appendChild(u),u.__data__=e,u.__values__={fill:"default"}}return(s.ownerSVGElement!==r||function _Fe(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}fe(pF,Ll,{initialize(e,t,n,i,r){return this._defs={},this._clearDefs(),e&&(this._svg=_s(e,0,"svg",Si),this._svg.setAttributeNS(hQ,"xmlns",Si),this._svg.setAttributeNS(hQ,"xmlns:xlink",Hy["xmlns:xlink"]),this._svg.setAttribute("version",Hy.version),this._svg.setAttribute("class","marks"),Fa(e,1),this._root=_s(this._svg,0,"g",Si),Dd(this._root,fQ),Fa(this._svg,1)),this.background(this._bgcolor),gF.initialize.call(this,e,t,n,i,r)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),gF.background.apply(this,arguments)},resize(e,t,n,i){return gF.resize.call(this,e,t,n,i),this._svg&&(Dd(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=_s(e,0,"rect",Si),Dd(n,{width:this._width,height:this._height,fill:t}));const i=cQ(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),i},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),Fa(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,i,r,s,o,a,l;for(o=0,a=e.length;o<a;++o)if(n=e[o],i=n.mark,i.marktype!==r&&(r=i.marktype,s=Zs[r]),i.zdirty&&i.dirty!==t&&(this._dirtyAll=!1,pQ(n,t),i.items.forEach(u=>{u.dirty=t})),!i.zdirty){if(n.exit){s.nested&&i.items.length?(l=i.items[0],l._svg&&this._update(s,l._svg,l)):n._svg&&(l=n._svg.parentNode,l&&l.removeChild(n._svg)),n._svg=null;continue}n=s.nested?i.items[0]:n,n._update!==t&&(n._svg&&n._svg.ownerSVGElement?this._update(s,n._svg,n):(this._dirtyAll=!1,pQ(n,t)),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const i=this._svg,r=Zs[t.marktype],s=!1===t.interactive?"none":null,o="g"===r.tag,a=gQ(t,e,n,"g",i);a.setAttribute("class",qX(t));const l=oQ(t);for(const f in l)Ur(a,f,l[f]);o||Ur(a,"pointer-events",s),Ur(a,"clip-path",t.clip?NR(this,t,t.group):null);let u=null,c=0;const d=f=>{const h=this.isDirty(f),p=gQ(f,a,u,r.tag,i);h&&(this._update(r,p,f),o&&function mFe(e,t,n){t=t.lastChild.previousSibling;let i,r=0;Ia(n,s=>{i=e.mark(t,s,i),++r}),Fa(t,1+r)}(this,p,f)),u=p,++c};return r.nested?t.items.length&&d(t.items[0]):Ia(t,d),Fa(a,c),a},_update(e,t,n){Ju=t,Cr=t.__values__,sQ(Jy,n),e.attr(Jy,n,this);const i=yFe[e.type];i&&i.call(this,e,t,n),Ju&&this.style(Ju,n)},style(e,t){if(null!=t){for(const n in VC){let i="font"===n?zy(t):t[n];if(i===Cr[n])continue;const r=VC[n];null==i?e.removeAttribute(r):(SR(i)&&(i=oX(i,this._defs.gradient,mQ())),e.setAttribute(r,i+"")),Cr[n]=i}for(const n in HC)UC(e,HC[n],t[n])}},defs(){const e=this._svg,t=this._defs;let n=t.el,i=0;for(const r in t.gradient)n||(t.el=n=_s(e,1,"defs",Si)),i=pFe(n,t.gradient[r],i);for(const r in t.clipping)n||(t.el=n=_s(e,1,"defs",Si)),i=gFe(n,t.clipping[r],i);n&&(0===i?(e.removeChild(n),t.el=null):Fa(n,i))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});let Ju=null,Cr=null;const yFe={group(e,t,n){const i=Ju=t.childNodes[2];Cr=i.__values__,e.foreground(Jy,n,this),Cr=t.__values__,Ju=t.childNodes[1],e.content(Jy,n,this);const r=Ju=t.childNodes[0];e.background(Jy,n,this);const s=!1===n.mark.interactive?"none":null;if(s!==Cr.events&&(Ur(i,"pointer-events",s),Ur(r,"pointer-events",s),Cr.events=s),n.strokeForeground&&n.stroke){const o=n.fill;Ur(i,"display",null),this.style(r,n),Ur(r,"stroke",null),o&&(n.fill=null),Cr=i.__values__,this.style(i,n),o&&(n.fill=o),Ju=null}else Ur(i,"display","none")},image(e,t,n){!1===n.smooth?(UC(t,"image-rendering","optimizeSpeed"),UC(t,"image-rendering","pixelated")):UC(t,"image-rendering",null)},text(e,t,n){const i=Uy(n);let r,s,o,a;ie(i)?(s=i.map(l=>vd(n,l)),r=s.join("\n"),r!==Cr.text&&(Fa(t,0),o=t.ownerDocument,a=yd(n),s.forEach((l,u)=>{const c=bd(o,"tspan",Si);c.__data__=n,c.textContent=l,u&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),Cr.text=r)):(s=vd(n,i),s!==Cr.text&&(t.textContent=s,Cr.text=s)),Ur(t,"font-family",zy(n)),Ur(t,"font-size",Pl(n)+"px"),Ur(t,"font-style",n.fontStyle),Ur(t,"font-variant",n.fontVariant),Ur(t,"font-weight",n.fontWeight)}};function Jy(e,t,n){t!==Cr[e]&&(n?function vFe(e,t,n,i){null!=n?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}(Ju,e,t,n):Ur(Ju,e,t),Cr[e]=t)}function UC(e,t,n){n!==Cr[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),Cr[t]=n)}function Dd(e,t){for(const n in t)Ur(e,n,t[n])}function Ur(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function mQ(){let e;return"undefined"==typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function mF(e){Ll.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}fe(mF,Ll,{svg(){return this._text},_render(e){const t=hF();t.open("svg",ot({},Hy,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",fQ,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=Zs[t.marktype],i=n.tag,r=[sQ,n.attr];e.open("g",{class:qX(t),"clip-path":t.clip?NR(this,t,t.group):null},oQ(t),{"pointer-events":"g"!==i&&!1===t.interactive?"none":null});const s=o=>{const a=this.href(o);if(a&&e.open("a",a),e.open(i,this.attr(t,o,r,"g"!==i?i:null)),"text"===i){const l=Uy(o);if(ie(l)){const u={x:0,dy:yd(o)};for(let c=0;c<l.length;++c)e.open("tspan",c?u:null).text(vd(o,l[c])).close()}else e.text(vd(o,l))}else if("g"===i){const l=o.strokeForeground,u=o.fill,c=o.stroke;l&&c&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),Ia(o,d=>this.mark(e,d)),e.close(),l&&c?(u&&(o.fill=null),o.stroke=c,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),u&&(o.fill=u)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),a&&e.close()};return n.nested?t.items&&t.items.length&&s(t.items[0]):Ia(t,s),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(i=>{i["xlink:href"]=i.href,i.href=null,(this._hrefs||(this._hrefs={}))[t]=i})}return null},attr(e,t,n,i){const r={},s=(o,a,l,u)=>{r[u||o]=a};return Array.isArray(n)?n.forEach(o=>o(s,t,this)):n(s,t,this),i&&function bFe(e,t,n,i,r){let s;if(null==t||("bgrect"===i&&!1===n.interactive&&(e["pointer-events"]="none"),"bgfore"===i&&(!1===n.interactive&&(e["pointer-events"]="none"),e.display="none",null!==t.fill)))return e;"image"===i&&!1===t.smooth&&(s=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),"text"===i&&(e["font-family"]=zy(t),e["font-size"]=Pl(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const o in VC){let a=t[o];const l=VC[o];"transparent"===a&&("fill"===l||"stroke"===l)||null!=a&&(SR(a)&&(a=oX(a,r.gradient,"")),e[l]=a)}for(const o in HC){const a=t[o];null!=a&&(s=s||[],s.push("".concat(HC[o],": ").concat(a,";")))}s&&(e.style=s.join(" "))}(r,t,e,i,this._defs),r},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const r in t){const s=t[r],o=s.stops;"radial"===s.gradient?(e.open("pattern",{id:"p_"+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),e.close(),e.open("radialGradient",{id:r,fx:s.x1,fy:s.y1,fr:s.r1,cx:s.x2,cy:s.y2,r:s.r2})):e.open("linearGradient",{id:r,x1:s.x1,x2:s.x2,y1:s.y1,y2:s.y2});for(let a=0;a<o.length;++a)e.open("stop",{offset:o[a].offset,"stop-color":o[a].color}).close();e.close()}for(const r in n){const s=n[r];e.open("clipPath",{id:r}),s.path?e.open("path",{d:s.path}).close():e.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),e.close()}e.close()}}});const Cd={Canvas:"canvas",PNG:"png",SVG:"svg",None:"none"},om={};function zC(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(om[e]=t,this):om[e]}function wQ(e,t,n){const i=[],r=(new fi).union(t),s=e.marktype;return s?DQ(e,r,n,i):"group"===s?CQ(e,r,n,i):te("Intersect scene must be mark node or group item.")}function DQ(e,t,n,i){if(function wFe(e,t,n){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!n||n(e)))}(e,t,n)){const r=e.items,s=e.marktype,o=r.length;let a=0;if("group"===s)for(;a<o;++a)CQ(r[a],t,n,i);else for(const l=Zs[s].isect;a<o;++a){const u=r[a];EQ(u,t,l)&&i.push(u)}}return i}function CQ(e,t,n,i){n&&n(e.mark)&&EQ(e,t,Zs.group.isect)&&i.push(e);const r=e.items,s=r&&r.length;if(s){const o=e.x||0,a=e.y||0;t.translate(-o,-a);for(let l=0;l<s;++l)DQ(r[l],t,n,i);t.translate(o,a)}return i}function EQ(e,t,n){const i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}om.canvas=om.png={renderer:$C,headless:$C,handler:Yy},om.svg={renderer:pF,headless:mF,handler:aF},om.none={};const _F=new fi;function SQ(e){const t=e.clip;if(st(t))t(By(_F.clear()));else{if(!t)return;_F.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(_F)}function yF(e,t,n){return e===t||("path"===n?xQ(e,t):e instanceof Date&&t instanceof Date?+e==+t:nn(e)&&nn(t)?Math.abs(e-t)<=1e-9:e&&t&&(Se(e)||Se(t))?function CFe(e,t){var r,s,n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(n.sort(),i.sort(),s=n.length-1;s>=0;s--)if(n[s]!=i[s])return!1;for(s=n.length-1;s>=0;s--)if(!yF(e[r=n[s]],t[r],r))return!1;return typeof e==typeof t}(e,t):e==t)}function xQ(e,t){return yF(em(e),em(t))}function EFe(){_X(),function Kke(){sX=0}()}const am="top",Pa="left",La="right",Ed="bottom",vF="start",bF="middle",zr="end",qC="group",wF="axis",DF="title",CF="legend",AQ="row-header",MQ="row-footer",TQ="row-title",OQ="column-header",NQ="column-footer",kQ="column-title",EF="none",GC="all",SF="each",xF="flush",Sd="column",xd="row";function RQ(e){Q.call(this,null,e)}function WC(e,t,n){return t(e.bounds.clear(),e,n)}fe(RQ,Q,{transform(e,t){const n=t.dataflow,i=e.mark,r=i.marktype,s=Zs[r],o=s.bound;let l,a=i.bounds;if(s.nested)i.items.length&&n.dirty(i.items[0]),a=WC(i,o),i.items.forEach(u=>{u.bounds.clear().union(a)});else if(r===qC||e.modified())switch(t.visit(t.MOD,u=>n.dirty(u)),a.clear(),i.items.forEach(u=>a.union(WC(u,o))),i.role){case wF:case CF:case DF:t.reflow()}else l=t.changed(t.REM),t.visit(t.ADD,u=>{a.union(WC(u,o))}),t.visit(t.MOD,u=>{l=l||a.alignsWith(u.bounds),n.dirty(u),a.union(WC(u,o))}),l&&(a.clear(),i.items.forEach(u=>a.union(u.bounds)));return SQ(i),t.modifies("bounds")}});const FQ=":vega_identifier:";function AF(e){Q.call(this,0,e)}function PQ(e){Q.call(this,null,e)}function LQ(e){Q.call(this,null,e)}AF.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},fe(AF,Q,{transform(e,t){const n=function jFe(e){return e._signals[FQ]||(e._signals[FQ]=e.add(0))}(t.dataflow),i=e.as;let r=n.value;return t.visit(t.ADD,s=>s[i]=s[i]||++r),n.set(this.value=r),t}}),fe(PQ,Q,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,function BFe(e){const t=e.groups,n=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const i=n.marktype===qC?vC:yC;return t.visit(t.ADD,r=>i.call(r,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});const jQ={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((i,r)=>r&&BQ(n.bounds,i.bounds,t)?i.opacity=0:(n=i,1))}},BQ=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),$Q=(e,t)=>{for(var s,n=1,i=e.length,r=e[0].bounds;n<i;r=s,++n)if(BQ(r,s=e[n].bounds,t))return!0},$Fe=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},VQ=e=>(e.forEach(t=>t.opacity=1),e),HQ=(e,t)=>e.reflow(t.modified()).modifies("opacity");function UQ(e){Q.call(this,null,e)}fe(LQ,Q,{transform(e,t){const n=jQ[e.method]||jQ.parity,i=e.separation||0;let s,o,r=t.materialize(t.SOURCE).source;if(!r||!r.length)return;if(!e.method)return e.modified("method")&&(VQ(r),t=HQ(t,e)),t;if(r=r.filter($Fe),!r.length)return;if(e.sort&&(r=r.slice().sort(e.sort)),s=VQ(r),t=HQ(t,e),s.length>=3&&$Q(s,i)){do{s=n(s,i)}while(s.length>=3&&$Q(s,i));s.length<3&&!bt(r).opacity&&(s.length>1&&(bt(s).opacity=0),bt(r).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(o=((e,t,n)=>{var i=e.range(),r=new fi;return t===am||t===Ed?r.set(i[0],-1/0,i[1],1/0):r.set(-1/0,i[0],1/0,i[1]),r.expand(n||1),s=>r.encloses(s.bounds)})(e.boundScale,e.boundOrient,+e.boundTolerance),r.forEach(l=>{o(l)||(l.opacity=0)}));const a=s[0].mark.bounds.clear();return r.forEach(l=>{l.opacity&&a.union(l.bounds)}),t}}),fe(UQ,Q,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,i=>n.dirty(i)),t.fields&&t.fields.zindex){const i=t.source&&t.source[0];i&&(i.mark.zdirty=!0)}}});const Er=new fi;function lm(e,t,n){return e[t]===n?0:(e[t]=n,1)}function HFe(e){var t=e.items[0].orient;return t===Pa||t===La}function zFe(e,t,n,i){var b,D,r=t.items[0],s=r.datum,o=null!=r.translate?r.translate:.5,a=r.orient,l=function UFe(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}(s),u=r.range,c=r.offset,d=r.position,f=r.minExtent,h=r.maxExtent,p=s.title&&r.items[l[2]].items[0],g=r.titlePadding,m=r.bounds,_=p&&QR(p),y=0,v=0;switch(Er.clear().union(m),m.clear(),(b=l[0])>-1&&m.union(r.items[b].bounds),(b=l[1])>-1&&m.union(r.items[b].bounds),a){case am:y=d||0,v=-c,D=Math.max(f,Math.min(h,-m.y1)),m.add(0,-D).add(u,0),p&&YC(e,p,D,g,_,0,-1,m);break;case Pa:y=-c,v=d||0,D=Math.max(f,Math.min(h,-m.x1)),m.add(-D,0).add(0,u),p&&YC(e,p,D,g,_,1,-1,m);break;case La:y=n+c,v=d||0,D=Math.max(f,Math.min(h,m.x2)),m.add(0,0).add(D,u),p&&YC(e,p,D,g,_,1,1,m);break;case Ed:y=d||0,v=i+c,D=Math.max(f,Math.min(h,m.y2)),m.add(0,0).add(u,D),p&&YC(e,p,D,g,0,0,1,m);break;default:y=r.x,v=r.y}return Ku(m.translate(y,v),r),lm(r,"x",y+o)|lm(r,"y",v+o)&&(r.bounds=Er,e.dirty(r),r.bounds=m,e.dirty(r)),r.mark.bounds.clear().union(m)}function YC(e,t,n,i,r,s,o,a){const l=t.bounds;if(t.auto){const u=o*(n+r+i);let c=0,d=0;e.dirty(t),s?c=(t.x||0)-(t.x=u):d=(t.y||0)-(t.y=u),t.mark.bounds.clear().union(l.translate(-c,-d)),e.dirty(t)}a.union(l)}const zQ=(e,t)=>Math.floor(Math.min(e,t)),qQ=(e,t)=>Math.ceil(Math.max(e,t));function GFe(e){return(new fi).set(0,0,e.width||0,e.height||0)}function WFe(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function kn(e,t,n){const i=Se(e)?e[t]:e;return null!=i?i:void 0!==n?n:0}function GQ(e){return e<0?Math.ceil(-e):0}function WQ(e,t,n){var C,w,E,N,k,I,L,B,T,A,x,i=!n.nodirty,r=n.bounds===xF?GFe:WFe,s=Er.set(0,0,0,0),o=kn(n.align,Sd),a=kn(n.align,xd),l=kn(n.padding,Sd),u=kn(n.padding,xd),c=n.columns||t.length,d=c<=0?1:Math.ceil(t.length/c),f=t.length,h=Array(f),p=Array(c),g=0,m=Array(f),_=Array(d),y=0,v=Array(f),b=Array(f),D=Array(f);for(w=0;w<c;++w)p[w]=0;for(w=0;w<d;++w)_[w]=0;for(w=0;w<f;++w)k=D[w]=r(I=t[w]),I.x=I.x||0,v[w]=0,I.y=I.y||0,b[w]=0,E=w%c,N=~~(w/c),g=Math.max(g,L=Math.ceil(k.x2)),y=Math.max(y,B=Math.ceil(k.y2)),p[E]=Math.max(p[E],L),_[N]=Math.max(_[N],B),h[w]=l+GQ(k.x1),m[w]=u+GQ(k.y1),i&&e.dirty(t[w]);for(w=0;w<f;++w)w%c==0&&(h[w]=0),w<c&&(m[w]=0);if(o===SF)for(E=1;E<c;++E){for(x=0,w=E;w<f;w+=c)x<h[w]&&(x=h[w]);for(w=E;w<f;w+=c)h[w]=x+p[E-1]}else if(o===GC){for(x=0,w=0;w<f;++w)w%c&&x<h[w]&&(x=h[w]);for(w=0;w<f;++w)w%c&&(h[w]=x+g)}else for(o=!1,E=1;E<c;++E)for(w=E;w<f;w+=c)h[w]+=p[E-1];if(a===SF)for(N=1;N<d;++N){for(x=0,C=(w=N*c)+c;w<C;++w)x<m[w]&&(x=m[w]);for(w=N*c;w<C;++w)m[w]=x+_[N-1]}else if(a===GC){for(x=0,w=c;w<f;++w)x<m[w]&&(x=m[w]);for(w=c;w<f;++w)m[w]=x+y}else for(a=!1,N=1;N<d;++N)for(C=(w=N*c)+c;w<C;++w)m[w]+=_[N-1];for(T=0,w=0;w<f;++w)v[w]+=(T=h[w]+(w%c?T:0))-t[w].x;for(E=0;E<c;++E)for(A=0,w=E;w<f;w+=c)b[w]+=(A+=m[w])-t[w].y;if(o&&kn(n.center,Sd)&&d>1)for(w=0;w<f;++w)(T=(k=o===GC?g:p[w%c])-D[w].x2-t[w].x-v[w])>0&&(v[w]+=T/2);if(a&&kn(n.center,xd)&&1!==c)for(w=0;w<f;++w)(A=(k=a===GC?y:_[~~(w/c)])-D[w].y2-t[w].y-b[w])>0&&(b[w]+=A/2);for(w=0;w<f;++w)s.union(D[w].translate(v[w],b[w]));switch(T=kn(n.anchor,"x"),A=kn(n.anchor,"y"),kn(n.anchor,Sd)){case zr:T-=s.width();break;case bF:T-=s.width()/2}switch(kn(n.anchor,xd)){case zr:A-=s.height();break;case bF:A-=s.height()/2}for(T=Math.round(T),A=Math.round(A),s.clear(),w=0;w<f;++w)t[w].mark.bounds.clear();for(w=0;w<f;++w)(I=t[w]).x+=v[w]+=T,I.y+=b[w]+=A,s.union(I.mark.bounds.union(I.bounds.translate(v[w],b[w]))),i&&e.dirty(I);return s}function KFe(e,t){return"x1"===t?e.x||0:"y1"===t?e.y||0:"x2"===t?(e.x||0)+(e.width||0):"y2"===t?(e.y||0)+(e.height||0):void 0}function JFe(e,t){return e.bounds[t]}function KC(e,t,n,i,r,s,o,a,l,u,c,d,f,h){var _,y,v,b,D,C,w,E,N,p=n.length,g=0,m=0;if(!p)return g;for(_=c;_<p;_+=d)n[_]&&(g=o(g,l(n[_],u)));if(!t.length)return g;for(t.length>r&&(e.warn("Grid headers exceed limit: "+r),t=t.slice(0,r)),g+=s,y=0,b=t.length;y<b;++y)e.dirty(t[y]),t[y].mark.bounds.clear();for(_=c,y=0,b=t.length;y<b;++y,_+=d){for(D=(C=t[y]).mark.bounds,v=_;v>=0&&null==(w=n[v]);v-=f);a?(E=null==h?w.x:Math.round(w.bounds.x1+h*w.bounds.width()),N=g):(E=g,N=null==h?w.y:Math.round(w.bounds.y1+h*w.bounds.height())),D.union(C.bounds.translate(E-(C.x||0),N-(C.y||0))),C.x=E,C.y=N,e.dirty(C),m=o(m,D[u])}return m}function YQ(e,t,n,i,r,s){if(t){e.dirty(t);var o=n,a=n;i?o=Math.round(r.x1+s*r.width()):a=Math.round(r.y1+s*r.height()),t.bounds.translate(o-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=a,e.dirty(t)}}function ZFe(e,t,n,i,r,s,o){const a=function XFe(e,t){const n=e[t]||{};return(i,r)=>null!=n[i]?n[i]:null!=e[i]?e[i]:r}(n,t),l=function QFe(e,t){let n=-1/0;return e.forEach(i=>{null!=i.offset&&(n=Math.max(n,i.offset))}),n>-1/0?n:t}(e,a("offset",0)),u=a("anchor",vF),c=u===zr?1:u===bF?.5:0,d={align:SF,bounds:a("bounds",xF),columns:"vertical"===a("direction")?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case Pa:d.anchor={x:Math.floor(i.x1)-l,column:zr,y:c*(o||i.height()+2*i.y1),row:u};break;case La:d.anchor={x:Math.ceil(i.x2)+l,y:c*(o||i.height()+2*i.y1),row:u};break;case am:d.anchor={y:Math.floor(r.y1)-l,row:zr,x:c*(s||r.width()+2*r.x1),column:u};break;case Ed:d.anchor={y:Math.ceil(r.y2)+l,x:c*(s||r.width()+2*r.x1),column:u};break;case"top-left":d.anchor={x:l,y:l};break;case"top-right":d.anchor={x:s-l,y:l,column:zr};break;case"bottom-left":d.anchor={x:l,y:o-l,row:zr};break;case"bottom-right":d.anchor={x:s-l,y:o-l,column:zr,row:zr}}return d}function ePe(e,t){var l,u,n=t.items[0],i=n.datum,r=n.orient,s=n.bounds,o=n.x,a=n.y;return n._bounds?n._bounds.clear().union(s):n._bounds=s.clone(),s.clear(),function nPe(e,t,n){var i=t.padding,r=i-n.x,s=i-n.y;if(t.datum.title){var o=t.items[1].items[0],a=o.anchor,l=t.titlePadding||0,u=i-o.x,c=i-o.y;switch(o.orient){case Pa:r+=Math.ceil(o.bounds.width())+l;break;case La:case Ed:break;default:s+=o.bounds.height()+l}switch((r||s)&&Xy(e,n,r,s),o.orient){case Pa:c+=um(t,n,o,a,1,1);break;case La:u+=um(t,n,o,zr,0,0)+l,c+=um(t,n,o,a,1,1);break;case Ed:u+=um(t,n,o,a,0,0),c+=um(t,n,o,zr,-1,0,1)+l;break;default:u+=um(t,n,o,a,0,0)}(u||c)&&Xy(e,o,u,c),(u=Math.round(o.bounds.x1-i))<0&&(Xy(e,n,-u,0),Xy(e,o,-u,0))}else(r||s)&&Xy(e,n,r,s)}(e,n,n.items[0].items[0]),s=function tPe(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}(n,s),l=2*n.padding,u=2*n.padding,s.empty()||(l=Math.ceil(s.width()+l),u=Math.ceil(s.height()+u)),"symbol"===i.type&&function iPe(e){const t=e.reduce((n,i)=>(n[i.column]=Math.max(i.bounds.x2-i.x,n[i.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}(n.items[0].items[0].items[0].items),r!==EF&&(n.x=o=0,n.y=a=0),n.width=l,n.height=u,Ku(s.set(o,a,o+l,a+u),n),n.mark.bounds.clear().union(s),n}function um(e,t,n,i,r,s,o){const l=n.datum.vgrad,c=("symbol"===e.datum.type||!s&&l||o?t:t.items[0]).bounds[r?"y2":"x2"]-e.padding,d=l&&s?c:0,f=l&&s?0:c,h=r<=0?0:QR(n);return Math.round(i===vF?d:i===zr?f-h:.5*(c-h))}function Xy(e,t,n,i){t.x+=n,t.y+=i,t.bounds.translate(n,i),t.mark.bounds.translate(n,i),e.dirty(t)}function KQ(e){Q.call(this,null,e)}function JQ(e,t){let n=0;if(void 0===t)for(let i of e)(i=+i)&&(n+=i);else{let i=-1;for(let r of e)(r=+t(r,++i,e))&&(n+=r)}return n}function XQ(e){Q.call(this,null,e)}function QQ(e){Q.call(this,null,e)}function lPe(){return Ut({})}function ZQ(e){Q.call(this,null,e)}function eZ(e){Q.call(this,[],e)}fe(KQ,Q,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(i=>{e.layout&&function YFe(e,t,n){var c,d,f,h,p,g,m,i=function qFe(e){var r,s,t=e.items,n=t.length,i=0;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;i<n;++i)if(s=(r=t[i]).items,r.marktype===qC)switch(r.role){case wF:case CF:case DF:break;case AQ:o.rowheaders.push(...s);break;case MQ:o.rowfooters.push(...s);break;case OQ:o.colheaders.push(...s);break;case NQ:o.colfooters.push(...s);break;case TQ:o.rowtitle=s[0];break;case kQ:o.coltitle=s[0];break;default:o.marks.push(...s)}return o}(t),r=i.marks,s=n.bounds===xF?KFe:JFe,o=n.offset,a=n.columns||r.length,l=a<=0?1:Math.ceil(r.length/a),u=l*a;const _=WQ(e,r,n);_.empty()&&_.set(0,0,0,0),i.rowheaders&&(g=kn(n.headerBand,xd,null),c=KC(e,i.rowheaders,r,0,l,-kn(o,"rowHeader"),zQ,0,s,"x1",0,a,1,g)),i.colheaders&&(g=kn(n.headerBand,Sd,null),d=KC(e,i.colheaders,r,0,a,-kn(o,"columnHeader"),zQ,1,s,"y1",0,1,a,g)),i.rowfooters&&(g=kn(n.footerBand,xd,null),f=KC(e,i.rowfooters,r,0,l,kn(o,"rowFooter"),qQ,0,s,"x2",a-1,a,1,g)),i.colfooters&&(g=kn(n.footerBand,Sd,null),h=KC(e,i.colfooters,r,0,a,kn(o,"columnFooter"),qQ,1,s,"y2",u-a,1,a,g)),i.rowtitle&&(p=kn(n.titleAnchor,xd),m=kn(o,"rowTitle"),m=p===zr?f+m:c-m,g=kn(n.titleBand,xd,.5),YQ(e,i.rowtitle,m,0,_,g)),i.coltitle&&(p=kn(n.titleAnchor,Sd),m=kn(o,"columnTitle"),m=p===zr?h+m:d-m,g=kn(n.titleBand,Sd,.5),YQ(e,i.coltitle,m,1,_,g))}(n,i,e.layout),function oPe(e,t,n){var c,d,f,p,g,i=t.items,r=Math.max(0,t.width||0),s=Math.max(0,t.height||0),o=(new fi).set(0,0,r,s),a=o.clone(),l=o.clone(),u=[];for(p=0,g=i.length;p<g;++p)switch(d=i[p],d.role){case wF:(HFe(d)?a:l).union(zFe(e,d,r,s));break;case DF:c=d;break;case CF:u.push(ePe(e,d));break;case"frame":case"scope":case AQ:case MQ:case TQ:case OQ:case NQ:case kQ:a.union(d.bounds),l.union(d.bounds);break;default:o.union(d.bounds)}if(u.length){const m={};u.forEach(_=>{(f=_.orient||La)!==EF&&(m[f]||(m[f]=[])).push(_)});for(const _ in m){const y=m[_];WQ(e,y,ZFe(y,_,n.legends,a,l,r,s))}u.forEach(_=>{const y=_.bounds;if(y.equals(_._bounds)||(_.bounds=_._bounds,e.dirty(_),_.bounds=y,e.dirty(_)),n.autosize&&"fit"===n.autosize.type)switch(_.orient){case Pa:case La:o.add(y.x1,0).add(y.x2,0);break;case am:case Ed:o.add(0,y.y1).add(0,y.y2)}else o.union(y)})}o.union(a).union(l),c&&o.union(function rPe(e,t,n,i,r){var v,s=t.items[0],a=s.orient,l=s.anchor,u=s.offset,c=s.padding,d=s.items[0].items[0],f=s.items[1]&&s.items[1].items[0],h=a===Pa||a===La?i:n,p=0,g=0,m=0,_=0,y=0;if(s.frame!==qC?a===Pa?(p=r.y2,h=r.y1):a===La?(p=r.y1,h=r.y2):(p=r.x1,h=r.x2):a===Pa&&(p=i,h=0),v=l===vF?p:l===zr?h:(p+h)/2,f&&f.text){switch(a){case am:case Ed:y=d.bounds.height()+c;break;case Pa:_=d.bounds.width()+c;break;case La:_=-d.bounds.width()-c}Er.clear().union(f.bounds),Er.translate(_-(f.x||0),y-(f.y||0)),lm(f,"x",_)|lm(f,"y",y)&&(e.dirty(f),f.bounds.clear().union(Er),f.mark.bounds.clear().union(Er),e.dirty(f)),Er.clear().union(f.bounds)}else Er.clear();switch(Er.union(d.bounds),a){case am:g=v,m=r.y1-Er.height()-u;break;case Pa:g=r.x1-Er.width()-u,m=v;break;case La:g=r.x2+Er.width()+u,m=v;break;case Ed:g=v,m=r.y2+u;break;default:g=s.x,m=s.y}return lm(s,"x",g)|lm(s,"y",m)&&(Er.translate(g,m),e.dirty(s),s.bounds.clear().union(Er),t.bounds.clear().union(Er),e.dirty(s)),s.bounds}(e,c,r,s,o)),t.clip&&o.set(0,0,t.width||0,t.height||0),function aPe(e,t,n,i){const r=i.autosize||{},s=r.type;if(e._autosize<1||!s)return;let o=e._width,a=e._height,l=Math.max(0,t.width||0),u=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),d=Math.max(0,Math.ceil(-n.y1));const f=Math.max(0,Math.ceil(n.x2-l)),h=Math.max(0,Math.ceil(n.y2-c));if("padding"===r.contains){const p=e.padding();o-=p.left+p.right,a-=p.top+p.bottom}s===EF?(u=0,d=0,l=o,c=a):"fit"===s?(l=Math.max(0,o-u-f),c=Math.max(0,a-d-h)):"fit-x"===s?(l=Math.max(0,o-u-f),a=c+d+h):"fit-y"===s?(o=l+u+f,c=Math.max(0,a-d-h)):"pad"===s&&(o=l+u+f,a=c+d+h),e._resizeView(o,a,l,c,[u,d],r.resize)}(e,t,o,n)}(n,i,e)}),function sPe(e){return e&&"legend-entry"!==e.mark.role}(e.mark.group)?t.reflow():t}}),fe(XQ,Q,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.scale,a=DR(s,null==e.count?e.values?e.values.length:10:e.count,e.minstep),l=e.format||XJ(n,s,a,e.formatSpecifier,e.formatType,!!e.values),u=e.values?JJ(s,e.values,a):CR(s,a);return r&&(i.rem=r),r=u.map((c,d)=>Ut({index:d/(u.length-1||1),value:c,label:l(c)})),e.extra&&r.length&&r.push(Ut({index:-1,extra:{value:r[0].value},label:""})),i.source=r,i.add=r,this.value=r,i}}),fe(QQ,Q,{transform(e,t){var n=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||lPe,s=e.key||je,o=this.value;return ie(i.encode)&&(i.encode=null),o&&(e.modified("key")||t.modified(s))&&te("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=function uPe(e){const t=Og().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}(s)),t.visit(t.ADD,a=>{const l=s(a);let u=o.get(l);u?u.exit?(o.empty--,i.add.push(u)):i.mod.push(u):(u=r(a),o.set(l,u),i.add.push(u)),u.datum=a,u.exit=!1}),t.visit(t.MOD,a=>{const l=s(a),u=o.get(l);u&&(u.datum=a,i.mod.push(u))}),t.visit(t.REM,a=>{const l=s(a),u=o.get(l);a===u.datum&&!u.exit&&(i.rem.push(u),u.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&i.modifies("datum"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),i}}),fe(ZQ,Q,{transform(e,t){var n=t.fork(t.ADD_REM),i=e.mod||!1,r=e.encoders,s=t.encode;if(ie(s)){if(!n.changed()&&!s.every(d=>r[d]))return t.StopPropagation;s=s[0],n.encode=null}var o="enter"===s,a=r.update||Gc,l=r.enter||Gc,u=r.exit||Gc,c=(s&&!o?r[s]:a)||Gc;if(t.changed(t.ADD)&&(t.visit(t.ADD,d=>{l(d,e),a(d,e)}),n.modifies(l.output),n.modifies(a.output),c!==Gc&&c!==a&&(t.visit(t.ADD,d=>{c(d,e)}),n.modifies(c.output))),t.changed(t.REM)&&u!==Gc&&(t.visit(t.REM,d=>{u(d,e)}),n.modifies(u.output)),o||c!==Gc){const d=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(d,f=>{const h=l(f,e)||i;(c(f,e)||h)&&n.mod.push(f)}),n.mod.length&&n.modifies(l.output)):t.visit(d,f=>{(c(f,e)||i)&&n.mod.push(f)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}}),fe(eZ,Q,{transform(e,t){if(null!=this.value&&!e.modified())return t.StopPropagation;var f,h,p,g,m,n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.type||pC,o=e.scale,a=+e.limit,l=DR(o,null==e.count?5:e.count,e.minstep),c=e.format||tX(n,o,l,s,e.formatSpecifier,e.formatType,!!e.values||s===pC),d=e.values||eX(o,l);return r&&(i.rem=r),s===pC?(a&&d.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),r=d.slice(0,a-1),m=!0):r=d,st(p=e.size)?(!e.values&&0===o(r[0])&&(r=r.slice(1)),g=r.reduce((_,y)=>Math.max(_,p(y,e)),0)):p=yr(g=p||8),r=r.map((_,y)=>Ut({index:y,label:c(_,y,r),value:_,offset:g,size:p(_,e)})),m&&(m=d[r.length],r.push(Ut({index:r.length,label:"\u2026".concat(d.length-r.length," entries"),value:m,offset:g,size:p(m,e)})))):"gradient"===s?(f=o.domain(),h=GJ(o,f[0],bt(f)),d.length<3&&!e.values&&f[0]!==bt(f)&&(d=[f[0],bt(f)]),r=d.map((_,y)=>Ut({index:y,label:c(_,y,d),value:_,perc:h(_)}))):(p=d.length-1,h=function Wke(e){const t=e.domain(),n=t.length-1;let i=+t[0],r=+bt(t),s=r-i;if(e.type===dC){const o=n?s/n:.1;i-=o,r+=o,s=r-i}return o=>(o-i)/s}(o),r=d.map((_,y)=>Ut({index:y,label:c(_,y,d),value:_,perc:y?h(_):0,perc2:y===p?1:h(d[y+1])}))),i.source=r,i.add=r,this.value=r,i}});const cPe=e=>e.source.x,dPe=e=>e.source.y,fPe=e=>e.target.x,hPe=e=>e.target.y;function MF(e){Q.call(this,{},e)}MF.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},fe(MF,Q,{transform(e,t){var n=e.sourceX||cPe,i=e.sourceY||dPe,r=e.targetX||fPe,s=e.targetY||hPe,o=e.as||"path",l=e.shape||"line",u=rZ.get(l+"-"+(e.orient||"vertical"))||rZ.get(l);return u||te("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[o]=u(n(c),i(c),r(c),s(c))}),t.reflow(e.modified()).modifies(o)}});const tZ=(e,t,n,i)=>"M"+e+","+t+"L"+n+","+i,nZ=(e,t,n,i)=>{var r=n-e,s=i-t,o=Math.sqrt(r*r+s*s)/2;return"M"+e+","+t+"A"+o+","+o+" "+180*Math.atan2(s,r)/Math.PI+" 0 1 "+n+","+i},iZ=(e,t,n,i)=>{const r=n-e,s=i-t,o=.2*(r+s),a=.2*(s-r);return"M"+e+","+t+"C"+(e+o)+","+(t+a)+" "+(n+a)+","+(i-o)+" "+n+","+i},rZ=Og({line:tZ,"line-radial":(e,t,n,i)=>tZ(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),arc:nZ,"arc-radial":(e,t,n,i)=>nZ(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),curve:iZ,"curve-radial":(e,t,n,i)=>iZ(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),"orthogonal-horizontal":(e,t,n,i)=>"M"+e+","+t+"V"+i+"H"+n,"orthogonal-vertical":(e,t,n,i)=>"M"+e+","+t+"H"+n+"V"+i,"orthogonal-radial":(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n);return"M"+t*r+","+t*s+"A"+t+","+t+" 0 0,"+((Math.abs(n-e)>Math.PI?n<=e:n>e)?1:0)+" "+t*o+","+t*a+"L"+i*o+","+i*a},"diagonal-horizontal":(e,t,n,i)=>{const r=(e+n)/2;return"M"+e+","+t+"C"+r+","+t+" "+r+","+i+" "+n+","+i},"diagonal-vertical":(e,t,n,i)=>{const r=(t+i)/2;return"M"+e+","+t+"C"+e+","+r+" "+n+","+r+" "+n+","+i},"diagonal-radial":(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),l=(t+i)/2;return"M"+t*r+","+t*s+"C"+l*r+","+l*s+" "+l*o+","+l*a+" "+i*o+","+i*a}});function TF(e){Q.call(this,null,e)}function sZ(e){return yR(e)&&e!==Il}TF.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},fe(TF,Q,{transform(e,t){var p,g,m,n=e.as||["startAngle","endAngle"],i=n[0],r=n[1],o=e.startAngle||0,a=null!=e.endAngle?e.endAngle:2*Math.PI,l=t.source,u=l.map(e.field||Ag),c=u.length,d=o,f=(a-o)/JQ(u),h=Qs(c);for(e.sort&&h.sort((_,y)=>u[_]-u[y]),p=0;p<c;++p)m=u[h[p]],(g=l[h[p]])[i]=d,g[r]=d+=m*f;return this.value=u,t.reflow(e.modified()).modifies(n)}});const yPe=Aa(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function oZ(e){Q.call(this,null,e),this.modified(!0)}function aZ(e,t,n){return VJ(e)&&Math.abs(t.reduce((r,s)=>r+(s<0?-1:s>0?1:0),0))!==t.length&&n.warn("Log scale domain includes zero: "+pe(t)),t}function lZ(e,t,n){return st(e)&&(t||n)?zJ(e,OF(t||[0,1],n)):e}function OF(e,t){return t?e.slice().reverse():e}function uZ(e){Q.call(this,null,e)}fe(oZ,Q,{transform(e,t){var n=t.dataflow,i=this.value,r=function vPe(e){var i,t=e.type,n="";return t===Il?Il+"-"+Jg:(function bPe(e){const t=e.type;return yR(t)&&t!==ah&&t!==lh&&(e.scheme||e.range&&e.range.length&&e.range.every(be))}(e)&&(n=2===(i=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(null!=e.domainMid):0)?Il+"-":3===i?Xg+"-":""),(n+t||Jg).toLowerCase())}(e);for(r in(!i||r!==i.type)&&(this.value=i=Pt(r)()),e)if(!yPe[r]){if("padding"===r&&sZ(i.type))continue;st(i[r])?i[r](e[r]):n.warn("Unsupported scale property: "+r)}return function SPe(e,t,n){var i=e.type,r=t.round||!1,s=t.range;if(null!=t.rangeStep)s=function xPe(e,t,n){return"band"!==e&&e!==pR&&te("Only band and point scales support rangeStep."),[0,t.rangeStep*fR(n,e===pR?1:(null!=t.paddingInner?t.paddingInner:t.padding)||0,(null!=t.paddingOuter?t.paddingOuter:t.padding)||0)]}(i,t,n);else if(t.scheme&&st(s=function APe(e,t,n){var s,i=t.schemeExtent;return ie(t.scheme)?s=hC(t.scheme,t.interpolate,t.interpolateGamma):(s=wR(t.scheme.toLowerCase()))||te("Unrecognized scheme name: ".concat(t.scheme)),n=e===dC?n+1:e===gR?n-1:e===Qg||e===cC?+t.schemeCount||5:n,HJ(e)?lZ(s,i,t.reverse):st(s)?qJ(lZ(s,i),n):e===hR?s:s.slice(0,n)}(i,t,n))){if(e.interpolator)return e.interpolator(s);te("Scale type ".concat(i," does not support interpolating color schemes."))}if(s&&HJ(i))return e.interpolator(hC(OF(s,t.reverse),t.interpolate,t.interpolateGamma));s&&t.interpolate&&e.interpolate?e.interpolate(bR(t.interpolate,t.interpolateGamma)):st(e.round)?e.round(r):st(e.rangeRound)&&e.interpolate(r?Ay:dd),s&&e.range(OF(s,t.reverse))}(i,e,function EPe(e,t,n){let i=t.bins;if(i&&!ie(i)){const r=e.domain(),s=r[0],o=bt(r),a=i.step;let l=null==i.start?s:i.start,u=null==i.stop?o:i.stop;a||te("Scale bins parameter missing step property."),l<s&&(l=a*Math.ceil(s/a)),u>o&&(u=a*Math.floor(o/a)),i=Qs(l,u+a/2,a)}return i?e.bins=i:e.bins&&delete e.bins,e.type===gR&&(i?!t.domain&&!t.domainRaw&&(e.domain(i),n=i.length):e.bins=e.domain()),n}(i,e,function wPe(e,t,n){const i=function DPe(e,t,n){return t?(e.domain(aZ(e.type,t,n)),t.length):-1}(e,t.domainRaw,n);if(i>-1)return i;var a,l,r=t.domain,s=e.type,o=t.zero||void 0===t.zero&&function _Pe(e){const t=e.type;return!e.bins&&(t===Jg||t===Oy||t===Ny)}(e);if(!r)return 0;if(sZ(s)&&t.padding&&r[0]!==bt(r)&&(r=function CPe(e,t,n,i,r,s){var o=Math.abs(bt(n)-n[0]),a=o/(o-2*i),l=e===Wu?xN(t,null,a):e===Ny?aD(t,null,a,.5):e===Oy?aD(t,null,a,r||1):e===uC?AN(t,null,a,s||1):SN(t,null,a);return(t=t.slice())[0]=l[0],t[t.length-1]=l[1],t}(s,r,t.range,t.padding,t.exponent,t.constant)),(o||null!=t.domainMin||null!=t.domainMax||null!=t.domainMid)&&(a=(r=r.slice()).length-1||1,o&&(r[0]>0&&(r[0]=0),r[a]<0&&(r[a]=0)),null!=t.domainMin&&(r[0]=t.domainMin),null!=t.domainMax&&(r[a]=t.domainMax),null!=t.domainMid)){const u=(l=t.domainMid)>r[a]?a+1:l<r[0]?0:a;u!==a&&n.warn("Scale domainMid exceeds domain min or max.",l),r.splice(u,0,l)}return e.domain(aZ(s,r,n)),s===hR&&e.unknown(t.domainImplicit?nR:void 0),t.nice&&e.nice&&e.nice(!0!==t.nice&&DR(e,t.nice)||null),r.length}(i,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),fe(uZ,Q,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(Xf(e.sort)),this.modified(n),t}});const fZ="normalize",hZ=["y0","y1"];function NF(e){Q.call(this,null,e)}function MPe(e,t,n,i,r){for(var l,s=(t-e.sum)/2,o=e.length,a=0;a<o;++a)(l=e[a])[i]=s,l[r]=s+=Math.abs(n(l))}function TPe(e,t,n,i,r){for(var c,s=1/e.sum,o=0,a=e.length,l=0,u=0;l<a;++l)(c=e[l])[i]=o,c[r]=o=s*(u+=Math.abs(n(c)))}function OPe(e,t,n,i,r){for(var u,c,s=0,o=0,a=e.length,l=0;l<a;++l)(u=+n(c=e[l]))<0?(c[i]=o,c[r]=o+=u):(c[i]=s,c[r]=s+=u)}NF.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:"zero",values:["zero","center",fZ]},{name:"as",type:"string",array:!0,length:2,default:hZ}]},fe(NF,Q,{transform(e,t){var l,u,c,d,n=e.as||hZ,i=n[0],r=n[1],s=Xf(e.sort),o=e.field||Ag,a="center"===e.offset?MPe:e.offset===fZ?TPe:OPe;for(l=function NPe(e,t,n,i){var o,a,l,u,c,d,f,h,p,r=[],s=g=>g(c);if(null==t)r.push(e.slice());else for(o={},a=0,l=e.length;a<l;++a)c=e[a],(f=o[d=t.map(s)])||(o[d]=f=[],r.push(f)),f.push(c);for(d=0,p=0,u=r.length;d<u;++d){for(a=0,h=0,l=(f=r[d]).length;a<l;++a)h+=Math.abs(i(f[a]));f.sum=h,h>p&&(p=h),n&&f.sort(n)}return r.max=p,r}(t.source,e.groupby,s,o),u=0,c=l.length,d=l.max;u<c;++u)a(l[u],d,o,i,r);return t.reflow(e.modified()).modifies(n)}});const Qy=e=>e;function JC(e,t){e&&gZ.hasOwnProperty(e.type)&&gZ[e.type](e,t)}var pZ={Feature:function(e,t){JC(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)JC(n[i].geometry,t)}},gZ={Sphere:function(e,t){t.sphere()},Point:function(e,t){t.point((e=e.coordinates)[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)t.point((e=n[i])[0],e[1],e[2])},LineString:function(e,t){kF(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)kF(n[i],t,0)},Polygon:function(e,t){mZ(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)mZ(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)JC(n[i],t)}};function kF(e,t,n){var s,i=-1,r=e.length-n;for(t.lineStart();++i<r;)t.point((s=e[i])[0],s[1],s[2]);t.lineEnd()}function mZ(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)kF(e[n],t,1);t.polygonEnd()}function Xu(e,t){e&&pZ.hasOwnProperty(e.type)?pZ[e.type](e,t):JC(e,t)}class Qi{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const s=n[r],o=t+s,a=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);a&&(n[i++]=a),t=o}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let i,r,s,n=this._n,o=0;if(n>0){for(o=t[--n];n>0&&(i=o,r=t[--n],o=i+r,s=r-(o-i),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(r=2*s,i=o+r,r==i-o&&(o=i))}return o}}var $e=1e-6,XC=1e-12,ft=Math.PI,Wn=ft/2,QC=ft/4,qr=2*ft,ri=180/ft,ht=ft/180,St=Math.abs,cm=Math.atan,Uo=Math.atan2,Ue=Math.cos,ZC=Math.ceil,_Z=Math.exp,IF=(Math,Math.hypot),eE=Math.log,RF=Math.pow,Pe=Math.sin,zo=Math.sign||function(e){return e>0?1:e<0?-1:0},Gr=Math.sqrt,FF=Math.tan;function yZ(e){return e>1?0:e<-1?ft:Math.acos(e)}function ys(e){return e>1?Wn:e<-1?-Wn:Math.asin(e)}function Zi(){}var vZ,bZ,jF,BF,PF=new Qi,LF=new Qi,Ad={point:Zi,lineStart:Zi,lineEnd:Zi,polygonStart:function(){Ad.lineStart=kPe,Ad.lineEnd=RPe},polygonEnd:function(){Ad.lineStart=Ad.lineEnd=Ad.point=Zi,PF.add(St(LF)),LF=new Qi},result:function(){var e=PF/2;return PF=new Qi,e}};function kPe(){Ad.point=IPe}function IPe(e,t){Ad.point=wZ,vZ=jF=e,bZ=BF=t}function wZ(e,t){LF.add(BF*e-jF*t),jF=e,BF=t}function RPe(){wZ(vZ,bZ)}const DZ=Ad;var dm=1/0,tE=dm,Zy=-dm,nE=Zy,FPe={point:function PPe(e,t){e<dm&&(dm=e),e>Zy&&(Zy=e),t<tE&&(tE=t),t>nE&&(nE=t)},lineStart:Zi,lineEnd:Zi,polygonStart:Zi,polygonEnd:Zi,result:function(){var e=[[dm,tE],[Zy,nE]];return Zy=nE=-(tE=dm=1/0),e}};const iE=FPe;var CZ,EZ,jl,Bl,$F=0,VF=0,ev=0,rE=0,sE=0,fm=0,HF=0,UF=0,tv=0,ja={point:gh,lineStart:SZ,lineEnd:xZ,polygonStart:function(){ja.lineStart=BPe,ja.lineEnd=$Pe},polygonEnd:function(){ja.point=gh,ja.lineStart=SZ,ja.lineEnd=xZ},result:function(){var e=tv?[HF/tv,UF/tv]:fm?[rE/fm,sE/fm]:ev?[$F/ev,VF/ev]:[NaN,NaN];return $F=VF=ev=rE=sE=fm=HF=UF=tv=0,e}};function gh(e,t){$F+=e,VF+=t,++ev}function SZ(){ja.point=LPe}function LPe(e,t){ja.point=jPe,gh(jl=e,Bl=t)}function jPe(e,t){var n=e-jl,i=t-Bl,r=Gr(n*n+i*i);rE+=r*(jl+e)/2,sE+=r*(Bl+t)/2,fm+=r,gh(jl=e,Bl=t)}function xZ(){ja.point=gh}function BPe(){ja.point=VPe}function $Pe(){AZ(CZ,EZ)}function VPe(e,t){ja.point=AZ,gh(CZ=jl=e,EZ=Bl=t)}function AZ(e,t){var n=e-jl,i=t-Bl,r=Gr(n*n+i*i);rE+=r*(jl+e)/2,sE+=r*(Bl+t)/2,fm+=r,HF+=(r=Bl*e-jl*t)*(jl+e),UF+=r*(Bl+t),tv+=3*r,gh(jl=e,Bl=t)}const MZ=ja;function TZ(e){this._context=e}TZ.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,qr)}},result:Zi};var qF,OZ,NZ,nv,iv,zF=new Qi,oE={point:Zi,lineStart:function(){oE.point=HPe},lineEnd:function(){qF&&kZ(OZ,NZ),oE.point=Zi},polygonStart:function(){qF=!0},polygonEnd:function(){qF=null},result:function(){var e=+zF;return zF=new Qi,e}};function HPe(e,t){oE.point=kZ,OZ=nv=e,NZ=iv=t}function kZ(e,t){zF.add(Gr((nv-=e)*nv+(iv-=t)*iv)),nv=e,iv=t}const IZ=oE;function RZ(){this._string=[]}function FZ(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function PZ(e,t){var i,r,n=4.5;function s(o){return o&&("function"==typeof n&&r.pointRadius(+n.apply(this,arguments)),Xu(o,i(r))),r.result()}return s.area=function(o){return Xu(o,i(DZ)),DZ.result()},s.measure=function(o){return Xu(o,i(IZ)),IZ.result()},s.bounds=function(o){return Xu(o,i(iE)),iE.result()},s.centroid=function(o){return Xu(o,i(MZ)),MZ.result()},s.projection=function(o){return arguments.length?(i=null==o?(e=null,Qy):(e=o).stream,s):e},s.context=function(o){return arguments.length?(r=null==o?(t=null,new RZ):new TZ(t=o),"function"!=typeof n&&r.pointRadius(n),s):t},s.pointRadius=function(o){return arguments.length?(n="function"==typeof o?o:(r.pointRadius(+o),+o),s):n},s.projection(e).context(t)}function LZ(){var t,e=[];return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:Zi,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function aE(e,t){return St(e[0]-t[0])<$e&&St(e[1]-t[1])<$e}function lE(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function jZ(e,t,n,i,r){var a,l,s=[],o=[];if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,y,m=p[0],_=p[g];if(aE(m,_)){if(!m[2]&&!_[2]){for(r.lineStart(),a=0;a<g;++a)r.point((m=p[a])[0],m[1]);return void r.lineEnd()}_[0]+=2*$e}s.push(y=new lE(m,p,null,!0)),o.push(y.o=new lE(m,null,y,!1)),s.push(y=new lE(_,p,null,!1)),o.push(y.o=new lE(_,null,y,!0))}}),s.length){for(o.sort(t),BZ(s),BZ(o),a=0,l=o.length;a<l;++a)o[a].e=n=!n;for(var c,d,u=s[0];;){for(var f=u,h=!0;f.v;)if((f=f.n)===u)return;c=f.z,r.lineStart();do{if(f.v=f.o.v=!0,f.e){if(h)for(a=0,l=c.length;a<l;++a)r.point((d=c[a])[0],d[1]);else i(f.x,f.n.x,1,r);f=f.n}else{if(h)for(a=(c=f.p.z).length-1;a>=0;--a)r.point((d=c[a])[0],d[1]);else i(f.x,f.p.x,-1,r);f=f.p}c=(f=f.o).z,h=!h}while(!f.v);r.lineEnd()}}}function BZ(e){if(t=e.length){for(var t,r,n=0,i=e[0];++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function uE(e){return[Uo(e[1],e[0]),ys(e[2])]}function mh(e){var t=e[0],n=e[1],i=Ue(n);return[i*Ue(t),i*Pe(t),Pe(n)]}function cE(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function hm(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function GF(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function dE(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function fE(e){var t=Gr(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function WF(e){return St(e[0])<=ft?e[0]:zo(e[0])*((St(e[0])+ft)%qr-ft)}function $Z(e){return Array.from(function*zPe(e){for(const t of e)yield*t}(e))}function VZ(e,t,n,i){return function(r){var u,c,d,s=t(r),o=LZ(),a=t(o),l=!1,f={point:h,lineStart:g,lineEnd:m,polygonStart:function(){f.point=_,f.lineStart=y,f.lineEnd=v,c=[],u=[]},polygonEnd:function(){f.point=h,f.lineStart=g,f.lineEnd=m,c=$Z(c);var b=function UPe(e,t){var n=WF(t),i=t[1],r=Pe(i),s=[Pe(n),-Ue(n),0],o=0,a=0,l=new Qi;1===r?i=Wn+$e:-1===r&&(i=-Wn-$e);for(var u=0,c=e.length;u<c;++u)if(f=(d=e[u]).length)for(var d,f,h=d[f-1],p=WF(h),g=h[1]/2+QC,m=Pe(g),_=Ue(g),y=0;y<f;++y,p=b,m=C,_=w,h=v){var v=d[y],b=WF(v),D=v[1]/2+QC,C=Pe(D),w=Ue(D),E=b-p,N=E>=0?1:-1,k=N*E,I=k>ft,L=m*C;if(l.add(Uo(L*N*Pe(k),_*w+L*Ue(k))),o+=I?E+N*qr:E,I^p>=n^b>=n){var B=hm(mh(h),mh(v));fE(B);var T=hm(s,B);fE(T);var A=(I^E>=0?-1:1)*ys(T[2]);(i>A||i===A&&(B[0]||B[1]))&&(a+=I^E>=0?1:-1)}}return(o<-$e||o<$e&&l<-XC)^1&a}(u,i);c.length?(l||(r.polygonStart(),l=!0),jZ(c,GPe,b,n,r)):b&&(l||(r.polygonStart(),l=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),l&&(r.polygonEnd(),l=!1),c=u=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function h(b,D){e(b,D)&&r.point(b,D)}function p(b,D){s.point(b,D)}function g(){f.point=p,s.lineStart()}function m(){f.point=h,s.lineEnd()}function _(b,D){d.push([b,D]),a.point(b,D)}function y(){a.lineStart(),d=[]}function v(){_(d[0][0],d[0][1]),a.lineEnd();var C,E,N,k,b=a.clean(),D=o.result(),w=D.length;if(d.pop(),u.push(d),d=null,w){if(1&b){if((E=(N=D[0]).length-1)>0){for(l||(r.polygonStart(),l=!0),r.lineStart(),C=0;C<E;++C)r.point((k=N[C])[0],k[1]);r.lineEnd()}return}w>1&&2&b&&D.push(D.pop().concat(D.shift())),c.push(D.filter(qPe))}}return f}}function qPe(e){return e.length>1}function GPe(e,t){return((e=e.x)[0]<0?e[1]-Wn-$e:Wn-e[1])-((t=t.x)[0]<0?t[1]-Wn-$e:Wn-t[1])}RZ.prototype={_radius:4.5,_circle:FZ(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._string.push("M",e,",",t),this._point=1;break;case 1:this._string.push("L",e,",",t);break;default:null==this._circle&&(this._circle=FZ(this._radius)),this._string.push("M",e,",",t,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}};const HZ=VZ(function(){return!0},function WPe(e){var r,t=NaN,n=NaN,i=NaN;return{lineStart:function(){e.lineStart(),r=1},point:function(s,o){var a=s>0?ft:-ft,l=St(s-t);St(l-ft)<$e?(e.point(t,n=(n+o)/2>0?Wn:-Wn),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(s,n),r=0):i!==a&&l>=ft&&(St(t-i)<$e&&(t-=i*$e),St(s-a)<$e&&(s-=a*$e),n=function YPe(e,t,n,i){var r,s,o=Pe(e-n);return St(o)>$e?cm((Pe(t)*(s=Ue(i))*Pe(n)-Pe(i)*(r=Ue(t))*Pe(e))/(r*s*o)):(t+i)/2}(t,n,s,o),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),r=0),e.point(t=s,n=o),i=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}},function KPe(e,t,n,i){var r;if(null==e)i.point(-ft,r=n*Wn),i.point(0,r),i.point(ft,r),i.point(ft,0),i.point(ft,-r),i.point(0,-r),i.point(-ft,-r),i.point(-ft,0),i.point(-ft,r);else if(St(e[0]-t[0])>$e){var s=e[0]<t[0]?ft:-ft;i.point(-s,r=n*s/2),i.point(0,r),i.point(s,r)}else i.point(t[0],t[1])},[-ft,-Wn]);function zZ(e,t){(t=mh(t))[0]-=e,fE(t);var n=yZ(-t[1]);return((-t[2]<0?-n:n)+qr-$e)%qr}function JPe(e){var t=Ue(e),n=6*ht,i=t>0,r=St(t)>$e;function o(c,d){return Ue(c)*Ue(d)>t}function l(c,d,f){var g=[1,0,0],m=hm(mh(c),mh(d)),_=cE(m,m),y=m[0],v=_-y*y;if(!v)return!f&&c;var b=t*_/v,D=-t*y/v,C=hm(g,m),w=dE(g,b);GF(w,dE(m,D));var N=C,k=cE(w,N),I=cE(N,N),L=k*k-I*(cE(w,w)-1);if(!(L<0)){var B=Gr(L),T=dE(N,(-k-B)/I);if(GF(T,w),T=uE(T),!f)return T;var j,A=c[0],x=d[0],F=c[1],O=d[1];x<A&&(j=A,A=x,x=j);var P=x-A,z=St(P-ft)<$e;if(!z&&O<F&&(j=F,F=O,O=j),z||P<$e?z?F+O>0^T[1]<(St(T[0]-A)<$e?F:O):F<=T[1]&&T[1]<=O:P>ft^(A<=T[0]&&T[0]<=x)){var G=dE(N,(-k+B)/I);return GF(G,w),[T,uE(G)]}}}function u(c,d){var f=i?e:ft-e,h=0;return c<-f?h|=1:c>f&&(h|=2),d<-f?h|=4:d>f&&(h|=8),h}return VZ(o,function a(c){var d,f,h,p,g;return{lineStart:function(){p=h=!1,g=1},point:function(m,_){var v,y=[m,_],b=o(m,_),D=i?b?0:u(m,_):b?u(m+(m<0?ft:-ft),_):0;if(!d&&(p=h=b)&&c.lineStart(),b!==h&&(!(v=l(d,y))||aE(d,v)||aE(y,v))&&(y[2]=1),b!==h)g=0,b?(c.lineStart(),v=l(y,d),c.point(v[0],v[1])):(v=l(d,y),c.point(v[0],v[1],2),c.lineEnd()),d=v;else if(r&&d&&i^b){var C;!(D&f)&&(C=l(y,d,!0))&&(g=0,i?(c.lineStart(),c.point(C[0][0],C[0][1]),c.point(C[1][0],C[1][1]),c.lineEnd()):(c.point(C[1][0],C[1][1]),c.lineEnd(),c.lineStart(),c.point(C[0][0],C[0][1],3)))}b&&(!d||!aE(d,y))&&c.point(y[0],y[1]),d=y,h=b,f=D},lineEnd:function(){h&&c.lineEnd(),d=null},clean:function(){return g|(p&&h)<<1}}},function s(c,d,f,h){!function UZ(e,t,n,i,r,s){if(n){var o=Ue(t),a=Pe(t),l=i*n;null==r?(r=t+i*qr,s=t-l/2):(r=zZ(o,r),s=zZ(o,s),(i>0?r<s:r>s)&&(r+=i*qr));for(var u,c=r;i>0?c>s:c<s;c-=l)u=uE([o,-a*Ue(c),-a*Pe(c)]),e.point(u[0],u[1])}}(h,e,n,f,c,d)},i?[0,-e]:[-ft,e-ft])}var rv=1e9,hE=-rv;function qZ(e,t,n,i){function r(u,c){return e<=u&&u<=n&&t<=c&&c<=i}function s(u,c,d,f){var h=0,p=0;if(null==u||(h=o(u,d))!==(p=o(c,d))||l(u,c)<0^d>0)do{f.point(0===h||3===h?e:n,h>1?i:t)}while((h=(h+d+4)%4)!==p);else f.point(c[0],c[1])}function o(u,c){return St(u[0]-e)<$e?c>0?0:3:St(u[0]-n)<$e?c>0?2:1:St(u[1]-t)<$e?c>0?1:0:c>0?3:2}function a(u,c){return l(u.x,c.x)}function l(u,c){var d=o(u,1),f=o(c,1);return d!==f?d-f:0===d?c[1]-u[1]:1===d?u[0]-c[0]:2===d?u[1]-c[1]:c[0]-u[0]}return function(u){var f,h,p,g,m,_,y,v,b,D,C,c=u,d=LZ(),w={point:E,lineStart:function L(){w.point=T,h&&h.push(p=[]),D=!0,b=!1,y=v=NaN},lineEnd:function B(){f&&(T(g,m),_&&b&&d.rejoin(),f.push(d.result())),w.point=E,b&&c.lineEnd()},polygonStart:function k(){c=d,f=[],h=[],C=!0},polygonEnd:function I(){var A=function N(){for(var A=0,x=0,F=h.length;x<F;++x)for(var q,G,O=h[x],j=1,P=O.length,z=O[0],V=z[0],K=z[1];j<P;++j)q=V,G=K,V=(z=O[j])[0],K=z[1],G<=i?K>i&&(V-q)*(i-G)>(K-G)*(e-q)&&++A:K<=i&&(V-q)*(i-G)<(K-G)*(e-q)&&--A;return A}(),x=C&&A,F=(f=$Z(f)).length;(x||F)&&(u.polygonStart(),x&&(u.lineStart(),s(null,null,1,u),u.lineEnd()),F&&jZ(f,a,A,s,u),u.polygonEnd()),c=u,f=h=p=null}};function E(A,x){r(A,x)&&c.point(A,x)}function T(A,x){var F=r(A,x);if(h&&p.push([A,x]),D)g=A,m=x,_=F,D=!1,F&&(c.lineStart(),c.point(A,x));else if(F&&b)c.point(A,x);else{var O=[y=Math.max(hE,Math.min(rv,y)),v=Math.max(hE,Math.min(rv,v))],j=[A=Math.max(hE,Math.min(rv,A)),x=Math.max(hE,Math.min(rv,x))];!function XPe(e,t,n,i,r,s){var p,o=e[0],a=e[1],c=0,d=1,f=t[0]-o,h=t[1]-a;if(p=n-o,f||!(p>0)){if(p/=f,f<0){if(p<c)return;p<d&&(d=p)}else if(f>0){if(p>d)return;p>c&&(c=p)}if(p=r-o,f||!(p<0)){if(p/=f,f<0){if(p>d)return;p>c&&(c=p)}else if(f>0){if(p<c)return;p<d&&(d=p)}if(p=i-a,h||!(p>0)){if(p/=h,h<0){if(p<c)return;p<d&&(d=p)}else if(h>0){if(p>d)return;p>c&&(c=p)}if(p=s-a,h||!(p<0)){if(p/=h,h<0){if(p>d)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<d&&(d=p)}return c>0&&(e[0]=o+c*f,e[1]=a+c*h),d<1&&(t[0]=o+d*f,t[1]=a+d*h),!0}}}}}(O,j,e,t,n,i)?F&&(c.lineStart(),c.point(A,x),C=!1):(b||(c.lineStart(),c.point(O[0],O[1])),c.point(j[0],j[1]),F||c.lineEnd(),C=!1)}y=A,v=x,b=F}return w}}function YF(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return(i=t.invert(i,r))&&e.invert(i[0],i[1])}),n}function KF(e,t){return[St(e)>ft?e+Math.round(-e/qr)*qr:e,t]}function GZ(e,t,n){return(e%=qr)?t||n?YF(YZ(e),KZ(t,n)):YZ(e):t||n?KZ(t,n):KF}function WZ(e){return function(t,n){return[(t+=e)>ft?t-qr:t<-ft?t+qr:t,n]}}function YZ(e){var t=WZ(e);return t.invert=WZ(-e),t}function KZ(e,t){var n=Ue(e),i=Pe(e),r=Ue(t),s=Pe(t);function o(a,l){var u=Ue(l),c=Ue(a)*u,d=Pe(a)*u,f=Pe(l),h=f*n+c*i;return[Uo(d*r-h*s,c*n-f*i),ys(h*r+d*s)]}return o.invert=function(a,l){var u=Ue(l),c=Ue(a)*u,d=Pe(a)*u,f=Pe(l),h=f*r-d*s;return[Uo(d*r+f*s,c*n+h*i),ys(h*n-c*i)]},o}function sv(e){return function(t){var n=new JF;for(var i in e)n[i]=e[i];return n.stream=t,n}}function JF(){}function XF(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=i&&e.clipExtent(null),Xu(n,e.stream(iE)),t(iE.result()),null!=i&&e.clipExtent(i),e}function pE(e,t,n){return XF(e,function(i){var r=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(r/(i[1][0]-i[0][0]),s/(i[1][1]-i[0][1])),a=+t[0][0]+(r-o*(i[1][0]+i[0][0]))/2,l=+t[0][1]+(s-o*(i[1][1]+i[0][1]))/2;e.scale(150*o).translate([a,l])},n)}function QF(e,t,n){return pE(e,[[0,0],t],n)}function ZF(e,t,n){return XF(e,function(i){var r=+t,s=r/(i[1][0]-i[0][0]),o=(r-s*(i[1][0]+i[0][0]))/2,a=-s*i[0][1];e.scale(150*s).translate([o,a])},n)}function eP(e,t,n){return XF(e,function(i){var r=+t,s=r/(i[1][1]-i[0][1]),o=-s*i[0][0],a=(r-s*(i[1][1]+i[0][1]))/2;e.scale(150*s).translate([o,a])},n)}KF.invert=KF,JF.prototype={constructor:JF,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var ZPe=Ue(30*ht);function XZ(e,t){return+t?function t3e(e,t){function n(i,r,s,o,a,l,u,c,d,f,h,p,g,m){var _=u-i,y=c-r,v=_*_+y*y;if(v>4*t&&g--){var b=o+f,D=a+h,C=l+p,w=Gr(b*b+D*D+C*C),E=ys(C/=w),N=St(St(C)-1)<$e||St(s-d)<$e?(s+d)/2:Uo(D,b),k=e(N,E),I=k[0],L=k[1],B=I-i,T=L-r,A=y*B-_*T;(A*A/v>t||St((_*B+y*T)/v-.5)>.3||o*f+a*h+l*p<ZPe)&&(n(i,r,s,o,a,l,I,L,N,b/=w,D/=w,C,g,m),m.point(I,L),n(I,L,N,b,D,C,u,c,d,f,h,p,g,m))}}return function(i){var r,s,o,a,l,u,c,d,f,h,p,g,m={point:_,lineStart:y,lineEnd:b,polygonStart:function(){i.polygonStart(),m.lineStart=D},polygonEnd:function(){i.polygonEnd(),m.lineStart=y}};function _(E,N){E=e(E,N),i.point(E[0],E[1])}function y(){d=NaN,m.point=v,i.lineStart()}function v(E,N){var k=mh([E,N]),I=e(E,N);n(d,f,c,h,p,g,d=I[0],f=I[1],c=E,h=k[0],p=k[1],g=k[2],16,i),i.point(d,f)}function b(){m.point=_,i.lineEnd()}function D(){y(),m.point=C,m.lineEnd=w}function C(E,N){v(r=E,N),s=d,o=f,a=h,l=p,u=g,m.point=v}function w(){n(d,f,c,h,p,g,s,o,r,a,l,u,16,i),m.lineEnd=b,b()}return m}}(e,t):function e3e(e){return sv({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)}var n3e=sv({point:function(e,t){this.stream.point(e*ht,t*ht)}});function QZ(e,t,n,i,r,s){if(!s)return function r3e(e,t,n,i,r){function s(o,a){return[t+e*(o*=i),n-e*(a*=r)]}return s.invert=function(o,a){return[(o-t)/e*i,(n-a)/e*r]},s}(e,t,n,i,r);var o=Ue(s),a=Pe(s),l=o*e,u=a*e,c=o/e,d=a/e,f=(a*n-o*t)/e,h=(a*t+o*n)/e;function p(g,m){return[l*(g*=i)-u*(m*=r)+t,n-u*g-l*m]}return p.invert=function(g,m){return[i*(c*g-d*m+f),r*(h-d*g-c*m)]},p}function $l(e){return ZZ(function(){return e})()}function ZZ(e){var t,c,_,y,v,C,w,E,N,k,n=150,i=480,r=250,s=0,o=0,a=0,l=0,u=0,d=0,f=1,h=1,p=null,g=HZ,m=null,b=Qy,D=.5;function I(A){return E(A[0]*ht,A[1]*ht)}function L(A){return(A=E.invert(A[0],A[1]))&&[A[0]*ri,A[1]*ri]}function B(){var A=QZ(n,0,0,f,h,d).apply(null,t(s,o)),x=QZ(n,i-A[0],r-A[1],f,h,d);return c=GZ(a,l,u),w=YF(t,x),E=YF(c,w),C=XZ(w,D),T()}function T(){return N=k=null,I}return I.stream=function(A){return N&&k===A?N:N=n3e(function i3e(e){return sv({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}(c)(g(C(b(k=A)))))},I.preclip=function(A){return arguments.length?(g=A,p=void 0,T()):g},I.postclip=function(A){return arguments.length?(b=A,m=_=y=v=null,T()):b},I.clipAngle=function(A){return arguments.length?(g=+A?JPe(p=A*ht):(p=null,HZ),T()):p*ri},I.clipExtent=function(A){return arguments.length?(b=null==A?(m=_=y=v=null,Qy):qZ(m=+A[0][0],_=+A[0][1],y=+A[1][0],v=+A[1][1]),T()):null==m?null:[[m,_],[y,v]]},I.scale=function(A){return arguments.length?(n=+A,B()):n},I.translate=function(A){return arguments.length?(i=+A[0],r=+A[1],B()):[i,r]},I.center=function(A){return arguments.length?(s=A[0]%360*ht,o=A[1]%360*ht,B()):[s*ri,o*ri]},I.rotate=function(A){return arguments.length?(a=A[0]%360*ht,l=A[1]%360*ht,u=A.length>2?A[2]%360*ht:0,B()):[a*ri,l*ri,u*ri]},I.angle=function(A){return arguments.length?(d=A%360*ht,B()):d*ri},I.reflectX=function(A){return arguments.length?(f=A?-1:1,B()):f<0},I.reflectY=function(A){return arguments.length?(h=A?-1:1,B()):h<0},I.precision=function(A){return arguments.length?(C=XZ(w,D=A*A),T()):Gr(D)},I.fitExtent=function(A,x){return pE(I,A,x)},I.fitSize=function(A,x){return QF(I,A,x)},I.fitWidth=function(A,x){return ZF(I,A,x)},I.fitHeight=function(A,x){return eP(I,A,x)},function(){return t=e.apply(this,arguments),I.invert=t.invert&&L,B()}}function tP(e){var t=0,n=ft/3,i=ZZ(e),r=i(t,n);return r.parallels=function(s){return arguments.length?i(t=s[0]*ht,n=s[1]*ht):[t*ri,n*ri]},r}function o3e(e,t){var n=Pe(e),i=(n+Pe(t))/2;if(St(i)<$e)return function s3e(e){var t=Ue(e);function n(i,r){return[i*t,Pe(r)/t]}return n.invert=function(i,r){return[i/t,ys(r*t)]},n}(e);var r=1+n*(2*i-n),s=Gr(r)/i;function o(a,l){var u=Gr(r-2*i*Pe(l))/i;return[u*Pe(a*=i),s-u*Ue(a)]}return o.invert=function(a,l){var u=s-l,c=Uo(a,St(u))*zo(u);return u*i<0&&(c-=ft*zo(a)*zo(u)),[c/i,ys((r-(a*a+u*u)*i*i)/(2*i))]},o}function gE(){return tP(o3e).scale(155.424).center([0,33.6442])}function eee(){return gE().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function tee(e){return function(t,n){var i=Ue(t),r=Ue(n),s=e(i*r);return s===1/0?[2,0]:[s*r*Pe(t),s*Pe(n)]}}function ov(e){return function(t,n){var i=Gr(t*t+n*n),r=e(i),s=Pe(r),o=Ue(r);return[Uo(t*s,i*o),ys(i&&n*s/i)]}}var nee=tee(function(e){return Gr(2/(1+e))});nee.invert=ov(function(e){return 2*ys(e/2)});var iee=tee(function(e){return(e=yZ(e))&&e/Pe(e)});function mE(e,t){return[e,eE(FF((Wn+t)/2))]}function ree(e){var a,l,u,t=$l(e),n=t.center,i=t.scale,r=t.translate,s=t.clipExtent,o=null;function c(){var d=ft*i(),f=t(function QPe(e){function t(n){return(n=e(n[0]*ht,n[1]*ht))[0]*=ri,n[1]*=ri,n}return e=GZ(e[0]*ht,e[1]*ht,e.length>2?e[2]*ht:0),t.invert=function(n){return(n=e.invert(n[0]*ht,n[1]*ht))[0]*=ri,n[1]*=ri,n},t}(t.rotate()).invert([0,0]));return s(null==o?[[f[0]-d,f[1]-d],[f[0]+d,f[1]+d]]:e===mE?[[Math.max(f[0]-d,o),a],[Math.min(f[0]+d,l),u]]:[[o,Math.max(f[1]-d,a)],[l,Math.min(f[1]+d,u)]])}return t.scale=function(d){return arguments.length?(i(d),c()):i()},t.translate=function(d){return arguments.length?(r(d),c()):r()},t.center=function(d){return arguments.length?(n(d),c()):n()},t.clipExtent=function(d){return arguments.length?(null==d?o=a=l=u=null:(o=+d[0][0],a=+d[0][1],l=+d[1][0],u=+d[1][1]),c()):null==o?null:[[o,a],[l,u]]},c()}function _E(e){return FF((Wn+e)/2)}function f3e(e,t){var n=Ue(e),i=e===t?Pe(e):eE(n/Ue(t))/eE(_E(t)/_E(e)),r=n*RF(_E(e),i)/i;if(!i)return mE;function s(o,a){r>0?a<-Wn+$e&&(a=-Wn+$e):a>Wn-$e&&(a=Wn-$e);var l=r/RF(_E(a),i);return[l*Pe(i*o),r-l*Ue(i*o)]}return s.invert=function(o,a){var l=r-a,u=zo(i)*Gr(o*o+l*l),c=Uo(o,St(l))*zo(l);return l*i<0&&(c-=ft*zo(o)*zo(l)),[c/i,2*cm(RF(r/u,1/i))-Wn]},s}function yE(e,t){return[e,t]}function g3e(e,t){var n=Ue(e),i=e===t?Pe(e):(n-Ue(t))/(t-e),r=n/i+e;if(St(i)<$e)return yE;function s(o,a){var l=r-a,u=i*o;return[l*Pe(u),r-l*Ue(u)]}return s.invert=function(o,a){var l=r-a,u=Uo(o,St(l))*zo(l);return l*i<0&&(u-=ft*zo(o)*zo(l)),[u/i,r-zo(i)*Gr(o*o+l*l)]},s}iee.invert=ov(function(e){return e}),mE.invert=function(e,t){return[e,2*cm(_Z(t))-Wn]},yE.invert=yE;var av=1.340264,lv=-.081106,uv=893e-6,cv=.003796,vE=Gr(3)/2;function see(e,t){var n=ys(vE*Pe(t)),i=n*n,r=i*i*i;return[e*Ue(n)/(vE*(av+3*lv*i+r*(7*uv+9*cv*i))),n*(av+lv*i+r*(uv+cv*i))]}function oee(e,t){var n=Ue(t),i=Ue(e)*n;return[n*Pe(e)/i,Pe(t)/i]}function aee(e,t){var n=t*t,i=n*n;return[e*(.8707-.131979*n+i*(i*(.003971*n-.001529*i)-.013791)),t*(1.007226+n*(.015085+i*(.028874*n-.044475-.005916*i)))]}function lee(e,t){return[Ue(t)*Pe(e),Pe(t)]}function uee(e,t){var n=Ue(t),i=1+Ue(e)*n;return[n*Pe(e)/i,Pe(t)/i]}function cee(e,t){return[eE(FF((Wn+t)/2)),-e]}see.invert=function(e,t){for(var o,n=t,i=n*n,r=i*i*i,s=0;s<12&&(r=(i=(n-=o=(n*(av+lv*i+r*(uv+cv*i))-t)/(av+3*lv*i+r*(7*uv+9*cv*i)))*n)*i*i,!(St(o)<XC));++s);return[vE*e*(av+3*lv*i+r*(7*uv+9*cv*i))/Ue(n),ys(Pe(n)/vE)]},oee.invert=ov(cm),aee.invert=function(e,t){var r,n=t,i=25;do{var s=n*n,o=s*s;n-=r=(n*(1.007226+s*(.015085+o*(.028874*s-.044475-.005916*o)))-t)/(1.007226+s*(.045255+o*(.259866*s-.311325-.005916*11*o)))}while(St(r)>$e&&--i>0);return[e/(.8707+(s=n*n)*(s*(s*s*s*(.003971-.001529*s)-.013791)-.131979)),n]},lee.invert=ov(ys),uee.invert=ov(function(e){return 2*cm(e)}),cee.invert=function(e,t){return[-t,2*cm(_Z(e))-Wn]};var S3e=Math.abs,nP=(Math,Math,Math,Math.cos),bE=(Math,Math,Math,Math,Math,Math,Math,Math,Math.sin),Md=(Math,Math.PI),iP=Md/2,fee=(Math,wE(2));function hee(e){return e>1?iP:e<-1?-iP:Math.asin(e)}function wE(e){return e>0?Math.sqrt(e):0}function A3e(e,t){var r,n=e*bE(t),i=30;do{t-=r=(t+bE(t)-n)/(1+nP(t))}while(S3e(r)>1e-6&&--i>0);return t/2}wE(Md);var T3e=function M3e(e,t,n){function i(r,s){return[e*r*nP(s=A3e(n,s)),t*bE(s)]}return i.invert=function(r,s){return s=hee(s/t),[r/(e*nP(s)),hee((2*s+bE(2*s))/n)]},i}(fee/iP,fee,Md);const N3e=PZ(),rP=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function k3e(e,t){return function n(){const i=t();return i.type=e,i.path=PZ().projection(i),i.copy=i.copy||function(){const r=n();return rP.forEach(s=>{i[s]&&r[s](i[s]())}),r.path.pointRadius(i.path.pointRadius()),r},i}}function sP(e,t){if(!e||"string"!=typeof e)throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(DE[e]=k3e(e,t),this):DE[e]||null}function pee(e){return e&&e.path||N3e}const DE={albers:eee,albersusa:function l3e(){var e,t,i,s,a,l,n=eee(),r=gE().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o=gE().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(f,h){l=[f,h]}};function c(f){var h=f[0],p=f[1];return l=null,i.point(h,p),l||(s.point(h,p),l)||(a.point(h,p),l)}function d(){return e=t=null,c}return c.invert=function(f){var h=n.scale(),p=n.translate(),g=(f[0]-p[0])/h,m=(f[1]-p[1])/h;return(m>=.12&&m<.234&&g>=-.425&&g<-.214?r:m>=.166&&m<.234&&g>=-.214&&g<-.115?o:n).invert(f)},c.stream=function(f){return e&&t===f?e:e=function a3e(e){var t=e.length;return{point:function(n,i){for(var r=-1;++r<t;)e[r].point(n,i)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}([n.stream(t=f),r.stream(f),o.stream(f)])},c.precision=function(f){return arguments.length?(n.precision(f),r.precision(f),o.precision(f),d()):n.precision()},c.scale=function(f){return arguments.length?(n.scale(f),r.scale(.35*f),o.scale(f),c.translate(n.translate())):n.scale()},c.translate=function(f){if(!arguments.length)return n.translate();var h=n.scale(),p=+f[0],g=+f[1];return i=n.translate(f).clipExtent([[p-.455*h,g-.238*h],[p+.455*h,g+.238*h]]).stream(u),s=r.translate([p-.307*h,g+.201*h]).clipExtent([[p-.425*h+$e,g+.12*h+$e],[p-.214*h-$e,g+.234*h-$e]]).stream(u),a=o.translate([p-.205*h,g+.212*h]).clipExtent([[p-.214*h+$e,g+.166*h+$e],[p-.115*h-$e,g+.234*h-$e]]).stream(u),d()},c.fitExtent=function(f,h){return pE(c,f,h)},c.fitSize=function(f,h){return QF(c,f,h)},c.fitWidth=function(f,h){return ZF(c,f,h)},c.fitHeight=function(f,h){return eP(c,f,h)},c.scale(1070)},azimuthalequalarea:function u3e(){return $l(nee).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function c3e(){return $l(iee).scale(79.4188).clipAngle(179.999)},conicconformal:function h3e(){return tP(f3e).scale(109.5).parallels([30,30])},conicequalarea:gE,conicequidistant:function m3e(){return tP(g3e).scale(131.154).center([0,13.9389])},equalEarth:function y3e(){return $l(see).scale(177.158)},equirectangular:function p3e(){return $l(yE).scale(152.63)},gnomonic:function v3e(){return $l(oee).scale(144.049).clipAngle(60)},identity:function b3e(){var o,a,u,c,d,m,_,e=1,t=0,n=0,i=1,r=1,s=0,l=null,f=1,h=1,p=sv({point:function(b,D){var C=v([b,D]);this.stream.point(C[0],C[1])}}),g=Qy;function y(){return f=e*i,h=e*r,m=_=null,v}function v(b){var D=b[0]*f,C=b[1]*h;if(s){var w=C*o-D*a;D=D*o+C*a,C=w}return[D+t,C+n]}return v.invert=function(b){var D=b[0]-t,C=b[1]-n;if(s){var w=C*o+D*a;D=D*o-C*a,C=w}return[D/f,C/h]},v.stream=function(b){return m&&_===b?m:m=p(g(_=b))},v.postclip=function(b){return arguments.length?(g=b,l=u=c=d=null,y()):g},v.clipExtent=function(b){return arguments.length?(g=null==b?(l=u=c=d=null,Qy):qZ(l=+b[0][0],u=+b[0][1],c=+b[1][0],d=+b[1][1]),y()):null==l?null:[[l,u],[c,d]]},v.scale=function(b){return arguments.length?(e=+b,y()):e},v.translate=function(b){return arguments.length?(t=+b[0],n=+b[1],y()):[t,n]},v.angle=function(b){return arguments.length?(a=Pe(s=b%360*ht),o=Ue(s),y()):s*ri},v.reflectX=function(b){return arguments.length?(i=b?-1:1,y()):i<0},v.reflectY=function(b){return arguments.length?(r=b?-1:1,y()):r<0},v.fitExtent=function(b,D){return pE(v,b,D)},v.fitSize=function(b,D){return QF(v,b,D)},v.fitWidth=function(b,D){return ZF(v,b,D)},v.fitHeight=function(b,D){return eP(v,b,D)},v},mercator:function d3e(){return ree(mE).scale(961/qr)},mollweide:function O3e(){return $l(T3e).scale(169.529)},naturalEarth1:function w3e(){return $l(aee).scale(175.295)},orthographic:function D3e(){return $l(lee).scale(249.5).clipAngle(90+$e)},stereographic:function C3e(){return $l(uee).scale(250).clipAngle(142)},transversemercator:function E3e(){var e=ree(cee),t=e.center,n=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):[(i=t())[1],-i[0]]},e.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):[(i=n())[0],i[1],i[2]-90]},n([0,0,90]).scale(159.155)}};for(const e in DE)sP(e,DE[e]);function gee(e,t,n){var i=Qs(e,t-$e,n).concat(t);return function(r){return i.map(function(s){return[r,s]})}}function mee(e,t,n){var i=Qs(e,t-$e,n).concat(t);return function(r){return i.map(function(s){return[s,r]})}}function I3e(){}const Qu=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function yee(){var e=1,t=1,n=a;function i(l,u){return u.map(c=>r(l,c))}function r(l,u){var c=[],d=[];return function s(l,u,c){var h,p,m,_,y,d=new Array,f=new Array;for(h=p=-1,Qu[(m=l[0]>=u)<<1].forEach(v);++h<e-1;)Qu[m|(m=l[h+1]>=u)<<1].forEach(v);for(Qu[m<<0].forEach(v);++p<t-1;){for(h=-1,Qu[(m=l[p*e+e]>=u)<<1|(_=l[p*e]>=u)<<2].forEach(v);++h<e-1;)y=_,Qu[m|(m=l[p*e+e+h+1]>=u)<<1|(_=l[p*e+h+1]>=u)<<2|y<<3].forEach(v);Qu[m|_<<3].forEach(v)}for(h=-1,Qu[(_=l[p*e]>=u)<<2].forEach(v);++h<e-1;)y=_,Qu[(_=l[p*e+h+1]>=u)<<2|y<<3].forEach(v);function v(b){var N,k,D=[b[0][0]+h,b[0][1]+p],C=[b[1][0]+h,b[1][1]+p],w=o(D),E=o(C);(N=f[w])?(k=d[E])?(delete f[N.end],delete d[k.start],N===k?(N.ring.push(C),c(N.ring)):d[N.start]=f[k.end]={start:N.start,end:k.end,ring:N.ring.concat(k.ring)}):(delete f[N.end],N.ring.push(C),f[N.end=E]=N):(N=d[E])?(k=f[w])?(delete d[N.start],delete f[k.end],N===k?(N.ring.push(C),c(N.ring)):d[k.start]=f[N.end]={start:k.start,end:N.end,ring:k.ring.concat(N.ring)}):(delete d[N.start],N.ring.unshift(D),d[N.start=w]=N):d[w]=f[E]={start:w,end:E,ring:[D,C]}}Qu[_<<3].forEach(v)}(l,u,f=>{n(f,l,u),function R3e(e){for(var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}(f)>0?c.push([f]):d.push(f)}),d.forEach(f=>{for(var g,h=0,p=c.length;h<p;++h)if(-1!==F3e((g=c[h])[0],f))return void g.push(f)}),{type:"MultiPolygon",value:u,coordinates:c}}function o(l){return 2*l[0]+l[1]*(e+1)*4}function a(l,u,c){l.forEach(d=>{var m,f=d[0],h=d[1],p=0|f,g=0|h,_=u[g*e+p];f>0&&f<e&&p===f&&(d[0]=f+(c-(m=u[g*e+p-1]))/(_-m)-.5),h>0&&h<t&&g===h&&(d[1]=h+(c-(m=u[(g-1)*e+p]))/(_-m)-.5)})}return i.contour=r,i.size=function(l){if(!arguments.length)return[e,t];var u=Math.floor(l[0]),c=Math.floor(l[1]);return u>=0&&c>=0||te("invalid size"),e=u,t=c,i},i.smooth=function(l){return arguments.length?(n=l?a:I3e,i):n===a},i}function F3e(e,t){for(var r,n=-1,i=t.length;++n<i;)if(r=P3e(e,t[n]))return r;return 0}function P3e(e,t){for(var n=t[0],i=t[1],r=-1,s=0,o=e.length,a=o-1;s<o;a=s++){var l=e[s],u=l[0],c=l[1],d=e[a],f=d[0],h=d[1];if(L3e(l,d,t))return 0;c>i!=h>i&&n<(f-u)*(i-c)/(h-c)+u&&(r=-r)}return r}function L3e(e,t,n){var i;return function j3e(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}(e,t,n)&&function B3e(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}(e[i=+(e[0]===t[0])],n[i],t[i])}function vee(e,t,n){return function(i){var r=Al(i),s=n?Math.min(r[0],0):r[0],o=r[1],a=o-s,l=t?Jc(s,o,e):a/(e+1);return Qs(s+l,o,l)}}function oP(e){Q.call(this,null,e)}function bee(e,t,n,i,r){const s=e.x1||0,o=e.y1||0,a=t*n<0;function l(d){d.forEach(u)}function u(d){a&&d.reverse(),d.forEach(c)}function c(d){d[0]=(d[0]-s)*t+i,d[1]=(d[1]-o)*n+r}return function(d){return d.coordinates.forEach(l),d}}function wee(e,t,n){const i=e>=0?e:jk(t,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function aP(e){return st(e)?e:yr(+e)}function Dee(){var e=l=>l[0],t=l=>l[1],n=Ag,i=[-1,-1],r=960,s=500,o=2;function a(l,u){const c=wee(i[0],l,e)>>o,d=wee(i[1],l,t)>>o,f=c?c+2:0,h=d?d+2:0,p=2*f+(r>>o),g=2*h+(s>>o),m=new Float32Array(p*g),_=new Float32Array(p*g);let y=m;l.forEach(b=>{const D=f+(+e(b)>>o),C=h+(+t(b)>>o);D>=0&&D<p&&C>=0&&C<g&&(m[D+C*p]+=+n(b))}),c>0&&d>0?(pm(p,g,m,_,c),gm(p,g,_,m,d),pm(p,g,m,_,c),gm(p,g,_,m,d),pm(p,g,m,_,c),gm(p,g,_,m,d)):c>0?(pm(p,g,m,_,c),pm(p,g,_,m,c),pm(p,g,m,_,c),y=_):d>0&&(gm(p,g,m,_,d),gm(p,g,_,m,d),gm(p,g,m,_,d),y=_);const v=u?Math.pow(2,-2*o):1/JQ(y);for(let b=0,D=p*g;b<D;++b)y[b]*=v;return{values:y,scale:1<<o,width:p,height:g,x1:f,y1:h,x2:f+(r>>o),y2:h+(s>>o)}}return a.x=function(l){return arguments.length?(e=aP(l),a):e},a.y=function(l){return arguments.length?(t=aP(l),a):t},a.weight=function(l){return arguments.length?(n=aP(l),a):n},a.size=function(l){if(!arguments.length)return[r,s];var u=+l[0],c=+l[1];return u>=0&&c>=0||te("invalid size"),r=u,s=c,a},a.cellSize=function(l){return arguments.length?((l=+l)>=1||te("invalid cell size"),o=Math.floor(Math.log(l)/Math.LN2),a):1<<o},a.bandwidth=function(l){return arguments.length?(1===(l=we(l)).length&&(l=[+l[0],+l[0]]),2!==l.length&&te("invalid bandwidth"),i=l,a):i},a}function pm(e,t,n,i,r){const s=1+(r<<1);for(let o=0;o<t;++o)for(let a=0,l=0;a<e+r;++a)a<e&&(l+=n[a+o*e]),a>=r&&(a>=s&&(l-=n[a-s+o*e]),i[a-r+o*e]=l/Math.min(a+1,e-1+s-a,s))}function gm(e,t,n,i,r){const s=1+(r<<1);for(let o=0;o<e;++o)for(let a=0,l=0;a<t+r;++a)a<t&&(l+=n[o+a*e]),a>=r&&(a>=s&&(l-=n[o+(a-s)*e]),i[o+(a-r)*e]=l/Math.min(a+1,t-1+s-a,s))}function lP(e){Q.call(this,null,e)}oP.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},fe(oP,Q,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=e.field||mr,s=yee().smooth(!1!==e.smooth),o=e.thresholds||function $3e(e,t,n){const i=vee(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?i:i(e.map(r=>Zf(t(r).values)))}(i,r,e),a=null===e.as?null:e.as||"contour",l=[];return i.forEach(u=>{const c=r(u),d=s.size([c.width,c.height])(c.values,ie(o)?o:o(c.values));(function V3e(e,t,n,i){let r=i.scale||t.scale,s=i.translate||t.translate;if(st(r)&&(r=r(n,i)),st(s)&&(s=s(n,i)),(1===r||null==r)&&!s)return;const o=(nn(r)?r:r[0])||1,a=(nn(r)?r:r[1])||1;e.forEach(bee(t,o,a,s&&s[0]||0,s&&s[1]||0))})(d,c,u,e),d.forEach(f=>{l.push(xD(u,Ut(null!=a?{[a]:f}:f)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}}),lP.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const H3e=["x","y","weight","size","cellSize","bandwidth"];function Cee(e,t){return H3e.forEach(n=>null!=t[n]?e[n](t[n]):0),e}function uP(e){Q.call(this,null,e)}fe(lP,Q,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var l,n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=function U3e(e,t){var r,s,o,a,l,u,n=[],i=c=>c(a);if(null==t)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],(u=r[l=t.map(i)])||(r[l]=u=[],u.dims=l,n.push(u)),u.push(a);return n}(t.materialize(t.SOURCE).source,e.groupby),s=(e.groupby||[]).map(Gn),o=Cee(Dee(),e),a=e.as||"grid";return l=r.map(c=>Ut(function u(c,d){for(let f=0;f<s.length;++f)c[s[f]]=d[f];return c}({[a]:o(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}}),uP.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},fe(uP,Q,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var a,l,n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=yee().smooth(!1!==e.smooth),r=e.values,s=e.thresholds||vee(e.count||10,e.nice,!!r),o=e.size;return r||(r=t.materialize(t.SOURCE).source,l=bee(a=Cee(Dee(),e)(r,!0),a.scale||1,a.scale||1,0,0),o=[a.width,a.height],r=a.values),s=ie(s)?s:s(r),r=i.size(o)(r,s),l&&r.forEach(l),this.value&&(n.rem=this.value),this.value=n.source=n.add=(r||[]).map(Ut),n}});const cP="Feature",dP="FeatureCollection";function fP(e){Q.call(this,null,e)}function hP(e){Q.call(this,null,e)}function pP(e){Q.call(this,null,e)}function gP(e){Q.call(this,null,e)}function mP(e){Q.call(this,[],e),this.generator=function _ee(){var e,t,n,i,r,s,o,a,f,h,p,g,l=10,u=l,c=90,d=360,m=2.5;function _(){return{type:"MultiLineString",coordinates:y()}}function y(){return Qs(ZC(i/c)*c,n,c).map(p).concat(Qs(ZC(a/d)*d,o,d).map(g)).concat(Qs(ZC(t/l)*l,e,l).filter(function(v){return St(v%c)>$e}).map(f)).concat(Qs(ZC(s/u)*u,r,u).filter(function(v){return St(v%d)>$e}).map(h))}return _.lines=function(){return y().map(function(v){return{type:"LineString",coordinates:v}})},_.outline=function(){return{type:"Polygon",coordinates:[p(i).concat(g(o).slice(1),p(n).reverse().slice(1),g(a).reverse().slice(1))]}},_.extent=function(v){return arguments.length?_.extentMajor(v).extentMinor(v):_.extentMinor()},_.extentMajor=function(v){return arguments.length?(a=+v[0][1],o=+v[1][1],(i=+v[0][0])>(n=+v[1][0])&&(v=i,i=n,n=v),a>o&&(v=a,a=o,o=v),_.precision(m)):[[i,a],[n,o]]},_.extentMinor=function(v){return arguments.length?(s=+v[0][1],r=+v[1][1],(t=+v[0][0])>(e=+v[1][0])&&(v=t,t=e,e=v),s>r&&(v=s,s=r,r=v),_.precision(m)):[[t,s],[e,r]]},_.step=function(v){return arguments.length?_.stepMajor(v).stepMinor(v):_.stepMinor()},_.stepMajor=function(v){return arguments.length?(c=+v[0],d=+v[1],_):[c,d]},_.stepMinor=function(v){return arguments.length?(l=+v[0],u=+v[1],_):[l,u]},_.precision=function(v){return arguments.length?(m=+v,f=gee(s,r,90),h=mee(t,e,m),p=gee(a,o,90),g=mee(i,n,m),_):m},_.extentMajor([[-180,-90+$e],[180,90-$e]]).extentMinor([[-180,-80-$e],[180,80+$e]])}()}function _P(e){Q.call(this,null,e)}function Eee(e){if(!st(e))return!1;const t=Aa(gr(e));return t.$x||t.$y||t.$value||t.$max}function See(e){Q.call(this,null,e),this.modified(!0)}function xee(e,t,n){st(e[t])&&e[t](n)}function Aee(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,d,f,h,p,g,m,_,y,s=e._root,o={data:i},a=e._x0,l=e._y0,u=e._x1,c=e._y1;if(!s)return e._root=o,e;for(;s.length;)if((g=t>=(d=(a+u)/2))?a=d:u=d,(m=n>=(f=(l+c)/2))?l=f:c=f,r=s,!(s=s[_=m<<1|g]))return r[_]=o,e;if(h=+e._x.call(null,s.data),p=+e._y.call(null,s.data),t===h&&n===p)return o.next=s,r?r[_]=o:e._root=o,e;do{r=r?r[_]=new Array(4):e._root=new Array(4),(g=t>=(d=(a+u)/2))?a=d:u=d,(m=n>=(f=(l+c)/2))?l=f:c=f}while((_=m<<1|g)==(y=(p>=f)<<1|h>=d));return r[y]=s,r[_]=o,e}function Wr(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function hLe(e){return e[0]}function gLe(e){return e[1]}function yP(e,t,n){var i=new vP(null==t?hLe:t,null==n?gLe:n,NaN,NaN,NaN,NaN);return null==e?i:i.addAll(e)}function vP(e,t,n,i,r,s){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=s,this._root=void 0}function Mee(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}fP.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},fe(fP,Q,{transform(e,t){var u,n=this._features,i=this._points,r=e.fields,s=r&&r[0],o=r&&r[1],a=e.geojson||!r&&mr,l=t.ADD;u=e.modified()||t.changed(t.REM)||t.modified(gr(a))||s&&t.modified(gr(s))||o&&t.modified(gr(o)),(!this.value||u)&&(l=t.SOURCE,this._features=n=[],this._points=i=[]),a&&t.visit(l,c=>n.push(a(c))),s&&o&&(t.visit(l,c=>{var d=s(c),f=o(c);null!=d&&null!=f&&(d=+d)===d&&(f=+f)===f&&i.push([d,f])}),n=n.concat({type:cP,geometry:{type:"MultiPoint",coordinates:i}})),this.value={type:dP,features:n}}}),hP.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},fe(hP,Q,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.field||mr,s=e.as||"path",o=n.SOURCE;!i||e.modified()?(this.value=i=pee(e.projection),n.materialize().reflow()):o=r===mr||t.modified(r.fields)?n.ADD_MOD:n.ADD;const a=function q3e(e,t){const n=e.pointRadius();return e.context(null),null!=t&&e.pointRadius(t),n}(i,e.pointRadius);return n.visit(o,l=>l[s]=i(r(l))),i.pointRadius(a),n.modifies(s)}}),pP.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},fe(pP,Q,{transform(e,t){var l,n=e.projection,i=e.fields[0],r=e.fields[1],s=e.as||["x","y"],o=s[0],a=s[1];function u(c){const d=n([i(c),r(c)]);d?(c[o]=d[0],c[a]=d[1]):(c[o]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,u):(l=t.modified(i.fields)||t.modified(r.fields),t.visit(l?t.ADD_MOD:t.ADD,u)),t.modifies(s)}}),gP.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},fe(gP,Q,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.as||"shape",s=n.ADD;return(!i||e.modified())&&(this.value=i=function G3e(e,t,n){const i=null==n?r=>e(t(r)):r=>{var s=e.pointRadius(),o=e.pointRadius(n)(t(r));return e.pointRadius(s),o};return i.context=r=>(e.context(r),i),i}(pee(e.projection),e.field||ds("datum"),e.pointRadius),n.materialize().reflow(),s=n.SOURCE),n.visit(s,o=>o[r]=i),n.modifies(r)}}),mP.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},fe(mP,Q,{transform(e,t){var r,n=this.value,i=this.generator;if(!n.length||e.modified())for(const s in e)st(i[s])&&i[s](e[s]);return r=i(),n.length?t.mod.push(qW(n[0],r)):t.add.push(Ut(r)),n[0]=r,t}}),_P.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},fe(_P,Q,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,i="shared"===e.resolve,r=e.field||mr,s=function Y3e(e,t){let n;return st(e)?(n=i=>e(i,t),n.dep=Eee(e)):e?n=yr(e):(n=i=>i.$value/i.$max||0,n.dep=!0),n}(e.opacity,e),o=function W3e(e,t){let n;return st(e)?(n=i=>cd(e(i,t)),n.dep=Eee(e)):n=yr(cd(e||"#888")),n}(e.color,e),a=e.as||"image",l={$x:0,$y:0,$value:0,$max:i?Zf(n.map(u=>Zf(r(u).values))):0};return n.forEach(u=>{const c=r(u),d=ot({},u,l);i||(d.$max=Zf(c.values||[])),u[a]=function K3e(e,t,n,i){const r=e.width,o=e.x1||0,a=e.y1||0,l=e.x2||r,u=e.y2||e.height,c=e.values,d=c?m=>c[m]:qc,f=ld(l-o,u-a),h=f.getContext("2d"),p=h.getImageData(0,0,l-o,u-a),g=p.data;for(let m=a,_=0;m<u;++m){t.$y=m-a;for(let y=o,v=m*r;y<l;++y,_+=4){t.$x=y-o,t.$value=d(y+v);const b=n(t);g[_+0]=b.r,g[_+1]=b.g,g[_+2]=b.b,g[_+3]=~~(255*i(t))}}return h.putImageData(p,0,0),f}(c,d,o.dep?o:yr(o(d)),s.dep?s:yr(s(d)))}),t.reflow(!0).modifies(a)}}),fe(See,Q,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=function X3e(e){const t=sP((e||"mercator").toLowerCase());return t||te("Unrecognized projection type: "+e),t()}(e.type),rP.forEach(i=>{null!=e[i]&&xee(n,i,e[i])})):rP.forEach(i=>{e.modified(i)&&xee(n,i,e[i])}),null!=e.pointRadius&&n.path.pointRadius(e.pointRadius),e.fit&&function J3e(e,t){const n=function Q3e(e){return 1===(e=we(e)).length?e[0]:{type:dP,features:e.reduce((t,n)=>t.concat(function Z3e(e){return e.type===dP?e.features:we(e).filter(t=>null!=t).map(t=>t.type===cP?t:{type:cP,geometry:t})}(n)),[])}}(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});var Yr=yP.prototype=vP.prototype;function Kr(e){return function(){return e}}function Td(e){return 1e-6*(e()-.5)}function _Le(e){return e.x+e.vx}function yLe(e){return e.y+e.vy}Yr.copy=function(){var n,i,e=new vP(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root;if(!t)return e;if(!t.length)return e._root=Mee(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(i=t.source[r])&&(i.length?n.push({source:i,target:t.target[r]=new Array(4)}):t.target[r]=Mee(i));return e},Yr.add=function tLe(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return Aee(this.cover(t,n),t,n,e)},Yr.addAll=function nLe(e){var t,n,r,s,i=e.length,o=new Array(i),a=new Array(i),l=1/0,u=1/0,c=-1/0,d=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(o[n]=r,a[n]=s,r<l&&(l=r),r>c&&(c=r),s<u&&(u=s),s>d&&(d=s));if(l>c||u>d)return this;for(this.cover(l,u).cover(c,d),n=0;n<i;++n)Aee(this,o[n],a[n],e[n]);return this},Yr.cover=function iLe(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,s=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,s=(i=Math.floor(t))+1;else{for(var l,u,o=r-n||1,a=this._root;n>e||e>=r||i>t||t>=s;)switch(u=(t<i)<<1|e<n,l=new Array(4),l[u]=a,a=l,o*=2,u){case 0:r=n+o,s=i+o;break;case 1:n=r-o,s=i+o;break;case 2:r=n+o,i=s-o;break;case 3:n=r-o,i=s-o}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=i,this._x1=r,this._y1=s,this},Yr.data=function rLe(){var e=[];return this.visit(function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)}),e},Yr.extent=function sLe(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Yr.find=function oLe(e,t,n){var i,o,a,l,u,p,g,r=this._x0,s=this._y0,c=this._x1,d=this._y1,f=[],h=this._root;for(h&&f.push(new Wr(h,r,s,c,d)),null==n?n=1/0:(r=e-n,s=t-n,c=e+n,d=t+n,n*=n);p=f.pop();)if(!(!(h=p.node)||(o=p.x0)>c||(a=p.y0)>d||(l=p.x1)<r||(u=p.y1)<s))if(h.length){var m=(o+l)/2,_=(a+u)/2;f.push(new Wr(h[3],m,_,l,u),new Wr(h[2],o,_,m,u),new Wr(h[1],m,a,l,_),new Wr(h[0],o,a,m,_)),(g=(t>=_)<<1|e>=m)&&(p=f[f.length-1],f[f.length-1]=f[f.length-1-g],f[f.length-1-g]=p)}else{var y=e-+this._x.call(null,h.data),v=t-+this._y.call(null,h.data),b=y*y+v*v;if(b<n){var D=Math.sqrt(n=b);r=e-D,s=t-D,c=e+D,d=t+D,i=h.data}}return i},Yr.remove=function aLe(e){if(isNaN(c=+this._x.call(null,e))||isNaN(d=+this._y.call(null,e)))return this;var t,i,r,s,c,d,f,h,p,g,m,_,n=this._root,o=this._x0,a=this._y0,l=this._x1,u=this._y1;if(!n)return this;if(n.length)for(;;){if((p=c>=(f=(o+l)/2))?o=f:l=f,(g=d>=(h=(a+u)/2))?a=h:u=h,t=n,!(n=n[m=g<<1|p]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(i=t,_=m)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,r?(s?r.next=s:delete r.next,this):t?(s?t[m]=s:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(i?i[_]=n:this._root=n),this):(this._root=s,this)},Yr.removeAll=function lLe(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},Yr.root=function uLe(){return this._root},Yr.size=function cLe(){var e=0;return this.visit(function(t){if(!t.length)do{++e}while(t=t.next)}),e},Yr.visit=function dLe(e){var n,r,s,o,a,l,t=[],i=this._root;for(i&&t.push(new Wr(i,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(i=n.node,s=n.x0,o=n.y0,a=n.x1,l=n.y1)&&i.length){var u=(s+a)/2,c=(o+l)/2;(r=i[3])&&t.push(new Wr(r,u,c,a,l)),(r=i[2])&&t.push(new Wr(r,s,c,u,l)),(r=i[1])&&t.push(new Wr(r,u,o,a,c)),(r=i[0])&&t.push(new Wr(r,s,o,u,c))}return this},Yr.visitAfter=function fLe(e){var i,t=[],n=[];for(this._root&&t.push(new Wr(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var r=i.node;if(r.length){var s,o=i.x0,a=i.y0,l=i.x1,u=i.y1,c=(o+l)/2,d=(a+u)/2;(s=r[0])&&t.push(new Wr(s,o,a,c,d)),(s=r[1])&&t.push(new Wr(s,c,a,l,d)),(s=r[2])&&t.push(new Wr(s,o,d,c,u)),(s=r[3])&&t.push(new Wr(s,c,d,l,u))}n.push(i)}for(;i=n.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this},Yr.x=function pLe(e){return arguments.length?(this._x=e,this):this._x},Yr.y=function mLe(e){return arguments.length?(this._y=e,this):this._y};var bLe={value:()=>{}};function Tee(){for(var i,e=0,t=arguments.length,n={};e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new CE(n)}function CE(e){this._=e}function wLe(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}function DLe(e,t){for(var r,n=0,i=e.length;n<i;++n)if((r=e[n]).name===t)return r.value}function Oee(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=bLe,e=e.slice(0,i).concat(e.slice(i+1));break}return null!=n&&e.push({name:t,value:n}),e}CE.prototype=Tee.prototype={constructor:CE,on:function(e,t){var r,n=this._,i=wLe(e+"",n),s=-1,o=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++s<o;)if(r=(e=i[s]).type)n[r]=Oee(n[r],e.name,t);else if(null==t)for(r in n)n[r]=Oee(n[r],e.name,null);return this}for(;++s<o;)if((r=(e=i[s]).type)&&(r=DLe(n[r],e.name)))return r},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new CE(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var r,s,n=new Array(r),i=0;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,r=(s=this._[e]).length;i<r;++i)s[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)}};const CLe=Tee;var EE,pv,mm=0,fv=0,hv=0,SE=0,_h=0,xE=0,gv="object"==typeof performance&&performance.now?performance:Date,kee="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function bP(){return _h||(kee(ELe),_h=gv.now()+xE)}function ELe(){_h=0}function AE(){this._call=this._time=this._next=null}function Iee(e,t,n){var i=new AE;return i.restart(e,t,n),i}function Ree(){_h=(SE=gv.now())+xE,mm=fv=0;try{!function SLe(){bP(),++mm;for(var t,e=EE;e;)(t=_h-e._time)>=0&&e._call.call(void 0,t),e=e._next;--mm}()}finally{mm=0,function ALe(){for(var e,n,t=EE,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:EE=n);pv=e,wP(i)}(),_h=0}}function xLe(){var e=gv.now(),t=e-SE;t>1e3&&(xE-=t,SE=e)}function wP(e){mm||(fv&&(fv=clearTimeout(fv)),e-_h>24?(e<1/0&&(fv=setTimeout(Ree,e-gv.now()-xE)),hv&&(hv=clearInterval(hv))):(hv||(SE=gv.now(),hv=setInterval(xLe,1e3)),mm=1,kee(Ree)))}function NLe(e){return e.x}function kLe(e){return e.y}AE.prototype=Iee.prototype={constructor:AE,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?bP():+n)+(null==t?0:+t),!this._next&&pv!==this&&(pv?pv._next=this:EE=this,pv=this),this._call=e,this._time=n,wP()},stop:function(){this._call&&(this._call=null,this._time=1/0,wP())}};var RLe=Math.PI*(3-Math.sqrt(5));function LLe(e){return e.index}function Pee(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}const Lee={center:function eLe(e,t){var n,i=1;function r(){var s,a,o=n.length,l=0,u=0;for(s=0;s<o;++s)l+=(a=n[s]).x,u+=a.y;for(l=(l/o-e)*i,u=(u/o-t)*i,s=0;s<o;++s)(a=n[s]).x-=l,a.y-=u}return null==e&&(e=0),null==t&&(t=0),r.initialize=function(s){n=s},r.x=function(s){return arguments.length?(e=+s,r):e},r.y=function(s){return arguments.length?(t=+s,r):t},r.strength=function(s){return arguments.length?(i=+s,r):i},r},collide:function vLe(e){var t,n,i,r=1,s=1;function o(){for(var u,d,f,h,p,g,m,c=t.length,_=0;_<s;++_)for(d=yP(t,_Le,yLe).visitAfter(a),u=0;u<c;++u)m=(g=n[(f=t[u]).index])*g,h=f.x+f.vx,p=f.y+f.vy,d.visit(y);function y(v,b,D,C,w){var E=v.data,N=v.r,k=g+N;if(!E)return b>h+k||C<h-k||D>p+k||w<p-k;if(E.index>f.index){var I=h-E.x-E.vx,L=p-E.y-E.vy,B=I*I+L*L;B<k*k&&(0===I&&(B+=(I=Td(i))*I),0===L&&(B+=(L=Td(i))*L),B=(k-(B=Math.sqrt(B)))/B*r,f.vx+=(I*=B)*(k=(N*=N)/(m+N)),f.vy+=(L*=B)*k,E.vx-=I*(k=1-k),E.vy-=L*k)}}}function a(u){if(u.data)return u.r=n[u.data.index];for(var c=u.r=0;c<4;++c)u[c]&&u[c].r>u.r&&(u.r=u[c].r)}function l(){if(t){var u,d,c=t.length;for(n=new Array(c),u=0;u<c;++u)n[(d=t[u]).index]=+e(d,u,t)}}return"function"!=typeof e&&(e=Kr(null==e?1:+e)),o.initialize=function(u,c){t=u,i=c,l()},o.iterations=function(u){return arguments.length?(s=+u,o):s},o.strength=function(u){return arguments.length?(r=+u,o):r},o.radius=function(u){return arguments.length?(e="function"==typeof u?u:Kr(+u),l(),o):e},o},nbody:function PLe(){var e,t,n,i,s,r=Kr(-30),o=1,a=1/0,l=.81;function u(h){var p,g=e.length,m=yP(e,NLe,kLe).visitAfter(d);for(i=h,p=0;p<g;++p)t=e[p],m.visit(f)}function c(){if(e){var h,g,p=e.length;for(s=new Array(p),h=0;h<p;++h)s[(g=e[h]).index]=+r(g,h,e)}}function d(h){var g,m,y,v,b,p=0,_=0;if(h.length){for(y=v=b=0;b<4;++b)(g=h[b])&&(m=Math.abs(g.value))&&(p+=g.value,_+=m,y+=m*g.x,v+=m*g.y);h.x=y/_,h.y=v/_}else{(g=h).x=g.data.x,g.y=g.data.y;do{p+=s[g.data.index]}while(g=g.next)}h.value=p}function f(h,p,g,m){if(!h.value)return!0;var _=h.x-t.x,y=h.y-t.y,v=m-p,b=_*_+y*y;if(v*v/l<b)return b<a&&(0===_&&(b+=(_=Td(n))*_),0===y&&(b+=(y=Td(n))*y),b<o&&(b=Math.sqrt(o*b)),t.vx+=_*h.value*i/b,t.vy+=y*h.value*i/b),!0;if(!(h.length||b>=a)){(h.data!==t||h.next)&&(0===_&&(b+=(_=Td(n))*_),0===y&&(b+=(y=Td(n))*y),b<o&&(b=Math.sqrt(o*b)));do{h.data!==t&&(t.vx+=_*(v=s[h.data.index]*i/b),t.vy+=y*v)}while(h=h.next)}}return u.initialize=function(h,p){e=h,n=p,c()},u.strength=function(h){return arguments.length?(r="function"==typeof h?h:Kr(+h),c(),u):r},u.distanceMin=function(h){return arguments.length?(o=h*h,u):Math.sqrt(o)},u.distanceMax=function(h){return arguments.length?(a=h*h,u):Math.sqrt(a)},u.theta=function(h){return arguments.length?(l=h*h,u):Math.sqrt(l)},u},link:function jLe(e){var i,s,o,a,l,u,t=LLe,n=function d(m){return 1/Math.min(a[m.source.index],a[m.target.index])},r=Kr(30),c=1;function f(m){for(var _=0,y=e.length;_<c;++_)for(var b,D,C,w,E,N,k,v=0;v<y;++v)w=(C=(b=e[v]).target).x+C.vx-(D=b.source).x-D.vx||Td(u),E=C.y+C.vy-D.y-D.vy||Td(u),E*=N=((N=Math.sqrt(w*w+E*E))-s[v])/N*m*i[v],C.vx-=(w*=N)*(k=l[v]),C.vy-=E*k,D.vx+=w*(k=1-k),D.vy+=E*k}function h(){if(o){var m,b,_=o.length,y=e.length,v=new Map(o.map((D,C)=>[t(D,C,o),D]));for(m=0,a=new Array(_);m<y;++m)(b=e[m]).index=m,"object"!=typeof b.source&&(b.source=Pee(v,b.source)),"object"!=typeof b.target&&(b.target=Pee(v,b.target)),a[b.source.index]=(a[b.source.index]||0)+1,a[b.target.index]=(a[b.target.index]||0)+1;for(m=0,l=new Array(y);m<y;++m)l[m]=a[(b=e[m]).source.index]/(a[b.source.index]+a[b.target.index]);i=new Array(y),p(),s=new Array(y),g()}}function p(){if(o)for(var m=0,_=e.length;m<_;++m)i[m]=+n(e[m],m,e)}function g(){if(o)for(var m=0,_=e.length;m<_;++m)s[m]=+r(e[m],m,e)}return null==e&&(e=[]),f.initialize=function(m,_){o=m,u=_,h()},f.links=function(m){return arguments.length?(e=m,h(),f):e},f.id=function(m){return arguments.length?(t=m,f):t},f.iterations=function(m){return arguments.length?(c=+m,f):c},f.strength=function(m){return arguments.length?(n="function"==typeof m?m:Kr(+m),p(),f):n},f.distance=function(m){return arguments.length?(r="function"==typeof m?m:Kr(+m),g(),f):r},f},x:function BLe(e){var n,i,r,t=Kr(.1);function s(a){for(var c,l=0,u=n.length;l<u;++l)(c=n[l]).vx+=(r[l]-c.x)*i[l]*a}function o(){if(n){var a,l=n.length;for(i=new Array(l),r=new Array(l),a=0;a<l;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return"function"!=typeof e&&(e=Kr(null==e?0:+e)),s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t="function"==typeof a?a:Kr(+a),o(),s):t},s.x=function(a){return arguments.length?(e="function"==typeof a?a:Kr(+a),o(),s):e},s},y:function $Le(e){var n,i,r,t=Kr(.1);function s(a){for(var c,l=0,u=n.length;l<u;++l)(c=n[l]).vy+=(r[l]-c.y)*i[l]*a}function o(){if(n){var a,l=n.length;for(i=new Array(l),r=new Array(l),a=0;a<l;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return"function"!=typeof e&&(e=Kr(null==e?0:+e)),s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t="function"==typeof a?a:Kr(+a),o(),s):t},s.y=function(a){return arguments.length?(e="function"==typeof a?a:Kr(+a),o(),s):e},s}},mv="forces",DP=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],VLe=["static","iterations"],jee=["x","y","vx","vy"];function CP(e){Q.call(this,null,e)}function Bee(e,t,n,i){var s,o,a,l,r=we(t.forces);for(s=0,o=DP.length;s<o;++s)(a=DP[s])!==mv&&t.modified(a)&&e[a](t[a]);for(s=0,o=r.length;s<o;++s)l=mv+s,(a=n||t.modified(mv,s)?qLe(r[s]):i&&zLe(r[s],i)?e.force(l):null)&&e.force(l,a);for(o=e.numForces||0;s<o;++s)e.force(mv+s,null);return e.numForces=r.length,e}function zLe(e,t){var n,i;for(n in e)if(st(i=e[n])&&t.modified(gr(i)))return 1;return 0}function qLe(e){var t,n;for(n in Fe(Lee,e.force)||te("Unrecognized force: "+e.force),t=Lee[e.force](),e)st(t[n])&&GLe(t[n],e[n],e);return t}function GLe(e,t,n){e(st(t)?i=>t(i,n):t)}function WLe(e){var t=0,n=e.children,i=n&&n.length;if(i)for(;--i>=0;)t+=n[i].value;else t=1;e.value=t}function EP(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=cje)):void 0===t&&(t=uje);for(var i,s,o,a,l,n=new _m(e),r=[n];i=r.pop();)if((o=t(i.data))&&(l=(o=Array.from(o)).length))for(i.children=o,a=l-1;a>=0;--a)r.push(s=o[a]=new _m(o[a])),s.parent=i,s.depth=i.depth+1;return n.eachBefore($ee)}function uje(e){return e.children}function cje(e){return Array.isArray(e)?e[1]:null}function dje(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function $ee(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function _m(e){this.data=e,this.depth=this.height=0,this.parent=null}function ME(e){return null==e?null:Vee(e)}function Vee(e){if("function"!=typeof e)throw new Error;return e}function yh(){return 0}function ym(e){return function(){return e}}function _je(e,t){var n,i;if(SP(t,e))return[t];for(n=0;n<e.length;++n)if(TE(t,e[n])&&SP(_v(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(i=n+1;i<e.length;++i)if(TE(_v(e[n],e[i]),t)&&TE(_v(e[n],t),e[i])&&TE(_v(e[i],t),e[n])&&SP(qee(e[n],e[i],t),e))return[e[n],e[i],t];throw new Error}function TE(e,t){var n=e.r-t.r,i=t.x-e.x,r=t.y-e.y;return n<0||n*n<i*i+r*r}function zee(e,t){var n=e.r-t.r+1e-9*Math.max(e.r,t.r,1),i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function SP(e,t){for(var n=0;n<t.length;++n)if(!zee(e,t[n]))return!1;return!0}function yje(e){switch(e.length){case 1:return function vje(e){return{x:e.x,y:e.y,r:e.r}}(e[0]);case 2:return _v(e[0],e[1]);case 3:return qee(e[0],e[1],e[2])}}function _v(e,t){var n=e.x,i=e.y,r=e.r,s=t.x,o=t.y,a=t.r,l=s-n,u=o-i,c=a-r,d=Math.sqrt(l*l+u*u);return{x:(n+s+l/d*c)/2,y:(i+o+u/d*c)/2,r:(d+r+a)/2}}function qee(e,t,n){var i=e.x,r=e.y,s=e.r,o=t.x,a=t.y,l=t.r,u=n.x,c=n.y,d=n.r,f=i-o,h=i-u,p=r-a,g=r-c,m=l-s,_=d-s,y=i*i+r*r-s*s,v=y-o*o-a*a+l*l,b=y-u*u-c*c+d*d,D=h*p-f*g,C=(p*b-g*v)/(2*D)-i,w=(g*m-p*_)/D,E=(h*v-f*b)/(2*D)-r,N=(f*_-h*m)/D,k=w*w+N*N-1,I=2*(s+C*w+E*N),L=C*C+E*E-s*s,B=-(Math.abs(k)>1e-6?(I+Math.sqrt(I*I-4*k*L))/(2*k):L/I);return{x:i+C+w*B,y:r+E+N*B,r:B}}function Gee(e,t,n){var r,s,a,l,i=e.x-t.x,o=e.y-t.y,u=i*i+o*o;u?(s=t.r+n.r,l=e.r+n.r,(s*=s)>(l*=l)?(r=(u+l-s)/(2*u),a=Math.sqrt(Math.max(0,l/u-r*r)),n.x=e.x-r*i-a*o,n.y=e.y-r*o+a*i):(r=(u+s-l)/(2*u),a=Math.sqrt(Math.max(0,s/u-r*r)),n.x=t.x+r*i-a*o,n.y=t.y+r*o+a*i)):(n.x=t.x+n.r,n.y=t.y)}function Wee(e,t){var n=e.r+t.r-1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function Yee(e){var t=e._,n=e.next._,i=t.r+n.r,r=(t.x*n.r+n.x*t.r)/i,s=(t.y*n.r+n.y*t.r)/i;return r*r+s*s}function OE(e){this._=e,this.next=null,this.previous=null}function Kee(e,t){if(!(s=(e=function gje(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}(e)).length))return 0;var n,i,r,s,o,a,l,u,c,d,f;if((n=e[0]).x=0,n.y=0,!(s>1))return n.r;if(n.x=-(i=e[1]).r,i.x=n.r,i.y=0,!(s>2))return n.r+i.r;Gee(i,n,r=e[2]),n=new OE(n),i=new OE(i),r=new OE(r),n.next=r.previous=i,i.next=n.previous=r,r.next=i.previous=n;e:for(l=3;l<s;++l){Gee(n._,i._,r=e[l]),r=new OE(r),u=i.next,c=n.previous,d=i._.r,f=n._.r;do{if(d<=f){if(Wee(u._,r._)){n.next=i=u,i.previous=n,--l;continue e}d+=u._.r,u=u.next}else{if(Wee(c._,r._)){(n=c).next=i,i.previous=n,--l;continue e}f+=c._.r,c=c.previous}}while(u!==c.next);for(r.previous=n,r.next=i,n.next=i.previous=i=r,o=Yee(n);(r=r.next)!==i;)(a=Yee(r))<o&&(n=r,o=a);i=n.next}for(n=[i._],r=i;(r=r.next)!==i;)n.push(r._);for(r=function Uee(e,t){for(var s,o,n=0,i=(e=function mje(e,t){let i,r,n=e.length;for(;n;)r=t()*n--|0,i=e[n],e[n]=e[r],e[r]=i;return e}(Array.from(e),t)).length,r=[];n<i;)s=e[n],o&&zee(o,s)?++n:(o=yje(r=_je(r,s)),n=0);return o}(n,t),l=0;l<s;++l)(n=e[l]).x-=r.x,n.y-=r.y;return r.r}function bje(e){return Math.sqrt(e.value)}function Jee(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function xP(e,t,n){return function(i){if(r=i.children){var r,s,l,o=r.length,a=e(i)*t||0;if(a)for(s=0;s<o;++s)r[s].r+=a;if(l=Kee(r,n),a)for(s=0;s<o;++s)r[s].r-=a;i.r=l+a}}}function Xee(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function Qee(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function yv(e,t,n,i,r){for(var o,s=e.children,a=-1,l=s.length,u=e.value&&(i-t)/e.value;++a<l;)(o=s[a]).y0=n,o.y1=r,o.x0=t,o.x1=t+=o.value*u}CP.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:jee}]},fe(CP,Q,{transform(e,t){var n=this.value,i=t.changed(t.ADD_REM),r=e.modified(DP),s=e.iterations||300;if(n?(i&&(t.modifies("index"),n.nodes(t.source)),(r||t.changed(t.MOD))&&Bee(n,e,0,t)):(this.value=n=function ULe(e,t){const n=function FLe(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),s=0,o=.6,a=new Map,l=Iee(d),u=CLe("tick","end"),c=function OLe(){let e=1;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296}();function d(){f(),u.call("tick",t),n<i&&(l.stop(),u.call("end",t))}function f(g){var m,y,_=e.length;void 0===g&&(g=1);for(var v=0;v<g;++v)for(n+=(s-n)*r,a.forEach(function(b){b(n)}),m=0;m<_;++m)null==(y=e[m]).fx?y.x+=y.vx*=o:(y.x=y.fx,y.vx=0),null==y.fy?y.y+=y.vy*=o:(y.y=y.fy,y.vy=0);return t}function h(){for(var _,g=0,m=e.length;g<m;++g){if((_=e[g]).index=g,null!=_.fx&&(_.x=_.fx),null!=_.fy&&(_.y=_.fy),isNaN(_.x)||isNaN(_.y)){var y=10*Math.sqrt(.5+g),v=g*RLe;_.x=y*Math.cos(v),_.y=y*Math.sin(v)}(isNaN(_.vx)||isNaN(_.vy))&&(_.vx=_.vy=0)}}function p(g){return g.initialize&&g.initialize(e,c),g}return null==e&&(e=[]),h(),t={tick:f,restart:function(){return l.restart(d),t},stop:function(){return l.stop(),t},nodes:function(g){return arguments.length?(e=g,h(),a.forEach(p),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(i=+g,t):i},alphaDecay:function(g){return arguments.length?(r=+g,t):+r},alphaTarget:function(g){return arguments.length?(s=+g,t):s},velocityDecay:function(g){return arguments.length?(o=1-g,t):1-o},randomSource:function(g){return arguments.length?(c=g,a.forEach(p),t):c},force:function(g,m){return arguments.length>1?(null==m?a.delete(g):a.set(g,p(m)),t):a.get(g)},find:function(g,m,_){var b,D,C,w,E,y=0,v=e.length;for(null==_?_=1/0:_*=_,y=0;y<v;++y)(C=(b=g-(w=e[y]).x)*b+(D=m-w.y)*D)<_&&(E=w,_=C);return E},on:function(g,m){return arguments.length>1?(u.on(g,m),t):u.on(g)}}}(e),i=n.stop,r=n.restart;let s=!1;return n.stopped=()=>s,n.restart=()=>(s=!1,r()),n.stop=()=>(s=!0,i()),Bee(n,t,!0).on("end",()=>s=!0)}(t.source,e),n.on("tick",function HLe(e,t){return()=>e.touch(t).run()}(t.dataflow,this)),e.static||(i=!0,n.tick()),t.modifies("index")),r||i||e.modified(VLe)||t.changed()&&e.restart)if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/s)),e.static)for(n.stop();--s>=0;)n.tick();else if(n.stopped()&&n.restart(),!i)return t.StopPropagation;return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let c,a=this._argops,l=0,u=a.length;l<u;++l)if(c=a[l],c.name===mv&&"link"===c.op._argval.force)for(var o,i=c.op._argops,r=0,s=i.length;r<s;++r)if("links"===i[r].name&&(o=i[r].op.source)){n.pulse(o,n.changeset().reflow());break}return t.reflow(e.modified()).modifies(jee)}}),_m.prototype=EP.prototype={constructor:_m,count:function YLe(){return this.eachAfter(WLe)},each:function KLe(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this},eachAfter:function XLe(e,t){for(var s,o,a,n=this,i=[n],r=[],l=-1;n=i.pop();)if(r.push(n),s=n.children)for(o=0,a=s.length;o<a;++o)i.push(s[o]);for(;n=r.pop();)e.call(t,n,++l,this);return this},eachBefore:function JLe(e,t){for(var r,s,n=this,i=[n],o=-1;n=i.pop();)if(e.call(t,n,++o,this),r=n.children)for(s=r.length-1;s>=0;--s)i.push(r[s]);return this},find:function QLe(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i},sum:function ZLe(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n})},sort:function eje(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})},path:function tje(e){for(var t=this,n=function nje(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}(t,e),i=[t];t!==n;)i.push(t=t.parent);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i},ancestors:function ije(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function rje(){return Array.from(this)},leaves:function sje(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e},links:function oje(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t},copy:function lje(){return EP(this).eachBefore(dje)},[Symbol.iterator]:function*aje(){var t,i,r,s,e=this,n=[e];do{for(t=n.reverse(),n=[];e=t.pop();)if(yield e,i=e.children)for(r=0,s=i.length;r<s;++r)n.push(i[r])}while(n.length)}};var Cje={depth:-1},Zee={},AP={};function Eje(e){return e.id}function Sje(e){return e.parentId}function ete(){var n,e=Eje,t=Sje;function i(r){var l,u,c,d,f,h,p,g,s=Array.from(r),o=e,a=t,m=new Map;if(null!=n){const _=s.map((b,D)=>function xje(e){let t=(e=`${e}`).length;return MP(e,t-1)&&!MP(e,t-2)&&(e=e.slice(0,-1)),"/"===e[0]?e:`/${e}`}(n(b,D,r))),y=_.map(tte),v=new Set(_).add("");for(const b of y)v.has(b)||(v.add(b),_.push(b),y.push(tte(b)),s.push(AP));o=(b,D)=>_[D],a=(b,D)=>y[D]}for(c=0,l=s.length;c<l;++c)h=s[c]=new _m(u=s[c]),null!=(p=o(u,c,r))&&(p+="")&&(g=h.id=p,m.set(g,m.has(g)?Zee:h)),null!=(p=a(u,c,r))&&(p+="")&&(h.parent=p);for(c=0;c<l;++c)if(p=(h=s[c]).parent){if(!(f=m.get(p)))throw new Error("missing: "+p);if(f===Zee)throw new Error("ambiguous: "+p);f.children?f.children.push(h):f.children=[h],h.parent=f}else{if(d)throw new Error("multiple roots");d=h}if(!d)throw new Error("no root");if(null!=n){for(;d.data===AP&&1===d.children.length;)d=d.children[0],--l;for(let _=s.length-1;_>=0&&(h=s[_]).data===AP;--_)h.data=null}if(d.parent=Cje,d.eachBefore(function(_){_.depth=_.parent.depth+1,--l}).eachBefore($ee),d.parent=null,l>0)throw new Error("cycle");return d}return i.id=function(r){return arguments.length?(e=ME(r),i):e},i.parentId=function(r){return arguments.length?(t=ME(r),i):t},i.path=function(r){return arguments.length?(n=ME(r),i):n},i}function tte(e){let t=e.length;if(t<2)return"";for(;--t>1&&!MP(e,t););return e.slice(0,t)}function MP(e,t){if("/"===e[t]){let n=0;for(;t>0&&"\\"===e[--t];)++n;if(0==(1&n))return!0}return!1}function Aje(e,t){return e.parent===t.parent?1:2}function TP(e){var t=e.children;return t?t[0]:e.t}function OP(e){var t=e.children;return t?t[t.length-1]:e.t}function Mje(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function Oje(e,t,n){return e.a.parent===t.parent?e.a:n}function NE(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function Ije(e,t){return e.parent===t.parent?1:2}function Fje(e,t){return e+t.x}function Lje(e,t){return Math.max(e,t.y)}function kE(e,t,n,i,r){for(var o,s=e.children,a=-1,l=s.length,u=e.value&&(r-n)/e.value;++a<l;)(o=s[a]).x0=t,o.x1=i,o.y0=n,o.y1=n+=o.value*u}NE.prototype=Object.create(_m.prototype);var nte=(1+Math.sqrt(5))/2;function ite(e,t,n,i,r,s){for(var l,u,h,p,m,_,y,v,b,D,C,o=[],a=t.children,c=0,d=0,f=a.length,g=t.value;c<f;){h=r-n,p=s-i;do{m=a[d++].value}while(!m&&d<f);for(_=y=m,C=m*m*(D=Math.max(p/h,h/p)/(g*e)),b=Math.max(y/C,C/_);d<f;++d){if(m+=u=a[d].value,u<_&&(_=u),u>y&&(y=u),C=m*m*D,(v=Math.max(y/C,C/_))>b){m-=u;break}b=v}o.push(l={value:m,dice:h<p,children:a.slice(c,d)}),l.dice?yv(l,n,i,r,g?i+=p*m/g:s):kE(l,n,i,g?n+=h*m/g:r,s),g-=m,c=d}return o}const rte=function e(t){function n(i,r,s,o,a){ite(t,i,r,s,o,a)}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(nte),Uje=function e(t){function n(i,r,s,o,a){if((l=i._squarify)&&l.ratio===t)for(var l,u,c,d,h,f=-1,p=l.length,g=i.value;++f<p;){for(c=(u=l[f]).children,d=u.value=0,h=c.length;d<h;++d)u.value+=c[d].value;u.dice?yv(u,r,s,o,g?s+=(a-s)*u.value/g:a):kE(u,r,s,g?r+=(o-r)*u.value/g:o,a),g-=u.value}else i._squarify=l=ite(t,i,r,s,o,a),l.ratio=t}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(nte);function NP(e,t,n){const i={};return e.each(r=>{const s=r.data;n(s)&&(i[t(s)]=r)}),e.lookup=i,e}function kP(e){Q.call(this,null,e)}kP.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const qje=e=>e.values;function Gje(){const e=[],t={entries:r=>i(n(r,0),0),key:r=>(e.push(r),t)};function n(r,s){if(s>=e.length)return r;const o=r.length,a=e[s++],l={},u={};let d,f,h,c=-1;for(;++c<o;)d=a(f=r[c])+"",(h=l[d])?h.push(f):l[d]=[f];for(d in l)u[d]=n(l[d],s);return u}function i(r,s){if(++s>e.length)return r;const o=[];for(const a in r)o.push({key:a,values:i(r[a],s)});return o}return t}function Zu(e){Q.call(this,null,e)}fe(kP,Q,{transform(e,t){t.source||te("Nest transform requires an upstream data source.");var n=e.generate,i=e.modified(),r=t.clone(),s=this.value;return(!s||i||t.changed())&&(s&&s.each(o=>{o.children&&SD(o.data)&&r.rem.push(o.data)}),this.value=s=EP({values:we(e.keys).reduce((o,a)=>(o.key(a),o),Gje()).entries(r.source)},qje),n&&s.each(o=>{o.children&&(o=Ut(o.data),r.add.push(o),r.source.push(o))}),NP(s,je,je)),r.source.root=s,r}});const Wje=(e,t)=>e.parent===t.parent?1:2;fe(Zu,Q,{transform(e,t){(!t.source||!t.source.root)&&te(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),i=this.fields,r=t.source.root,s=e.as||i;e.field?r.sum(e.field):r.count(),e.sort&&r.sort(Xf(e.sort,o=>o.data)),function Yje(e,t,n){for(let i,r=0,s=t.length;r<s;++r)i=t[r],i in n&&e[i](n[i])}(n,this.params,e),n.separation&&n.separation(!1!==e.separation?Wje:Ag);try{this.value=n(r)}catch(o){te(o)}return r.each(o=>function Kje(e,t,n){const i=e.data,r=t.length-1;for(let s=0;s<r;++s)i[n[s]]=e[t[s]];i[n[r]]=e.children?e.children.length:0}(o,i,s)),t.reflow(e.modified()).modifies(s).modifies("leaf")}});const IP=["x","y","r","depth","children"];function RP(e){Zu.call(this,e)}RP.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:IP.length,default:IP}]},fe(RP,Zu,{layout:function wje(){var e=null,t=1,n=1,i=yh;function r(s){const o=function pje(){let e=1;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296}();return s.x=t/2,s.y=n/2,e?s.eachBefore(Jee(e)).eachAfter(xP(i,.5,o)).eachBefore(Xee(1)):s.eachBefore(Jee(bje)).eachAfter(xP(yh,1,o)).eachAfter(xP(i,s.r/Math.min(t,n),o)).eachBefore(Xee(Math.min(t,n)/(2*s.r))),s}return r.radius=function(s){return arguments.length?(e=ME(s),r):e},r.size=function(s){return arguments.length?(t=+s[0],n=+s[1],r):[t,n]},r.padding=function(s){return arguments.length?(i="function"==typeof s?s:ym(+s),r):i},r},params:["radius","size","padding"],fields:IP});const FP=["x0","y0","x1","y1","depth","children"];function PP(e){Zu.call(this,e)}function LP(e){Q.call(this,null,e)}PP.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:FP.length,default:FP}]},fe(PP,Zu,{layout:function Dje(){var e=1,t=1,n=0,i=!1;function r(o){var a=o.height+1;return o.x0=o.y0=n,o.x1=e,o.y1=t/a,o.eachBefore(function s(o,a){return function(l){l.children&&yv(l,l.x0,o*(l.depth+1)/a,l.x1,o*(l.depth+2)/a);var u=l.x0,c=l.y0,d=l.x1-n,f=l.y1-n;d<u&&(u=d=(u+d)/2),f<c&&(c=f=(c+f)/2),l.x0=u,l.y0=c,l.x1=d,l.y1=f}}(t,a)),i&&o.eachBefore(Qee),o}return r.round=function(o){return arguments.length?(i=!!o,r):i},r.size=function(o){return arguments.length?(e=+o[0],t=+o[1],r):[e,t]},r.padding=function(o){return arguments.length?(n=+o,r):n},r},params:["size","round","padding"],fields:FP}),LP.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},fe(LP,Q,{transform(e,t){t.source||te("Stratify transform requires an upstream data source.");let n=this.value;const i=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),s=!n||i||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),s&&(n=r.source.length?NP(ete().id(e.key).parentId(e.parentKey)(r.source),e.key,Fo):NP(ete()([{}]),e.key,e.key)),r.source.root=this.value=n,r}});const ste={tidy:function kje(){var e=Aje,t=1,n=1,i=null;function r(u){var c=function Nje(e){for(var n,r,s,o,a,t=new NE(e,0),i=[t];n=i.pop();)if(s=n._.children)for(n.children=new Array(a=s.length),o=a-1;o>=0;--o)i.push(r=n.children[o]=new NE(s[o],o)),r.parent=n;return(t.parent=new NE(null,0)).children=[t],t}(u);if(c.eachAfter(s),c.parent.m=-c.z,c.eachBefore(o),i)u.eachBefore(l);else{var d=u,f=u,h=u;u.eachBefore(function(y){y.x<d.x&&(d=y),y.x>f.x&&(f=y),y.depth>h.depth&&(h=y)});var p=d===f?1:e(d,f)/2,g=p-d.x,m=t/(f.x+p+g),_=n/(h.depth||1);u.eachBefore(function(y){y.x=(y.x+g)*m,y.y=y.depth*_})}return u}function s(u){var c=u.children,d=u.parent.children,f=u.i?d[u.i-1]:null;if(c){!function Tje(e){for(var s,t=0,n=0,i=e.children,r=i.length;--r>=0;)(s=i[r]).z+=t,s.m+=t,t+=s.s+(n+=s.c)}(u);var h=(c[0].z+c[c.length-1].z)/2;f?(u.z=f.z+e(u._,f._),u.m=u.z-h):u.z=h}else f&&(u.z=f.z+e(u._,f._));u.parent.A=function a(u,c,d){if(c){for(var b,f=u,h=u,p=c,g=f.parent.children[0],m=f.m,_=h.m,y=p.m,v=g.m;p=OP(p),f=TP(f),p&&f;)g=TP(g),(h=OP(h)).a=u,(b=p.z+y-f.z-m+e(p._,f._))>0&&(Mje(Oje(p,u,d),u,b),m+=b,_+=b),y+=p.m,m+=f.m,v+=g.m,_+=h.m;p&&!OP(h)&&(h.t=p,h.m+=y-_),f&&!TP(g)&&(g.t=f,g.m+=m-v,d=u)}return d}(u,f,u.parent.A||d[0])}function o(u){u._.x=u.z+u.parent.m,u.m+=u.parent.m}function l(u){u.x*=t,u.y=u.depth*n}return r.separation=function(u){return arguments.length?(e=u,r):e},r.size=function(u){return arguments.length?(i=!1,t=+u[0],n=+u[1],r):i?null:[t,n]},r.nodeSize=function(u){return arguments.length?(i=!0,t=+u[0],n=+u[1],r):i?[t,n]:null},r},cluster:function $je(){var e=Ije,t=1,n=1,i=!1;function r(s){var o,a=0;s.eachAfter(function(f){var h=f.children;h?(f.x=function Rje(e){return e.reduce(Fje,0)/e.length}(h),f.y=function Pje(e){return 1+e.reduce(Lje,0)}(h)):(f.x=o?a+=e(f,o):0,f.y=0,o=f)});var l=function jje(e){for(var t;t=e.children;)e=t[0];return e}(s),u=function Bje(e){for(var t;t=e.children;)e=t[t.length-1];return e}(s),c=l.x-e(l,u)/2,d=u.x+e(u,l)/2;return s.eachAfter(i?function(f){f.x=(f.x-s.x)*t,f.y=(s.y-f.y)*n}:function(f){f.x=(f.x-c)/(d-c)*t,f.y=(1-(s.y?f.y/s.y:1))*n})}return r.separation=function(s){return arguments.length?(e=s,r):e},r.size=function(s){return arguments.length?(i=!1,t=+s[0],n=+s[1],r):i?null:[t,n]},r.nodeSize=function(s){return arguments.length?(i=!0,t=+s[0],n=+s[1],r):i?[t,n]:null},r}},jP=["x","y","depth","children"];function BP(e){Zu.call(this,e)}function $P(e){Q.call(this,[],e)}BP.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:jP.length,default:jP}]},fe(BP,Zu,{layout(e){const t=e||"tidy";if(Fe(ste,t))return ste[t]();te("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:jP}),$P.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},fe($P,Q,{transform(e,t){const n=this.value,i=t.source&&t.source.root,r=t.fork(t.NO_SOURCE),s={};return i||te("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(r.rem=n,t.visit(t.SOURCE,o=>s[je(o)]=1),i.each(o=>{const a=o.data,l=o.parent&&o.parent.data;l&&s[je(a)]&&s[je(l)]&&r.add.push(Ut({source:l,target:a}))}),this.value=r.add):t.changed(t.MOD)&&(t.visit(t.MOD,o=>s[je(o)]=1),n.forEach(o=>{(s[je(o.source)]||s[je(o.target)])&&r.mod.push(o)})),r}});const ote={binary:function Vje(e,t,n,i,r){var o,l,s=e.children,a=s.length,u=new Array(a+1);for(u[0]=l=o=0;o<a;++o)u[o+1]=l+=s[o].value;!function c(d,f,h,p,g,m,_){if(d>=f-1){var y=s[d];return y.x0=p,y.y0=g,y.x1=m,void(y.y1=_)}for(var v=u[d],b=h/2+v,D=d+1,C=f-1;D<C;){var w=D+C>>>1;u[w]<b?D=w+1:C=w}b-u[D-1]<u[D]-b&&d+1<D&&--D;var E=u[D]-v,N=h-E;if(m-p>_-g){var k=h?(p*N+m*E)/h:m;c(d,D,E,p,g,k,_),c(D,f,N,k,g,m,_)}else{var I=h?(g*N+_*E)/h:_;c(d,D,E,p,g,m,I),c(D,f,N,p,I,m,_)}}(0,a,e.value,t,n,i,r)},dice:yv,slice:kE,slicedice:function Hje(e,t,n,i,r){(1&e.depth?kE:yv)(e,t,n,i,r)},squarify:rte,resquarify:Uje},VP=["x0","y0","x1","y1","depth","children"];function HP(e){Zu.call(this,e)}HP.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:VP.length,default:VP}]},fe(HP,Zu,{layout(){const e=function zje(){var e=rte,t=!1,n=1,i=1,r=[0],s=yh,o=yh,a=yh,l=yh,u=yh;function c(f){return f.x0=f.y0=0,f.x1=n,f.y1=i,f.eachBefore(d),r=[0],t&&f.eachBefore(Qee),f}function d(f){var h=r[f.depth],p=f.x0+h,g=f.y0+h,m=f.x1-h,_=f.y1-h;m<p&&(p=m=(p+m)/2),_<g&&(g=_=(g+_)/2),f.x0=p,f.y0=g,f.x1=m,f.y1=_,f.children&&(h=r[f.depth+1]=s(f)/2,p+=u(f)-h,g+=o(f)-h,(m-=a(f)-h)<p&&(p=m=(p+m)/2),(_-=l(f)-h)<g&&(g=_=(g+_)/2),e(f,p,g,m,_))}return c.round=function(f){return arguments.length?(t=!!f,c):t},c.size=function(f){return arguments.length?(n=+f[0],i=+f[1],c):[n,i]},c.tile=function(f){return arguments.length?(e=Vee(f),c):e},c.padding=function(f){return arguments.length?c.paddingInner(f).paddingOuter(f):c.paddingInner()},c.paddingInner=function(f){return arguments.length?(s="function"==typeof f?f:ym(+f),c):s},c.paddingOuter=function(f){return arguments.length?c.paddingTop(f).paddingRight(f).paddingBottom(f).paddingLeft(f):c.paddingTop()},c.paddingTop=function(f){return arguments.length?(o="function"==typeof f?f:ym(+f),c):o},c.paddingRight=function(f){return arguments.length?(a="function"==typeof f?f:ym(+f),c):a},c.paddingBottom=function(f){return arguments.length?(l="function"==typeof f?f:ym(+f),c):l},c.paddingLeft=function(f){return arguments.length?(u="function"==typeof f?f:ym(+f),c):u},c}();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{Fe(ote,t)?e.tile(ote[t]):te("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:VP});const UP=4278190080;function zP(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function IE(e,t,n){if(!t.length)return;const i=t[0].mark.marktype;"group"===i?t.forEach(r=>{r.items.forEach(s=>IE(e,s.items,n))}):Zs[i].draw(e,{items:n?t.map(Qje):t})}function Qje(e){const t=xD(e,{});return t.stroke&&0!==t.strokeOpacity||t.fill&&0!==t.fillOpacity?yce(_ce({},t),{strokeOpacity:1,stroke:"#000",fillOpacity:0}):t}const Od=new Uint32Array(33),Ba=new Uint32Array(33);Ba[0]=0,Od[0]=~Ba[0];for(let e=1;e<=32;++e)Ba[e]=Ba[e-1]<<1|1,Od[e]=~Ba[e];function RE(e,t,n,i,r,s){let o=n/2;return e-o<0||e+o>r||t-(o=i/2)<0||t+o>s}function Nd(e,t,n,i,r,s,o,a){const l=r*s/(2*i),u=e(t-l),c=e(t+l),d=e(n-(s/=2)),f=e(n+s);return o.outOfBounds(u,d,c,f)||o.getRange(u,d,c,f)||a&&a.getRange(u,d,c,f)}const i5e=[-1,-1,1,1],r5e=[-1,1,-1,1],o5e=["right","center","left"],a5e=["bottom","middle","top"];function ate(e,t,n,i,r,s,o,a,l,u,c,d){return!(r.outOfBounds(e,n,t,i)||(d&&s||r).getRange(e,n,t,i))}const u5e={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},c5e={naive:function t5e(e,t,n,i){const r=e.width,s=e.height;return function(o){const a=o.datum.datum.items[i].items,l=a.length,u=o.datum.fontSize,c=Ra.width(o.datum,o.datum.text);let f,h,p,g,m,_,y,d=0;for(let v=0;v<l;++v)f=a[v].x,p=a[v].y,h=void 0===a[v].x2?f:a[v].x2,g=void 0===a[v].y2?p:a[v].y2,m=(f+h)/2,_=(p+g)/2,y=Math.abs(h-f+g-p),y>=d&&(d=y,o.x=m,o.y=_);return m=c/2,_=u/2,f=o.x-m,h=o.x+m,p=o.y-_,g=o.y+_,o.align="center",f<0&&h<=r?o.align="left":0<=f&&r<h&&(o.align="right"),o.baseline="middle",p<0&&g<=s?o.baseline="top":0<=p&&s<g&&(o.baseline="bottom"),!0}},"reduced-search":function n5e(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1];function l(u,c,d,f,h){const p=e.invert(u),g=e.invert(c);let y,m=d,_=s;if(!RE(p,g,f,h,r,s)&&!Nd(e,p,g,h,f,m,o,a)&&!Nd(e,p,g,h,f,h,o,null)){for(;_-m>=1;)y=(m+_)/2,Nd(e,p,g,h,f,y,o,a)?_=y:m=y;if(m>d)return[p,g,m,!0]}}return function(u){const c=u.datum.datum.items[i].items,d=c.length,f=u.datum.fontSize,h=Ra.width(u.datum,u.datum.text);let y,v,b,D,C,w,E,N,k,I,L,B,T,A,x,F,O,p=n?f:0,g=!1,m=!1,_=0;for(let j=0;j<d;++j){for(y=c[j].x,b=c[j].y,v=void 0===c[j].x2?y:c[j].x2,D=void 0===c[j].y2?b:c[j].y2,y>v&&(O=y,y=v,v=O),b>D&&(O=b,b=D,D=O),k=e(y),L=e(v),I=~~((k+L)/2),B=e(b),A=e(D),T=~~((B+A)/2),E=I;E>=k;--E)for(N=T;N>=B;--N)F=l(E,N,p,h,f),F&&([u.x,u.y,p,g]=F);for(E=I;E<=L;++E)for(N=T;N<=A;++N)F=l(E,N,p,h,f),F&&([u.x,u.y,p,g]=F);!g&&!n&&(x=Math.abs(v-y+D-b),C=(y+v)/2,w=(b+D)/2,x>=_&&!RE(C,w,h,f,r,s)&&!Nd(e,C,w,f,h,f,o,null)&&(_=x,u.x=C,u.y=w,m=!0))}return!(!g&&!m||(C=h/2,w=f/2,o.setRange(e(u.x-C),e(u.y-w),e(u.x+C),e(u.y+w)),u.align="center",u.baseline="middle",0))}},floodfill:function s5e(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1],l=e.bitmap();return function(u){const c=u.datum.datum.items[i].items,d=c.length,f=u.datum.fontSize,h=Ra.width(u.datum,u.datum.text),p=[];let v,b,D,C,w,E,N,k,I,L,B,T,g=n?f:0,m=!1,_=!1,y=0;for(let A=0;A<d;++A){for(v=c[A].x,D=c[A].y,b=void 0===c[A].x2?v:c[A].x2,C=void 0===c[A].y2?D:c[A].y2,p.push([e((v+b)/2),e((D+C)/2)]);p.length;)if([N,k]=p.pop(),!(o.get(N,k)||a.get(N,k)||l.get(N,k))){l.set(N,k);for(let x=0;x<4;++x)w=N+i5e[x],E=k+r5e[x],l.outOfBounds(w,E,w,E)||p.push([w,E]);if(w=e.invert(N),E=e.invert(k),I=g,L=s,!RE(w,E,h,f,r,s)&&!Nd(e,w,E,f,h,I,o,a)&&!Nd(e,w,E,f,h,f,o,null)){for(;L-I>=1;)B=(I+L)/2,Nd(e,w,E,f,h,B,o,a)?L=B:I=B;I>g&&(u.x=w,u.y=E,g=I,m=!0)}}!m&&!n&&(T=Math.abs(b-v+C-D),w=(v+b)/2,E=(D+C)/2,T>=y&&!RE(w,E,h,f,r,s)&&!Nd(e,w,E,f,h,f,o,null)&&(y=T,u.x=w,u.y=E,_=!0))}return!(!m&&!_||(w=h/2,E=f/2,o.setRange(e(u.x-w),e(u.y-E),e(u.x+w),e(u.y+E)),u.align="center",u.baseline="middle",0))}}};function d5e(e,t,n,i,r,s,o,a,l,u,c){if(!e.length)return e;const d=Math.max(i.length,r.length),f=function f5e(e,t){const n=new Float64Array(t),i=e.length;for(let r=0;r<i;++r)n[r]=e[r]||0;for(let r=i;r<t;++r)n[r]=n[i-1];return n}(i,d),h=function h5e(e,t){const n=new Int8Array(t),i=e.length;for(let r=0;r<i;++r)n[r]|=u5e[e[r]];for(let r=i;r<t;++r)n[r]=n[i-1];return n}(r,d),p=function p5e(e){return e&&e.mark&&e.mark.marktype}(e[0].datum),g="group"===p&&e[0].datum.items[l].marktype,m="area"===g,_=function g5e(e,t,n,i){const r=s=>[s.x,s.x,s.x,s.y,s.y,s.y];return e?"line"===e||"area"===e?s=>r(s.datum):"line"===t?s=>{const o=s.datum.items[i].items;return r(o.length?o["start"===n?0:o.length-1]:{x:NaN,y:NaN})}:s=>{const o=s.datum.bounds;return[o.x1,(o.x1+o.x2)/2,o.x2,o.y1,(o.y1+o.y2)/2,o.y2]}:r}(p,g,a,l),y=null===u||u===1/0,v=m&&"naive"===c;let b=-1,D=-1;const C=e.map(k=>{const I=y?Ra.width(k,k.text):void 0;return b=Math.max(b,I),D=Math.max(D,k.fontSize),{datum:k,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:_(k),textWidth:I}});u=null===u||u===1/0?Math.max(b,D)+Math.max(...i):u;const w=function e5e(e,t,n){const i=Math.max(1,Math.sqrt(e*t/1e6)),r=~~((e+2*n+i)/i),s=~~((t+2*n+i)/i),o=a=>~~((a+n)/i);return o.invert=a=>a*i-n,o.bitmap=()=>function Zje(e,t){const n=new Uint32Array(~~((e*t+32)/32));function i(s,o){n[s]|=o}function r(s,o){n[s]&=o}return{array:n,get:(s,o)=>{const a=o*e+s;return n[a>>>5]&1<<(31&a)},set:(s,o)=>{const a=o*e+s;i(a>>>5,1<<(31&a))},clear:(s,o)=>{const a=o*e+s;r(a>>>5,~(1<<(31&a)))},getRange:(s,o,a,l)=>{let c,d,f,h,u=l;for(;u>=o;--u)if(c=u*e+s,d=u*e+a,f=c>>>5,h=d>>>5,f===h){if(n[f]&Od[31&c]&Ba[1+(31&d)])return!0}else{if(n[f]&Od[31&c]||n[h]&Ba[1+(31&d)])return!0;for(let p=f+1;p<h;++p)if(n[p])return!0}return!1},setRange:(s,o,a,l)=>{let u,c,d,f,h;for(;o<=l;++o)if(u=o*e+s,c=o*e+a,d=u>>>5,f=c>>>5,d===f)i(d,Od[31&u]&Ba[1+(31&c)]);else for(i(d,Od[31&u]),i(f,Ba[1+(31&c)]),h=d+1;h<f;++h)i(h,4294967295)},clearRange:(s,o,a,l)=>{let u,c,d,f,h;for(;o<=l;++o)if(u=o*e+s,c=o*e+a,d=u>>>5,f=c>>>5,d===f)r(d,Ba[31&u]|Od[1+(31&c)]);else for(r(d,Ba[31&u]),r(f,Od[1+(31&c)]),h=d+1;h<f;++h)r(h,0)},outOfBounds:(s,o,a,l)=>s<0||o<0||l>=t||a>=e}}(r,s),o.ratio=i,o.padding=n,o.width=e,o.height=t,o}(t[0],t[1],u);let E;if(!v){n&&C.sort((L,B)=>n(L.datum,B.datum));let k=!1;for(let L=0;L<h.length&&!k;++L)k=5===h[L]||f[L]<0;const I=(p&&o||m)&&e.map(L=>L.datum);E=s.length||I?function Xje(e,t,n,i,r){const s=e.width,o=e.height,a=i||r,l=ld(s,o).getContext("2d"),u=ld(s,o).getContext("2d"),c=a&&ld(s,o).getContext("2d");n.forEach(E=>IE(l,E,!1)),IE(u,t,!1),a&&IE(c,t,!0);const d=zP(l,s,o),f=zP(u,s,o),h=a&&zP(c,s,o),p=e.bitmap(),g=a&&e.bitmap();let m,_,y,v,b,D,C,w;for(_=0;_<o;++_)for(m=0;m<s;++m)b=_*s+m,D=d[b]&UP,w=f[b]&UP,C=a&&h[b]&UP,(D||C||w)&&(y=e(m),v=e(_),!r&&(D||w)&&p.set(y,v),a&&(D||C)&&g.set(y,v));return[p,g]}(w,I||[],s,k,m):function Jje(e,t){const n=e.bitmap();return(t||[]).forEach(i=>n.set(e(i.boundary[0]),e(i.boundary[3]))),[n,void 0]}(w,o&&C)}const N=m?c5e[c](w,E,o,l):function l5e(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1],l=i.length;return function(u){var c;const d=u.boundary,f=u.datum.fontSize;if(d[2]<0||d[5]<0||d[0]>r||d[3]>s)return!1;let p,g,m,_,y,v,b,D,C,w,E,N,k,I,L,h=null!==(c=u.textWidth)&&void 0!==c?c:0;for(let B=0;B<l;++B){if(p=(3&n[B])-1,g=(n[B]>>>2&3)-1,m=0===p&&0===g||i[B]<0,_=p&&g?Math.SQRT1_2:1,y=i[B]<0?-1:1,v=d[1+p]+i[B]*p*_,E=d[4+g]+y*f*g/2+i[B]*g*_,D=E-f/2,C=E+f/2,N=e(v),I=e(D),L=e(C),!h){if(!ate(N,N,I,L,o,a,0,0,0,0,0,m))continue;h=Ra.width(u.datum,u.datum.text)}if(w=v+y*h*p/2,v=w-h/2,b=w+h/2,N=e(v),k=e(b),ate(N,k,I,L,o,a,0,0,0,0,0,m))return u.x=p?p*y<0?b:v:w,u.y=g?g*y<0?C:D:E,u.align=o5e[p*y+1],u.baseline=a5e[g*y+1],o.setRange(N,I,k,L),!0}return!1}}(w,E,h,f);return C.forEach(k=>k.opacity=+N(k)),C}const XP=["x","y","opacity","align","baseline"],lte=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function QP(e){Q.call(this,null,e)}function ute(e,t){var r,s,o,a,l,u,n=[],i=function(c){return c(a)};if(null==t)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],(u=r[l=t.map(i)])||(r[l]=u=[],u.dims=l,n.push(u)),u.push(a);return n}function ZP(e){Q.call(this,null,e)}QP.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:lte},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:XP.length,default:XP}]},fe(QP,Q,{transform(e,t){const i=e.modified();if(!(i||t.changed(t.ADD_REM)||function n(s){const o=e[s];return st(o)&&t.modified(o.fields)}("sort")))return;(!e.size||2!==e.size.length)&&te("Size parameter should be specified as a [width, height] array.");const r=e.as||XP;return d5e(t.materialize(t.SOURCE).source||[],e.size,e.sort,we(null==e.offset?1:e.offset),we(e.anchor||lte),e.avoidMarks||[],!1!==e.avoidBaseMark,e.lineAnchor||"end",e.markIndex||0,void 0===e.padding?0:e.padding,e.method||"naive").forEach(s=>{const o=s.datum;o[r[0]]=s.x,o[r[1]]=s.y,o[r[2]]=s.opacity,o[r[3]]=s.align,o[r[4]]=s.baseline}),t.reflow(i).modifies(r)}}),ZP.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},fe(ZP,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=ute(t.materialize(t.SOURCE).source,e.groupby),s=(e.groupby||[]).map(Gn),o=s.length,a=e.as||[Gn(e.x),Gn(e.y)],l=[];r.forEach(u=>{DY(u,e.x,e.y,e.bandwidth||.3).forEach(c=>{const d={};for(let f=0;f<o;++f)d[s[f]]=u.dims[f];d[a[0]]=c[0],d[a[1]]=c[1],l.push(Ut(d))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});const e3={linear:Jk,log:mY,exp:_Y,pow:yY,quad:Xk,poly:vY};function t3(e){Q.call(this,null,e)}t3.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(e3)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},fe(t3,Q,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=ute(t.materialize(t.SOURCE).source,e.groupby),s=(e.groupby||[]).map(Gn),o=e.method||"linear",a=e.order||3,l=((e,t)=>"poly"===e?t:"quad"===e?2:1)(o,a),u=e.as||[Gn(e.x),Gn(e.y)],c=e3[o],d=[];let f=e.extent;Fe(e3,o)||te("Invalid regression method: "+o),null!=f&&"log"===o&&f[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),f=null),r.forEach(h=>{if(h.length<=l)return void t.dataflow.warn("Skipping regression with more parameters than data points.");const g=c(h,e.x,e.y,a);if(e.params)return void d.push(Ut({keys:h.dims,coef:g.coef,rSquared:g.rSquared}));const m=f||Al(h,e.x),_=y=>{const v={};for(let b=0;b<s.length;++b)v[s[b]]=h.dims[b];v[u[0]]=y[0],v[u[1]]=y[1],d.push(Ut(v))};"linear"===o?m.forEach(y=>_([y,g.predict(y)])):LD(g.predict,m,25,200).forEach(_)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=d}return n}});const xi=134217729;function bv(e,t,n,i,r){let s,o,a,l,u=t[0],c=i[0],d=0,f=0;c>u==c>-u?(s=u,u=t[++d]):(s=c,c=i[++f]);let h=0;if(d<e&&f<n)for(c>u==c>-u?(o=u+s,a=s-(o-u),u=t[++d]):(o=c+s,a=s-(o-c),c=i[++f]),s=o,0!==a&&(r[h++]=a);d<e&&f<n;)c>u==c>-u?(o=s+u,l=o-s,a=s-(o-l)+(u-l),u=t[++d]):(o=s+c,l=o-s,a=s-(o-l)+(c-l),c=i[++f]),s=o,0!==a&&(r[h++]=a);for(;d<e;)o=s+u,l=o-s,a=s-(o-l)+(u-l),u=t[++d],s=o,0!==a&&(r[h++]=a);for(;f<n;)o=s+c,l=o-s,a=s-(o-l)+(c-l),c=i[++f],s=o,0!==a&&(r[h++]=a);return(0!==s||0===h)&&(r[h++]=s),h}function ue(e){return new Float64Array(e)}const vm=ue(4),cte=ue(8),dte=ue(12),fte=ue(16),Xr=ue(4);function FE(e,t,n,i,r,s){const o=(t-s)*(n-r),a=(e-r)*(i-s),l=o-a;if(0===o||0===a||o>0!=a>0)return l;const u=Math.abs(o+a);return Math.abs(l)>=33306690738754716e-32*u?l:-function D5e(e,t,n,i,r,s,o){let a,l,u,c,d,f,h,p,g,m,_,y,v,b,D,C,w,E;const N=e-r,k=n-r,I=t-s,L=i-s;b=N*L,f=xi*N,h=f-(f-N),p=N-h,f=xi*L,g=f-(f-L),m=L-g,D=p*m-(b-h*g-p*g-h*m),C=I*k,f=xi*I,h=f-(f-I),p=I-h,f=xi*k,g=f-(f-k),m=k-g,w=p*m-(C-h*g-p*g-h*m),_=D-w,d=D-_,vm[0]=D-(_+d)+(d-w),y=b+_,d=y-b,v=b-(y-d)+(_-d),_=v-C,d=v-_,vm[1]=v-(_+d)+(d-C),E=y+_,d=E-y,vm[2]=y-(E-d)+(_-d),vm[3]=E;let B=function y5e(e,t){let n=t[0];for(let i=1;i<e;i++)n+=t[i];return n}(4,vm),T=22204460492503146e-32*o;if(B>=T||-B>=T||(d=e-N,a=e-(N+d)+(d-r),d=n-k,u=n-(k+d)+(d-r),d=t-I,l=t-(I+d)+(d-s),d=i-L,c=i-(L+d)+(d-s),0===a&&0===l&&0===u&&0===c)||(T=11093356479670487e-47*o+33306690738754706e-32*Math.abs(B),B+=N*c+L*a-(I*u+k*l),B>=T||-B>=T))return B;b=a*L,f=xi*a,h=f-(f-a),p=a-h,f=xi*L,g=f-(f-L),m=L-g,D=p*m-(b-h*g-p*g-h*m),C=l*k,f=xi*l,h=f-(f-l),p=l-h,f=xi*k,g=f-(f-k),m=k-g,w=p*m-(C-h*g-p*g-h*m),_=D-w,d=D-_,Xr[0]=D-(_+d)+(d-w),y=b+_,d=y-b,v=b-(y-d)+(_-d),_=v-C,d=v-_,Xr[1]=v-(_+d)+(d-C),E=y+_,d=E-y,Xr[2]=y-(E-d)+(_-d),Xr[3]=E;const A=bv(4,vm,4,Xr,cte);b=N*c,f=xi*N,h=f-(f-N),p=N-h,f=xi*c,g=f-(f-c),m=c-g,D=p*m-(b-h*g-p*g-h*m),C=I*u,f=xi*I,h=f-(f-I),p=I-h,f=xi*u,g=f-(f-u),m=u-g,w=p*m-(C-h*g-p*g-h*m),_=D-w,d=D-_,Xr[0]=D-(_+d)+(d-w),y=b+_,d=y-b,v=b-(y-d)+(_-d),_=v-C,d=v-_,Xr[1]=v-(_+d)+(d-C),E=y+_,d=E-y,Xr[2]=y-(E-d)+(_-d),Xr[3]=E;const x=bv(A,cte,4,Xr,dte);b=a*c,f=xi*a,h=f-(f-a),p=a-h,f=xi*c,g=f-(f-c),m=c-g,D=p*m-(b-h*g-p*g-h*m),C=l*u,f=xi*l,h=f-(f-l),p=l-h,f=xi*u,g=f-(f-u),m=u-g,w=p*m-(C-h*g-p*g-h*m),_=D-w,d=D-_,Xr[0]=D-(_+d)+(d-w),y=b+_,d=y-b,v=b-(y-d)+(_-d),_=v-C,d=v-_,Xr[1]=v-(_+d)+(d-C),E=y+_,d=E-y,Xr[2]=y-(E-d)+(_-d),Xr[3]=E;const F=bv(x,dte,4,Xr,fte);return fte[F-1]}(e,t,n,i,r,s,u)}ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(8),ue(8),ue(8),ue(4),ue(8),ue(8),ue(8),ue(12),ue(192),ue(192),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(8),ue(8),ue(8),ue(8),ue(8),ue(8),ue(8),ue(8),ue(8),ue(4),ue(4),ue(4),ue(8),ue(16),ue(16),ue(16),ue(32),ue(32),ue(48),ue(64),ue(1152),ue(1152),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(4),ue(24),ue(24),ue(24),ue(24),ue(24),ue(24),ue(24),ue(24),ue(24),ue(24),ue(1152),ue(1152),ue(1152),ue(1152),ue(1152),ue(2304),ue(2304),ue(3456),ue(5760),ue(8),ue(8),ue(8),ue(16),ue(24),ue(48),ue(48),ue(96),ue(192),ue(384),ue(384),ue(384),ue(768),ue(96),ue(96),ue(96),ue(1152);const Ite=Math.pow(2,-52),qE=new Uint32Array(512);class GE{static from(t,n=H5e,i=U5e){const r=t.length,s=new Float64Array(2*r);for(let o=0;o<r;o++){const a=t[o];s[2*o]=n(a),s[2*o+1]=i(a)}return new GE(s)}constructor(t){const n=t.length>>1;if(n>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(3*i),this._halfedges=new Int32Array(3*i),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:s}=this,o=t.length>>1;let a=1/0,l=1/0,u=-1/0,c=-1/0;for(let k=0;k<o;k++){const I=t[2*k],L=t[2*k+1];I<a&&(a=I),L<l&&(l=L),I>u&&(u=I),L>c&&(c=L),this._ids[k]=k}const d=(a+u)/2,f=(l+c)/2;let p,g,m,h=1/0;for(let k=0;k<o;k++){const I=M3(d,f,t[2*k],t[2*k+1]);I<h&&(p=k,h=I)}const _=t[2*p],y=t[2*p+1];h=1/0;for(let k=0;k<o;k++){if(k===p)continue;const I=M3(_,y,t[2*k],t[2*k+1]);I<h&&I>0&&(g=k,h=I)}let v=t[2*g],b=t[2*g+1],D=1/0;for(let k=0;k<o;k++){if(k===p||k===g)continue;const I=$5e(_,y,v,b,t[2*k],t[2*k+1]);I<D&&(m=k,D=I)}let C=t[2*m],w=t[2*m+1];if(D===1/0){for(let L=0;L<o;L++)this._dists[L]=t[2*L]-t[0]||t[2*L+1]-t[1];Am(this._ids,this._dists,0,o-1);const k=new Uint32Array(o);let I=0;for(let L=0,B=-1/0;L<o;L++){const T=this._ids[L];this._dists[T]>B&&(k[I++]=T,B=this._dists[T])}return this.hull=k.subarray(0,I),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(FE(_,y,v,b,C,w)<0){const k=g,I=v,L=b;g=m,v=C,b=w,m=k,C=I,w=L}const E=function V5e(e,t,n,i,r,s){const o=n-e,a=i-t,l=r-e,u=s-t,c=o*o+a*a,d=l*l+u*u,f=.5/(o*u-a*l);return{x:e+(u*c-a*d)*f,y:t+(o*d-l*c)*f}}(_,y,v,b,C,w);this._cx=E.x,this._cy=E.y;for(let k=0;k<o;k++)this._dists[k]=M3(t[2*k],t[2*k+1],E.x,E.y);Am(this._ids,this._dists,0,o-1),this._hullStart=p;let N=3;i[p]=n[m]=g,i[g]=n[p]=m,i[m]=n[g]=p,r[p]=0,r[g]=1,r[m]=2,s.fill(-1),s[this._hashKey(_,y)]=p,s[this._hashKey(v,b)]=g,s[this._hashKey(C,w)]=m,this.trianglesLen=0,this._addTriangle(p,g,m,-1,-1,-1);for(let I,L,k=0;k<this._ids.length;k++){const B=this._ids[k],T=t[2*B],A=t[2*B+1];if(k>0&&Math.abs(T-I)<=Ite&&Math.abs(A-L)<=Ite||(I=T,L=A,B===p||B===g||B===m))continue;let x=0;for(let z=0,q=this._hashKey(T,A);z<this._hashSize&&(x=s[(q+z)%this._hashSize],-1===x||x===i[x]);z++);x=n[x];let O,F=x;for(;O=i[F],FE(T,A,t[2*F],t[2*F+1],t[2*O],t[2*O+1])>=0;)if(F=O,F===x){F=-1;break}if(-1===F)continue;let j=this._addTriangle(F,B,i[F],-1,-1,r[F]);r[B]=this._legalize(j+2),r[F]=j,N++;let P=i[F];for(;O=i[P],FE(T,A,t[2*P],t[2*P+1],t[2*O],t[2*O+1])<0;)j=this._addTriangle(P,B,O,r[B],-1,r[P]),r[B]=this._legalize(j+2),i[P]=P,N--,P=O;if(F===x)for(;O=n[F],FE(T,A,t[2*O],t[2*O+1],t[2*F],t[2*F+1])<0;)j=this._addTriangle(O,B,F,-1,r[F],r[O]),this._legalize(j+2),r[O]=j,i[F]=F,N--,F=O;this._hullStart=n[B]=F,i[F]=n[P]=B,i[B]=P,s[this._hashKey(T,A)]=B,s[this._hashKey(t[2*F],t[2*F+1])]=F}this.hull=new Uint32Array(N);for(let k=0,I=this._hullStart;k<N;k++)this.hull[k]=I,I=i[I];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(function j5e(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:i,coords:r}=this;let s=0,o=0;for(;;){const a=i[t],l=t-t%3;if(o=l+(t+2)%3,-1===a){if(0===s)break;t=qE[--s];continue}const u=a-a%3,d=u+(a+2)%3,f=n[o],h=n[t],p=n[l+(t+1)%3],g=n[d];if(B5e(r[2*f],r[2*f+1],r[2*h],r[2*h+1],r[2*p],r[2*p+1],r[2*g],r[2*g+1])){n[t]=g,n[a]=f;const _=i[d];if(-1===_){let v=this._hullStart;do{if(this._hullTri[v]===d){this._hullTri[v]=t;break}v=this._hullPrev[v]}while(v!==this._hullStart)}this._link(t,_),this._link(a,i[o]),this._link(o,d);const y=u+(a+1)%3;s<qE.length&&(qE[s++]=y)}else{if(0===s)break;t=qE[--s]}}return o}_link(t,n){this._halfedges[t]=n,-1!==n&&(this._halfedges[n]=t)}_addTriangle(t,n,i,r,s,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=i,this._link(a,r),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function M3(e,t,n,i){const r=e-n,s=t-i;return r*r+s*s}function B5e(e,t,n,i,r,s,o,a){const l=e-o,u=t-a,c=n-o,d=i-a,f=r-o,h=s-a,g=c*c+d*d,m=f*f+h*h;return l*(d*m-g*h)-u*(c*m-g*f)+(l*l+u*u)*(c*h-d*f)<0}function $5e(e,t,n,i,r,s){const o=n-e,a=i-t,l=r-e,u=s-t,c=o*o+a*a,d=l*l+u*u,f=.5/(o*u-a*l),h=(u*c-a*d)*f,p=(o*d-l*c)*f;return h*h+p*p}function Am(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const s=e[r],o=t[s];let a=r-1;for(;a>=n&&t[e[a]]>o;)e[a+1]=e[a--];e[a+1]=s}else{let s=n+1,o=i;Ev(e,n+i>>1,s),t[e[n]]>t[e[i]]&&Ev(e,n,i),t[e[s]]>t[e[i]]&&Ev(e,s,i),t[e[n]]>t[e[s]]&&Ev(e,n,s);const a=e[s],l=t[a];for(;;){do{s++}while(t[e[s]]<l);do{o--}while(t[e[o]]>l);if(o<s)break;Ev(e,s,o)}e[n+1]=e[o],e[o]=a,i-s+1>=o-n?(Am(e,t,s,i),Am(e,t,n,o-1)):(Am(e,t,n,o-1),Am(e,t,s,i))}}function Ev(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function H5e(e){return e[0]}function U5e(e){return e[1]}class Ah{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,i){const r=(t=+t)+(i=+i),s=n=+n;if(i<0)throw new Error("negative radius");null===this._x1?this._+=`M${r},${s}`:(Math.abs(this._x1-r)>1e-6||Math.abs(this._y1-s)>1e-6)&&(this._+="L"+r+","+s),i&&(this._+=`A${i},${i},0,1,1,${t-i},${n}A${i},${i},0,1,1,${this._x1=r},${this._y1=s}`)}rect(t,n,i,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class T3{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class z5e{constructor(t,[n,i,r,s]=[0,0,960,500]){if(!((r=+r)>=(n=+n)&&(s=+s)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=r,this.xmin=n,this.ymax=s,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:i},vectors:r}=this,s=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let m,_,h=0,p=0,g=i.length;h<g;h+=3,p+=2){const y=2*i[h],v=2*i[h+1],b=2*i[h+2],D=t[y],C=t[y+1],N=t[b],k=t[b+1],I=t[v]-D,L=t[v+1]-C,B=N-D,T=k-C,A=2*(I*T-L*B);if(Math.abs(A)<1e-9){let x=1e9;const F=2*i[0];x*=Math.sign((t[F]-D)*T-(t[F+1]-C)*B),m=(D+N)/2-x*T,_=(C+k)/2+x*B}else{const x=1/A,F=I*I+L*L,O=B*B+T*T;m=D+(T*F-L*O)*x,_=C+(I*O-B*F)*x}s[p]=m,s[p+1]=_}let a,u,d,o=n[n.length-1],l=4*o,c=t[2*o],f=t[2*o+1];r.fill(0);for(let h=0;h<n.length;++h)o=n[h],a=l,u=c,d=f,l=4*o,c=t[2*o],f=t[2*o+1],r[a+2]=r[l]=d-f,r[a+3]=r[l+1]=c-u}render(t){const n=null==t?t=new Ah:void 0,{delaunay:{halfedges:i,inedges:r,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let c=0,d=i.length;c<d;++c){const f=i[c];if(f<c)continue;const h=2*Math.floor(c/3),p=2*Math.floor(f/3);this._renderSegment(o[h],o[h+1],o[p],o[p+1],t)}let l,u=s[s.length-1];for(let c=0;c<s.length;++c){l=u,u=s[c];const d=2*Math.floor(r[u]/3),f=o[d],h=o[d+1],p=4*l,g=this._project(f,h,a[p+2],a[p+3]);g&&this._renderSegment(f,h,g[0],g[1],t)}return n&&n.value()}renderBounds(t){const n=null==t?t=new Ah:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const i=null==n?n=new Ah:void 0,r=this._clip(t);if(null===r||!r.length)return;n.moveTo(r[0],r[1]);let s=r.length;for(;r[0]===r[s-2]&&r[1]===r[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(r[o]!==r[o-2]||r[o+1]!==r[o-1])&&n.lineTo(r[o],r[o+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,i=t.length/2;n<i;++n){const r=this.cellPolygon(n);r&&(r.index=n,yield r)}}cellPolygon(t){const n=new T3;return this.renderCell(t,n),n.value()}_renderSegment(t,n,i,r,s){let o;const a=this._regioncode(t,n),l=this._regioncode(i,r);0===a&&0===l?(s.moveTo(t,n),s.lineTo(i,r)):(o=this._clipSegment(t,n,i,r,a,l))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(t,n,i){return(n=+n)==n&&(i=+i)==i&&this.delaunay._step(t,n,i)===t}*neighbors(t){const n=this._clip(t);if(n)for(const i of this.delaunay.neighbors(t)){const r=this._clip(i);if(r)e:for(let s=0,o=n.length;s<o;s+=2)for(let a=0,l=r.length;a<l;a+=2)if(n[s]==r[a]&&n[s+1]==r[a+1]&&n[(s+2)%o]==r[(a+l-2)%l]&&n[(s+3)%o]==r[(a+l-1)%l]){yield i;break e}}}_cell(t){const{circumcenters:n,delaunay:{inedges:i,halfedges:r,triangles:s}}=this,o=i[t];if(-1===o)return null;const a=[];let l=o;do{const u=Math.floor(l/3);if(a.push(n[2*u],n[2*u+1]),l=l%3==2?l-2:l+1,s[l]!==t)break;l=r[l]}while(l!==o&&-1!==l);return a}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(null===n)return null;const{vectors:i}=this,r=4*t;return i[r]||i[r+1]?this._clipInfinite(t,n,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(t,n)}_clipFinite(t,n){const i=n.length;let s,o,u,d,r=null,a=n[i-2],l=n[i-1],c=this._regioncode(a,l),f=0;for(let h=0;h<i;h+=2)if(s=a,o=l,a=n[h],l=n[h+1],u=c,c=this._regioncode(a,l),0===u&&0===c)d=f,f=0,r?r.push(a,l):r=[a,l];else{let p,g,m,_,y;if(0===u){if(null===(p=this._clipSegment(s,o,a,l,u,c)))continue;[g,m,_,y]=p}else{if(null===(p=this._clipSegment(a,l,s,o,c,u)))continue;[_,y,g,m]=p,d=f,f=this._edgecode(g,m),d&&f&&this._edge(t,d,f,r,r.length),r?r.push(g,m):r=[g,m]}d=f,f=this._edgecode(_,y),d&&f&&this._edge(t,d,f,r,r.length),r?r.push(_,y):r=[_,y]}if(r)d=f,f=this._edgecode(r[0],r[1]),d&&f&&this._edge(t,d,f,r,r.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(t,n,i,r,s,o){for(;;){if(0===s&&0===o)return[t,n,i,r];if(s&o)return null;let a,l,u=s||o;8&u?(a=t+(i-t)*(this.ymax-n)/(r-n),l=this.ymax):4&u?(a=t+(i-t)*(this.ymin-n)/(r-n),l=this.ymin):2&u?(l=n+(r-n)*(this.xmax-t)/(i-t),a=this.xmax):(l=n+(r-n)*(this.xmin-t)/(i-t),a=this.xmin),s?s=this._regioncode(t=a,n=l):o=this._regioncode(i=a,r=l)}}_clipInfinite(t,n,i,r,s,o){let l,a=Array.from(n);if((l=this._project(a[0],a[1],i,r))&&a.unshift(l[0],l[1]),(l=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(l[0],l[1]),a=this._clipFinite(t,a))for(let d,u=0,c=a.length,f=this._edgecode(a[c-2],a[c-1]);u<c;u+=2)d=f,f=this._edgecode(a[u],a[u+1]),d&&f&&(u=this._edge(t,d,f,a,u),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,i,r,s){for(;n!==i;){let o,a;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,a=this.ymin}(r[s]!==o||r[s+1]!==a)&&this.contains(t,o,a)&&(r.splice(s,0,o,a),s+=2)}if(r.length>4)for(let o=0;o<r.length;o+=2){const a=(o+2)%r.length,l=(o+4)%r.length;(r[o]===r[a]&&r[a]===r[l]||r[o+1]===r[a+1]&&r[a+1]===r[l+1])&&(r.splice(a,2),o-=2)}return s}_project(t,n,i,r){let o,a,l,s=1/0;if(r<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/r)<s&&(l=this.ymin,a=t+(s=o)*i)}else if(r>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/r)<s&&(l=this.ymax,a=t+(s=o)*i)}if(i>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/i)<s&&(a=this.xmax,l=n+(s=o)*r)}else if(i<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/i)<s&&(a=this.xmin,l=n+(s=o)*r)}return[a,l]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const q5e=2*Math.PI,Mm=Math.pow;function G5e(e){return e[0]}function W5e(e){return e[1]}function K5e(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class O3{static from(t,n=G5e,i=W5e,r){return new O3("length"in t?function J5e(e,t,n,i){const r=e.length,s=new Float64Array(2*r);for(let o=0;o<r;++o){const a=e[o];s[2*o]=t.call(i,a,o,e),s[2*o+1]=n.call(i,a,o,e)}return s}(t,n,i,r):Float64Array.from(function*X5e(e,t,n,i){let r=0;for(const s of e)yield t.call(i,s,r,e),yield n.call(i,s,r,e),++r}(t,n,i,r)))}constructor(t){this._delaunator=new GE(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&function Y5e(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const r=2*t[i],s=2*t[i+1],o=2*t[i+2];if((n[o]-n[r])*(n[s+1]-n[r+1])-(n[s]-n[r])*(n[o+1]-n[r+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:n.length/2},(f,h)=>h).sort((f,h)=>n[2*f]-n[2*h]||n[2*f+1]-n[2*h+1]);const l=this.collinear[0],u=this.collinear[this.collinear.length-1],c=[n[2*l],n[2*l+1],n[2*u],n[2*u+1]],d=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let f=0,h=n.length/2;f<h;++f){const p=K5e(n[2*f],n[2*f+1],d);n[2*f]=p[0],n[2*f+1]=p[1]}this._delaunator=new GE(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let l=0,u=i.length;l<u;++l){const c=s[l%3==2?l-2:l+1];(-1===i[l]||-1===o[c])&&(o[c]=l)}for(let l=0,u=r.length;l<u;++l)a[r[l]]=l;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,2===r.length&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(t){return new z5e(this,t)}*neighbors(t){const{inedges:n,hull:i,_hullIndex:r,halfedges:s,triangles:o,collinear:a}=this;if(a){const d=a.indexOf(t);return d>0&&(yield a[d-1]),void(d<a.length-1&&(yield a[d+1]))}const l=n[t];if(-1===l)return;let u=l,c=-1;do{if(yield c=o[u],u=u%3==2?u-2:u+1,o[u]!==t)return;if(u=s[u],-1===u){const d=i[(r[t]+1)%i.length];return void(d!==c&&(yield d))}}while(u!==l)}find(t,n,i=0){if((t=+t)!=t||(n=+n)!=n)return-1;const r=i;let s;for(;(s=this._step(i,t,n))>=0&&s!==i&&s!==r;)i=s;return s}_step(t,n,i){const{inedges:r,hull:s,_hullIndex:o,halfedges:a,triangles:l,points:u}=this;if(-1===r[t]||!u.length)return(t+1)%(u.length>>1);let c=t,d=Mm(n-u[2*t],2)+Mm(i-u[2*t+1],2);const f=r[t];let h=f;do{let p=l[h];const g=Mm(n-u[2*p],2)+Mm(i-u[2*p+1],2);if(g<d&&(d=g,c=p),h=h%3==2?h-2:h+1,l[h]!==t)break;if(h=a[h],-1===h){if(h=s[(o[t]+1)%s.length],h!==p&&Mm(n-u[2*h],2)+Mm(i-u[2*h+1],2)<d)return h;break}}while(h!==f);return c}render(t){const n=null==t?t=new Ah:void 0,{points:i,halfedges:r,triangles:s}=this;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l<o)continue;const u=2*s[o],c=2*s[l];t.moveTo(i[u],i[u+1]),t.lineTo(i[c],i[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){void 0===n&&(!t||"function"!=typeof t.moveTo)&&(n=t,t=null),n=null==n?2:+n;const i=null==t?t=new Ah:void 0,{points:r}=this;for(let s=0,o=r.length;s<o;s+=2){const a=r[s],l=r[s+1];t.moveTo(a+n,l),t.arc(a,l,n,0,q5e)}return i&&i.value()}renderHull(t){const n=null==t?t=new Ah:void 0,{hull:i,points:r}=this,s=2*i[0],o=i.length;t.moveTo(r[s],r[s+1]);for(let a=1;a<o;++a){const l=2*i[a];t.lineTo(r[l],r[l+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new T3;return this.renderHull(t),t.value()}renderTriangle(t,n){const i=null==n?n=new Ah:void 0,{points:r,triangles:s}=this,o=2*s[t*=3],a=2*s[t+1],l=2*s[t+2];return n.moveTo(r[o],r[o+1]),n.lineTo(r[a],r[a+1]),n.lineTo(r[l],r[l+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,i=t.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new T3;return this.renderTriangle(t,n),n.value()}}function N3(e){Q.call(this,null,e)}N3.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const Q5e=[-1e5,-1e5,1e5,1e5];function Z5e(e){const t=e[0][0],n=e[0][1];let i=e.length-1;for(;e[i][0]===t&&e[i][1]===n;--i);return"M"+e.slice(0,i+1).join("L")+"Z"}fe(N3,Q,{transform(e,t){const n=e.as||"path",i=t.source;if(!i||!i.length)return t;let r=e.size;r=r?[0,0,r[0],r[1]]:(r=e.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:Q5e;const s=this.value=O3.from(i,e.x,e.y).voronoi(r);for(let o=0,a=i.length;o<a;++o){const l=s.cellPolygon(o);i[o][n]=l?Z5e(l):null}return t.reflow(e.modified()).modifies(n)}});var k3=Math.PI/180;function tBe(e,t,n,i){if(!t.sprite){var r=e.context,s=e.ratio;r.clearRect(0,0,2048/s,2048/s);var c,d,f,h,p,o=0,a=0,l=0,u=n.length;for(--i;++i<u;){if(t=n[i],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font,c=r.measureText(t.text+"m").width*s,f=t.size<<1,t.rotate){var g=Math.sin(t.rotate*k3),m=Math.cos(t.rotate*k3),_=c*m,y=c*g,v=f*m,b=f*g;c=Math.max(Math.abs(_+b),Math.abs(_-b))+31>>5<<5,f=~~Math.max(Math.abs(y+v),Math.abs(y-v))}else c=c+31>>5<<5;if(f>l&&(l=f),o+c>=2048&&(o=0,a+=l,l=0),a+f>=2048)break;r.translate((o+(c>>1))/s,(a+(f>>1))/s),t.rotate&&r.rotate(t.rotate*k3),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=c,t.height=f,t.xoff=o,t.yoff=a,t.x1=c>>1,t.y1=f>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,o+=c}for(var D=r.getImageData(0,0,2048/s,2048/s).data,C=[];--i>=0;)if((t=n[i]).hasText){for(d=(c=t.width)>>5,f=t.y1-t.y0,h=0;h<f*d;h++)C[h]=0;if(null==(o=t.xoff))return;a=t.yoff;var w=0,E=-1;for(p=0;p<f;p++){for(h=0;h<c;h++){var k=D[2048*(a+p)+(o+h)<<2]?1<<31-h%32:0;C[d*p+(h>>5)]|=k,w|=k}w?E=p:(t.y0++,f--,p--,a++)}t.y1=t.y0+E,t.sprite=C.slice(0,(t.y1-t.y0)*d)}}}function nBe(e,t,n){for(var c,i=e.sprite,r=e.width>>5,s=e.x-(r<<4),o=127&s,a=32-o,l=e.y1-e.y0,u=(e.y+e.y0)*(n>>=5)+(s>>5),d=0;d<l;d++){c=0;for(var f=0;f<=r;f++)if((c<<a|(f<r?(c=i[d*r+f])>>>o:0))&t[u+f])return!0;u+=n}return!1}function iBe(e,t){var n=e[0],i=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>i.x&&(i.x=t.x+t.x1),t.y+t.y1>i.y&&(i.y=t.y+t.y1)}function rBe(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function Fte(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Mh(e){return"function"==typeof e?e:function(){return e}}var aBe={archimedean:Fte,rectangular:function sBe(e){var n=4*e[0]/e[1],i=0,r=0;return function(s){var o=s<0?-1:1;switch(Math.sqrt(1+4*o*s)-o&3){case 0:i+=n;break;case 1:r+=4;break;case 2:i-=n;break;default:r-=4}return[i,r]}}};const Pte=["x","y","font","fontSize","fontStyle","fontWeight","angle"],lBe=["text","font","rotate","fontSize","fontStyle","fontWeight"];function I3(e){Q.call(this,function eBe(){var t,n,i,r,s,o,a,e=[256,256],l=Fte,u=[],c=Math.random,d={};function h(p,g,m){for(var w,E,N,_=g.x,y=g.y,v=Math.sqrt(e[0]*e[0]+e[1]*e[1]),b=l(e),D=c()<.5?1:-1,C=-D;(w=b(C+=D))&&(E=~~w[0],N=~~w[1],!(Math.min(Math.abs(E),Math.abs(N))>=v));)if(g.x=_+E,g.y=y+N,!(g.x+g.x0<0||g.y+g.y0<0||g.x+g.x1>e[0]||g.y+g.y1>e[1])&&(!m||!nBe(g,p,e[0]))&&(!m||rBe(g,m))){for(var O,k=g.sprite,I=g.width>>5,L=e[0]>>5,B=g.x-(I<<4),T=127&B,A=32-T,x=g.y1-g.y0,F=(g.y+g.y0)*L+(B>>5),j=0;j<x;j++){O=0;for(var P=0;P<=I;P++)p[F+P]|=O<<A|(P<I?(O=k[j*I+P])>>>T:0);F+=L}return g.sprite=null,!0}return!1}return d.layout=function(){for(var p=function f(p){p.width=p.height=1;var g=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=2048/g,p.height=2048/g;var m=p.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:g}}(ld()),g=function oBe(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}((e[0]>>5)*e[1]),m=null,_=u.length,y=-1,v=[],b=u.map(C=>({text:t(C),font:n(C),style:r(C),weight:s(C),rotate:o(C),size:~~(i(C)+1e-14),padding:a(C),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:C})).sort((C,w)=>w.size-C.size);++y<_;){var D=b[y];D.x=e[0]*(c()+.5)>>1,D.y=e[1]*(c()+.5)>>1,tBe(p,D,b,y),D.hasText&&h(g,D,m)&&(v.push(D),m?iBe(m,D):m=[{x:D.x+D.x0,y:D.y+D.y0},{x:D.x+D.x1,y:D.y+D.y1}],D.x-=e[0]>>1,D.y-=e[1]>>1)}return v},d.words=function(p){return arguments.length?(u=p,d):u},d.size=function(p){return arguments.length?(e=[+p[0],+p[1]],d):e},d.font=function(p){return arguments.length?(n=Mh(p),d):n},d.fontStyle=function(p){return arguments.length?(r=Mh(p),d):r},d.fontWeight=function(p){return arguments.length?(s=Mh(p),d):s},d.rotate=function(p){return arguments.length?(o=Mh(p),d):o},d.text=function(p){return arguments.length?(t=Mh(p),d):t},d.spiral=function(p){return arguments.length?(l=aBe[p]||p,d):l},d.fontSize=function(p){return arguments.length?(i=Mh(p),d):i},d.padding=function(p){return arguments.length?(a=Mh(p),d):a},d.random=function(p){return arguments.length?(c=p,d):c},d}(),e)}I3.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:Pte}]},fe(I3,Q,{transform(e,t){e.size&&(!e.size[0]||!e.size[1])&&te("Wordcloud size dimensions must be non-zero.");const i=e.modified();if(!(i||t.changed(t.ADD_REM)||lBe.some(function n(p){const g=e[p];return st(g)&&t.modified(g.fields)})))return;const r=t.materialize(t.SOURCE).source,s=this.value,o=e.as||Pte;let l,a=e.fontSize||14;if(st(a)?l=e.fontSizeRange:a=yr(a),l){const p=a,g=Pt("sqrt")().domain(Al(r,p)).range(l);a=m=>g(p(m))}r.forEach(p=>{p[o[0]]=NaN,p[o[1]]=NaN,p[o[3]]=0});const u=s.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(jo).layout(),c=s.size(),d=c[0]>>1,f=c[1]>>1,h=u.length;for(let g,m,p=0;p<h;++p)g=u[p],m=g.datum,m[o[0]]=g.x+d,m[o[1]]=g.y+f,m[o[2]]=g.font,m[o[3]]=g.size,m[o[4]]=g.style,m[o[5]]=g.weight,m[o[6]]=g.rotate;return t.reflow(i).modifies(o)}});const cBe=e=>new Uint8Array(e),dBe=e=>new Uint16Array(e),xv=e=>new Uint32Array(e);function YE(e,t,n){const i=(t<257?cBe:t<65537?dBe:xv)(e);return n&&i.set(n),i}function Lte(e,t,n){const i=1<<t;return{one:i,zero:~i,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(r,s){const o=this,a=o.bisect(o.range,r.value),l=r.index,u=a[0],c=a[1],d=l.length;let f;for(f=0;f<u;++f)s[l[f]]|=i;for(f=c;f<d;++f)s[l[f]]|=i;return o}}}function jte(){let e=xv(0),t=[],n=0;return{insert:function i(a,l,u){if(!l.length)return[];const c=n,d=l.length,f=xv(d);let p,g,m,h=Array(d);for(m=0;m<d;++m)h[m]=a(l[m]),f[m]=m;if(h=function pBe(e,t){return e.sort.call(t,(n,i)=>{const r=e[n],s=e[i];return r<s?-1:r>s?1:0}),function uBe(e,t){return Array.from(t,n=>e[n])}(e,t)}(h,f),c)p=t,g=e,t=Array(c+d),e=xv(c+d),function gBe(e,t,n,i,r,s,o,a,l){let d,u=0,c=0;for(d=0;u<i&&c<o;++d)t[u]<r[c]?(a[d]=t[u],l[d]=n[u++]):(a[d]=r[c],l[d]=s[c++]+e);for(;u<i;++u,++d)a[d]=t[u],l[d]=n[u];for(;c<o;++c,++d)a[d]=r[c],l[d]=s[c]+e}(u,p,g,c,h,f,d,t,e);else{if(u>0)for(m=0;m<d;++m)f[m]+=u;t=h,e=f}return n=c+d,{index:f,value:h}},remove:function r(a,l){const u=n;let c,d,f;for(d=0;!l[e[d]]&&d<u;++d);for(f=d;d<u;++d)l[c=e[d]]||(e[f]=c,t[f]=t[d],++f);n=u-a},bisect:function o(a,l){let u;return l?u=l.length:(l=t,u=n),[mNe(l,a[0],0,u),WD(l,a[1],0,u)]},reindex:function s(a){for(let l=0,u=n;l<u;++l)e[l]=a[e[l]]},index:()=>e,size:()=>n}}function R3(e){Q.call(this,function fBe(){let e=8,t=[],n=xv(0),i=YE(0,e),r=YE(0,e);return{data:()=>t,seen:()=>n=function hBe(e,t,n){return e.length>=t?e:((n=n||new e.constructor(t)).set(e),n)}(n,t.length),add(s){for(let u,o=0,a=t.length,l=s.length;o<l;++o)u=s[o],u._index=a++,t.push(u)},remove(s,o){const a=t.length,l=Array(a-s),u=t;let c,d,f;for(d=0;!o[d]&&d<a;++d)l[d]=t[d],u[d]=d;for(f=d;d<a;++d)c=t[d],o[d]?u[d]=-1:(u[d]=f,i[f]=i[d],r[f]=r[d],l[f]=c,c._index=f++),i[d]=0;return t=l,u},size:()=>t.length,curr:()=>i,prev:()=>r,reset:s=>r[s]=i[s],all:()=>e<257?255:e<65537?65535:4294967295,set(s,o){i[s]|=o},clear(s,o){i[s]&=~o},resize(s,o){(s>i.length||o>e)&&(e=Math.max(o,e),i=YE(s,e,i),r=YE(s,e))}}}(),e),this._indices=null,this._dims=null}function F3(e){Q.call(this,null,e)}R3.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},fe(R3,Q,{transform(e,t){return this._dims?e.modified("fields")||e.fields.some(i=>t.modified(i.fields))?this.reinit(e,t):this.eval(e,t):this.init(e,t)},init(e,t){const n=e.fields,i=e.query,r=this._indices={},s=this._dims=[],o=i.length;let l,u,a=0;for(;a<o;++a)l=n[a].fname,u=r[l]||(r[l]=jte()),s.push(Lte(u,a,i[a]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),i=e.fields,r=e.query,s=this._indices,o=this._dims,a=this.value,l=a.curr(),u=a.prev(),c=a.all(),d=n.rem=n.add,f=n.mod,h=r.length,p={};let g,m,_,y,v,b,D,C,w;if(u.set(l),t.rem.length&&(v=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(b={},y=t.mod,D=0,C=y.length;D<C;++D)b[y[D]._index]=1;for(D=0;D<h;++D)w=i[D],(!o[D]||e.modified("fields",D)||t.modified(w.fields))&&(_=w.fname,(g=p[_])||(s[_]=m=jte(),p[_]=g=m.insert(w,t.source,0)),o[D]=Lte(m,D,r[D]).onAdd(g,l));for(D=0,C=a.data().length;D<C;++D)v[D]||(u[D]!==l[D]?d.push(D):b[D]&&l[D]!==c&&f.push(D));return a.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),i=this._dims.length;let r=0;return t.rem.length&&(this.remove(e,t,n),r|=(1<<i)-1),e.modified("query")&&!e.modified("fields")&&(r|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),r|=(1<<i)-1),t.mod.length&&(this.modify(t,n),r|=(1<<i)-1),this.value.mask=r,n},insert(e,t,n){const i=t.add,r=this.value,s=this._dims,o=this._indices,a=e.fields,l={},u=n.add,c=r.size()+i.length,d=s.length;let h,p,g,f=r.size();r.resize(c,d),r.add(i);const m=r.curr(),_=r.prev(),y=r.all();for(h=0;h<d;++h)p=a[h].fname,g=l[p]||(l[p]=o[p].insert(a[h],i,f)),s[h].onAdd(g,m);for(;f<c;++f)_[f]=y,m[f]!==y&&u.push(f)},modify(e,t){const n=t.mod,i=this.value,r=i.curr(),s=i.all(),o=e.mod;let a,l,u;for(a=0,l=o.length;a<l;++a)u=o[a]._index,r[u]!==s&&n.push(u)},remove(e,t,n){const i=this._indices,r=this.value,s=r.curr(),o=r.prev(),a=r.all(),l={},u=n.rem,c=t.rem;let d,f,h,p;for(d=0,f=c.length;d<f;++d)h=c[d]._index,l[h]=1,o[h]=p=s[h],s[h]=a,p!==a&&u.push(h);for(h in i)i[h].remove(f,l);return this.reindex(t,f,l),l},reindex(e,t,n){const i=this._indices,r=this.value;e.runAfter(()=>{const s=r.remove(t,n);for(const o in i)i[o].reindex(s)})},update(e,t,n){const i=this._dims,r=e.query,s=t.stamp,o=i.length;let l,u,a=0;for(n.filters=0,u=0;u<o;++u)e.modified("query",u)&&(l=u,++a);if(1===a)a=i[l].one,this.incrementOne(i[l],r[l],n.add,n.rem);else for(u=0,a=0;u<o;++u)!e.modified("query",u)||(a|=i[u].one,this.incrementAll(i[u],r[u],s,n.add),n.rem=n.add);return a},incrementAll(e,t,n,i){const r=this.value,s=r.seen(),o=r.curr(),a=r.prev(),l=e.index(),u=e.bisect(e.range),c=e.bisect(t),d=c[0],f=c[1],h=u[0],p=u[1],g=e.one;let m,_,y;if(d<h)for(m=d,_=Math.min(h,f);m<_;++m)y=l[m],s[y]!==n&&(a[y]=o[y],s[y]=n,i.push(y)),o[y]^=g;else if(d>h)for(m=h,_=Math.min(d,p);m<_;++m)y=l[m],s[y]!==n&&(a[y]=o[y],s[y]=n,i.push(y)),o[y]^=g;if(f>p)for(m=Math.max(d,p),_=f;m<_;++m)y=l[m],s[y]!==n&&(a[y]=o[y],s[y]=n,i.push(y)),o[y]^=g;else if(f<p)for(m=Math.max(h,f),_=p;m<_;++m)y=l[m],s[y]!==n&&(a[y]=o[y],s[y]=n,i.push(y)),o[y]^=g;e.range=t.slice()},incrementOne(e,t,n,i){const s=this.value.curr(),o=e.index(),a=e.bisect(e.range),l=e.bisect(t),u=l[0],c=l[1],d=a[0],f=a[1],h=e.one;let p,g,m;if(u<d)for(p=u,g=Math.min(d,c);p<g;++p)m=o[p],s[m]^=h,n.push(m);else if(u>d)for(p=d,g=Math.min(u,f);p<g;++p)m=o[p],s[m]^=h,i.push(m);if(c>f)for(p=Math.max(u,f),g=c;p<g;++p)m=o[p],s[m]^=h,n.push(m);else if(c<f)for(p=Math.max(d,c),g=f;p<g;++p)m=o[p],s[m]^=h,i.push(m);e.range=t.slice()}}),F3.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},fe(F3,Q,{transform(e,t){const n=~(e.ignore||0),i=e.filter,r=i.mask;if(0==(r&n))return t.StopPropagation;const s=t.fork(t.ALL),o=i.data(),a=i.curr(),l=i.prev(),u=c=>a[c]&n?null:o[c];return s.filter(s.MOD,u),r&r-1?(s.filter(s.ADD,c=>{const d=a[c]&n;return!d&&d^l[c]&n?o[c]:null}),s.filter(s.REM,c=>{const d=a[c]&n;return!d||d^d^l[c]&n?null:o[c]})):(s.filter(s.ADD,u),s.filter(s.REM,c=>(a[c]&n)===r?o[c]:null)),s.filter(s.SOURCE,c=>u(c._index))}});const Th="Literal",Bte="CallExpression";function Ha(e){this.type=e}var ql,Te,ee,Sr,Xt;Ha.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=function xBe(e){switch(e.type){case"ArrayExpression":return e.elements;case"BinaryExpression":case"LogicalExpression":return[e.left,e.right];case Bte:return[e.callee].concat(e.arguments);case"ConditionalExpression":return[e.test,e.consequent,e.alternate];case"MemberExpression":return[e.object,e.property];case"ObjectExpression":return e.properties;case"Property":return[e.key,e.value];case"UnaryExpression":return[e.argument];default:return[]}}(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1},(ql={})[1]="Boolean",ql[2]="<end>",ql[3]="Identifier",ql[4]="Keyword",ql[5]="Null",ql[6]="Numeric",ql[7]="Punctuator",ql[8]="String",ql[9]="RegularExpression";var $te="Identifier",$i="Unexpected token %0",P3="Invalid regular expression",L3="Invalid regular expression: missing /",Vte="Octal literals are not allowed in strict mode.",er="ILLEGAL",Tv="Disabled.",zBe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),qBe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function XE(e,t){if(!e)throw new Error("ASSERT: "+t)}function tc(e){return e>=48&&e<=57}function j3(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Ov(e){return"01234567".indexOf(e)>=0}function GBe(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function Nv(e){return 10===e||13===e||8232===e||8233===e}function kv(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&zBe.test(String.fromCharCode(e))}function QE(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&qBe.test(String.fromCharCode(e))}const WBe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function Hte(){for(;ee<Sr;){const e=Te.charCodeAt(ee);if(!GBe(e)&&!Nv(e))break;++ee}}function B3(e){var t,n,i,r=0;for(n="u"===e?4:2,t=0;t<n;++t)ee<Sr&&j3(Te[ee])?(i=Te[ee++],r=16*r+"0123456789abcdef".indexOf(i.toLowerCase())):Lt({},$i,er);return String.fromCharCode(r)}function YBe(){var e,t;for(t=0,"}"===(e=Te[ee])&&Lt({},$i,er);ee<Sr&&j3(e=Te[ee++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&Lt({},$i,er),t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}function Ute(){var e,t;for(e=Te.charCodeAt(ee++),t=String.fromCharCode(e),92===e&&(117!==Te.charCodeAt(ee)&&Lt({},$i,er),++ee,(!(e=B3("u"))||"\\"===e||!kv(e.charCodeAt(0)))&&Lt({},$i,er),t=e);ee<Sr&&QE(e=Te.charCodeAt(ee));)++ee,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==Te.charCodeAt(ee)&&Lt({},$i,er),++ee,(!(e=B3("u"))||"\\"===e||!QE(e.charCodeAt(0)))&&Lt({},$i,er),t+=e);return t}function $3(){var n,r,s,o,e=ee,t=Te.charCodeAt(ee),i=Te[ee];switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++ee,{type:7,value:String.fromCharCode(t),start:e,end:ee};default:if(61===(n=Te.charCodeAt(ee+1)))switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return ee+=2,{type:7,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:ee};case 33:case 61:return 61===Te.charCodeAt(ee+=2)&&++ee,{type:7,value:Te.slice(e,ee),start:e,end:ee}}}return">>>="===(o=Te.substr(ee,4))?{type:7,value:o,start:e,end:ee+=4}:">>>"===(s=o.substr(0,3))||"<<="===s||">>="===s?{type:7,value:s,start:e,end:ee+=3}:i===(r=s.substr(0,2))[1]&&"+-<>&|".indexOf(i)>=0||"=>"===r?{type:7,value:r,start:e,end:ee+=2}:("//"===r&&Lt({},$i,er),"<>=!+-*%&|^/".indexOf(i)>=0?{type:7,value:i,start:e,end:++ee}:void Lt({},$i,er))}function zte(){var e,t,n;if(XE(tc((n=Te[ee]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=ee,e="","."!==n){if(e=Te[ee++],n=Te[ee],"0"===e){if("x"===n||"X"===n)return++ee,function XBe(e){let t="";for(;ee<Sr&&j3(Te[ee]);)t+=Te[ee++];return 0===t.length&&Lt({},$i,er),kv(Te.charCodeAt(ee))&&Lt({},$i,er),{type:6,value:parseInt("0x"+t,16),start:e,end:ee}}(t);if(Ov(n))return function QBe(e){let t="0"+Te[ee++];for(;ee<Sr&&Ov(Te[ee]);)t+=Te[ee++];return(kv(Te.charCodeAt(ee))||tc(Te.charCodeAt(ee)))&&Lt({},$i,er),{type:6,value:parseInt(t,8),octal:!0,start:e,end:ee}}(t);n&&tc(n.charCodeAt(0))&&Lt({},$i,er)}for(;tc(Te.charCodeAt(ee));)e+=Te[ee++];n=Te[ee]}if("."===n){for(e+=Te[ee++];tc(Te.charCodeAt(ee));)e+=Te[ee++];n=Te[ee]}if("e"===n||"E"===n)if(e+=Te[ee++],("+"===(n=Te[ee])||"-"===n)&&(e+=Te[ee++]),tc(Te.charCodeAt(ee)))for(;tc(Te.charCodeAt(ee));)e+=Te[ee++];else Lt({},$i,er);return kv(Te.charCodeAt(ee))&&Lt({},$i,er),{type:6,value:parseFloat(e),start:t,end:ee}}function qte(){if(Hte(),ee>=Sr)return{type:2,start:ee,end:ee};const e=Te.charCodeAt(ee);return kv(e)?function JBe(){var e,t;return e=ee,t=92===Te.charCodeAt(ee)?Ute():function KBe(){var e,t;for(e=ee++;ee<Sr;){if(92===(t=Te.charCodeAt(ee)))return ee=e,Ute();if(!QE(t))break;++ee}return Te.slice(e,ee)}(),{type:1===t.length?3:WBe.hasOwnProperty(t)?4:"null"===t?5:"true"===t||"false"===t?1:3,value:t,start:e,end:ee}}():40===e||41===e||59===e?$3():39===e||34===e?function ZBe(){var t,n,i,r,e="",s=!1;for(XE("'"===(t=Te[ee])||'"'===t,"String literal must starts with a quote"),n=ee,++ee;ee<Sr;){if((i=Te[ee++])===t){t="";break}if("\\"===i)if((i=Te[ee++])&&Nv(i.charCodeAt(0)))"\r"===i&&"\n"===Te[ee]&&++ee;else switch(i){case"u":case"x":"{"===Te[ee]?(++ee,e+=YBe()):e+=B3(i);break;case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Ov(i)?(0!==(r="01234567".indexOf(i))&&(s=!0),ee<Sr&&Ov(Te[ee])&&(s=!0,r=8*r+"01234567".indexOf(Te[ee++]),"0123".indexOf(i)>=0&&ee<Sr&&Ov(Te[ee])&&(r=8*r+"01234567".indexOf(Te[ee++]))),e+=String.fromCharCode(r)):e+=i}else{if(Nv(i.charCodeAt(0)))break;e+=i}}return""!==t&&Lt({},$i,er),{type:8,value:e,octal:s,start:n,end:ee}}():46===e?tc(Te.charCodeAt(ee+1))?zte():$3():tc(e)?zte():$3()}function Ds(){const e=Xt;return ee=e.end,Xt=qte(),ee=e.end,e}function Gte(){const e=ee;Xt=qte(),ee=e}function Wte(e,t,n){const i=new Ha("||"===e||"&&"===e?"LogicalExpression":"BinaryExpression");return i.operator=e,i.left=t,i.right=n,i}function o4e(e,t){const n=new Ha("CallExpression");return n.callee=e,n.arguments=t,n}function V3(e){const t=new Ha($te);return t.name=e,t}function Iv(e){const t=new Ha("Literal");return t.value=e.value,t.raw=Te.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function Yte(e,t,n){const i=new Ha("MemberExpression");return i.computed="["===e,i.object=t,i.property=n,i.computed||(n.member=!0),i}function Kte(e,t,n){const i=new Ha("Property");return i.key=t,i.value=n,i.kind=e,i}function Lt(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(s,o)=>(XE(o<i.length,"Message reference must be in range"),i[o]));throw(n=new Error(r)).index=ee,n.description=r,n}function ZE(e){2===e.type&&Lt(e,"Unexpected end of input"),6===e.type&&Lt(e,"Unexpected number"),8===e.type&&Lt(e,"Unexpected string"),3===e.type&&Lt(e,"Unexpected identifier"),4===e.type&&Lt(e,"Unexpected reserved word"),Lt(e,$i,e.value)}function xr(e){const t=Ds();(7!==t.type||t.value!==e)&&ZE(t)}function Cn(e){return 7===Xt.type&&Xt.value===e}function H3(e){return 4===Xt.type&&Xt.value===e}function Jte(){ee=Xt.start;const e=Ds();return 8===e.type||6===e.type?(e.octal&&Lt(e,Vte),Iv(e)):V3(e.value)}function d4e(){var e,t,n;return ee=Xt.start,3===(e=Xt).type?(n=Jte(),xr(":"),Kte("init",n,kh())):2!==e.type&&7!==e.type?(t=Jte(),xr(":"),Kte("init",t,kh())):void ZE(e)}const p4e={if:1};function g4e(){var e,t,n;if(Cn("("))return function h4e(){xr("(");const e=U3();return xr(")"),e}();if(Cn("["))return function c4e(){const e=[];for(ee=Xt.start,xr("[");!Cn("]");)Cn(",")?(Ds(),e.push(null)):(e.push(kh()),Cn("]")||xr(","));return Ds(),function s4e(e){const t=new Ha("ArrayExpression");return t.elements=e,t}(e)}();if(Cn("{"))return function f4e(){var t,i,e=[],r={},s=String;for(ee=Xt.start,xr("{");!Cn("}");)i="$"+((t=d4e()).key.type===$te?t.key.name:s(t.key.value)),Object.prototype.hasOwnProperty.call(r,i)?Lt({},"Duplicate data property in object literal not allowed in strict mode"):r[i]=!0,e.push(t),Cn("}")||xr(",");return xr("}"),function l4e(e){const t=new Ha("ObjectExpression");return t.properties=e,t}(e)}();if(ee=Xt.start,3===(e=Xt.type)||p4e[Xt.value])n=V3(Ds().value);else if(8===e||6===e)Xt.octal&&Lt(Xt,Vte),n=Iv(Ds());else{if(4===e)throw new Error(Tv);1===e?((t=Ds()).value="true"===t.value,n=Iv(t)):5===e?((t=Ds()).value=null,n=Iv(t)):Cn("/")||Cn("/=")?(n=Iv(function i4e(){var e,t,n,i;return Xt=null,Hte(),e=ee,t=function t4e(){var e,t,n,i;for(XE("/"===(e=Te[ee]),"Regular expression literal must start with a slash"),t=Te[ee++],n=!1,i=!1;ee<Sr;)if(t+=e=Te[ee++],"\\"===e)Nv((e=Te[ee++]).charCodeAt(0))&&Lt({},L3),t+=e;else if(Nv(e.charCodeAt(0)))Lt({},L3);else if(n)"]"===e&&(n=!1);else{if("/"===e){i=!0;break}"["===e&&(n=!0)}return i||Lt({},L3),{value:t.substr(1,t.length-2),literal:t}}(),n=function n4e(){var e,t,n;for(t="",n="";ee<Sr&&QE((e=Te[ee]).charCodeAt(0));)++ee,"\\"===e&&ee<Sr?Lt({},$i,er):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Lt({},P3,n),{value:n,literal:t}}(),i=function e4e(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";Lt({},P3)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(i){Lt({},P3)}try{return new RegExp(e,t)}catch(i){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:ee}}()),Gte()):ZE(Ds())}return n}function m4e(){const e=[];if(xr("("),!Cn(")"))for(;ee<Sr&&(e.push(kh()),!Cn(")"));)xr(",");return xr(")"),e}function v4e(){xr("[");const e=U3();return xr("]"),e}function Xte(){const e=function b4e(){var e;for(e=g4e();;)if(Cn("."))e=Yte(".",e,(xr("."),function _4e(){ee=Xt.start;const e=Ds();return function r4e(e){return 3===e.type||4===e.type||1===e.type||5===e.type}(e)||ZE(e),V3(e.value)}()));else if(Cn("("))e=o4e(e,m4e());else{if(!Cn("["))break;e=Yte("[",e,v4e())}return e}();if(7===Xt.type&&(Cn("++")||Cn("--")))throw new Error(Tv);return e}function eS(){var e,t;if(7!==Xt.type&&4!==Xt.type)t=Xte();else{if(Cn("++")||Cn("--"))throw new Error(Tv);if(Cn("+")||Cn("-")||Cn("~")||Cn("!"))e=Ds(),t=eS(),t=function u4e(e,t){const n=new Ha("UnaryExpression");return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if(H3("delete")||H3("void")||H3("typeof"))throw new Error(Tv);t=Xte()}}return t}function Qte(e){let t=0;if(7!==e.type&&4!==e.type)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function kh(){var e,t;return e=function w4e(){var e,t,n,i,r,s,o,a,l,u;if(e=Xt,l=eS(),0===(r=Qte(i=Xt)))return l;for(i.prec=r,Ds(),t=[e,Xt],s=[l,i,o=eS()];(r=Qte(Xt))>0;){for(;s.length>2&&r<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,l=s.pop(),t.pop(),n=Wte(a,l,o),s.push(n);(i=Ds()).prec=r,s.push(i),t.push(Xt),n=eS(),s.push(n)}for(n=s[u=s.length-1],t.pop();u>1;)t.pop(),n=Wte(s[u-1].value,s[u-2],n),u-=2;return n}(),Cn("?")&&(Ds(),t=kh(),xr(":"),e=function a4e(e,t,n){const i=new Ha("ConditionalExpression");return i.test=e,i.consequent=t,i.alternate=n,i}(e,t,kh())),e}function U3(){const e=kh();if(Cn(","))throw new Error(Tv);return e}function z3(e){ee=0,Sr=(Te=e).length,Xt=null,Gte();const t=U3();if(2!==Xt.type)throw new Error("Unexpect token after expression.");return t}var Zte={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function ene(e){function n(o,a,l){return u=>function t(o,a,l,u){let c=e(a[0]);return l&&(c=l+"("+c+")",0===l.lastIndexOf("new ",0)&&(c="("+c+")")),c+"."+o+(u<0?"":0===u?"()":"("+a.slice(1).map(e).join(",")+")")}(o,u,a,l)}const i="new Date",r="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&te("Missing arguments to clamp function."),o.length>3&&te("Too many arguments to clamp function.");const a=o.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:n("getDate",i,0),day:n("getDay",i,0),year:n("getFullYear",i,0),month:n("getMonth",i,0),hours:n("getHours",i,0),minutes:n("getMinutes",i,0),seconds:n("getSeconds",i,0),milliseconds:n("getMilliseconds",i,0),time:n("getTime",i,0),timezoneoffset:n("getTimezoneOffset",i,0),utcdate:n("getUTCDate",i,0),utcday:n("getUTCDay",i,0),utcyear:n("getUTCFullYear",i,0),utcmonth:n("getUTCMonth",i,0),utchours:n("getUTCHours",i,0),utcminutes:n("getUTCMinutes",i,0),utcseconds:n("getUTCSeconds",i,0),utcmilliseconds:n("getUTCMilliseconds",i,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",r,0),lower:n("toLowerCase",r,0),substring:n("substring",r),split:n("split",r),trim:n("trim",r,0),regexp:s,test:n("test",s),if:function(o){o.length<3&&te("Missing arguments to if function."),o.length>3&&te("Too many arguments to if function.");const a=o.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function tne(e){const t=(e=e||{}).allowed?Aa(e.allowed):{},n=e.forbidden?Aa(e.forbidden):{},i=e.constants||Zte,r=(e.functions||ene)(d),s=e.globalvar,o=e.fieldvar,a=st(s)?s:p=>`${s}["${p}"]`;let l={},u={},c=0;function d(p){if(be(p))return p;const g=f[p.type];return null==g&&te("Unsupported type: "+p.type),g(p)}const f={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:Fe(n,g)?te("Illegal identifier: "+g):Fe(i,g)?i[g]:Fe(t,g)?g:(l[g]=1,a(g))},MemberExpression:p=>{const g=!p.computed,m=d(p.object);g&&(c+=1);const _=d(p.property);return m===o&&(u[function D4e(e){const t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}(_)]=1),g&&(c-=1),m+(g?"."+_:"["+_+"]")},CallExpression:p=>{"Identifier"!==p.callee.type&&te("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,_=Fe(r,g)&&r[g];return _||te("Unrecognized function: "+g),st(_)?_(m):_+"("+m.map(d).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(d).join(",")+"]",BinaryExpression:p=>"("+d(p.left)+" "+p.operator+" "+d(p.right)+")",UnaryExpression:p=>"("+p.operator+d(p.argument)+")",ConditionalExpression:p=>"("+d(p.test)+"?"+d(p.consequent)+":"+d(p.alternate)+")",LogicalExpression:p=>"("+d(p.left)+p.operator+d(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(d).join(",")+"}",Property:p=>{c+=1;const g=d(p.key);return c-=1,g+":"+d(p.value)}};function h(p){const g={code:d(p),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},g}return h.functions=r,h.constants=i,h}var nne,ine,q3,G3,W3,tS=new Qi,nS=new Qi,Gl={point:Zi,lineStart:Zi,lineEnd:Zi,polygonStart:function(){tS=new Qi,Gl.lineStart=C4e,Gl.lineEnd=E4e},polygonEnd:function(){var e=+tS;nS.add(e<0?qr+e:e),this.lineStart=this.lineEnd=this.point=Zi},sphere:function(){nS.add(qr)}};function C4e(){Gl.point=S4e}function E4e(){rne(nne,ine)}function S4e(e,t){Gl.point=rne,nne=e,ine=t,q3=e*=ht,G3=Ue(t=(t*=ht)/2+QC),W3=Pe(t)}function rne(e,t){var n=(e*=ht)-q3,i=n>=0?1:-1,r=i*n,s=Ue(t=(t*=ht)/2+QC),o=Pe(t),a=W3*o,l=G3*s+a*Ue(r),u=a*i*Pe(r);tS.add(Uo(u,l)),q3=e,G3=s,W3=o}var jn,Cs,Yn,oo,Ih,sne,one,Tm,Rv,jd,nc,ic={point:Y3,lineStart:lne,lineEnd:une,polygonStart:function(){ic.point=cne,ic.lineStart=A4e,ic.lineEnd=M4e,Rv=new Qi,Gl.polygonStart()},polygonEnd:function(){Gl.polygonEnd(),ic.point=Y3,ic.lineStart=lne,ic.lineEnd=une,tS<0?(jn=-(Yn=180),Cs=-(oo=90)):Rv>$e?oo=90:Rv<-$e&&(Cs=-90),nc[0]=jn,nc[1]=Yn},sphere:function(){jn=-(Yn=180),Cs=-(oo=90)}};function Y3(e,t){jd.push(nc=[jn=e,Yn=e]),t<Cs&&(Cs=t),t>oo&&(oo=t)}function ane(e,t){var n=mh([e*ht,t*ht]);if(Tm){var i=hm(Tm,n),s=hm([i[1],-i[0],0],i);fE(s),s=uE(s);var u,o=e-Ih,a=o>0?1:-1,l=s[0]*ri*a,c=St(o)>180;c^(a*Ih<l&&l<a*e)?(u=s[1]*ri)>oo&&(oo=u):c^(a*Ih<(l=(l+360)%360-180)&&l<a*e)?(u=-s[1]*ri)<Cs&&(Cs=u):(t<Cs&&(Cs=t),t>oo&&(oo=t)),c?e<Ih?ao(jn,e)>ao(jn,Yn)&&(Yn=e):ao(e,Yn)>ao(jn,Yn)&&(jn=e):Yn>=jn?(e<jn&&(jn=e),e>Yn&&(Yn=e)):e>Ih?ao(jn,e)>ao(jn,Yn)&&(Yn=e):ao(e,Yn)>ao(jn,Yn)&&(jn=e)}else jd.push(nc=[jn=e,Yn=e]);t<Cs&&(Cs=t),t>oo&&(oo=t),Tm=n,Ih=e}function lne(){ic.point=ane}function une(){nc[0]=jn,nc[1]=Yn,ic.point=Y3,Tm=null}function cne(e,t){if(Tm){var n=e-Ih;Rv.add(St(n)>180?n+(n>0?360:-360):n)}else sne=e,one=t;Gl.point(e,t),ane(e,t)}function A4e(){Gl.lineStart()}function M4e(){cne(sne,one),Gl.lineEnd(),St(Rv)>$e&&(jn=-(Yn=180)),nc[0]=jn,nc[1]=Yn,Tm=null}function ao(e,t){return(t-=e)<0?t+360:t}function T4e(e,t){return e[0]-t[0]}function dne(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var Fv,iS,rS,sS,oS,aS,lS,uS,K3,J3,X3,fne,hne,es,ts,ns,Ua={sphere:Zi,point:Q3,lineStart:pne,lineEnd:gne,polygonStart:function(){Ua.lineStart=I4e,Ua.lineEnd=R4e},polygonEnd:function(){Ua.lineStart=pne,Ua.lineEnd=gne}};function Q3(e,t){e*=ht;var n=Ue(t*=ht);Pv(n*Ue(e),n*Pe(e),Pe(t))}function Pv(e,t,n){++Fv,rS+=(e-rS)/Fv,sS+=(t-sS)/Fv,oS+=(n-oS)/Fv}function pne(){Ua.point=N4e}function N4e(e,t){e*=ht;var n=Ue(t*=ht);es=n*Ue(e),ts=n*Pe(e),ns=Pe(t),Ua.point=k4e,Pv(es,ts,ns)}function k4e(e,t){e*=ht;var n=Ue(t*=ht),i=n*Ue(e),r=n*Pe(e),s=Pe(t),o=Uo(Gr((o=ts*s-ns*r)*o+(o=ns*i-es*s)*o+(o=es*r-ts*i)*o),es*i+ts*r+ns*s);iS+=o,aS+=o*(es+(es=i)),lS+=o*(ts+(ts=r)),uS+=o*(ns+(ns=s)),Pv(es,ts,ns)}function gne(){Ua.point=Q3}function I4e(){Ua.point=F4e}function R4e(){mne(fne,hne),Ua.point=Q3}function F4e(e,t){fne=e,hne=t,e*=ht,t*=ht,Ua.point=mne;var n=Ue(t);es=n*Ue(e),ts=n*Pe(e),ns=Pe(t),Pv(es,ts,ns)}function mne(e,t){e*=ht;var n=Ue(t*=ht),i=n*Ue(e),r=n*Pe(e),s=Pe(t),o=ts*s-ns*r,a=ns*i-es*s,l=es*r-ts*i,u=IF(o,a,l),c=ys(u),d=u&&-c/u;K3.add(d*o),J3.add(d*a),X3.add(d*l),iS+=c,aS+=c*(es+(es=i)),lS+=c*(ts+(ts=r)),uS+=c*(ns+(ns=s)),Pv(es,ts,ns)}function _ne(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function $4e(e){return e instanceof iC?e:new iC(e)}const Z3="intersect",Wl="_vgsid_",Lv=ds(Wl),cS="index:unit";function bne(e,t){for(var o,a,n=t.fields,i=t.values,r=n.length,s=0;s<r;++s)if((a=n[s]).getter=ds.getter||ds(a.field),Yc(o=a.getter(e))&&(o=_r(o)),Yc(i[s])&&(i[s]=_r(i[s])),Yc(i[s][0])&&(i[s]=i[s].map(_r)),"E"===a.type){if(ie(i[s])?i[s].indexOf(o)<0:o!==i[s])return!1}else if("R"===a.type){if(!Ng(o,i[s]))return!1}else if("R-RE"===a.type){if(!Ng(o,i[s],!0,!1))return!1}else if("R-E"===a.type){if(!Ng(o,i[s],!1,!1))return!1}else if("R-LE"===a.type&&!Ng(o,i[s],!1,!0))return!1;return!0}const wne=function L4e(e){let t=e,n=e,i=e;function r(a,l,u=0,c=a.length){if(u<c){if(0!==n(l,l))return c;do{const d=u+c>>>1;i(a[d],l)<0?u=d+1:c=d}while(u<c)}return u}return 2!==e.length&&(t=(a,l)=>e(a)-l,n=_ne,i=(a,l)=>_ne(e(a),l)),{left:r,center:function o(a,l,u=0,c=a.length){const d=r(a,l,u,c-1);return d>u&&t(a[d-1],l)>-t(a[d],l)?d-1:d},right:function s(a,l,u=0,c=a.length){if(u<c){if(0!==n(l,l))return c;do{const d=u+c>>>1;i(a[d],l)<=0?u=d+1:c=d}while(u<c)}return u}}}(Lv),J4e=wne.left,X4e=wne.right;var eL={["".concat(Wl,"_union")]:function j4e(...e){const t=new iC;for(const n of e)for(const i of n)t.add(i);return t},["".concat(Wl,"_intersect")]:function B4e(e,...t){e=new iC(e),t=t.map($4e);e:for(const n of e)for(const i of t)if(!i.has(n)){e.delete(n);continue e}return e},E_union:function(e,t){if(!e.length)return t;for(var n=0,i=t.length;n<i;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=_r(t[0]),i=_r(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<i&&(e[1]=i),e):[n,i]},R_intersect:function(e,t){var n=_r(t[0]),i=_r(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?i<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>i&&(e[1]=i),e):[n,i]}};function tL(e,t,n,i){t[0].type!==Th&&te("First argument to selection functions must be a string literal.");const r=t[0].value,o="unit",a="@"+o,l=":"+r;(t.length>=2&&bt(t).value)===Z3&&!Fe(i,a)&&(i[a]=n.getData(r).indataRef(n,o)),Fe(i,l)||(i[l]=n.getData(r).tuplesRef())}function Dne(e){const t=this.context.data[e];return t?t.values.value:[]}const jv=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},o8e=jv("format"),Cne=jv("timeFormat"),a8e=jv("utcFormat"),l8e=jv("timeParse"),u8e=jv("utcParse"),dS=new Date(2e3,0,1);function fS(e,t,n){return Number.isInteger(e)&&Number.isInteger(t)?(dS.setYear(2e3),dS.setMonth(e),dS.setDate(t),Cne.call(this,dS,n)):""}function iL(e,t,n,i){t[0].type!==Th&&te("First argument to data functions must be a string literal.");const r=t[0].value,s=":"+r;if(!Fe(s,i))try{i[s]=n.getData(r).tuplesRef()}catch(o){}}function Es(e,t,n,i){if(t[0].type===Th)Sne(n,i,t[0].value);else for(e in n.scales)Sne(n,i,e)}function Sne(e,t,n){const i="%"+n;if(!Fe(t,i))try{t[i]=e.scaleRef(n)}catch(r){}}function rc(e,t){let n;return st(e)?e:be(e)?(n=t.scales[e])&&n.value:void 0}function rL(e,t){return function(n,i,r){if(n){const s=rc(n,(r||this).context);return s&&s.path[e](i)}return t(i)}}const y8e=rL("area",function x4e(e){return nS=new Qi,Xu(e,Gl),2*nS}),v8e=rL("bounds",function O4e(e){var t,n,i,r,s,o,a;if(oo=Yn=-(jn=Cs=1/0),jd=[],Xu(e,ic),n=jd.length){for(jd.sort(T4e),t=1,s=[i=jd[0]];t<n;++t)dne(i,(r=jd[t])[0])||dne(i,r[1])?(ao(i[0],r[1])>ao(i[0],i[1])&&(i[1]=r[1]),ao(r[0],i[1])>ao(i[0],i[1])&&(i[0]=r[0])):s.push(i=r);for(o=-1/0,t=0,i=s[n=s.length-1];t<=n;i=r,++t)(a=ao(i[1],(r=s[t])[0]))>o&&(o=a,jn=r[0],Yn=i[1])}return jd=nc=null,jn===1/0||Cs===1/0?[[NaN,NaN],[NaN,NaN]]:[[jn,Cs],[Yn,oo]]}),b8e=rL("centroid",function P4e(e){Fv=iS=rS=sS=oS=aS=lS=uS=0,K3=new Qi,J3=new Qi,X3=new Qi,Xu(e,Ua);var t=+K3,n=+J3,i=+X3,r=IF(t,n,i);return r<XC&&(t=aS,n=lS,i=uS,iS<$e&&(t=rS,n=sS,i=oS),(r=IF(t,n,i))<XC)?[NaN,NaN]:[Uo(n,t)*ri,ys(i/r)*ri]});function sL(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(i){e.warn(i)}return n[n.length-1]}function oL(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function aL(e){const t=cd(e);return.2126*oL(t.r)+.7152*oL(t.g)+.0722*oL(t.b)}function xne(e,t){return e===t||e!=e&&t!=t||(ie(e)?!(!ie(t)||e.length!==t.length)&&function A8e(e,t){for(let n=0,i=e.length;n<i;++n)if(!xne(e[n],t[n]))return!1;return!0}(e,t):!(!Se(e)||!Se(t))&&Ane(e,t))}function Ane(e,t){for(const n in e)if(!xne(e[n],t[n]))return!1;return!0}function Mne(e){return t=>Ane(e,t)}const Tne={};function lL(e){return ie(e)||ArrayBuffer.isView(e)?e:null}function uL(e){return lL(e)||(be(e)?e:null)}const One=e=>e.data;function Nne(e,t){const n=Dne.call(t,e);return n.root&&n.root.lookup||{}}const kne=()=>"undefined"!=typeof window&&window||null;function Ine(e,t,n){if(!e)return[];const[i,r]=e,s=(new fi).set(i[0],i[1],r[0],r[1]);return wQ(n||this.context.dataflow.scenegraph().root,s,function Z8e(e){let t=null;if(e){const n=we(e.marktype),i=we(e.markname);t=r=>(!n.length||n.some(s=>r.marktype===s))&&(!i.length||i.some(s=>r.name===s))}return t}(t))}const Bv={random:()=>jo(),cumulativeNormal:RD,cumulativeLogNormal:zk,cumulativeUniform:Yk,densityNormal:Bk,densityLogNormal:Uk,densityUniform:Wk,quantileNormal:FD,quantileLogNormal:qk,quantileUniform:Kk,sampleNormal:ID,sampleLogNormal:Hk,sampleUniform:Gk,isArray:ie,isBoolean:Wc,isDate:Yc,isDefined:e=>void 0!==e,isNumber:nn,isObject:Se,isRegExp:cG,isString:be,isTuple:SD,isValid:e=>null!=e&&e==e,toBoolean:NN,toDate:e=>kN(e),toNumber:_r,toString:IN,indexof:function I8e(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return uL(e).indexOf(...n)},join:function k8e(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return lL(e).join(...n)},lastindexof:function R8e(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return uL(e).lastIndexOf(...n)},replace:function P8e(e,t,n){return st(n)&&te("Function argument passed to replace."),String(e).replace(t,n)},reverse:function L8e(e){return lL(e).slice().reverse()},slice:function F8e(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return uL(e).slice(...n)},flush:lG,lerp:dG,merge:function x8e(){const e=[].slice.call(arguments);return e.unshift({}),ot(...e)},pad:pG,peek:bt,pluck:function N8e(e,t){const n=Tne[t]||(Tne[t]=ds(t));return ie(e)?e.map(n):n(e)},span:Q_,inrange:Ng,truncate:gG,rgb:cd,lab:oC,hcl:aC,hsl:JD,luminance:aL,contrast:function S8e(e,t){const n=aL(e),i=aL(t);return(Math.max(n,i)+.05)/(Math.min(n,i)+.05)},sequence:Qs,format:o8e,utcFormat:a8e,utcParse:u8e,utcOffset:tW,utcSequence:rW,timeFormat:Cne,timeParse:l8e,timeOffset:eW,timeSequence:iW,timeUnitSpecifier:UG,monthFormat:function c8e(e){return fS.call(this,e,1,"%B")},monthAbbrevFormat:function d8e(e){return fS.call(this,e,1,"%b")},dayFormat:function f8e(e){return fS.call(this,0,2+e,"%A")},dayAbbrevFormat:function h8e(e){return fS.call(this,0,2+e,"%a")},quarter:rG,utcquarter:sG,week:qG,utcweek:YG,dayofyear:zG,utcdayofyear:WG,warn:function D8e(){return sL(this.context.dataflow,"warn",arguments)},info:function C8e(){return sL(this.context.dataflow,"info",arguments)},debug:function E8e(){return sL(this.context.dataflow,"debug",arguments)},extent:e=>Al(e),inScope:function w8e(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n},intersect:Ine,clampRange:oG,pinchDistance:function T8e(e){const t=e.touches,n=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+i*i)},pinchAngle:function O8e(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)},screen:function J8e(){const e=kne();return e?e.screen:{}},containerSize:function Q8e(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]},windowSize:function X8e(){const e=kne();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]},bandspace:function j8e(e,t,n){return fR(e||0,t||0,n||0)},setdata:function r8e(e,t){const n=this.context.dataflow;return n.pulse(this.context.data[e].input,n.changeset().remove(Fo).insert(t)),1},pathShape:function W8e(e){let t=null;return function(n){return n?Ry(n,t=t||em(e)):e}},panLinear:eG,panLog:tG,panPow:nG,panSymlog:iG,zoomLinear:SN,zoomLog:xN,zoomPow:aD,zoomSymlog:AN,encode:function s8e(e,t,n){if(e){const i=this.context.dataflow;i.pulse(e.mark.source,i.changeset().encode(e,t))}return void 0!==n?n:e},modify:function M8e(e,t,n,i,r,s){const o=this.context.dataflow,a=this.context.data[e],l=a.input,u=o.stamp();let d,f,c=a.changes;if(!1===o._trigger||!(l.value.length||t||i))return 0;if((!c||c.stamp<u)&&(a.changes=c=o.changeset(),c.stamp=u,o.runAfter(()=>{a.modified=!0,o.pulse(l,c).run()},!0,1)),n&&(d=!0===n?Fo:ie(n)||SD(n)?n:Mne(n),c.remove(d)),t&&c.insert(t),i&&(d=Mne(i),l.value.some(d)?c.remove(d):c.insert(i)),r)for(f in s)c.modify(r,f,s[f]);return 1},lassoAppend:function e$e(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;const r=e[e.length-1];return void 0===r||Math.sqrt((r[0]-t)**2+(r[1]-n)**2)>i?(e.push([t,n]),[...e]):e},lassoPath:function t$e(e){return(null!=e?e:[]).reduce((t,n,i)=>{let[r,s]=n;return t+(0==i?"M ".concat(r,",").concat(s," "):i===e.length-1?" Z":"L ".concat(r,",").concat(s," "))},"")},intersectLasso:function n$e(e,t,n){const{x:i,y:r,mark:s}=n,o=(new fi).set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[l,u]of t)l<o.x1&&(o.x1=l),l>o.x2&&(o.x2=l),u<o.y1&&(o.y1=u),u>o.y2&&(o.y2=u);return o.translate(i,r),Ine([[o.x1,o.y1],[o.x2,o.y2]],e,s).filter(l=>function i$e(e,t,n){let i=0;for(let r=0,s=n.length-1;r<n.length;s=r++){const[o,a]=n[s],[l,u]=n[r];u>t!=a>t&&e<(o-l)*(t-u)/(a-u)+l&&i++}return 1&i}(l.x,l.y,t))}},r$e=["view","item","group","xy","x","y"],cL={},Fne={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>"_[".concat(pe("$"+e),"]"),functions:function o$e(e){const t=ene(e);r$e.forEach(n=>t[n]="event.vega."+n);for(const n in Bv)t[n]="this."+n;return ot(t,function _8e(e,t,n){t.__bandwidth=r=>r&&r.bandwidth?r.bandwidth():0,n._bandwidth=Es,n._range=Es,n._scale=Es;const i=r=>"_["+(r.type===Th?pe("%"+r.value):pe("%")+"+"+e(r))+"]";return{_bandwidth:r=>"this.__bandwidth(".concat(i(r[0]),")"),_range:r=>"".concat(i(r[0]),".range()"),_scale:r=>"".concat(i(r[0]),"(").concat(e(r[1]),")")}}(e,Bv,cL)),t},constants:Zte,visitors:cL},dL=tne(Fne);function hi(e,t,n){return 1===arguments.length?Bv[e]:(Bv[e]=t,n&&(cL[e]=n),dL&&(dL.functions[e]="this."+e),this)}function Yl(e,t){const n={};let i;try{i=z3(e=be(e)?e:pe(e)+"")}catch(s){te("Expression parse error: "+e)}i.visit(s=>{if(s.type!==Bte)return;const o=s.callee.name,a=Fne.visitors[o];a&&a(o,s.arguments,t,n)});const r=dL(i);return r.globals.forEach(s=>{const o="$"+s;!Fe(n,o)&&t.getSignal(s)&&(n[o]=t.signalRef(s))}),{$expr:ot({code:r.code},t.options.ast?{ast:i}:null),$fields:r.fields,$params:n}}hi("bandwidth",function B8e(e,t){const n=rc(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0},Es),hi("copy",function $8e(e,t){const n=rc(e,(t||this).context);return n?n.copy():void 0},Es),hi("domain",function V8e(e,t){const n=rc(e,(t||this).context);return n?n.domain():[]},Es),hi("range",function U8e(e,t){const n=rc(e,(t||this).context);return n&&n.range?n.range():[]},Es),hi("invert",function H8e(e,t,n){const i=rc(e,(n||this).context);return i?ie(t)?(i.invertRange||i.invert)(t):(i.invert||i.invertExtent)(t):void 0},Es),hi("scale",function z8e(e,t,n){const i=rc(e,(n||this).context);return i?i(t):void 0},Es),hi("gradient",function q8e(e,t,n,i,r){e=rc(e,(r||this).context);const s=aX(t,n);let o=e.domain(),a=o[0],l=bt(o),u=mr;return l-a?u=GJ(e,a,l):e=(e.interpolator?Pt("sequential")().interpolator(e.interpolator()):Pt("linear")().interpolate(e.interpolate()).range(e.range())).domain([a=0,l=1]),e.ticks&&(o=e.ticks(+i||15),a!==o[0]&&o.unshift(a),l!==bt(o)&&o.push(l)),o.forEach(c=>s.stop(u(c),e(c))),s},Es),hi("geoArea",y8e,Es),hi("geoBounds",v8e,Es),hi("geoCentroid",b8e,Es),hi("geoShape",function G8e(e,t,n){const i=rc(e,(n||this).context);return function(r){return i?i.path.context(r)(t):""}},Es),hi("indata",function i8e(e,t,n){const i=this.context.data[e]["index:"+t],r=i?i.value.get(n):void 0;return r&&r.count},function m8e(e,t,n,i){t[0].type!==Th&&te("First argument to indata must be a string literal."),t[1].type!==Th&&te("Second argument to indata must be a string literal.");const r=t[0].value,s=t[1].value,o="@"+s;Fe(o,i)||(i[o]=n.getData(r).indataRef(n,s))}),hi("data",Dne,iL),hi("treePath",function Y8e(e,t,n){const i=Nne(e,this),r=i[t],s=i[n];return r&&s?r.path(s).map(One):void 0},iL),hi("treeAncestors",function K8e(e,t){const n=Nne(e,this)[t];return n?n.ancestors().map(One):void 0},iL),hi("vlSelectionTest",function K4e(e,t,n){for(var u,c,d,f,h,i=this.context.data[e],r=i?i.values.value:[],s=i?i[cS]&&i[cS].value:void 0,o=n===Z3,a=r.length,l=0;l<a;++l)if(u=r[l],s&&o){if(-1===(d=(c=c||{})[f=u.unit]||0))continue;if(h=bne(t,u),c[f]=h?-1:++d,h&&1===s.size)return!0;if(!h&&d===s.get(f).count)return!1}else if(o^(h=bne(t,u)))return h;return a&&o},tL),hi("vlSelectionIdTest",function Q4e(e,t,n){const i=this.context.data[e],r=i?i.values.value:[],s=i?i[cS]&&i[cS].value:void 0,o=n===Z3,a=Lv(t),l=J4e(r,a);if(l===r.length||Lv(r[l])!==a)return!1;if(s&&o){if(1===s.size)return!0;if(X4e(r,a)-l<s.size)return!1}return!0},tL),hi("vlSelectionResolve",function e8e(e,t,n,i){for(var u,c,d,f,h,p,g,m,_,y,D,C,r=this.context.data[e],s=r?r.values.value:[],o={},a={},l={},v=s.length,b=0;b<v;++b)if(f=(u=s[b]).unit,d=u.values,(c=u.fields)&&d){for(D=0,C=c.length;D<C;++D)m=(g=o[(h=c[D]).field]||(o[h.field]={}))[f]||(g[f]=[]),l[h.field]=_=h.type.charAt(0),y=eL["".concat(_,"_union")],g[f]=y(m,we(d[D]));n&&(m=a[f]||(a[f]=[])).push(we(d).reduce((w,E,N)=>(w[c[N].field]=E,w),{}))}else h=Wl,p=Lv(u),(m=(g=o[h]||(o[h]={}))[f]||(g[f]=[])).push(p),n&&(m=a[f]||(a[f]=[])).push({[Wl]:p});return t=t||"union",o[Wl]?o[Wl]=eL["".concat(Wl,"_").concat(t)](...Object.values(o[Wl])):Object.keys(o).forEach(w=>{o[w]=Object.keys(o[w]).map(E=>o[w][E]).reduce((E,N)=>void 0===E?N:eL["".concat(l[w],"_").concat(t)](E,N))}),s=Object.keys(a),n&&s.length&&(o[i?"vlPoint":"vlMulti"]="union"===t?{or:s.reduce((E,N)=>(E.push(...a[N]),E),[])}:{and:s.map(E=>({or:a[E]}))}),o},tL),hi("vlSelectionTuples",function Z4e(e,t){return e.map(n=>ot(t.fields?{values:t.fields.map(i=>(i.getter||(i.getter=ds(i.field)))(n.datum))}:{[Wl]:Lv(n.datum)},t))});const l$e=Aa(["rule"]),Pne=Aa(["group","image","rect"]);function fL(e){return(e+"").toLowerCase()}function $v(e,t,n){";"!==n[n.length-1]&&(n="return("+n+");");const i=Function(...t.concat(n));return e&&e.functions?i.bind(e.functions):i}var h$e={operator:(e,t)=>$v(e,["_"],t.code),parameter:(e,t)=>$v(e,["datum","_"],t.code),event:(e,t)=>$v(e,["event"],t.code),handler:(e,t)=>$v(e,["_","event"],"var datum=event.item&&event.item.datum;return ".concat(t.code,";")),encode:(e,t)=>{const{marktype:n,channels:i}=t;let r="var o=item,datum=o.datum,m=0,$;";for(const s in i){const o="o["+pe(s)+"]";r+="$=".concat(i[s].code,";if(").concat(o,"!==$)").concat(o,"=$,m=1;")}return r+=function u$e(e,t){let n="";return l$e[t]||(e.x2&&(e.x?(Pne[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(Pne[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(i,n),r+="return m;",$v(e,["item","_"],r)},codegen:{get(e){const t="[".concat(e.map(pe).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator(e,t){let n;const r=Function("a","b","var u, v; return "+e.map((s,o)=>{const a=t[o];let l,u;return s.path?(l="a".concat(s.path),u="b".concat(s.path)):((n=n||{})["f"+o]=s,l="this.f".concat(o,"(a)"),u="this.f".concat(o,"(b)")),function f$e(e,t,n,i){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(i,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(i," : ")}(l,u,-a,a)}).join("")+"0;");return n?r.bind(n):r}}};function Lne(e,t,n){if(!e||!Se(e))return e;for(let s,i=0,r=jne.length;i<r;++i)if(s=jne[i],Fe(e,s.key))return s.parse(e,t,n);return e}var jne=[{key:"$ref",parse:function _$e(e,t){return t.get(e.$ref)||te("Operator not defined: "+e.$ref)}},{key:"$key",parse:function v$e(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=ON(e.$key,e.$flat,t.expr.codegen))}},{key:"$expr",parse:function y$e(e,t,n){e.$params&&t.parseParameters(e.$params,n);const i="e:"+e.$expr.code+"_"+e.$name;return t.fn[i]||(t.fn[i]=cs(t.parameterExpression(e.$expr),e.$fields,e.$name))}},{key:"$field",parse:function b$e(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=ds(e.$field,e.$name,t.expr.codegen))}},{key:"$encode",parse:function D$e(e,t){const n=e.$encode,i={};for(const r in n){const s=n[r];i[r]=cs(t.encodeExpression(s.$expr),s.$fields),i[r].output=s.$output}return i}},{key:"$compare",parse:function w$e(e,t){const n="c:"+e.$compare+"_"+e.$order,i=we(e.$compare).map(r=>r&&r.$tupleid?je:r);return t.fn[n]||(t.fn[n]=MN(i,e.$order,t.expr.codegen))}},{key:"$context",parse:function C$e(e,t){return t}},{key:"$subflow",parse:function E$e(e,t){const n=e.$subflow;return function(i,r,s){const o=t.fork().parse(n),a=o.get(n.operators[0].id),l=o.signals.parent;return l&&l.set(s),a.detachSubflow=()=>t.detach(o),a}}},{key:"$tupleid",parse:function S$e(){return je}}];const M$e={skip:!0};function Bne(e,t,n,i){return new $ne(e,t,n,i)}function $ne(e,t,n,i){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=i||h$e,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function Vne(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}function Hne(e,t){e&&(null==t?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}$ne.prototype=Vne.prototype={fork(){const e=new Vne(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,i=n.dataflow,r=e.value;if(n.set(e.id,t),function d$e(e){return"collect"===fL(e)}(e.type)&&r&&(r.$ingest?i.ingest(t,r.$ingest,r.$format):r.$request?i.preload(t,r.$request,r.$format):i.pulse(t,i.changeset().insert(r))),e.root&&(n.root=t),e.parent){let s=n.get(e.parent.$ref);s?(i.connect(s,[t]),t.targets().add(s)):(n.unresolved=n.unresolved||[]).push(()=>{s=n.get(e.parent.$ref),i.connect(s,[t]),t.targets().add(s)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const s in e.data){const o=n.data[s]||(n.data[s]={});e.data[s].forEach(a=>o[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[fL(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,i,r){this.dataflow.on(t,n,i,r,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:function a$e(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(i=>t.parseOperator(i)),n.forEach(i=>t.parseOperatorParameters(i)),(e.streams||[]).forEach(i=>t.parseStream(i)),(e.updates||[]).forEach(i=>t.parseUpdate(i)),t.resolve()},parseOperator:function p$e(e){const t=this;!function c$e(e){return"operator"===fL(e)}(e.type)&&e.type?t.transform(e,e.type):t.operator(e,e.update?t.operatorExpression(e.update):null)},parseOperatorParameters:function g$e(e){const t=this;if(e.params){const n=t.get(e.id);n||te("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}},parseParameters:function m$e(e,t){t=t||{};const n=this;for(const i in e){const r=e[i];t[i]=ie(r)?r.map(s=>Lne(s,n,t)):Lne(r,n,t)}return t},parseStream:function x$e(e){var r,t=this,n=null!=e.filter?t.eventExpression(e.filter):void 0,i=null!=e.stream?t.get(e.stream):void 0;e.source?i=t.events(e.source,e.type,n):e.merge&&(i=(r=e.merge.map(s=>t.get(s)))[0].merge.apply(r[0],r.slice(1))),e.between&&(r=e.between.map(s=>t.get(s)),i=i.between(r[0],r[1])),e.filter&&(i=i.filter(n)),null!=e.throttle&&(i=i.throttle(+e.throttle)),null!=e.debounce&&(i=i.debounce(+e.debounce)),null==i&&te("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),t.stream(e,i)},parseUpdate:function A$e(e){var r,t=this,n=Se(n=e.source)?n.$ref:n,i=t.get(n),s=e.update,o=void 0;i||te("Source not defined: "+e.source),r=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),s&&s.$expr&&(s.$params&&(o=t.parseParameters(s.$params)),s=t.handlerExpression(s.$expr)),t.update(e,i,r,s,o)},getState:function T$e(e){var t=this,n={};if(e.signals){var i=n.signals={};Object.keys(t.signals).forEach(s=>{const o=t.signals[s];e.signals(s,o)&&(i[s]=o.value)})}if(e.data){var r=n.data={};Object.keys(t.data).forEach(s=>{const o=t.data[s];e.data(s,o)&&(r[s]=o.input.value)})}return t.subcontext&&!1!==e.recurse&&(n.subcontext=t.subcontext.map(s=>s.getState(e))),n},setState:function O$e(e){var t=this,n=t.dataflow,i=e.data,r=e.signals;Object.keys(r||{}).forEach(s=>{n.update(t.signals[s],r[s],M$e)}),Object.keys(i||{}).forEach(s=>{n.pulse(t.data[s].input,n.changeset().remove(Fo).insert(i[s]))}),(e.subcontext||[]).forEach((s,o)=>{const a=t.subcontext[o];a&&a.setState(s)})}};const hL="default";function pL(e,t){const n=e.globalCursor()?"undefined"!=typeof document&&document.body:e.container();if(n)return null==t?n.style.removeProperty("cursor"):n.style.cursor=t}function hS(e,t){var n=e._runtime.data;return Fe(n,t)||te("Unrecognized data set: "+t),n[t]}function pS(e,t){GW(t)||te("Second argument to changes must be a changeset.");const n=hS(this,e);return n.modified=!0,this.pulse(n.input,t)}function Une(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function zne(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function gS(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}const U$e={trap:!1};function Gne(e,t,n,i){e._eventListeners.push({type:n,sources:we(t),handler:i})}function mS(e,t,n){const i=e._eventConfig&&e._eventConfig[t];return!(!1===i||Se(i)&&!i[n])||(e.warn("Blocked ".concat(t," ").concat(n," event listener.")),!1)}function Wne(e){return e.item}function Yne(e){return e.item.mark.source}function Kne(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function lo(e,t,n){const i=document.createElement(e);for(const r in t)i.setAttribute(r,t[r]);return null!=n&&(i.textContent=n),i}function Q$e(e,t,n){if(!t)return;const i=n.param;let r=n.state;return r||(r=n.state={elements:null,active:!1,set:null,update:o=>{o!=e.signal(i.signal)&&e.runAsync(null,()=>{r.source=!0,e.signal(i.signal,o)})}},i.debounce&&(r.update=TN(i.debounce,r.update))),(null==i.input&&i.element?Z$e:t6e)(r,t,i,e),r.active||(e.on(e._signals[i.signal],null,()=>{r.source?r.source=!1:r.set(e.signal(i.signal))}),r.active=!0),r}function Z$e(e,t,n,i){const r=n.event||"input",s=()=>e.update(t.value);i.signal(n.signal,t.value),t.addEventListener(r,s),Gne(i,t,r,s),e.set=o=>{t.value=o,t.dispatchEvent(function e6e(e){return"undefined"!=typeof Event?new Event(e):{type:e}}(r))}}function t6e(e,t,n,i){const r=i.signal(n.signal),s=lo("div",{class:"vega-bind"}),o="radio"===n.input?s:s.appendChild(lo("label"));o.appendChild(lo("span",{class:"vega-bind-name"},n.name||n.signal)),t.appendChild(s);let a=n6e;switch(n.input){case"checkbox":a=i6e;break;case"select":a=r6e;break;case"radio":a=s6e;break;case"range":a=o6e}a(e,o,n,r)}function n6e(e,t,n,i){const r=lo("input");for(const s in n)"signal"!==s&&"element"!==s&&r.setAttribute("input"===s?"type":s,n[s]);r.setAttribute("name",n.signal),r.value=i,t.appendChild(r),r.addEventListener("input",()=>e.update(r.value)),e.elements=[r],e.set=s=>r.value=s}function i6e(e,t,n,i){const r={type:"checkbox",name:n.signal};i&&(r.checked=!0);const s=lo("input",r);t.appendChild(s),s.addEventListener("change",()=>e.update(s.checked)),e.elements=[s],e.set=o=>s.checked=!!o||null}function r6e(e,t,n,i){const r=lo("select",{name:n.signal}),s=n.labels||[];n.options.forEach((o,a)=>{const l={value:o};_S(o,i)&&(l.selected=!0),r.appendChild(lo("option",l,(s[a]||o)+""))}),t.appendChild(r),r.addEventListener("change",()=>{e.update(n.options[r.selectedIndex])}),e.elements=[r],e.set=o=>{for(let a=0,l=n.options.length;a<l;++a)if(_S(n.options[a],o))return void(r.selectedIndex=a)}}function s6e(e,t,n,i){const r=lo("span",{class:"vega-bind-radio"}),s=n.labels||[];t.appendChild(r),e.elements=n.options.map((o,a)=>{const l={type:"radio",name:n.signal,value:o};_S(o,i)&&(l.checked=!0);const u=lo("input",l);u.addEventListener("change",()=>e.update(o));const c=lo("label",{},(s[a]||o)+"");return c.prepend(u),r.appendChild(c),u}),e.set=o=>{const a=e.elements,l=a.length;for(let u=0;u<l;++u)_S(a[u].value,o)&&(a[u].checked=!0)}}function o6e(e,t,n,i){i=void 0!==i?i:(+n.max+ +n.min)/2;const r=null!=n.max?n.max:Math.max(100,+i)||100,s=n.min||Math.min(0,r,+i)||0,o=n.step||Jc(s,r,100),a=lo("input",{type:"range",name:n.signal,min:s,max:r,step:o});a.value=i;const l=lo("span",{},+i);t.appendChild(a),t.appendChild(l);const u=()=>{l.textContent=a.value,e.update(+a.value)};a.addEventListener("input",u),a.addEventListener("change",u),e.elements=[a],e.set=c=>{a.value=c,l.textContent=c}}function _S(e,t){return e===t||e+""==t+""}function Jne(e,t,n,i,r,s){return(t=t||new i(e.loader())).initialize(n,Une(e),zne(e),gS(e),r,s).background(e.background())}function gL(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function mL(e,t,n){if("string"==typeof t){if("undefined"==typeof document)return e.error("DOM document instance not found."),null;if(!(t=document.querySelector(t)))return e.error("Signal bind element not found: "+t),null}if(t&&n)try{t.textContent=""}catch(i){t=null,e.error(i)}return t}const Vv=e=>+e||0;function Xne(e){return Se(e)?{top:Vv(e.top),bottom:Vv(e.bottom),left:Vv(e.left),right:Vv(e.right)}:(e=>({top:e,bottom:e,left:e,right:e}))(Vv(e))}function _L(e,t,n,i){return yL.apply(this,arguments)}function yL(){return yL=Hr(function*(e,t,n,i){const r=zC(t),s=r&&r.headless;return s||te("Unrecognized renderer type: "+t),yield e.runAsync(),Jne(e,null,null,s,n,i).renderAsync(e._scenegraph.root)}),yL.apply(this,arguments)}function vL(){return vL=Hr(function*(e,t){e!==Cd.Canvas&&e!==Cd.SVG&&e!==Cd.PNG&&te("Unrecognized image type: "+e);const n=yield _L(this,e,t);return e===Cd.SVG?d6e(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}),vL.apply(this,arguments)}function d6e(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}function bL(){return bL=Hr(function*(e,t){return(yield _L(this,Cd.Canvas,e,t)).canvas()}),bL.apply(this,arguments)}function wL(){return wL=Hr(function*(e){return(yield _L(this,Cd.SVG,e)).svg()}),wL.apply(this,arguments)}var DL="padding",eie={skip:!0};function tie(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===DL?i.left+i.right:0)}function nie(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===DL?i.top+i.bottom:0)}function v6e(e,t){return t.modified&&ie(t.input.value)&&e.indexOf("_:vega:_")}function b6e(e,t){return!("parent"===e||t instanceof Ug.proxy)}function C6e(e,t,n,i){const r=e.element();r&&r.setAttribute("title",function E6e(e){return null==e?"":ie(e)?iie(e):Se(e)&&!Yc(e)?function S6e(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(ie(n)?iie(n):rie(n))}).join("\n")}(e):e+""}(i))}function iie(e){return"["+e.map(rie).join(", ")+"]"}function rie(e){return ie(e)?"[\u2026]":Se(e)&&!Yc(e)?"{\u2026}":e}function sie(e,t){const n=this;if(t=t||{},Hg.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),null!=t.logLevel&&n.logLevel(t.logLevel),t.locale||e.locale){const s=ot({},e.locale,t.locale);n.locale(RW(s.number,s.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||Cd.Canvas,n._scenegraph=new nF;const i=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||C6e,n._redraw=!0,n._handler=(new Yy).scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function z$e(e){const t=ot({defaults:{}},e),n=(i,r)=>{r.forEach(s=>{ie(i[s])&&(i[s]=Aa(i[s]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const r=function p6e(e,t,n){return Bne(e,Ug,Bv,n).parse(t)}(n,e,t.expr);n._runtime=r,n._signals=r.signals,n._bind=(e.bindings||[]).map(s=>({state:null,param:ot({},s)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=tie(n,n._width),n._viewHeight=nie(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function m6e(e){var t=e._signals,n=t.width,i=t.height,r=t[DL];function s(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=tie(e,a.size),s()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=nie(e,a.size),s()},{size:i});const o=e.add(null,s,{pad:r});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=i.rank+1,o.rank=r.rank+1}(n),function I$e(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}(n),function R$e(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:hL,item:null}));e.on(e.events("view","mousemove"),t,(n,i)=>{const r=t.value,s=r?be(r)?r:r.user:hL,o=i.item&&i.item.cursor||null;return r&&s===r.user&&o==r.item?r:{user:s,item:o}}),e.add(null,function(n){let i=n.cursor,r=this.value;return be(i)||(r=i.item,i=i.user),pL(e,i&&i!==hL?i:r||i),r},{cursor:t})}(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function yS(e,t){return Fe(e._signals,t)?e._signals[t]:te("Unrecognized signal name: "+pe(t))}function oie(e,t){const n=(e._targets||[]).filter(i=>i._update&&i._update.handler===t);return n.length?n[0]:null}function aie(e,t,n,i){let r=oie(n,i);return r||(r=gL(e,()=>i(t,n.value)),r.handler=i,e.on(n,null,r)),e}function lie(e,t,n){const i=oie(t,n);return i&&t._targets.remove(i),e}fe(sie,Hg,{evaluate(e,t,n){var i=this;return Hr(function*(){if(yield Hg.prototype.evaluate.call(i,e,t),i._redraw||i._resize)try{i._renderer&&(i._resize&&(i._resize=0,function j$e(e){var t=gS(e),n=Une(e),i=zne(e);e._renderer.background(e.background()),e._renderer.resize(n,i,t),e._handler.origin(t),e._resizeListeners.forEach(r=>{try{r(n,i)}catch(s){e.error(s)}})}(i)),yield i._renderer.renderAsync(i._scenegraph.root)),i._redraw=!1}catch(r){i.error(r)}return n&&ED(i,n),i})()},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=null!=e?e+"":null;return t!==this._desc&&Hne(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const i=yS(this,e);return 1===arguments.length?i.value:this.update(i,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",Xne(e)):Xne(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(zC(e)||te("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Hg.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(yS(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function _6e(e,t,n,i,r,s){this.runAfter(o=>{let a=0;o._autosize=0,o.width()!==n&&(a=1,o.signal("width",n,eie),o._resizeWidth.skip(!0)),o.height()!==i&&(a=1,o.signal("height",i,eie),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),(o._origin[0]!==r[0]||o._origin[1]!==r[1])&&(o._resize=1,o._origin=r),a&&o.run("enter"),s&&o.runAfter(l=>l.resize())},!1,1)},addEventListener(e,t,n){let i=t;return n&&!1===n.trap||(i=gL(this,t),i.raw=t),this._handler.on(e,i),this},removeEventListener(e,t){for(var r,s,n=this._handler.handlers(e),i=n.length;--i>=0;)if(r=n[i].handler,e===(s=n[i].type)&&(t===r||t===r.raw)){this._handler.off(s,r);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return aie(this,e,yS(this,e),t)},removeSignalListener(e,t){return lie(this,yS(this,e),t)},addDataListener(e,t){return aie(this,e,hS(this,e).values,t)},removeDataListener(e,t){return lie(this,hS(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=pL(this,null);this._globalCursor=!!e,t&&pL(this,t)}return this}return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:function D6e(e,t){this._timers.push(function N$e(e,t,n){var i=new AE,r=t;return null==t?(i.restart(e,t,n),i):(i._restart=i.restart,i.restart=function(s,o,a){o=+o,a=null==a?bP():+a,i._restart(function l(u){u+=r,i._restart(l,r+=o,a),s(u)},o,a)},i.restart(e,t,n),i)}(function n(i){e({timestamp:Date.now(),elapsed:i})},t))},events:function G$e(e,t,n){var o,i=this,r=new TD(n),s=function(u,c){i.runAsync(null,()=>{"view"===e&&function q$e(e,t){var n=e._eventConfig.defaults,i=n.prevent,r=n.allow;return!1!==i&&!0!==r&&(!0===i||!1===r||(i?i[t]:r?!r[t]:e.preventDefault()))}(i,t)&&u.preventDefault(),r.receive(function B$e(e,t,n){var s,a,i=e._renderer,r=i&&i.canvas();return r&&(a=gS(e),(s=IC(t.changedTouches?t.changedTouches[0]:t,r))[0]-=a[0],s[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=function $$e(e,t,n){const i=t?"group"===t.mark.marktype?t:t.mark.group:null;function r(o){var l,a=i;if(o)for(l=t;l;l=l.mark.group)if(l.mark.name===o){a=l;break}return a&&a.mark&&a.mark.interactive?a:{}}function s(o){if(!o)return n;be(o)&&(o=r(o));const a=n.slice();for(;o;)a[0]-=o.x||0,a[1]-=o.y||0,o=o.mark&&o.mark.group;return a}return{view:yr(e),item:yr(t||{}),group:r,xy:s,x:o=>s(o)[0],y:o=>s(o)[1]}}(e,n,s),t}(i,u,c))})};if("timer"===e)mS(i,"timer",t)&&i.timer(s,t);else if("view"===e)mS(i,"view",t)&&i.addEventListener(t,s,U$e);else if("window"===e?mS(i,"window",t)&&"undefined"!=typeof window&&(o=[window]):"undefined"!=typeof document&&mS(i,"selector",t)&&(o=document.querySelectorAll(e)),o){for(var a=0,l=o.length;a<l;++a)o[a].addEventListener(t,s);Gne(i,o,t,s)}else i.warn("Can not resolve event source: "+e);return r},finalize:function Y$e(){var i,r,s,e=this._tooltip,t=this._timers,n=this._eventListeners;for(i=t.length;--i>=0;)t[i].stop();for(i=n.length;--i>=0;)for(r=(s=n[i]).sources.length;--r>=0;)s.sources[r].removeEventListener(s.type,s.handler);return e&&e.call(this,this._handler,null,null,null),this},hover:function W$e(e,t){return t=[t||"update",(e=[e||"hover"])[0]],this.on(this.events("view","mouseover",Wne),Yne,Kne(e)),this.on(this.events("view","mouseout",Wne),Yne,Kne(t)),this},data:function F$e(e,t){return arguments.length<2?hS(this,e).values.value:pS.call(this,e,Qf().remove(Fo).insert(t))},change:pS,insert:function P$e(e,t){return pS.call(this,e,Qf().insert(t))},remove:function L$e(e,t){return pS.call(this,e,Qf().remove(t))},scale:function g6e(e){var t=this._runtime.scales;return Fe(t,e)||te("Unrecognized scale or projection: "+e),t[e].value},initialize:function l6e(e,t){const n=this,i=n._renderType,r=n._eventConfig.bind,s=zC(i);e=n._el=e?mL(n,e,!0):null,function k$e(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),Hne(t,e.description()))}(n),s||n.error("Unrecognized renderer type: "+i);const o=s.handler||Yy,a=e?s.renderer:s.headless;return n._renderer=a?Jne(n,n._renderer,e,a):null,n._handler=function a6e(e,t,n,i){const r=new i(e.loader(),gL(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,gS(e),e);return t&&t.handlers().forEach(s=>{r.on(s.type,s.handler)}),r}(n,n._handler,e,o),n._redraw=!0,e&&"none"!==r&&(t=t?n._elBind=mL(n,t,!0):e.appendChild(lo("form",{class:"vega-bindings"})),n._bind.forEach(l=>{l.param.element&&"container"!==r&&(l.element=mL(n,l.param.element,!!l.param.input))}),n._bind.forEach(l=>{Q$e(n,l.element||t,l)})),n},toImageURL:function c6e(e,t){return vL.apply(this,arguments)},toCanvas:function f6e(e,t){return bL.apply(this,arguments)},toSVG:function h6e(e){return wL.apply(this,arguments)},getState:function y6e(e){return this._runtime.getState(e||{data:v6e,signals:b6e,recurse:!0})},setState:function w6e(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}});const O6e=/[[\]{}]/,N6e={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let fie,hie;function Bd(e,t,n){return fie=t||"view",hie=n||N6e,pie(e.trim()).map(CL)}function Hv(e,t,n,i,r){const s=e.length;let a,o=0;for(;t<s;++t){if(a=e[t],!o&&a===n)return t;r&&r.indexOf(a)>=0?--o:i&&i.indexOf(a)>=0&&++o}return t}function pie(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=Hv(e,r,",","[{","]}"),t.push(e.substring(i,r).trim()),i=++r;if(0===t.length)throw"Empty event selector: "+e;return t}function CL(e){return"["===e[0]?function I6e(e){const t=e.length;let i,n=1;if(n=Hv(e,n,"]","[","]"),n===t)throw"Empty between selector: "+e;if(i=pie(e.substring(1,n)),2!==i.length)throw"Between selector must have two elements: "+e;if(">"!==(e=e.slice(n+1).trim())[0])throw"Expected '>' after between selector: "+e;i=i.map(CL);const r=CL(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}(e):function R6e(e){const t={source:fie},n=[];let l,u,i=[0,0],r=0,s=0,o=e.length,a=0;if("}"===e[o-1]){if(a=e.lastIndexOf("{"),!(a>=0))throw"Unmatched right brace: "+e;try{i=function F6e(e){const t=e.split(",");if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!=i)throw e;return i})}(e.substring(a+1,o-1))}catch(c){throw"Invalid throttle specification: "+e}o=(e=e.slice(0,a).trim()).length,a=0}if(!o)throw e;if("@"===e[0]&&(r=++a),l=Hv(e,a,":"),l<o&&(n.push(e.substring(s,l).trim()),s=a=++l),a=Hv(e,a,"["),a===o)n.push(e.substring(s,o).trim());else if(n.push(e.substring(s,a).trim()),u=[],s=++a,s===o)throw"Unmatched left bracket: "+e;for(;a<o;){if(a=Hv(e,a,"]"),a===o)throw"Unmatched left bracket: "+e;if(u.push(e.substring(s,a).trim()),a<o-1&&"["!==e[++a])throw"Expected left bracket: "+e;s=++a}if(!(o=n.length)||O6e.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],r?t.markname=n[0].slice(1):function k6e(e){return hie[e]}(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],"!"===t.type.slice(-1)&&(t.consume=!0,t.type=t.type.slice(0,-1)),null!=u&&(t.filter=u),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}(e)}function P6e(e){return Se(e)?e:{type:e||"pad"}}const Uv=e=>+e||0;function j6e(e){return Se(e)?e.signal?e:{top:Uv(e.top),bottom:Uv(e.bottom),left:Uv(e.left),right:Uv(e.right)}:(e=>({top:e,bottom:e,left:e,right:e}))(Uv(e))}const Vi=e=>Se(e)&&!ie(e)?ot({},e):{value:e};function gie(e,t,n,i){return null!=n?(Se(n)&&!ie(n)||ie(n)&&n.length&&Se(n[0])?e.update[t]=n:e[i||"enter"][t]={value:n},1):0}function tr(e,t,n){for(const i in t)gie(e,i,t[i]);for(const i in n)gie(e,i,n[i],"update")}function Om(e,t,n){for(const i in t)n&&Fe(n,i)||(e[i]=ot(e[i]||{},t[i]));return e}function Nm(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const EL="mark",SL="frame",xL="scope",mie="legend-label";function AL(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const _ie=e=>be(e)?pe(e):e.signal?`(${e.signal})`:yie(e);function wS(e){if(null!=e.gradient)return function nVe(e){const t=[e.start,e.stop,e.count].map(n=>null==n?null:pe(n));for(;t.length&&null==bt(t);)t.pop();return t.unshift(_ie(e.gradient)),`gradient(${t.join(",")})`}(e);let t=e.signal?`(${e.signal})`:e.color?function tVe(e){return e.c?DS("hcl",e.h,e.c,e.l):e.h||e.s?DS("hsl",e.h,e.s,e.l):e.l||e.a?DS("lab",e.l,e.a,e.b):e.r||e.g||e.b?DS("rgb",e.r,e.g,e.b):null}(e.color):null!=e.field?yie(e.field):void 0!==e.value?pe(e.value):void 0;return null!=e.scale&&(t=function iVe(e,t){const n=_ie(e.scale);return null!=e.range?t=`lerp(_range(${n}), ${+e.range})`:(void 0!==t&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(1==+e.band?"":"*"+CS(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),null==t&&(t="0")),t}(e,t)),void 0===t&&(t=null),null!=e.exponent&&(t=`pow(${t},${CS(e.exponent)})`),null!=e.mult&&(t+=`*${CS(e.mult)}`),null!=e.offset&&(t+=`+${CS(e.offset)}`),e.round&&(t=`round(${t})`),t}const DS=(e,t,n,i)=>`(${e}(${[t,n,i].map(wS).join(",")})+'')`;function CS(e){return Se(e)?"("+wS(e)+")":e}function yie(e){return vie(Se(e)?e:{datum:e})}function vie(e){let t,n,i;if(e.signal)t="datum",i=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(i=e.parent,t+=".datum"):i=e.group}else e.datum?(t="datum",i=e.datum):te("Invalid field reference: "+pe(e));return e.signal||(i=be(i)?xl(i).map(pe).join("]["):vie(i)),t+"["+i+"]"}function bie(e,t,n,i,r,s){const o={};(s=s||{}).encoders={$encode:o},e=function eVe(e,t,n,i,r){const s={},o={};let a,l,u,c;for(l in l="lineBreak","text"===t&&null!=r[l]&&!Nm(l,e)&&AL(s,l,r[l]),("legend"==n||String(n).startsWith("axis"))&&(n=null),c=n===SL?r.group:n===EL?ot({},r.mark,r[t]):null,c)u=Nm(l,e)||("fill"===l||"stroke"===l)&&(Nm("fill",e)||Nm("stroke",e)),u||AL(s,l,c[l]);for(l in we(i).forEach(d=>{const f=r.style&&r.style[d];for(const h in f)Nm(h,e)||AL(s,h,f[h])}),e=ot({},e),s)c=s[l],c.signal?(a=a||{})[l]=c:o[l]=c;return e.enter=ot(o,e.enter),a&&(e.update=ot(a,e.update)),e}(e,t,n,i,r.config);for(const a in e)o[a]=sVe(e[a],t,s,r);return s}function sVe(e,t,n,i){const r={},s={};for(const o in e)null!=e[o]&&(r[o]=aVe(oVe(e[o]),i,n,s));return{$expr:{marktype:t,channels:r},$fields:Object.keys(s),$output:Object.keys(e)}}function oVe(e){return ie(e)?function rVe(e){let t="";return e.forEach(n=>{const i=wS(n);t+=n.test?`(${n.test})?${i}:`:i}),":"===bt(t)&&(t+="null"),t}(e):wS(e)}function aVe(e,t,n,i){const r=Yl(e,t);return r.$fields.forEach(s=>i[s]=1),ot(n,r.$params),r.$expr}const uVe=["value","update","init","react","bind"];function wie(e,t){te(e+' for "outer" push: '+pe(t))}function Die(e,t){const n=e.name;if("outer"===e.push)t.signals[n]||wie("No prior signal definition",n),uVe.forEach(i=>{void 0!==e[i]&&wie("Invalid property ",i)});else{const i=t.addSignal(n,e.value);!1===e.react&&(i.react=!1),e.bind&&t.addBinding(n,e.bind)}}function ML(e,t,n,i){this.id=-1,this.type=e,this.value=t,this.params=n,i&&(this.parent=i)}function ES(e,t,n,i){return new ML(e,t,n,i)}function SS(e,t){return ES("operator",e,t)}function Be(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function zv(e,t){return t?{$field:e,$name:t}:{$field:e}}const TL=zv("key");function Cie(e,t){return{$compare:e,$order:t}}function xS(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const OL="scope",NL="view";function Ai(e){return e&&e.signal}function AS(e){if(Ai(e))return!0;if(Se(e))for(const t in e)if(AS(e[t]))return!0;return!1}function za(e,t){return null!=e?e:t}function Rh(e){return e&&e.signal||e}function qv(e,t){return(e.merge?mVe:e.stream?_Ve:e.type?yVe:te("Invalid stream specification: "+pe(e)))(e,t)}function mVe(e,t){const i=kL({merge:e.merge.map(r=>qv(r,t))},e,t);return t.addStream(i).id}function _Ve(e,t){const i=kL({stream:qv(e.stream,t)},e,t);return t.addStream(i).id}function yVe(e,t){let n;"timer"===e.type?(n=t.event("timer",e.throttle),e={between:e.between,filter:e.filter}):n=t.event(function gVe(e){return e===OL?NL:e||NL}(e.source),e.type);const i=kL({stream:n},e,t);return 1===Object.keys(i).length?n:t.addStream(i).id}function kL(e,t,n){let i=t.between;return i&&(2!==i.length&&te('Stream "between" parameter must have 2 entries: '+pe(t)),e.between=[qv(i[0],n),qv(i[1],n)]),i=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&i.push(function vVe(e,t,n){const i="event.item";return i+(e&&"*"!==e?"&&"+i+".mark.marktype==='"+e+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(t?"&&"+i+".mark.name==='"+t+"'":"")}(t.marktype,t.markname,t.markrole)),t.source===OL&&i.push("inScope(event.item)"),i.length&&(e.filter=Yl("("+i.join(")&&(")+")",n).$expr),null!=(i=t.throttle)&&(e.throttle=+i),null!=(i=t.debounce)&&(e.debounce=+i),t.consume&&(e.consume=!0),e}const bVe={code:"_.$value",ast:{type:"Identifier",value:"value"}};function CVe(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}const rn=e=>(t,n,i)=>ES(e,n,t||void 0,i),Sie=rn("aggregate"),SVe=rn("axisticks"),xie=rn("bound"),qa=rn("collect"),Aie=rn("compare"),xVe=rn("datajoin"),Mie=rn("encode"),AVe=rn("expression"),MVe=rn("facet"),TVe=rn("field"),OVe=rn("key"),NVe=rn("legendentries"),kVe=rn("load"),IVe=rn("mark"),RVe=rn("multiextent"),FVe=rn("multivalues"),PVe=rn("overlap"),LVe=rn("params"),Tie=rn("prefacet"),jVe=rn("projection"),BVe=rn("proxy"),$Ve=rn("relay"),Oie=rn("render"),VVe=rn("scale"),Fh=rn("sieve"),HVe=rn("sortitems"),Nie=rn("viewlayout"),UVe=rn("values");let zVe=0;const kie={min:"min",max:"max",count:"sum"};function GVe(e,t){const n=t.getScale(e.name).params;let i;for(i in n.domain=Iie(e.domain,e,t),null!=e.range&&(n.range=Fie(e,t,n)),null!=e.interpolate&&function n7e(e,t){t.interpolate=qo(e.type||e),null!=e.gamma&&(t.interpolateGamma=qo(e.gamma))}(e.interpolate,n),null!=e.nice&&(n.nice=function t7e(e){return Se(e)?{interval:qo(e.interval),step:qo(e.step)}:qo(e)}(e.nice)),null!=e.bins&&(n.bins=function e7e(e,t){return e.signal||ie(e)?MS(e,t):t.objectProperty(e)}(e.bins,t)),e)Fe(n,i)||"name"===i||(n[i]=qo(e[i],t))}function qo(e,t){return Se(e)?e.signal?t.signalRef(e.signal):te("Unsupported object: "+pe(e)):e}function MS(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>qo(n,t))}function TS(e){te("Can not find data set: "+pe(e))}function Iie(e,t,n){if(e)return e.signal?n.signalRef(e.signal):(ie(e)?WVe:e.fields?KVe:YVe)(e,t,n);(null!=t.domainMin||null!=t.domainMax)&&te("No scale domain defined for domainMin/domainMax to override.")}function WVe(e,t,n){return e.map(i=>qo(i,n))}function YVe(e,t,n){const i=n.getData(e.data);return i||TS(e.data),Zg(t.type)?i.valuesRef(n,e.field,Rie(e.sort,!1)):UJ(t.type)?i.domainRef(n,e.field):i.extentRef(n,e.field)}function KVe(e,t,n){const i=e.data,r=e.fields.reduce((s,o)=>(o=be(o)?{data:i,field:o}:ie(o)||o.signal?function JVe(e,t){const n="_:vega:_"+zVe++,i=qa({});if(ie(e))i.value={$ingest:e};else if(e.signal){const r="setdata("+pe(n)+","+e.signal+")";i.params.input=t.signalRef(r)}return t.addDataPipeline(n,[i,Fh({})]),{data:n,field:"data"}}(o,n):o,s.push(o),s),[]);return(Zg(t.type)?XVe:UJ(t.type)?QVe:ZVe)(e,n,r)}function XVe(e,t,n){const i=Rie(e.sort,!0);let r,s;const o=n.map(u=>{const c=t.getData(u.data);return c||TS(u.data),c.countsRef(t,u.field,i)}),a={groupby:TL,pulse:o};i&&(r=i.op||"count",s=i.field?xS(r,i.field):"count",a.ops=[kie[r]],a.fields=[t.fieldRef(s)],a.as=[s]),r=t.add(Sie(a));const l=t.add(qa({pulse:Be(r)}));return s=t.add(UVe({field:TL,sort:t.sortRef(i),pulse:Be(l)})),Be(s)}function Rie(e,t){return e&&(e.field||e.op?e.field||"count"===e.op?t&&e.field&&e.op&&!kie[e.op]&&te("Multiple domain scales can not be sorted using "+e.op):te("No field provided for sort aggregate op: "+e.op):Se(e)?e.field="key":e={field:"key"}),e}function QVe(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||TS(r.data),s.domainRef(t,r.field)});return Be(t.add(FVe({values:i})))}function ZVe(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||TS(r.data),s.extentRef(t,r.field)});return Be(t.add(RVe({extents:i})))}function Fie(e,t,n){const i=t.config.range;let r=e.range;if(r.signal)return t.signalRef(r.signal);if(be(r)){if(i&&Fe(i,r))return Fie(e=ot({},e,{range:i[r]}),t,n);"width"===r?r=[0,{signal:"width"}]:"height"===r?r=Zg(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:te("Unrecognized scale range value: "+pe(r))}else{if(r.scheme)return n.scheme=ie(r.scheme)?MS(r.scheme,t):qo(r.scheme,t),r.extent&&(n.schemeExtent=MS(r.extent,t)),void(r.count&&(n.schemeCount=qo(r.count,t)));if(r.step)return void(n.rangeStep=qo(r.step,t));if(Zg(e.type)&&!ie(r))return Iie(r,e,t);ie(r)||te("Unsupported range type: "+pe(r))}return r.map(s=>(ie(s)?MS:qo)(s,t))}function IL(e,t,n){return ie(e)?e.map(i=>IL(i,t,n)):Se(e)?e.signal?n.signalRef(e.signal):"fit"===t?e:te("Unsupported parameter object: "+pe(e)):e}const Ga="top",$d="bottom",FL="label",Go="value",Gv="guide-label",PL="guide-title",OS="gradient",LL="discrete",BL=["size","shape","fill","stroke","strokeWidth","strokeDash","opacity"],Wv={name:1,style:1,interactive:1},At={value:0},Wo={value:1},NS="group",$L="rule",Ph="text";function Yv(e){return e.type=NS,e.interactive=e.interactive||!1,e}function Ss(e,t){const n=(i,r)=>za(e[i],za(t[i],r));return n.isVertical=i=>"vertical"===za(e.direction,t.direction||(i?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>za(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>za(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>za(e.columns,za(t.columns,+n.isVertical(!0))),n}function Bie(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function kS(e,t,n){return`item.anchor === 'start' ? ${e} : item.anchor === 'end' ? ${t} : ${n}`}const VL=kS(pe("left"),pe("right"),pe("center"));function $ie(e,t){return t?e?Se(e)?Object.assign({},e,{offset:$ie(e.offset,t)}):{value:e,offset:t}:t:e}function uo(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=Om(e.encode,t,Wv)):e.interactive=!1,e}function g7e(e,t,n,i){const r=Ss(e,n),s=r.isVertical(),o=r.gradientThickness(),a=r.gradientLength();let l,u,c,d,f;s?(u=[0,1],c=[0,0],d=o,f=a):(u=[0,0],c=[1,0],d=a,f=o);const h={enter:l={opacity:At,x:At,y:At,width:Vi(d),height:Vi(f)},update:ot({},l,{opacity:Wo,fill:{gradient:t,start:u,stop:c}}),exit:{opacity:At}};return tr(h,{stroke:r("gradientStrokeColor"),strokeWidth:r("gradientStrokeWidth")},{opacity:r("gradientOpacity")}),uo({type:"rect",role:"legend-gradient",encode:h},i)}function m7e(e,t,n,i,r){const s=Ss(e,n),o=s.isVertical(),a=s.gradientThickness(),l=s.gradientLength();let u,c,d,f,h="";o?(u="y",d="y2",c="x",f="width",h="1-"):(u="x",d="x2",c="y",f="height");const p={opacity:At,fill:{scale:t,field:Go}};p[u]={signal:h+"datum.perc",mult:l},p[c]=At,p[d]={signal:h+"datum.perc2",mult:l},p[f]=Vi(a);const g={enter:p,update:ot({},p,{opacity:Wo}),exit:{opacity:At}};return tr(g,{stroke:s("gradientStrokeColor"),strokeWidth:s("gradientStrokeWidth")},{opacity:s("gradientOpacity")}),uo({type:"rect",role:"legend-band",key:Go,from:r,encode:g},i)}const y7e=`datum.perc<=0?"${$d}":datum.perc>=1?"top":"middle"`;function Vie(e,t,n,i){const r=Ss(e,t),s=r.isVertical(),o=Vi(r.gradientThickness()),a=r.gradientLength();let u,c,d,f,l=r("labelOverlap"),h="";const p={enter:u={opacity:At},update:c={opacity:Wo,text:{field:FL}},exit:{opacity:At}};return tr(p,{fill:r("labelColor"),fillOpacity:r("labelOpacity"),font:r("labelFont"),fontSize:r("labelFontSize"),fontStyle:r("labelFontStyle"),fontWeight:r("labelFontWeight"),limit:za(e.labelLimit,t.gradientLabelLimit)}),s?(u.align={value:"left"},u.baseline=c.baseline={signal:y7e},d="y",f="x",h="1-"):(u.align=c.align={signal:'datum.perc<=0?"left":datum.perc>=1?"right":"center"'},u.baseline={value:"top"},d="x",f="y"),u[d]=c[d]={signal:h+"datum.perc",mult:a},u[f]=c[f]=o,o.offset=za(e.labelOffset,t.gradientLabelOffset)||0,l=l?{separation:r("labelSeparation"),method:l,order:"datum.index"}:void 0,uo({type:Ph,role:mie,style:Gv,key:Go,from:i,encode:p,overlap:l},n)}function v7e(e,t,n,i,r){const s=Ss(e,t),o=n.entries,a=!(!o||!o.interactive),l=o?o.name:void 0,u=s("clipHeight"),c=s("symbolOffset"),d={data:"value"},f=`(${r}) ? datum.offset : datum.size`,h=u?Vi(u):{field:"size"},p="datum.index",g=`max(1, ${r})`;let m,_,y,v,b;h.mult=.5,m={enter:_={opacity:At,x:{signal:f,mult:.5,offset:c},y:h},update:y={opacity:Wo,x:_.x,y:_.y},exit:{opacity:At}};let D=null,C=null;e.fill||(D=t.symbolBaseFillColor,C=t.symbolBaseStrokeColor),tr(m,{fill:s("symbolFillColor",D),shape:s("symbolType"),size:s("symbolSize"),stroke:s("symbolStrokeColor",C),strokeDash:s("symbolDash"),strokeDashOffset:s("symbolDashOffset"),strokeWidth:s("symbolStrokeWidth")},{opacity:s("symbolOpacity")}),BL.forEach(k=>{e[k]&&(y[k]=_[k]={scale:e[k],field:Go})});const w=uo({type:"symbol",role:"legend-symbol",key:Go,from:d,clip:!!u||void 0,encode:m},n.symbols),E=Vi(c);E.offset=s("labelOffset"),m={enter:_={opacity:At,x:{signal:f,offset:E},y:h},update:y={opacity:Wo,text:{field:FL},x:_.x,y:_.y},exit:{opacity:At}},tr(m,{align:s("labelAlign"),baseline:s("labelBaseline"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontStyle:s("labelFontStyle"),fontWeight:s("labelFontWeight"),limit:s("labelLimit")});const N=uo({type:Ph,role:mie,style:Gv,key:Go,from:d,encode:m},n.labels);return m={enter:{noBound:{value:!u},width:At,height:u?Vi(u):At,opacity:At},exit:{opacity:At},update:y={opacity:Wo,row:{signal:null},column:{signal:null}}},s.isVertical(!0)?(v=`ceil(item.mark.items.length / ${g})`,y.row.signal=`${p}%${v}`,y.column.signal=`floor(${p} / ${v})`,b={field:["row",p]}):(y.row.signal=`floor(${p} / ${g})`,y.column.signal=`${p} % ${g}`,b={field:p}),y.column.signal=`(${r})?${y.column.signal}:${p}`,Yv({role:xL,from:i={facet:{data:i,name:"value",groupby:"index"}},encode:Om(m,o,Wv),marks:[w,N],name:l,interactive:a,sort:b})}const HL='item.orient === "left"',UL='item.orient === "right"',IS=`(${HL} || ${UL})`,w7e=`datum.vgrad && ${IS}`,D7e=kS('"top"','"bottom"','"middle"'),E7e=`datum.vgrad && ${UL} ? (${kS('"right"','"left"','"center"')}) : (${IS} && !(datum.vgrad && ${HL})) ? "left" : ${VL}`,S7e=`item._anchor || (${IS} ? "middle" : "start")`,x7e=`${w7e} ? (${HL} ? -90 : 90) : 0`,A7e=`${IS} ? (datum.vgrad ? (${UL} ? "bottom" : "top") : ${D7e}) : "top"`;function T7e(e,t){let n;return Se(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+Hie(e.path)+")":e.sphere&&(n="geoShape("+Hie(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function Hie(e){return Se(e)&&e.signal?e.signal:pe(e)}function Uie(e){const t=e.role||"";return t.indexOf("axis")&&t.indexOf("legend")&&t.indexOf("title")?e.type===NS?xL:t||EL:t}function O7e(e){return{marktype:e.type,name:e.name||void 0,role:e.role||Uie(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function N7e(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e}function zL(e,t){const n=tY(e.type);n||te("Unrecognized transform type: "+pe(e.type));const i=ES(n.type.toLowerCase(),null,zie(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(i)),i.metadata=n.metadata||{},i}function zie(e,t,n){const i={},r=e.params.length;for(let s=0;s<r;++s){const o=e.params[s];i[o.name]=k7e(o,t,n)}return i}function k7e(e,t,n){const i=e.type,r=t[e.name];return"index"===i?function I7e(e,t,n){return be(t.from)||te('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}(0,t,n):void 0!==r?"param"===i?function R7e(e,t,n){const i=t[e.name];return e.array?(ie(i)||te("Expected an array of sub-parameters. Instead: "+pe(i)),i.map(r=>Gie(e,r,n))):Gie(e,i,n)}(e,t,n):"projection"===i?n.projectionRef(t[e.name]):e.array&&!Ai(r)?r.map(s=>qie(e,s,n)):qie(e,r,n):void(e.required&&te("Missing required "+pe(t.type)+" parameter: "+pe(e.name)))}function qie(e,t,n){const i=e.type;if(Ai(t))return Wie(i)?te("Expression references can not be signals."):qL(i)?n.fieldRef(t):Yie(i)?n.compareRef(t):n.signalRef(t.signal);{const r=e.expr||qL(i);return r&&F7e(t)?n.exprRef(t.expr,t.as):r&&P7e(t)?zv(t.field,t.as):Wie(i)?Yl(t,n):L7e(i)?Be(n.getData(t).values):qL(i)?zv(t):Yie(i)?n.compareRef(t):t}}function Gie(e,t,n){const i=e.params.length;let r;for(let o=0;o<i;++o){r=e.params[o];for(const a in r.key)if(r.key[a]!==t[a]){r=null;break}if(r)break}r||te("Unsupported parameter: "+pe(t));const s=ot(zie(r,t,n),r.key);return Be(n.add(LVe(s)))}const F7e=e=>e&&e.expr,P7e=e=>e&&e.field,L7e=e=>"data"===e,Wie=e=>"expr"===e,qL=e=>"field"===e,Yie=e=>"compare"===e;function RS(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:Be(t.getData(e.data).output)}function Lh(e,t,n,i,r){this.scope=e,this.input=t,this.output=n,this.values=i,this.aggregate=r,this.index={}}function Kie(e){return be(e)?e:null}function Jie(e,t,n){const i=xS(n.op,n.field);let r;if(t.ops){for(let s=0,o=t.as.length;s<o;++s)if(t.as[s]===i)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(i))}function Kv(e,t,n,i,r,s,o){const a=t[n]||(t[n]={}),l=function hVe(e){return Se(e)?("descending"===e.order?"-":"+")+xS(e.op,e.field):""}(s);let c,d,u=Kie(r);if(null!=u&&(e=t.scope,u+=l?"|"+l:"",c=a[u]),!c){const f=s?{field:TL,pulse:t.countsRef(e,r,s)}:{field:e.fieldRef(r),pulse:Be(t.output)};l&&(f.sort=e.sortRef(s)),d=e.add(ES(i,void 0,f)),o&&(t.index[r]=d),c=Be(d),null!=u&&(a[u]=c)}return c}function Xie(e,t,n){const i=e.remove,r=e.insert,s=e.toggle,o=e.modify,a=e.values,l=t.add(SS()),c=Yl("if("+e.trigger+',modify("'+n+'",'+[r,i,s,o,a].map(d=>null==d?"null":d).join(",")+"),0)",t);l.update=c.$expr,l.params=c.$params}function FS(e,t){const n=Uie(e),i=e.type===NS,r=e.from&&e.from.facet,s=e.overlap;let a,l,u,c,d,f,h,o=e.layout||n===xL||n===SL;const p=n===EL||o||r,g=function j7e(e,t,n){let i,r,s,o,a;return e?(i=e.facet)&&(t||te("Only group marks can be faceted."),null!=i.field?o=a=RS(i,n):(e.data?a=Be(n.getData(e.data).aggregate):(s=zL(ot({type:"aggregate",groupby:we(i.groupby)},i.aggregate),n),s.params.key=n.keyRef(i.groupby),s.params.pulse=RS(i,n),o=a=Be(n.add(s))),r=n.keyRef(i.groupby,!0))):o=Be(n.add(qa(null,[{}]))),o||(o=RS(e,n)),{key:r,pulse:o,parent:a}}(e.from,i,t);l=t.add(xVe({key:g.key||(e.key?zv(e.key):void 0),pulse:g.pulse,clean:!i}));const m=Be(l);l=u=t.add(qa({pulse:m})),l=t.add(IVe({markdef:O7e(e),interactive:N7e(e.interactive,t),clip:T7e(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:Be(l)}));const _=Be(l);l=c=t.add(Mie(bie(e.encode,e.type,n,e.style,t,{mod:!1,pulse:_}))),l.params.parent=t.encode(),e.transform&&e.transform.forEach(C=>{const w=zL(C,t),E=w.metadata;(E.generates||E.changes)&&te("Mark transforms should not generate new data."),E.nomod||(c.params.mod=!0),w.params.pulse=Be(l),t.add(l=w)}),e.sort&&(l=t.add(HVe({sort:t.compareRef(e.sort),pulse:Be(l)})));const y=Be(l);(r||o)&&(o=t.add(Nie({layout:t.objectProperty(e.layout),legends:t.legends,mark:_,pulse:y})),f=Be(o));const v=t.add(xie({mark:_,pulse:f||y}));h=Be(v),i&&(p&&(a=t.operators,a.pop(),o&&a.pop()),t.pushState(y,f||h,m),r?function B7e(e,t,n){const i=e.from.facet,r=i.name,s=RS(i,t);let o;i.name||te("Facet must have a name: "+pe(i)),i.data||te("Facet must reference a data set: "+pe(i)),i.field?o=t.add(Tie({field:t.fieldRef(i.field),pulse:s})):i.groupby?o=t.add(MVe({key:t.keyRef(i.groupby),group:Be(t.proxy(n.parent)),pulse:s})):te("Facet must specify groupby or field: "+pe(i));const a=t.fork(),l=a.add(qa()),u=a.add(Fh({pulse:Be(l)}));a.addData(r,new Lh(a,l,l,u)),a.addSignal("parent",null),o.params.subflow={$subflow:a.parse(e).toRuntime()}}(e,t,g):p?function $7e(e,t,n){const i=t.add(Tie({pulse:n.pulse})),r=t.fork();r.add(Fh()),r.addSignal("parent",null),i.params.subflow={$subflow:r.parse(e).toRuntime()}}(e,t,g):t.parse(e),t.popState(),p&&(o&&a.push(o),a.push(v))),s&&(h=function V7e(e,t,n){const i=e.method,r=e.bound,s=e.separation,o={separation:Ai(s)?n.signalRef(s.signal):s,method:Ai(i)?n.signalRef(i.signal):i,pulse:t};if(e.order&&(o.sort=n.compareRef({field:e.order})),r){const a=r.tolerance;o.boundTolerance=Ai(a)?n.signalRef(a.signal):+a,o.boundScale=n.scaleRef(r.scale),o.boundOrient=r.orient}return Be(n.add(PVe(o)))}(s,h,t));const b=t.add(Oie({pulse:h})),D=t.add(Fh({pulse:Be(b)},void 0,t.parent()));null!=e.name&&(d=e.name,t.addData(d,new Lh(t,u,b,D)),e.on&&e.on.forEach(C=>{(C.insert||C.remove||C.toggle)&&te("Marks only support modify triggers."),Xie(C,t,d)}))}function q7e(e,t,n){const i={enter:{},update:{}};return tr(i,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),i}function Qie(e,t,n){return t[e]?`scale("${t[e]}",datum)`:Bie(e,n[0].encode)}function X7e(e,t){const n={enter:{},update:{}};return tr(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:VL},angle:{signal:'item.orient==="left"?-90:item.orient==="right"?90:0'},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),Om(n,t,Wv)}function jh(e){const t=qa({},e);return t.metadata={source:!0},t}function Zie(e,t){return kVe({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}Lh.fromEntries=function(e,t){const n=t.length,i=t[n-1],r=t[n-2];let s=t[0],o=null,a=1;for(s&&"load"===s.type&&(s=t[1]),e.add(t[0]);a<n;++a)t[a].params.pulse=Be(t[a-1]),e.add(t[a]),"aggregate"===t[a].type&&(o=t[a]);return new Lh(e,s,r,i,o)},Lh.prototype={countsRef(e,t,n){const i=this,r=i.counts||(i.counts={}),s=Kie(t);let o,a,l;return null!=s&&(e=i.scope,o=r[s]),o?n&&n.field&&Jie(e,o.agg.params,n):(l={groupby:e.fieldRef(t,"key"),pulse:Be(i.output)},n&&n.field&&Jie(e,l,n),a=e.add(Sie(l)),o=e.add(qa({pulse:Be(a)})),o={agg:a,ref:Be(o)},null!=s&&(r[s]=o)),o.ref},tuplesRef(){return Be(this.values)},extentRef(e,t){return Kv(e,this,"extent","extent",t,!1)},domainRef(e,t){return Kv(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return Kv(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return Kv(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return Kv(e,this,"indata","tupleindex",t,!0,!0)}};const ere=e=>e===$d||e===Ga,PS=(e,t,n)=>Ai(e)?s9e(e.signal,t,n):"left"===e||e===Ga?t:n,Hi=(e,t,n)=>Ai(e)?i9e(e.signal,t,n):ere(e)?t:n,Wa=(e,t,n)=>Ai(e)?r9e(e.signal,t,n):ere(e)?n:t,tre=(e,t,n)=>Ai(e)?o9e(e.signal,t,n):e===Ga?{value:t}:{value:n},i9e=(e,t,n)=>nre(`${e} === 'top' || ${e} === '${$d}'`,t,n),r9e=(e,t,n)=>nre(`${e} !== 'top' && ${e} !== '${$d}'`,t,n),s9e=(e,t,n)=>GL(`${e} === 'left' || ${e} === 'top'`,t,n),o9e=(e,t,n)=>GL(`${e} === 'top'`,t,n),nre=(e,t,n)=>(t=null!=t?Vi(t):t,n=null!=n?Vi(n):n,ire(t)&&ire(n)?{signal:`${e} ? (${t=t?t.signal||pe(t.value):null}) : (${n=n?n.signal||pe(n.value):null})`}:[ot({test:e},t)].concat(n||[])),ire=e=>null==e||1===Object.keys(e).length,GL=(e,t,n)=>({signal:`${e} ? (${Fm(t)}) : (${Fm(n)})`}),l9e=(e,t,n,i,r)=>({signal:(null!=i?`${e} === 'left' ? (${Fm(i)}) : `:"")+(null!=n?`${e} === '${$d}' ? (${Fm(n)}) : `:"")+(null!=r?`${e} === 'right' ? (${Fm(r)}) : `:"")+(null!=t?`${e} === 'top' ? (${Fm(t)}) : `:"")+"(null)"}),Fm=e=>Ai(e)?e.signal:null==e?null:pe(e),Pm=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function Lm(e,t,n,i){let r;if(t&&Fe(t,e))return t[e];if(Fe(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=e[5].toLowerCase()+e.slice(6)}return i[PL][r]}if(e.startsWith("label")){switch(e){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=e[5].toLowerCase()+e.slice(6)}return i[Gv][r]}return null}function rre(e){const t={};for(const n of e)if(n)for(const i in n)t[i]=1;return Object.keys(t)}function sre(e,t){return{scale:e.scale,range:t}}function WL(e,t,n,i,r){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+i+","+r+")"}}function g9e(e,t,n,i,r,s){const o=Ss(e,t),a=e.orient,l=e.scale,u=PS(a,-1,1),c=Rh(o("labelFlush")),d=Rh(o("labelFlushOffset")),f=o("labelAlign"),h=o("labelBaseline");let g,p=0===c||!!c;const m=Vi(r);m.mult=u,m.offset=Vi(o("labelPadding")||0),m.offset.mult=u;const _={scale:l,field:Go,band:.5,offset:$ie(s.offset,o("labelOffset"))},y=Hi(a,p?WL(l,c,'"left"','"right"','"center"'):{value:"center"},((e,t,n)=>Ai(e)?((e,t,n)=>GL(`${e} === 'right'`,t,n))(e.signal,t,n):"right"===e?{value:t}:{value:n})(a,"left","right")),v=Hi(a,tre(a,"bottom","top"),p?WL(l,c,'"top"','"bottom"','"middle"'):{value:"middle"}),b=WL(l,c,`-(${d})`,d,0);p=p&&d;const D={opacity:At,x:Hi(a,_,m),y:Wa(a,_,m)},C={enter:D,update:g={opacity:Wo,text:{field:FL},x:D.x,y:D.y,align:y,baseline:v},exit:{opacity:At,x:D.x,y:D.y}};tr(C,{dx:!f&&p?Hi(a,b):null,dy:!h&&p?Wa(a,b):null}),tr(C,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:f,baseline:h});const w=o("labelBound");let E=o("labelOverlap");return E=E||w?{separation:o("labelSeparation"),method:E,order:"datum.index",bound:w?{scale:l,orient:a,tolerance:w}:null}:void 0,g.align!==y&&(g.align=Pm(g.align,y)),g.baseline!==v&&(g.baseline=Pm(g.baseline,v)),uo({type:Ph,role:"axis-label",style:Gv,key:Go,from:i,encode:C,overlap:E},n)}function y9e(e,t){const n=function c9e(e,t){var a,l,u,n=t.config,i=n.style,r=n.axis,s="band"===t.scaleType(e.scale)&&n.axisBand,o=e.orient;if(Ai(o)){const d=rre([n.axisX,n.axisY]),f=rre([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);for(u of(a={},d))a[u]=Hi(o,Lm(u,n.axisX,r,i),Lm(u,n.axisY,r,i));for(u of(l={},f))l[u]=l9e(o.signal,Lm(u,n.axisTop,r,i),Lm(u,n.axisBottom,r,i),Lm(u,n.axisLeft,r,i),Lm(u,n.axisRight,r,i))}else a=o===Ga||o===$d?n.axisX:n.axisY,l=n["axis"+o[0].toUpperCase()+o.slice(1)];return a||l||s?ot({},r,a,l,s):r}(e,t),i=e.encode||{},r=i.axis||{},s=r.name||void 0,o=r.interactive,a=r.style,l=Ss(e,n),u=function p7e(e){const t=e("tickBand");let i,r,n=e("tickOffset");return t?t.signal?(i={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${t.signal}) === 'extent'`},Se(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):"extent"===t?(i=1,r=!0,n=0):(i=.5,r=!1):(i=e("bandPosition"),r=e("tickExtra")),{extra:r,band:i,offset:n}}(l),c={scale:e.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:null!=e.title},d=Be(t.add(qa({},[c]))),f=Be(t.add(SVe({scale:t.scaleRef(e.scale),extra:t.property(u.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(function f9e(e,t,n,i,r){const s=Ss(e,t),o=e.orient,a=e.gridScale,l=PS(o,1,-1),u=function h9e(e,t){if(1!==t)if(Se(e)){let n=e=ot({},e);for(;null!=n.mult;){if(!Se(n.mult))return n.mult=Ai(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n=n.mult=ot({},n.mult)}n.mult=t}else e=Ai(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);return e}(e.offset,l);let c,d,f;const h={enter:c={opacity:At},update:f={opacity:Wo},exit:d={opacity:At}};tr(h,{stroke:s("gridColor"),strokeCap:s("gridCap"),strokeDash:s("gridDash"),strokeDashOffset:s("gridDashOffset"),strokeOpacity:s("gridOpacity"),strokeWidth:s("gridWidth")});const p={scale:e.scale,field:Go,band:r.band,extra:r.extra,offset:r.offset,round:s("tickRound")},g=Hi(o,{signal:"height"},{signal:"width"}),m=a?{scale:a,range:0,mult:l,offset:u}:{value:0,offset:u},_=a?{scale:a,range:1,mult:l,offset:u}:ot(g,{mult:l,offset:u});return c.x=f.x=Hi(o,p,m),c.y=f.y=Wa(o,p,m),c.x2=f.x2=Wa(o,_),c.y2=f.y2=Hi(o,_),d.x=Hi(o,p),d.y=Wa(o,p),uo({type:$L,role:"axis-grid",key:Go,from:i,encode:h},n)}(e,n,i.grid,f,u)),c.ticks&&(p=l("tickSize"),h.push(function p9e(e,t,n,i,r,s){const o=Ss(e,t),a=e.orient,l=PS(a,-1,1);let u,c,d;const f={enter:u={opacity:At},update:d={opacity:Wo},exit:c={opacity:At}};tr(f,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const h=Vi(r);h.mult=l;const p={scale:e.scale,field:Go,band:s.band,extra:s.extra,offset:s.offset,round:o("tickRound")};return d.y=u.y=Hi(a,At,p),d.y2=u.y2=Hi(a,h),c.x=Hi(a,p),d.x=u.x=Wa(a,At,p),d.x2=u.x2=Wa(a,h),c.y=Wa(a,p),uo({type:$L,role:"axis-tick",key:Go,from:i,encode:f},n)}(e,n,i.ticks,f,p,u))),c.labels&&(p=c.ticks?p:0,h.push(g9e(e,n,i.labels,f,p,u))),c.domain&&h.push(function d9e(e,t,n,i){const r=Ss(e,t),s=e.orient;let o,a;const l={enter:o={opacity:At},update:a={opacity:Wo},exit:{opacity:At}};tr(l,{stroke:r("domainColor"),strokeCap:r("domainCap"),strokeDash:r("domainDash"),strokeDashOffset:r("domainDashOffset"),strokeWidth:r("domainWidth"),strokeOpacity:r("domainOpacity")});const u=sre(e,0),c=sre(e,1);return o.x=a.x=Hi(s,u,At),o.x2=a.x2=Hi(s,c),o.y=a.y=Wa(s,u,At),o.y2=a.y2=Wa(s,c),uo({type:$L,role:"axis-domain",from:i,encode:l},n)}(e,n,i.domain,d)),c.title&&h.push(function m9e(e,t,n,i){const r=Ss(e,t),s=e.orient,o=PS(s,-1,1);let a,l;const u={enter:a={opacity:At,anchor:Vi(r("titleAnchor",null)),align:{signal:VL}},update:l=ot({},a,{opacity:Wo,text:Vi(e.title)}),exit:{opacity:At}},c={signal:`lerp(range("${e.scale}"), ${kS(0,1,.5)})`};return l.x=Hi(s,c),l.y=Wa(s,c),a.angle=Hi(s,At,((e,t)=>Ai(e)?{signal:`(${e.signal}) * 90`}:{value:90*e})(o)),a.baseline=Hi(s,tre(s,$d,Ga),{value:$d}),l.angle=a.angle,l.baseline=a.baseline,tr(u,{fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),angle:r("titleAngle"),baseline:r("titleBaseline")}),function _9e(e,t,n,i){const r=(a,l)=>null!=a?(n.update[l]=Pm(Vi(a),n.update[l]),!1):!Nm(l,i),s=r(e("titleX"),"x"),o=r(e("titleY"),"y");n.enter.auto=o===s?Vi(o):Hi(t,Vi(o),Vi(s))}(r,s,u,n),u.update.align=Pm(u.update.align,a.align),u.update.angle=Pm(u.update.angle,a.angle),u.update.baseline=Pm(u.update.baseline,a.baseline),uo({type:Ph,role:"axis-title",style:PL,from:i,encode:u},n)}(e,n,i.title,d)),FS(Yv({role:"axis",from:d,encode:Om(v9e(l,e),r,Wv),marks:h,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:s,interactive:o,style:a}),t)}function v9e(e,t){const n={enter:{},update:{}};return tr(n,{orient:e("orient"),offset:e("offset")||0,position:za(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function ore(e,t,n){const i=we(e.signals),r=we(e.scales);return n||i.forEach(s=>Die(s,t)),we(e.projections).forEach(s=>function i7e(e,t){const n=t.config.projection||{},i={};for(const r in e)"name"!==r&&(i[r]=IL(e[r],r,t));for(const r in n)null==i[r]&&(i[r]=IL(n[r],r,t));t.addProjection(e.name,i)}(s,t)),r.forEach(s=>function qVe(e,t){const n=e.type||"linear";$J(n)||te("Unrecognized scale type: "+pe(n)),t.addScale(e.name,{type:n,domain:void 0})}(s,t)),we(e.data).forEach(s=>function e9e(e,t){const n=[];e.transform&&e.transform.forEach(i=>{n.push(zL(i,t))}),e.on&&e.on.forEach(i=>{Xie(i,t,e.name)}),t.addDataPipeline(e.name,function t9e(e,t,n){const i=[];let a,l,u,c,d,r=null,s=!1,o=!1;for(e.values?Ai(e.values)||AS(e.format)?(i.push(Zie(t,e)),i.push(r=jh())):i.push(r=jh({$ingest:e.values,$format:e.format})):e.url?AS(e.url)||AS(e.format)?(i.push(Zie(t,e)),i.push(r=jh())):i.push(r=jh({$request:e.url,$format:e.format})):e.source&&(r=a=we(e.source).map(f=>Be(t.getData(f).output)),i.push(null)),l=0,u=n.length;l<u;++l)c=n[l],d=c.metadata,!r&&!d.source&&i.push(r=jh()),i.push(c),d.generates&&(o=!0),d.modifies&&!o&&(s=!0),d.source?r=c:d.changes&&(r=null);return a&&(u=a.length-1,i[0]=$Ve({derive:s,pulse:u?a:a[0]}),(s||u)&&i.splice(1,0,jh())),r||i.push(jh()),i.push(Fh({})),i}(e,t,n))}(s,t)),r.forEach(s=>GVe(s,t)),(n||i).forEach(s=>function EVe(e,t){const n=t.getSignal(e.name);let i=e.update;e.init&&(i?te("Signals can not include both init and update expressions."):(i=e.init,n.initonly=!0)),i&&(i=Yl(i,t),n.update=i.$expr,n.params=i.$params),e.on&&e.on.forEach(r=>function wVe(e,t,n){const i=e.encode,r={target:n};let s=e.events,o=e.update,a=[];s||te("Signal update missing events specification."),be(s)&&(s=Bd(s,t.isSubscope()?OL:NL)),s=we(s).filter(l=>l.signal||l.scale?(a.push(l),0):1),a.length>1&&(a=[CVe(a)]),s.length&&a.push(s.length>1?{merge:s}:s[0]),null!=i&&(o&&te("Signal encode and update are mutually exclusive."),o="encode(item(),"+pe(i)+")"),r.update=be(o)?Yl(o,t):null!=o.expr?Yl(o.expr,t):null!=o.value?o.value:null!=o.signal?{$expr:bVe,$params:{$value:t.signalRef(o.signal)}}:te("Invalid signal update specification."),e.force&&(r.options={force:!0}),a.forEach(l=>t.addUpdate(ot(function DVe(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):qv(e,t)}}(l,t),r)))}(r,t,n.id))}(s,t)),we(e.axes).forEach(s=>y9e(s,t)),we(e.marks).forEach(s=>FS(s,t)),we(e.legends).forEach(s=>function H7e(e,t){const n=t.config.legend,i=e.encode||{},r=Ss(e,n),s=i.legend||{},o=s.name||void 0,a=s.interactive,l=s.style,u={};let d,f,h,c=0;BL.forEach(v=>e[v]?(u[v]=e[v],c=c||e[v]):0),c||te("Missing valid scale for legend.");const p=function U7e(e,t){let n=e.type||"symbol";return!e.type&&1===function z7e(e){return BL.reduce((t,n)=>t+(e[n]?1:0),0)}(e)&&(e.fill||e.stroke)&&(n=yR(t)?OS:vR(t)?LL:"symbol"),n!==OS?n:vR(t)?LL:OS}(e,t.scaleType(c)),g={title:null!=e.title,scales:u,type:p,vgrad:"symbol"!==p&&r.isVertical()},m=Be(t.add(qa(null,[g]))),y=Be(t.add(NVe(f={type:p,scale:t.scaleRef(c),count:t.objectProperty(r("tickCount")),limit:t.property(r("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===OS?(h=[g7e(e,c,n,i.gradient),Vie(e,n,i.labels,y)],f.count=f.count||t.signalRef(`max(2,2*floor((${Rh(r.gradientLength())})/100))`)):p===LL?h=[m7e(e,c,n,i.gradient,y),Vie(e,n,i.labels,y)]:(d=function b7e(e,t){const n=Ss(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(e,n),h=[v7e(e,n,i,y,Rh(d.columns))],f.size=function G7e(e,t,n){const i=Rh(Qie("size",e,n)),r=Rh(Qie("strokeWidth",e,n)),s=Rh(function W7e(e,t,n){return Bie("fontSize",e)||function h7e(e,t,n){const i=t.config.style[n];return i&&i[e]}("fontSize",t,n)}(n[1].encode,t,Gv));return Yl(`max(ceil(sqrt(${i})+${r}),${s})`,t)}(e,t,h[0].marks)),h=[Yv({role:"legend-entry",from:m,encode:{enter:{x:{value:0},y:{value:0}}},marks:h,layout:d,interactive:a})],g.title&&h.push(function M7e(e,t,n,i){const r=Ss(e,t),s={enter:{opacity:At},update:{opacity:Wo,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:At}};return tr(s,{orient:r("titleOrient"),_anchor:r("titleAnchor"),anchor:{signal:S7e},angle:{signal:x7e},align:{signal:E7e},baseline:{signal:A7e},text:e.title,fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),baseline:r("titleBaseline")}),uo({type:Ph,role:"legend-title",style:PL,from:i,encode:s},n)}(e,n,i.title,m)),FS(Yv({role:"legend",from:m,encode:Om(q7e(r,e,n),s,Wv),marks:h,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:o,interactive:a,style:l}),t)}(s,t)),e.title&&function K7e(e,t){const n=Ss(e=be(e)?{text:e}:e,t.config.title),i=e.encode||{},r=i.group||{},s=r.name||void 0,o=r.interactive,a=r.style,l=[],c=Be(t.add(qa(null,[{}])));return l.push(function Q7e(e,t,n,i){const r={value:0},o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return tr(o,{text:e.text,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),uo({type:Ph,role:"title-text",style:"group-title",from:i,encode:o},n)}(e,n,function J7e(e){const t=e.encode;return t&&t.title||ot({name:e.name,interactive:e.interactive,style:e.style},t)}(e),c)),e.subtitle&&l.push(function Z7e(e,t,n,i){const r={value:0},o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return tr(o,{text:e.subtitle,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),uo({type:Ph,role:"title-subtitle",style:"group-subtitle",from:i,encode:o},n)}(e,n,i.subtitle,c)),FS(Yv({role:"title",from:c,encode:X7e(n,r),marks:l,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:s,interactive:o,style:a}),t)}(e.title,t),t.parseLambdas(),t}function Jv(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function are(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function lre(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}function YL(e){return(ie(e)?C9e:E9e)(e)}function C9e(e){const t=e.length;let n="[";for(let i=0;i<t;++i){const r=e[i];n+=(i>0?",":"")+(Se(r)?r.signal||YL(r):pe(r))}return n+"]"}function E9e(e){let i,r,t="{",n=0;for(i in e)r=e[i],t+=(++n>1?",":"")+pe(i)+":"+(Se(r)?r.signal||YL(r):pe(r));return t+"}"}function x9e(e,t,n){return Se(e)||te("Input Vega specification must be an object."),function w9e(e,t){const n=t.config,i=Be(t.root=t.add(SS())),r=function D9e(e,t){const n=o=>za(e[o],t[o]),i=[Jv("background",n("background")),Jv("autosize",P6e(n("autosize"))),Jv("padding",j6e(n("padding"))),Jv("width",n("width")||0),Jv("height",n("height")||0)],r=i.reduce((o,a)=>(o[a.name]=a,o),{}),s={};return we(e.signals).forEach(o=>{Fe(r,o.name)?o=ot(r[o.name],o):i.push(o),s[o.name]=o}),we(t.signals).forEach(o=>{!Fe(s,o.name)&&!Fe(r,o.name)&&i.push(o)}),i}(e,n);r.forEach(u=>Die(u,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const s=t.add(qa()),o=t.add(Mie(bie((e=>Om({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e))(e.encode),NS,SL,e.style,t,{pulse:Be(s)}))),a=t.add(Nie({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:i,pulse:Be(o)}));t.operators.pop(),t.pushState(Be(o),Be(a),null),ore(e,t,r),t.operators.push(a);let l=t.add(xie({mark:i,pulse:Be(a)}));return l=t.add(Oie({pulse:Be(l)})),l=t.add(Fh({pulse:Be(l)})),t.addData("root",new Lh(t,s,s,l)),t}(e,new are(t=Mg(function S9e(){const e="sans-serif",i="#4c78a8",r="#000",s="#888",o="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i},area:{fill:i},image:null,line:{stroke:i,strokeWidth:2},path:{stroke:i},rect:{fill:i},rule:{stroke:r},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:r,font:e,fontSize:11},trail:{fill:i,size:2},style:{"guide-label":{fill:r,font:e,fontSize:10},"guide-title":{fill:r,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:o}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:s,grid:!1,gridWidth:1,gridColor:o,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:s,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:o,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:s,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}(),t,e.config),n)).toRuntime()}are.prototype=lre.prototype={parse(e){return ore(e,this)},fork(){return new lre(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof ML?Be(e):e;return this.add(BVe({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(i,r,s){let o,a;i&&(o=i.data||(i.data={}),a=o[r]||(o[r]=[]),a.push(s))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const i in t.index)n(t.index[i],e,"index:"+i)}return this},pushState(e,t,n){this._encode.push(Be(this.add(Fh({pulse:e})))),this._parent.push(t),this._lookup.push(n?Be(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return bt(this._parent)},encode(){return bt(this._encode)},lookup(){return bt(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(be(e))return zv(e,t);e.signal||te("Unsupported field reference: "+pe(e));const n=e.signal;let i=this.field[n];if(!i){const r={name:this.signalRef(n)};t&&(r.as=t),this.field[n]=i=Be(this.add(TVe(r)))}return i},compareRef(e){let t=!1;const n=s=>Ai(s)?(t=!0,this.signalRef(s.signal)):function pVe(e){return e&&e.expr}(s)?(t=!0,this.exprRef(s.expr)):s,i=we(e.field).map(n),r=we(e.order).map(n);return t?Be(this.add(Aie({fields:i,orders:r}))):Cie(i,r)},keyRef(e,t){let n=!1;const r=this.signals;return e=we(e).map(s=>Ai(s)?(n=!0,Be(r[s.signal])):s),n?Be(this.add(OVe({fields:e,flat:t}))):function cVe(e,t){const n={$key:e};return t&&(n.$flat=!0),n}(e,t)},sortRef(e){if(!e)return e;const t=xS(e.op,e.field),n=e.order||"ascending";return n.signal?Be(this.add(Aie({fields:t,orders:this.signalRef(n.signal)}))):Cie(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:e,type:t}),this.events[n]=i}return this.events[n]},hasOwnSignal(e){return Fe(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&te("Duplicate signal name: "+pe(e));const n=t instanceof ML?t:this.add(SS(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||te("Unrecognized signal name: "+pe(e)),this.signals[e]},signalRef(e){return this.signals[e]?Be(this.signals[e]):(Fe(this.lambdas,e)||(this.lambdas[e]=this.add(SS(null))),Be(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const i=e[t],r=Yl(i,this),s=this.lambdas[i];s.params=r.$params,s.update=r.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return e&&Se(e)?this.signalRef(e.signal||YL(e)):e},exprRef(e,t){const n={expr:Yl(e,this)};return t&&(n.expr.$name=t),Be(this.add(AVe(n)))},addBinding(e,t){this.bindings||te("Nested signals do not support binding: "+pe(e)),this.bindings.push(ot({signal:e},t))},addScaleProj(e,t){Fe(this.scales,e)&&te("Duplicate scale or projection name: "+pe(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,VVe(t))},addProjection(e,t){this.addScaleProj(e,jVe(t))},getScale(e){return this.scales[e]||te("Unrecognized scale name: "+pe(e)),this.scales[e]},scaleRef(e){return Be(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return Fe(this.data,e)&&te("Duplicate data set name: "+pe(e)),this.data[e]=t},getData(e){return this.data[e]||te("Undefined data set name: "+pe(e)),this.data[e]},addDataPipeline(e,t){return Fe(this.data,e)&&te("Duplicate data set name: "+pe(e)),this.addData(e,Lh.fromEntries(this,t))}};var A9e="5.22.1";ot(Ug,Zt,dt,Kn,kt,Is,Tt,Rs,mt,Wi,yo,ia);var T9e={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},O9e={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},N9e={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const k9e=Array.prototype.slice,Bh=(e,t,n)=>{const i=n?n(t[0]):t[0];return i[e].apply(i,k9e.call(t,1))};var R9e={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:(e,t,n,i,r,s,o)=>new Date(e,t||0,null!=n?n:1,i||0,r||0,s||0,o||0),date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return Bh("join",arguments)},indexof:function(){return Bh("indexOf",arguments)},lastindexof:function(){return Bh("lastIndexOf",arguments)},slice:function(){return Bh("slice",arguments)},reverse:e=>e.slice().reverse(),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return Bh("substring",arguments,String)},split:function(){return Bh("split",arguments,String)},replace:function(){return Bh("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const F9e=["view","item","group","xy","x","y"],P9e={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:"datum"===n?e.datum:"event"===n?e.event:"item"===n?e.item:T9e[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,i=e(t.object);n&&(e.memberDepth+=1);const r=e(t.property);return n&&(e.memberDepth-=1),i[r]},CallExpression:(e,t)=>{const n=t.arguments;let i=t.callee.name;return i.startsWith("_")&&(i=i.slice(1)),"if"===i?e(n[0])?e(n[1]):e(n[2]):(e.fn[i]||R9e[i]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>O9e[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>N9e[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>"&&"===t.operator?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,i)=>{e.memberDepth+=1;const r=e(i.key);return e.memberDepth-=1,n[r]=e(i.value),n},{})};function Xv(e,t,n,i,r,s){const o=a=>P9e[a.type](o,a);return o.memberDepth=0,o.fn=Object.create(t),o.params=n,o.datum=i,o.event=r,o.item=s,F9e.forEach(a=>o.fn[a]=(...l)=>r.vega[a](...l)),o(e)}var L9e={operator(e,t){const n=t.ast,i=e.functions;return r=>Xv(n,i,r)},parameter(e,t){const n=t.ast,i=e.functions;return(r,s)=>Xv(n,i,s,r)},event(e,t){const n=t.ast,i=e.functions;return r=>Xv(n,i,void 0,void 0,r)},handler(e,t){const n=t.ast,i=e.functions;return(r,s)=>Xv(n,i,r,s.item&&s.item.datum,s)},encode(e,t){const{marktype:n,channels:i}=t,r=e.functions,s="group"===n||"image"===n||"rect"===n;return(o,a)=>{const l=o.datum;let c,u=0;for(const d in i)c=Xv(i[d].ast,r,a,l,void 0,o),o[d]!==c&&(o[d]=c,u=1);return"rule"!==n&&function M9e(e,t,n){let i;t.x2&&(t.x?(n&&e.x>e.x2&&(i=e.x,e.x=e.x2,e.x2=i),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(i=e.y,e.y=e.y2,e.y2=i),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}(o,i,s),u}}};Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,i){return Array.isArray(i)?n.push.apply(n,e.call(i,t-1)):n.push(i),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var B9e=de(478),$9e=de.n(B9e),V9e=de(559),H9e=de.n(V9e),U9e=de(245),KL=de.n(U9e);function JL(e){return!!e.or}function XL(e){return!!e.and}function QL(e){return!!e.not}function LS(e,t){if(QL(e))LS(e.not,t);else if(XL(e))for(const n of e.and)LS(n,t);else if(JL(e))for(const n of e.or)LS(n,t);else t(e)}function jm(e,t){return QL(e)?{not:jm(e.not,t)}:XL(e)?{and:e.and.map(n=>jm(n,t))}:JL(e)?{or:e.or.map(n=>jm(n,t))}:t(e)}const Kl=H9e(),it=$9e();function ure(e){throw new Error(e)}function Bm(e,t){const n={};for(const i of t)Fe(e,i)&&(n[i]=e[i]);return n}function co(e,t){const n=Object.assign({},e);for(const i of t)delete n[i];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>KL()(e)).join(",")})`};const yn=KL();function wt(e){if(nn(e))return e;const t=be(e)?e:KL()(e);if(t.length<250)return t;let n=0;for(let i=0;i<t.length;i++)n=(n<<5)-n+t.charCodeAt(i),n&=n;return n}function ZL(e){return!1===e||null===e}function Dt(e,t){return e.includes(t)}function $h(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function ej(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function cre(e,...t){for(const n of t)z9e(e,null!=n?n:{});return e}function z9e(e,t){for(const n of oe(t))Tg(e,n,t[n],!0)}function Jl(e,t){const n=[],i={};let r;for(const s of e)r=t(s),!(r in i)&&(i[r]=1,n.push(s));return n}function q9e(e,t){const n=oe(e),i=oe(t);if(n.length!==i.length)return!1;for(const r of n)if(e[r]!==t[r])return!1;return!0}function dre(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function tj(e,t){for(const n of e)if(t.has(n))return!0;return!1}function nj(e){const t=new Set;for(const n of e){const r=xl(n).map((o,a)=>0===a?o:`[${o}]`),s=r.map((o,a)=>r.slice(0,a+1).join(""));for(const o of s)t.add(o)}return t}function ij(e,t){return void 0===e||void 0===t||tj(nj(e),nj(t))}function sn(e){return 0===oe(e).length}const oe=Object.keys,Ar=Object.values,Vd=Object.entries;function Qv(e){return!0===e||!1===e}function Fn(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function Zv(e,t){return QL(e)?`!(${Zv(e.not,t)})`:XL(e)?`(${e.and.map(n=>Zv(n,t)).join(") && (")})`:JL(e)?`(${e.or.map(n=>Zv(n,t)).join(") || (")})`:t(e)}function jS(e,t){if(0===t.length)return!0;const n=t.shift();return n in e&&jS(e[n],t)&&delete e[n],sn(e)}function e1(e){return e.charAt(0).toUpperCase()+e.substr(1)}function rj(e,t="datum"){const n=xl(e),i=[];for(let r=1;r<=n.length;r++){const s=`[${n.slice(0,r).map(pe).join("][")}]`;i.push(`${t}${s}`)}return i.join(" && ")}function fre(e,t="datum"){return`${t}[${pe(xl(e).join("."))}]`}function G9e(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Yo(e){return`${xl(e).map(G9e).join("\\.")}`}function Vh(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function sj(e){return`${xl(e).join(".")}`}function $m(e){return e?xl(e).length:0}function pi(...e){for(const t of e)if(void 0!==t)return t}let hre=42;function pre(e){const t=++hre;return e?String(e)+t:t}function W9e(){hre=42}function gre(e){return mre(e)?e:`__${e}`}function mre(e){return e.startsWith("__")}function t1(e){if(void 0!==e)return(e%360+360)%360}function BS(e){return!!nn(e)||!isNaN(e)&&!isNaN(parseFloat(e))}var n1=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};const sc="row",oc="column",$S="facet",Bn="x",Ui="y",Ya="x2",Xl="y2",Hd="xOffset",Vm="yOffset",Ql="radius",ac="radius2",Ka="theta",lc="theta2",Zl="latitude",eu="longitude",Ja="latitude2",Ko="longitude2",xs="color",tu="fill",nu="stroke",As="shape",uc="size",Hh="angle",cc="opacity",Ud="fillOpacity",zd="strokeOpacity",qd="strokeWidth",Gd="strokeDash",i1="text",r1="order",s1="detail",VS="key",Uh="tooltip",HS="href",US="url",zS="description",_re={theta:1,theta2:1,radius:1,radius2:1};function yre(e){return e in _re}const oj={longitude:1,longitude2:1,latitude:1,latitude2:1},X9e=oe(oj),qS=Object.assign(Object.assign(Object.assign(Object.assign({},{x:1,y:1,x2:1,y2:1}),_re),oj),{xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function Hm(e){return e===xs||e===tu||e===nu}const vre={row:1,column:1,facet:1},Jo=oe(vre),GS=Object.assign(Object.assign({},qS),vre),Q9e=oe(GS),aj=n1(GS,["order","detail","tooltip"]),bre=n1(aj,["row","column","facet"]);function Z9e(e){return!!bre[e]}function wre(e){return!!GS[e]}oe(aj),oe(bre);const eHe=[Ya,Xl,Ja,Ko,lc,ac];function Dre(e){return zh(e)!==e}function zh(e){switch(e){case Ya:return Bn;case Xl:return Ui;case Ja:return Zl;case Ko:return eu;case lc:return Ka;case ac:return Ql}return e}function Wd(e){if(yre(e))switch(e){case Ka:return"startAngle";case lc:return"endAngle";case Ql:return"outerRadius";case ac:return"innerRadius"}return e}function dc(e){switch(e){case Bn:return Ya;case Ui:return Xl;case Zl:return Ja;case eu:return Ko;case Ka:return lc;case Ql:return ac}}function Ms(e){switch(e){case Bn:case Ya:return"width";case Ui:case Xl:return"height"}}function Cre(e){switch(e){case Bn:return"xOffset";case Ui:return"yOffset"}}function Ere(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const nHe=oe(qS),WS=n1(qS,["x","y","x2","y2","xOffset","yOffset","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),iHe=oe(WS),lj={x:1,y:1},iu=oe(lj);function nr(e){return e in lj}const uj={theta:1,radius:1},rHe=oe(uj);function YS(e){return"width"===e?Bn:Ui}const cj={xOffset:1,yOffset:1};function Um(e){return e in cj}oe(cj);const Sre=n1(WS,["text","tooltip","href","url","description","detail","key","order"]),sHe=oe(Sre),xre=Object.assign(Object.assign(Object.assign(Object.assign({},lj),uj),cj),Sre),KS=oe(xre);function Yd(e){return!!xre[e]}const dj={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},uHe=n1(dj,["geoshape"]);function fj(e){switch(e){case Bn:case Ui:case Ka:case Ql:case Hd:case Vm:case uc:case Hh:case qd:case cc:case Ud:case zd:case Ya:case Xl:case lc:case ac:return;case $S:case sc:case oc:case As:case Gd:case i1:case Uh:case HS:case US:case zS:return"discrete";case xs:case tu:case nu:return"flexible";case Zl:case eu:case Ja:case Ko:case s1:case VS:case r1:return}}const dHe={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},fHe={count:1,min:1,max:1};function fc(e){return!!e&&!!e.argmin}function Kd(e){return!!e&&!!e.argmax}function hj(e){return be(e)&&!!dHe[e]}const hHe=new Set(["count","valid","missing","distinct"]);function Are(e){return be(e)&&hHe.has(e)}const gHe=new Set(["count","sum","distinct","valid","missing"]),mHe=new Set(["mean","average","median","q1","q3","min","max"]);function Mre(e){return Wc(e)&&(e=_x(e,void 0)),"bin"+oe(e).map(t=>JS(e[t])?Fn(`_${t}_${Vd(e[t])}`):Fn(`_${t}_${e[t]}`)).join("")}function vn(e){return!0===e||qh(e)&&!e.binned}function is(e){return"binned"===e||qh(e)&&!0===e.binned}function qh(e){return Se(e)}function JS(e){return null==e?void 0:e.param}function Tre(e){switch(e){case sc:case oc:case uc:case xs:case tu:case nu:case qd:case cc:case Ud:case zd:case As:return 6;case Gd:return 4;default:return 10}}function o1(e){return e&&!!e.expr}function Ts(e){const t=oe(e||{}),n={};for(const i of t)n[i]=fo(e[i]);return n}function Ore(e){const{anchor:t,frame:n,offset:i,orient:r,angle:s,limit:o,color:a,subtitleColor:l,subtitleFont:u,subtitleFontSize:c,subtitleFontStyle:d,subtitleFontWeight:f,subtitleLineHeight:h,subtitlePadding:p}=e,g=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["anchor","frame","offset","orient","angle","limit","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),m=Object.assign(Object.assign({},g),a?{fill:a}:{}),_=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),i?{offset:i}:{}),r?{orient:r}:{}),void 0!==s?{angle:s}:{}),void 0!==o?{limit:o}:{}),y=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{subtitleColor:l}:{}),u?{subtitleFont:u}:{}),c?{subtitleFontSize:c}:{}),d?{subtitleFontStyle:d}:{}),f?{subtitleFontWeight:f}:{}),h?{subtitleLineHeight:h}:{}),p?{subtitlePadding:p}:{});return{titleMarkConfig:m,subtitleMarkConfig:Bm(e,["align","baseline","dx","dy","limit"]),nonMarkTitleProperties:_,subtitle:y}}function Jd(e){return be(e)||ie(e)&&be(e[0])}function Le(e){return e&&!!e.signal}function Xd(e){return!!e.step}function hc(e){return!ie(e)&&"field"in e&&"data"in e}const bHe=oe({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1}),wHe={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},pj=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];var gj=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Nre(e){const t=ie(e.condition)?e.condition.map(kre):kre(e.condition);return Object.assign(Object.assign({},fo(e)),{condition:t})}function fo(e){if(o1(e)){const{expr:t}=e,n=gj(e,["expr"]);return Object.assign({signal:t},n)}return e}function kre(e){if(o1(e)){const{expr:t}=e,n=gj(e,["expr"]);return Object.assign({signal:t},n)}return e}function En(e){if(o1(e)){const{expr:t}=e,n=gj(e,["expr"]);return Object.assign({signal:t},n)}return Le(e)?e:void 0!==e?{value:e}:void 0}function DHe(e){return Le(e)?e.signal:pe(e)}function Ire(e){return Le(e)?e.signal:pe(e.value)}function pc(e){return Le(e)?e.signal:null==e?null:pe(e)}function Rre(e){var t;return[].concat(e.type,null!==(t=e.style)&&void 0!==t?t:[])}function Kt(e,t,n,i={}){const{vgChannel:r,ignoreVgConfig:s}=i;return r&&void 0!==t[r]?t[r]:void 0!==t[e]?t[e]:!s||r&&r!==e?Gh(e,t,n,i):void 0}function Gh(e,t,n,{vgChannel:i}={}){return pi(i?XS(e,t,n.style):void 0,XS(e,t,n.style),i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function XS(e,t,n){return Fre(e,Rre(t),n)}function Fre(e,t,n){let i;t=we(t);for(const r of t){const s=n[r];s&&void 0!==s[e]&&(i=s[e])}return i}function Pre(e,t){return we(e).reduce((n,i)=>{var r;return n.field.push(_e(i,t)),n.order.push(null!==(r=i.sort)&&void 0!==r?r:"ascending"),n},{field:[],order:[]})}function Lre(e,t){const n=[...e];return t.forEach(i=>{for(const r of n)if(Kl(r,i))return;n.push(i)}),n}function jre(e,t){return Kl(e,t)||!t?e:e?[...we(e),...we(t)].join(", "):t}function Bre(e,t){const n=e.value,i=t.value;if(null==n||null===i)return{explicit:e.explicit,value:null};if((Jd(n)||Le(n))&&(Jd(i)||Le(i)))return{explicit:e.explicit,value:jre(n,i)};if(Jd(n)||Le(n))return{explicit:e.explicit,value:n};if(Jd(i)||Le(i))return{explicit:e.explicit,value:i};if(!(Jd(n)||Le(n)||Jd(i)||Le(i)))return{explicit:e.explicit,value:Lre(n,i)};throw new Error("It should never reach here")}function mj(e){return`Invalid specification ${yn(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}function $re(e){return("width"==e?"Width":"Height")+' "container" only works for single views and layered views.'}function Vre(e){return`${"width"==e?"Width":"Height"} "container" only works well with autosize "fit" or "fit-${"width"==e?"x":"y"}".`}function Hre(e){return e?`Dropping "fit-${e}" because spec has discrete ${Ms(e)}.`:'Dropping "fit" because spec has discrete size.'}function _j(e){return`Unknown field for ${e}. Cannot calculate view size.`}function Ure(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function SHe(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function zre(e){return`Selection not supported for ${e} yet.`}function qre(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}function Gre(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}function jHe(e){return`Ignoring an invalid transform: ${yn(e)}.`}function Wre(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function HHe(e){return`${e}Offset dropped because ${e} is continuous`}function UHe(e){return`There is no ${e} encoding. Replacing ${e}Offset encoding as ${e}.`}function Yre(e){return`Invalid field type "${e}".`}function Kre(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`}function yj(e,t){return`Dropping ${yn(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}function QS(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function KHe(e){return`${e} encoding has no scale, so specified scale is ignored.`}function JHe(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function XHe(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function QHe(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function vj(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${"ordinal"===t?"order":"magnitude"}.`}function sUe(e){return`Using unaggregated domain with raw field has no effect (${yn(e)}).`}function oUe(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function aUe(e){return`Unaggregated domain is currently unsupported for log scale (${yn(e)}).`}function Jre(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function Xre(e){return`The step for "${e}" is dropped because the ${"width"===e?"x":"y"} is continuous.`}const Qre="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";function ZS(e,t){return`Invalid ${e}: ${yn(t)}.`}function Zre(e){return`1D error band does not support ${e}.`}function ese(e){return`Channel ${e} is required for "binned" bin.`}const tse=EN(CN);let ru=tse;function ce(...e){ru.warn(...e)}function Wh(e){if(e&&Se(e))for(const t of wj)if(t in e)return!0;return!1}const ise=["january","february","march","april","may","june","july","august","september","october","november","december"],NUe=ise.map(e=>e.substr(0,3)),rse=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],kUe=rse.map(e=>e.substr(0,3));function bj(e,t){const n=[];if(t&&void 0!==e.day&&oe(e).length>1&&(ce(function wUe(e){return`Dropping day from datetime ${yn(e)} as day cannot be combined with other units.`}(e)),delete(e=it(e)).day),n.push(void 0!==e.year?e.year:2012),void 0!==e.month){const i=t?function RUe(e){if(BS(e)&&(e=+e),nn(e))return e-1;{const t=e.toLowerCase(),n=ise.indexOf(t);if(-1!==n)return n;const i=t.substr(0,3),r=NUe.indexOf(i);if(-1!==r)return r;throw new Error(ZS("month",e))}}(e.month):e.month;n.push(i)}else if(void 0!==e.quarter){const i=t?function IUe(e){if(BS(e)&&(e=+e),nn(e))return e>4&&ce(ZS("quarter",e)),e-1;throw new Error(ZS("quarter",e))}(e.quarter):e.quarter;n.push(nn(i)?3*i:`${i}*3`)}else n.push(0);if(void 0!==e.date)n.push(e.date);else if(void 0!==e.day){const i=t?function FUe(e){if(BS(e)&&(e=+e),nn(e))return e%7;{const t=e.toLowerCase(),n=rse.indexOf(t);if(-1!==n)return n;const i=t.substr(0,3),r=kUe.indexOf(i);if(-1!==r)return r;throw new Error(ZS("day",e))}}(e.day):e.day;n.push(nn(i)?i+1:`${i}+1`)}else n.push(1);for(const i of["hours","minutes","seconds","milliseconds"]){const r=e[i];n.push(void 0===r?0:r)}return n}function l1(e){const n=bj(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}const sse={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},wj=oe(sse);function Dj(e){return e.startsWith("utc")}const VUe={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function Cj(e){return wj.filter(t=>ose(e,t))}function ose(e,t){const n=e.indexOf(t);return!(n<0||n>0&&"seconds"===t&&"i"===e.charAt(n-1)||e.length>n+3&&"day"===t&&"o"===e.charAt(n+3)||n>0&&"year"===t&&"f"===e.charAt(n-1))}function ase(e){if(!e)return;const t=Cj(e);return`timeUnitSpecifier(${yn(t)}, ${yn(VUe)})`}function rs(e){if(!e)return;let t;return be(e)?t={unit:e}:Se(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),Dj(t.unit)&&(t.utc=!0,t.unit=function $Ue(e){return e.substr(3)}(t.unit)),t}function Ej(e){return e&&!!e.field&&void 0!==e.equal}function Sj(e){return e&&!!e.field&&void 0!==e.lt}function xj(e){return e&&!!e.field&&void 0!==e.lte}function Aj(e){return e&&!!e.field&&void 0!==e.gt}function Mj(e){return e&&!!e.field&&void 0!==e.gte}function Tj(e){if(null==e?void 0:e.field){if(ie(e.range)&&2===e.range.length)return!0;if(Le(e.range))return!0}return!1}function Oj(e){return e&&!!e.field&&(ie(e.oneOf)||ie(e.in))}function lse(e){return Oj(e)||Ej(e)||Tj(e)||Sj(e)||Aj(e)||xj(e)||Mj(e)}function su(e,t){return yx(e,{timeUnit:t,wrapTime:!0})}function use(e,t=!0){var n;const{field:i}=e,r=null===(n=rs(e.timeUnit))||void 0===n?void 0:n.unit,s=r?`time(${function HUe(e,t,{end:n}={end:!1}){const i=rj(t),r=Dj(e)?"utc":"";function s(l){return"quarter"===l?`(${r}quarter(${i})-1)`:`${r}${l}(${i})`}let o;const a={};for(const l of wj)ose(e,l)&&(a[l]=s(l),o=l);return n&&(a[o]+="+1"),function PUe(e){const n=bj(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}(a)}(r,i)})`:_e(e,{expr:"datum"});if(Ej(e))return`${s}===${su(e.equal,r)}`;if(Sj(e))return`${s}<${su(e.lt,r)}`;if(Aj(e))return`${s}>${su(e.gt,r)}`;if(xj(e))return`${s}<=${su(e.lte,r)}`;if(Mj(e))return`${s}>=${su(e.gte,r)}`;if(Oj(e))return`indexof([${function WUe(e,t){return e.map(n=>su(n,t))}(e.oneOf,r).join(",")}], ${s}) !== -1`;if(function GUe(e){return e&&!!e.field&&void 0!==e.valid}(e))return Nj(s,e.valid);if(Tj(e)){const{range:o}=e,a=Le(o)?{signal:`${o.signal}[0]`}:o[0],l=Le(o)?{signal:`${o.signal}[1]`}:o[1];if(null!==a&&null!==l&&t)return"inrange("+s+", ["+su(a,r)+", "+su(l,r)+"])";const u=[];return null!==a&&u.push(`${s} >= ${su(a,r)}`),null!==l&&u.push(`${s} <= ${su(l,r)}`),u.length>0?u.join(" && "):"true"}throw new Error(`Invalid field predicate: ${yn(e)}`)}function Nj(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function YUe(e){var t;return lse(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:null===(t=rs(e.timeUnit))||void 0===t?void 0:t.unit}):e}const Yh={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function KUe(e){return"quantitative"===e||"temporal"===e}function cse(e){return"ordinal"===e||"nominal"===e}const Kh=Yh.quantitative,kj=Yh.ordinal,zm=Yh.temporal,Ij=Yh.nominal,qm=Yh.geojson;oe(Yh);const ex={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function QUe(e,t){const n=ex[e],i=ex[t];return n===i||"ordinal-position"===n&&"time"===i||"ordinal-position"===i&&"time"===n}oe(ex);const ZUe={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function dse(e){return ZUe[e]}const fse=new Set(["linear","log","pow","sqrt","symlog"]),hse=new Set([...fse,"time","utc"]);function pse(e){return fse.has(e)}const gse=new Set(["quantile","quantize","threshold"]),eze=new Set([...hse,...gse,"sequential","identity"]),tze=new Set(["ordinal","bin-ordinal","point","band"]);function zi(e){return tze.has(e)}function ho(e){return eze.has(e)}function Xa(e){return hse.has(e)}function Gm(e){return gse.has(e)}function mse(e){return null==e?void 0:e.param}const Rj={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},oze=(oe(Rj),function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(Rj,["type","domain","range","rangeMax","rangeMin","scheme"])),aze=oe(oze);function Fj(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return Xa(e)||"band"===e||"point"===e;case"padding":case"rangeMin":case"rangeMax":return Xa(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return"band"===e;case"domainMax":case"domainMid":case"domainMin":case"clamp":return Xa(e);case"nice":return Xa(e)||"quantize"===e||"threshold"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"constant":return"symlog"===e;case"zero":return ho(e)&&!Dt(["log","time","utc","threshold","quantile"],e)}}function _se(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return Hm(e)?void 0:function iUe(e){return`Cannot use the scale property "${e}" with non-color channel.`}(e);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}const Mr={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},yse=Mr.arc,tx=Mr.area,nx=Mr.bar,cze=Mr.image,ix=Mr.line,rx=Mr.point,dze=Mr.rect,sx=Mr.rule,vse=Mr.text,Pj=Mr.tick,fze=Mr.trail,Lj=Mr.circle,jj=Mr.square,bse=Mr.geoshape;function Zd(e){return["line","area","trail"].includes(e)}function wse(e){return["rect","bar","image","arc"].includes(e)}const Dse=new Set(oe(Mr));function Qa(e){return e.type}const gze=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],Cse=oe({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1}),Ese=oe({mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1});function Wm(e){return e&&null!=e.band}const yze={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]};function Bj(e){const{channel:t,channelDef:n,markDef:i,scale:r,config:s}=e,o=Vj(e);return ge(n)&&!Are(n.aggregate)&&r&&Xa(r.get("type"))?function Cze({fieldDef:e,channel:t,markDef:n,ref:i,config:r}){return Zd(n.type)?i:null===Kt("invalid",n,r)?[Eze(e,t),i]:i}({fieldDef:n,channel:t,markDef:i,ref:o,config:s}):o}function Eze(e,t){const n=$j(e,!0),r="y"===zh(t)?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function $j(e,t=!0){return Nj(be(e)?e:_e(e,{expr:"datum"}),!t)}function Jh(e,t,n,i){const r={};if(t&&(r.scale=t),au(e)){const{datum:s}=e;Wh(s)?r.signal=l1(s):Le(s)?r.signal=s.signal:o1(s)?r.signal=s.expr:r.value=s}else r.field=_e(e,n);if(i){const{offset:s,band:o}=i;s&&(r.offset=s),o&&(r.band=o)}return r}function ox({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,bandPosition:s=.5}){const o=0<s&&s<1?"datum":void 0,a=_e(t,{expr:o,suffix:r}),l=void 0!==n?_e(n,{expr:o}):_e(t,{suffix:"end",expr:o}),u={};if(0===s||1===s)u.scale=e,u.field=0===s?a:l;else{const c=Le(s)?`${s.signal} * ${a} + (1-${s.signal}) * ${l}`:`${s} * ${a} + ${1-s} * ${l}`;u.signal=`scale("${e}", ${c})`}return i&&(u.offset=i),u}function Vj({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:l,defaultRef:u,bandPosition:c}){var d;if(t){if(Je(t)){const f=null==o?void 0:o.get("type");if(Xo(t)){null!=c||(c=Lse({fieldDef:t,fieldDef2:n,markDef:i,config:r}));const{bin:h,timeUnit:p,type:g}=t;if(vn(h)||c&&p&&g===zm)return(null==a?void 0:a.impute)?Jh(t,s,{binSuffix:"mid"},{offset:l}):c&&!zi(f)?ox({scaleName:s,fieldOrDatumDef:t,bandPosition:c,offset:l}):Jh(t,s,f1(t,e)?{binSuffix:"range"}:{},{offset:l});if(is(h)){if(ge(n))return ox({scaleName:s,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:l});ce(ese(e===Bn?Ya:Xl))}}return Jh(t,s,zi(f)?{binSuffix:"range"}:{},{offset:l,band:"band"===f?null!==(d=null!=c?c:t.bandPosition)&&void 0!==d?d:.5:void 0})}if(Za(t)){const h=l?{offset:l}:{};return Object.assign(Object.assign({},u1(e,t.value)),h)}}return st(u)&&(u=u()),u&&Object.assign(Object.assign({},u),l?{offset:l}:{})}function u1(e,t){return Dt(["x","x2"],e)&&"width"===t?{field:{group:"width"}}:Dt(["y","y2"],e)&&"height"===t?{field:{group:"height"}}:En(t)}function Xh(e){return e&&"number"!==e&&"time"!==e}function xse(e,t,n){return`${e}(${t}${n?`, ${yn(n)}`:""})`}function Hj({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s}){var o,a;if(Xh(n))return Uj({fieldOrDatumDef:e,format:t,formatType:n,expr:i,config:s});const l=Ase(e,i,r);if(Jm(e)){const u=function Mze(e,t,n,i,r){return!t||n?`${r?"utc":"time"}Format(${e}, '${n=be(n)?n:i}')`:function UUe(e,t,n){if(!e)return;const i=ase(e);return`${n||Dj(e)?"utc":"time"}Format(${t}, ${i})`}(t,e,r)}(l,ge(e)?null===(o=rs(e.timeUnit))||void 0===o?void 0:o.unit:void 0,t,s.timeFormat,Qh(e)&&"utc"===(null===(a=e.scale)||void 0===a?void 0:a.type));return u?{signal:u}:void 0}return t=Ose(fx(e),t,s),ge(e)&&vn(e.bin)?{signal:ax(l,_e(e,{expr:i,binSuffix:"end"}),t,n,s)}:t||"quantitative"===fx(e)?{signal:`${Nse(l,t)}`}:{signal:`isValid(${l}) ? ${l} : ""+${l}`}}function Ase(e,t,n){return ge(e)?n?`${_e(e,{expr:t,suffix:"end"})}-${_e(e,{expr:t,suffix:"start"})}`:_e(e,{expr:t}):function Sze(e){const{datum:t}=e;return Wh(t)?l1(t):`${yn(t)}`}(e)}function Uj({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s,field:o}){return null!=o||(o=Ase(e,i,r)),ge(e)&&vn(e.bin)?{signal:ax(o,_e(e,{expr:i,binSuffix:"end"}),t,n,s)}:{signal:xse(n,o,t)}}function Mse(e,t,n,i,r,s){var o;if(!Xh(i))return Jm(e)?function Aze(e,t,n,i){return e||(t?{signal:ase(t)}:i?void 0:n.timeFormat)}(n,ge(e)?null===(o=rs(e.timeUnit))||void 0===o?void 0:o.unit:void 0,r,s):Ose(t,n,r)}function Tse(e,t,n){return e&&(Le(e)||"number"===e||"time"===e)?e:Jm(t)&&"time"!==n&&"utc"!==n?"time":void 0}function Ose(e,t,n){return be(t)?t:e===Kh?n.numberFormat:void 0}function Nse(e,t){return`format(${e}, "${t||""}")`}function kse(e,t,n,i){var r;return Xh(n)?xse(n,e,t):Nse(e,null!==(r=be(t)?t:void 0)&&void 0!==r?r:i.numberFormat)}function ax(e,t,n,i,r){const s=kse(e,n,i,r),o=kse(t,n,i,r);return`${Nj(e,!1)} ? "null" : ${s} + " \u2013 " + ${o}`}const lx="min",Tze={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function Ise(e){return e in Tze}function Rse(e){return!!e&&!!e.encoding}function ou(e){return!(!e||"count"!==e.op&&!e.field)}function Fse(e){return!!e&&ie(e)}function c1(e){return"row"in e||"column"in e}function zj(e){return!!e&&"header"in e}function ux(e){return"facet"in e}var qj=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Pse(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),i?{bin:i}:{}),r?{aggregate:r}:{}),{field:t})}function Gj(e){return"sort"in e}function Lse({fieldDef:e,fieldDef2:t,markDef:n,config:i}){if(Je(e)&&void 0!==e.bandPosition)return e.bandPosition;if(ge(e)){const{timeUnit:r,bin:s}=e;if(r&&!t)return wse(n.type)?0:Gh("timeUnitBandPosition",n,i);if(vn(s))return.5}}function jse({channel:e,fieldDef:t,fieldDef2:n,markDef:i,config:r,scaleType:s,useVlSizeChannel:o}){var a,l,u;const c=Ms(e),d=Kt(o?"size":c,i,r,{vgChannel:c});if(void 0!==d)return d;if(ge(t)){const{timeUnit:f,bin:h}=t;if(f&&!n)return{band:Gh("timeUnitBandSize",i,r)};if(vn(h)&&!zi(s))return{band:1}}return wse(i.type)?s?zi(s)?(null===(a=r[i.type])||void 0===a?void 0:a.discreteBandSize)||{band:1}:null===(l=r[i.type])||void 0===l?void 0:l.continuousBandSize:null===(u=r[i.type])||void 0===u?void 0:u.discreteBandSize:void 0}function Bse(e,t,n,i){return!!(vn(e.bin)||e.timeUnit&&Xo(e)&&"temporal"===e.type)&&void 0!==Lse({fieldDef:e,fieldDef2:t,markDef:n,config:i})}function cx(e){return e&&"condition"in e}function dx(e){const t=e&&e.condition;return!!t&&!ie(t)&&ge(t)}function d1(e){const t=e&&e.condition;return!!t&&!ie(t)&&Je(t)}function ge(e){return e&&(!!e.field||"count"===e.aggregate)}function fx(e){return e&&e.type}function au(e){return e&&"datum"in e}function lu(e){return Xo(e)&&!px(e)||hx(e)}function hx(e){return au(e)&&nn(e.datum)}function Je(e){return ge(e)||au(e)}function Xo(e){return e&&("field"in e||"count"===e.aggregate)&&"type"in e}function Za(e){return e&&"value"in e&&"value"in e}function Qh(e){return e&&("scale"in e||"sort"in e)}function Wj(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function $se(e){return e&&"legend"in e}function Vse(e){return e&&("format"in e||"formatType"in e)}function Ize(e){return co(e,["legend","axis","header","scale"])}function _e(e,t={}){var n,i,r;let s=e.field;const o=t.prefix;let a=t.suffix,l="";if(function Pze(e){return"count"===e.aggregate}(e))s=gre("count");else{let u;if(!t.nofn)if(function Rze(e){return"op"in e}(e))u=e.op;else{const{bin:c,aggregate:d,timeUnit:f}=e;vn(c)?(u=Mre(c),a=(null!==(n=t.binSuffix)&&void 0!==n?n:"")+(null!==(i=t.suffix)&&void 0!==i?i:"")):d?Kd(d)?(l=`["${s}"]`,s=`argmax_${d.argmax}`):fc(d)?(l=`["${s}"]`,s=`argmin_${d.argmin}`):u=String(d):f&&(u=function zUe(e){const t=rs(e),{utc:n}=t,i=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["utc"]);return i.unit?(n?"utc":"")+oe(i).map(r=>Fn(`${"unit"===r?"":`_${r}_`}${i[r]}`)).join(""):(n?"utc":"")+"timeunit"+oe(i).map(r=>Fn(`_${r}_${i[r]}`)).join("")}(f),a=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(null!==(r=t.suffix)&&void 0!==r?r:""))}u&&(s=s?`${u}_${s}`:u)}return a&&(s=`${s}_${a}`),o&&(s=`${o}_${s}`),t.forAs?sj(s):t.expr?fre(s,t.expr)+l:Yo(s)+l}function px(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return ge(e)&&!!e.bin;case"temporal":return!1}throw new Error(Yre(e.type))}const Hse=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return function jze(e){const{aggregate:t,bin:n,timeUnit:i,field:r}=e;if(Kd(t))return`${r} for argmax(${t.argmax})`;if(fc(t))return`${r} for argmin(${t.argmin})`;const s=rs(i),o=t||(null==s?void 0:s.unit)||(null==s?void 0:s.maxbins)&&"timeunit"||vn(n)&&"bin";return o?`${o.toUpperCase()}(${r})`:r}(e);default:return function Lze(e,t){var n;const{field:i,bin:r,timeUnit:s,aggregate:o}=e;if("count"===o)return t.countTitle;if(vn(r))return`${i} (binned)`;if(s){const a=null===(n=rs(s))||void 0===n?void 0:n.unit;if(a)return`${i} (${Cj(a).join("-")})`}else if(o)return Kd(o)?`${i} for max ${o.argmax}`:fc(o)?`${i} for min ${o.argmin}`:`${e1(o)} of ${i}`;return i}(e,t)}};let Use=Hse;function zse(e){Use=e}function Ym(e,t,{allowDisabling:n,includeDefault:i=!0}){var r,s;const o=null===(r=Yj(e))||void 0===r?void 0:r.title;if(!ge(e))return null!=o?o:e.title;const a=e,l=i?Kj(a,t):void 0;return n?pi(o,a.title,l):null!==(s=null!=o?o:a.title)&&void 0!==s?s:l}function Yj(e){return Wj(e)&&e.axis?e.axis:$se(e)&&e.legend?e.legend:zj(e)&&e.header?e.header:void 0}function Kj(e,t){return Use(e,t)}function gx(e){var t;if(Vse(e)){const{format:n,formatType:i}=e;return{format:n,formatType:i}}{const n=null!==(t=Yj(e))&&void 0!==t?t:{},{format:i,formatType:r}=n;return{format:i,formatType:r}}}function uu(e){return ge(e)?e:dx(e)?e.condition:void 0}function Mi(e){return Je(e)?e:d1(e)?e.condition:void 0}function qse(e,t,n,i={}){return be(e)||nn(e)||Wc(e)?(ce(function zHe(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${yn(n)}}.`}(t,be(e)?"string":nn(e)?"number":"boolean",e)),{value:e}):Je(e)?mx(e,t,n,i):d1(e)?Object.assign(Object.assign({},e),{condition:mx(e.condition,t,n,i)}):e}function mx(e,t,n,i){if(Vse(e)){const{formatType:s}=e,o=qj(e,["format","formatType"]);if(Xh(s)&&!n.customFormatTypes)return ce(Wre(t)),mx(o,t,n,i)}else{const r=Wj(e)?"axis":$se(e)?"legend":zj(e)?"header":null;if(r&&e[r]){const s=e[r],{formatType:a}=s,l=qj(s,["format","formatType"]);if(Xh(a)&&!n.customFormatTypes)return ce(Wre(t)),mx(Object.assign(Object.assign({},e),{[r]:l}),t,n,i)}}return ge(e)?Jj(e,t,i):function Vze(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=nn(n)?"quantitative":be(n)?"nominal":Wh(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}(e)}function Jj(e,t,{compositeMark:n=!1}={}){const{aggregate:i,timeUnit:r,bin:s,field:o}=e,a=Object.assign({},e);if(!n&&i&&!hj(i)&&!Kd(i)&&!fc(i)&&(ce(function GHe(e){return`Invalid aggregation operator "${e}".`}(i)),delete a.aggregate),r&&(a.timeUnit=rs(r)),o&&(a.field=`${o}`),vn(s)&&(a.bin=_x(s,t)),is(s)&&!nr(t)&&ce(function SUe(e){return`Channel ${e} should not be used with "binned" bin.`}(t)),Xo(a)){const{type:l}=a,u=function JUe(e){if(e)switch(e=e.toLowerCase(),e){case"q":case Kh:return"quantitative";case"t":case zm:return"temporal";case"o":case kj:return"ordinal";case"n":case Ij:return"nominal";case qm:return"geojson"}}(l);l!==u&&(a.type=u),"quantitative"!==l&&Are(i)&&(ce(function qHe(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}(l,i)),a.type="quantitative")}else if(!Dre(t)){const l=function $ze(e,t){var n;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(Gj(e)&&ie(e.sort))return"ordinal";const{aggregate:i,bin:r,timeUnit:s}=e;if(s)return"temporal";if(r||i&&!Kd(i)&&!fc(i))return"quantitative";if(Qh(e)&&(null===(n=e.scale)||void 0===n?void 0:n.type))switch(ex[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}(a,t);a.type=l}if(Xo(a)){const{compatible:l,warning:u}=function Hze(e,t){const n=e.type;if("geojson"===n&&"shape"!==t)return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case sc:case oc:case $S:return px(e)?Km:{compatible:!1,warning:XHe(t)};case Bn:case Ui:case Hd:case Vm:case xs:case tu:case nu:case i1:case s1:case VS:case Uh:case HS:case US:case Hh:case Ka:case Ql:case zS:return Km;case eu:case Ko:case Zl:case Ja:return n!==Kh?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Km;case cc:case Ud:case zd:case qd:case uc:case lc:case ac:case Ya:case Xl:return"nominal"!==n||e.sort?Km:{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`};case As:case Gd:return px(e)||function Fze(e){var t;return Qh(e)&&Gm(null===(t=e.scale)||void 0===t?void 0:t.type)}(e)?Km:{compatible:!1,warning:QHe(t)};case r1:return"nominal"!==e.type||"sort"in e?Km:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(a,t)||{};!1===l&&ce(u)}if(Gj(a)&&be(a.sort)){const{sort:l}=a;if(Ise(l))return Object.assign(Object.assign({},a),{sort:{encoding:l}});const u=l.substr(1);if("-"===l.charAt(0)&&Ise(u))return Object.assign(Object.assign({},a),{sort:{encoding:u,order:"descending"}})}if(zj(a)){const{header:l}=a;if(l){const{orient:u}=l,c=qj(l,["orient"]);if(u)return Object.assign(Object.assign({},a),{header:Object.assign(Object.assign({},c),{labelOrient:l.labelOrient||u,titleOrient:l.titleOrient||u})})}}return a}function _x(e,t){return Wc(e)?{maxbins:Tre(t)}:"binned"===e?{binned:!0}:e.maxbins||e.step?e:Object.assign(Object.assign({},e),{maxbins:Tre(t)})}const Km={compatible:!0};function Jm(e){const{formatType:t}=gx(e);return"time"===t||!t&&function Uze(e){return e&&("temporal"===e.type||ge(e)&&!!e.timeUnit)}(e)}function yx(e,{timeUnit:t,type:n,wrapTime:i,undefinedIfExprNotRequired:r}){var s;const o=t&&(null===(s=rs(t))||void 0===s?void 0:s.unit);let l,a=o||"temporal"===n;return o1(e)?l=e.expr:Le(e)?l=e.signal:Wh(e)?(a=!0,l=l1(e)):(be(e)||nn(e))&&a&&(l=`datetime(${yn(e)})`,function BUe(e){return!!sse[e]}(o)&&(nn(e)&&e<1e4||be(e)&&isNaN(Date.parse(e)))&&(l=l1({[o]:e}))),l?i&&a?`time(${l})`:l:r?void 0:yn(e)}function Gse(e,t){const{type:n}=e;return t.map(i=>{const r=yx(i,{timeUnit:ge(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==r?{signal:r}:i})}function f1(e,t){return vn(e.bin)?Yd(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const Wse={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function h1(e){return e&&e.condition}const Yse=["domain","grid","labels","ticks","title"],zze={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},Kse={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},Jse=Object.assign(Object.assign({},Kse),{style:1,labelExpr:1,encoding:1});function Xse(e){return!!Jse[e]}oe(Jse);const Qse=oe({axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1});function gc(e){return"mark"in e}class vx{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return!!gc(t)&&function Dze(e){return Qa(e)?e.type:e}(t.mark)===this.name}}function Zh(e,t){const n=e&&e[t];return!!n&&(ie(n)?$h(n,i=>!!i.field):ge(n)||dx(n))}function Zse(e,t){const n=e&&e[t];return!!n&&(ie(n)?$h(n,i=>!!i.field):ge(n)||au(n)||d1(n))}function Xj(e,t){if(nr(t)){const n=e[t];if((ge(n)||au(n))&&cse(n.type))return Zse(e,Cre(t))}return!1}function Qj(e){return $h(Q9e,t=>{if(Zh(e,t)){const n=e[t];if(ie(n))return $h(n,i=>!!i.aggregate);{const i=uu(n);return i&&!!i.aggregate}}return!1})}function eoe(e,t){const n=[],i=[],r=[],s=[],o={};return Zj(e,(a,l)=>{if(ge(a)){const{field:u,aggregate:c,bin:d,timeUnit:f}=a,h=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(a,["field","aggregate","bin","timeUnit"]);if(c||f||d){const p=Yj(a),g=null==p?void 0:p.title;let m=_e(a,{forAs:!0});const _=Object.assign(Object.assign(Object.assign({},g?[]:{title:Ym(a,t,{allowDisabling:!0})}),h),{field:m});if(c){let y;if(Kd(c)?(y="argmax",m=_e({op:"argmax",field:c.argmax},{forAs:!0}),_.field=`${m}.${u}`):fc(c)?(y="argmin",m=_e({op:"argmin",field:c.argmin},{forAs:!0}),_.field=`${m}.${u}`):"boxplot"!==c&&"errorbar"!==c&&"errorband"!==c&&(y=c),y){const v={op:y,as:m};u&&(v.field=u),s.push(v)}}else if(n.push(m),Xo(a)&&vn(d))i.push({bin:d,field:u,as:m}),n.push(_e(a,{binSuffix:"end"})),f1(a,l)&&n.push(_e(a,{binSuffix:"range"})),nr(l)&&(o[`${l}2`]={field:`${m}_end`}),_.bin="binned",Dre(l)||(_.type=Kh);else if(f){r.push({timeUnit:f,field:u,as:m});const y=Xo(a)&&a.type!==zm&&"time";y&&(l===i1||l===Uh?_.formatType=y:function oHe(e){return!!WS[e]}(l)?_.legend=Object.assign({formatType:y},_.legend):nr(l)&&(_.axis=Object.assign({formatType:y},_.axis)))}o[l]=_}else n.push(u),o[l]=e[l]}else o[l]=e[l]}),{bins:i,timeUnits:r,aggregate:s,groupby:n,encoding:o}}function Gze(e,t,n){const i=function lHe(e,t){return function cHe(e){switch(e){case xs:case tu:case nu:case zS:case s1:case VS:case Uh:case HS:case r1:case cc:case Ud:case zd:case qd:case $S:case sc:case oc:return dj;case Bn:case Ui:case Hd:case Vm:case Zl:case eu:return uHe;case Ya:case Xl:case Ja:case Ko:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case uc:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Gd:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case As:return{point:"always",geoshape:"always"};case i1:return{text:"always"};case Hh:return{point:"always",square:"always",text:"always"};case US:return{image:"always"};case Ka:case Ql:return{text:"always",arc:"always"};case lc:case ac:return{arc:"always"}}}(e)[t]}(t,n);if(!i)return!1;if("binned"===i){const r=e[t===Ya?Bn:Ui];return!!(ge(r)&&ge(e[t])&&is(r.bin))}return!0}function bx(e,t){const n={};for(const i of oe(e)){const r=qse(e[i],i,t,{compositeMark:!0});n[i]=r}return n}function Zj(e,t,n){if(e)for(const i of oe(e)){const r=e[i];if(ie(r))for(const s of r)t.call(n,s,i);else t.call(n,r,i)}}function toe(e,t){return oe(t).reduce((n,i)=>{switch(i){case Bn:case Ui:case HS:case zS:case US:case Ya:case Xl:case Hd:case Vm:case Ka:case lc:case Ql:case ac:case Zl:case eu:case Ja:case Ko:case i1:case As:case Hh:case Uh:return n;case r1:if("line"===e||"trail"===e)return n;case s1:case VS:{const r=t[i];if(ie(r)||ge(r))for(const s of we(r))s.aggregate||n.push(_e(s,{}));return n}case uc:if("trail"===e)return n;case xs:case tu:case nu:case cc:case Ud:case zd:case Gd:case qd:{const r=uu(t[i]);return r&&!r.aggregate&&n.push(_e(r,{})),n}}},[])}var noe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function e5(e,t,n,i=!0){if("tooltip"in n)return{tooltip:n.tooltip};const r=e.map(({fieldPrefix:o,titlePrefix:a})=>{const l=i?` of ${t5(t)}`:"";return{field:o+t.field,type:t.type,title:Le(a)?{signal:`${a}"${escape(l)}"`}:a+l}}),s=function Yze(e){const t=[];for(const n of oe(e))if(Zh(e,n)){const r=we(e[n]);for(const s of r)ge(s)?t.push(s):dx(s)&&t.push(s.condition)}return t}(n).map(Ize);return{tooltip:[...r,...Jl(s,wt)]}}function t5(e){const{title:t,field:n}=e;return pi(t,n)}function n5(e,t,n,i,r){const{scale:s,axis:o}=n;return({partName:a,mark:l,positionPrefix:u,endPositionPrefix:c,extraEncoding:d={}})=>{const f=t5(n);return ioe(e,a,r,{mark:l,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:`${u}_${n.field}`,type:n.type},void 0!==f?{title:f}:{}),void 0!==s?{scale:s}:{}),void 0!==o?{axis:o}:{})},be(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{}),i),d)})}}function ioe(e,t,n,i){const{clip:r,color:s,opacity:o}=e,a=e.type;return e[t]||void 0===e[t]&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),r?{clip:r}:{}),s?{color:s}:{}),o?{opacity:o}:{}),Qa(i.mark)?i.mark:{type:i.mark}),{style:`${a}-${t}`}),Wc(e[t])?{}:e[t])})]:[]}function roe(e,t,n){const{encoding:i}=e,r="vertical"===t?"y":"x",o=i[`${r}2`],a=i[`${r}Error`],l=i[`${r}Error2`];return{continuousAxisChannelDef:wx(i[r],n),continuousAxisChannelDef2:wx(o,n),continuousAxisChannelDefError:wx(a,n),continuousAxisChannelDefError2:wx(l,n),continuousAxis:r}}function wx(e,t){if(null==e?void 0:e.aggregate){const{aggregate:n}=e,i=noe(e,["aggregate"]);return n!==t&&ce(function EUe(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}(n,t)),i}return e}function soe(e,t){const{mark:n,encoding:i}=e,{x:r,y:s}=i;if(Qa(n)&&n.orient)return n.orient;if(lu(r)){if(lu(s)){const o=ge(r)&&r.aggregate,a=ge(s)&&s.aggregate;if(!o&&a===t)return"vertical";if(!a&&o===t)return"horizontal";if(o===t&&a===t)throw new Error("Both x and y cannot have aggregate");return Jm(s)&&!Jm(r)?"horizontal":"vertical"}return"horizontal"}if(lu(s))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}var Dx=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};const Cx="boxplot",Qze=new vx(Cx,aoe);function ooe(e){return nn(e)?"tukey":e}function aoe(e,{config:t}){var n,i;e=Object.assign(Object.assign({},e),{encoding:bx(e.encoding,t)});const{mark:r,params:o}=e,l=Dx(e,["mark","encoding","params","projection"]),u=Qa(r)?r:{type:r};o&&ce(zre("boxplot"));const c=null!==(n=u.extent)&&void 0!==n?n:t.boxplot.extent,d=Kt("size",u,t),f=ooe(c),{bins:h,timeUnits:p,transform:g,continuousAxisChannelDef:m,continuousAxis:_,groupby:y,aggregate:v,encodingWithoutContinuousAxis:b,ticksOrient:D,boxOrient:C,customTooltipWithoutAggregatedField:w}=function Zze(e,t,n){const i=soe(e,Cx),{continuousAxisChannelDef:r,continuousAxis:s}=roe(e,i,Cx),o=r.field,a=ooe(t),l=[...loe(o),{op:"median",field:o,as:`mid_box_${o}`},{op:"min",field:o,as:("min-max"===a?"lower_whisker_":"min_")+o},{op:"max",field:o,as:("min-max"===a?"upper_whisker_":"max_")+o}],u="min-max"===a||"tukey"===a?[]:[{calculate:`datum["upper_box_${o}"] - datum["lower_box_${o}"]`,as:`iqr_${o}`},{calculate:`min(datum["upper_box_${o}"] + datum["iqr_${o}"] * ${t}, datum["max_${o}"])`,as:`upper_whisker_${o}`},{calculate:`max(datum["lower_box_${o}"] - datum["iqr_${o}"] * ${t}, datum["min_${o}"])`,as:`lower_whisker_${o}`}],h=Dx(e.encoding,["symbol"==typeof s?s:s+""]),{customTooltipWithoutAggregatedField:p,filteredEncoding:g}=function Jze(e){const{tooltip:t}=e,n=noe(e,["tooltip"]);if(!t)return{filteredEncoding:n};let i,r;if(ie(t)){for(const s of t)s.aggregate?(i||(i=[]),i.push(s)):(r||(r=[]),r.push(s));i&&(n.tooltip=i)}else t.aggregate?n.tooltip=t:r=t;return ie(r)&&1===r.length&&(r=r[0]),{customTooltipWithoutAggregatedField:r,filteredEncoding:n}}(h),{bins:m,timeUnits:_,aggregate:y,groupby:v,encoding:b}=eoe(g,n),D="vertical"===i?"horizontal":"vertical",C=i;return{bins:m,timeUnits:_,transform:[...m,..._,{aggregate:[...y,...l],groupby:v},...u],groupby:v,aggregate:y,continuousAxisChannelDef:r,continuousAxis:s,encodingWithoutContinuousAxis:b,ticksOrient:D,boxOrient:C,customTooltipWithoutAggregatedField:p}}(e,c,t),{color:E,size:N}=b,k=Dx(b,["color","size"]),I=Oe=>n5(u,_,m,Oe,t.boxplot),L=I(k),B=I(b),T=I(Object.assign(Object.assign({},k),N?{size:N}:{})),A=e5([{fieldPrefix:"min-max"===f?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===f?"lower_whisker_":"min_",titlePrefix:"Min"}],m,b),x={type:"tick",color:"black",opacity:1,orient:D,invalid:null,aria:!1},F="min-max"===f?A:e5([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],m,b),O=[...L({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:F}),...L({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:F}),...L({partName:"ticks",mark:x,positionPrefix:"lower_whisker",extraEncoding:F}),...L({partName:"ticks",mark:x,positionPrefix:"upper_whisker",extraEncoding:F})],j=[..."tukey"!==f?O:[],...B({partName:"box",mark:Object.assign(Object.assign({type:"bar"},d?{size:d}:{}),{orient:C,invalid:null,ariaRoleDescription:"box"}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:A}),...T({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},Se(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),d?{size:d}:{}),{orient:D,aria:!1}),positionPrefix:"mid_box",extraEncoding:A})];if("min-max"===f)return Object.assign(Object.assign({},l),{transform:(null!==(i=l.transform)&&void 0!==i?i:[]).concat(g),layer:j});const P=`datum["lower_box_${m.field}"]`,z=`datum["upper_box_${m.field}"]`,q=`(${z} - ${P})`,G=`${P} - ${c} * ${q}`,V=`${z} + ${c} * ${q}`,K=`datum["${m.field}"]`,re={joinaggregate:loe(m.field),groupby:y},X={transform:[{filter:`(${G} <= ${K}) && (${K} <= ${V})`},{aggregate:[{op:"min",field:m.field,as:`lower_whisker_${m.field}`},{op:"max",field:m.field,as:`upper_whisker_${m.field}`},{op:"min",field:`lower_box_${m.field}`,as:`lower_box_${m.field}`},{op:"max",field:`upper_box_${m.field}`,as:`upper_box_${m.field}`},...v],groupby:y}],layer:O},Y=Dx(k,["tooltip"]),{scale:Z,axis:ne}=m,W=t5(m),he=co(ne,["title"]),ve=ioe(u,"outliers",t.boxplot,{transform:[{filter:`(${K} < ${G}) || (${K} > ${V})`}],mark:"point",encoding:Object.assign(Object.assign(Object.assign({[_]:Object.assign(Object.assign(Object.assign({field:m.field,type:m.type},void 0!==W?{title:W}:{}),void 0!==Z?{scale:Z}:{}),sn(he)?{}:{axis:he})},Y),E?{color:E}:{}),w?{tooltip:w}:{})})[0];let Re;const Ce=[...h,...p,re];return ve?Re={transform:Ce,layer:[ve,X]}:(Re=X,Re.transform.unshift(...Ce)),Object.assign(Object.assign({},l),{layer:[Re,{transform:g,layer:j}]})}function loe(e){return[{op:"q1",field:e,as:`lower_box_${e}`},{op:"q3",field:e,as:`upper_box_${e}`}]}var uoe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};const i5="errorbar",tqe=new vx(i5,coe);function coe(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:bx(e.encoding,t)});const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,ticksOrient:o,markDef:a,outerSpec:l,tooltipEncoding:u}=doe(e,i5,t);delete s.size;const c=n5(a,r,i,s,t.errorbar),d=a.thickness,f=a.size,h=Object.assign(Object.assign({type:"tick",orient:o,aria:!1},void 0!==d?{thickness:d}:{}),void 0!==f?{size:f}:{}),p=[...c({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:u}),...c({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:u}),...c({partName:"rule",mark:Object.assign({type:"rule",ariaRoleDescription:"errorbar"},void 0!==d?{size:d}:{}),positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u})];return Object.assign(Object.assign(Object.assign({},l),{transform:n}),p.length>1?{layer:p}:Object.assign({},p[0]))}function doe(e,t,n){var i;const{mark:r,encoding:s,params:o}=e,l=uoe(e,["mark","encoding","params","projection"]),u=Qa(r)?r:{type:r};o&&ce(zre(t));const{orient:c,inputType:d}=function nqe(e,t){const{encoding:n}=e;if(function iqe(e){return(Je(e.x)||Je(e.y))&&!Je(e.x2)&&!Je(e.y2)&&!Je(e.xError)&&!Je(e.xError2)&&!Je(e.yError)&&!Je(e.yError2)}(n))return{orient:soe(e,t),inputType:"raw"};const i=function rqe(e){return Je(e.x2)||Je(e.y2)}(n),r=function sqe(e){return Je(e.xError)||Je(e.xError2)||Je(e.yError)||Je(e.yError2)}(n),s=n.x,o=n.y;if(i){if(r)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const a=n.x2,l=n.y2;if(Je(a)&&Je(l))throw new Error(`${t} cannot have both x2 and y2`);if(Je(a)){if(lu(s))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}if(Je(l)){if(lu(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}{const a=n.xError,u=n.yError,c=n.yError2;if(Je(n.xError2)&&!Je(a))throw new Error(`${t} cannot have xError2 without xError`);if(Je(c)&&!Je(u))throw new Error(`${t} cannot have yError2 without yError`);if(Je(a)&&Je(u))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(Je(a)){if(lu(s))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(Je(u)){if(lu(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}(e,t),{continuousAxisChannelDef:f,continuousAxisChannelDef2:h,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:g,continuousAxis:m}=roe(e,c,t),{errorBarSpecificAggregate:_,postAggregateCalculates:y,tooltipSummary:v,tooltipTitleWithFieldName:b}=function oqe(e,t,n,i,r,s,o,a){let l=[],u=[];const c=t.field;let d,f=!1;if("raw"===s){const h=e.center?e.center:e.extent?"iqr"===e.extent?"median":"mean":a.errorbar.center,p=e.extent?e.extent:"mean"===h?"stderr":"iqr";if("median"===h!=("iqr"===p)&&ce(function CUe(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}(h,p,o)),"stderr"===p||"stdev"===p)l=[{op:p,field:c,as:`extent_${c}`},{op:h,field:c,as:`center_${c}`}],u=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],d=[{fieldPrefix:"center_",titlePrefix:e1(h)},{fieldPrefix:"upper_",titlePrefix:foe(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:foe(h,p,"-")}],f=!0;else{let g,m,_;"ci"===p?(g="mean",m="ci0",_="ci1"):(g="median",m="q1",_="q3"),l=[{op:m,field:c,as:`lower_${c}`},{op:_,field:c,as:`upper_${c}`},{op:g,field:c,as:`center_${c}`}],d=[{fieldPrefix:"upper_",titlePrefix:Ym({field:c,aggregate:_,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Ym({field:c,aggregate:m,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Ym({field:c,aggregate:g,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&ce(function DUe(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}(e.center,e.extent)),"aggregated-upper-lower"===s?(d=[],u=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):"aggregated-error"===s&&(d=[{fieldPrefix:"",titlePrefix:c}],u=[{calculate:`datum["${c}"] + datum["${i.field}"]`,as:`upper_${c}`}],u.push(r?{calculate:`datum["${c}"] + datum["${r.field}"]`,as:`lower_${c}`}:{calculate:`datum["${c}"] - datum["${i.field}"]`,as:`lower_${c}`}));for(const h of u)d.push({fieldPrefix:h.as.substring(0,6),titlePrefix:Vh(Vh(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:l,tooltipSummary:d,tooltipTitleWithFieldName:f}}(u,f,h,p,g,d,t,n),E="x"===m?"x2":"y2",k="x"===m?"xError":"yError",L="x"===m?"xError2":"yError2",T=uoe(s,["symbol"==typeof m?m:m+"","symbol"==typeof E?E:E+"","symbol"==typeof k?k:k+"","symbol"==typeof L?L:L+""]),{bins:A,timeUnits:x,aggregate:F,groupby:O,encoding:j}=eoe(T,n),P=[...F,..._],z="raw"!==d?[]:O,q=e5(v,f,j,b);return{transform:[...null!==(i=l.transform)&&void 0!==i?i:[],...A,...x,...0===P.length?[]:[{aggregate:P,groupby:z}],...y],groupby:z,continuousAxisChannelDef:f,continuousAxis:m,encodingWithoutContinuousAxis:j,ticksOrient:"vertical"===c?"horizontal":"vertical",markDef:u,outerSpec:l,tooltipEncoding:q}}function foe(e,t,n){return`${e1(e)} ${n} ${t}`}const r5="errorband",lqe=new vx(r5,hoe);function hoe(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:bx(e.encoding,t)});const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,markDef:o,outerSpec:a,tooltipEncoding:l}=doe(e,r5,t),u=o,c=n5(u,r,i,s,t.errorband),d=void 0!==e.encoding.x&&void 0!==e.encoding.y;let f={type:d?"area":"rect"},h={type:d?"line":"rule"};const p=Object.assign(Object.assign({},u.interpolate?{interpolate:u.interpolate}:{}),u.tension&&u.interpolate?{tension:u.tension}:{});return d?(f=Object.assign(Object.assign(Object.assign({},f),p),{ariaRoleDescription:"errorband"}),h=Object.assign(Object.assign(Object.assign({},h),p),{aria:!1})):u.interpolate?ce(Zre("interpolate")):u.tension&&ce(Zre("tension")),Object.assign(Object.assign({},a),{transform:n,layer:[...c({partName:"band",mark:f,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l}),...c({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:l}),...c({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:l})]})}const s5={};function o5(e,t,n){const i=new vx(e,t);s5[e]={normalizer:i,parts:n}}o5(Cx,aoe,["box","median","outliers","rule","ticks"]),o5(i5,coe,["ticks","rule"]),o5(r5,hoe,["band","borders"]);const cqe=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],poe={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},goe={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},dqe=oe(poe),fqe=oe(goe),moe=oe({header:1,headerRow:1,headerColumn:1,headerFacet:1}),_oe=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],yoe={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},p1=(oe(yoe),"_vgsid_"),pqe={point:{on:"click",fields:[p1],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function a5(e){return!(!e||"legend"!==e&&!e.legend)}function l5(e){return a5(e)&&Se(e)}function u5(e){return!!e.select}var gqe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function voe(e){const t=[];for(const n of e||[]){if(u5(n))continue;const{expr:i,bind:r}=n,s=gqe(n,["expr","bind"]);if(r&&i){const o=Object.assign(Object.assign({},s),{bind:r,init:i});t.push(o)}else{const o=Object.assign(Object.assign(Object.assign({},s),i?{update:i}:{}),r?{bind:r}:{});t.push(o)}}return t}function c5(e){return"concat"in e}function Ex(e){return"vconcat"in e}function d5(e){return"hconcat"in e}function boe({step:e,offsetIsDiscrete:t}){var n;return t?null!==(n=e.for)&&void 0!==n?n:"offset":"position"}function cu(e){return Se(e)&&void 0!==e.step}function woe(e){return e.view||e.width||e.height}const _qe=oe({align:1,bounds:1,center:1,columns:1,spacing:1});function f5(e,t){var n;return null!==(n=e[t])&&void 0!==n?n:e["width"===t?"continuousWidth":"continuousHeight"]}function Sx(e,t){const n=xx(e,t);return cu(n)?n.step:Coe}function xx(e,t){var n;return pi(null!==(n=e[t])&&void 0!==n?n:e["width"===t?"discreteWidth":"discreteHeight"],{step:e.step})}const Coe=20,wqe={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:Coe},mark:{color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},arc:{},area:{},bar:{binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},circle:{},geoshape:{},image:{},line:{},point:{},rect:{binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5},rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:pqe,style:{},title:{},facet:{spacing:20},concat:{spacing:20}},mc=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],Eoe={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},Soe={blue:mc[0],orange:mc[1],red:mc[2],teal:mc[3],green:mc[4],yellow:mc[5],purple:mc[6],pink:mc[7],brown:mc[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function xoe(e){const t=oe(e||{}),n={};for(const i of t){const r=e[i];n[i]=h1(r)?Nre(r):fo(r)}return n}const xqe=[...Ese,...Qse,...moe,"background","padding","legend","lineBreak","scale","style","title","view"];function Aoe(e={}){const{color:t,font:n,fontSize:i,selection:r}=e,s=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["color","font","fontSize","selection"]),o=Mg({},it(wqe),n?function Eqe(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}(n):{},t?function Dqe(e={}){return{signals:[{name:"color",value:Se(e)?Object.assign(Object.assign({},Soe),e):Soe}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(t):{},i?function Cqe(e){return{signals:[{name:"fontSize",value:Se(e)?Object.assign(Object.assign({},Eoe),e):Eoe}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(i):{},s||{});r&&Tg(o,"selection",r,!0);const a=co(o,xqe);for(const l of["background","lineBreak","padding"])o[l]&&(a[l]=fo(o[l]));for(const l of Ese)o[l]&&(a[l]=Ts(o[l]));for(const l of Qse)o[l]&&(a[l]=xoe(o[l]));for(const l of moe)o[l]&&(a[l]=Ts(o[l]));return o.legend&&(a.legend=Ts(o.legend)),o.scale&&(a.scale=Ts(o.scale)),o.style&&(a.style=function Sqe(e){const t=oe(e),n={};for(const i of t)n[i]=xoe(e[i]);return n}(o.style)),o.title&&(a.title=Ts(o.title)),o.view&&(a.view=Ts(o.view)),a}const Aqe=new Set(["view",...Dse]),Mqe=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],Tqe=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},{area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]});function kqe(e,t,n,i){"view"===t&&(n="cell");const s=Object.assign(Object.assign({},i?e[t][i]:e[t]),e.style[null!=n?n:t]);sn(s)||(e.style[null!=n?n:t]=s),i||delete e[t]}function Ax(e){return"layer"in e}class h5{map(t,n){return ux(t)?this.mapFacet(t,n):function Iqe(e){return"repeat"in e}(t)?this.mapRepeat(t,n):d5(t)?this.mapHConcat(t,n):Ex(t)?this.mapVConcat(t,n):c5(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(Ax(t))return this.mapLayer(t,n);if(gc(t))return this.mapUnit(t,n);throw new Error(mj(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(i=>this.mapLayerOrUnit(i,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(i=>this.map(i,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(i=>this.map(i,n))})}mapConcat(t,n){const{concat:i}=t,r=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["concat"]);return Object.assign(Object.assign({},r),{concat:i.map(s=>this.map(s,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const Pqe={zero:1,center:1,normalize:1},jqe=new Set([yse,nx,tx,sx,rx,Lj,jj,ix,vse,Pj]),Bqe=new Set([nx,tx,yse]);function Xm(e){return ge(e)&&"quantitative"===fx(e)&&!e.bin}function Moe(e,t){var n,i;const r="x"===t?"y":"radius",s=e[t],o=e[r];if(ge(s)&&ge(o))if(Xm(s)&&Xm(o)){if(s.stack)return t;if(o.stack)return r;const a=ge(s)&&!!s.aggregate;if(a!==(ge(o)&&!!o.aggregate))return a?t:r;{const u=null===(n=s.scale)||void 0===n?void 0:n.type,c=null===(i=o.scale)||void 0===i?void 0:i.type;if(u&&"linear"!==u)return r;if(c&&"linear"!==c)return t}}else{if(Xm(s))return t;if(Xm(o))return r}else{if(Xm(s))return t;if(Xm(o))return r}}function Toe(e,t,n={}){var i,r;const s=Qa(e)?e.type:e;if(!jqe.has(s))return null;const o=Moe(t,"x")||Moe(t,"theta");if(!o)return null;const a=t[o],l=ge(a)?_e(a,{}):void 0,u=function $qe(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(o),c=[],d=new Set;if(t[u]){const p=t[u],g=ge(p)?_e(p,{}):void 0;g&&g!==l&&(c.push(u),d.add(g));const m="x"===u?"xOffset":"yOffset",_=t[m],y=ge(_)?_e(_,{}):void 0;y&&y!==l&&(c.push(m),d.add(y))}const f=iHe.reduce((p,g)=>{if("tooltip"!==g&&Zh(t,g)){const m=t[g];for(const _ of we(m)){const y=uu(_);if(y.aggregate)continue;const v=_e(y,{});(!v||!d.has(v))&&p.push({channel:g,fieldDef:y})}}return p},[]);let h;if(void 0!==a.stack?h=Wc(a.stack)?a.stack?"zero":null:a.stack:Bqe.has(s)&&(h="zero"),!h||!function Lqe(e){return e in Pqe}(h)||Qj(t)&&0===f.length)return null;if((null===(i=null==a?void 0:a.scale)||void 0===i?void 0:i.type)&&"linear"!==(null===(r=null==a?void 0:a.scale)||void 0===r?void 0:r.type)){if(n.disallowNonLinearStack)return null;ce(function vUe(e){return`Cannot stack non-linear scale (${e}).`}(a.scale.type))}return Je(t[dc(o)])?(void 0!==a.stack&&ce(function yUe(e){return`Cannot stack "${e}" if there is already "${e}2".`}(o)),null):(ge(a)&&a.aggregate&&!gHe.has(a.aggregate)&&ce(function bUe(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}(a.aggregate)),{groupbyChannels:c,groupbyFields:d,fieldChannel:o,impute:null!==a.impute&&Zd(s),stackBy:f,offset:h})}var Ooe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Vqe(e){const i=Ooe(e,["point","line"]);return oe(i).length>1?i:i.type}function Hqe(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:co(e[t],["point","line"])}));return e}function p5(e,t={},n){return"transparent"===e.point?{opacity:0}:e.point?Se(e.point)?e.point:{}:void 0!==e.point?null:t.point||n.shape?Se(t.point)?t.point:{}:void 0}function Noe(e,t={}){return e.line?!0===e.line?{}:e.line:void 0!==e.line?null:t.line?!0===t.line?{}:t.line:void 0}class Uqe{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(gc(t)){const{mark:i,encoding:r}=t,s=Qa(i)?i:{type:i};switch(s.type){case"line":case"rule":case"trail":return!!p5(s,n[s.type],r);case"area":return!!p5(s,n[s.type],r)||!!Noe(s,n[s.type])}}return!1}run(t,n,i){const{config:r}=n,{params:s,projection:o,mark:a,encoding:l}=t,u=Ooe(t,["params","projection","mark","encoding"]),c=bx(l,r),d=Qa(a)?a:{type:a},f=p5(d,r[d.type],c),h="area"===d.type&&Noe(d,r[d.type]),p=[Object.assign(Object.assign({},s?{params:s}:{}),{mark:Vqe(Object.assign(Object.assign({},"area"===d.type&&void 0===d.opacity&&void 0===d.fillOpacity?{opacity:.7}:{}),d)),encoding:co(c,["shape"])})],g=Toe(d,c);let m=c;if(g){const{fieldChannel:_,offset:y}=g;m=Object.assign(Object.assign({},c),{[_]:Object.assign(Object.assign({},c[_]),y?{stack:y}:{})})}return h&&p.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},Bm(d,["clip","interpolate","tension","tooltip"])),h),encoding:m})),f&&p.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},Bm(d,["clip","tooltip"])),f),encoding:m})),i(Object.assign(Object.assign({},u),{layer:p}),Object.assign(Object.assign({},n),{config:Hqe(r)}))}}function qqe(e,t){return t?c1(e)?Foe(e,t):koe(e,t):e}function g5(e,t){return t?Foe(e,t):e}function m5(e,t,n){const i=t[e];return function Nze(e){return e&&!be(e)&&"repeat"in e}(i)?i.repeat in n?Object.assign(Object.assign({},t),{[e]:n[i.repeat]}):void ce(function RHe(e){return`Unknown repeated value "${e}".`}(i.repeat)):t}function koe(e,t){if(void 0!==(e=m5("field",e,t))){if(null===e)return null;if(Gj(e)&&ou(e.sort)){const n=m5("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function Ioe(e,t){if(ge(e))return koe(e,t);{const n=m5("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function Roe(e,t){if(!Je(e)){if(d1(e)){const n=Ioe(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["condition"])}return e}{const n=Ioe(e,t);if(n)return n;if(cx(e))return{condition:e.condition}}}function Foe(e,t){const n={};for(const i in e)if(Fe(e,i)){const r=e[i];if(ie(r))n[i]=r.map(s=>Roe(s,t)).filter(s=>s);else{const s=Roe(r,t);void 0!==s&&(n[i]=s)}}return n}class Gqe{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(gc(t)){const{encoding:n,mark:i}=t;if("line"===i||Qa(i)&&"line"===i.type)for(const r of eHe){const o=n[zh(r)];if(n[r]&&(ge(o)&&!is(o.bin)||au(o)))return!0}}return!1}run(t,n,i){const{encoding:r,mark:s}=t;return ce(function tUe(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}(!!r.x2,!!r.y2)),i(Object.assign(Object.assign({},t),{mark:Se(s)?Object.assign(Object.assign({},s),{type:"rule"}):"rule"}),n)}}var ef=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Poe({parentEncoding:e,encoding:t={},layer:n}){let i={};if(e){const r=new Set([...oe(e),...oe(t)]);for(const s of r){const o=t[s],a=e[s];if(Je(o)){const l=Object.assign(Object.assign({},a),o);i[s]=l}else d1(o)?i[s]=Object.assign(Object.assign({},o),{condition:Object.assign(Object.assign({},a),o.condition)}):o||null===o?i[s]=o:(n||Za(a)||Le(a)||Je(a)||ie(a))&&(i[s]=a)}}else i=t;return!i||sn(i)?void 0:i}function Loe(e){const{parentProjection:t,projection:n}=e;return t&&n&&ce(function $He(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${yn(t)} is overridden by a child projection ${yn(n)}.`}({parentProjection:t,projection:n})),null!=n?n:t}function _5(e){return"filter"in e}function Yqe(e){return void 0!==(null==e?void 0:e.stop)}function joe(e){return"lookup"in e}function Xqe(e){return"pivot"in e}function Qqe(e){return"density"in e}function Zqe(e){return"quantile"in e}function eGe(e){return"regression"in e}function tGe(e){return"loess"in e}function nGe(e){return"sample"in e}function iGe(e){return"window"in e}function rGe(e){return"joinaggregate"in e}function sGe(e){return"flatten"in e}function oGe(e){return"calculate"in e}function Boe(e){return"bin"in e}function aGe(e){return"impute"in e}function lGe(e){return"timeUnit"in e}function uGe(e){return"aggregate"in e}function cGe(e){return"stack"in e}function dGe(e){return"fold"in e}var tf=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function $oe(e,t){const{transform:n}=e,i=tf(e,["transform"]);if(n){const r=n.map(s=>{if(_5(s))return{filter:y5(s,t)};if(Boe(s)&&qh(s.bin))return Object.assign(Object.assign({},s),{bin:Hoe(s.bin)});if(joe(s)){const o=s.from,{selection:a}=o,l=tf(o,["selection"]);return a?Object.assign(Object.assign({},s),{from:Object.assign({param:a},l)}):s}return s});return Object.assign(Object.assign({},i),{transform:r})}return e}function Voe(e,t){var n,i;const r=it(e);if(ge(r)&&qh(r.bin)&&(r.bin=Hoe(r.bin)),Qh(r)&&(null===(i=null===(n=r.scale)||void 0===n?void 0:n.domain)||void 0===i?void 0:i.selection)){const s=r.scale.domain,{selection:o}=s,a=tf(s,["selection"]);r.scale.domain=Object.assign(Object.assign({},a),o?{param:o}:{})}if(cx(r))if(ie(r.condition))r.condition=r.condition.map(s=>{const{param:a}=s,u=tf(s,["selection","param","test"]);return a?s:Object.assign(Object.assign({},u),{test:y5(s,t)})});else{const s=Voe(r.condition,t),{param:a}=s,u=tf(s,["selection","param","test"]);r.condition=a?r.condition:Object.assign(Object.assign({},u),{test:y5(r.condition,t)})}return r}function Hoe(e){const t=e.extent;if(null==t?void 0:t.selection){const{selection:n}=t,i=tf(t,["selection"]);return Object.assign(Object.assign({},e),{extent:Object.assign(Object.assign({},i),{param:n})})}return e}function y5(e,t){const n=i=>jm(i,r=>{var s,o,a;const u={param:r,empty:null===(s=t.emptySelections[r])||void 0===s||s};return null!==(o=(a=t.selectionPredicates)[r])&&void 0!==o||(a[r]=[]),t.selectionPredicates[r].push(u),u});return e.selection?n(e.selection):jm(e.test||e.filter,i=>i.selection?n(i.selection):i)}class v5 extends h5{map(t,n){var i;const r=null!==(i=n.selections)&&void 0!==i?i:[];if(t.params&&!gc(t)){const s=[];for(const o of t.params)u5(o)?r.push(o):s.push(o);t.params=s}return n.selections=r,super.map(t,Uoe(t,n))}mapUnit(t,n){var i;const r=n.selections;if(!r||!r.length)return t;const s=(null!==(i=n.path)&&void 0!==i?i:[]).concat(t.name),o=[];for(const a of r)if(a.views&&a.views.length)for(const l of a.views)(be(l)&&(l===t.name||s.indexOf(l)>=0)||ie(l)&&l.map(u=>s.indexOf(u)).every((u,c,d)=>-1!==u&&(0===c||u>d[c-1])))&&o.push(a);else o.push(a);return o.length&&(t.params=o),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=v5.prototype[e];v5.prototype[e]=function(n,i){return t.call(this,n,Uoe(n,i))}}function Uoe(e,t){var n;return e.name?Object.assign(Object.assign({},t),{path:(null!==(n=t.path)&&void 0!==n?n:[]).concat(e.name)}):t}function zoe(e,t){void 0===t&&(t=Aoe(e.config));const n=function _Ge(e,t={}){const n={config:t};return mGe.map(pGe.map(gGe.map(e,n),n),n)}(e,t),{width:i,height:r}=e,s=function yGe(e,t,n){let{width:i,height:r}=t;const s=gc(e)||Ax(e),o={};s?"container"==i&&"container"==r?(o.type="fit",o.contains="padding"):"container"==i?(o.type="fit-x",o.contains="padding"):"container"==r&&(o.type="fit-y",o.contains="padding"):("container"==i&&(ce($re("width")),i=void 0),"container"==r&&(ce($re("height")),r=void 0));const a=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?qoe(n.autosize):{}),qoe(e.autosize));if("fit"===a.type&&!s&&(ce('Autosize "fit" only works for single views and layered views.'),a.type="pad"),"container"==i&&!("fit"==a.type||"fit-x"==a.type)&&ce(Vre("width")),"container"==r&&!("fit"==a.type||"fit-y"==a.type)&&ce(Vre("height")),!Kl(a,{type:"pad"}))return a}(n,{width:i,height:r,autosize:e.autosize},t);return Object.assign(Object.assign({},n),s?{autosize:s}:{})}const pGe=new class Wqe extends h5{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[Qze,tqe,lqe,new Uqe,new Gqe]}map(t,n){if(gc(t)){const i=Zh(t.encoding,sc),r=Zh(t.encoding,oc),s=Zh(t.encoding,$S);if(i||r||s)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:i,parentProjection:r}=n,s=g5(t.encoding,n.repeater),o=Object.assign(Object.assign({},t),s?{encoding:s}:{});if(i||r)return this.mapUnitWithParentEncodingOrProjection(o,n);const a=this.mapLayerOrUnit.bind(this);for(const l of this.nonFacetUnitNormalizers)if(l.hasMatchingType(o,n.config))return l.run(o,n,a);return o}mapRepeat(t,n){return function Rqe(e){return!ie(e.repeat)&&e.repeat.layer}(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:i,spec:r}=t,s=ef(t,["repeat","spec"]),{row:o,column:a,layer:l}=i,{repeater:u={},repeaterPrefix:c=""}=n;return o||a?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),a?{column:a}:{}),spec:{repeat:{layer:l},spec:r}}),n):Object.assign(Object.assign({},s),{layer:l.map(d=>{const f=Object.assign(Object.assign({},u),{layer:d}),h=`${(r.name||"")+c}child__layer_${Fn(d)}`,p=this.mapLayerOrUnit(r,Object.assign(Object.assign({},n),{repeater:f,repeaterPrefix:h}));return p.name=h,p})})}mapNonLayerRepeat(t,n){var i;const{repeat:r,spec:s,data:o}=t,a=ef(t,["repeat","spec","data"]);!ie(r)&&t.columns&&(t=co(t,["columns"]),ce(qre("repeat")));const l=[],{repeater:u={},repeaterPrefix:c=""}=n,d=!ie(r)&&r.row||[u?u.row:null],f=!ie(r)&&r.column||[u?u.column:null],h=ie(r)&&r||[u?u.repeat:null];for(const g of h)for(const m of d)for(const _ of f){const y={repeat:g,row:m,column:_,layer:u.layer},v=(s.name||"")+c+"child__"+(ie(r)?`${Fn(g)}`:(r.row?`row_${Fn(m)}`:"")+(r.column?`column_${Fn(_)}`:"")),b=this.map(s,Object.assign(Object.assign({},n),{repeater:y,repeaterPrefix:v}));b.name=v,l.push(co(b,["data"]))}const p=ie(r)?t.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:null!==(i=s.data)&&void 0!==i?i:o,align:"all"},a),{columns:p,concat:l})}mapFacet(t,n){const{facet:i}=t;return c1(i)&&t.columns&&(t=co(t,["columns"]),ce(qre("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:i,projection:r}=t,{parentEncoding:s,parentProjection:o,config:a}=n,l=Loe({parentProjection:o,projection:r}),u=Poe({parentEncoding:s,encoding:g5(i,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),l?{projection:l}:{}),u?{encoding:u}:{}),{config:a})}mapFacetedUnit(t,n){const i=t.encoding,{row:r,column:s,facet:o}=i,a=ef(i,["row","column","facet"]),{mark:l,width:u,projection:c,height:d,view:f,params:h}=t,g=ef(t,["mark","width","projection","height","view","params","encoding"]),{facetMapping:m,layout:_}=this.getFacetMappingAndLayout({row:r,column:s,facet:o},n),y=g5(a,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},g),_),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u?{width:u}:{}),d?{height:d}:{}),f?{view:f}:{}),c?{projection:c}:{}),{mark:l,encoding:y}),h?{params:h}:{})}),n)}getFacetMappingAndLayout(t,n){var i;const{row:r,column:s,facet:o}=t;if(r||s){o&&ce(function ZHe(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}([...r?[sc]:[],...s?[oc]:[]]));const a={},l={};for(const u of[sc,oc]){const c=t[u];if(c){const g=ef(c,["align","center","spacing","columns"]);a[u]=g;for(const m of["align","center","spacing"])void 0!==c[m]&&(null!==(i=l[m])&&void 0!==i||(l[m]={}),l[m][u]=c[m])}}return{facetMapping:a,layout:l}}{const{align:a,center:l,spacing:u,columns:c}=o;return{facetMapping:qqe(ef(o,["align","center","spacing","columns"]),n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},a?{align:a}:{}),l?{center:l}:{}),u?{spacing:u}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:i,parentProjection:r}=n,s=ef(n,["parentEncoding","parentProjection"]);const{encoding:o,projection:a}=t,l=ef(t,["encoding","projection"]),u=Object.assign(Object.assign({},s),{parentEncoding:Poe({parentEncoding:i,encoding:o,layer:!0}),parentProjection:Loe({parentProjection:r,projection:a})});return super.mapLayer(l,u)}},gGe=new class hGe extends h5{map(t,n){var i,r;return null!==(i=n.emptySelections)&&void 0!==i||(n.emptySelections={}),null!==(r=n.selectionPredicates)&&void 0!==r||(n.selectionPredicates={}),t=$oe(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if((t=$oe(t,n)).encoding){const i={};for(const[r,s]of Vd(t.encoding))i[r]=Voe(s,n);t=Object.assign(Object.assign({},t),{encoding:i})}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const i=t,{selection:r}=i,s=tf(i,["selection"]);return r?Object.assign(Object.assign({},s),{params:Vd(r).map(([o,a])=>{var l;const u=a,{init:c,bind:d,empty:f}=u,h=tf(u,["init","bind","empty"]);"single"===h.type?(h.type="point",h.toggle=!1):"multi"===h.type&&(h.type="point"),n.emptySelections[o]="none"!==f;for(const p of Ar(null!==(l=n.selectionPredicates[o])&&void 0!==l?l:{}))p.empty="none"!==f;return{name:o,value:c,select:h,bind:d}})}):t}},mGe=new v5;function qoe(e){return be(e)?{type:e}:null!=e?e:{}}const wGe=["background","padding"];function Goe(e,t){const n={};for(const i of wGe)e&&void 0!==e[i]&&(n[i]=fo(e[i]));return t&&(n.params=e.params),n}class _c{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new _c(it(this.explicit),it(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return pi(this.explicit[t],this.implicit[t])}getWithExplicit(t){return void 0!==this.explicit[t]?{explicit:!0,value:this.explicit[t]}:void 0!==this.implicit[t]?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:i}){void 0!==n&&this.set(t,n,i)}set(t,n,i){return delete this[i?"implicit":"explicit"][t],this[i?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:i}){void 0!==n[t]?this.set(t,n[t],!0):void 0!==i[t]&&this.set(t,i[t],!1)}copyKeyFromObject(t,n){void 0!==n[t]&&this.set(t,n[t],!0)}copyAll(t){for(const n of oe(t.combine())){const i=t.getWithExplicit(n);this.setWithExplicit(n,i)}}}function du(e){return{explicit:!0,value:e}}function po(e){return{explicit:!1,value:e}}function Woe(e){return(t,n,i,r)=>{const s=e(t.value,n.value);return s>0?t:s<0?n:Mx(t,n,i,r)}}function Mx(e,t,n,i){return e.explicit&&t.explicit&&ce(function dUe(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${yn(n)} and ${yn(i)}). Using ${yn(n)}.`}(n,i,e.value,t.value)),e}function nf(e,t,n,i,r=Mx){return void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:Kl(e.value,t.value)?e:r(e,t,n,i)}class DGe extends _c{constructor(t={},n={},i=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=i}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function Qm(e){return"url"in e}function g1(e){return"values"in e}function Yoe(e){return"name"in e&&!Qm(e)&&!g1(e)&&!rf(e)}function rf(e){return e&&(Koe(e)||Joe(e)||b5(e))}function Koe(e){return"sequence"in e}function Joe(e){return"sphere"in e}function b5(e){return"graticule"in e}var gn=(()=>(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup"}(gn||(gn={})),gn))(),CGe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Zm(e,t=!0,n=mr){if(ie(e)){const i=e.map(r=>Zm(r,t,n));return t?`[${i.join(", ")}]`:i}return Wh(e)?n(t?l1(e):function LUe(e){const t=bj(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}(e)):t?n(yn(e)):e}function EGe(e,t){var n;for(const i of Ar(null!==(n=e.component.selection)&&void 0!==n?n:{})){const r=i.name;let s=`${r}${lf}, ${"global"===i.resolve?"true":`{unit: ${n0(e)}}`}`;for(const o of Ix)!o.defined(i)||(o.signals&&(t=o.signals(e,i,t)),o.modifyExpr&&(s=o.modifyExpr(e,i,s)));t.push({name:r+rWe,on:[{events:{signal:i.name+lf},update:`modify(${pe(i.name+ep)}, ${s})`}]})}return w5(t)}function SGe(e,t){if(e.component.selection&&oe(e.component.selection).length){const n=pe(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Bd("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return w5(t)}function Xoe(e,t){var n;for(const i of Ar(null!==(n=e.component.selection)&&void 0!==n?n:{}))for(const r of Ix)r.defined(i)&&r.marks&&(t=r.marks(e,i,t));return t}function w5(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}class on{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){this._children.includes(t)?ce("Attempt to add the same child twice."):void 0!==n?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const i of this._children)i.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class ss extends on{constructor(t,n,i,r){super(t,n),this.type=i,this.refCounts=r,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash=`Output ${pre()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}var Qoe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};class fu extends on{constructor(t,n){super(t),this.formula=n}clone(){return new fu(null,it(this.formula))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s)=>{const{field:o,timeUnit:a}=s;if(a){const l=_e(s,{forAs:!0});r[wt({as:l,field:o,timeUnit:a})]={as:l,field:o,timeUnit:a}}return r},{});return sn(i)?null:new fu(t,i)}static makeFromTransform(t,n){const i=Object.assign({},n),{timeUnit:r}=i,s=Qoe(i,["timeUnit"]),o=rs(r),a=Object.assign(Object.assign({},s),{timeUnit:o});return new fu(t,{[wt(a)]:a})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)this.formula[n]||(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[i,r]of Vd(this.formula))t.has(r.as)||(n[i]=r);this.formula=n}producedFields(){return new Set(Ar(this.formula).map(t=>t.as))}dependentFields(){return new Set(Ar(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${wt(this.formula)}`}assemble(){const t=[];for(const n of Ar(this.formula)){const{field:i,as:r,timeUnit:s}=n,o=rs(s),{unit:a,utc:l}=o,u=Qoe(o,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:Yo(i),type:"timeunit"},a?{units:Cj(a)}:{}),l?{timezone:"utc"}:{}),u),{as:[r,`${r}_end`]}))}return t}}const m1="_tuple_fields";class NGe{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const kGe={defined:()=>!0,parse:(e,t,n)=>{var i;const r=t.name,s=null!==(i=t.project)&&void 0!==i?i:t.project=new NGe,o={},a={},l=new Set,u=(g,m)=>{const _="visual"===m?g.channel:g.field;let y=Fn(`${r}_${_}`);for(let v=1;l.has(y);v++)y=Fn(`${r}_${_}_${v}`);return l.add(y),{[m]:y}},c=t.type,d=e.config.selection[c],f=void 0!==n.value?we(n.value):null;let{fields:h,encodings:p}=Se(n.select)?n.select:{};if(!h&&!p&&f)for(const g of f)if(Se(g))for(const m of oe(g))Z9e(m)?(p||(p=[])).push(m):"interval"===c?(ce('Interval selections should be initialized using "x" and/or "y" keys.'),p=d.encodings):(h||(h=[])).push(m);!h&&!p&&(p=d.encodings,"fields"in d&&(h=d.fields));for(const g of null!=p?p:[]){const m=e.fieldDef(g);if(m){let _=m.field;if(m.aggregate){ce(SHe(g,m.aggregate));continue}if(!_){ce(Ure(g));continue}if(m.timeUnit){_=e.vgField(g);const y={timeUnit:m.timeUnit,as:_,field:m.field};a[wt(y)]=y}if(!o[_]){let y="E";"interval"===c?ho(e.getScaleComponent(g).get("type"))&&(y="R"):m.bin&&(y="R-RE");const v={field:_,channel:g,type:y};v.signals=Object.assign(Object.assign({},u(v,"data")),u(v,"visual")),s.items.push(o[_]=v),s.hasField[_]=s.hasChannel[g]=o[_]}}else ce(Ure(g))}for(const g of null!=h?h:[]){if(s.hasField[g])continue;const m={type:"E",field:g};m.signals=Object.assign({},u(m,"data")),s.items.push(m),s.hasField[g]=m}f&&(t.init=f.map(g=>s.items.map(m=>Se(g)?void 0!==g[m.channel]?g[m.channel]:g[m.field]:g))),sn(a)||(s.timeUnit=new fu(null,a))},signals:(e,t,n)=>{const i=t.name+m1;return n.filter(s=>s.name===i).length>0?n:n.concat({name:i,value:t.project.items.map(s=>{const l=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(s,["signals","hasLegend"]);return l.field=Yo(l.field),l})})}},sf={defined:e=>"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind,parse:(e,t)=>{const n=t.scales=[];for(const i of t.project.items){const r=i.channel;if(!Yd(r))continue;const s=e.getScaleComponent(r),o=s?s.get("type"):void 0;s&&ho(o)?(s.set("selectionExtent",{param:t.name,field:i.field},!0),n.push(i)):ce("Scale bindings are currently only supported for scales with unbinned, continuous domains.")}},topLevelSignals:(e,t,n)=>{const i=t.scales.filter(o=>0===n.filter(a=>a.name===o.signals.data).length);if(!e.parent||C5(e)||0===i.length)return n;const r=n.filter(o=>o.name===t.name)[0];let s=r.update;if(s.indexOf(vae)>=0)r.update=`{${i.map(o=>`${pe(Yo(o.field))}: ${o.signals.data}`).join(", ")}}`;else{for(const o of i){const a=`${pe(Yo(o.field))}: ${o.signals.data}`;s.includes(a)||(s=`${s.substring(0,s.length-1)}, ${a}}`)}r.update=s}return n.concat(i.map(o=>({name:o.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!C5(e))for(const i of t.scales){const r=n.filter(s=>s.name===i.signals.data)[0];r.push="outer",delete r.value,delete r.update}return n}};function D5(e,t){return`domain(${pe(e.scaleName(t))})`}function C5(e){var t;return e.parent&&c0(e.parent)&&(null!==(t=!e.parent.parent)&&void 0!==t?t:C5(e.parent.parent))}const e0="_brush",E5="_scale_trigger",RGe={defined:e=>"interval"===e.type,signals:(e,t,n)=>{const i=t.name,r=i+m1,s=sf.defined(t),o=t.init?t.init[0]:null,a=[],l=[];if(t.translate&&!s){const c=`!event.item || event.item.mark.name !== ${pe(i+e0)}`;Zoe(t,(d,f)=>{var h,p;const g=we(null!==(h=(p=f.between[0]).filter)&&void 0!==h?h:p.filter=[]);return g.includes(c)||g.push(c),d})}t.project.items.forEach((c,d)=>{const f=c.channel;if(f!==Bn&&f!==Ui)return void ce("Interval selections only support x and y encoding channels.");const p=function FGe(e,t,n,i){const r=n.channel,s=n.signals.visual,o=n.signals.data,a=sf.defined(t),l=pe(e.scaleName(r)),u=e.getScaleComponent(r),c=u?u.get("type"):void 0,d=g=>`scale(${l}, ${g})`,f=e.getSizeSignalRef(r===Bn?"width":"height").signal,h=`${r}(unit)`,p=Zoe(t,(g,m)=>[...g,{events:m.between[0],update:`[${h}, ${h}]`},{events:m,update:`[${s}[0], clamp(${h}, 0, ${f})]`}]);return p.push({events:{signal:t.name+E5},update:ho(c)?`[${d(`${o}[0]`)}, ${d(`${o}[1]`)}]`:"[0, 0]"}),a?[{name:o,on:[]}]:[Object.assign(Object.assign({name:s},i?{init:Zm(i,!0,d)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:o},i?{init:Zm(i)}:{}),{on:[{events:{signal:s},update:`${s}[0] === ${s}[1] ? null : invert(${l}, ${s})`}]})]}(e,t,c,o?o[d]:null),g=c.signals.data,m=c.signals.visual,_=pe(e.scaleName(f)),v=ho(e.getScaleComponent(f).get("type"))?"+":"";n.push(...p),a.push(g),l.push({scaleName:e.scaleName(f),expr:`(!isArray(${g}) || (${v}invert(${_}, ${m})[0] === ${v}${g}[0] && ${v}invert(${_}, ${m})[1] === ${v}${g}[1]))`})}),!s&&l.length&&n.push({name:i+E5,value:{},on:[{events:l.map(c=>({scale:c.scaleName})),update:`${l.map(c=>c.expr).join(" && ")} ? ${i+E5} : {}`}]});const u=`unit: ${n0(e)}, fields: ${r}, values`;return n.concat(Object.assign(Object.assign({name:i+lf},o?{init:`{${u}: ${Zm(o)}}`}:{}),a.length?{on:[{events:[{signal:a.join(" || ")}],update:`${a.join(" && ")} ? {${u}: [${a}]} : null`}]}:{}))},marks:(e,t,n)=>{const i=t.name,{x:r,y:s}=t.project.hasChannel,o=null==r?void 0:r.signals.visual,a=null==s?void 0:s.signals.visual,l=`data(${pe(t.name+ep)})`;if(sf.defined(t)||!r&&!s)return n;const u={x:void 0!==r?{signal:`${o}[0]`}:{value:0},y:void 0!==s?{signal:`${a}[0]`}:{value:0},x2:void 0!==r?{signal:`${o}[1]`}:{field:{group:"width"}},y2:void 0!==s?{signal:`${a}[1]`}:{field:{group:"height"}}};if("global"===t.resolve)for(const m of oe(u))u[m]=[Object.assign({test:`${l}.length && ${l}[0].unit === ${n0(e)}`},u[m]),{value:0}];const c=t.mark,{fill:d,fillOpacity:f,cursor:h}=c,p=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(c,["fill","fillOpacity","cursor"]),g=oe(p).reduce((m,_)=>(m[_]=[{test:[void 0!==r&&`${o}[0] !== ${o}[1]`,void 0!==s&&`${a}[0] !== ${a}[1]`].filter(y=>y).join(" && "),value:p[_]},{value:null}],m),{});return[{name:`${i+e0}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:d},fillOpacity:{value:f}},update:u}},...n,{name:i+e0,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},h?{cursor:{value:h}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},u),g)}}]}};function Zoe(e,t){return e.events.reduce((n,i)=>i.between?t(n,i):(ce(`${i} is not an ordered event stream for interval selections.`),n),[])}const PGe={defined:e=>"point"===e.type,signals:(e,t,n)=>{var i;const r=t.name,s=r+m1,a="(item().isVoronoi ? datum.datum : datum)",l=t.project.items.map(h=>{const p=e.fieldDef(h.channel);return(null==p?void 0:p.bin)?`[${a}[${pe(e.vgField(h.channel,{}))}], ${a}[${pe(e.vgField(h.channel,{binSuffix:"end"}))}]]`:`${a}[${pe(h.field)}]`}).join(", "),u=`unit: ${n0(e)}, fields: ${s}, values`,c=t.events,d=Ar(null!==(i=e.component.selection)&&void 0!==i?i:{}).reduce((h,p)=>"interval"===p.type?h.concat(p.name+e0):h,[]).map(h=>`indexof(item().mark.name, '${h}') < 0`).join(" && ");return n.concat([{name:r+lf,on:c?[{events:c,update:`${"datum && item().mark.marktype !== 'group'"+(d?` && ${d}`:"")} ? {${u}: [${l}]} : null`,force:!0}]:[]}])}};function t0(e,t,n,i){const r=cx(t)&&t.condition,s=i(t);return r?{[n]:[...we(r).map(l=>{const u=i(l);if(function Oze(e){return e.param}(l)){const{param:c,empty:d}=l,f=Cae(e,{param:c,empty:d});return Object.assign({test:f},u)}{const c=Rx(e,l.test);return Object.assign({test:c},u)}}),...void 0!==s?[s]:[]]}:void 0!==s?{[n]:s}:{}}function S5(e,t="text"){return t0(e,e.encoding[t],t,i=>Tx(i,e.config))}function Tx(e,t,n="datum"){if(e){if(Za(e))return En(e.value);if(Je(e)){const{format:i,formatType:r}=gx(e);return Hj({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t})}}}function eae(e,t={}){const{encoding:n,markDef:i,config:r,stack:s}=e,o=n.tooltip;if(ie(o))return{tooltip:nae({tooltip:o},s,r,t)};{const a=t.reactiveGeom?"datum.datum":"datum";return t0(e,o,"tooltip",l=>{const u=Tx(l,r,a);if(u)return u;if(null===l)return;let c=Kt("tooltip",i,r);return!0===c&&(c={content:"encoding"}),be(c)?{value:c}:Se(c)?Le(c)?c:"encoding"===c.content?nae(n,s,r,t):{signal:a}:void 0})}}function tae(e,t,n,{reactiveGeom:i}={}){const r={},s=i?"datum.datum":"datum",o=[];function a(u,c){const d=zh(c),f=Xo(u)?u:Object.assign(Object.assign({},u),{type:e[d].type}),p=we(f.title||Kj(f,n)).join(", ");let g;if(nr(c)){const m="x"===c?"x2":"y2",_=uu(e[m]);if(is(f.bin)&&_){const y=_e(f,{expr:s}),v=_e(_,{expr:s}),{format:b,formatType:D}=gx(f);g=ax(y,v,b,D,n),r[m]=!0}else if(t&&t.fieldChannel===c&&"normalize"===t.offset){const{format:y,formatType:v}=gx(f);g=Hj({fieldOrDatumDef:f,format:y,formatType:v,expr:s,config:n,normalizeStack:!0}).signal}}null!=g||(g=Tx(f,n,s).signal),o.push({channel:c,key:p,value:g})}Zj(e,(u,c)=>{ge(u)?a(u,c):dx(u)&&a(u.condition,c)});const l={};for(const{channel:u,key:c,value:d}of o)!r[u]&&!l[c]&&(l[c]=d);return l}function nae(e,t,n,{reactiveGeom:i}={}){const r=tae(e,t,n,{reactiveGeom:i}),s=Vd(r).map(([o,a])=>`"${o}": ${a}`);return s.length>0?{signal:`{${s.join(", ")}}`}:void 0}function qi(e,t,n={}){const{markDef:i,encoding:r,config:s}=t,{vgChannel:o}=n;let{defaultRef:a,defaultValue:l}=n;return void 0===a&&(null!=l||(l=Kt(e,i,s,{vgChannel:o,ignoreVgConfig:!0})),void 0!==l&&(a=En(l))),t0(t,r[e],null!=o?o:e,c=>Vj({channel:e,channelDef:c,markDef:i,config:s,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:a}))}function iae(e,t={filled:void 0}){var n,i,r,s;const{markDef:o,encoding:a,config:l}=e,{type:u}=o,c=null!==(n=t.filled)&&void 0!==n?n:Kt("filled",o,l),d=Dt(["bar","point","circle","square","geoshape"],u)?"transparent":void 0,f=null!==(r=null!==(i=Kt(!0===c?"color":void 0,o,l,{vgChannel:"fill"}))&&void 0!==i?i:l.mark[!0===c&&"color"])&&void 0!==r?r:d,h=null!==(s=Kt(!1===c?"color":void 0,o,l,{vgChannel:"stroke"}))&&void 0!==s?s:l.mark[!1===c&&"color"],p=c?"fill":"stroke",g=Object.assign(Object.assign({},f?{fill:En(f)}:{}),h?{stroke:En(h)}:{});return o.color&&(c?o.fill:o.stroke)&&ce(Kre("property",{fill:"fill"in o,stroke:"stroke"in o})),Object.assign(Object.assign(Object.assign(Object.assign({},g),qi("color",e,{vgChannel:p,defaultValue:c?f:h})),qi("fill",e,{defaultValue:a.fill?f:void 0})),qi("stroke",e,{defaultValue:a.stroke?h:void 0}))}function _1({channel:e,markDef:t,encoding:n={},model:i,bandPosition:r}){const s=`${e}Offset`,o=t[s],a=n[s];if(("xOffset"===s||"yOffset"===s)&&a)return{offsetType:"encoding",offset:Vj({channel:s,channelDef:a,markDef:t,config:null==i?void 0:i.config,scaleName:i.scaleName(s),scale:i.getScaleComponent(s),stack:null,defaultRef:En(o),bandPosition:r})};const l=t[s];return l?{offsetType:"visual",offset:l}:{}}function Tr(e,t,{defaultPos:n,vgChannel:i}){const{encoding:r,markDef:s,config:o,stack:a}=t,l=r[e],u=r[dc(e)],c=t.scaleName(e),d=t.getScaleComponent(e),{offset:f,offsetType:h}=_1({channel:e,markDef:s,encoding:r,model:t,bandPosition:.5}),p=x5({model:t,defaultPos:n,channel:e,scaleName:c,scale:d}),g=!l&&nr(e)&&(r.latitude||r.longitude)?{field:t.getName(e)}:function VGe(e){const{channel:t,channelDef:n,scaleName:i,stack:r,offset:s,markDef:o}=e;if(Je(n)&&r&&t===r.fieldChannel){if(ge(n)){let a=n.bandPosition;if(void 0===a&&"text"===o.type&&("radius"===t||"theta"===t)&&(a=.5),void 0!==a)return ox({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",bandPosition:a,offset:s})}return Jh(n,i,{suffix:"end"},{offset:s})}return Bj(e)}({channel:e,channelDef:l,channel2Def:u,markDef:s,config:o,scaleName:c,scale:d,stack:a,offset:f,defaultRef:p,bandPosition:"encoding"===h?0:void 0});return g?{[i||e]:g}:void 0}function x5({model:e,defaultPos:t,channel:n,scaleName:i,scale:r}){const{markDef:s,config:o}=e;return()=>{const a=zh(n),l=Wd(n),u=Kt(n,s,o,{vgChannel:l});if(void 0!==u)return u1(n,u);switch(t){case"zeroOrMin":case"zeroOrMax":if(i){if(!Dt(["log","time","utc"],r.get("type"))&&r.domainDefinitelyIncludesZero())return{scale:i,value:0}}if("zeroOrMin"===t)return"y"===a?{field:{group:"height"}}:{value:0};switch(a){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[Ms(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const HGe={left:"x",center:"xc",right:"x2"},UGe={top:"y",middle:"yc",bottom:"y2"};function rae(e,t,n,i="middle"){if("radius"===e||"theta"===e)return Wd(e);const r="x"===e?"align":"baseline",s=Kt(r,t,n);let o;return Le(s)?(ce(function eUe(e){return`The ${e} for range marks cannot be an expression`}(r)),o=void 0):o=s,"x"===e?HGe[o||("top"===i?"left":"center")]:UGe[o||i]}function Ox(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?sae(e,t,{defaultPos:n,defaultPos2:i}):Tr(e,t,{defaultPos:n})}function sae(e,t,{defaultPos:n,defaultPos2:i}){const{markDef:r,config:s}=t,o=dc(e),a=Ms(e),l=function zGe(e,t,n){const{encoding:i,mark:r,markDef:s,stack:o,config:a}=e,l=zh(n),u=Ms(n),c=Wd(n),d=i[l],f=e.scaleName(l),h=e.getScaleComponent(l),{offset:p}=_1(n in i||n in s?{channel:n,markDef:s,encoding:i,model:e}:{channel:l,markDef:s,encoding:i,model:e});if(!d&&("x2"===n||"y2"===n)&&(i.latitude||i.longitude)){const m=Ms(n),_=e.markDef[m];return null!=_?{[m]:{value:_}}:{[c]:{field:e.getName(n)}}}const g=function qGe({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:l,defaultRef:u}){return Je(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?Jh(t,s,{suffix:"start"},{offset:l}):Bj({channel:e,channelDef:n,scaleName:s,scale:o,stack:a,markDef:i,config:r,offset:l,defaultRef:u})}({channel:n,channelDef:d,channel2Def:i[n],markDef:s,config:a,scaleName:f,scale:h,stack:o,offset:p,defaultRef:void 0});return void 0!==g?{[c]:g}:Nx(n,s)||Nx(n,{[n]:XS(n,s,a.style),[u]:XS(u,s,a.style)})||Nx(n,a[r])||Nx(n,a.mark)||{[c]:x5({model:e,defaultPos:t,channel:n,scaleName:f,scale:h})()}}(t,i,o),u=l[a]?rae(e,r,s):Wd(e);return Object.assign(Object.assign({},Tr(e,t,{defaultPos:n,vgChannel:u})),l)}function Nx(e,t){const n=Ms(e),i=Wd(e);if(void 0!==t[i])return{[i]:u1(e,t[i])};if(void 0!==t[e])return{[i]:u1(e,t[e])};if(t[n]){const r=t[n];if(!Wm(r))return{[n]:u1(e,r)};ce(function WHe(e){return`Position range does not support relative band size for ${e}.`}(n))}}function af(e,t){var n,i;const{config:r,encoding:s,markDef:o}=e,a=o.type,l=dc(t),u=Ms(t),c=s[t],d=s[l],f=e.getScaleComponent(t),h=f?f.get("type"):void 0,p=o.orient,g=null!==(i=null!==(n=s[u])&&void 0!==n?n:s.size)&&void 0!==i?i:Kt("size",o,r,{vgChannel:u}),m="bar"===a&&("x"===t?"vertical"===p:"horizontal"===p);return!ge(c)||!(vn(c.bin)||is(c.bin)||c.timeUnit&&!d)||g&&!Wm(g)||zi(h)?(Je(c)&&zi(h)||m)&&!d?function WGe(e,t,n){const{markDef:i,encoding:r,config:s,stack:o}=n,a=i.orient,l=n.scaleName(t),u=n.getScaleComponent(t),c=Ms(t),d=dc(t),f=function tHe(e){switch(e){case Bn:return"xOffset";case Ui:return"yOffset";case Ya:return"x2Offset";case Xl:return"y2Offset";case Ka:return"thetaOffset";case Ql:return"radiusOffset";case lc:return"theta2Offset";case ac:return"radius2Offset"}}(t),h=n.scaleName(f),p="horizontal"===a&&"y"===t||"vertical"===a&&"x"===t;let g;(r.size||i.size)&&(p?g=qi("size",n,{vgChannel:c,defaultRef:En(i.size)}):ce(function lUe(e){return`Cannot apply size to non-oriented mark "${e}".`}(i.type)));const m=jse({channel:t,fieldDef:e,markDef:i,config:s,scaleType:null==u?void 0:u.get("type"),useVlSizeChannel:p});g=g||{[c]:GGe(c,h||l,u,s,m)};const y=rae(t,i,s,"band"===(null==u?void 0:u.get("type"))&&"band"in g[c]?"top":"middle"),v="xc"===y||"yc"===y,{offset:b,offsetType:D}=_1({channel:t,markDef:i,encoding:r,model:n,bandPosition:v?.5:0}),C=Bj({channel:t,channelDef:e,markDef:i,config:s,scaleName:l,scale:u,stack:o,offset:b,defaultRef:x5({model:n,defaultPos:"mid",channel:t,scaleName:l,scale:u}),bandPosition:v?"encoding"===D?0:.5:Le(m)?{signal:`(1-${m})/2`}:Wm(m)?(1-m.band)/2:0});if(c)return Object.assign({[y]:C},g);{const w=Wd(d),E=g[c],N=b?Object.assign(Object.assign({},E),{offset:b}):E;return{[y]:C,[w]:ie(C)?[C[0],Object.assign(Object.assign({},C[1]),{offset:N})]:Object.assign(Object.assign({},C),{offset:N})}}}(c,t,e):sae(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"}):function YGe({fieldDef:e,fieldDef2:t,channel:n,model:i}){var r,s,o;const{config:a,markDef:l,encoding:u}=i,c=i.getScaleComponent(n),d=i.scaleName(n),f=c?c.get("type"):void 0,h=c.get("reverse"),p=jse({channel:n,fieldDef:e,markDef:l,config:a,scaleType:f}),g=null===(r=i.component.axes[n])||void 0===r?void 0:r[0],m=null!==(s=null==g?void 0:g.get("translate"))&&void 0!==s?s:.5,_=nr(n)&&null!==(o=Kt("binSpacing",l,a))&&void 0!==o?o:0,y=dc(n),v=Wd(n),b=Wd(y),{offset:D}=_1({channel:n,markDef:l,encoding:u,model:i,bandPosition:0}),C=Le(p)?{signal:`(1-${p.signal})/2`}:Wm(p)?(1-p.band)/2:.5;if(vn(e.bin)||e.timeUnit)return{[b]:oae({fieldDef:e,scaleName:d,bandPosition:C,offset:y1(y,_,h,m,D)}),[v]:oae({fieldDef:e,scaleName:d,bandPosition:Le(C)?{signal:`1-${C.signal}`}:1-C,offset:y1(n,_,h,m,D)})};if(is(e.bin)){const w=Jh(e,d,{},{offset:y1(y,_,h,m,D)});if(ge(t))return{[b]:w,[v]:Jh(t,d,{},{offset:y1(n,_,h,m,D)})};if(qh(e.bin)&&e.bin.step)return{[b]:w,[v]:{signal:`scale("${d}", ${_e(e,{expr:"datum"})} + ${e.bin.step})`,offset:y1(n,_,h,m,D)}}}ce(ese(y))}({fieldDef:c,fieldDef2:d,channel:t,model:e})}function GGe(e,t,n,i,r){if(Wm(r)){if(!n)return{mult:r.band,field:{group:e}};{const o=n.get("type");if("band"===o)return{scale:t,band:r.band};1!==r.band&&(ce(function rUe(e){return`Cannot use the relative band size with ${e} scale.`}(o)),r=void 0)}}else{if(Le(r))return r;if(r)return{value:r}}if(n){const o=n.get("range");if(Xd(o)&&nn(o.step))return{value:o.step-2}}return{value:Sx(i.view,e)-2}}function y1(e,t,n,i,r){if(yre(e))return 0;const s="x"===e||"y2"===e?-t/2:t/2;if(Le(n)||Le(r)||Le(i)){const o=pc(n),a=pc(r),l=pc(i);return{signal:(l?`${l} + `:"")+(o?`(${o} ? -1 : 1) * `:"")+(a?`(${a} + ${s})`:s)}}return r=r||0,i+(n?-r-s:+r+s)}function oae({fieldDef:e,scaleName:t,bandPosition:n,offset:i}){return ox({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:i})}const KGe=new Set(["aria","width","height"]);function Qo(e,t){const{fill:n,stroke:i}="include"===t.color?iae(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function JGe(e,t){return bHe.reduce((n,i)=>(!KGe.has(i)&&void 0!==e[i]&&"ignore"!==t[i]&&(n[i]=En(e[i])),n),{})}(e.markDef,t)),aae(e,"fill",n)),aae(e,"stroke",i)),qi("opacity",e)),qi("fillOpacity",e)),qi("strokeOpacity",e)),qi("strokeWidth",e)),qi("strokeDash",e)),function $Ge(e){const{encoding:t,mark:n}=e,i=t.order;return!Zd(n)&&Za(i)?t0(e,i,"zindex",r=>En(r.value)):{}}(e)),eae(e)),S5(e,"href")),function LGe(e){const{markDef:t,config:n}=e,i=Kt("aria",t,n);return!1===i?{}:Object.assign(Object.assign(Object.assign({},i?{aria:i}:{}),function jGe(e){const{mark:t,markDef:n,config:i}=e;if(!1===i.aria)return{};const r=Kt("ariaRoleDescription",n,i);return null!=r?{ariaRoleDescription:{value:r}}:t in wHe?{}:{ariaRoleDescription:{value:t}}}(e)),function BGe(e){const{encoding:t,markDef:n,config:i,stack:r}=e,s=t.description;if(s)return t0(e,s,"description",l=>Tx(l,e.config));const o=Kt("description",n,i);if(null!=o)return{description:En(o)};if(!1===i.aria)return{};const a=tae(t,r,i);return sn(a)?void 0:{description:{signal:Vd(a).map(([l,u],c)=>`"${c>0?"; ":""}${l}: " + (${u})`).join(" + ")}}}(e))}(e))}function aae(e,t,n){const{config:i,mark:r,markDef:s}=e;if("hide"===Kt("invalid",s,i)&&n&&!Zd(r)){const a=function XGe(e,{invalid:t=!1,channels:n}){const i=n.reduce((s,o)=>{const a=e.getScaleComponent(o);if(a){const l=a.get("type"),u=e.vgField(o,{expr:"datum"});u&&ho(l)&&(s[u]=!0)}return s},{}),r=oe(i);if(r.length>0){const s=t?"||":"&&";return r.map(o=>$j(o,t)).join(` ${s} `)}}(e,{invalid:!0,channels:KS});if(a)return{[t]:[{test:a,value:null},...we(n)]}}return n?{[t]:n}:{}}function A5(e){const{config:t,markDef:n}=e;if(Kt("invalid",n,t)){const r=function QGe(e,{invalid:t=!1,channels:n}){const i=n.reduce((s,o)=>{const a=e.getScaleComponent(o);if(a){const l=a.get("type"),u=e.vgField(o,{expr:"datum"});u&&ho(l)&&(s[u]=!0)}return s},{}),r=oe(i);if(r.length>0){const s=t?"||":"&&";return r.map(o=>$j(o,t)).join(` ${s} `)}}(e,{channels:iu});if(r)return{defined:{signal:r}}}return{}}function lae(e,t){if(void 0!==t)return{[e]:En(t)}}const M5="voronoi",uae={defined:e=>"point"===e.type&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(M5)},marks:(e,t,n)=>{const{x:i,y:r}=t.project.hasChannel,s=e.mark;if(Zd(s))return ce(function xHe(e){return`The "nearest" transform is not supported for ${e} marks.`}(s)),n;const o={name:e.getName(M5),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},eae(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:i||!r?"datum.datum.x || 0":"0"},y:{expr:r||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let a=0,l=!1;return n.forEach((u,c)=>{var d;const f=null!==(d=u.name)&&void 0!==d?d:"";f===e.component.mark[0].name?a=c:f.indexOf(M5)>=0&&(l=!0)}),l||n.splice(a+1,0,o),n}},cae={defined:e=>"point"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind&&!a5(e.bind),parse:(e,t,n)=>bae(t,n),topLevelSignals:(e,t,n)=>{const i=t.name,r=t.project,s=t.bind,o=t.init&&t.init[0],a=uae.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return r.items.forEach((l,u)=>{var c,d;const f=Fn(`${i}_${l.field}`);n.filter(p=>p.name===f).length||n.unshift(Object.assign(Object.assign({name:f},o?{init:Zm(o[u])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${pe(l.field)}] : null`}]:[],bind:null!==(d=null!==(c=s[l.field])&&void 0!==c?c:s[l.channel])&&void 0!==d?d:s}))}),n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.filter(u=>u.name===i+lf)[0],o=i+m1,a=r.items.map(u=>Fn(`${i}_${u.field}`)),l=a.map(u=>`${u} !== null`).join(" && ");return a.length&&(s.update=`${l} ? {fields: ${o}, values: [${a.join(", ")}]} : null`),delete s.value,delete s.on,n}},kx="_toggle",dae={defined:e=>"point"===e.type&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+kx,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+lf,i=t.name+kx;return`${i} ? null : ${n}, `+("global"===t.resolve?`${i} ? null : true, `:`${i} ? null : {unit: ${n0(e)}}, `)+`${i} ? ${n} : null`}},ZGe={defined:e=>void 0!==e.clear&&!1!==e.clear,parse:(e,t)=>{t.clear&&(t.clear=be(t.clear)?Bd(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(cae.defined(t))for(const i of t.project.items){const r=n.findIndex(s=>s.name===Fn(`${t.name}_${i.field}`));-1!==r&&n[r].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function i(r,s){-1!==r&&n[r].on&&n[r].on.push({events:t.clear,update:s})}if("interval"===t.type)for(const r of t.project.items){const s=n.findIndex(o=>o.name===r.signals.visual);i(s,"[0, 0]"),-1===s&&i(n.findIndex(a=>a.name===r.signals.data),"null")}else{let r=n.findIndex(s=>s.name===t.name+lf);i(r,"null"),dae.defined(t)&&(r=n.findIndex(s=>s.name===t.name+kx),i(r,"false"))}return n}},fae={defined:e=>{const t="global"===e.resolve&&e.bind&&a5(e.bind),n=1===e.project.items.length&&e.project.items[0].field!==p1;return t&&!n&&ce("Legend bindings are only supported for selections over an individual field or encoding channel."),t&&n},parse:(e,t,n)=>{var i;const r=it(n);if(r.select=be(r.select)?{type:r.select,toggle:t.toggle}:Object.assign(Object.assign({},r.select),{toggle:t.toggle}),bae(t,r),Se(n.select)&&(n.select.on||n.select.clear)){const a='event.item && indexof(event.item.mark.role, "legend") < 0';for(const l of t.events)l.filter=we(null!==(i=l.filter)&&void 0!==i?i:[]),l.filter.includes(a)||l.filter.push(a)}const s=l5(t.bind)?t.bind.legend:"click",o=be(s)?Bd(s,"view"):we(s);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const i=t.name,r=l5(t.bind)&&t.bind.legend,s=o=>a=>{const l=it(a);return l.markname=o,l};for(const o of t.project.items){if(!o.hasLegend)continue;const a=`${Fn(o.field)}_legend`,l=`${i}_${a}`;if(0===n.filter(c=>c.name===l).length){const c=r.merge.map(s(`${a}_symbols`)).concat(r.merge.map(s(`${a}_labels`))).concat(r.merge.map(s(`${a}_entries`)));n.unshift(Object.assign(Object.assign({name:l},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:`!event.item || !datum ? null : ${l}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.find(f=>f.name===i+lf),o=i+m1,a=r.items.filter(f=>f.hasLegend).map(f=>Fn(`${i}_${Fn(f.field)}_legend`)),u=`${a.map(f=>`${f} !== null`).join(" && ")} ? {fields: ${o}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?s.on.push({events:a.map(f=>({signal:f})),update:u}):a.length>0&&(s.update=u,delete s.value,delete s.on);const c=n.find(f=>f.name===i+kx),d=l5(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:d})):c.on[0].events=d),n}},hae="_translate_anchor",pae="_translate_delta",nWe={defined:e=>"interval"===e.type&&e.translate,signals:(e,t,n)=>{const i=t.name,r=sf.defined(t),s=i+hae,{x:o,y:a}=t.project.hasChannel;let l=Bd(t.translate,"scope");return r||(l=l.map(u=>(u.between[0].markname=i+e0,u))),n.push({name:s,value:{},on:[{events:l.map(u=>u.between[0]),update:"{x: x(unit), y: y(unit)"+(void 0!==o?`, extent_x: ${r?D5(e,Bn):`slice(${o.signals.visual})`}`:"")+(void 0!==a?`, extent_y: ${r?D5(e,Ui):`slice(${a.signals.visual})`}`:"")+"}"}]},{name:i+pae,value:{},on:[{events:l,update:`{x: ${s}.x - x(unit), y: ${s}.y - y(unit)}`}]}),void 0!==o&&gae(e,t,o,"width",n),void 0!==a&&gae(e,t,a,"height",n),n}};function gae(e,t,n,i,r){var s,o;const a=t.name,l=a+hae,u=a+pae,c=n.channel,d=sf.defined(t),f=r.filter(w=>w.name===n.signals[d?"data":"visual"])[0],h=e.getSizeSignalRef(i).signal,p=e.getScaleComponent(c),g=p.get("type"),m=p.get("reverse"),y=`${l}.extent_${c}`,C=`${d?"log"===g?"panLog":"symlog"===g?"panSymlog":"pow"===g?"panPow":"panLinear":"panLinear"}(${y}, ${d?c===Bn?m?"":"-":m?"-":"":""}${u}.${c} / ${d?`${h}`:`span(${y})`}${d?"pow"===g?`, ${null!==(s=p.get("exponent"))&&void 0!==s?s:1}`:"symlog"===g?`, ${null!==(o=p.get("constant"))&&void 0!==o?o:1}`:"":""})`;f.on.push({events:{signal:u},update:d?C:`clampRange(${C}, 0, ${h})`})}const mae="_zoom_anchor",_ae="_zoom_delta",iWe={defined:e=>"interval"===e.type&&e.zoom,signals:(e,t,n)=>{const i=t.name,r=sf.defined(t),s=i+_ae,{x:o,y:a}=t.project.hasChannel,l=pe(e.scaleName(Bn)),u=pe(e.scaleName(Ui));let c=Bd(t.zoom,"scope");return r||(c=c.map(d=>(d.markname=i+e0,d))),n.push({name:i+mae,on:[{events:c,update:r?"{"+[l?`x: invert(${l}, x(unit))`:"",u?`y: invert(${u}, y(unit))`:""].filter(d=>!!d).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:s,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==o&&yae(e,t,o,"width",n),void 0!==a&&yae(e,t,a,"height",n),n}};function yae(e,t,n,i,r){var s,o;const a=t.name,l=n.channel,u=sf.defined(t),c=r.filter(b=>b.name===n.signals[u?"data":"visual"])[0],d=e.getSizeSignalRef(i).signal,f=e.getScaleComponent(l),h=f.get("type"),p=u?D5(e,l):c.name,g=a+_ae,v=`${u?"log"===h?"zoomLog":"symlog"===h?"zoomSymlog":"pow"===h?"zoomPow":"zoomLinear":"zoomLinear"}(${p}, ${a}${mae}.${l}, ${g}${u?"pow"===h?`, ${null!==(s=f.get("exponent"))&&void 0!==s?s:1}`:"symlog"===h?`, ${null!==(o=f.get("constant"))&&void 0!==o?o:1}`:"":""})`;c.on.push({events:{signal:g},update:u?v:`clampRange(${v}, 0, ${d})`})}const ep="_store",lf="_tuple",rWe="_modify",vae="vlSelectionResolve",Ix=[PGe,RGe,kGe,dae,cae,sf,fae,ZGe,nWe,iWe,uae];function n0(e,{escape:t}={escape:!0}){let n=t?pe(e.name):e.name;const i=function sWe(e){let t=e.parent;for(;t&&!nl(t);)t=t.parent;return t}(e);if(i){const{facet:r}=i;for(const s of Jo)r[s]&&(n+=` + '__facet_${s}_' + (facet[${pe(i.vgField(s))}])`)}return n}function T5(e){var t;return Ar(null!==(t=e.component.selection)&&void 0!==t?t:{}).reduce((n,i)=>n||i.project.items.some(r=>r.field===p1),!1)}function bae(e,t){(be(t.select)||!t.select.on)&&delete e.events,(be(t.select)||!t.select.clear)&&delete e.clear,(be(t.select)||!t.select.toggle)&&delete e.toggle}function O5(e){const t=[];return"Identifier"===e.type?[e.name]:"Literal"===e.type?[e.value]:("MemberExpression"===e.type&&(t.push(...O5(e.object)),t.push(...O5(e.property))),t)}function wae(e){return"MemberExpression"===e.object.type?wae(e.object):"datum"===e.object.name}function Dae(e){const t=z3(e),n=new Set;return t.visit(i=>{"MemberExpression"===i.type&&wae(i)&&n.add(O5(i).slice(1).join("."))}),n}class r0 extends on{constructor(t,n,i){super(t),this.model=n,this.filter=i,this.expr=Rx(this.model,this.filter,this),this._dependentFields=Dae(this.expr)}clone(){return new r0(null,this.model,it(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function Cae(e,t,n,i="datum"){const r=be(t)?t:t.param,s=Fn(r),o=pe(s+ep);let a;try{a=e.getSelectionComponent(s,r)}catch(c){return`!!${s}`}if(a.project.timeUnit){const c=null!=n?n:e.component.data.raw,d=a.project.timeUnit.clone();c.parent?d.insertAsParentOf(c):c.parent=d}const l=`vlSelectionTest(${o}, ${i}${"global"===a.resolve?")":`, ${pe(a.resolve)})`}`,u=`length(data(${o}))`;return!1===t.empty?`${u} && ${l}`:`!${u} || ${l}`}function Eae(e,t,n){const i=Fn(t),r=n.encoding;let o,s=n.field;try{o=e.getSelectionComponent(i,t)}catch(a){return i}if(r||s){if(r&&!s){const a=o.project.items.filter(l=>l.channel===r);!a.length||a.length>1?(s=o.project.items[0].field,ce((a.length?"Multiple ":"No ")+`matching ${pe(r)} encoding found for selection ${pe(n.param)}. Using "field": ${pe(s)}.`)):s=a[0].field}}else s=o.project.items[0].field,o.project.items.length>1&&ce(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${pe(s)}.`);return`${o.name}[${pe(Yo(s))}]`}function Rx(e,t,n){return Zv(t,i=>be(i)?i:function qUe(e){return null==e?void 0:e.param}(i)?Cae(e,i,n):use(i))}var Fx=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function N5(e,t,n,i){var r,s,o,a,l;null!==(r=e.encode)&&void 0!==r||(e.encode={}),null!==(s=(a=e.encode)[t])&&void 0!==s||(a[t]={}),null!==(o=(l=e.encode[t]).update)&&void 0!==o||(l.update={}),e.encode[t].update[n]=i}function v1(e,t,n,i={header:!1}){var r,s;const o=e.combine(),{disable:a,orient:l,scale:u,labelExpr:c,title:d,zindex:f}=o,h=Fx(o,["disable","orient","scale","labelExpr","title","zindex"]);if(!a){for(const p in h){const g=zze[p],m=h[p];if(g&&g!==t&&"both"!==g)delete h[p];else if(h1(m)){const{condition:_}=m,y=Fx(m,["condition"]),v=we(_),b=Wse[p];if(b){const{vgProp:D,part:C}=b;N5(h,C,D,[...v.map(E=>{const{test:N}=E,k=Fx(E,["test"]);return Object.assign({test:Rx(null,N)},k)}),y]),delete h[p]}else if(null===b){const D={signal:v.map(C=>{const{test:w}=C,E=Fx(C,["test"]);return`${Rx(null,w)} ? ${Ire(E)} : `}).join("")+Ire(y)};h[p]=D}}else if(Le(m)){const _=Wse[p];if(_){const{vgProp:y,part:v}=_;N5(h,v,y,m),delete h[p]}}Dt(["labelAlign","labelBaseline"],p)&&null===h[p]&&delete h[p]}if("grid"===t){if(!h.grid)return;if(h.encode){const{grid:p}=h.encode;h.encode=Object.assign({},p?{grid:p}:{}),sn(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:u,orient:l},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:pi(f,0)})}{if(!i.header&&e.mainExtracted)return;if(void 0!==c){let g=c;(null===(s=null===(r=h.encode)||void 0===r?void 0:r.labels)||void 0===s?void 0:s.update)&&Le(h.encode.labels.update.text)&&(g=Vh(c,"datum.label",h.encode.labels.update.text.signal)),N5(h,"labels","text",{signal:g})}if(null===h.labelAlign&&delete h.labelAlign,h.encode){for(const g of Yse)e.hasAxisPart(g)||delete h.encode[g];sn(h.encode)&&delete h.encode}const p=function lWe(e,t){if(e)return ie(e)&&!Jd(e)?e.map(n=>Kj(n,t)).join(", "):e}(d,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:u,orient:l,grid:!1},p?{title:p}:{}),h),!1===n.aria?{aria:!1}:{}),{zindex:pi(f,0)})}}}function Sae(e){const{axes:t}=e.component,n=[];for(const i of iu)if(t[i])for(const r of t[i])if(!r.get("disable")&&!r.get("gridScale")){const s="x"===i?"height":"width",o=e.getSizeSignalRef(s).signal;s!==o&&n.push({name:s,update:o})}return n}function xae(e,t,n,i){return Object.assign.apply(null,[{},...e.map(r=>{if("axisOrient"===r){const s="x"===n?"bottom":"left",o=t["x"===n?"axisBottom":"axisLeft"]||{},a=t["x"===n?"axisTop":"axisRight"]||{},l=new Set([...oe(o),...oe(a)]),u={};for(const c of l.values())u[c]={signal:`${i.signal} === "${s}" ? ${pc(o[c])} : ${pc(a[c])}`};return u}return t[r]})])}function dWe(e,t){var n;const i=[{}];for(const r of e){let s=null===(n=t[r])||void 0===n?void 0:n.style;if(s){s=we(s);for(const o of s)i.push(t.style[o])}}return Object.assign.apply(null,i)}function k5(e,t,n,i={}){var r;const s=Fre(e,n,t);if(void 0!==s)return{configFrom:"style",configValue:s};for(const o of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(void 0!==(null===(r=i[o])||void 0===r?void 0:r[e]))return{configFrom:o,configValue:i[o][e]};return{}}const Aae={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:i,formatType:r}=n;return Mse(e,e.type,i,r,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return Tse(i,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var i;return null!==(i=t.grid)&&void 0!==i?i:function fWe(e,t){return!zi(e)&&ge(t)&&!vn(null==t?void 0:t.bin)&&!is(null==t?void 0:t.bin)}(n,e)},gridScale:({model:e,channel:t})=>function hWe(e,t){const n="x"===t?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||Tae(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||Mae(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var i;return null!==(i=e.labelFlush)&&void 0!==i?i:function gWe(e,t){if("x"===t&&Dt(["quantitative","temporal"],e))return!0}(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var i;return null!==(i=e.labelOverlap)&&void 0!==i?i:function mWe(e,t,n,i){if(n&&!Se(i)||"nominal"!==e&&"ordinal"!==e)return"log"!==t&&"symlog"!==t||"greedy"}(t.type,n,ge(t)&&!!t.timeUnit,ge(t)?t.sort:void 0)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{var s;const o="x"===e?"width":"y"===e?"height":void 0,a=o?t.getSizeSignalRef(o):void 0;return null!==(s=n.tickCount)&&void 0!==s?s:function yWe({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){var r;if(!i&&!zi(t)&&"log"!==t){if(ge(e)){if(vn(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&Dt(["month","hours","day","quarter"],null===(r=rs(e.timeUnit))||void 0===r?void 0:r.unit))return}return{signal:`ceil(${n.signal}/40)`}}}({fieldOrDatumDef:i,scaleType:r,size:a,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(void 0!==e.title)return e.title;const i=Oae(t,n);if(void 0!==i)return i;const r=t.typedFieldDef(n),o=t.fieldDef("x"===n?"x2":"y2");return Lre(r?[Pse(r)]:[],ge(o)?[Pse(o)]:[])},values:({axis:e,fieldOrDatumDef:t})=>function vWe(e,t){const n=e.values;return ie(n)?Gse(t,n):Le(n)?n:void 0}(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var i;return null!==(i=e.zindex)&&void 0!==i?i:function bWe(e,t){return"rect"===e&&px(t)?1:0}(n,t)}};function I5(e){return`(((${e.signal} % 360) + 360) % 360)`}function Mae(e,t,n,i){if(void 0!==e){if("x"===n){if(Le(e)){const r=I5(e);return{signal:`(45 < ${r} && ${r} < 135) || (225 < ${r} && ${r} < 315) ? "middle" :(${r} <= 45 || 315 <= ${r}) === ${Le(t)?`(${t.signal} === "top")`:"top"===t} ? "bottom" : "top"`}}return 45<e&&e<135||225<e&&e<315?"middle":Le(t)?{signal:`${t.signal} ${e<=45||315<=e?"===":"!=="} "top" ? "bottom" : "top"`}:(e<=45||315<=e)==("top"===t)?"bottom":"top"}if(Le(e)){const r=I5(e);return{signal:`${r} <= 45 || 315 <= ${r} || (135 <= ${r} && ${r} <= 225) ? ${i?'"middle"':"null"} : (45 <= ${r} && ${r} <= 135) === ${Le(t)?`(${t.signal} === "left")`:"left"===t} ? "top" : "bottom"`}}return e<=45||315<=e||135<=e&&e<=225?i?"middle":null:Le(t)?{signal:`${t.signal} ${45<=e&&e<=135?"===":"!=="} "left" ? "top" : "bottom"`}:(45<=e&&e<=135)==("left"===t)?"top":"bottom"}}function Tae(e,t,n){if(void 0===e)return;const i="x"===n,r=i?0:90,s=i?"bottom":"left";if(Le(e)){const o=I5(e);return{signal:`(${r?`(${o} + 90)`:o} % 180 === 0) ? ${i?null:'"center"'} :(${r} < ${o} && ${o} < ${180+r}) === ${Le(t)?`(${t.signal} === "${s}")`:t===s} ? "left" : "right"`}}return(e+r)%180==0?i?null:"center":Le(t)?{signal:`${t.signal} ${r<e&&e<180+r?"===":"!=="} "${s}" ? "left" : "right"`}:(r<e&&e<180+r)==(t===s)?"left":"right"}function Oae(e,t){const n="x"===t?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),s=i?i.title:void 0,o=r?r.title:void 0;return s&&o?jre(s,o):s||o||(void 0!==s?s:void 0!==o?o:void 0)}class s0 extends on{constructor(t,n){super(t),this.transform=n,this._dependentFields=Dae(this.transform.calculate)}clone(){return new s0(null,it(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((i,r)=>{if(Qh(i)&&Fse(i.sort)){const{field:s,timeUnit:o}=i,a=i.sort,l=a.map((u,c)=>`${use({field:s,timeUnit:o,equal:u})} ? ${c} : `).join("")+a.length;t=new s0(t,{calculate:l,as:o0(i,r,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${wt(this.transform)}`}}function o0(e,t,n){return _e(e,Object.assign({prefix:t,suffix:"sort_index"},null!=n?n:{}))}function Px(e,t){return Dt(["top","bottom"],t)?"column":Dt(["left","right"],t)||"row"===e?"row":"column"}function a0(e,t,n,i){return pi((t||{})[e],("row"===i?n.headerRow:"column"===i?n.headerColumn:n.headerFacet)[e],n.header[e])}function Lx(e,t,n,i){const r={};for(const s of e){const o=a0(s,t||{},n,i);void 0!==o&&(r[s]=o)}return r}const R5=["row","column"],F5=["header","footer"];function wWe(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:s,titleAngle:o,titleOrient:a}=Lx(["titleAnchor","titleAngle","titleOrient"],r.header,i,t),l=Px(t,a),u=t1(o);return{name:`${t}-title`,type:"group",role:`${l}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},"row"===t?{orient:"left"}:{}),{style:"guide-title"}),kae(u,l)),Nae(l,u,s)),Iae(i,r,t,dqe,poe))}}function Nae(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const i=Tae(t,"row"===e?"left":"top","row"===e?"y":"x");return i?{align:i}:{}}function kae(e,t){const n=Mae(e,"row"===t?"left":"top","row"===t?"y":"x",!0);return n?{baseline:n}:{}}function DWe(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of F5)if(n[r])for(const s of n[r]){const o=EWe(e,t,r,n,s);null!=o&&i.push(o)}return i}function CWe(e,t){var n;const{sort:i}=e;return ou(i)?{field:_e(i,{expr:"datum"}),order:null!==(n=i.order)&&void 0!==n?n:"ascending"}:ie(i)?{field:o0(e,t,{expr:"datum"}),order:"ascending"}:{field:_e(e,{expr:"datum"}),order:null!=i?i:"ascending"}}function P5(e,t,n){const{format:i,formatType:r,labelAngle:s,labelAnchor:o,labelOrient:a,labelExpr:l}=Lx(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),u=Hj({fieldOrDatumDef:e,format:i,formatType:r,expr:"parent",config:n}).signal,c=Px(t,a);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:l?Vh(Vh(l,"datum.label",u),"datum.value",_e(e,{expr:"parent"})):u}},"row"===t?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),kae(s,c)),Nae(c,s,o)),Iae(n,e,t,fqe,goe))}function EWe(e,t,n,i,r){if(r){let s=null;const{facetFieldDef:o}=i,a=e.config?e.config:void 0;if(o&&r.labels){const{labelOrient:d}=Lx(["labelOrient"],o.header,a,t);("row"===t&&!Dt(["top","bottom"],d)||"column"===t&&!Dt(["left","right"],d))&&(s=P5(o,t,a))}const l=nl(e)&&!c1(e.facet),u=r.axes,c=(null==u?void 0:u.length)>0;if(s||c){const d="row"===t?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},i.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:CWe(o,t)}:{}),c&&l?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),s?{title:s}:{}),r.sizeSignal?{encode:{update:{[d]:r.sizeSignal}}}:{}),c?{axes:u}:{})}}return null}const SWe={column:{start:0,end:1},row:{start:1,end:0}};function xWe(e,t){return SWe[t][e]}function Iae(e,t,n,i,r){const s={};for(const o of i){if(!r[o])continue;const a=a0(o,null==t?void 0:t.header,e,n);void 0!==a&&(s[r[o]]=a)}return s}function L5(e){return[...jx(e,"width"),...jx(e,"height"),...jx(e,"childWidth"),...jx(e,"childHeight")]}function jx(e,t){const n="width"===t?"x":"y",i=e.component.layoutSize.get(t);if(!i||"merged"===i)return[];const r=e.getSizeSignalRef(t).signal;if("step"===i){const s=e.getScaleComponent(n);if(s){const o=s.get("type"),a=s.get("range");if(zi(o)&&Xd(a)){const l=e.scaleName(n);return nl(e.parent)&&"independent"===e.parent.component.resolve.scale[n]?[Rae(l,a)]:[Rae(l,a),{name:r,update:Fae(l,s,`domain('${l}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==i){const s=r.endsWith("width"),o=s?"containerSize()[0]":"containerSize()[1]",l=`isFinite(${o}) ? ${o} : ${f5(e.config.view,s?"width":"height")}`;return[{name:r,init:l,on:[{update:l,events:"window:resize"}]}]}return[{name:r,value:i}]}function Rae(e,t){const n=`${e}_step`;return Le(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function Fae(e,t,n){const i=t.get("type"),r=t.get("padding"),s=pi(t.get("paddingOuter"),r);let o=t.get("paddingInner");return o="band"===i?void 0!==o?o:r:1,`bandspace(${n}, ${pc(o)}, ${pc(s)}) * ${e}_step`}function Pae(e){return"childWidth"===e?"width":"childHeight"===e?"height":e}function Lae(e,t){return oe(e).reduce((n,i)=>{const r=e[i];return Object.assign(Object.assign({},n),t0(t,r,i,s=>En(s.value)))},{})}function jae(e,t){if(nl(t))return"theta"===e?"independent":"shared";if(c0(t))return"shared";if(Z5(t))return nr(e)||"theta"===e||"radius"===e?"independent":"shared";throw new Error("invalid model type for resolve")}function j5(e,t){const n=e.scale[t],i=nr(t)?"axis":"legend";return"independent"===n?("shared"===e[i][t]&&ce(function hUe(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}(t)),"independent"):e[i][t]||"shared"}const MWe=Object.assign(Object.assign({},yoe),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),Bae=oe(MWe);class TWe extends _c{}const $ae={symbols:function OWe(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r,legendType:s}){var o,a,l,u,c,d,f,h;if("symbol"!==s)return;const{markDef:p,encoding:g,config:m,mark:_}=n,y=p.filled&&"trail"!==_;let v=Object.assign(Object.assign({},function CHe(e,t,n){for(const i of n){const r=Gh(i,t.markDef,t.config);void 0!==r&&(e[i]=En(r))}return e}({},n,gze)),iae(n,{filled:y}));const b=null!==(o=r.get("symbolOpacity"))&&void 0!==o?o:m.legend.symbolOpacity,D=null!==(a=r.get("symbolFillColor"))&&void 0!==a?a:m.legend.symbolFillColor,C=null!==(l=r.get("symbolStrokeColor"))&&void 0!==l?l:m.legend.symbolStrokeColor,w=void 0===b?null!==(u=Vae(g.opacity))&&void 0!==u?u:p.opacity:void 0;if(v.fill)if("fill"===i||y&&i===xs)delete v.fill;else if(v.fill.field)D?delete v.fill:(v.fill=En(null!==(c=m.legend.symbolBaseFillColor)&&void 0!==c?c:"black"),v.fillOpacity=En(null!=w?w:1));else if(ie(v.fill)){const E=null!==(h=null!==(f=B5(null!==(d=g.fill)&&void 0!==d?d:g.color))&&void 0!==f?f:p.fill)&&void 0!==h?h:y&&p.color;E&&(v.fill=En(E))}if(v.stroke)if("stroke"===i||!y&&i===xs)delete v.stroke;else if(v.stroke.field||C)delete v.stroke;else if(ie(v.stroke)){const E=pi(B5(g.stroke||g.color),p.stroke,y?p.color:void 0);E&&(v.stroke={value:E})}if(i!==cc){const E=ge(t)&&Uae(0,r,t);E?v.opacity=[Object.assign({test:E},En(null!=w?w:1)),En(m.legend.unselectedOpacity)]:w&&(v.opacity=En(w))}return v=Object.assign(Object.assign({},v),e),sn(v)?void 0:v},gradient:function NWe(e,{model:t,legendType:n,legendCmpt:i}){var r;if("gradient"!==n)return;const{config:s,markDef:o,encoding:a}=t;let l={};const c=void 0===(null!==(r=i.get("gradientOpacity"))&&void 0!==r?r:s.legend.gradientOpacity)?Vae(a.opacity)||o.opacity:void 0;return c&&(l.opacity=En(c)),l=Object.assign(Object.assign({},l),e),sn(l)?void 0:l},labels:function kWe(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){const s=n.legend(i)||{},o=n.config,a=ge(t)?Uae(0,r,t):void 0,l=a?[{test:a,value:1},{value:o.legend.unselectedOpacity}]:void 0,{format:u,formatType:c}=s,d=Xh(c)?Uj({fieldOrDatumDef:t,field:"datum.value",format:u,formatType:c,config:o}):void 0,f=Object.assign(Object.assign(Object.assign({},l?{opacity:l}:{}),d?{text:d}:{}),e);return sn(f)?void 0:f},entries:function IWe(e,{legendCmpt:t}){const n=t.get("selections");return(null==n?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}};function Vae(e){return Hae(e,(t,n)=>Math.max(t,n.value))}function B5(e){return Hae(e,(t,n)=>pi(t,n.value))}function Hae(e,t){return function kze(e){const t=e&&e.condition;return!!t&&(ie(t)||Za(t))}(e)?we(e.condition).reduce(t,e.value):Za(e)?e.value:void 0}function Uae(e,t,n){const i=t.get("selections");if(!(null==i?void 0:i.length))return;const r=pe(n.field);return i.map(s=>`(!length(data(${pe(Fn(s)+ep)})) || (${s}[${r}] && indexof(${s}[${r}], datum.value) >= 0))`).join(" || ")}const zae={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:i,formatType:r}=t;return Mse(e,e.type,i,r,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return Tse(i,t,n)},gradientLength:e=>{var t,n;const{legend:i,legendConfig:r}=e;return null!==(n=null!==(t=i.gradientLength)&&void 0!==t?t:r.gradientLength)&&void 0!==n?n:function $We({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){const{gradientHorizontalMaxLength:s,gradientHorizontalMinLength:o,gradientVerticalMaxLength:a,gradientVerticalMinLength:l}=e;if(Xa(r))return"horizontal"===n?"top"===i||"bottom"===i?qae(t,"width",o,s):o:qae(t,"height",l,a)}(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var i,r;return null!==(r=null!==(i=e.labelOverlap)&&void 0!==i?i:t.labelOverlap)&&void 0!==r?r:function VWe(e){if(Dt(["quantile","threshold","log","symlog"],e))return"greedy"}(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>{var r;return null!==(r=e.symbolType)&&void 0!==r?r:function FWe(e,t,n,i){var r;if("shape"!==t){const s=null!==(r=B5(n))&&void 0!==r?r:i;if(s)return s}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(t.type,n,i.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>Ym(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(Hm(n)&&Xa(t)){if("gradient"===e)return}else if("symbol"===e)return;return e},values:({fieldOrDatumDef:e,legend:t})=>function RWe(e,t){const n=e.values;return ie(n)?Gse(t,n):Le(n)?n:void 0}(t,e)};function qae(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`}}function Gae(e){const t=gi(e)?function HWe(e){const{encoding:t}=e,n={};for(const i of[xs,..._oe]){const r=Mi(t[i]);!r||!e.getScaleComponent(i)||i===As&&ge(r)&&r.type===qm||(n[i]=qWe(e,i))}return n}(e):function GWe(e){const{legends:t,resolve:n}=e.component;for(const i of e.children){Gae(i);for(const r of oe(i.component.legends))n.legend[r]=j5(e.component.resolve,r),"shared"===n.legend[r]&&(t[r]=Wae(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]))}for(const i of oe(t))for(const r of e.children)!r.component.legends[i]||"shared"===n.legend[i]&&delete r.component.legends[i];return t}(e);return e.component.legends=t,t}function zWe(e,t,n,i){switch(t){case"disable":return void 0!==n;case"values":return!!(null==n?void 0:n.values);case"title":if("title"===t&&e===(null==i?void 0:i.title))return!0}return e===(n||{})[t]}function qWe(e,t){var n,i,r;let s=e.legend(t);const{markDef:o,encoding:a,config:l}=e,u=l.legend,c=new TWe({},function UWe(e,t){const n=e.scaleName(t);if("trail"===e.mark){if("color"===t)return{stroke:n};if("size"===t)return{strokeWidth:n}}return"color"===t?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}(e,t));!function tWe(e,t,n){var i,r,s,o;const a=null===(i=e.fieldDef(t))||void 0===i?void 0:i.field;for(const l of Ar(null!==(r=e.component.selection)&&void 0!==r?r:{})){const u=null!==(s=l.project.hasField[a])&&void 0!==s?s:l.project.hasChannel[t];if(u&&fae.defined(l)){const c=null!==(o=n.get("selections"))&&void 0!==o?o:[];c.push(l.name),n.set("selections",c,!1),u.hasLegend=!0}}}(e,t,c);const d=void 0!==s?!s:u.disable;if(c.set("disable",d,void 0!==s),d)return c;s=s||{};const f=e.getScaleComponent(t).get("type"),h=Mi(a[t]),p=ge(h)?null===(n=rs(h.timeUnit))||void 0===n?void 0:n.unit:void 0,g=s.orient||l.legend.orient||"right",m=function PWe(e){const{legend:t}=e;return pi(t.type,function LWe({channel:e,timeUnit:t,scaleType:n}){if(Hm(e)){if(Dt(["quarter","month","day"],t))return"symbol";if(Xa(n))return"gradient"}return"symbol"}(e))}({legend:s,channel:t,timeUnit:p,scaleType:f}),_=function jWe({legendConfig:e,legendType:t,orient:n,legend:i}){var r,s;return null!==(s=null!==(r=i.direction)&&void 0!==r?r:e[t?"gradientDirection":"symbolDirection"])&&void 0!==s?s:function BWe(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===t?"horizontal":void 0}}(n,t)}({legend:s,legendType:m,orient:g,legendConfig:u}),y={legend:s,channel:t,model:e,markDef:o,encoding:a,fieldOrDatumDef:h,legendConfig:u,config:l,scaleType:f,orient:g,legendType:m,direction:_};for(const w of Bae){if("gradient"===m&&w.startsWith("symbol")||"symbol"===m&&w.startsWith("gradient"))continue;const E=w in zae?zae[w](y):s[w];if(void 0!==E){const N=zWe(E,w,s,e.fieldDef(t));(N||void 0===l.legend[w])&&c.set(w,E,N)}}const v=null!==(i=null==s?void 0:s.encoding)&&void 0!==i?i:{},b=c.get("selections"),D={},C={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:c,legendType:m};for(const w of["labels","legend","title","symbols","gradient","entries"]){const E=Lae(null!==(r=v[w])&&void 0!==r?r:{},e),N=w in $ae?$ae[w](E,C):E;void 0!==N&&!sn(N)&&(D[w]=Object.assign(Object.assign(Object.assign({},(null==b?void 0:b.length)&&ge(h)?{name:`${Fn(h.field)}_legend_${w}`}:{}),(null==b?void 0:b.length)?{interactive:!!b}:{}),{update:N}))}return sn(D)||c.set("encode",D,!!(null==s?void 0:s.encoding)),c}function Wae(e,t){var n,i,r,s;if(!e)return t.clone();const o=e.getWithExplicit("orient"),a=t.getWithExplicit("orient");if(o.explicit&&a.explicit&&o.value!==a.value)return;let l=!1;for(const u of Bae){const c=nf(e.getWithExplicit(u),t.getWithExplicit(u),u,"legend",(d,f)=>{switch(u){case"symbolType":return WWe(d,f);case"title":return Bre(d,f);case"type":return l=!0,po("symbol")}return Mx(d,f,u,"legend")});e.setWithExplicit(u,c)}return l&&((null===(i=null===(n=e.implicit)||void 0===n?void 0:n.encode)||void 0===i?void 0:i.gradient)&&jS(e.implicit,["encode","gradient"]),(null===(s=null===(r=e.explicit)||void 0===r?void 0:r.encode)||void 0===s?void 0:s.gradient)&&jS(e.explicit,["encode","gradient"])),e}function WWe(e,t){return"circle"===t.value?t:e}function Yae(e){const t=e.component.legends,n={};for(const r of oe(t)){const s=e.getScaleComponent(r),o=yn(s.get("domains"));if(n[o])for(const a of n[o])Wae(a,t[r])||n[o].push(t[r]);else n[o]=[t[r].clone()]}return Ar(n).flat().map(r=>function JWe(e,t){var n,i,r;const s=e.combine(),{disable:o,labelExpr:a}=s,u=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(s,["disable","labelExpr","selections"]);if(!o){if(!1===t.aria&&null==u.aria&&(u.aria=!1),null===(n=u.encode)||void 0===n?void 0:n.symbols){const c=u.encode.symbols.update;c.fill&&"transparent"!==c.fill.value&&!c.stroke&&!u.stroke&&(c.stroke={value:"transparent"});for(const d of _oe)u[d]&&delete c[d]}if(u.title||delete u.title,void 0!==a){let c=a;(null===(r=null===(i=u.encode)||void 0===i?void 0:i.labels)||void 0===r?void 0:r.update)&&Le(u.encode.labels.update.text)&&(c=Vh(a,"datum.label",u.encode.labels.update.text.signal)),function KWe(e,t,n,i){var r,s,o,a,l;null!==(r=e.encode)&&void 0!==r||(e.encode={}),null!==(s=(a=e.encode)[t])&&void 0!==s||(a[t]={}),null!==(o=(l=e.encode[t]).update)&&void 0!==o||(l.update={}),e.encode[t].update[n]=i}(u,"labels","text",{signal:c})}return u}}(r,e.config)).filter(r=>void 0!==r)}function Kae(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:i}=n;if(t.data){const r={signal:`[${t.size.map(o=>o.signal).join(", ")}]`},s=t.data.reduce((o,a)=>{const l=Le(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return Dt(o,l)||o.push(l),o},[]);if(s.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:i,size:r,fit:{signal:s.length>1?`[${s.join(", ")}]`:s[0]}},n)]}return[Object.assign(Object.assign({name:i},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const ZWe=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class Jae extends _c{constructor(t,n,i,r){super(Object.assign({},n),{name:t}),this.specifiedProjection=n,this.size=i,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function Xae(e){e.component.projection=gi(e)?function eYe(e){var t;if(e.hasProjection){const n=Ts(e.specifiedProjection),i=!(n&&(null!=n.scale||null!=n.translate)),r=i?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,s=i?function tYe(e){const t=[],{encoding:n}=e;for(const i of[[eu,Zl],[Ko,Ja]])(Mi(n[i[0]])||Mi(n[i[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(As)&&e.typedFieldDef(As).type===qm&&t.push({signal:e.getName(`geojson_${t.length}`)}),0===t.length&&t.push(e.requestDataName(gn.Main)),t}(e):void 0,o=new Jae(e.projectionName(!0),Object.assign(Object.assign({},null!==(t=Ts(e.config.projection))&&void 0!==t?t:{}),null!=n?n:{}),r,s);return o.get("type")||o.set("type","equalEarth",!1),o}}(e):function iYe(e){if(0===e.children.length)return;let t;for(const i of e.children)Xae(i);const n=ej(e.children,i=>{const r=i.component.projection;if(r){if(t){const s=function nYe(e,t){const n=ej(ZWe,r=>!!(!Fe(e.explicit,r)&&!Fe(t.explicit,r)||Fe(e.explicit,r)&&Fe(t.explicit,r)&&Kl(e.get(r),t.get(r))));if(Kl(e.size,t.size)){if(n)return e;if(Kl(e.explicit,{}))return t;if(Kl(t.explicit,{}))return e}return null}(t,r);return s&&(t=s),!!s}return t=r,!0}return!0});if(t&&n){const i=e.projectionName(!0),r=new Jae(i,t.specifiedProjection,t.size,it(t.data));for(const s of e.children){const o=s.component.projection;o&&(o.isFit&&r.data.push(...s.component.projection.data),s.renameProjection(o.get("name"),i),o.merged=!0)}return r}}(e)}function Qae(e,t){return`${Mre(e)}_${t}`}function $5(e,t,n){var i;const s=Qae(null!==(i=_x(n,void 0))&&void 0!==i?i:{},t);return e.getName(`${s}_bins`)}function Zae(e,t,n){let i,r;i=function aYe(e){return"as"in e}(e)?be(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:[_e(e,{forAs:!0}),_e(e,{binSuffix:"end",forAs:!0})];const s=Object.assign({},_x(t,void 0)),o=Qae(s,e.field),{signal:a,extentSignal:l}=function oYe(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}(n,o);if(JS(s.extent)){const c=s.extent;r=Eae(n,c.param,c),delete s.extent}return{key:o,binComponent:Object.assign(Object.assign(Object.assign({bin:s,field:e.field,as:[i]},a?{signal:a}:{}),l?{extentSignal:l}:{}),r?{span:r}:{})}}class hu extends on{constructor(t,n){super(t),this.bins=n}clone(){return new hu(null,it(this.bins))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s,o)=>{if(Xo(s)&&vn(s.bin)){const{key:a,binComponent:l}=Zae(s,s.bin,n);r[a]=Object.assign(Object.assign(Object.assign({},l),r[a]),function sYe(e,t,n,i){var r,s;if(f1(t,n)){const o=gi(e)&&null!==(s=null!==(r=e.axis(n))&&void 0!==r?r:e.legend(n))&&void 0!==s?s:{},a=_e(t,{expr:"datum"}),l=_e(t,{expr:"datum",binSuffix:"end"});return{formulaAs:_e(t,{binSuffix:"range",forAs:!0}),formula:ax(a,l,o.format,o.formatType,i)}}return{}}(n,s,o,n.config))}return r},{});return sn(i)?null:new hu(t,i)}static makeFromTransform(t,n,i){const{key:r,binComponent:s}=Zae(n,n.bin,i);return new hu(t,{[r]:s})}merge(t,n){for(const i of oe(t.bins))i in this.bins?(n(t.bins[i].signal,this.bins[i].signal),this.bins[i].as=Jl([...this.bins[i].as,...t.bins[i].as],wt)):this.bins[i]=t.bins[i];for(const i of t.children)t.removeChild(i),i.parent=this;t.remove()}producedFields(){return new Set(Ar(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(Ar(this.bins).map(t=>t.field))}hash(){return`Bin ${wt(this.bins)}`}assemble(){return Ar(this.bins).flatMap(t=>{const n=[],[i,...r]=t.as,s=t.bin,{extent:o}=s,a=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(s,["extent"]),l=Object.assign(Object.assign(Object.assign({type:"bin",field:Yo(t.field),as:i,signal:t.signal},JS(o)?{extent:null}:{extent:o}),t.span?{span:{signal:`span(${t.span})`}}:{}),a);!o&&t.extentSignal&&(n.push({type:"extent",field:Yo(t.field),signal:t.extentSignal}),l.extent={signal:t.extentSignal}),n.push(l);for(const u of r)for(let c=0;c<2;c++)n.push({type:"formula",expr:_e({field:i[c]},{expr:"datum"}),as:u[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}class el extends on{constructor(t,n,i){super(t),this.dimensions=n,this.measures=i}clone(){return new el(null,new Set(this.dimensions),it(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let i=!1;n.forEachFieldDef(o=>{o.aggregate&&(i=!0)});const r={},s=new Set;return i&&(n.forEachFieldDef((o,a)=>{var l,u,c,d;const{aggregate:f,field:h}=o;if(f)if("count"===f)null!==(l=r["*"])&&void 0!==l||(r["*"]={}),r["*"].count=new Set([_e(o,{forAs:!0})]);else{if(fc(f)||Kd(f)){const p=fc(f)?"argmin":"argmax",g=f[p];null!==(u=r[g])&&void 0!==u||(r[g]={}),r[g][p]=new Set([_e({op:p,field:g},{forAs:!0})])}else null!==(c=r[h])&&void 0!==c||(r[h]={}),r[h][f]=new Set([_e(o,{forAs:!0})]);Yd(a)&&"unaggregated"===n.scaleDomain(a)&&(null!==(d=r[h])&&void 0!==d||(r[h]={}),r[h].min=new Set([_e({field:h,aggregate:"min"},{forAs:!0})]),r[h].max=new Set([_e({field:h,aggregate:"max"},{forAs:!0})]))}else!function lYe(e,t,n,i){var r;const s=gi(i)?i.encoding[dc(t)]:void 0;if(Xo(n)&&gi(i)&&Bse(n,s,i.markDef,i.config))e.add(_e(n,{})),e.add(_e(n,{suffix:"end"})),n.bin&&f1(n,t)&&e.add(_e(n,{binSuffix:"range"}));else if(function J9e(e){return e in oj}(t)){const o=function K9e(e){switch(e){case Zl:return"y";case Ja:return"y2";case eu:return"x";case Ko:return"x2"}}(t);e.add(i.getName(o))}else e.add(_e(n));return Qh(n)&&function sze(e){return Se(e)&&"field"in e}(null===(r=n.scale)||void 0===r?void 0:r.range)&&e.add(n.scale.range.field),e}(s,a,o,n)}),s.size+oe(r).length!==0)?new el(t,s,r):null}static makeFromTransform(t,n){var i,r,s;const o=new Set,a={};for(const l of n.aggregate){const{op:u,field:c,as:d}=l;u&&("count"===u?(null!==(i=a["*"])&&void 0!==i||(a["*"]={}),a["*"].count=new Set([d||_e(l,{forAs:!0})])):(null!==(r=a[c])&&void 0!==r||(a[c]={}),a[c][u]=new Set([d||_e(l,{forAs:!0})])))}for(const l of null!==(s=n.groupby)&&void 0!==s?s:[])o.add(l);return o.size+oe(a).length===0?null:new el(t,o,a)}merge(t){return dre(this.dimensions,t.dimensions)?(function uYe(e,t){var n;for(const i of oe(t)){const r=t[i];for(const s of oe(r))i in e?e[i][s]=new Set([...null!==(n=e[i][s])&&void 0!==n?n:[],...r[s]]):e[i]={[s]:r[s]}}}(this.measures,t.measures),!0):(function OUe(...e){ru.debug(...e)}("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...oe(this.measures)])}producedFields(){const t=new Set;for(const n of oe(this.measures))for(const i of oe(this.measures[n])){const r=this.measures[n][i];0===r.size?t.add(`${i}_${n}`):r.forEach(t.add,t)}return t}hash(){return`Aggregate ${wt({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],i=[];for(const s of oe(this.measures))for(const o of oe(this.measures[s]))for(const a of this.measures[s][o])i.push(a),t.push(o),n.push("*"===s?null:Yo(s));return{type:"aggregate",groupby:[...this.dimensions].map(Yo),ops:t,fields:n,as:i}}}class l0 extends on{constructor(t,n,i,r){super(t),this.model=n,this.name=i,this.data=r;for(const s of Jo){const o=n.facet[s];if(o){const{bin:a,sort:l}=o;this[s]=Object.assign({name:n.getName(`${s}_domain`),fields:[_e(o),...vn(a)?[_e(o,{binSuffix:"end"})]:[]]},ou(l)?{sortField:l}:ie(l)?{sortIndexField:o0(o,s)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of Jo)this[n]&&(t+=` ${n.charAt(0)}:${wt(this[n])}`);return t}get fields(){var t;const n=[];for(const i of Jo)(null===(t=this[i])||void 0===t?void 0:t.fields)&&n.push(...this[i].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of Jo)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of iu){const i=this.childModel.component.scales[n];if(i&&!i.merged){const r=i.get("type"),s=i.get("range");if(zi(r)&&Xd(s)){const a=J5($x(this.childModel,n));a?t[n]=a:ce(_j(n))}}}return t}assembleRowColumnHeaderData(t,n,i){const r={row:"y",column:"x",facet:void 0}[t],s=[],o=[],a=[];r&&i&&i[r]&&(n?(s.push(`distinct_${i[r]}`),o.push("max")):(s.push(i[r]),o.push("distinct")),a.push(`distinct_${i[r]}`));const{sortField:l,sortIndexField:u}=this[t];if(l){const{op:c=lx,field:d}=l;s.push(d),o.push(c),a.push(_e(l,{forAs:!0}))}else u&&(s.push(u),o.push("max"),a.push(u));return{name:this[t].name,source:null!=n?n:this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},s.length?{fields:s,ops:o,as:a}:{})]}}assembleFacetHeaderData(t){var n,i;const{columns:r}=this.model.layout,{layoutHeaders:s}=this.model.component,o=[],a={};for(const c of R5){for(const d of F5){const f=null!==(n=s[c]&&s[c][d])&&void 0!==n?n:[];for(const h of f)if((null===(i=h.axes)||void 0===i?void 0:i.length)>0){a[c]=!0;break}}if(a[c]){const d=`length(data("${this.facet.name}"))`;o.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:"row"===c?r?{signal:`ceil(${d} / ${r})`}:1:r?{signal:`min(${d}, ${r})`}:{signal:d}}]})}}const{row:l,column:u}=a;return(l||u)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,t)),o}assemble(){var t,n;const i=[];let r=null;const s=this.getChildIndependentFieldsWithStep(),{column:o,row:a,facet:l}=this;if(o&&a&&(s.x||s.y)){r=`cross_${this.column.name}_${this.row.name}`;const u=[].concat(null!==(t=s.x)&&void 0!==t?t:[],null!==(n=s.y)&&void 0!==n?n:[]),c=u.map(()=>"distinct");i.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:u,ops:c}]})}for(const u of[oc,sc])this[u]&&i.push(this.assembleRowColumnHeaderData(u,r,s));if(l){const u=this.assembleFacetHeaderData(s);u&&i.push(...u)}return i}}function ele(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function dYe(e){const t={};return LS(e.filter,n=>{var i;if(lse(n)){let r=null;Ej(n)?r=fo(n.equal):xj(n)?r=fo(n.lte):Sj(n)?r=fo(n.lt):Aj(n)?r=fo(n.gt):Mj(n)?r=fo(n.gte):Tj(n)?r=n.range[0]:Oj(n)&&(r=(null!==(i=n.oneOf)&&void 0!==i?i:n.in)[0]),r&&(Wh(r)?t[n.field]="date":nn(r)?t[n.field]="number":be(r)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}class Or extends on{constructor(t,n){super(t),this._parse=n}clone(){return new Or(null,it(this._parse))}hash(){return`Parse ${wt(this._parse)}`}static makeExplicit(t,n,i){var r;let s={};const o=n.data;return!rf(o)&&(null===(r=null==o?void 0:o.format)||void 0===r?void 0:r.parse)&&(s=o.format.parse),this.makeWithAncestors(t,s,{},i)}static makeWithAncestors(t,n,i,r){for(const a of oe(i)){const l=r.getWithExplicit(a);void 0!==l.value&&(l.explicit||l.value===i[a]||"derived"===l.value||"flatten"===i[a]?delete i[a]:ce(Gre(a,i[a],l.value)))}for(const a of oe(n)){const l=r.get(a);void 0!==l&&(l===n[a]?delete n[a]:ce(Gre(a,n[a],l)))}const s=new _c(n,i);r.copyAll(s);const o={};for(const a of oe(s.combine())){const l=s.get(a);null!==l&&(o[a]=l)}return 0===oe(o).length||r.parseNothing?null:new Or(t,o)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of oe(this._parse)){const i=this._parse[n];1===$m(n)&&(t[n]=i)}return t}producedFields(){return new Set(oe(this._parse))}dependentFields(){return new Set(oe(this._parse))}assembleTransforms(t=!1){return oe(this._parse).filter(n=>!t||$m(n)>1).map(n=>{const i=function cYe(e,t){const n=rj(e);return"number"===t?`toNumber(${n})`:"boolean"===t?`toBoolean(${n})`:"string"===t?`toString(${n})`:"date"===t?`toDate(${n})`:"flatten"===t?n:t.startsWith("date:")?`timeParse(${n},'${ele(t.slice(5,t.length))}')`:t.startsWith("utc:")?`utcParse(${n},'${ele(t.slice(4,t.length))}')`:(ce(function PHe(e){return`Unrecognized parse "${e}".`}(t)),null)}(n,this._parse[n]);return i?{type:"formula",expr:i,as:sj(n)}:null}).filter(n=>null!==n)}}class uf extends on{clone(){return new uf(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([p1])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:p1}}}class b1 extends on{constructor(t,n){super(t),this.params=n}clone(){return new b1(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${wt(this.params)}`}assemble(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}class w1 extends on{constructor(t,n){super(t),this.params=n}clone(){return new w1(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([null!==(t=this.params.as)&&void 0!==t?t:"data"])}hash(){return`Hash ${wt(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}class tp extends on{constructor(t){let n;if(super(null),null!=t||(t={name:"source"}),rf(t)||(n=t.format?Object.assign({},co(t.format,["parse"])):{}),g1(t))this._data={values:t.values};else if(Qm(t)){if(this._data={url:t.url},!n.type){let i=/(?:\.([^.]+))?$/.exec(t.url)[1];Dt(["json","csv","tsv","dsv","topojson"],i)||(i="json"),n.type=i}}else Joe(t)?this._data={values:[{type:"Sphere"}]}:(Yoe(t)||rf(t))&&(this._data={});this._generator=rf(t),t.name&&(this._name=t.name),n&&!sn(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}var D1,tle=function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n};function V5(e){return e instanceof tp||e instanceof b1||e instanceof w1}class H5{constructor(){D1.set(this,void 0),tle(this,D1,!1,"f")}setModified(){tle(this,D1,!0,"f")}get modifiedFlag(){return function(e,t,n,i){if("function"==typeof t||!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}(this,D1)}}D1=new WeakMap;class np extends H5{getNodeDepths(t,n,i){i.set(t,n);for(const r of t.children)this.getNodeDepths(r,n+1,i);return i}optimize(t){const i=[...this.getNodeDepths(t,0,new Map).entries()].sort((r,s)=>s[1]-r[1]);for(const r of i)this.run(r[0]);return this.modifiedFlag}}class U5 extends H5{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class gYe extends U5{mergeNodes(t,n){const i=n.shift();for(const r of n)t.removeChild(r),r.parent=i,r.remove()}run(t){const n=t.children.map(r=>r.hash()),i={};for(let r=0;r<n.length;r++)void 0===i[n[r]]?i[n[r]]=[t.children[r]]:i[n[r]].push(t.children[r]);for(const r of oe(i))i[r].length>1&&(this.setModified(),this.mergeNodes(t,i[r]))}}class mYe extends U5{constructor(t){super(),this.requiresSelectionId=t&&T5(t)}run(t){t instanceof uf&&(this.requiresSelectionId&&(V5(t.parent)||t.parent instanceof el||t.parent instanceof Or)||(this.setModified(),t.remove()))}}class _Ye extends H5{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let i=new Set;t instanceof fu&&(i=t.producedFields(),tj(i,n)&&(this.setModified(),t.removeFormulas(n),0===t.producedFields.length&&t.remove()));for(const r of t.children)this.run(r,new Set([...n,...i]))}}class yYe extends U5{constructor(){super()}run(t){t instanceof ss&&!t.isRequired()&&(this.setModified(),t.remove())}}class vYe extends np{run(t){if(!(V5(t)||t.numChildren()>1))for(const n of t.children)if(n instanceof Or)if(t instanceof Or)this.setModified(),t.merge(n);else{if(ij(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}class bYe extends np{run(t){const n=[...t.children],i=t.children.filter(r=>r instanceof Or);if(t.numChildren()>1&&i.length>=1){const r={},s=new Set;for(const o of i){const a=o.parse;for(const l of oe(a))l in r?r[l]!==a[l]&&s.add(l):r[l]=a[l]}for(const o of s)delete r[o];if(!sn(r)){this.setModified();const o=new Or(t,r);for(const a of n){if(a instanceof Or)for(const l of oe(r))delete a.parse[l];t.removeChild(a),a.parent=o,a instanceof Or&&0===oe(a.parse).length&&a.remove()}}}}}class wYe extends np{run(t){t instanceof ss||t.numChildren()>0||t instanceof l0||t instanceof tp||(this.setModified(),t.remove())}}class DYe extends np{run(t){const n=t.children.filter(r=>r instanceof fu),i=n.pop();for(const r of n)this.setModified(),i.merge(r)}}class CYe extends np{run(t){const n=t.children.filter(r=>r instanceof el),i={};for(const r of n){const s=wt(r.groupBy);s in i||(i[s]=[]),i[s].push(r)}for(const r of oe(i)){const s=i[r];if(s.length>1){const o=s.pop();for(const a of s)o.merge(a)&&(t.removeChild(a),a.parent=o,a.remove(),this.setModified())}}}}class EYe extends np{constructor(t){super(),this.model=t}run(t){const n=!(V5(t)||t instanceof r0||t instanceof Or||t instanceof uf),i=[],r=[];for(const s of t.children)s instanceof hu&&(n&&!ij(t.producedFields(),s.dependentFields())?i.push(s):r.push(s));if(i.length>0){const s=i.pop();for(const o of i)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof hu?t.merge(s,this.model.renameSignal.bind(this.model)):s.swapWithParent()}if(r.length>1){const s=r.pop();for(const o of r)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified()}}}class SYe extends np{run(t){const n=[...t.children];if(!$h(n,o=>o instanceof ss)||t.numChildren()<=1)return;const r=[];let s;for(const o of n)if(o instanceof ss){let a=o;for(;1===a.numChildren();){const[l]=a.children;if(!(l instanceof ss))break;a=l}r.push(...a.children),s?(t.removeChild(o),o.parent=s.parent,s.parent.removeChild(s),s.parent=a,this.setModified()):s=a}else r.push(o);if(r.length){this.setModified();for(const o of r)o.parent.removeChild(o),o.parent=s}}}class ip extends on{constructor(t,n){super(t),this.transform=n}clone(){return new ip(null,it(this.transform))}addDimensions(t){this.transform.groupby=Jl(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>void 0!==n).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return null!==(n=t.as)&&void 0!==n?n:_e(t)}hash(){return`JoinAggregateTransform ${wt(this.transform)}`}assemble(){const t=[],n=[],i=[];for(const s of this.transform.joinaggregate)n.push(s.op),i.push(this.getDefaultName(s)),t.push(void 0===s.field?null:s.field);const r=this.transform.groupby;return Object.assign({type:"joinaggregate",as:i,ops:n,fields:t},void 0!==r?{groupby:r}:{})}}class yc extends on{constructor(t,n){super(t),this._stack=n}clone(){return new yc(null,it(this._stack))}static makeFromTransform(t,n){const{stack:i,groupby:r,as:s,offset:o="zero"}=n,a=[],l=[];if(void 0!==n.sort)for(const d of n.sort)a.push(d.field),l.push(pi(d.order,"ascending"));const u={field:a,order:l};let c;return c=function AYe(e){return ie(e)&&e.every(t=>be(t))&&e.length>1}(s)?s:be(s)?[s,`${s}_end`]:[`${n.stack}_start`,`${n.stack}_end`],new yc(t,{dimensionFieldDefs:[],stackField:i,groupby:r,offset:o,sort:u,facetby:[],as:c})}static makeFromEncoding(t,n){const i=n.stack,{encoding:r}=n;if(!i)return null;const{groupbyChannels:s,fieldChannel:o,offset:a,impute:l}=i,u=s.map(h=>uu(r[h])).filter(h=>!!h),c=function xYe(e){return e.stack.stackBy.reduce((t,n)=>{const r=_e(n.fieldDef);return r&&t.push(r),t},[])}(n),d=n.encoding.order;let f;return f=ie(d)||ge(d)?Pre(d):c.reduce((h,p)=>(h.field.push(p),h.order.push("y"===o?"descending":"ascending"),h),{field:[],order:[]}),new yc(t,{dimensionFieldDefs:u,stackField:n.vgField(o),facetby:[],stackby:c,sort:f,offset:a,impute:l,as:[n.vgField(o,{suffix:"start",forAs:!0}),n.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${wt(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:t,impute:n,groupby:i}=this._stack;return t.length>0?t.map(r=>r.bin?n?[_e(r,{binSuffix:"mid"})]:[_e(r,{}),_e(r,{binSuffix:"end"})]:[_e(r)]).flat():null!=i?i:[]}assemble(){const t=[],{facetby:n,dimensionFieldDefs:i,stackField:r,stackby:s,sort:o,offset:a,impute:l,as:u}=this._stack;if(l)for(const c of i){const{bandPosition:d=.5,bin:f}=c;if(f){const h=_e(c,{expr:"datum"}),p=_e(c,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:`${d}*${h}+${1-d}*${p}`,as:_e(c,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:r,groupby:[...s,...n],key:_e(c,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:r,sort:o,as:u,offset:a}),t}}class u0 extends on{constructor(t,n){super(t),this.transform=n}clone(){return new u0(null,it(this.transform))}addDimensions(t){this.transform.groupby=Jl(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const i=new Set;return(null!==(t=this.transform.groupby)&&void 0!==t?t:[]).forEach(i.add,i),(null!==(n=this.transform.sort)&&void 0!==n?n:[]).forEach(r=>i.add(r.field)),this.transform.window.map(r=>r.field).filter(r=>void 0!==r).forEach(i.add,i),i}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return null!==(n=t.as)&&void 0!==n?n:_e(t)}hash(){return`WindowTransform ${wt(this.transform)}`}assemble(){var t;const n=[],i=[],r=[],s=[];for(const f of this.transform.window)i.push(f.op),r.push(this.getDefaultName(f)),s.push(void 0===f.param?null:f.param),n.push(void 0===f.field?null:f.field);const o=this.transform.frame,a=this.transform.groupby;if(o&&null===o[0]&&null===o[1]&&i.every(f=>hj(f)))return Object.assign({type:"joinaggregate",as:r,ops:i,fields:n},void 0!==a?{groupby:a}:{});const l=[],u=[];if(void 0!==this.transform.sort)for(const f of this.transform.sort)l.push(f.field),u.push(null!==(t=f.order)&&void 0!==t?t:"ascending");const d=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:s,as:r,ops:i,fields:n,sort:{field:l,order:u}},void 0!==d?{ignorePeers:d}:{}),void 0!==a?{groupby:a}:{}),void 0!==o?{frame:o}:{})}}function z5(e){if(e instanceof l0)if(1!==e.numChildren()||e.children[0]instanceof ss){const t=e.model.component.data.main;nle(t);const n=function MYe(e){return function t(n){if(!(n instanceof l0)){const i=n.clone();if(i instanceof ss){const r=q5+i.getSource();i.setSource(r),e.model.component.data.outputNodes[r]=i}else(i instanceof el||i instanceof yc||i instanceof u0||i instanceof ip)&&i.addDimensions(e.fields);for(const r of n.children.flatMap(t))r.parent=i;return[i]}return n.children.flatMap(t)}}(e),i=e.children.map(n).flat();for(const r of i)r.parent=t}else{const t=e.children[0];(t instanceof el||t instanceof yc||t instanceof u0||t instanceof ip)&&t.addDimensions(e.fields),t.swapWithParent(),z5(e)}else e.children.map(z5)}function nle(e){if(e instanceof ss&&e.type===gn.Main&&1===e.numChildren()){const t=e.children[0];t instanceof l0||(t.swapWithParent(),nle(e))}}const q5="scale_";function G5(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!G5(t.children))return!1}return!0}function tl(e,t){let n=!1;for(const i of t)n=e.optimize(i)||n;return n}function ile(e,t,n){let i=e.sources,r=!1;return r=tl(new yYe,i)||r,r=tl(new mYe(t),i)||r,i=i.filter(s=>s.numChildren()>0),r=tl(new wYe,i)||r,i=i.filter(s=>s.numChildren()>0),n||(r=tl(new vYe,i)||r,r=tl(new EYe(t),i)||r,r=tl(new _Ye,i)||r,r=tl(new bYe,i)||r,r=tl(new CYe,i)||r,r=tl(new DYe,i)||r,r=tl(new gYe,i)||r,r=tl(new SYe,i)||r),e.sources=i,r}class Ns{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Ns(()=>t(n))}}function rle(e){gi(e)?function NYe(e){const t=e.component.scales;for(const n of oe(t)){const i=RYe(e,n);if(t[n].setWithExplicit("domains",i),PYe(e,n),e.component.data.isFaceted){let s=e;for(;!nl(s)&&s.parent;)s=s.parent;if("shared"===s.component.resolve.scale[n])for(const a of i.value)hc(a)&&(a.data=q5+a.data.replace(q5,""))}}}(e):function kYe(e){for(const n of e.children)rle(n);const t=e.component.scales;for(const n of oe(t)){let i,r=null;for(const s of e.children){const o=s.component.scales[n];if(o){i=void 0===i?o.getWithExplicit("domains"):nf(i,o.getWithExplicit("domains"),"domains","scale",K5);const a=o.get("selectionExtent");r&&a&&r.param!==a.param&&ce("The same selection must be used to override scale domains in a layered view."),r=a}}t[n].setWithExplicit("domains",i),r&&t[n].set("selectionExtent",r,!0)}}(e)}function RYe(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:i}=e,r=function IYe(e,t,n,i){if("unaggregated"===e){const{valid:r,reason:s}=sle(t,n);if(!r)return void ce(s)}else if(void 0===e&&i.useUnaggregatedDomain){const{valid:r}=sle(t,n);if(r)return"unaggregated"}return e}(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:r})),"x"===t&&Mi(i.x2)?Mi(i.x)?nf(cf(n,r,e,"x"),cf(n,r,e,"x2"),"domain","scale",K5):cf(n,r,e,"x2"):"y"===t&&Mi(i.y2)?Mi(i.y)?nf(cf(n,r,e,"y"),cf(n,r,e,"y2"),"domain","scale",K5):cf(n,r,e,"y2"):cf(n,r,e,t)}function W5(e,t,n){var i;const r=null===(i=rs(n))||void 0===i?void 0:i.unit;return"temporal"===t||r?function FYe(e,t,n){return e.map(i=>({signal:`{data: ${yx(i,{timeUnit:n,type:t})}}`}))}(e,t,r):[e]}function cf(e,t,n,i){const{encoding:r}=n,s=Mi(r[i]),{type:o}=s,a=s.timeUnit;if(function rze(e){return e&&e.unionWith}(t)){const d=cf(e,void 0,n,i),f=W5(t.unionWith,o,a);return du([...d.value,...f])}if(Le(t))return du([t]);if(t&&"unaggregated"!==t&&!mse(t))return du(W5(t,o,a));const l=n.stack;if(l&&i===l.fieldChannel){if("normalize"===l.offset)return po([[0,1]]);const d=n.requestDataName(gn.Main);return po([{data:d,field:n.vgField(i,{suffix:"start"})},{data:d,field:n.vgField(i,{suffix:"end"})}])}const u=Yd(i)&&ge(s)?function LYe(e,t,n){if(!zi(n))return;const i=e.fieldDef(t),r=i.sort;if(Fse(r))return{op:"min",field:o0(i,t),order:"ascending"};const{stack:s}=e,o=s?new Set([...s.groupbyFields,...s.stackBy.map(a=>a.fieldDef.field)]):void 0;if(ou(r))return Y5(r,s&&!o.has(r.field));if(Rse(r)){const{encoding:a,order:l}=r,u=e.fieldDef(a),{aggregate:c,field:d}=u,f=s&&!o.has(d);if(fc(c)||Kd(c))return Y5({field:_e(u),order:l},f);if(hj(c)||!c)return Y5({op:c,field:d,order:l},f)}else{if("descending"===r)return{op:"min",field:e.vgField(t),order:"descending"};if(Dt(["ascending",void 0],r))return!0}}(n,i,e):void 0;if(au(s))return po(W5([s.datum],o,a));const c=s;if("unaggregated"===t){const d=n.requestDataName(gn.Main),{field:f}=s;return po([{data:d,field:_e({field:f,aggregate:"min"})},{data:d,field:_e({field:f,aggregate:"max"})}])}if(vn(c.bin)){if(zi(e))return po("bin-ordinal"===e?[]:[{data:Qv(u)?n.requestDataName(gn.Main):n.requestDataName(gn.Raw),field:n.vgField(i,f1(c,i)?{binSuffix:"range"}:{}),sort:!0!==u&&Se(u)?u:{field:n.vgField(i,{}),op:"min"}}]);{const{bin:d}=c;if(vn(d)){const f=$5(n,c.field,d);return po([new Ns(()=>{const h=n.getSignalName(f);return`[${h}.start, ${h}.stop]`})])}return po([{data:n.requestDataName(gn.Main),field:n.vgField(i,{})}])}}if(c.timeUnit&&Dt(["time","utc"],e)&&Bse(c,gi(n)?n.encoding[dc(i)]:void 0,n.markDef,n.config)){const d=n.requestDataName(gn.Main);return po([{data:d,field:n.vgField(i)},{data:d,field:n.vgField(i,{suffix:"end"})}])}return po(u?[{data:Qv(u)?n.requestDataName(gn.Main):n.requestDataName(gn.Raw),field:n.vgField(i),sort:u}]:[{data:n.requestDataName(gn.Main),field:n.vgField(i)}])}function Y5(e,t){const{op:n,field:i,order:r}=e;return Object.assign(Object.assign({op:null!=n?n:t?"sum":lx},i?{field:Yo(i)}:{}),r?{order:r}:{})}function PYe(e,t){var n;const i=e.component.scales[t],r=e.specifiedScales[t].domain,s=null===(n=e.fieldDef(t))||void 0===n?void 0:n.bin,o=mse(r)&&r,a=qh(s)&&JS(s.extent)&&s.extent;(o||a)&&i.set("selectionExtent",null!=o?o:a,!0)}function sle(e,t){const{aggregate:n,type:i}=e;return n?be(n)&&!mHe.has(n)?{valid:!1,reason:oUe(n)}:"quantitative"===i&&"log"===t?{valid:!1,reason:aUe(e)}:{valid:!0}:{valid:!1,reason:sUe(e)}}function K5(e,t,n,i){return e.explicit&&t.explicit&&ce(function fUe(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${yn(n)} and ${yn(i)}). Using the union of the two domains.`}(n,i,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function J5(e){if(hc(e)&&be(e.field))return e.field;if(function yHe(e){return!ie(e)&&"fields"in e&&!("data"in e)}(e)){let t;for(const n of e.fields)if(hc(n)&&be(n.field))if(t){if(t!==n.field)return ce("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),t}else t=n.field;return ce("Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect."),t}if(function vHe(e){return!ie(e)&&"fields"in e&&"data"in e}(e)){ce("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");const t=e.fields[0];return be(t)?t:void 0}}function $x(e,t){return function jYe(e){const t=Jl(e.map(o=>hc(o)?function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(o,["sort"]):o),wt),n=Jl(e.map(o=>{if(hc(o)){const a=o.sort;return void 0!==a&&!Qv(a)&&("op"in a&&"count"===a.op&&delete a.field,"ascending"===a.order&&delete a.order),a}}).filter(o=>void 0!==o),wt);if(0===t.length)return;if(1===t.length){const o=e[0];if(hc(o)&&n.length>0){let a=n[0];return n.length>1?(ce(Qre),a=!0):Se(a)&&"field"in a&&o.field===a.field&&(a=!a.order||{order:a.order}),Object.assign(Object.assign({},o),{sort:a})}return o}const i=Jl(n.map(o=>Qv(o)||!("op"in o)||be(o.op)&&o.op in fHe?o:(ce(function pUe(e){return`Dropping sort property ${yn(e)} as unioned domains only support boolean or op "count", "min", and "max".`}(o)),!0)),wt);let r;1===i.length?r=i[0]:i.length>1&&(ce(Qre),r=!0);const s=Jl(e.map(o=>hc(o)?o.data:null),o=>o);return Object.assign(1===s.length&&null!==s[0]?{data:s[0],fields:t.map(a=>a.field)}:{fields:t},r?{sort:r}:{})}(e.component.scales[t].get("domains").map(r=>(hc(r)&&(r.data=e.lookupDataSource(r.data)),r)))}function ole(e){return c0(e)||Z5(e)?e.children.reduce((t,n)=>t.concat(ole(n)),ale(e)):ale(e)}function ale(e){return oe(e.component.scales).reduce((t,n)=>{const i=e.component.scales[n];if(i.merged)return t;const r=i.combine(),{name:s,type:o,selectionExtent:a,reverse:c}=r,d=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(r,["name","type","selectionExtent","domains","range","reverse"]),f=function $Ye(e,t,n,i){if(nr(n)){if(Xd(e))return{step:{signal:`${t}_step`}}}else if(Se(e)&&hc(e))return Object.assign(Object.assign({},e),{data:i.lookupDataSource(e.data)});return e}(r.range,s,n,e),h=$x(e,n),p=a?function TGe(e,t,n,i){const r=Eae(e,t.param,t);return{signal:ho(n.get("type"))&&ie(i)&&i[0]>i[1]?`isValid(${r}) && reverse(${r})`:r}}(e,a,i,h):null;return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:s,type:o},h?{domain:h}:{}),p?{domainRaw:p}:{}),{range:f}),void 0!==c?{reverse:c}:{}),d)),t},[])}class lle extends _c{constructor(t,n){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||$h(this.get("domains"),t=>ie(t)&&2===t.length&&t[0]<=0&&t[1]>=0)}}const VYe=["range","scheme"];function ule(e,t){const n=e.fieldDef(t);if(null==n?void 0:n.bin){const{bin:i,field:r}=n,s=Ms(t),o=e.getName(s);if(Se(i)&&i.binned&&void 0!==i.step)return new Ns(()=>{const a=e.scaleName(t),l=`(domain("${a}")[1] - domain("${a}")[0]) / ${i.step}`;return`${e.getSignalName(o)} / (${l})`});if(vn(i)){const a=$5(e,r,i);return new Ns(()=>{const l=e.getSignalName(a),u=`(${l}.stop - ${l}.start) / ${l}.step`;return`${e.getSignalName(o)} / (${u})`})}}}function UYe(e,t){const n=t.specifiedScales[e],{size:i}=t,s=t.getScaleComponent(e).get("type");for(const d of VYe)if(void 0!==n[d]){const f=Fj(s,d),h=_se(e,d);if(f)if(h)ce(h);else switch(d){case"range":{const p=n.range;if(ie(p)){if(nr(e))return du(p.map(g=>{if("width"===g||"height"===g){const m=t.getName(g),_=t.getSignalName.bind(t);return Ns.fromName(_,m)}return g}))}else if(Se(p))return du({data:t.requestDataName(gn.Main),field:p.field,sort:{op:"min",field:t.vgField(e)}});return du(p)}case"scheme":return du(zYe(n[d]))}else ce(Jre(s,d,e))}const o=e===Bn||"xOffset"===e?"width":"height",a=i[o];if(cu(a))if(nr(e))if(zi(s)){const d=cle(a,t,e);if(d)return du({step:d})}else ce(Xre(o));else if(Um(e)&&"band"===t.getScaleComponent(e===Hd?"x":"y").get("type")){const p=dle(a,s);if(p)return du(p)}const{rangeMin:l,rangeMax:u}=n,c=function qYe(e,t){const{size:n,config:i,mark:r,encoding:s}=t,o=t.getSignalName.bind(t),{type:a}=Mi(s[e]),u=t.getScaleComponent(e).get("type"),{domain:c,domainMid:d}=t.specifiedScales[e];switch(e){case Bn:case Ui:{if(Dt(["point","band"],u)){const p=fle(e,n,i.view);if(cu(p))return{step:cle(p,t,e)}}const f=Ms(e),h=t.getName(f);return e===Ui&&ho(u)?[Ns.fromName(o,h),0]:[0,Ns.fromName(o,h)]}case Hd:case Vm:return function GYe(e,t,n){const i=e===Hd?"x":"y",s=t.getScaleComponent(i).get("type"),o=t.scaleName(i);if("band"===s){const a=fle(i,t.size,t.config.view);if(cu(a)){const l=dle(a,n);if(l)return l}return[0,{signal:`bandwidth('${o}')`}]}return ure(`Cannot use ${e} scale if ${i} scale is not discrete.`)}(e,t,u);case uc:{const h=hle(r,t.component.scales[e].get("zero"),i),p=function KYe(e,t,n,i){const r={x:ule(n,"x"),y:ule(n,"y")};switch(e){case"bar":case"tick":{if(void 0!==i.scale.maxBandSize)return i.scale.maxBandSize;const s=gle(t,r,i.view);return nn(s)?s-1:new Ns(()=>`${s.signal} - 1`)}case"line":case"trail":case"rule":return i.scale.maxStrokeWidth;case"text":return i.scale.maxFontSize;case"point":case"square":case"circle":{if(i.scale.maxSize)return i.scale.maxSize;const s=gle(t,r,i.view);return nn(s)?Math.pow(.95*s,2):new Ns(()=>`pow(0.95 * ${s.signal}, 2)`)}}throw new Error(QS("size",e))}(r,n,t,i);return Gm(u)?function YYe(e,t,n){const i=()=>{const r=pc(t),s=pc(e),o=`(${r} - ${s}) / (${n} - 1)`;return`sequence(${s}, ${r} + ${o}, ${o})`};return Le(t)?new Ns(i):{signal:i()}}(h,p,function WYe(e,t,n,i){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return void 0!==n&&ie(n)?n.length+1:(ce(function xUe(e){return`Domain for ${e} is required for threshold scale.`}(i)),3)}}(u,i,c,e)):[h,p]}case Ka:return[0,2*Math.PI];case Hh:return[0,360];case Ql:return[0,new Ns(()=>`min(${t.getSignalName("width")},${t.getSignalName("height")})/2`)];case qd:return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case Gd:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case As:return"symbol";case xs:case tu:case nu:return"ordinal"===u?"nominal"===a?"category":"ordinal":void 0!==d?"diverging":"rect"===r||"geoshape"===r?"heatmap":"ramp";case cc:case Ud:case zd:return[i.scale.minOpacity,i.scale.maxOpacity]}}(e,t);return(void 0!==l||void 0!==u)&&Fj(s,"rangeMin")&&ie(c)&&2===c.length?du([null!=l?l:c[0],null!=u?u:c[1]]):po(c)}function zYe(e){return function ize(e){return!be(e)&&!!e.name}(e)?Object.assign({scheme:e.name},co(e,["name"])):{scheme:e}}function cle(e,t,n){var i,r,s,o,a;const{encoding:l}=t,u=t.getScaleComponent(n),c=Cre(n),d=l[c];if("offset"===boe({step:e,offsetIsDiscrete:Je(d)&&cse(d.type)})&&Zse(l,c)){const h=t.getScaleComponent(c);let g=`domain('${t.scaleName(c)}').length`;"band"===h.get("type")&&(g=`bandspace(${g}, ${null!==(r=null!==(i=h.get("paddingInner"))&&void 0!==i?i:h.get("padding"))&&void 0!==r?r:0}, ${null!==(o=null!==(s=h.get("paddingOuter"))&&void 0!==s?s:h.get("padding"))&&void 0!==o?o:0})`);const m=null!==(a=u.get("paddingInner"))&&void 0!==a?a:u.get("padding");return{signal:`${e.step} * ${g} / (1-${DHe(m)})`}}return e.step}function dle(e,t){if("offset"===boe({step:e,offsetIsDiscrete:zi(t)}))return{step:e.step}}function fle(e,t,n){const i=e===Bn?"width":"height";return t[i]||xx(n,i)}function hle(e,t,n){if(t)return Le(t)?{signal:`${t.signal} ? 0 : ${hle(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(QS("size",e))}function gle(e,t,n){const i=cu(e.width)?e.width.step:Sx(n,"width"),r=cu(e.height)?e.height.step:Sx(n,"height");return t.x||t.y?new Ns(()=>`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(", ")})`):Math.min(i,r)}function mle(e,t){gi(e)?function JYe(e,t){const n=e.component.scales,{config:i,encoding:r,markDef:s,specifiedScales:o}=e;for(const a of oe(n)){const l=o[a],u=n[a],c=e.getScaleComponent(a),d=Mi(r[a]),f=l[t],h=c.get("type"),p=c.get("padding"),g=c.get("paddingInner"),m=Fj(h,t),_=_se(a,t);if(void 0!==f&&(m?_&&ce(_):ce(Jre(h,t,a))),m&&void 0===_)if(void 0!==f){const y=d.timeUnit,v=d.type;switch(t){case"domainMax":case"domainMin":Wh(l[t])||"temporal"===v||y?u.set(t,{signal:yx(l[t],{type:v,timeUnit:y})},!0):u.set(t,l[t],!0);break;default:u.copyKeyFromObject(t,l)}}else{const y=t in _le?_le[t]({model:e,channel:a,fieldOrDatumDef:d,scaleType:h,scalePadding:p,scalePaddingInner:g,domain:l.domain,domainMin:l.domainMin,domainMax:l.domainMax,markDef:s,config:i,hasNestedOffsetScale:Xj(r,a)}):i.scale[t];void 0!==y&&u.set(t,y,!1)}}}(e,t):vle(e,t)}const _le={bins:({model:e,fieldOrDatumDef:t})=>ge(t)?function XYe(e,t){const n=t.bin;if(vn(n)){const i=$5(e,t.field,n);return new Ns(()=>e.getSignalName(i))}if(is(n)&&qh(n)&&void 0!==n.step)return{step:n.step}}(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>function QYe(e,t){if(Dt([xs,tu,nu],e)&&"nominal"!==t)return"hcl"}(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:i,domainMax:r,fieldOrDatumDef:s})=>function ZYe(e,t,n,i,r,s){var o;if(!((null===(o=uu(s))||void 0===o?void 0:o.bin)||ie(n)||null!=r||null!=i||Dt(["time","utc"],e)))return!!nr(t)||void 0}(e,t,n,i,r,s),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>function eKe(e,t,n,i,r,s){if(nr(e)){if(Xa(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:o,orient:a}=r;if("bar"===o&&(!ge(i)||!i.bin&&!i.timeUnit)&&("vertical"===a&&"x"===e||"horizontal"===a&&"y"===e))return s.continuousBandSize}if("point"===t)return n.pointPadding}}(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:i,config:r,hasNestedOffsetScale:s})=>function tKe(e,t,n,i,r,s=!1){if(void 0===e){if(nr(t)){const{bandPaddingInner:o,barBandPaddingInner:a,rectBandPaddingInner:l,bandWithNestedOffsetPaddingInner:u}=r;return s?u:pi(o,"bar"===n?a:l)}if(Um(t)&&"band"===i)return r.offsetBandPaddingInner}}(e,t,n.type,i,r.scale,s),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:i,config:r,hasNestedOffsetScale:s})=>function nKe(e,t,n,i,r,s=!1){if(void 0===e)if(nr(t)){const{bandPaddingOuter:o,bandWithNestedOffsetPaddingOuter:a}=r;if(s)return a;if("band"===n)return pi(o,Le(i)?{signal:`${i.signal}/2`}:i/2)}else if(Um(t)){if("point"===n)return.5;if("band"===n)return r.offsetBandPaddingOuter}}(e,t,n,i,r.scale,s),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>function iKe(e,t,n,i){return"x"===n&&void 0!==i.xReverse?ho(e)&&"descending"===t?Le(i.xReverse)?{signal:`!${i.xReverse.signal}`}:!i.xReverse:i.xReverse:!(!ho(e)||"descending"!==t)||void 0}(t,ge(e)?e.sort:void 0,n,i.scale),zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:i,scaleType:r})=>function rKe(e,t,n,i,r){if(n&&"unaggregated"!==n&&ho(r)){if(ie(n)){const a=n[n.length-1];if(n[0]<=0&&a>=0)return!0}return!1}if("size"===e&&"quantitative"===t.type&&!Gm(r))return!0;if((!ge(t)||!t.bin)&&Dt([...iu,...rHe],e)){const{orient:o,type:a}=i;return!(Dt(["bar","area","line","trail"],a)&&("horizontal"===o&&"y"===e||"vertical"===o&&"x"===e))}return!1}(e,t,n,i,r)};function yle(e){gi(e)?function HYe(e){const t=e.component.scales;for(const n of KS){const i=t[n];if(!i)continue;const r=UYe(n,e);i.setWithExplicit("range",r)}}(e):vle(e,"range")}function vle(e,t){const n=e.component.scales;for(const i of e.children)"range"===t?yle(i):mle(i,t);for(const i of oe(n)){let r;for(const s of e.children){const o=s.component.scales[i];o&&(r=nf(r,o.getWithExplicit(t),t,"scale",Woe((l,u)=>"range"===t&&l.step&&u.step?l.step-u.step:0)))}n[i].setWithExplicit(t,r)}}function sKe(e,t,n,i,r=!1){const s=function oKe(e,t,n,i){var r;switch(t.type){case"nominal":case"ordinal":if(Hm(e)||"discrete"===fj(e))return"shape"===e&&"ordinal"===t.type&&ce(vj(e,"ordinal")),"ordinal";if(nr(e)||Um(e)){if(Dt(["rect","bar","image","rule"],n.type)||i)return"band"}else if("arc"===n.type&&e in uj)return"band";return Wm(n[Ms(e)])||Wj(t)&&(null===(r=t.axis)||void 0===r?void 0:r.tickBand)?"band":"point";case"temporal":return Hm(e)?"time":"discrete"===fj(e)?(ce(vj(e,"temporal")),"ordinal"):ge(t)&&t.timeUnit&&rs(t.timeUnit).utc?"utc":"time";case"quantitative":return Hm(e)?ge(t)&&vn(t.bin)?"bin-ordinal":"linear":"discrete"===fj(e)?(ce(vj(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(Yre(t.type))}(t,n,i,r),{type:o}=e;return Yd(t)?void 0!==o?function uze(e,t,n=!1){if(!Yd(e))return!1;switch(e){case Bn:case Ui:case Hd:case Vm:case Ka:case Ql:return!(!Xa(t)&&"band"!==t)||"point"===t&&!n;case uc:case qd:case cc:case Ud:case zd:case Hh:return Xa(t)||Gm(t)||Dt(["band","point","ordinal"],t);case xs:case tu:case nu:return"band"!==t;case Gd:case As:return"ordinal"===t||Gm(t)}}(t,o)?ge(n)&&!function lze(e,t){return Dt([kj,Ij],t)?void 0===e||zi(e):t===zm?Dt(["time","utc",void 0],e):t!==Kh||pse(e)||Gm(e)||void 0===e}(o,n.type)?(ce(function cUe(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}(o,s)),s):o:(ce(function uUe(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}(t,o,s)),s):s:null}function ble(e){e.component.scales=gi(e)?function lKe(e){const{encoding:t,mark:n,markDef:i}=e,r={};for(const s of KS){const o=Mi(t[s]);if(o&&n===bse&&s===As&&o.type===qm)continue;let a=o&&o.scale;if(!Um(s)||Xj(t,Ere(s))){if(o&&null!==a&&!1!==a){null!=a||(a={});const u=sKe(a,s,o,i,Xj(t,s));r[s]=new lle(e.scaleName(`${s}`,!0),{value:u,explicit:a.type===u})}}else a&&ce(KHe(s))}return r}(e):function cKe(e){var t,n;const i=e.component.scales={},r={},s=e.component.resolve;for(const o of e.children){ble(o);for(const a of oe(o.component.scales))if(null!==(t=(n=s.scale)[a])&&void 0!==t||(n[a]=jae(a,e)),"shared"===s.scale[a]){const l=r[a],u=o.component.scales[a].getWithExplicit("type");l?QUe(l.value,u.value)?r[a]=nf(l,u,"type","scale",uKe):(s.scale[a]="independent",delete r[a]):r[a]=u}}for(const o of oe(r)){const a=e.scaleName(o,!0);i[o]=new lle(a,r[o]);for(const u of e.children){const c=u.component.scales[o];c&&(u.renameScale(c.get("name"),a),c.merged=!0)}}return i}(e)}const uKe=Woe((e,t)=>dse(e)-dse(t));var X5=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};class Q5{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return void 0!==this.nameMap[t]}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function gi(e){return"unit"===(null==e?void 0:e.type)}function nl(e){return"facet"===(null==e?void 0:e.type)}function Z5(e){return"concat"===(null==e?void 0:e.type)}function c0(e){return"layer"===(null==e?void 0:e.type)}class eB{constructor(t,n,i,r,s,o,a){var l,u;this.type=n,this.parent=i,this.config=s,this.correctDataNames=c=>{var d,f,h;return(null===(d=c.from)||void 0===d?void 0:d.data)&&(c.from.data=this.lookupDataSource(c.from.data)),(null===(h=null===(f=c.from)||void 0===f?void 0:f.facet)||void 0===h?void 0:h.data)&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c},this.parent=i,this.config=s,this.view=Ts(a),this.name=null!==(l=t.name)&&void 0!==l?l:r,this.title=Jd(t.title)?{text:t.title}:t.title?Ts(t.title):void 0,this.scaleNameMap=i?i.scaleNameMap:new Q5,this.projectionNameMap=i?i.projectionNameMap:new Q5,this.signalNameMap=i?i.signalNameMap:new Q5,this.data=t.data,this.description=t.description,this.transforms=function fGe(e){return e.map(t=>_5(t)?{filter:jm(t.filter,YUe)}:t)}(null!==(u=t.transform)&&void 0!==u?u:[]),this.layout="layer"===n||"unit"===n?{}:function yqe(e,t,n){var i,r;const s=n[t],o={},{spacing:a,columns:l}=s;void 0!==a&&(o.spacing=a),void 0!==l&&(ux(e)&&!c1(e.facet)||c5(e))&&(o.columns=l),Ex(e)&&(o.columns=1);for(const u of _qe)if(void 0!==e[u])if("spacing"===u){const c=e[u];o[u]=nn(c)?c:{row:null!==(i=c.row)&&void 0!==i?i:a,column:null!==(r=c.column)&&void 0!==r?r:a}}else o[u]=e[u];return o}(t,n,s),this.component={data:{sources:i?i.component.data.sources:[],outputNodes:i?i.component.data.outputNodes:{},outputNodeRefCounts:i?i.component.data.outputNodeRefCounts:{},isFaceted:ux(t)||(null==i?void 0:i.component.data.isFaceted)&&void 0===t.data},layoutSize:new _c,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?it(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){!function aKe(e,{ignoreRange:t}={}){ble(e),rle(e);for(const n of aze)mle(e,n);t||yle(e)}(this)}parseProjection(){Xae(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){Gae(this)}assembleEncodeFromView(t){const i=X5(t,["style"]),r={};for(const s of oe(i)){const o=i[s];void 0!==o&&(r[s]=En(o))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),t||(this.description&&(n.description=En(this.description)),"unit"!==this.type&&"layer"!==this.type)?sn(n)?void 0:n:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},null!=n?n:{})}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,i=X5(t,["spacing"]),{component:r,config:s}=this,o=function AWe(e,t){const n={};for(const i of Jo){const r=e[i];if(null==r?void 0:r.facetFieldDef){const{titleAnchor:s,titleOrient:o}=Lx(["titleAnchor","titleOrient"],r.facetFieldDef.header,t,i),a=Px(i,o),l=xWe(s,a);void 0!==l&&(n[a]=l)}}return sn(n)?void 0:n}(r.layoutHeaders,s);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),i),o?{titleBand:o}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const i of Jo)t[i].title&&n.push(wWe(this,i));for(const i of R5)n=n.concat(DWe(this,i));return n}assembleAxes(){return function uWe(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(r=>v1(r,"grid",t)),...i.map(r=>v1(r,"grid",t)),...n.map(r=>v1(r,"main",t)),...i.map(r=>v1(r,"main",t))].filter(r=>r)}(this.component.axes,this.config)}assembleLegends(){return Yae(this)}assembleProjections(){return function XWe(e){return c0(e)||Z5(e)?function QWe(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),Kae(e))}(e):Kae(e)}(this)}assembleTitle(){var t,n,i;const r=null!==(t=this.title)&&void 0!==t?t:{},{encoding:s}=r,o=X5(r,["encoding"]),a=Object.assign(Object.assign(Object.assign({},Ore(this.config.title).nonMarkTitleProperties),o),s?{encode:{update:s}}:{});if(a.text)return Dt(["unit","layer"],this.type)?Dt(["middle",void 0],a.anchor)&&(null!==(n=a.frame)&&void 0!==n||(a.frame="group")):null!==(i=a.anchor)&&void 0!==i||(a.anchor="start"),sn(a)?void 0:a}assembleGroup(t=[]){const n={};(t=t.concat(this.assembleSignals())).length>0&&(n.signals=t);const i=this.assembleLayout();i&&(n.layout=i),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||nl(this.parent)?ole(this):[];r.length>0&&(n.scales=r);const s=this.assembleAxes();s.length>0&&(n.axes=s);const o=this.assembleLegends();return o.length>0&&(n.legends=o),n}getName(t){return Fn((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(gn[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),i=this.component.data.outputNodeRefCounts;return i[n]=(i[n]||0)+1,n}getSizeSignalRef(t){if(nl(this.parent)){const i=YS(Pae(t)),r=this.component.scales[i];if(r&&!r.merged){const s=r.get("type"),o=r.get("range");if(zi(s)&&Xd(o)){const a=r.get("name"),u=J5($x(this,i));return u?{signal:Fae(a,r,_e({aggregate:"distinct",field:u},{expr:"datum"}))}:(ce(_j(i)),null)}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){return n?this.getName(t):wre(t)&&Yd(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t))?this.scaleNameMap.get(this.getName(t)):void 0}projectionName(t){return t?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let i=this.component.selection[t];if(!i&&this.parent&&(i=this.parent.getSelectionComponent(t,n)),!i)throw new Error(function AHe(e){return`Cannot find a selection named "${e}".`}(n));return i}hasAxisOrientSignalRef(){var t,n;return(null===(t=this.component.axes.x)||void 0===t?void 0:t.some(i=>i.hasOrientSignalRef()))||(null===(n=this.component.axes.y)||void 0===n?void 0:n.some(i=>i.hasOrientSignalRef()))}}class wle extends eB{vgField(t,n={}){const i=this.fieldDef(t);if(i)return _e(i,n)}reduceFieldDef(t,n){return function Kze(e,t,n,i){return e?oe(e).reduce((r,s)=>{const o=e[s];return ie(o)?o.reduce((a,l)=>t.call(i,a,l,s),r):t.call(i,r,o,s)},n):n}(this.getMapping(),(i,r,s)=>{const o=uu(r);return o?t(i,o,s):i},n)}forEachFieldDef(t,n){Zj(this.getMapping(),(i,r)=>{const s=uu(i);s&&t(s,r)},n)}}class Vx extends on{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=it(n);const o=null!==(i=this.transform.as)&&void 0!==i?i:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"value",null!==(s=o[1])&&void 0!==s?s:"density"]}clone(){return new Vx(null,it(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${wt(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,i=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["density"]);return Object.assign({type:"kde",field:n},i)}}class C1 extends on{constructor(t,n){super(t),this.filter=n}clone(){return new C1(null,Object.assign({},this.filter))}static make(t,n){const{config:i,mark:r,markDef:s}=n;if("filter"!==Kt("invalid",s,i))return null;const a=n.reduceFieldDef((l,u,c)=>{const d=Yd(c)&&n.getScaleComponent(c);return d&&ho(d.get("type"))&&"count"!==u.aggregate&&!Zd(r)&&(l[u.field]=u),l},{});return oe(a).length?new C1(t,a):null}dependentFields(){return new Set(oe(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${wt(this.filter)}`}assemble(){const t=oe(this.filter).reduce((n,i)=>{const r=this.filter[i],s=_e(r,{expr:"datum"});return null!==r&&("temporal"===r.type?n.push(`(isDate(${s}) || (isValid(${s}) && isFinite(+${s})))`):"quantitative"===r.type&&(n.push(`isValid(${s})`),n.push(`isFinite(+${s})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class Hx extends on{constructor(t,n){super(t),this.transform=n,this.transform=it(n);const{flatten:i,as:r=[]}=this.transform;this.transform.as=i.map((s,o)=>{var a;return null!==(a=r[o])&&void 0!==a?a:s})}clone(){return new Hx(this.parent,it(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${wt(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class Ux extends on{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=it(n);const o=null!==(i=this.transform.as)&&void 0!==i?i:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"key",null!==(s=o[1])&&void 0!==s?s:"value"]}clone(){return new Ux(null,it(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${wt(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class d0 extends on{constructor(t,n,i,r){super(t),this.fields=n,this.geojson=i,this.signal=r}clone(){return new d0(null,it(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let i=0;for(const r of[[eu,Zl],[Ko,Ja]]){const s=r.map(o=>{const a=Mi(n.encoding[o]);return ge(a)?a.field:au(a)?{expr:`${a.datum}`}:Za(a)?{expr:`${a.value}`}:void 0});(s[0]||s[1])&&(t=new d0(t,s,null,n.getName("geojson_"+i++)))}if(n.channelHasField(As)){const r=n.typedFieldDef(As);r.type===qm&&(t=new d0(t,null,r.field,n.getName("geojson_"+i++)))}return t}dependentFields(){var t;const n=(null!==(t=this.fields)&&void 0!==t?t:[]).filter(be);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${wt(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})]}}class E1 extends on{constructor(t,n,i,r){super(t),this.projection=n,this.fields=i,this.as=r}clone(){return new E1(null,this.projection,it(this.fields),it(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const i of[[eu,Zl],[Ko,Ja]]){const r=i.map(o=>{const a=Mi(n.encoding[o]);return ge(a)?a.field:au(a)?{expr:`${a.datum}`}:Za(a)?{expr:`${a.value}`}:void 0}),s=i[0]===Ko?"2":"";(r[0]||r[1])&&(t=new E1(t,n.projectionName(),r,[n.getName(`x${s}`),n.getName(`y${s}`)]))}return t}dependentFields(){return new Set(this.fields.filter(be))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${wt(this.fields)} ${wt(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class rp extends on{constructor(t,n){super(t),this.transform=n}clone(){return new rp(null,it(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:i,step:r}=t;return{signal:`sequence(${[n,i,...r?[r]:[]].join(",")})`}}static makeFromTransform(t,n){return new rp(t,n)}static makeFromEncoding(t,n){const i=n.encoding,r=i.x,s=i.y;if(ge(r)&&ge(s)){const o=r.impute?r:s.impute?s:void 0;if(void 0===o)return;const a=r.impute?s:s.impute?r:void 0,{method:l,value:u,frame:c,keyvals:d}=o.impute,f=toe(n.mark,i);return new rp(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:a.field},l?{method:l}:{}),void 0!==u?{value:u}:{}),c?{frame:c}:{}),void 0!==d?{keyvals:d}:{}),f.length?{groupby:f}:{}))}return null}hash(){return`Impute ${wt(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:i,method:r,groupby:s,value:o,frame:a=[null,null]}=this.transform,l=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},i?{keyvals:Yqe(i)?this.processSequence(i):i}:{}),{method:"value"}),s?{groupby:s}:{}),{value:r&&"value"!==r?null:o});return r&&"value"!==r?[l,Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[r],fields:[t],frame:a,ignorePeers:!1},s?{groupby:s}:{}),{type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t}]:[l]}}class zx extends on{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=it(n);const o=null!==(i=this.transform.as)&&void 0!==i?i:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:n.on,null!==(s=o[1])&&void 0!==s?s:n.loess]}clone(){return new zx(null,it(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${wt(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:i}=t,r=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["loess","on"]);return Object.assign({type:"loess",x:i,y:n},r)}}class S1 extends on{constructor(t,n,i){super(t),this.transform=n,this.secondary=i}clone(){return new S1(null,it(this.transform),this.secondary)}static make(t,n,i,r){const s=n.component.data.sources,{from:o}=i;let a=null;if(function Kqe(e){return"data"in e}(o)){let l=Sle(o.data,s);l||(l=new tp(o.data),s.push(l));const u=n.getName(`lookup_${r}`);a=new ss(l,u,gn.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[u]=a}else if(function Jqe(e){return"param"in e}(o)){const l=o.param;let u;i=Object.assign({as:l},i);try{u=n.getSelectionComponent(Fn(l),l)}catch(c){throw new Error(function OHe(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}(l))}if(a=u.materialized,!a)throw new Error(function NHe(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}(l))}return new S1(t,i,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?we(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${wt({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:we(this.transform.as)}:{});else{let n=this.transform.as;be(n)||(ce('If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.'),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}class qx extends on{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=it(n);const o=null!==(i=this.transform.as)&&void 0!==i?i:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"prob",null!==(s=o[1])&&void 0!==s?s:"value"]}clone(){return new qx(null,it(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${wt(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,i=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["quantile"]);return Object.assign({type:"quantile",field:n},i)}}class Gx extends on{constructor(t,n){var i,r,s;super(t),this.transform=n,this.transform=it(n);const o=null!==(i=this.transform.as)&&void 0!==i?i:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:n.on,null!==(s=o[1])&&void 0!==s?s:n.regression]}clone(){return new Gx(null,it(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${wt(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:i}=t,r=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["regression","on"]);return Object.assign({type:"regression",x:i,y:n},r)}}class Wx extends on{constructor(t,n){super(t),this.transform=n}clone(){return new Wx(null,it(this.transform))}addDimensions(t){var n;this.transform.groupby=Jl((null!==(n=this.transform.groupby)&&void 0!==n?n:[]).concat(t),i=>i)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}hash(){return`PivotTransform ${wt(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:i,limit:r,op:s}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},void 0!==r?{limit:r}:{}),void 0!==s?{op:s}:{}),void 0!==i?{groupby:i}:{})}}class Yx extends on{constructor(t,n){super(t),this.transform=n}clone(){return new Yx(null,it(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${wt(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function Dle(e){let t=0;return function n(i,r){var s;if(i instanceof tp&&!i.isGenerator&&!Qm(i.data)&&(e.push(r),r={name:null,source:r.name,transform:[]}),i instanceof Or&&(i.parent instanceof tp&&!r.source?(r.format=Object.assign(Object.assign({},null!==(s=r.format)&&void 0!==s?s:{}),{parse:i.assembleFormatParse()}),r.transform.push(...i.assembleTransforms(!0))):r.transform.push(...i.assembleTransforms())),i instanceof l0)return r.name||(r.name="data_"+t++),!r.source||r.transform.length>0?(e.push(r),i.data=r.name):i.data=r.source,void e.push(...i.assemble());switch((i instanceof b1||i instanceof w1||i instanceof C1||i instanceof r0||i instanceof s0||i instanceof E1||i instanceof el||i instanceof S1||i instanceof u0||i instanceof ip||i instanceof Ux||i instanceof Hx||i instanceof Vx||i instanceof zx||i instanceof qx||i instanceof Gx||i instanceof uf||i instanceof Yx||i instanceof Wx)&&r.transform.push(i.assemble()),(i instanceof hu||i instanceof fu||i instanceof rp||i instanceof yc||i instanceof d0)&&r.transform.push(...i.assemble()),i instanceof ss&&(r.source&&0===r.transform.length?i.setSource(r.source):i.parent instanceof ss?i.setSource(r.name):(r.name||(r.name="data_"+t++),i.setSource(r.name),1===i.numChildren()&&(e.push(r),r={name:null,source:r.name,transform:[]}))),i.numChildren()){case 0:i instanceof ss&&(!r.source||r.transform.length>0)&&e.push(r);break;case 1:n(i.children[0],r);break;default:{r.name||(r.name="data_"+t++);let o=r.name;!r.source||r.transform.length>0?e.push(r):o=r.source;for(const a of i.children)n(a,{name:null,source:o,transform:[]});break}}}}function _Ke(e){return"top"===e||"left"===e||Le(e)?"header":"footer"}function vKe(e,t){var n;const{facet:i,config:r,child:s,component:o}=e;if(e.channelHasField(t)){const a=i[t],l=a0("title",null,r,t);let u=Ym(a,r,{allowDisabling:!0,includeDefault:void 0===l||!!l});s.component.layoutHeaders[t].title&&(u=ie(u)?u.join(", "):u,u+=` / ${s.component.layoutHeaders[t].title}`,s.component.layoutHeaders[t].title=null);const c=a0("labelOrient",a.header,r,t),d=null!==a.header&&pi(null===(n=a.header)||void 0===n?void 0:n.labels,r.header.labels,!0),f=Dt(["bottom","right"],c)?"footer":"header";o.layoutHeaders[t]={title:null!==a.header?u:null,facetFieldDef:a,[f]:"facet"===t?[]:[Cle(e,t,d)]}}}function Cle(e,t,n){const i="row"===t?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function Ele(e,t){var n;const{child:i}=e;if(i.component.axes[t]){const{layoutHeaders:r,resolve:s}=e.component;if(s.axis[t]=j5(s,t),"shared"===s.axis[t]){const o="x"===t?"column":"row",a=r[o];for(const l of i.component.axes[t]){const u=_Ke(l.get("orient"));null!==(n=a[u])&&void 0!==n||(a[u]=[Cle(e,o,!1)]);const c=v1(l,"main",e.config,{header:!0});c&&a[u][0].axes.push(c),l.mainExtracted=!0}}}}function tB(e){for(const t of e.children)t.parseLayoutSize()}function Kx(e,t){var n;const i=Pae(t),r=YS(i),s=e.component.resolve,o=e.component.layoutSize;let a;for(const l of e.children){const u=l.component.layoutSize.getWithExplicit(i),c=null!==(n=s.scale[r])&&void 0!==n?n:jae(r,e);if("independent"===c&&"step"===u.value){a=void 0;break}if(a){if("independent"===c&&a.value!==u.value){a=void 0;break}a=nf(a,u,i,"")}else a=u}if(a){for(const l of e.children)e.renameSignal(l.getName(i),e.getName(t)),l.component.layoutSize.set(i,"merged",!1);o.setWithExplicit(t,a)}else o.setWithExplicit(t,{explicit:!1,value:void 0})}function CKe(e,t){const i=e.config,r=e.getScaleComponent("width"===t?"x":"y");if(r){const s=r.get("type"),o=r.get("range");if(zi(s)){const a=xx(i.view,t);return Xd(o)||cu(a)?"step":a}return f5(i.view,t)}if(e.hasProjection||"arc"===e.mark)return f5(i.view,t);{const s=xx(i.view,t);return cu(s)?s.step:s}}function nB(e,t,n){return _e(t,Object.assign({suffix:`by_${_e(e)}`},null!=n?n:{}))}class x1 extends wle{constructor(t,n,i,r){super(t,"facet",n,i,r,t.resolve),this.child=aB(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!c1(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=oe(t),i={};for(const r of n){if(![sc,oc].includes(r)){ce(QS(r,"facet"));break}const s=t[r];if(void 0===s.field){ce(yj(s,r));break}i[r]=this.initFacetFieldDef(s,r)}return i}initFacetFieldDef(t,n){const i=Jj(t,n);return i.header?i.header=Ts(i.header):null===i.header&&(i.header=null),i}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=Jx(this),this.child.parseData()}parseLayoutSize(){tB(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function yKe(e){for(const t of Jo)vKe(e,t);Ele(e,"x"),Ele(e,"y")}(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,i;const r={};for(const s of Jo)for(const o of F5){const a=this.component.layoutHeaders[s],l=a[o],{facetFieldDef:u}=a;if(u){const c=a0("titleOrient",u.header,this.config,s);if(["right","bottom"].includes(c)){const d=Px(s,c);null!==(t=r.titleAnchor)&&void 0!==t||(r.titleAnchor={}),r.titleAnchor[d]="end"}}if(null==l?void 0:l[0]){const c="row"===s?"height":"width",d="header"===o?"headerBand":"footerBand";"facet"!==s&&!this.child.component.layoutSize.get(c)&&(null!==(n=r[d])&&void 0!==n||(r[d]={}),r[d][s]=.5),a.title&&(null!==(i=r.offset)&&void 0!==i||(r.offset={}),r.offset["row"===s?"rowTitle":"columnTitle"]=10)}}return r}assembleDefaultLayout(){const{column:t,row:n}=this.facet,i=t?this.columnDistinctSignal():n?1:void 0;let r="all";return(!n&&"independent"===this.component.resolve.scale.x||!t&&"independent"===this.component.resolve.scale.y)&&(r="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),i?{columns:i}:{}),{bounds:"full",align:r})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof x1))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof x1?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:_e(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],i=[];if(this.child instanceof x1){if(this.child.channelHasField("column")){const r=_e(this.child.facet.column);t.push(r),n.push("distinct"),i.push(`distinct_${r}`)}}else for(const r of iu){const s=this.child.component.scales[r];if(s&&!s.merged){const o=s.get("type"),a=s.get("range");if(zi(o)&&Xd(a)){const u=J5($x(this.child,r));u?(t.push(u),n.push("distinct"),i.push(`distinct_${u}`)):ce(_j(r))}}}return{fields:t,ops:n,as:i}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:i,column:r}=this.facet,{fields:s,ops:o,as:a}=this.getCardinalityAggregateForChild(),l=[];for(const c of Jo){const d=this.facet[c];if(d){l.push(_e(d));const{bin:f,sort:h}=d;if(vn(f)&&l.push(_e(d,{binSuffix:"end"})),ou(h)){const{field:p,op:g=lx}=h,m=nB(d,h);i&&r?(s.push(m),o.push("max"),a.push(m)):(s.push(p),o.push(g),a.push(m))}else if(ie(h)){const p=o0(d,c);s.push(p),o.push("max"),a.push(p)}}}const u=!!i&&!!r;return Object.assign({name:t,data:n,groupby:l},u||s.length>0?{aggregate:Object.assign(Object.assign({},u?{cross:u}:{}),s.length?{fields:s,ops:o,as:a}:{})}:{})}facetSortFields(t){const{facet:n}=this,i=n[t];return i?ou(i.sort)?[nB(i,i.sort,{expr:"datum"})]:ie(i.sort)?[o0(i,t,{expr:"datum"})]:[_e(i,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,i=n[t];if(i){const{sort:r}=i;return[(ou(r)?r.order:!ie(r)&&r)||"ascending"]}return[]}assembleLabelTitle(){var t;const{facet:n,config:i}=this;if(n.facet)return P5(n.facet,"facet",i);const r={row:["top","bottom"],column:["left","right"]};for(const s of R5)if(n[s]){const o=a0("labelOrient",null===(t=n[s])||void 0===t?void 0:t.header,i,s);if(r[s].includes(o))return P5(n[s],s,i)}}assembleMarks(){const{child:t}=this,i=function gKe(e){const t=[],n=Dle(t);for(const i of e.children)n(i,{source:e.name,name:null,transform:[]});return t}(this.component.data.facetRoot),r=t.assembleGroupEncodeEntry(!1),s=this.assembleLabelTitle()||t.assembleTitle(),o=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},s?{title:s}:{}),o?{style:o}:{}),{from:{facet:this.assembleFacet()},sort:{field:Jo.map(l=>this.facetSortFields(l)).flat(),order:Jo.map(l=>this.facetSortOrder(l)).flat()}}),i.length>0?{data:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup(SGe(this,[])))]}getMapping(){return this.facet}}function Sle(e,t){var n,i,r,s;for(const o of t){const a=o.data;if(e.name&&o.hasName()&&e.name!==o.dataName)continue;const l=null===(n=e.format)||void 0===n?void 0:n.mesh,u=null===(i=a.format)||void 0===i?void 0:i.feature;if(l&&u)continue;const c=null===(r=e.format)||void 0===r?void 0:r.feature;if((c||u)&&c!==u)continue;const d=null===(s=a.format)||void 0===s?void 0:s.mesh;if(!l&&!d||l===d)if(g1(e)&&g1(a)){if(Kl(e.values,a.values))return o}else if(Qm(e)&&Qm(a)){if(e.url===a.url)return o}else if(Yoe(e)&&e.name===o.dataName)return o}return null}function Jx(e){var t,n,i,r,s,o,a,l,u,c;let d=function SKe(e,t){if(e.data||!e.parent){if(null===e.data){const i=new tp({values:[]});return t.push(i),i}const n=Sle(e.data,t);if(n)return rf(e.data)||(n.data.format=cre({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const i=new tp(e.data);return t.push(i),i}}return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}(e,e.component.data.sources);const{outputNodes:f,outputNodeRefCounts:h}=e.component.data,p=e.data,m=p&&(rf(p)||Qm(p)||g1(p))||!e.parent?new DGe:e.parent.component.data.ancestorParse.clone();rf(p)?(Koe(p)?d=new w1(d,p.sequence):b5(p)&&(d=new b1(d,p.graticule)),m.parseNothing=!0):null===(null===(t=null==p?void 0:p.format)||void 0===t?void 0:t.parse)&&(m.parseNothing=!0),d=null!==(n=Or.makeExplicit(d,e,m))&&void 0!==n?n:d,d=new uf(d);const _=e.parent&&c0(e.parent);(gi(e)||nl(e))&&_&&(d=null!==(i=hu.makeFromEncoding(d,e))&&void 0!==i?i:d),e.transforms.length>0&&(d=function xKe(e,t,n){var i,r;let s=0;for(const o of t.transforms){let a,l;if(oGe(o))l=e=new s0(e,o),a="derived";else if(_5(o)){const u=dYe(o);l=e=null!==(i=Or.makeWithAncestors(e,{},u,n))&&void 0!==i?i:e,e=new r0(e,t,o.filter)}else if(Boe(o))l=e=hu.makeFromTransform(e,o,t),a="number";else if(lGe(o))a="date",void 0===n.getWithExplicit(o.field).value&&(e=new Or(e,{[o.field]:a}),n.set(o.field,a,!1)),l=e=fu.makeFromTransform(e,o);else if(uGe(o))l=e=el.makeFromTransform(e,o),a="number",T5(t)&&(e=new uf(e));else if(joe(o))l=e=S1.make(e,t,o,s++),a="derived";else if(iGe(o))l=e=new u0(e,o),a="number";else if(rGe(o))l=e=new ip(e,o),a="number";else if(cGe(o))l=e=yc.makeFromTransform(e,o),a="derived";else if(dGe(o))l=e=new Ux(e,o),a="derived";else if(sGe(o))l=e=new Hx(e,o),a="derived";else if(Xqe(o))l=e=new Wx(e,o),a="derived";else if(nGe(o))e=new Yx(e,o);else if(aGe(o))l=e=rp.makeFromTransform(e,o),a="derived";else if(Qqe(o))l=e=new Vx(e,o),a="derived";else if(Zqe(o))l=e=new qx(e,o),a="derived";else if(eGe(o))l=e=new Gx(e,o),a="derived";else{if(!tGe(o)){ce(jHe(o));continue}l=e=new zx(e,o),a="derived"}if(l&&void 0!==a)for(const u of null!==(r=l.producedFields())&&void 0!==r?r:[])n.set(u,a,!1)}return e}(d,e,m));const y=function hYe(e){const t={};if(gi(e)&&e.component.selection)for(const n of oe(e.component.selection)){const i=e.component.selection[n];for(const r of i.project.items)!r.channel&&$m(r.field)>1&&(t[r.field]="flatten")}return t}(e),v=function fYe(e){const t={};function n(i){Jm(i)?t[i.field]="date":"quantitative"===i.type&&function pHe(e){return be(e)&&Dt(["min","max"],e)}(i.aggregate)?t[i.field]="number":$m(i.field)>1?i.field in t||(t[i.field]="flatten"):Qh(i)&&ou(i.sort)&&$m(i.sort.field)>1&&(i.sort.field in t||(t[i.sort.field]="flatten"))}if((gi(e)||nl(e))&&e.forEachFieldDef((i,r)=>{if(Xo(i))n(i);else{const s=zh(r),o=e.fieldDef(s);n(Object.assign(Object.assign({},i),{type:o.type}))}}),gi(e)){const{mark:i,markDef:r,encoding:s}=e;if(Zd(i)&&!e.encoding.order){const a=s["horizontal"===r.orient?"y":"x"];ge(a)&&"quantitative"===a.type&&!(a.field in t)&&(t[a.field]="number")}}return t}(e);d=null!==(r=Or.makeWithAncestors(d,{},Object.assign(Object.assign({},y),v),m))&&void 0!==r?r:d,gi(e)&&(d=d0.parseAll(d,e),d=E1.parseAll(d,e)),(gi(e)||nl(e))&&(_||(d=null!==(s=hu.makeFromEncoding(d,e))&&void 0!==s?s:d),d=null!==(o=fu.makeFromEncoding(d,e))&&void 0!==o?o:d,d=s0.parseAllForSortIndex(d,e));const b=e.getDataName(gn.Raw),D=new ss(d,b,gn.Raw,h);if(f[b]=D,d=D,gi(e)){const N=el.makeFromEncoding(d,e);N&&(d=N,T5(e)&&(d=new uf(d))),d=null!==(a=rp.makeFromEncoding(d,e))&&void 0!==a?a:d,d=null!==(l=yc.makeFromEncoding(d,e))&&void 0!==l?l:d}gi(e)&&(d=null!==(u=C1.make(d,e))&&void 0!==u?u:d);const C=e.getDataName(gn.Main),w=new ss(d,C,gn.Main,h);f[C]=w,d=w,gi(e)&&function aWe(e,t){var n;for(const[i,r]of Vd(null!==(n=e.component.selection)&&void 0!==n?n:{})){const s=e.getName(`lookup_${i}`);e.component.data.outputNodes[s]=r.materialized=new ss(new r0(t,e,{param:i}),s,gn.Lookup,e.component.data.outputNodeRefCounts)}}(e,w);let E=null;if(nl(e)){const N=e.getName("facet");d=null!==(c=function EKe(e,t){const{row:n,column:i}=t;if(n&&i){let r=null;for(const s of[n,i])if(ou(s.sort)){const{field:o,op:a=lx}=s.sort;e=r=new ip(e,{joinaggregate:[{op:a,field:o,as:nB(s,s.sort,{forAs:!0})}],groupby:[_e(s)]})}return r}return null}(d,e.facet))&&void 0!==c?c:d,E=new l0(d,e,N,w.getSource()),f[N]=E}return Object.assign(Object.assign({},e.component.data),{outputNodes:f,outputNodeRefCounts:h,raw:D,main:w,facetRoot:E,ancestorParse:m})}class AKe extends eB{constructor(t,n,i,r){var s,o,a,l;super(t,"concat",n,i,r,t.resolve),("shared"===(null===(o=null===(s=t.resolve)||void 0===s?void 0:s.axis)||void 0===o?void 0:o.x)||"shared"===(null===(l=null===(a=t.resolve)||void 0===a?void 0:a.axis)||void 0===l?void 0:l.y))&&ce("Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415)."),this.children=this.getChildren(t).map((u,c)=>aB(u,this,this.getName(`concat_${c}`),void 0,r))}parseData(){this.component.data=Jx(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of oe(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return Ex(t)?t.vconcat:d5(t)?t.hconcat:t.concat}parseLayoutSize(){!function wKe(e){tB(e);const n=void 0===e.layout.columns?"height":"childHeight";Kx(e,1===e.layout.columns?"width":"childWidth"),Kx(e,n)}(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=L5(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),i=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),i?{style:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup())})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},null!=t?{columns:t}:{}),{bounds:"full",align:"each"})}}const TKe=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},Kse),{labelExpr:1,encode:1}),xle=oe(TKe);class iB extends _c{constructor(t={},n={},i=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=i}clone(){return new iB(it(this.explicit),it(this.implicit),this.mainExtracted)}hasAxisPart(t){return"axis"===t||("grid"===t||"title"===t?!!this.get(t):!function MKe(e){return!1===e||null===e}(this.get(t)))}hasOrientSignalRef(){return Le(this.explicit.orient)}}const kKe={bottom:"top",top:"bottom",left:"right",right:"left"};function RKe(e,t){if(!e)return t.map(n=>n.clone());{if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const r=e[i],s=t[i];if(!!r!=!!s)return;if(r&&s){const o=r.getWithExplicit("orient"),a=s.getWithExplicit("orient");if(o.explicit&&a.explicit&&o.value!==a.value)return;e[i]=FKe(r,s)}}}return e}function FKe(e,t){for(const n of xle){const i=nf(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(r,s)=>{switch(n){case"title":return Bre(r,s);case"gridScale":return{explicit:r.explicit,value:pi(r.value,s.value)}}return Mx(r,s,n,"axis")});e.setWithExplicit(n,i)}return e}function PKe(e,t,n,i,r){if("disable"===t)return void 0!==n;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(Le(n.labelAngle)?n.labelAngle:t1(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===Oae(i,r))return!0}return e===n[t]}const LKe=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function jKe(e,t){var n,i,r;let s=t.axis(e);const o=new iB,a=Mi(t.encoding[e]),{mark:l,config:u}=t,c=(null==s?void 0:s.orient)||(null===(n=u["x"===e?"axisX":"axisY"])||void 0===n?void 0:n.orient)||(null===(i=u.axis)||void 0===i?void 0:i.orient)||function _We(e){return"x"===e?"bottom":"left"}(e),d=t.getScaleComponent(e).get("type"),f=function cWe(e,t,n,i){const r="band"===t?["axisDiscrete","axisBand"]:"point"===t?["axisDiscrete","axisPoint"]:pse(t)?["axisQuantitative"]:"time"===t||"utc"===t?["axisTemporal"]:[],s="x"===e?"axisX":"axisY",o=Le(n)?"axisOrient":`axis${e1(n)}`,a=[...r,...r.map(u=>s+u.substr(4))],l=["axis",o,s];return{vlOnlyAxisConfig:xae(a,i,e,n),vgAxisConfig:xae(l,i,e,n),axisConfigStyle:dWe([...l,...a],i)}}(e,d,c,t.config),h=void 0!==s?!s:k5("disable",u.style,null==s?void 0:s.style,f).configValue;if(o.set("disable",h,void 0!==s),h)return o;s=s||{};const p=function pWe(e,t,n,i,r){const s=null==t?void 0:t.labelAngle;if(void 0!==s)return Le(s)?s:t1(s);{const{configValue:o}=k5("labelAngle",i,null==t?void 0:t.style,r);return void 0!==o?t1(o):n!==Bn||!Dt([Ij,kj],e.type)||ge(e)&&e.timeUnit?void 0:270}}(a,s,e,u.style,f),g={fieldOrDatumDef:a,axis:s,channel:e,model:t,scaleType:d,orient:c,labelAngle:p,mark:l,config:u};for(const y of xle){const v=y in Aae?Aae[y](g):Xse(y)?s[y]:void 0,b=void 0!==v,D=PKe(v,y,s,t,e);if(b&&D)o.set(y,v,D);else{const{configValue:C,configFrom:w}=Xse(y)&&"values"!==y?k5(y,u.style,s.style,f):{},E=void 0!==C;b&&!E?o.set(y,v,D):("vgAxisConfig"!==w||LKe.has(y)&&E||h1(C)||Le(C))&&o.set(y,C,!1)}}const m=null!==(r=s.encoding)&&void 0!==r?r:{},_=Yse.reduce((y,v)=>{var b;if(!o.hasAxisPart(v))return y;const D=Lae(null!==(b=m[v])&&void 0!==b?b:{},t),C="labels"===v?function OKe(e,t,n){var i;const{encoding:r,config:s}=e,o=null!==(i=Mi(r[t]))&&void 0!==i?i:Mi(r[dc(t)]),a=e.axis(t)||{},{format:l,formatType:u}=a;return Xh(u)?Object.assign({text:Uj({fieldOrDatumDef:o,field:"datum.value",format:l,formatType:u,config:s})},n):n}(t,e,D):D;return void 0!==C&&!sn(C)&&(y[v]={update:C}),y},{});return sn(_)||o.set("encode",_,!!s.encoding||void 0!==s.labelAngle),o}const qKe={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Qo(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),Tr("x",e,{defaultPos:"mid"})),Tr("y",e,{defaultPos:"mid"})),af(e,"radius")),af(e,"theta"))},GKe={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Qo(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),Ox("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===e.markDef.orient})),Ox("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===e.markDef.orient})),A5(e))},WKe={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Qo(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),af(e,"x")),af(e,"y"))},YKe={vgMark:"shape",encodeEntry:e=>Object.assign({},Qo(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&ge(n)&&n.type===qm?{field:_e(n,{expr:"datum"})}:{})]}},KKe={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Qo(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),af(e,"x")),af(e,"y")),S5(e,"url"))},JKe={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Qo(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),Tr("x",e,{defaultPos:"mid"})),Tr("y",e,{defaultPos:"mid"})),qi("size",e,{vgChannel:"strokeWidth"})),A5(e))},XKe={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Qo(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),Tr("x",e,{defaultPos:"mid"})),Tr("y",e,{defaultPos:"mid"})),qi("size",e)),A5(e))};function rB(e,t){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Qo(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),Tr("x",e,{defaultPos:"mid"})),Tr("y",e,{defaultPos:"mid"})),qi("size",e)),qi("angle",e)),function QKe(e,t,n){return n?{shape:{value:n}}:qi("shape",e)}(e,0,t))}const ZKe={vgMark:"symbol",encodeEntry:e=>rB(e)},eJe={vgMark:"symbol",encodeEntry:e=>rB(e,"circle")},tJe={vgMark:"symbol",encodeEntry:e=>rB(e,"square")},nJe={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Qo(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),af(e,"x")),af(e,"y"))},iJe={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},Qo(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Ox("x",e,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n})),Ox("y",e,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n})),qi("size",e,{vgChannel:"strokeWidth"})):{}}},rJe={vgMark:"text",encodeEntry:e=>{const{config:t}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Qo(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),Tr("x",e,{defaultPos:"mid"})),Tr("y",e,{defaultPos:"mid"})),S5(e)),qi("size",e,{vgChannel:"fontSize"})),qi("angle",e)),lae("align",function sJe(e,t,n){if(void 0===Kt("align",e,n))return"center"}(e.markDef,0,t))),lae("baseline",function oJe(e,t,n){if(void 0===Kt("baseline",e,n))return"middle"}(e.markDef,0,t))),Tr("radius",e,{defaultPos:null})),Tr("theta",e,{defaultPos:null}))}},aJe={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r="horizontal"===i?"width":"height",s="horizontal"===i?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Qo(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Tr("x",e,{defaultPos:"mid",vgChannel:"xc"})),Tr("y",e,{defaultPos:"mid",vgChannel:"yc"})),qi("size",e,{defaultValue:lJe(e),vgChannel:r})),{[s]:En(Kt("thickness",n,t))})}};function lJe(e){var t;const{config:n,markDef:i}=e,{orient:r}=i,s="horizontal"===r?"width":"height",o=e.getScaleComponent("horizontal"===r?"x":"y"),a=null!==(t=Kt("size",i,n,{vgChannel:s}))&&void 0!==t?t:n.tick.bandSize;if(void 0!==a)return a;{const l=o?o.get("range"):void 0;return l&&Xd(l)&&nn(l.step)?3*l.step/4:3*Sx(n.view,s)/4}}const Xx={arc:qKe,area:GKe,bar:WKe,circle:eJe,geoshape:YKe,image:KKe,line:JKe,point:ZKe,rect:nJe,rule:iJe,square:tJe,text:rJe,tick:aJe,trail:XKe};const Ale="faceted_path_",Mle="stack_group_";function sB(e,t={fromPrefix:""}){const{mark:n,markDef:i,encoding:r,config:s}=e,o=pi(i.clip,function hJe(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return!(!(null==t?void 0:t.get("selectionExtent"))&&!(null==n?void 0:n.get("selectionExtent")))||void 0}(e),function pJe(e){const t=e.component.projection;return!(!t||t.isFit)||void 0}(e)),a=Rre(i),l=r.key,u=function fJe(e){var t;const{encoding:n,stack:i,mark:r,markDef:s,config:o}=e,a=n.order;if(!(!ie(a)&&Za(a)&&ZL(a.value)||!a&&ZL(Kt("order",s,o)))){if((ie(a)||ge(a))&&!i)return Pre(a,{expr:"datum"});if(Zd(r)){const l="horizontal"===s.orient?"y":"x",u=n[l];if(ge(u)){const c=u.sort;return ie(c)?{field:_e(u,{prefix:l,suffix:"sort_index",expr:"datum"})}:ou(c)?{field:_e({aggregate:Qj(e.encoding)?c.op:void 0,field:c.field},{expr:"datum"})}:Rse(c)?{field:_e(e.fieldDef(c.encoding),{expr:"datum"}),order:c.order}:null===c?void 0:{field:_e(u,{binSuffix:(null===(t=e.stack)||void 0===t?void 0:t.impute)?"mid":void 0,expr:"datum"})}}return}}}(e),c=function gJe(e){if(!e.component.selection)return null;const t=oe(e.component.selection).length;let n=t,i=e.parent;for(;i&&0===n;)n=oe(i.component.selection).length,i=i.parent;return n?{interactive:t>0||!!e.encoding.tooltip}:null}(e),d=Kt("aria",i,s),f=Xx[n].postEncodingTransform?Xx[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:Xx[n].vgMark},o?{clip:!0}:{}),a?{style:a}:{}),l?{key:l.field}:{}),u?{sort:u}:{}),c||{}),!1===d?{aria:d}:{}),{from:{data:t.fromPrefix+e.requestDataName(gn.Main)},encode:{update:Xx[n].encodeEntry(e)}}),f?{transform:f}:{})]}class Tle extends wle{constructor(t,n,i,r={},s){var o;super(t,"unit",n,i,s,void 0,woe(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const a=Qa(t.mark)?Object.assign({},t.mark):{type:t.mark},l=a.type;void 0===a.filled&&(a.filled=function UKe(e,t,{graticule:n}){if(n)return!1;const i=Gh("filled",e,t),r=e.type;return pi(i,r!==rx&&r!==ix&&r!==sx)}(a,s,{graticule:t.data&&b5(t.data)}));const u=this.encoding=function Wze(e,t,n,i){const r={};for(const s of oe(e))wre(s)||ce(JHe(s));for(let s of nHe){if(!e[s])continue;const o=e[s];if(Um(s)){const a=Ere(s),l=r[a];if(ge(l)){if(KUe(l.type)&&ge(o)){ce(HHe(a));continue}}else s=a,ce(UHe(a))}if("angle"===s&&"arc"===t&&!e.theta&&(ce("Arc marks uses theta channel rather than angle, replacing angle with theta."),s=Ka),Gze(e,s,t)){if(s===uc&&"line"===t){const a=uu(e[s]);if(null==a?void 0:a.aggregate){ce("Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.");continue}}if(s===xs&&(n?"fill"in e:"stroke"in e))ce(Kre("encoding",{fill:"fill"in e,stroke:"stroke"in e}));else if(s===s1||s===r1&&!ie(o)&&!Za(o)||s===Uh&&ie(o))o&&(r[s]=we(o).reduce((a,l)=>(ge(l)?a.push(Jj(l,s)):ce(yj(l,s)),a),[]));else{if(s===Uh&&null===o)r[s]=null;else if(!(ge(o)||au(o)||Za(o)||cx(o)||Le(o))){ce(yj(o,s));continue}r[s]=qse(o,s,i)}}else ce(QS(s,t))}return r}(t.encoding||{},l,a.filled,s);this.markDef=function $Ke(e,t,n){const i=Ts(e),r=Kt("orient",i,n);if(i.orient=function zKe(e,t,n){switch(e){case rx:case Lj:case jj:case vse:case dze:case cze:return}const{x:i,y:r,x2:s,y2:o}=t;switch(e){case nx:if(ge(i)&&(is(i.bin)||ge(r)&&r.aggregate&&!i.aggregate))return"vertical";if(ge(r)&&(is(r.bin)||ge(i)&&i.aggregate&&!r.aggregate))return"horizontal";if(o||s){if(n)return n;if(!s&&(ge(i)&&i.type===Kh&&!vn(i.bin)||hx(i)))return"horizontal";if(!o&&(ge(r)&&r.type===Kh&&!vn(r.bin)||hx(r)))return"vertical"}case sx:if(s&&(!ge(i)||!is(i.bin))&&o&&(!ge(r)||!is(r.bin)))return;case tx:if(o)return ge(r)&&is(r.bin)?"horizontal":"vertical";if(s)return ge(i)&&is(i.bin)?"vertical":"horizontal";if(e===sx){if(i&&!r)return"vertical";if(r&&!i)return"horizontal"}case ix:case Pj:{const a=lu(i),l=lu(r);if(n)return n;if(a&&!l)return"tick"!==e?"horizontal":"vertical";if(!a&&l)return"tick"!==e?"vertical":"horizontal";if(a&&l){const u=i,c=r,d=u.type===zm,f=c.type===zm;return d&&!f?"tick"!==e?"vertical":"horizontal":!d&&f?"tick"!==e?"horizontal":"vertical":!u.aggregate&&c.aggregate?"tick"!==e?"vertical":"horizontal":u.aggregate&&!c.aggregate&&"tick"!==e?"horizontal":"vertical"}return}}return"vertical"}(i.type,t,r),void 0!==r&&r!==i.orient&&ce(function nUe(e,t){return`Specified orient "${e}" overridden with "${t}".`}(i.orient,r)),"bar"===i.type&&i.orient){const a=Kt("cornerRadiusEnd",i,n);if(void 0!==a){const l="horizontal"===i.orient&&t.x2||"vertical"===i.orient&&t.y2?["cornerRadius"]:yze[i.orient];for(const u of l)i[u]=a;void 0!==i.cornerRadiusEnd&&delete i.cornerRadiusEnd}}return void 0===Kt("opacity",i,n)&&(i.opacity=function HKe(e,t){if(Dt([rx,Pj,Lj,jj],e)&&!Qj(t))return.7}(i.type,t)),void 0===Kt("cursor",i,n)&&(i.cursor=function VKe(e,t,n){return t.href||e.href||Kt("href",e,n)?"pointer":e.cursor}(i,t,n)),i}(a,u,s),this.size=function BKe({encoding:e,size:t}){for(const n of iu){const i=Ms(n);cu(t[i])&&lu(e[n])&&(delete t[i],ce(Xre(i)))}return t}({encoding:u,size:woe(t)?Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):r}),this.stack=Toe(l,u),this.specifiedScales=this.initScales(l,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegends(u),this.specifiedProjection=t.projection,this.selection=(null!==(o=t.params)&&void 0!==o?o:[]).filter(c=>u5(c))}get hasProjection(){const{encoding:t}=this,n=this.mark===bse,i=t&&X9e.some(r=>Je(t[r]));return n||i}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return KS.reduce((i,r)=>{var s;const o=Mi(n[r]);return o&&(i[r]=this.initScale(null!==(s=o.scale)&&void 0!==s?s:{})),i},{})}initScale(t){const{domain:n,range:i}=t,r=Ts(t);return ie(n)&&(r.domain=n.map(fo)),ie(i)&&(r.range=i.map(fo)),r}initAxes(t){return iu.reduce((n,i)=>{const r=t[i];if(Je(r)||i===Bn&&Je(t.x2)||i===Ui&&Je(t.y2)){const s=Je(r)?r.axis:void 0;n[i]=s&&this.initAxis(Object.assign({},s))}return n},{})}initAxis(t){const n=oe(t),i={};for(const r of n){const s=t[r];i[r]=h1(s)?Nre(s):fo(s)}return i}initLegends(t){return sHe.reduce((n,i)=>{const r=Mi(t[i]);if(r&&function aHe(e){switch(e){case xs:case tu:case nu:case uc:case As:case cc:case qd:case Gd:return!0;case Ud:case zd:case Hh:return!1}}(i)){const s=r.legend;n[i]=s&&Ts(s)}return n},{})}parseData(){this.component.data=Jx(this)}parseLayoutSize(){!function DKe(e){const{size:t,component:n}=e;for(const i of iu){const r=Ms(i);if(t[r]){const s=t[r];n.layoutSize.set(r,cu(s)?"step":s,!0)}else{const s=CKe(e,r);n.layoutSize.set(r,s,!1)}}}(this)}parseSelections(){this.component.selection=function oWe(e,t){var n;const i={},r=e.config.selection;if(!t||!t.length)return i;for(const s of t){const o=Fn(s.name),a=s.select,l=be(a)?a:a.type,u=Se(a)?it(a):{type:l},c=r[l];for(const f in c)"fields"===f||"encodings"===f||("mark"===f&&(u[f]=Object.assign(Object.assign({},c[f]),u[f])),(void 0===u[f]||!0===u[f])&&(u[f]=null!==(n=c[f])&&void 0!==n?n:u[f]));const d=i[o]=Object.assign(Object.assign({},u),{name:o,type:l,init:s.value,bind:s.bind,events:be(u.on)?Bd(u.on,"scope"):we(it(u.on))});for(const f of Ix)f.defined(d)&&f.parse&&f.parse(e,d,s)}return i}(this,this.selection)}parseMarkGroup(){this.component.mark=function uJe(e){if(Dt([ix,tx,fze],e.mark)){const t=toe(e.mark,e.encoding);if(t.length>0)return function cJe(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:Ale+e.requestDataName(gn.Main),data:e.requestDataName(gn.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:sB(e,{fromPrefix:Ale})}]}(e,t)}else if(e.mark===nx){const t=pj.some(n=>Kt(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return function dJe(e){var t;const[n]=sB(e,{fromPrefix:Mle}),i=e.scaleName(e.stack.fieldChannel),r=(c={})=>e.vgField(e.stack.fieldChannel,c),s=(c,d)=>`${c}(${[r({prefix:"min",suffix:"start",expr:d}),r({prefix:"max",suffix:"start",expr:d}),r({prefix:"min",suffix:"end",expr:d}),r({prefix:"max",suffix:"end",expr:d})].map(h=>`scale('${i}',${h})`).join(",")})`;let o,a;"x"===e.stack.fieldChannel?(o=Object.assign(Object.assign({},Bm(n.encode.update,["y","yc","y2","height",...pj])),{x:{signal:s("min","datum")},x2:{signal:s("max","datum")},clip:{value:!0}}),a={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},n.encode.update=Object.assign(Object.assign({},co(n.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(o=Object.assign(Object.assign({},Bm(n.encode.update,["x","xc","x2","width"])),{y:{signal:s("min","datum")},y2:{signal:s("max","datum")},clip:{value:!0}}),a={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},n.encode.update=Object.assign(Object.assign({},co(n.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const c of pj){const d=Gh(c,e.markDef,e.config);n.encode.update[c]?(o[c]=n.encode.update[c],delete n.encode.update[c]):d&&(o[c]=En(d)),d&&(n.encode.update[c]={value:0})}const l=[];if((null===(t=e.stack.groupbyChannels)||void 0===t?void 0:t.length)>0)for(const c of e.stack.groupbyChannels){const d=e.fieldDef(c),f=_e(d);f&&l.push(f),((null==d?void 0:d.bin)||(null==d?void 0:d.timeUnit))&&l.push(_e(d,{binSuffix:"end"}))}return o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((c,d)=>{if(n.encode.update[d])return Object.assign(Object.assign({},c),{[d]:n.encode.update[d]});{const f=Gh(d,e.markDef,e.config);return void 0!==f?Object.assign(Object.assign({},c),{[d]:En(f)}):c}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(gn.Main),name:Mle+e.requestDataName(gn.Main),groupby:l,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:a},marks:[n]}]}]}(e)}return sB(e)}(this)}parseAxesAndHeaders(){this.component.axes=function NKe(e){return iu.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[jKe(n,e)]),t),{})}(this)}assembleSelectionTopLevelSignals(t){return function xGe(e,t){var n;let i=!1;for(const r of Ar(null!==(n=e.component.selection)&&void 0!==n?n:{})){const s=r.name,o=pe(s+ep);if(0===t.filter(l=>l.name===s).length){const u="point"===r.type?", true, true)":")";t.push({name:r.name,update:`${vae}(${o}, ${pe("global"===r.resolve?"union":r.resolve)}${u}`})}i=!0;for(const l of Ix)l.defined(r)&&l.topLevelSignals&&(t=l.topLevelSignals(e,r,t))}return i&&0===t.filter(s=>"unit"===s.name).length&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),w5(t)}(this,t)}assembleSignals(){return[...Sae(this),...EGe(this,[])]}assembleSelectionData(t){return function AGe(e,t){var n;const i=[...t];for(const r of Ar(null!==(n=e.component.selection)&&void 0!==n?n:{})){const s={name:r.name+ep};if(r.init){const a=r.project.items.map(l=>CGe(l,["signals"]));s.values=r.init.map(l=>({unit:n0(e,{escape:!1}),fields:a,values:Zm(l,!1)}))}i.filter(a=>a.name===r.name+ep).length||i.push(s)}return i}(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return L5(this)}assembleMarks(){var t;let n=null!==(t=this.component.mark)&&void 0!==t?t:[];return(!this.parent||!c0(this.parent))&&(n=Xoe(this,n)),n.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};return void 0!==t?t:this.encoding.x||this.encoding.y?"cell":void 0}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return Zh(this.encoding,t)}fieldDef(t){return uu(this.encoding[t])}typedFieldDef(t){const n=this.fieldDef(t);return Xo(n)?n:null}}class oB extends eB{constructor(t,n,i,r,s){super(t,"layer",n,i,s,t.resolve,t.view);const o=Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((a,l)=>{if(Ax(a))return new oB(a,this,this.getName(`layer_${l}`),o,s);if(gc(a))return new Tle(a,this,this.getName(`layer_${l}`),o,s);throw new Error(mj(a))})}parseData(){this.component.data=Jx(this);for(const t of this.children)t.parseData()}parseLayoutSize(){!function bKe(e){tB(e),Kx(e,"width"),Kx(e,"height")}(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of oe(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){!function IKe(e){var t;const{axes:n,resolve:i}=e.component,r={top:0,bottom:0,right:0,left:0};for(const s of e.children){s.parseAxesAndHeaders();for(const o of oe(s.component.axes))i.axis[o]=j5(e.component.resolve,o),"shared"===i.axis[o]&&(n[o]=RKe(n[o],s.component.axes[o]),n[o]||(i.axis[o]="independent",delete n[o]))}for(const s of iu){for(const o of e.children)if(o.component.axes[s]){if("independent"===i.axis[s]){n[s]=(null!==(t=n[s])&&void 0!==t?t:[]).concat(o.component.axes[s]);for(const a of o.component.axes[s]){const{value:l,explicit:u}=a.getWithExplicit("orient");if(!Le(l)){if(r[l]>0&&!u){const c=kKe[l];r[l]>r[c]&&a.set("orient",c,!1)}r[l]++}}}delete o.component.axes[s]}if("independent"===i.axis[s]&&n[s]&&n[s].length>1)for(const o of n[s])o.get("grid")&&!o.explicit.grid&&(o.implicit.grid=!1)}}(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),Sae(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),L5(this))}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const i of this.children)for(const r of we(i.assembleGroupStyle()))t.add(r);const n=Array.from(t);return n.length>1?n:1===n.length?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return function MGe(e,t){for(const n of e.children)gi(n)&&(t=Xoe(n,t));return t}(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),Yae(this))}}function aB(e,t,n,i,r){if(ux(e))return new x1(e,t,n,r);if(Ax(e))return new oB(e,t,n,i,r);if(gc(e))return new Tle(e,t,n,i,r);if(function mqe(e){return Ex(e)||d5(e)||c5(e)}(e))return new AKe(e,t,n,r);throw new Error(mj(e))}function _Je(e,t={}){t.logger&&function TUe(e){ru=e}(t.logger),t.fieldTitle&&zse(t.fieldTitle);try{const n=Aoe(Mg(t.config,e.config)),i=zoe(e,n),r=aB(i,null,"",void 0,n);return r.parse(),function TYe(e,t){G5(e.sources);let n=0,i=0;for(let r=0;r<5&&ile(e,t,!0);r++)n++;e.sources.map(z5);for(let r=0;r<5&&ile(e,t,!1);r++)i++;G5(e.sources),5===Math.max(n,i)&&ce("Maximum optimization runs(5) reached.")}(r.component.data,r),{spec:vJe(r,yJe(e,i.autosize,n,r),e.datasets,e.usermeta),normalized:i}}finally{t.logger&&function nse(){return ru=tse,ru}(),t.fieldTitle&&function Bze(){zse(Hse)}()}}function yJe(e,t,n,i){const r=i.component.layoutSize.get("width"),s=i.component.layoutSize.get("height");if(void 0===t?(t={type:"pad"},i.hasAxisOrientSignalRef()&&(t.resize=!0)):be(t)&&(t={type:t}),r&&s&&function vGe(e){return"fit"===e||"fit-x"===e||"fit-y"===e}(t.type))if("step"===r&&"step"===s)ce(Hre()),t.type="pad";else if("step"===r||"step"===s){const o="step"===r?"width":"height";ce(Hre(YS(o))),t.type=function bGe(e){return e?`fit-${YS(e)}`:"fit"}("width"===o?"height":"width")}return Object.assign(Object.assign(Object.assign({},1===oe(t).length&&t.type?"pad"===t.type?{}:{autosize:t.type}:{autosize:t}),Goe(n,!1)),Goe(e,!0))}function vJe(e,t,n={},i){const r=e.config?function Oqe(e){e=it(e);for(const t of Mqe)delete e[t];if(e.axis)for(const t in e.axis)h1(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of cqe)delete e.legend[t];if(e.mark){for(const t of Cse)delete e.mark[t];e.mark.tooltip&&Se(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(voe(e.params)),delete e.params);for(const t of Aqe){for(const i of Cse)delete e[t][i];const n=Tqe[t];if(n)for(const i of n)delete e[t][i];kqe(e,t)}for(const t of function uqe(){return oe(s5)}())delete e[t];!function Nqe(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=Ore(e.title);sn(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),sn(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),sn(i)?delete e.title:e.title=i}(e);for(const t in e)Se(e[t])&&sn(e[t])&&delete e[t];return sn(e)?void 0:e}(e.config):void 0,s=[].concat(e.assembleSelectionData([]),function mKe(e,t){var n,i;const r=[],s=Dle(r);let o=0;for(const l of e.sources){l.hasName()||(l.dataName="source_"+o++);const u=l.assemble();s(l,u)}for(const l of r)0===l.transform.length&&delete l.transform;let a=0;for(const[l,u]of r.entries())0===(null!==(n=u.transform)&&void 0!==n?n:[]).length&&!u.source&&r.splice(a++,0,r.splice(l,1)[0]);for(const l of r)for(const u of null!==(i=l.transform)&&void 0!==i?i:[])"lookup"===u.type&&(u.from=e.outputNodes[u.from].getSource());for(const l of r)l.name in t&&(l.values=t[l.name]);return r}(e.component.data,n)),o=e.assembleProjections(),a=e.assembleTitle(),l=e.assembleGroupStyle(),u=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter(h=>"width"!==h.name&&"height"!==h.name||void 0===h.value||(t[h.name]=+h.value,!1));const{params:d}=t,f=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(t,["params"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),f),a?{title:a}:{}),l?{style:l}:{}),u?{encode:{update:u}}:{}),{data:s}),o.length>0?{projections:o}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...voe(d)])),r?{config:r}:{}),i?{usermeta:i}:{})}const bJe="5.2.0",Ole=function wJe(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}},f0="#fff",$Je={background:"#333",title:{color:f0,subtitleColor:f0},style:{"guide-label":{fill:f0},"guide-title":{fill:f0}},axis:{domainColor:f0,gridColor:"#888",tickColor:f0}},sp="#4572a7",VJe={background:"#fff",arc:{fill:sp},area:{fill:sp},line:{stroke:sp,strokeWidth:2},path:{stroke:sp},rect:{fill:sp},shape:{stroke:sp},symbol:{fill:sp,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},op="#30a2da",lB="#cbcbcb",zJe={arc:{fill:op},area:{fill:op},axis:{domainColor:lB,grid:!0,gridColor:lB,gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:lB,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:"#f0f0f0",group:{fill:"#f0f0f0"},legend:{labelColor:"#333",labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:"#333",titleFontSize:14,titlePadding:10},line:{stroke:op,strokeWidth:2},path:{stroke:op,strokeWidth:.5},rect:{fill:op},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:op},bar:{binSpacing:2,fill:op,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},ap="#000",qJe={group:{fill:"#e5e5e5"},arc:{fill:ap},area:{fill:ap},line:{stroke:ap},path:{stroke:ap},rect:{fill:ap},shape:{stroke:ap},symbol:{fill:ap,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},Ile="Benton Gothic, sans-serif",lp="#82c6df",uB="Benton Gothic Bold, sans-serif",A1={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},KJe={background:"#ffffff",title:{anchor:"start",color:"#000000",font:uB,fontSize:22,fontWeight:"normal"},arc:{fill:lp},area:{fill:lp},line:{stroke:lp,strokeWidth:2},path:{stroke:lp},rect:{fill:lp},shape:{stroke:lp},symbol:{fill:lp,size:30},axis:{labelFont:Ile,labelFontSize:11.5,labelFontWeight:"normal",titleFont:uB,titleFontSize:13,titleFontWeight:"normal"},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:Ile,labelFontSize:11.5,symbolType:"square",titleFont:uB,titleFontSize:13,titleFontWeight:"normal"},range:{category:A1["category-6"],diverging:A1["fireandice-6"],heatmap:A1["fire-7"],ordinal:A1["fire-7"],ramp:A1["fire-7"]}},up="#ab5787",Qx="#979797",JJe={background:"#f9f9f9",arc:{fill:up},area:{fill:up},line:{stroke:up},path:{stroke:up},rect:{fill:up},shape:{stroke:up},symbol:{fill:up,size:30},axis:{domainColor:Qx,domainWidth:.5,gridWidth:.2,labelColor:Qx,tickColor:Qx,tickWidth:.2,titleColor:Qx},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},cp="#3e5c69",XJe={background:"#fff",arc:{fill:cp},area:{fill:cp},line:{stroke:cp},path:{stroke:cp},rect:{fill:cp},shape:{stroke:cp},symbol:{fill:cp},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Zo="#1696d2",Zx="Lato",cB="Lato",M1={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},nXe={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:Zx},axisX:{domain:!0,domainColor:"#000000",domainWidth:1,grid:!1,labelFontSize:12,labelFont:cB,labelAngle:0,tickColor:"#000000",tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Zx},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:cB,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Zx,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:cB,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Zx,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:M1["six-groups-cat-1"],diverging:M1["diverging-colors"],heatmap:M1["diverging-colors"],ordinal:M1["six-groups-seq"],ramp:M1["shades-blue"]},area:{fill:Zo},rect:{fill:Zo},line:{color:Zo,stroke:Zo,strokeWidth:5},trail:{color:Zo,stroke:Zo,strokeWidth:0,size:1},path:{stroke:Zo,strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:Zo,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Zo,stroke:null}},arc:{fill:Zo},shape:{stroke:Zo},symbol:{fill:Zo,size:30}},dp="#3366CC",eA="Arial, sans-serif",iXe={arc:{fill:dp},area:{fill:dp},path:{stroke:dp},rect:{fill:dp},shape:{stroke:dp},symbol:{stroke:dp},circle:{fill:dp},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:eA,fontSize:12},"guide-title":{font:eA,fontSize:12},"group-title":{font:eA,fontSize:12}},title:{font:eA,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:"#ccc",tickColor:"#ccc",domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},rXe="2.10.0";function Ble(e,t){return JSON.stringify(e,function AXe(e){const t=[];return function(n,i){if("object"!=typeof i||null===i)return i;const r=t.indexOf(this)+1;return t.length=r,t.length>e?"[Object]":t.indexOf(i)>=0?"[Circular]":(t.push(i),i)}}(t))}const $le="vg-tooltip-element",TXe={offsetX:10,offsetY:10,id:$le,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function OXe(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2,formatTooltip:function xXe(e,t,n){if(ie(e))return`[${e.map(i=>t(be(i)?i:Ble(i,n))).join(", ")}]`;if(Se(e)){let i="";const r=e,{title:s,image:o}=r,a=function SXe(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(r,["title","image"]);s&&(i+=`<h2>${t(s)}</h2>`),o&&(i+=`<img src="${t(o)}">`);const l=Object.keys(a);if(l.length>0){i+="<table>";for(const u of l){let c=a[u];void 0!==c&&(Se(c)&&(c=Ble(c,n)),i+=`<tr><td class="key">${t(u)}:</td><td class="value">${t(c)}</td></tr>`)}i+="</table>"}return i||"{}"}return t(e)}};class Vle{constructor(t){this.options=Object.assign(Object.assign({},TXe),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const i=document.createElement("style");i.setAttribute("id",this.options.styleId),i.innerHTML=function NXe(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return"#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black;\n}\n#vg-tooltip-element.visible {\n  visibility: visible;\n}\n#vg-tooltip-element h2 {\n  margin-top: 0;\n  margin-bottom: 10px;\n  font-size: 13px;\n}\n#vg-tooltip-element img {\n  max-width: 200px;\n  max-height: 200px;\n}\n#vg-tooltip-element table {\n  border-spacing: 0;\n}\n#vg-tooltip-element table tr {\n  border: none;\n}\n#vg-tooltip-element table tr td {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-top: 2px;\n  padding-bottom: 2px;\n}\n#vg-tooltip-element table tr td.key {\n  color: #808080;\n  max-width: 150px;\n  text-align: right;\n  padding-right: 4px;\n}\n#vg-tooltip-element table tr td.value {\n  display: block;\n  max-width: 300px;\n  max-height: 7em;\n  text-align: left;\n}\n#vg-tooltip-element.dark-theme {\n  background-color: rgba(32, 32, 32, 0.9);\n  border: 1px solid #f5f5f5;\n  color: white;\n}\n#vg-tooltip-element.dark-theme td.key {\n  color: #bfbfbf;\n}\n".toString().replace($le,e)}(n);const r=document.head;r.childNodes.length>0?r.insertBefore(i,r.childNodes[0]):r.appendChild(i)}}tooltipHandler(t,n,i,r){var s;if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),(null!==(s=document.fullscreenElement)&&void 0!==s?s:document.body).appendChild(this.el)),null==r||""===r)return void this.el.classList.remove("visible",`${this.options.theme}-theme`);this.el.innerHTML=this.options.formatTooltip(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:o,y:a}=function kXe(e,t,n,i){let r=e.clientX+n;r+t.width>window.innerWidth&&(r=+e.clientX-n-t.width);let s=e.clientY+i;return s+t.height>window.innerHeight&&(s=+e.clientY-i-t.height),{x:r,y:s}}(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${a}px; left: ${o}px`)}}function IXe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hle(e,t,n,i,r,s,o){try{var a=e[s](o),l=a.value}catch(u){return void n(u)}a.done?t(l):Promise.resolve(l).then(i,r)}function tA(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var s=e.apply(t,n);function o(l){Hle(s,i,r,o,a,"next",l)}function a(l){Hle(s,i,r,o,a,"throw",l)}o(void 0)})}}var pu,Ule=Object.prototype,fp=Ule.hasOwnProperty,dB="function"==typeof Symbol?Symbol:{},nA=dB.iterator||"@@iterator",RXe=dB.asyncIterator||"@@asyncIterator",iA=dB.toStringTag||"@@toStringTag";function zle(e,t,n,i){var s=Object.create((t&&t.prototype instanceof hB?t:hB).prototype),o=new _B(i||[]);return s._invoke=function BXe(e,t,n){var i=qle;return function(s,o){if(i===Gle)throw new Error("Generator is already running");if(i===rA){if("throw"===s)throw o;return Jle()}for(n.method=s,n.arg=o;;){var a=n.delegate;if(a){var l=Kle(a,n);if(l){if(l===il)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===qle)throw i=rA,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=Gle;var u=fB(e,t,n);if("normal"===u.type){if(i=n.done?rA:FXe,u.arg===il)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=rA,n.method="throw",n.arg=u.arg)}}}(e,n,o),s}function fB(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(i){return{type:"throw",arg:i}}}var qle="suspendedStart",FXe="suspendedYield",Gle="executing",rA="completed",il={};function hB(){}function sA(){}function h0(){}var pB={};pB[nA]=function(){return this};var gB=Object.getPrototypeOf,oA=gB&&gB(gB(yB([])));oA&&oA!==Ule&&fp.call(oA,nA)&&(pB=oA);var p0=h0.prototype=hB.prototype=Object.create(pB);function Wle(e){["next","throw","return"].forEach(function(t){e[t]=function(n){return this._invoke(t,n)}})}function Yle(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===sA||"GeneratorFunction"===(t.displayName||t.name))}function aA(e,t){function n(s,o,a,l){var u=fB(e[s],e,o);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==typeof d&&fp.call(d,"__await")?t.resolve(d.__await).then(function(f){n("next",f,a,l)},function(f){n("throw",f,a,l)}):t.resolve(d).then(function(f){c.value=f,a(c)},function(f){return n("throw",f,a,l)})}l(u.arg)}var i;this._invoke=function r(s,o){function a(){return new t(function(l,u){n(s,o,l,u)})}return i=i?i.then(a,a):a()}}function Kle(e,t){var n=e.iterator[t.method];if(n===pu){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=pu,Kle(e,t),"throw"===t.method))return il;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return il}var i=fB(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,il;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=pu),t.delegate=null,il):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,il)}function $Xe(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function mB(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _B(e){this.tryEntries=[{tryLoc:"root"}],e.forEach($Xe,this),this.reset(!0)}function yB(e){if(e){var t=e[nA];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(fp.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=pu,r.done=!0,r};return i.next=i}}return{next:Jle}}function Jle(){return{value:pu,done:!0}}sA.prototype=p0.constructor=h0,h0.constructor=sA,h0[iA]=sA.displayName="GeneratorFunction",Wle(aA.prototype),aA.prototype[RXe]=function(){return this},Wle(p0),p0[iA]="Generator",p0[nA]=function(){return this},p0.toString=function(){return"[object Generator]"},_B.prototype={constructor:_B,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=pu,this.done=!1,this.delegate=null,this.method="next",this.arg=pu,this.tryEntries.forEach(mB),!t)for(var n in this)"t"===n.charAt(0)&&fp.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=pu)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(u,c){return o.type="throw",o.arg=t,n.next=u,c&&(n.method="next",n.arg=pu),!!c}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var a=fp.call(s,"catchLoc"),l=fp.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,n){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&fp.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=n&&n<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=n,s?(this.method="next",this.next=s.finallyLoc,il):this.complete(o)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),il},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),mB(i),il}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc===t){var r=i.completion;if("throw"===r.type){var s=r.arg;mB(i)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:yB(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=pu),il}};var gu={wrap:zle,isGeneratorFunction:Yle,AsyncIterator:aA,mark:function PXe(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h0):(e.__proto__=h0,iA in e||(e[iA]="GeneratorFunction")),e.prototype=Object.create(p0),e},awrap:function LXe(e){return{__await:e}},async:function jXe(e,t,n,i,r){void 0===r&&(r=Promise);var s=new aA(zle(e,t,n,i),r);return Yle(t)?s:s.next().then(function(o){return o.done?o.value:s.next()})},keys:function VXe(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function i(){for(;t.length;){var r=t.pop();if(r in e)return i.value=r,i.done=!1,i}return i.done=!0,i}},values:yB},HXe=jt;function jt(e){var t=this;if(t instanceof jt||(t=new jt),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach(function(r){t.push(r)});else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);return t}function UXe(e,t,n){var i=t===e.head?new hp(n,null,t,e):new hp(n,t,t.next,e);return null===i.next&&(e.tail=i),null===i.prev&&(e.head=i),e.length++,i}function zXe(e,t){e.tail=new hp(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function qXe(e,t){e.head=new hp(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function hp(e,t,n,i){if(!(this instanceof hp))return new hp(e,t,n,i);this.list=i,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}jt.Node=hp,jt.create=jt,jt.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},jt.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},jt.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},jt.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)zXe(this,arguments[e]);return this.length},jt.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)qXe(this,arguments[e]);return this.length},jt.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},jt.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},jt.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,i=0;null!==n;i++)e.call(t,n.value,i,this),n=n.next},jt.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,i=this.length-1;null!==n;i--)e.call(t,n.value,i,this),n=n.prev},jt.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},jt.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},jt.prototype.map=function(e,t){t=t||this;for(var n=new jt,i=this.head;null!==i;)n.push(e.call(t,i.value,this)),i=i.next;return n},jt.prototype.mapReverse=function(e,t){t=t||this;for(var n=new jt,i=this.tail;null!==i;)n.push(e.call(t,i.value,this)),i=i.prev;return n},jt.prototype.reduce=function(e,t){var n,i=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");i=this.head.next,n=this.head.value}for(var r=0;null!==i;r++)n=e(n,i.value,r),i=i.next;return n},jt.prototype.reduceReverse=function(e,t){var n,i=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");i=this.tail.prev,n=this.tail.value}for(var r=this.length-1;null!==i;r--)n=e(n,i.value,r),i=i.prev;return n},jt.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},jt.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},jt.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new jt;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,r=this.head;null!==r&&i<e;i++)r=r.next;for(;null!==r&&i<t;i++,r=r.next)n.push(r.value);return n},jt.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new jt;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,r=this.tail;null!==r&&i>t;i--)r=r.prev;for(;null!==r&&i>e;i--,r=r.prev)n.push(r.value);return n},jt.prototype.splice=function(e,t){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,i=this.head;null!==i&&n<e;n++)i=i.next;var r=[];for(n=0;i&&n<t;n++)r.push(i.value),i=this.removeNode(i);for(null===i&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev),n=0;n<(arguments.length<=2?0:arguments.length-2);n++)i=UXe(this,i,n+2<2||arguments.length<=n+2?void 0:arguments[n+2]);return r},jt.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var i=n.prev;n.prev=n.next,n.next=i}return this.head=t,this.tail=e,this};try{jt.prototype[Symbol.iterator]=gu.mark(function e(){var t;return gu.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:t=this.head;case 1:if(!t){i.next=7;break}return i.next=4,t.value;case 4:t=t.next,i.next=1;break;case 7:case"end":return i.stop()}},e,this)})}catch(e){}var GXe=HXe,pp=Symbol("max"),vc=Symbol("length"),g0=Symbol("lengthCalculator"),T1=Symbol("allowStale"),gp=Symbol("maxAge"),bc=Symbol("dispose"),Xle=Symbol("noDisposeOnSet"),Gi=Symbol("lruList"),rl=Symbol("cache"),Qle=Symbol("updateAgeOnGet"),vB=()=>1,bB=(e,t,n)=>{var i=e[rl].get(t);if(i){var r=i.value;if(lA(e,r)){if(m0(e,i),!e[T1])return}else n&&(e[Qle]&&(i.value.now=Date.now()),e[Gi].unshiftNode(i));return r.value}},lA=(e,t)=>{if(!t||!t.maxAge&&!e[gp])return!1;var n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[gp]&&n>e[gp]},O1=e=>{if(e[vc]>e[pp])for(var t=e[Gi].tail;e[vc]>e[pp]&&null!==t;){var n=t.prev;m0(e,t),t=n}},m0=(e,t)=>{if(t){var n=t.value;e[bc]&&e[bc](n.key,n.value),e[vc]-=n.length,e[rl].delete(n.key),e[Gi].removeNode(t)}};class YXe{constructor(t,n,i,r,s){this.key=t,this.value=n,this.length=i,this.now=r,this.maxAge=s||0}}var Zle=(e,t,n,i)=>{var r=n.value;lA(e,r)&&(m0(e,n),e[T1]||(r=void 0)),r&&t.call(i,r.value,r.key,e)},JXe=["includePrerelease","loose","rtl"],wB=e=>e?"object"!=typeof e?{loose:!0}:JXe.filter(t=>e[t]).reduce((t,n)=>(t[n]=!0,t),{}):{},sl={exports:{}},DB={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH:16},nQe="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.error("SEMVER",...t)}:()=>{},uA=nQe;!function(e,t){var n=DB.MAX_SAFE_COMPONENT_LENGTH,i=uA,r=(t=e.exports={}).re=[],s=t.src=[],o=t.t={},a=0,l=(u,c,d)=>{var f=a++;i(f,c),o[u]=f,s[f]=c,r[f]=new RegExp(c,d?"g":void 0)};l("NUMERICIDENTIFIER","0|[1-9]\\d*"),l("NUMERICIDENTIFIERLOOSE","[0-9]+"),l("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),l("MAINVERSION","(".concat(s[o.NUMERICIDENTIFIER],")\\.")+"(".concat(s[o.NUMERICIDENTIFIER],")\\.")+"(".concat(s[o.NUMERICIDENTIFIER],")")),l("MAINVERSIONLOOSE","(".concat(s[o.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(s[o.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(s[o.NUMERICIDENTIFIERLOOSE],")")),l("PRERELEASEIDENTIFIER","(?:".concat(s[o.NUMERICIDENTIFIER],"|").concat(s[o.NONNUMERICIDENTIFIER],")")),l("PRERELEASEIDENTIFIERLOOSE","(?:".concat(s[o.NUMERICIDENTIFIERLOOSE],"|").concat(s[o.NONNUMERICIDENTIFIER],")")),l("PRERELEASE","(?:-(".concat(s[o.PRERELEASEIDENTIFIER],"(?:\\.").concat(s[o.PRERELEASEIDENTIFIER],")*))")),l("PRERELEASELOOSE","(?:-?(".concat(s[o.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(s[o.PRERELEASEIDENTIFIERLOOSE],")*))")),l("BUILDIDENTIFIER","[0-9A-Za-z-]+"),l("BUILD","(?:\\+(".concat(s[o.BUILDIDENTIFIER],"(?:\\.").concat(s[o.BUILDIDENTIFIER],")*))")),l("FULLPLAIN","v?".concat(s[o.MAINVERSION]).concat(s[o.PRERELEASE],"?").concat(s[o.BUILD],"?")),l("FULL","^".concat(s[o.FULLPLAIN],"$")),l("LOOSEPLAIN","[v=\\s]*".concat(s[o.MAINVERSIONLOOSE]).concat(s[o.PRERELEASELOOSE],"?").concat(s[o.BUILD],"?")),l("LOOSE","^".concat(s[o.LOOSEPLAIN],"$")),l("GTLT","((?:<|>)?=?)"),l("XRANGEIDENTIFIERLOOSE","".concat(s[o.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),l("XRANGEIDENTIFIER","".concat(s[o.NUMERICIDENTIFIER],"|x|X|\\*")),l("XRANGEPLAIN","[v=\\s]*(".concat(s[o.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(s[o.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(s[o.XRANGEIDENTIFIER],")")+"(?:".concat(s[o.PRERELEASE],")?").concat(s[o.BUILD],"?")+")?)?"),l("XRANGEPLAINLOOSE","[v=\\s]*(".concat(s[o.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(s[o.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(s[o.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(s[o.PRERELEASELOOSE],")?").concat(s[o.BUILD],"?")+")?)?"),l("XRANGE","^".concat(s[o.GTLT],"\\s*").concat(s[o.XRANGEPLAIN],"$")),l("XRANGELOOSE","^".concat(s[o.GTLT],"\\s*").concat(s[o.XRANGEPLAINLOOSE],"$")),l("COERCE","".concat("(^|[^\\d])(\\d{1,").concat(n,"})")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:$|[^\\d])"),l("COERCERTL",s[o.COERCE],!0),l("LONETILDE","(?:~>?)"),l("TILDETRIM","(\\s*)".concat(s[o.LONETILDE],"\\s+"),!0),t.tildeTrimReplace="$1~",l("TILDE","^".concat(s[o.LONETILDE]).concat(s[o.XRANGEPLAIN],"$")),l("TILDELOOSE","^".concat(s[o.LONETILDE]).concat(s[o.XRANGEPLAINLOOSE],"$")),l("LONECARET","(?:\\^)"),l("CARETTRIM","(\\s*)".concat(s[o.LONECARET],"\\s+"),!0),t.caretTrimReplace="$1^",l("CARET","^".concat(s[o.LONECARET]).concat(s[o.XRANGEPLAIN],"$")),l("CARETLOOSE","^".concat(s[o.LONECARET]).concat(s[o.XRANGEPLAINLOOSE],"$")),l("COMPARATORLOOSE","^".concat(s[o.GTLT],"\\s*(").concat(s[o.LOOSEPLAIN],")$|^$")),l("COMPARATOR","^".concat(s[o.GTLT],"\\s*(").concat(s[o.FULLPLAIN],")$|^$")),l("COMPARATORTRIM","(\\s*)".concat(s[o.GTLT],"\\s*(").concat(s[o.LOOSEPLAIN],"|").concat(s[o.XRANGEPLAIN],")"),!0),t.comparatorTrimReplace="$1$2$3",l("HYPHENRANGE","^\\s*(".concat(s[o.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(s[o.XRANGEPLAIN],")")+"\\s*$"),l("HYPHENRANGELOOSE","^\\s*(".concat(s[o.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(s[o.XRANGEPLAINLOOSE],")")+"\\s*$"),l("STAR","(<|>)?=?\\s*\\*"),l("GTE0","^\\s*>=\\s*0.0.0\\s*$"),l("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")}(sl,sl.exports);var eue=/^[0-9]+$/,cA=uA,nue=DB.MAX_LENGTH,dA=DB.MAX_SAFE_INTEGER,iue=sl.exports.re,rue=sl.exports.t,sQe=wB,N1=(e,t)=>{var n=eue.test(e),i=eue.test(t);return n&&i&&(e=+e,t=+t),e===t?0:n&&!i?-1:i&&!n?1:e<t?-1:1};class ol{constructor(t,n){if(n=sQe(n),t instanceof ol){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if("string"!=typeof t)throw new TypeError("Invalid Version: ".concat(t));if(t.length>nue)throw new TypeError("version is longer than ".concat(nue," characters"));cA("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;var i=t.trim().match(n.loose?iue[rue.LOOSE]:iue[rue.FULL]);if(!i)throw new TypeError("Invalid Version: ".concat(t));if(this.raw=t,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>dA||this.major<0)throw new TypeError("Invalid major version");if(this.minor>dA||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>dA||this.patch<0)throw new TypeError("Invalid patch version");this.prerelease=i[4]?i[4].split(".").map(r=>{if(/^[0-9]+$/.test(r)){var s=+r;if(s>=0&&s<dA)return s}return r}):[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}toString(){return this.version}compare(t){if(cA("SemVer.compare",this.version,this.options,t),!(t instanceof ol)){if("string"==typeof t&&t===this.version)return 0;t=new ol(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof ol||(t=new ol(t,this.options)),N1(this.major,t.major)||N1(this.minor,t.minor)||N1(this.patch,t.patch)}comparePre(t){if(t instanceof ol||(t=new ol(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var n=0;do{var i=this.prerelease[n],r=t.prerelease[n];if(cA("prerelease compare",n,i,r),void 0===i&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===i)return-1;if(i!==r)return N1(i,r)}while(++n)}compareBuild(t){t instanceof ol||(t=new ol(t,this.options));var n=0;do{var i=this.build[n],r=t.build[n];if(cA("prerelease compare",n,i,r),void 0===i&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===i)return-1;if(i!==r)return N1(i,r)}while(++n)}inc(t,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n),this.inc("pre",n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",n),this.inc("pre",n);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var i=this.prerelease.length;--i>=0;)"number"==typeof this.prerelease[i]&&(this.prerelease[i]++,i=-2);-1===i&&this.prerelease.push(0)}n&&(this.prerelease[0]===n?isNaN(this.prerelease[1])&&(this.prerelease=[n,0]):this.prerelease=[n,0]);break;default:throw new Error("invalid increment argument: ".concat(t))}return this.format(),this.raw=this.version,this}}var CB=ol,sue=CB,_0=(e,t,n)=>new sue(e,n).compare(new sue(t,n)),aQe=_0,cQe=_0,hQe=_0,mQe=_0,vQe=_0,DQe=_0,SQe=(e,t,n)=>0===aQe(e,t,n),xQe=(e,t,n)=>0!==cQe(e,t,n),AQe=(e,t,n)=>hQe(e,t,n)>0,MQe=(e,t,n)=>mQe(e,t,n)>=0,TQe=(e,t,n)=>vQe(e,t,n)<0,OQe=(e,t,n)=>DQe(e,t,n)<=0,k1=Symbol("SemVer ANY");class fA{static get ANY(){return k1}constructor(t,n){if(n=RQe(n),t instanceof fA){if(t.loose===!!n.loose)return t;t=t.value}SB("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.value=this.semver===k1?"":this.operator+this.semver.version,SB("comp",this)}parse(t){var i=t.match(this.options.loose?oue[aue.COMPARATORLOOSE]:oue[aue.COMPARATOR]);if(!i)throw new TypeError("Invalid comparator: ".concat(t));this.operator=void 0!==i[1]?i[1]:"","="===this.operator&&(this.operator=""),this.semver=i[2]?new lue(i[2],this.options.loose):k1}toString(){return this.value}test(t){if(SB("Comparator.test",t,this.options.loose),this.semver===k1||t===k1)return!0;if("string"==typeof t)try{t=new lue(t,this.options)}catch(n){return!1}return EB(t,this.operator,this.semver,this.options)}intersects(t,n){if(!(t instanceof fA))throw new TypeError("a Comparator is required");if((!n||"object"!=typeof n)&&(n={loose:!!n,includePrerelease:!1}),""===this.operator)return""===this.value||new uue(t.value,n).test(this.value);if(""===t.operator)return""===t.value||new uue(this.value,n).test(t.semver);var i=!(">="!==this.operator&&">"!==this.operator||">="!==t.operator&&">"!==t.operator),r=!("<="!==this.operator&&"<"!==this.operator||"<="!==t.operator&&"<"!==t.operator),s=this.semver.version===t.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==t.operator&&"<="!==t.operator),a=EB(this.semver,"<",t.semver,n)&&(">="===this.operator||">"===this.operator)&&("<="===t.operator||"<"===t.operator),l=EB(this.semver,">",t.semver,n)&&("<="===this.operator||"<"===this.operator)&&(">="===t.operator||">"===t.operator);return i||r||s&&o||a||l}}var IQe=fA,RQe=wB,oue=sl.exports.re,aue=sl.exports.t,EB=(e,t,n,i)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return SQe(e,n,i);case"!=":return xQe(e,n,i);case">":return AQe(e,n,i);case">=":return MQe(e,n,i);case"<":return TQe(e,n,i);case"<=":return OQe(e,n,i);default:throw new TypeError("Invalid operator: ".concat(t))}},SB=uA,lue=CB,uue=fue;function cue(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function FQe(e,t){if(e){if("string"==typeof e)return due(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return due(e,t)}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(u){throw u},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var u=n.next();return s=u.done,u},e:function(u){o=!0,a=u},f:function(){try{!s&&null!=n.return&&n.return()}finally{if(o)throw a}}}}function due(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}class I1{constructor(t,n){if(n=LQe(n),t instanceof I1)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new I1(t.raw,n);if(t instanceof xB)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(a=>this.parseRange(a.trim())).filter(a=>a.length),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(t));if(this.set.length>1){var i=this.set[0];if(this.set=this.set.filter(a=>!pue(a[0])),0===this.set.length)this.set=[i];else if(this.set.length>1){var s,r=cue(this.set);try{for(r.s();!(s=r.n()).done;){var o=s.value;if(1===o.length&&HQe(o[0])){this.set=[o];break}}}catch(a){r.e(a)}finally{r.f()}}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){t=t.trim();var n=Object.keys(this.options).join(","),i="parseRange:".concat(n,":").concat(t),r=hue.get(i);if(r)return r;var s=this.options.loose;t=t.replace(s?Nr[ir.HYPHENRANGELOOSE]:Nr[ir.HYPHENRANGE],QQe(this.options.includePrerelease)),si("hyphen replace",t),t=t.replace(Nr[ir.COMPARATORTRIM],BQe),si("comparator trim",t,Nr[ir.COMPARATORTRIM]),t=(t=(t=t.replace(Nr[ir.TILDETRIM],$Qe)).replace(Nr[ir.CARETTRIM],VQe)).split(/\s+/).join(" ");var d,a=s?Nr[ir.COMPARATORLOOSE]:Nr[ir.COMPARATOR],l=t.split(" ").map(p=>UQe(p,this.options)).join(" ").split(/\s+/).map(p=>XQe(p,this.options)).filter(this.options.loose?p=>!!p.match(a):()=>!0).map(p=>new xB(p,this.options)),u=new Map,c=cue(l);try{for(c.s();!(d=c.n()).done;){var f=d.value;if(pue(f))return[f];u.set(f.value,f)}}catch(p){c.e(p)}finally{c.f()}u.size>1&&u.has("")&&u.delete("");var h=[...u.values()];return hue.set(i,h),h}intersects(t,n){if(!(t instanceof I1))throw new TypeError("a Range is required");return this.set.some(i=>gue(i,n)&&t.set.some(r=>gue(r,n)&&i.every(s=>r.every(o=>s.intersects(o,n)))))}test(t){if(!t)return!1;if("string"==typeof t)try{t=new jQe(t,this.options)}catch(i){return!1}for(var n=0;n<this.set.length;n++)if(ZQe(this.set[n],t,this.options))return!0;return!1}}var fue=I1,hue=new class WXe{constructor(t){if("number"==typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!=typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[pp]=t.max||1/0;var n=t.length||vB;if(this[g0]="function"!=typeof n?vB:n,this[T1]=t.stale||!1,t.maxAge&&"number"!=typeof t.maxAge)throw new TypeError("maxAge must be a number");this[gp]=t.maxAge||0,this[bc]=t.dispose,this[Xle]=t.noDisposeOnSet||!1,this[Qle]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!=typeof t||t<0)throw new TypeError("max must be a non-negative number");this[pp]=t||1/0,O1(this)}get max(){return this[pp]}set allowStale(t){this[T1]=!!t}get allowStale(){return this[T1]}set maxAge(t){if("number"!=typeof t)throw new TypeError("maxAge must be a non-negative number");this[gp]=t,O1(this)}get maxAge(){return this[gp]}set lengthCalculator(t){"function"!=typeof t&&(t=vB),t!==this[g0]&&(this[g0]=t,this[vc]=0,this[Gi].forEach(n=>{n.length=this[g0](n.value,n.key),this[vc]+=n.length})),O1(this)}get lengthCalculator(){return this[g0]}get length(){return this[vc]}get itemCount(){return this[Gi].length}rforEach(t,n){n=n||this;for(var i=this[Gi].tail;null!==i;){var r=i.prev;Zle(this,t,i,n),i=r}}forEach(t,n){n=n||this;for(var i=this[Gi].head;null!==i;){var r=i.next;Zle(this,t,i,n),i=r}}keys(){return this[Gi].toArray().map(t=>t.key)}values(){return this[Gi].toArray().map(t=>t.value)}reset(){this[bc]&&this[Gi]&&this[Gi].length&&this[Gi].forEach(t=>this[bc](t.key,t.value)),this[rl]=new Map,this[Gi]=new GXe,this[vc]=0}dump(){return this[Gi].map(t=>!lA(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[Gi]}set(t,n,i){if((i=i||this[gp])&&"number"!=typeof i)throw new TypeError("maxAge must be a number");var r=i?Date.now():0,s=this[g0](n,t);if(this[rl].has(t)){if(s>this[pp])return m0(this,this[rl].get(t)),!1;var a=this[rl].get(t).value;return this[bc]&&(this[Xle]||this[bc](t,a.value)),a.now=r,a.maxAge=i,a.value=n,this[vc]+=s-a.length,a.length=s,this.get(t),O1(this),!0}var l=new YXe(t,n,s,r,i);return l.length>this[pp]?(this[bc]&&this[bc](t,n),!1):(this[vc]+=l.length,this[Gi].unshift(l),this[rl].set(t,this[Gi].head),O1(this),!0)}has(t){if(!this[rl].has(t))return!1;var n=this[rl].get(t).value;return!lA(this,n)}get(t){return bB(this,t,!0)}peek(t){return bB(this,t,!1)}pop(){var t=this[Gi].tail;return t?(m0(this,t),t.value):null}del(t){m0(this,this[rl].get(t))}load(t){this.reset();for(var n=Date.now(),i=t.length-1;i>=0;i--){var r=t[i],s=r.e||0;if(0===s)this.set(r.k,r.v);else{var o=s-n;o>0&&this.set(r.k,r.v,o)}}}prune(){this[rl].forEach((t,n)=>bB(this,n,!1))}}({max:1e3}),LQe=wB,xB=IQe,si=uA,jQe=CB,Nr=sl.exports.re,ir=sl.exports.t,BQe=sl.exports.comparatorTrimReplace,$Qe=sl.exports.tildeTrimReplace,VQe=sl.exports.caretTrimReplace,pue=e=>"<0.0.0-0"===e.value,HQe=e=>""===e.value,gue=(e,t)=>{for(var n=!0,i=e.slice(),r=i.pop();n&&i.length;)n=i.every(s=>r.intersects(s,t)),r=i.pop();return n},UQe=(e,t)=>(si("comp",e,t),e=GQe(e,t),si("caret",e),e=zQe(e,t),si("tildes",e),e=YQe(e,t),si("xrange",e),e=JQe(e,t),si("stars",e),e),os=e=>!e||"x"===e.toLowerCase()||"*"===e,zQe=(e,t)=>e.trim().split(/\s+/).map(n=>qQe(n,t)).join(" "),qQe=(e,t)=>e.replace(t.loose?Nr[ir.TILDELOOSE]:Nr[ir.TILDE],(i,r,s,o,a)=>{var l;return si("tilde",e,i,r,s,o,a),os(r)?l="":os(s)?l=">=".concat(r,".0.0 <").concat(+r+1,".0.0-0"):os(o)?l=">=".concat(r,".").concat(s,".0 <").concat(r,".").concat(+s+1,".0-0"):a?(si("replaceTilde pr",a),l=">=".concat(r,".").concat(s,".").concat(o,"-").concat(a," <").concat(r,".").concat(+s+1,".0-0")):l=">=".concat(r,".").concat(s,".").concat(o," <").concat(r,".").concat(+s+1,".0-0"),si("tilde return",l),l}),GQe=(e,t)=>e.trim().split(/\s+/).map(n=>WQe(n,t)).join(" "),WQe=(e,t)=>{si("caret",e,t);var i=t.includePrerelease?"-0":"";return e.replace(t.loose?Nr[ir.CARETLOOSE]:Nr[ir.CARET],(r,s,o,a,l)=>{var u;return si("caret",e,r,s,o,a,l),os(s)?u="":os(o)?u=">=".concat(s,".0.0").concat(i," <").concat(+s+1,".0.0-0"):os(a)?u="0"===s?">=".concat(s,".").concat(o,".0").concat(i," <").concat(s,".").concat(+o+1,".0-0"):">=".concat(s,".").concat(o,".0").concat(i," <").concat(+s+1,".0.0-0"):l?(si("replaceCaret pr",l),u="0"===s?"0"===o?">=".concat(s,".").concat(o,".").concat(a,"-").concat(l," <").concat(s,".").concat(o,".").concat(+a+1,"-0"):">=".concat(s,".").concat(o,".").concat(a,"-").concat(l," <").concat(s,".").concat(+o+1,".0-0"):">=".concat(s,".").concat(o,".").concat(a,"-").concat(l," <").concat(+s+1,".0.0-0")):(si("no pr"),u="0"===s?"0"===o?">=".concat(s,".").concat(o,".").concat(a).concat(i," <").concat(s,".").concat(o,".").concat(+a+1,"-0"):">=".concat(s,".").concat(o,".").concat(a).concat(i," <").concat(s,".").concat(+o+1,".0-0"):">=".concat(s,".").concat(o,".").concat(a," <").concat(+s+1,".0.0-0")),si("caret return",u),u})},YQe=(e,t)=>(si("replaceXRanges",e,t),e.split(/\s+/).map(n=>KQe(n,t)).join(" ")),KQe=(e,t)=>(e=e.trim()).replace(t.loose?Nr[ir.XRANGELOOSE]:Nr[ir.XRANGE],(i,r,s,o,a,l)=>{si("xRange",e,i,r,s,o,a,l);var u=os(s),c=u||os(o),d=c||os(a);return"="===r&&d&&(r=""),l=t.includePrerelease?"-0":"",u?i=">"===r||"<"===r?"<0.0.0-0":"*":r&&d?(c&&(o=0),a=0,">"===r?(r=">=",c?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):"<="===r&&(r="<",c?s=+s+1:o=+o+1),"<"===r&&(l="-0"),i="".concat(r+s,".").concat(o,".").concat(a).concat(l)):c?i=">=".concat(s,".0.0").concat(l," <").concat(+s+1,".0.0-0"):d&&(i=">=".concat(s,".").concat(o,".0").concat(l," <").concat(s,".").concat(+o+1,".0-0")),si("xRange return",i),i}),JQe=(e,t)=>(si("replaceStars",e,t),e.trim().replace(Nr[ir.STAR],"")),XQe=(e,t)=>(si("replaceGTE0",e,t),e.trim().replace(Nr[t.includePrerelease?ir.GTE0PRE:ir.GTE0],"")),QQe=e=>(t,n,i,r,s,o,a,l,u,c,d,f,h)=>(n=os(i)?"":os(r)?">=".concat(i,".0.0").concat(e?"-0":""):os(s)?">=".concat(i,".").concat(r,".0").concat(e?"-0":""):o?">=".concat(n):">=".concat(n).concat(e?"-0":""),l=os(u)?"":os(c)?"<".concat(+u+1,".0.0-0"):os(d)?"<".concat(u,".").concat(+c+1,".0-0"):f?"<=".concat(u,".").concat(c,".").concat(d,"-").concat(f):e?"<".concat(u,".").concat(c,".").concat(+d+1,"-0"):"<=".concat(l),"".concat(n," ").concat(l).trim()),ZQe=(e,t,n)=>{for(var i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(var r=0;r<e.length;r++)if(si(e[r].semver),e[r].semver!==xB.ANY&&e[r].semver.prerelease.length>0){var s=e[r].semver;if(s.major===t.major&&s.minor===t.minor&&s.patch===t.patch)return!0}return!1}return!0},eZe=fue,mue=(e,t,n)=>{try{t=new eZe(t,n)}catch(i){return!1}return t.test(e)};function nZe(e,t,n){var i=e.open(t),a=new URL(t).origin,l=40;e.addEventListener("message",function u(d){d.source===i&&(l=0,e.removeEventListener("message",u,!1))},!1),setTimeout(function c(){l<=0||(i.postMessage(n,a),setTimeout(c,250),l-=1)},250)}var AB,iZe='.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box;\n}\n.vega-embed.has-actions {\n  padding-right: 38px;\n}\n.vega-embed details:not([open]) > :not(summary) {\n  display: none !important;\n}\n.vega-embed summary {\n  list-style: none;\n  position: absolute;\n  top: 0;\n  right: 0;\n  padding: 6px;\n  z-index: 1000;\n  background: white;\n  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n  color: #1b1e23;\n  border: 1px solid #aaa;\n  border-radius: 999px;\n  opacity: 0.2;\n  transition: opacity 0.4s ease-in;\n  cursor: pointer;\n  line-height: 0px;\n}\n.vega-embed summary::-webkit-details-marker {\n  display: none;\n}\n.vega-embed summary:active {\n  box-shadow: #aaa 0px 0px 0px 1px inset;\n}\n.vega-embed summary svg {\n  width: 14px;\n  height: 14px;\n}\n.vega-embed details[open] summary {\n  opacity: 0.7;\n}\n.vega-embed:hover summary, .vega-embed:focus-within summary {\n  opacity: 1 !important;\n  transition: opacity 0.2s ease;\n}\n.vega-embed .vega-actions {\n  position: absolute;\n  z-index: 1001;\n  top: 35px;\n  right: -9px;\n  display: flex;\n  flex-direction: column;\n  padding-bottom: 8px;\n  padding-top: 8px;\n  border-radius: 4px;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n  border: 1px solid #d9d9d9;\n  background: white;\n  animation-duration: 0.15s;\n  animation-name: scale-in;\n  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n  text-align: left;\n}\n.vega-embed .vega-actions a {\n  padding: 8px 16px;\n  font-family: sans-serif;\n  font-size: 14px;\n  font-weight: 600;\n  white-space: nowrap;\n  color: #434a56;\n  text-decoration: none;\n}\n.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {\n  background-color: #f7f7f9;\n  color: black;\n}\n.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n  content: "";\n  display: inline-block;\n  position: absolute;\n}\n.vega-embed .vega-actions::before {\n  left: auto;\n  right: 14px;\n  top: -16px;\n  border: 8px solid #0000;\n  border-bottom-color: #d9d9d9;\n}\n.vega-embed .vega-actions::after {\n  left: auto;\n  right: 15px;\n  top: -14px;\n  border: 7px solid #0000;\n  border-bottom-color: #fff;\n}\n.vega-embed .chart-wrapper.fit-x {\n  width: 100%;\n}\n.vega-embed .chart-wrapper.fit-y {\n  height: 100%;\n}\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px;\n}\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n';function _ue(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var r=0,s=n;r<s.length;r++){var o=s[r];rZe(e,o)}return e}function rZe(e,t){for(var n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];Tg(e,r,t[r],!0)}}function yue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function df(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yue(Object(n),!0).forEach(function(i){IXe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yue(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});var ff=ll,R1=rr,hA="undefined"!=typeof window?window:void 0;void 0===R1&&null!=hA&&null!==(AB=hA.vl)&&void 0!==AB&&AB.compile&&(R1=hA.vl);var AZe={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},MZe={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},F1={vega:"Vega","vega-lite":"Vega-Lite"},pA={vega:ff.version,"vega-lite":R1?R1.version:"not available"},TZe={vega:e=>e,"vega-lite":(e,t)=>R1.compile(e,{config:t}).spec},OZe='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',NZe="chart-wrapper";function kZe(e){return"function"==typeof e}function vue(e,t,n,i){var r="<html><head>".concat(t,'</head><body><pre><code class="json">'),s="</code></pre>".concat(n,"</body></html>"),o=window.open("");o.document.write(r+e+s),o.document.title="".concat(F1[i]," JSON Source")}function IZe(e,t){if(e.$schema){var i,n=Ole(e.$schema);t&&t!==n.library&&console.warn("The given visualization spec is written in ".concat(F1[n.library],", but mode argument sets ").concat(null!==(i=F1[t])&&void 0!==i?i:t,"."));var r=n.library;return mue(pA[r],"^".concat(n.version.slice(1)))||console.warn("The input spec uses ".concat(F1[r]," ").concat(n.version,", but the current version of ").concat(F1[r]," is v").concat(pA[r],".")),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":null!=t?t:"vega"}function bue(e){return function RZe(e){return!(!e||!("load"in e))}(e)?e:ff.loader(e)}function FZe(e){var t,n,i=null!==(t=null===(n=e.usermeta)||void 0===n?void 0:n.embedOptions)&&void 0!==t?t:{};return be(i.defaultStyle)&&(i.defaultStyle=!1),i}function hf(e,t){return MB.apply(this,arguments)}function MB(){return MB=tA(gu.mark(function e(t,n){var i,r,s,o,a,l,u,c,d,f,h,p=arguments;return gu.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(s=p.length>2&&void 0!==p[2]?p[2]:{},!be(n)){m.next=10;break}return a=bue(s.loader),m.t0=JSON,m.next=6,a.load(n);case 6:m.t1=m.sent,o=m.t0.parse.call(m.t0,m.t1),m.next=11;break;case 10:o=n;case 11:return l=FZe(o),u=l.loader,(!a||u)&&(a=bue(null!==(c=s.loader)&&void 0!==c?c:u)),m.next=16,wue(l,a);case 16:return d=m.sent,m.next=19,wue(s,a);case 19:return h=df(df({},_ue(f=m.sent,d)),{},{config:Mg(null!==(i=f.config)&&void 0!==i?i:{},null!==(r=d.config)&&void 0!==r?r:{})}),m.next=23,LZe(t,o,h,a);case 23:return m.abrupt("return",m.sent);case 24:case"end":return m.stop()}},e)})),MB.apply(this,arguments)}function wue(e,t){return TB.apply(this,arguments)}function TB(){return TB=tA(gu.mark(function e(t,n){var i,r,s;return gu.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!be(t.config)){a.next=8;break}return a.t1=JSON,a.next=4,n.load(t.config);case 4:a.t2=a.sent,a.t0=a.t1.parse.call(a.t1,a.t2),a.next=9;break;case 8:a.t0=null!==(i=t.config)&&void 0!==i?i:{};case 9:if(r=a.t0,!be(t.patch)){a.next=18;break}return a.t4=JSON,a.next=14,n.load(t.patch);case 14:a.t5=a.sent,a.t3=a.t4.parse.call(a.t4,a.t5),a.next=19;break;case 18:a.t3=t.patch;case 19:return s=a.t3,a.abrupt("return",df(df(df({},t),s?{patch:s}:{}),r?{config:r}:{}));case 21:case"end":return a.stop()}},e)})),TB.apply(this,arguments)}function PZe(e){var t,n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:null!==(t=document.head)&&void 0!==t?t:document.body}}function LZe(e,t){return OB.apply(this,arguments)}function OB(){return OB=tA(gu.mark(function e(t,n){var i,r,s,o,a,l,u,c,d,f,h,p,g,m,_,y,v,b,C,w,E,N,k,I,L,B,T,A,x,F,O,j,q,G,V,K,re,X,le,Y,Z,ne,W,he,ve,Re,Ce=arguments;return gu.wrap(function(Xe){for(;;)switch(Xe.prev=Xe.next){case 0:if(Re=function(){q&&document.removeEventListener("click",q),x.finalize()},d=Ce.length>3?Ce[3]:void 0,f=(c=Ce.length>2&&void 0!==Ce[2]?Ce[2]:{}).theme?Mg(ul[c.theme],null!==(i=c.config)&&void 0!==i?i:{}):c.config,h=Wc(c.actions)?c.actions:_ue({},AZe,null!==(r=c.actions)&&void 0!==r?r:{}),p=df(df({},MZe),c.i18n),g=null!==(s=c.renderer)&&void 0!==s?s:"canvas",m=null!==(o=c.logLevel)&&void 0!==o?o:ff.Warn,_=null!==(a=c.downloadFileName)&&void 0!==a?a:"visualization",y="string"==typeof t?document.querySelector(t):t){Xe.next=12;break}throw new Error("".concat(t," does not exist"));case 12:return!1!==c.defaultStyle&&(v="vega-embed-style",b=PZe(y),C=b.rootContainer,b.root.getElementById(v)||((w=document.createElement("style")).id=v,w.innerHTML=void 0===c.defaultStyle||!0===c.defaultStyle?iZe.toString():c.defaultStyle,C.appendChild(w))),E=IZe(n,c.mode),N=TZe[E](n,f),"vega-lite"===E&&N.$schema&&(k=Ole(N.$schema),mue(pA.vega,"^".concat(k.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(k.version,", but current version is v").concat(pA.vega,"."))),y.classList.add("vega-embed"),h&&y.classList.add("has-actions"),y.innerHTML="",I=y,h&&((L=document.createElement("div")).classList.add(NZe),y.appendChild(L),I=L),(B=c.patch)&&(N=B instanceof Function?B(N):nD(N,B,!0,!1).newDocument),c.formatLocale&&ff.formatLocale(c.formatLocale),c.timeFormatLocale&&ff.timeFormatLocale(c.timeFormatLocale),A=ff.parse(N,"vega-lite"===E?{}:f,{ast:T=c.ast}),(x=new(c.viewClass||ff.View)(A,df({loader:d,logLevel:m,renderer:g},T?{expr:null!==(l=null!==(u=ff.expressionInterpreter)&&void 0!==u?u:c.expr)&&void 0!==l?l:L9e}:{}))).addSignalListener("autosize",(Mt,tt)=>{var He=tt.type;"fit-x"==He?(I.classList.add("fit-x"),I.classList.remove("fit-y")):"fit-y"==He?(I.classList.remove("fit-x"),I.classList.add("fit-y")):"fit"==He?I.classList.add("fit-x","fit-y"):I.classList.remove("fit-x","fit-y")}),!1!==c.tooltip&&(F=kZe(c.tooltip)?c.tooltip:new Vle(!0===c.tooltip?{}:c.tooltip).call,x.tooltip(F)),void 0===(O=c.hover)&&(O="vega"===E),O&&x.hover((j="boolean"==typeof O?{}:O).hoverSet,j.updateSet),c&&(null!=c.width&&x.width(c.width),null!=c.height&&x.height(c.height),null!=c.padding&&x.padding(c.padding)),Xe.next=36,x.initialize(I,c.bind).runAsync();case 36:if(!1!==h){if(G=y,!1!==c.defaultStyle&&((V=document.createElement("details")).title=p.CLICK_TO_VIEW_ACTIONS,y.append(V),G=V,(K=document.createElement("summary")).innerHTML=OZe,V.append(K),q=Mt=>{V.contains(Mt.target)||V.removeAttribute("open")},document.addEventListener("click",q)),re=document.createElement("div"),G.append(re),re.classList.add("vega-actions"),!0===h||!1!==h.export)for(X=function(){var tt=Y[le];if(!0===h||!0===h.export||h.export[tt]){var He=p["".concat(tt.toUpperCase(),"_ACTION")],se=document.createElement("a");se.text=He,se.href="#",se.target="_blank",se.download="".concat(_,".").concat(tt),se.addEventListener("mousedown",function(){var Bt=tA(gu.mark(function Ti(_o){return gu.wrap(function(ks){for(;;)switch(ks.prev=ks.next){case 0:return _o.preventDefault(),ks.next=3,x.toImageURL(tt,c.scaleFactor);case 3:this.href=ks.sent;case 5:case"end":return ks.stop()}},Ti,this)}));return function(Ti){return Bt.apply(this,arguments)}}()),re.append(se)}},le=0,Y=["svg","png"];le<Y.length;le++)X();(!0===h||!1!==h.source)&&((Z=document.createElement("a")).text=p.SOURCE_ACTION,Z.href="#",Z.addEventListener("click",function(Mt){var tt,He;vue(wN()(n),null!==(tt=c.sourceHeader)&&void 0!==tt?tt:"",null!==(He=c.sourceFooter)&&void 0!==He?He:"",E),Mt.preventDefault()}),re.append(Z)),"vega-lite"===E&&(!0===h||!1!==h.compiled)&&((ne=document.createElement("a")).text=p.COMPILED_ACTION,ne.href="#",ne.addEventListener("click",function(Mt){var tt,He;vue(wN()(N),null!==(tt=c.sourceHeader)&&void 0!==tt?tt:"",null!==(He=c.sourceFooter)&&void 0!==He?He:"","vega"),Mt.preventDefault()}),re.append(ne)),(!0===h||!1!==h.editor)&&(he=null!==(W=c.editorUrl)&&void 0!==W?W:"https://vega.github.io/editor/",(ve=document.createElement("a")).text=p.EDITOR_ACTION,ve.href="#",ve.addEventListener("click",function(Mt){nZe(window,he,{config:f,mode:E,renderer:g,spec:wN()(n)}),Mt.preventDefault()}),re.append(ve))}return Xe.abrupt("return",{view:x,spec:n,vgSpec:N,finalize:Re,embedOptions:c});case 38:case"end":return Xe.stop()}},e)})),OB.apply(this,arguments)}let ea=(()=>{class e{constructor(){this.wikirateApiHost="https://wikirate.org"}drawPieChart(n,i,r,s,o,a,l,u){var c=JSON.parse(JSON.stringify(Xxe));return c.description=n,c.data[0].values=r,c.width=s,c.height=o,c.scales[0].range=a,c.scales[0].domain=l,hf(i,c,u)}drawPieCustomChart(n,i,r,s,o,a,l,u,c,d){let f=JSON.parse(JSON.stringify(Qxe)),h=f.data;return h.unshift({name:"answers",url:`${this.wikirateApiHost}/~${s}+answer/answer_list.json?limit=0&filter[year]=${o}`,transform:[{type:"lookup",from:"assessed",key:"company",fields:["company"],values:["value"],as:["assessed"]},{type:"filter",expr:"datum.assessed === 'Yes'"},{type:"formula",as:"value",expr:"test(/beyond tier 1/, datum.value)? 'beyond tier 1': 'direct'"}]}),h.unshift({name:"assessed",url:`${this.wikirateApiHost}/~${r}+Answer.json?view=answer_list&limit=0&filter[year]=${o}`}),f.data=h,f.description=n,f.width=a,f.height=l,f.scales[0].range=u,f.scales[0].domain=c,console.log(f),hf(i,f,d)}drawMinimumRequirementsBarChart(n,i,r,s,o,a,l,u,c){let d=JSON.parse(JSON.stringify(Bq)),f=[];f.push({name:"assessed",url:`${this.wikirateApiHost}/~${o}+Answer.json?view=answer_list&limit=0&filter[year]=${l}&filter[company_group]=${u}`,transform:[{type:"formula",as:"key",expr:"datum.company + ',' + datum.year"}]});let h=[];for(let p of a){h.push(p.short_label);let g="[";for(let m of p.filter_value)g+="'"+m+"',";g=g.substring(0,g.length-1)+"]",f.push({name:p.short_label,url:`${this.wikirateApiHost}/~${p.id}+answer/answer_list.json?limit=0&filter[year]=${l}&filter[company_group]=${u}`,transform:[{type:"formula",as:"key",expr:"datum.company + ',' + datum.year"},{type:"lookup",from:"assessed",key:"key",fields:["key"],values:["value"],as:["assessed"]},{type:"filter",expr:"datum.assessed == 'Yes'"},{type:"formula",as:"accepted_value",expr:"indexof("+g+", datum.value) >= 0"},{type:"aggregate",groupby:["accepted_value"]},{type:"impute",key:"accepted_value",keyvals:[!0],field:"count",value:0},{type:"joinaggregate",fields:["count"],ops:["sum"]},{type:"filter",expr:"datum.accepted_value == true"}]})}f.push({name:"metrics",values:a}),f.push({name:"counts",source:h,transform:[{type:"window",ops:["row_number"],as:["seq"]},{type:"lookup",from:"metrics",key:"seq",fields:["seq"],values:["label","metric","color","filter_value"],as:["title","wikirate_page","color","filter_value"]},{type:"formula",expr:"datum.count/datum.sum_count",as:"percentage"},{type:"formula",expr:"format(datum.count / datum.sum_count, '.0%')",as:"percent_label"},{type:"formula",expr:"datum.count + ' out of ' + datum.sum_count + ' statements'",as:"count_label"},{type:"formula",expr:"{ value: datum.filter_value }",as:"filter"}]}),d.description=n,d.data=f,d.width=r,d.height=s,hf(i,d,c)}drawSubgroupsBarChart(n,i,r,s,o,a,l,u,c,d){let f=JSON.parse(JSON.stringify(eAe)),h=[];return h.push({name:"assessed",url:`${this.wikirateApiHost}/~${s}+Answer.json?view=answer_list&limit=0&filter[year]=${u}&filter[company_group]=${c}`,transform:[{type:"formula",as:"key",expr:"datum.company + ',' + datum.year"}]}),h.push({name:"answers",url:`${this.wikirateApiHost}/~${o}+Answer.json?view=answer_list&limit=0&filter[year]=${u}&filter[company_group]=${c}`,transform:[{type:"formula",as:"key",expr:"datum.company + ',' + datum.year"},{type:"lookup",from:"assessed",key:"key",fields:["key"],values:["value"],as:["assessed"]},{type:"filter",expr:"datum.value != '' && datum.assessed == 'Yes'"},{type:"formula",expr:"split(datum.value, ', ')",as:"value_array"}]}),h.push(a),h.push(l),h.push(f.data[4]),f.description=n,f.data=h,f.width=r,hf(i,f,d)}drawBarChart(n,i,r,s,o,a,l,u,c){let d=JSON.parse(JSON.stringify(Bq)),f=[];f.push({name:"assessed",url:`${this.wikirateApiHost}/~${o}+Answer.json?view=answer_list&limit=0&filter[year]=${l}&filter[company_group]=${u}`,transform:[{type:"formula",as:"key",expr:"datum.company + ',' + datum.year"}]}),f.push({name:"answers",url:`${this.wikirateApiHost}/~${a[0].id}+answer/answer_list.json?limit=0&filter[year]=${l}&filter[company_group]=${u}`});let h=[];for(let p of a){h.push(p.short_label);let g="[";for(let m of p.filter_value)g+="'"+m+"',";g=g.substring(0,g.length-1)+"]",f.push({name:p.short_label,source:["answers"],transform:[{type:"formula",as:"key",expr:"datum.company + ',' + datum.year"},{type:"lookup",from:"assessed",key:"key",fields:["key"],values:["value"],as:["assessed"]},{type:"filter",expr:"datum.assessed == 'Yes'"},{type:"formula",as:"accepted_value",expr:"indexof("+g+", datum.value) >= 0"},{type:"aggregate",groupby:["accepted_value"]},{type:"impute",key:"accepted_value",keyvals:[!0],field:"count",value:0},{type:"joinaggregate",fields:["count"],ops:["sum"]},{type:"filter",expr:"datum.accepted_value == true"}]})}return f.push({name:"metrics",values:a}),f.push({name:"counts",source:h,transform:[{type:"window",ops:["row_number"],as:["seq"]},{type:"lookup",from:"metrics",key:"seq",fields:["seq"],values:["label","metric","color","filter_value"],as:["title","wikirate_page","color","filter_value"]},{type:"formula",expr:"datum.count/datum.sum_count",as:"percentage"},{type:"formula",expr:"format(datum.count / datum.sum_count, '.0%')",as:"percent_label"},{type:"formula",expr:"datum.count + ' out of ' + datum.sum_count + ' statements'",as:"count_label"},{type:"formula",expr:"{ value: datum.filter_value }",as:"filter"}]}),d.description=n,d.data=f,d.width=r,d.height=s,hf(i,d,c)}drawPieChartGroups(n,i,r,s,o,a,l,u,c,d){var f=JSON.parse(JSON.stringify(Zxe));let h={},p="";for(let g in o)h["color_"+g]=o[g],p+="colors.color_"+g+", ";return p="["+p.substring(0,p.length-2)+"]",f.signals[0].value=h,f.description=n,f.data[0].values=a,f.data.unshift({name:"answers",url:`${this.wikirateApiHost}/~${s}+Answer.json?view=answer_list&limit=0&filter[year]=${i}`,transform:[{type:"formula",as:"key",expr:"datum.company + ',' + datum.year"},{type:"lookup",from:"assessed",key:"key",fields:["key"],values:["value"],as:["assessed"]},{type:"filter",expr:"datum.assessed == 'Yes'"}]}),f.data.unshift({name:"assessed",url:`${this.wikirateApiHost}/~${r}+Answer.json?view=answer_list&limit=0&filter[year]=${i}`,transform:[{type:"formula",as:"key",expr:"datum.company + ',' + datum.year"}]}),f.width=u,f.height=c,f.scales[0].range=o,f.scales[0].range.signal=p,hf(l,f,d)}uk_legislation_tree_map(n,i,r,s,o){var a=JSON.parse(JSON.stringify(tAe));return a.data[0].values=n,hf(i,a,o)}both_legislations_tree_map(n,i,r,s,o){var a=JSON.parse(JSON.stringify(nAe));return a.data[0].values=n,console.log(JSON.stringify(a)),hf(i,a,o)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();function jZe(e,t){1&e&&(S(0,"div",13)(1,"div",14)(2,"div",15)(3,"span",16),R(4,"Loading..."),M()()()())}let BZe=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartService=i,this.year="",this.legislation="both",this.isLoading=!0}ngOnInit(){this.updateData()}updateData(){if("both"==this.legislation){this.isLoading=!0;let n=0,i=0,r=0,s=0;this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new J("year",this.year),new J("value","Yes")]).subscribe(o=>{this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new J("year",this.year),new J("company_group","MSA Garment"),new J("value","Yes")]).subscribe(a=>{this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new J("year",this.year),new J("company_group","MSA Financial"),new J("value","Yes")]).subscribe(l=>{this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new J("year",this.year),new J("company_group","MSA Hospitality"),new J("value","Yes")]).subscribe(u=>{this.dataProvider.getAnswers(this.dataProvider.metrics.meet_uk_min_requirements,[new J("year",this.year),new J("value","Yes")]).subscribe(c=>{this.dataProvider.getAnswers(this.dataProvider.metrics.meet_aus_min_requirements,[new J("year",this.year),new J("value","Yes")]).subscribe(d=>{for(let h of o)(c.findIndex(p=>p.company===h.company&&p.year===h.year)>=0||d.findIndex(p=>p.company===h.company&&p.year===h.year)>=0)&&a.findIndex(p=>p.company===h.company&&p.year===h.year)>=0?n++:(c.findIndex(p=>p.company===h.company&&p.year===h.year)>=0||d.findIndex(p=>p.company===h.company&&p.year===h.year)>=0)&&l.findIndex(p=>p.company===h.company&&p.year===h.year)>=0?i++:(c.findIndex(p=>p.company===h.company&&p.year===h.year)>=0||d.findIndex(p=>p.company===h.company&&p.year===h.year)>=0)&&u.findIndex(p=>p.company===h.company&&p.year===h.year)>=0?r++:(c.findIndex(p=>p.company===h.company&&p.year===h.year)>=0||d.findIndex(p=>p.company===h.company&&p.year===h.year)>=0)&&s++;let f=[{name:"Statements",id:0},{name:"Garment Sector",id:1,parent:0},{name:"Financial Sector",id:2,parent:0},{name:"Hospitality Sector",id:3,parent:0},{name:"Other",id:4,parent:0},{id:5,name:"Meet Minimum Requirements",size:n,parent:1},{id:6,name:"Do Not Meet Minimum Requirements",size:a.length-n,parent:1},{id:7,name:"Meet Minimum Requirements",size:i,parent:2},{id:8,name:"Do Not Meet Minimum Requirements",size:l.length-i,parent:2},{id:9,name:"Meet Minimum Requirements",size:r,parent:3},{id:10,name:"Do Not Meet Minimum Requirements",size:u.length-r,parent:3},{id:11,name:"Meet Minimum Requirements",size:s,parent:4},{id:12,name:"Do Not Meet Minimum Requirements",size:o.length-a.length-l.length-u.length-s,parent:4}];console.log(JSON.stringify(f)),this.chartService.both_legislations_tree_map(f,"div#tree-map",0,0,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.isLoading=!1})})})})})})})}else if("uk"===this.legislation){this.isLoading=!0;let n=0,i=0,r=0,s=0,o=0,a=0,l=0,u=0,c=0,d=0,f=0,h=0,p=0,g=0,m=0,_=0,y=0,v=0,b=0,D=0,C=0,w=0,E=0,N=0,k=0,I=0,L=0,B=0,T=0,A=0,x=0,F=0,O=0,j=0,P=0,z=0,q=0,G=0,V=0,K=0,re=0,X=0,le=0,Y=0,Z=0,ne=0,W=0,he=0;this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new J("year",this.year),new J("value","Yes")]).subscribe(ve=>{this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new J("year",this.year),new J("company_group","MSA Garment"),new J("value","Yes")]).subscribe(Re=>{this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new J("year",this.year),new J("company_group","MSA Financial"),new J("value","Yes")]).subscribe(Ce=>{this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new J("year",this.year),new J("company_group","MSA Hospitality"),new J("value","Yes")]).subscribe(Oe=>{this.dataProvider.getAnswers(this.dataProvider.metrics.meet_uk_min_requirements,[new J("year",this.year),new J("value","Yes")]).subscribe(Xe=>{this.dataProvider.getAnswers(this.dataProvider.metrics.turnover_range,[new J("year","latest")]).subscribe(Mt=>{for(let He of ve){let se=Mt.find(Bt=>Bt.company===He.company);Re.findIndex(Bt=>Bt.company===He.company&&Bt.year===He.year)>=0?Xe.findIndex(Bt=>Bt.company===He.company&&Bt.year===He.year)>=0?void 0!==se&&"Under \xa336 million"===se.value?n++:void 0!==se&&"\xa336 million to \xa360 million"===se.value?i++:void 0!==se&&"\xa360 million to \xa3100 million"===se.value?r++:void 0!==se&&"\xa3100 million to \xa3500 million"===se.value?s++:void 0!==se&&"Over \xa3500 million"===se.value?o++:a++:void 0!==se&&"Under \xa336 million"===se.value?l++:void 0!==se&&"\xa336 million to \xa360 million"===se.value?u++:void 0!==se&&"\xa360 million to \xa3100 million"===se.value?c++:void 0!==se&&"\xa3100 million to \xa3500 million"===se.value?d++:void 0!==se&&"Over \xa3500 million"===se.value?f++:h++:Ce.findIndex(Bt=>Bt.company===He.company&&Bt.year===He.year)>=0?Xe.findIndex(Bt=>Bt.company===He.company&&Bt.year===He.year)>=0?void 0!==se&&"Under \xa336 million"===se.value?p++:void 0!==se&&"\xa336 million to \xa360 million"===se.value?g++:void 0!==se&&"\xa360 million to \xa3100 million"===se.value?m++:void 0!==se&&"\xa3100 million to \xa3500 million"===se.value?_++:void 0!==se&&"Over \xa3500 million"===se.value?y++:v++:void 0!==se&&"Under \xa336 million"===se.value?b++:void 0!==se&&"\xa336 million to \xa360 million"===se.value?D++:void 0!==se&&"\xa360 million to \xa3100 million"===se.value?C++:void 0!==se&&"\xa3100 million to \xa3500 million"===se.value?w++:void 0!==se&&"Over \xa3500 million"===se.value?E++:N++:Oe.findIndex(Bt=>Bt.company===He.company&&Bt.year===He.year)>=0?Xe.findIndex(Bt=>Bt.company===He.company&&Bt.year===He.year)>=0?void 0!==se&&"Under \xa336 million"===se.value?k++:void 0!==se&&"\xa336 million to \xa360 million"===se.value?I++:void 0!==se&&"\xa360 million to \xa3100 million"===se.value?L++:void 0!==se&&"\xa3100 million to \xa3500 million"===se.value?B++:void 0!==se&&"Over \xa3500 million"===se.value?T++:A++:void 0!==se&&"Under \xa336 million"===se.value?x++:void 0!==se&&"\xa336 million to \xa360 million"===se.value?F++:void 0!==se&&"\xa360 million to \xa3100 million"===se.value?O++:void 0!==se&&"\xa3100 million to \xa3500 million"===se.value?j++:void 0!==se&&"Over \xa3500 million"===se.value?P++:z++:Xe.findIndex(Bt=>Bt.company===He.company&&Bt.year===He.year)>=0?void 0!==se&&"Under \xa336 million"===se.value?q++:void 0!==se&&"\xa336 million to \xa360 million"===se.value?G++:void 0!==se&&"\xa360 million to \xa3100 million"===se.value?V++:void 0!==se&&"\xa3100 million to \xa3500 million"===se.value?K++:void 0!==se&&"Over \xa3500 million"===se.value?re++:X++:void 0!==se&&"Under \xa336 million"===se.value?le++:void 0!==se&&"\xa336 million to \xa360 million"===se.value?Y++:void 0!==se&&"\xa360 million to \xa3100 million"===se.value?Z++:void 0!==se&&"\xa3100 million to \xa3500 million"===se.value?ne++:void 0!==se&&"Over \xa3500 million"===se.value?W++:he++}this.chartService.uk_legislation_tree_map([{name:"Statements",id:0,alt_name:"Statements"},{name:"Garment Sector",id:1,parent:0,alt_name:"Garment Sector"},{name:"Financial Sector",id:2,parent:0,alt_name:"Financial Sector"},{name:"Hospitality Sector",id:3,parent:0,alt_name:"Hospitality Sector"},{name:"Other",id:4,parent:0,alt_name:"Other"},{id:5,name:"<\xa336M",alt_name:"<\xa336M Garment Sector",parent:1},{id:6,name:"\xa336M-\xa360M",alt_name:"\xa336M-\xa360M Garment Sector",parent:1},{id:7,name:"\xa360M-\xa3100M",alt_name:"\xa360M-\xa3100M Garment Sector",parent:1},{id:8,name:"\xa3100M-\xa3500M",alt_name:"\xa3100M-\xa3500M Garment Sector",parent:1},{id:9,name:">\xa3500M",alt_name:">\xa3500M Garment Sector",parent:1},{id:10,name:"Unknown",alt_name:"Unknown Garment Sector",parent:1},{id:11,name:"<\xa336M",alt_name:"<\xa336M Financial Sector",parent:2},{id:12,name:"\xa336M-\xa360M",alt_name:"\xa336M-\xa360M Financial Sector",parent:2},{id:13,name:"\xa360M-\xa3100M",alt_name:"\xa360M-\xa3100M Financial Sector",parent:2},{id:14,name:"\xa3100M-\xa3500M",alt_name:"\xa3100M-\xa3500M Financial Sector",parent:2},{id:15,name:">\xa3500M",alt_name:">\xa3500M Financial Sector",parent:2},{id:16,name:"Unknown",alt_name:"Unknown Financial Sector",parent:2},{id:17,name:"<\xa336M",alt_name:"<\xa336M Hospitality Sector",parent:3},{id:18,name:"\xa336M-\xa360M",alt_name:"\xa336M-\xa360M Hospitality Sector",parent:3},{id:19,name:"\xa360M-\xa3100M",alt_name:"\xa360M-\xa3100M Hospitality Sector",parent:3},{id:20,name:"\xa3100M-\xa3500M",alt_name:"\xa3100M-\xa3500M Hospitality Sector",parent:3},{id:21,name:">\xa3500M",alt_name:">\xa3500M Hospitality Sector",parent:3},{id:22,name:"Unknown",alt_name:"Unknown Hospitality Sector",parent:3},{id:23,name:"<\xa336M",alt_name:"<\xa336M Other",parent:4},{id:24,name:"\xa336M-\xa360M",alt_name:"\xa336M-\xa360M Other",parent:4},{id:25,name:"\xa360M-\xa3100M",alt_name:"\xa360M-\xa3100M Other",parent:4},{id:26,name:"\xa3100M-\xa3500M",alt_name:"\xa3100M-\xa3500M Other",parent:4},{id:27,name:">\xa3500M",alt_name:">\xa3500M Other",parent:4},{id:28,name:"Unknown",alt_name:"Unknown Other",parent:4},{id:29,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:5,size:n},{id:30,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:5,size:l},{id:31,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:6,size:i},{id:32,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:6,size:u},{id:33,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:7,size:r},{id:34,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:7,size:c},{id:35,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:8,size:s},{id:36,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:8,size:d},{id:37,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:9,size:o},{id:38,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:9,size:f},{id:39,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:10,size:a},{id:40,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:10,size:h},{id:41,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:11,size:p},{id:42,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:11,size:b},{id:43,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:12,size:g},{id:44,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:12,size:D},{id:45,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:13,size:m},{id:46,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:13,size:C},{id:47,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:14,size:_},{id:48,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:14,size:w},{id:49,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:15,size:y},{id:50,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:15,size:E},{id:51,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:16,size:v},{id:52,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:16,size:N},{id:53,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:17,size:k},{id:54,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:17,size:x},{id:55,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:18,size:I},{id:56,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:18,size:F},{id:57,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:19,size:L},{id:58,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:19,size:O},{id:59,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:20,size:B},{id:60,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:20,size:j},{id:61,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:21,size:T},{id:62,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:21,size:P},{id:63,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:22,size:A},{id:64,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:22,size:z},{id:65,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:23,size:q},{id:66,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:23,size:le},{id:67,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:24,size:G},{id:68,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:24,size:Y},{id:69,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:25,size:V},{id:70,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:25,size:Z},{id:71,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:26,size:K},{id:72,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:26,size:ne},{id:73,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:27,size:re},{id:74,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:27,size:W},{id:75,name:"Meet Minimum Requirements",alt_name:"Meet Minimum Requirements",parent:28,size:X},{id:76,name:"Do Not Meet Minimum Requirements",alt_name:"Do Not Meet Minimum Requirements",parent:28,size:he}],"div#tree-map",0,0,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.isLoading=!1})})})})})})})}else alert("Under Construction...")}}return e.\u0275fac=function(n){return new(n||e)(H(Fi),H(ea))},e.\u0275cmp=Nt({type:e,selectors:[["treemap"]],inputs:{sector:"sector"},decls:36,vars:16,consts:[[1,"section","mt-5","bg-neutral-orange","p-4"],[1,"row"],[1,"col-md-4"],[1,"title"],[1,"col-md-8","ms-md-auto"],[1,"row","ps-3","pe-3","pt-md-0","pt-2"],["aria-label","Default select example",1,"msa-form-select","bg-neutral-orange","ms-md-auto","me-3","mb-md-0","mb-1",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],["aria-label","Default select example",1,"msa-form-select","bg-neutral-orange",3,"ngModel","ngModelChange","change"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row","text-center","pt-4",3,"ngClass"],["id","tree-map",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),R(4,"Statements Overview"),M()(),S(5,"div",4)(6,"div",5)(7,"select",6),ke("ngModelChange",function(s){return i.year=s})("change",function(){return i.updateData()}),S(8,"option",7),R(9,"all years"),M(),S(10,"option",7),R(11,"latest"),M(),S(12,"option",8),R(13,"2021"),M(),S(14,"option",8),R(15,"2020"),M(),S(16,"option",8),R(17,"2019"),M(),S(18,"option",8),R(19,"2018"),M(),S(20,"option",8),R(21,"2017"),M(),S(22,"option",8),R(23,"2016"),M(),S(24,"option",8),R(25,"2015"),M()(),S(26,"select",9),ke("ngModelChange",function(s){return i.legislation=s})("change",function(){return i.updateData()}),S(27,"option",7),R(28,"Legislation"),M(),S(29,"option",8),R(30,"UK MSA"),M(),S(31,"option",8),R(32,"AUS MSA"),M()()()()(),Ne(33,jZe,5,0,"div",10),S(34,"div",11),Me(35,"div",12),M()()),2&n&&($(7),U("ngModel",i.year),$(1),U("ngValue",""),$(2),U("ngValue","latest"),$(2),U("ngValue",2021),$(2),U("ngValue",2020),$(2),U("ngValue",2019),$(2),U("ngValue",2018),$(2),U("ngValue",2017),$(2),U("ngValue",2016),$(2),U("ngValue",2015),$(2),U("ngModel",i.legislation),$(1),U("ngValue","both"),$(2),U("ngValue","uk"),$(2),U("ngValue","aus"),$(2),U("ngIf",i.isLoading),$(1),U("ngClass",i.isLoading?"hide-element":"show-element"))},directives:[Gs,ba,Io,wa,Da,zn,Yi],styles:[""]}),e})();const $Ze=JSON.parse('[{"seq":1,"id":1831852,"metric":"Business_Human_Rights_Resource_Centre+MSA_statement_signed","label":"Signed by Appropriate Person","short_label":"signed","color":0,"filter_value":["Signed by CEO","Signed by Director","Signed by Managing Director","Signed by Chairman"]},{"seq":2,"id":1827915,"metric":"Business_Human_Rights_Resource_Centre+MSA_Statement_Approval","label":"Board Approval","short_label":"approved","color":0,"filter_value":["Approved by Board"]},{"seq":3,"id":7046195,"metric":"Walk Free+MSA statement homepage link","label":"Homepage Link","short_label":"homepage","color":0,"filter_value":["Yes"]}]'),VZe=JSON.parse('[{"seq":1,"id":1831852,"metric":"Business_Human_Rights_Resource_Centre+MSA_statement_signed","label":"Signed by Appropriate Person","short_label":"signed","color":0,"filter_value":["Signed by CEO","Signed by Director","Signed by Managing Director","Signed by Chairman"]},{"seq":2,"id":1827915,"metric":"Business_Human_Rights_Resource_Centre+MSA_Statement_Approval","label":"Board Approval","short_label":"approved","color":0,"filter_value":["Approved by Board"]},{"seq":3,"id":12621116,"metric":"Walk_Free+Australian_MSA_Registry_Submission","label":"Registry Submission","short_label":"registry_submission","color":0,"filter_value":["Yes"]},{"seq":4,"id":5454264,"metric":"Walk_Free+MSA_registry_submission","label":"Organizational Structure and Operations","short_label":"organizational_structure","color":0,"filter_value":["Yes"]},{"seq":5,"id":1831908,"metric":"Walk_Free+MSA_supply_chain_disclosure","label":"Supply Chain Disclosure","short_label":"supply_chain_disclosure","color":0,"filter_value":["Geographical","Facility/Supplier"]},{"seq":6,"id":1831932,"metric":"Walk_Free+MSA_Identification_of_risks","label":"Identification of Risks","short_label":"risk_identification","color":0,"filter_value":["Geographic","Resource","Workforce","Industry"]},{"seq":7,"id":2722223,"metric":"Walk_Free+MSA_risk_assessment","label":"Risk Assessment","short_label":"risk_assessment","color":0,"filter_value":["Risk-based questionnaires","Use of risk management tool or software","Conducting desk research"]},{"seq":8,"id":2722169,"metric":"Walk_Free+MSA_risk_management","label":"Risk Management","short_label":"risk_management","color":0,"filter_value":["Audits of suppliers (self- reporting)","Audits of suppliers (independent)","On-site visits (self- reporting)","On-site visits (independent)"]},{"seq":9,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"Incidents Remediation","short_label":"incident_remediation","color":0,"filter_value":["Worker remediation","Corrective action plan","Senior management","Cancel contracts"]},{"seq":10,"id":2722458,"metric":"Walk_Free+MSA_whistleblowing_mechanism_revised","label":"Whistleblowing mechanism","short_label":"whistleblowing_mechanism","color":0,"filter_value":["Hotline, Email, Contact Form (direct employees)","Hotline, Email, Contact Form (supply chain workers)","Whistleblower protection (direct employees)","Whistleblower protection (supply chain workers)","Focal Point (direct employees)","Focal Point (supply chain workers)"]},{"seq":11,"id":1832024,"metric":"Walk_Free+MSA_Performance_Indicators","label":"Key Performance Indicators","short_label":"kpis","color":0,"filter_value":["Yes"]},{"seq":12,"id":8772491,"metric":"Walk_Free+MSA_Consultation_Process","label":"Consultation Process","short_label":"consultation_process","color":0,"filter_value":["Yes"]}]');function HZe(e,t){1&e&&(S(0,"div",22)(1,"div",23)(2,"div",24)(3,"span",25),R(4,"Loading..."),M()()()())}let UZe=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartsService=i,this.year="",this.isLoading=!0}ngOnInit(){}updateData(){let n=this.dataProvider.getCompanyGroup(this.sector);this.isLoading=!0,this.draw_minimum_requirements_pie_chart("Meet Minimun UK Requirements","div#uk-meet-min-requirements",this.dataProvider.metrics.uk_msa_statement_assessed,this.dataProvider.metrics.meet_uk_min_requirements,n),this.chartsService.drawMinimumRequirementsBarChart("Which minimum uk requirements do these companies meet?","div#uk-requirements-bars",350,200,this.dataProvider.metrics.uk_msa_statement_assessed,$Ze,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}),(this.year>=2020||""==this.year||"latest"==this.year)&&(this.draw_minimum_requirements_pie_chart("Meet Minimun Australian Requirements","div#aus-meet-min-requirements",this.dataProvider.metrics.aus_msa_statement_assessed,this.dataProvider.metrics.meet_aus_min_requirements,n),this.chartsService.drawMinimumRequirementsBarChart("Which minimum aus requirements do these companies meet?","div#aus-requirements-bars",350,670,this.dataProvider.metrics.aus_msa_statement_assessed,VZe,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}))}draw_minimum_requirements_pie_chart(n,i,r,s,o){this.dataProvider.getAnswers(r,[new J("year",this.year),new J("value","Yes"),new J("company_group",o)]).subscribe(a=>{let l=a.length;this.dataProvider.getAnswers(s,[new J("year",this.year),new J("value","Yes"),new J("company_group",o)]).subscribe(u=>{u.filter(d=>a.findIndex(f=>f.company==d.company&&f.year==d.year)>=0);let c=u.length;this.chartsService.drawPieChart(n,i,[{value:"Met",count:c,sum_count:l},{value:"Not Met",count:l-c,sum_count:l}],210,180,["#000028","#FF9300"],["Not Met","Met"],{renderer:"svg",actions:{source:!1,editor:!1}})},u=>console.log(u),()=>this.isLoading=!1)})}ngOnChanges(n){this.updateData()}}return e.\u0275fac=function(n){return new(n||e)(H(Fi),H(ea))},e.\u0275cmp=Nt({type:e,selectors:[["minimum-requirements-section"]],inputs:{sector:"sector"},features:[Ht],decls:51,vars:14,consts:[[1,"section","mt-5","bg-neutral-grey","p-4"],[1,"row"],[1,"col-md-8"],[1,"title"],[1,"col-md-4"],["aria-label","Minimum requirements year filter",1,"msa-form-select","ms-md-auto","bg-neutral-grey",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row","mt-2","justify-items-center",3,"ngClass"],[1,"p-3",3,"ngClass"],[1,"row","text-center"],[1,"row","text-center","pt-4"],["id","uk-meet-min-requirements",1,"chart-wrapper"],["id","uk-requirements-bars",1,"chart-wrapper"],[1,"row","pt-4","justify-content-center"],[1,"col-10"],[1,"quote"],[1,"bi","bi-exclamation-diamond","pe-2"],[1,"col-md-6","p-3",3,"ngClass"],["id","aus-meet-min-requirements",1,"chart-wrapper"],["id","aus-requirements-bars",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),R(4,"Meeting Minimum Requirements"),M()(),S(5,"div",4)(6,"select",5),ke("ngModelChange",function(s){return i.year=s})("change",function(){return i.updateData()}),S(7,"option",6),R(8,"all years"),M(),S(9,"option",7),R(10,"latest"),M(),S(11,"option",7),R(12,"2021"),M(),S(13,"option",7),R(14,"2020"),M(),S(15,"option",7),R(16,"2019"),M(),S(17,"option",7),R(18,"2018"),M(),S(19,"option",7),R(20,"2017"),M(),S(21,"option",7),R(22,"2016"),M(),S(23,"option",7),R(24,"2015"),M()()()(),S(25,"div",1)(26,"p"),R(27,"Are company statements compliant with the minimum requirements under the UK or Australian Modern Slavery Act?"),M()(),Ne(28,HZe,5,0,"div",8),S(29,"div",9)(30,"div",10)(31,"div",11)(32,"h4"),R(33,"UK Act"),M()(),S(34,"div",12),Me(35,"div",13),M(),S(36,"div",12),Me(37,"div",14),M(),S(38,"div",15)(39,"div",16)(40,"p",17),Me(41,"i",18),R(42,"The UK legislation only requires three criteria, none of which relate to the quality or content of the statement. While there is accompanying guidance which provides suggested categories \u2013 similar to those which appear within the Australian legislation \u2013 these are not mandatory. Therefore, arguably the Australian legislation is stronger, making a direct comparison of minimum compliance difficult. "),M()()()(),S(43,"div",19)(44,"div",11)(45,"h4"),R(46,"Australian Act"),M()(),S(47,"div",12),Me(48,"div",20),M(),S(49,"div",12),Me(50,"div",21),M()()()()),2&n&&($(6),U("ngModel",i.year),$(1),U("ngValue",""),$(2),U("ngValue","latest"),$(2),U("ngValue",2021),$(2),U("ngValue",2020),$(2),U("ngValue",2019),$(2),U("ngValue",2018),$(2),U("ngValue",2017),$(2),U("ngValue",2016),$(2),U("ngValue",2015),$(5),U("ngIf",i.isLoading),$(1),U("ngClass",i.isLoading?"hide-element":"show-element"),$(1),U("ngClass",i.year>=2020||""==i.year||"latest"==i.year?"col-md-6":"col-md-12"),$(13),U("ngClass",i.year>=2020||""==i.year||"latest"==i.year?"show-element":"hide-element"))},directives:[Gs,ba,Io,wa,Da,zn,Yi],styles:[""]}),e})();const zZe=JSON.parse('[{"seq":1,"id":1831852,"metric":"Business_Human_Rights_Resource_Centre+MSA_statement_signed","label":"Signed by Appropriate Person","short_label":"signed","color":0,"filter_value":["Signed by CEO","Signed by Director","Signed by Managing Director","Signed by Chairman"],"aus_color":"bg-deep-blue","uk_color":"bg-deep-blue"},{"seq":2,"id":1827915,"metric":"Business_Human_Rights_Resource_Centre+MSA_Statement_Approval","label":"Board Approval","short_label":"approved","color":0,"filter_value":["Approved by Board"],"aus_color":"bg-deep-blue","uk_color":"bg-deep-blue"},{"seq":3,"id":12552057,"metric":"Walk_Free+MSA_Statement_Publication","label":"Statement Publication","short_label":"statement_publication","color":0,"filter_value":["Yes"],"aus_color":"bg-deep-blue","uk_color":"bg-deep-blue"},{"seq":4,"id":8772491,"metric":"Walk_Free+MSA_Consultation_Process","label":"Consultation Process","short_label":"consultation_process","color":0,"filter_value":["Yes"],"aus_color":"bg-deep-blue","uk_color":"bg-orange"},{"seq":5,"id":5454264,"metric":"Walk_Free+MSA_registry_submission","label":"Organizational Structure and Operations","short_label":"organizational_structure","color":0,"filter_value":["Yes"],"aus_color":"bg-deep-blue","uk_color":"bg-orange"},{"seq":6,"id":1831908,"metric":"Walk_Free+MSA_supply_chain_disclosure","label":"Supply Chain Disclosure","short_label":"supply_chain_disclosure","color":0,"filter_value":["Geographical","Facility/Supplier"],"aus_color":"bg-deep-blue","uk_color":"bg-orange"},{"seq":7,"id":2722057,"metric":"Walk Free+MSA policy (revised)","label":"Supply Chain Policies","short_label":"policies","color":0,"filter_value":["Suppliers comply with laws and company\u2019s policies (direct / tier 1)","Suppliers comply with laws and company\u2019s policies (beyond tier 1)","Prohibit use of forced labour (direct / tier 1)","Prohibit use of forced labour (beyond tier 1)","Code of conduct or supplier code includes clauses on slavery and human trafficking (direct / tier 1)","Code of conduct or supplier code includes clauses on slavery and human trafficking (beyond tier 1)","Contracts include clauses on forced labour (direct / tier 1)","Contracts include clauses on forced labour (beyond tier 1)","Suppliers produce their own statement (direct / tier 1)","Suppliers produce their own statement (beyond tier 1)","Prohibit charging of recruitment fees to employee (direct / tier 1)","Prohibit charging of recruitment fees to employee (beyond tier 1)","Prohibit use of child labour (direct / tier 1)","Prohibit use of child labour (beyond tier 1)","Suppliers protect migrant workers (direct / tier 1)","Suppliers protect migrant workers (beyond tier 1)","Suppliers respect labour rights (wages / freedom of association etc) (direct / tier 1)","Suppliers respect labour rights (wages / freedom of association etc) (beyond tier 1)"],"aus_color":"bg-orange","uk_color":"bg-orange"},{"seq":8,"id":2722223,"metric":"Walk_Free+MSA_risk_assessment","label":"Risk Assessment","short_label":"risk_assessment","color":0,"filter_value":["Risk-based questionnaires","Use of risk management tool or software","Conducting desk research"],"aus_color":"bg-deep-blue","uk_color":"bg-orange"},{"seq":9,"id":1831932,"metric":"Walk_Free+MSA_Identification_of_risks","label":"Identification of Risks","short_label":"risk_identification","color":0,"filter_value":["Geographic","Resource","Workforce","Industry"],"aus_color":"bg-deep-blue","uk_color":"bg-orange"},{"seq":10,"id":2722169,"metric":"Walk_Free+MSA_risk_management","label":"Risk Management","short_label":"risk_management","color":0,"filter_value":["Audits of suppliers (self- reporting)","Audits of suppliers (independent)","On-site visits (self- reporting)","On-site visits (independent)"],"aus_color":"bg-deep-blue","uk_color":"bg-orange"},{"seq":11,"id":2722458,"metric":"Walk_Free+MSA_whistleblowing_mechanism_revised","label":"Whistleblowing mechanism","short_label":"whistleblowing_mechanism","color":0,"filter_value":["Hotline, Email, Contact Form (direct employees)","Hotline, Email, Contact Form (supply chain workers)","Whistleblower protection (direct employees)","Whistleblower protection (supply chain workers)","Focal Point (direct employees)","Focal Point (supply chain workers)"],"aus_color":"bg-deep-blue","uk_color":"bg-orange"},{"seq":12,"id":1831964,"metric":"Walk Free+MSA incidents identified","label":"Incidents Identification","short_label":"incident_identification","color":0,"filter_value":["Yes"],"aus_color":"bg-orange","uk_color":"bg-orange"},{"seq":13,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"Incidents Remediation","short_label":"incident_remediation","color":0,"filter_value":["Worker remediation","Corrective action plan","Senior management","Cancel contracts"],"aus_color":"bg-deep-blue","uk_color":"bg-orange"},{"seq":14,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Modern Slavery Training","short_label":"training","color":0,"filter_value":["Employees (all)","Procurement / purchasing","Recruitment / HR","Leadership","Suppliers","Training provided - not specified to who"],"aus_color":"bg-orange","uk_color":"bg-orange"},{"seq":15,"id":1832024,"metric":"Walk_Free+MSA_Performance_Indicators","label":"Key Performance Indicators","short_label":"kpis","color":0,"filter_value":["Yes"],"aus_color":"bg-deep-blue","uk_color":"bg-orange"},{"seq":16,"id":1832012,"metric":"Walk_Free+MSA_Business_Performance_Indicators","label":"Business Performance Indicators","short_label":"business_kpis","color":0,"filter_value":["Yes"],"aus_color":"bg-orange","uk_color":"bg-orange"}]');function qZe(e,t){1&e&&(S(0,"div",17)(1,"div",18)(2,"div",19)(3,"span",20),R(4,"Loading..."),M()()()())}function GZe(e,t){if(1&e){const n=Hs();S(0,"tr",21)(1,"td",22)(2,"a",23),R(3),M()(),S(4,"td",24),ke("click",function(){const s=ur(n).$implicit;return Et().openURL(s.url)}),R(5),ga(6,"percentageFormat"),M(),S(7,"td",25),ke("click",function(){const s=ur(n).$implicit;return Et().openURL(s.url)}),R(8),ga(9,"percentageFormat"),M(),S(10,"td",25),ke("click",function(){const s=ur(n).$implicit;return Et().openURL(s.url)}),R(11),ga(12,"percentageFormat"),M()()}if(2&e){const n=t.$implicit;$(2),Z0("href",n.url,V0),$(1),ki(n.name),$(2),ki(ma(6,11,n.total)),$(2),BT("col-2 clickable text-center ",n.uk_color,""),$(1),ki(ma(9,13,n.uk)),$(2),BT("col-2 clickable text-center ",n.aus_color,""),$(1),ki(ma(12,15,n.aus))}}const gA=function(e){return{active:e}};let WZe=(()=>{class e{constructor(n){this.dataProvider=n,this.year="",this.beyond_compliance_table_data=[],this.active="name",this.isLoading=!0,this.garment_avg_disclosure_rate=0,this.financial_avg_disclosure_rate=0,this.hospitality_avg_disclosure_rate=0}ngOnInit(){}updateBeyondComplianceTable(){this.active="name",this.beyond_compliance_table_data=[],this.isLoading=!0;let n=this.dataProvider.getCompanyGroup(this.sector);this.dataProvider.getAnswers(this.dataProvider.metrics.uk_msa_statement_assessed,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(i=>{let r=i.map(s=>({company:s.company,year:s.year}));this.dataProvider.getAnswers(this.dataProvider.metrics.aus_msa_statement_assessed,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(s=>{let o=s.map(l=>({company:l.company,year:l.year})),a=[...new Set([...r,...o])];a=a.filter((l,u,c)=>u===c.findIndex(d=>d.company===l.company&&d.year===l.year));for(let l of zZe)this.dataProvider.getAnswers(l.id,[new J("year",this.year),new J("value",l.filter_value)]).subscribe(u=>{let c=0,d=0,f=0;for(let _ of u){let y=void 0!==r.find(b=>b.company==_.company&&b.year==_.year),v=void 0!==o.find(b=>b.company==_.company&&b.year==_.year);y&&c++,v&&d++,(y||v)&&f++}let h=Math.round(100*c/r.length),p=Math.round(100*d/o.length),g=Math.round(100*f/a.length),m="";for(let _ of l.filter_value)m+="filter[value][]="+_+"&";this.beyond_compliance_table_data.push("Consultation Process"==l.label?{name:l.label,url:"https://wikirate.org/"+l.metric+"?filter[year]="+this.year+"&"+m.substring(0,m.length+1),uk:"N/A",aus:p,total:"N/A",aus_color:l.aus_color,uk_color:l.uk_color}:{name:l.label,url:"https://wikirate.org/"+l.metric+"?filter[year]="+this.year+"&"+m.substring(0,m.length+1),uk:h,aus:p,total:g,aus_color:l.aus_color,uk_color:l.uk_color})});setTimeout(()=>{this.isLoading=!1},1e3)})})}sort(n){this.beyond_compliance_table_data.sort((i,r)=>"N/A"==r[n]||i[n]>r[n]?-1:1),this.active=n}openURL(n){window.open(n,"_blank")}ngOnChanges(n){this.updateBeyondComplianceTable()}}return e.\u0275fac=function(n){return new(n||e)(H(Fi))},e.\u0275cmp=Nt({type:e,selectors:[["going-beyond-compliance"]],inputs:{sector:"sector"},features:[Ht],decls:45,vars:25,consts:[[1,"section","mt-5","bg-neutral-orange","p-4"],[1,"row"],[1,"col-md-8"],[1,"title"],[1,"col-md-4"],["aria-label","Minimum requirements year filter",1,"msa-form-select","ms-md-auto","bg-neutral-orange",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],[1,"col-md-12"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row","p-2","row","justify-content-center",3,"ngClass"],[1,"table","table-bordered","border-light"],[1,"bg-light-orange"],["scope","col",1,"clickable-header","text-end",3,"ngClass","click"],["scope","col",1,"text-center","clickable-header","active",3,"ngClass","click"],["scope","col",1,"text-center","clickable-header",3,"ngClass","click"],["class","text-white",4,"ngFor","ngForOf"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"],[1,"text-white"],[1,"col-4","text-end","bg-neutral-blue"],["target","_blank",1,"metric",3,"href"],[1,"col-2","clickable","text-center","bg-deep-blue",3,"click"],[3,"click"]],template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),R(4,"Going Beyond Compliance"),M()(),S(5,"div",4)(6,"select",5),ke("ngModelChange",function(s){return i.year=s})("change",function(){return i.updateBeyondComplianceTable()}),S(7,"option",6),R(8,"all years"),M(),S(9,"option",7),R(10,"latest"),M(),S(11,"option",7),R(12,"2021"),M(),S(13,"option",7),R(14,"2020"),M(),S(15,"option",7),R(16,"2019"),M(),S(17,"option",7),R(18,"2018"),M(),S(19,"option",7),R(20,"2017"),M(),S(21,"option",7),R(22,"2016"),M(),S(23,"option",7),R(24,"2015"),M()()(),S(25,"div",1)(26,"div",8)(27,"p"),R(28,"Beyond minimum requirements, the accompanying guidance of the MSAs outlines the measures and actions companies should take to ensure their operations and supply chains are free from exploitation. Click on a metric to find out more about what it entails. "),M()()()(),Ne(29,qZe,5,0,"div",9),S(30,"div",10)(31,"div",8)(32,"table",11)(33,"thead")(34,"tr",12)(35,"th",13),ke("click",function(){return i.sort("name")}),R(36,"Metric "),M(),S(37,"th",14),ke("click",function(){return i.sort("total")}),R(38,"Total "),M(),S(39,"th",15),ke("click",function(){return i.sort("uk")}),R(40,"UK "),M(),S(41,"th",15),ke("click",function(){return i.sort("aus")}),R(42,"AUS "),M()()(),S(43,"tbody"),Ne(44,GZe,13,17,"tr",16),M()()()()()),2&n&&($(6),U("ngModel",i.year),$(1),U("ngValue",""),$(2),U("ngValue","latest"),$(2),U("ngValue",2021),$(2),U("ngValue",2020),$(2),U("ngValue",2019),$(2),U("ngValue",2018),$(2),U("ngValue",2017),$(2),U("ngValue",2016),$(2),U("ngValue",2015),$(6),U("ngIf",i.isLoading),$(1),U("ngClass",i.isLoading?"hide-element":"show-element"),$(5),U("ngClass",Fc(17,gA,"name"===i.active)),$(2),U("ngClass",Fc(19,gA,"total"===i.active)),$(2),U("ngClass",Fc(21,gA,"uk"===i.active)),$(2),U("ngClass",Fc(23,gA,"aus"===i.active)),$(3),U("ngForOf",i.beyond_compliance_table_data))},directives:[Gs,ba,Io,wa,Da,zn,Yi,Nf],pipes:[jq],styles:[".metric[_ngcontent-%COMP%]{font-size:1.2em}"]}),e})();function YZe(e,t){1&e&&(S(0,"div",15)(1,"div",16)(2,"div",17)(3,"span",18),R(4,"Loading..."),M()()()())}let KZe=(()=>{class e{constructor(n){this.dataProvider=n,this.year="",this.isLoading=!0,this.garment_avg_disclosure_rate=0,this.financial_avg_disclosure_rate=0,this.hospitality_avg_disclosure_rate=0}ngOnInit(){this.updateDisclosureRates()}updateDisclosureRates(){this.isLoading=!0,this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new J("year",this.year),new J("value","Yes"),new J("company_group","MSA Garment")]).subscribe(n=>{this.dataProvider.getAnswers(this.dataProvider.metrics.msa_disclosure_rate,[new J("year",this.year),new J("company_group","MSA Garment")]).subscribe(i=>{this.garment_avg_disclosure_rate=0,i=i.filter(r=>n.some(s=>s.company==r.company&&s.year==r.year));for(let r of i)this.garment_avg_disclosure_rate+=Number(r.value);this.garment_avg_disclosure_rate=Math.round(this.garment_avg_disclosure_rate/i.length),this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new J("year",this.year),new J("value","Yes"),new J("company_group","MSA Financial")]).subscribe(r=>{this.dataProvider.getAnswers(this.dataProvider.metrics.msa_disclosure_rate,[new J("year",this.year),new J("company_group","MSA Financial")]).subscribe(s=>{this.financial_avg_disclosure_rate=0,s=s.filter(o=>r.some(a=>a.company==o.company&&a.year==o.year));for(let o of s)this.financial_avg_disclosure_rate+=Number(o.value);this.financial_avg_disclosure_rate=Math.round(this.financial_avg_disclosure_rate/s.length)})})}),this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new J("year",this.year),new J("value","Yes"),new J("company_group","MSA Hospitality")]).subscribe(i=>{this.dataProvider.getAnswers(this.dataProvider.metrics.msa_disclosure_rate,[new J("year",this.year),new J("company_group","MSA Hospitality")]).subscribe(r=>{this.hospitality_avg_disclosure_rate=0,r=r.filter(s=>i.some(o=>o.company==s.company&&o.year==s.year));for(let s of r)this.hospitality_avg_disclosure_rate+=Number(s.value);this.hospitality_avg_disclosure_rate=Math.round(this.hospitality_avg_disclosure_rate/r.length)},r=>console.log(r),()=>this.isLoading=!1)})})}openURL(n){window.open(`${this.dataProvider.wikirateApiHost}/~${this.dataProvider.metrics.msa_disclosure_rate}?filter[company_group][]=${n}&filter[year]=${this.year}`,"_blank")}}return e.\u0275fac=function(n){return new(n||e)(H(Fi))},e.\u0275cmp=Nt({type:e,selectors:[["disclosure-rates"]],decls:56,vars:21,consts:[[1,"section","mt-5","bg-neutral-grey","p-4"],[1,"row"],[1,"col-md-8"],[1,"title"],[1,"col-md-4"],["aria-label","Minimum requirements year filter",1,"msa-form-select","ms-md-auto","bg-neutral-grey",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],[1,"col-md-12"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"disclosure-rates",3,"ngClass"],[1,"row","justify-content-center"],[1,"number-box","m-md-3","m-1",3,"click"],[1,"msa-primary-info-md"],[1,"highlighted-number-lg"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),R(4,"Disclosure Rates"),M()(),S(5,"div",4)(6,"select",5),ke("ngModelChange",function(s){return i.year=s})("change",function(){return i.updateDisclosureRates()}),S(7,"option",6),R(8,"all years"),M(),S(9,"option",7),R(10,"latest"),M(),S(11,"option",7),R(12,"2021"),M(),S(13,"option",7),R(14,"2020"),M(),S(15,"option",7),R(16,"2019"),M(),S(17,"option",7),R(18,"2018"),M(),S(19,"option",7),R(20,"2017"),M(),S(21,"option",7),R(22,"2016"),M(),S(23,"option",7),R(24,"2015"),M()()()(),S(25,"div",1)(26,"div",8)(27,"p"),R(28,"Average number of measures and actions reported by companies in their modern slavery statements."),M()()(),Ne(29,YZe,5,0,"div",9),S(30,"div",10)(31,"div",11)(32,"div",12),ke("click",function(){return i.openURL("MSA Garment")}),S(33,"div",13)(34,"span",14),R(35),ga(36,"numFormat"),M(),R(37,"/15 "),S(38,"h5"),R(39,"Garment Industry"),M()()(),S(40,"div",12),ke("click",function(){return i.openURL("MSA Financial")}),S(41,"div",13)(42,"span",14),R(43),ga(44,"numFormat"),M(),R(45,"/15 "),S(46,"h5"),R(47,"Financial Industry"),M()()(),S(48,"div",12),ke("click",function(){return i.openURL("MSA Hospitality")}),S(49,"div",13)(50,"span",14),R(51),ga(52,"numFormat"),M(),R(53,"/15 "),S(54,"h5"),R(55,"Hospitality Industry"),M()()()()()()),2&n&&($(6),U("ngModel",i.year),$(1),U("ngValue",""),$(2),U("ngValue","latest"),$(2),U("ngValue",2021),$(2),U("ngValue",2020),$(2),U("ngValue",2019),$(2),U("ngValue",2018),$(2),U("ngValue",2017),$(2),U("ngValue",2016),$(2),U("ngValue",2015),$(6),U("ngIf",i.isLoading),$(1),U("ngClass",i.isLoading?"hide-element":"show-element"),$(5),ki(ma(36,15,i.garment_avg_disclosure_rate)),$(8),ki(ma(44,17,i.financial_avg_disclosure_rate)),$(8),ki(ma(52,19,i.hospitality_avg_disclosure_rate)))},directives:[Gs,ba,Io,wa,Da,zn,Yi],pipes:[Lq],styles:[""]}),e})();const NB=JSON.parse('[{"seq":1,"id":12616892,"metric":"Walk Free+MSA policy (grouped)","label":"Direct supply chain","short_label":"direct_supply_chain","color":0,"filter_value":["Direct Supply Chain","Both"]},{"seq":2,"id":12616892,"metric":"Walk Free+MSA policy (grouped)","label":"Beyond tier 1 supply chain","short_label":"beyond_t1","color":0,"filter_value":["Beyond Tier 1 Supply Chain","Both"]},{"seq":3,"id":12616892,"metric":"Walk Free+MSA policy (grouped)","label":"Both","short_label":"both","color":3,"filter_value":["Both"]},{"seq":4,"id":12616892,"metric":"Walk Free+MSA policy (grouped)","label":"None of the above","short_label":"none_of_the_above","color":1,"filter_value":["Neither","Unknown"]}]');function JZe(e,t){1&e&&(S(0,"div",6)(1,"div",7)(2,"div",8)(3,"span",9),R(4,"Loading..."),M()()()())}let XZe=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartsService=i,this.isLoading=!0}ngOnInit(){}ngOnChanges(n){this.updateData()}updateData(){let n=this.dataProvider.getCompanyGroup(this.sector);this.isLoading=!0,this.chartsService.drawBarChart("Modern Slavery Supply Chain Policies","div#modern-slavery-supply-chain-policies",350,250,this.dataProvider.metrics.msa_statement_assessed,NB,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>this.isLoading=!1)}}return e.\u0275fac=function(n){return new(n||e)(H(Fi),H(ea))},e.\u0275cmp=Nt({type:e,selectors:[["approach-to-policies"]],inputs:{year:"year",sector:"sector"},features:[Ht],decls:16,vars:2,consts:[["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row",3,"ngClass"],[1,"col-md-12"],[1,"row"],[1,"row","text-center","pt-2"],["id","modern-slavery-supply-chain-policies",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(Ne(0,JZe,5,0,"div",0),S(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5"),R(5,"MODERN SLAVERY SUPPLY CHAIN POLICIES"),M(),S(6,"p"),R(7,"Does the company's statement detail clear, organisational modern slavery policies that apply to their "),S(8,"b"),R(9,"direct"),M(),R(10," and/or "),S(11,"b"),R(12,"beyond tier 1"),M(),R(13," supply chain?"),M()(),S(14,"div",4),Me(15,"div",5),M()()()),2&n&&(U("ngIf",i.isLoading),$(1),U("ngClass",i.isLoading?"hide-element":"show-element"))},directives:[zn,Yi],styles:[""]}),e})();const kB=JSON.parse('[{"seq":1,"id":6948985,"metric":"Walk Free+MSA risk assessment","label":"Risk-based questionnaires","short_label":"risk_based_questionnaires","color":0,"filter_value":["Risk-based questionnaires"]},{"seq":2,"id":6948985,"metric":"Walk Free+MSA risk assessment","label":"Use of risk management tool or software","short_label":"use_of_risk_mng_tool","color":0,"filter_value":["Use of risk management tool or software"]},{"seq":3,"id":6948985,"metric":"Walk Free+MSA risk assessment","label":"Conducting desk research","short_label":"desk_research","color":0,"filter_value":["Conducting research"]},{"seq":4,"id":6948985,"metric":"Walk Free+MSA risk assessment","label":"None of the above","short_label":"none_of_the_above","color":1,"filter_value":["None"]}]'),IB=JSON.parse('[{"seq":1,"id":6949027,"metric":"Walk_Free+MSA_Identification_of_risks","label":"Geographic/Risk Region","short_label":"geographic","color":0,"filter_value":["Geographic"]},{"seq":2,"id":6949027,"metric":"Walk_Free+MSA_Identification_of_risks","label":"Industry Risk","short_label":"industry","color":0,"filter_value":["Industry"]},{"seq":3,"id":6949027,"metric":"Walk_Free+MSA_Identification_of_risks","label":"Resource Risk","short_label":"resource","color":0,"filter_value":["Resource"]},{"seq":4,"id":6949027,"metric":"Walk_Free+MSA_Identification_of_risks","label":"Workforce Risk","short_label":"workforce_risk","color":0,"filter_value":["Workforce"]},{"seq":5,"id":6949027,"metric":"Walk_Free+MSA_Identification_of_risks","label":"None of the above","short_label":"none_of_the_above","color":1,"filter_value":["None"]}]');function QZe(e,t){1&e&&(S(0,"div",9)(1,"div",10)(2,"div",11)(3,"span",12),R(4,"Loading..."),M()()()())}let ZZe=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartsService=i,this.isLoading=!0}ngOnChanges(n){this.updateData()}ngOnInit(){}updateData(){let n=this.dataProvider.getCompanyGroup(this.sector);this.isLoading=!0,this.chartsService.drawBarChart("Risk Assessment","div#risk-assessment",350,200,this.dataProvider.metrics.msa_statement_assessed,kB,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.chartsService.drawBarChart("Risks identified by risk category","div#risk-identification",350,250,this.dataProvider.metrics.msa_statement_assessed,IB,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>this.chartsService.drawSubgroupsBarChart("Risks Management","div#risk-management",350,this.dataProvider.metrics.msa_statement_assessed,6948944,{name:"subgroups",values:[{key:"(self- reporting)",label:"Self reporting",color:0,seq:1},{key:"(independent)",label:"Independent",color:1,seq:2}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},{name:"groups",values:[{title:"Audits of suppliers",term:"Audits of suppliers",seq:1},{title:"On-site visits",term:"On-site visits",seq:2},{title:"Neither",term:"Neither",seq:3}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}})).finally(()=>this.isLoading=!1)})}}return e.\u0275fac=function(n){return new(n||e)(H(Fi),H(ea))},e.\u0275cmp=Nt({type:e,selectors:[["approach-to-risks"]],inputs:{year:"year",sector:"sector"},features:[Ht],decls:27,vars:3,consts:[["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row",3,"ngClass"],[1,"col-md-12"],[1,"row"],[1,"row","text-center","pt-2"],["id","risk-assessment",1,"chart-wrapper"],["id","risk-identification",1,"chart-wrapper"],[1,"row","justify-content-md-center","mt-md-3",3,"ngClass"],["id","risk-management",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(Ne(0,QZe,5,0,"div",0),S(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5"),R(5,"RISK ASSESSMENT TOOLS"),M(),S(6,"p"),R(7,"used to identify high risk factors in operations"),M()(),S(8,"div",4),Me(9,"div",5),M()(),S(10,"div",2)(11,"div",3)(12,"h5"),R(13,"TYPES OF RISKS IDENTIFIED"),M(),S(14,"p"),R(15,"as likely to occur within operations"),M()(),S(16,"div",4),Me(17,"div",6),M()()(),S(18,"div",7)(19,"div",2)(20,"div",3)(21,"h5"),R(22,"RISK MANAGEMENT SYSTEM"),M(),S(23,"p"),R(24,"used to keep an eye on (high risk) operations"),M()(),S(25,"div",4),Me(26,"div",8),M()()()),2&n&&(U("ngIf",i.isLoading),$(1),U("ngClass",i.isLoading?"hide-element":"show-element"),$(17),U("ngClass",i.isLoading?"hide-element":"show-element"))},directives:[zn,Yi],styles:[""]}),e})();const RB=JSON.parse('[{"seq":1,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"Worker remediation","short_label":"worker_remediation","color":0,"filter_value":["Worker remediation"]},{"seq":2,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"Incidents remediation","short_label":"corrective_action_plan","color":0,"filter_value":["Corrective action plan"]},{"seq":3,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"Senior management","short_label":"senior_management","color":0,"filter_value":["Senior management"]},{"seq":4,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"Cancel contracts","short_label":"cancel_contracts","color":0,"filter_value":["Cancel contracts"]},{"seq":5,"id":2722444,"metric":"Walk_Free+MSA_incidents_remediation_revised","label":"None of the Above","short_label":"none_of_the_above","color":1,"filter_value":["In Development","No"]}]'),FB=JSON.parse('[{"seq":1,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Employees (all)","short_label":"employees","color":0,"filter_value":["Employees (all)"]},{"seq":2,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Procurement / purchasing","short_label":"procurement","color":0,"filter_value":["Procurement / purchasing"]},{"seq":3,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Recruitment / HR","short_label":"recruitment","color":0,"filter_value":["Recruitment / HR"]},{"seq":4,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Leadership","short_label":"leadership","color":0,"filter_value":["Leadership"]},{"seq":5,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Suppliers","short_label":"suppliers","color":0,"filter_value":["Suppliers"]},{"seq":6,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Training provided - not specified to who","short_label":"training_provided","color":0,"filter_value":["Training provided - not specified"]},{"seq":7,"id":2722482,"metric":"Walk Free+MSA training (revised)","label":"Any of the above","short_label":"any_of_the_above","color":3,"filter_value":["Training provided - not specified","Suppliers","Leadership","Recruitment / HR","Procurement / purchasing","Employees (all)"]}]');function eet(e,t){1&e&&(S(0,"div",9)(1,"div",10)(2,"div",11)(3,"span",12),R(4,"Loading..."),M()()()())}let tet=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartsService=i,this.isLoading=!0}ngOnInit(){}ngOnChanges(n){this.updateData()}updateData(){let n=this.dataProvider.getCompanyGroup(this.sector);this.isLoading=!0,this.chartsService.drawSubgroupsBarChart("Whistleblowing or Grievance Mechanisms","div#whistleblowing-mechanisms",300,this.dataProvider.metrics.msa_statement_assessed,2722458,{name:"subgroups",values:[{key:"(direct employees)",label:"Direct employees",color:0,seq:1},{key:"(supply chain workers)",label:"Supply chain workers",color:1,seq:2},{key:"",label:"Direct employees",color:2,seq:3}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},{name:"groups",values:[{title:"Whistleblower protection",term:"Whistleblower protection",seq:1},{title:"Hotline, Email, Contact Form",term:"Hotline",seq:2},{title:"Focal Point",term:"Focal Point",seq:3},{title:"None of the Above",term:"No",seq:3}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.chartsService.drawBarChart("Incidents Remediation","div#incident-remediation",350,250,this.dataProvider.metrics.msa_statement_assessed,RB,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.chartsService.drawBarChart("Modern Slavery Training","div#training",350,350,this.dataProvider.metrics.msa_statement_assessed,FB,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.isLoading=!1})})})}}return e.\u0275fac=function(n){return new(n||e)(H(Fi),H(ea))},e.\u0275cmp=Nt({type:e,selectors:[["approach-to-incidents"]],inputs:{year:"year",sector:"sector"},features:[Ht],decls:27,vars:3,consts:[["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row",3,"ngClass"],[1,"col-md-12"],[1,"row"],[1,"row","text-center","pt-2"],["id","training",1,"chart-wrapper"],["id","whistleblowing-mechanisms",1,"chart-wrapper"],[1,"row","justify-content-md-center",3,"ngClass"],["id","incident-remediation",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(Ne(0,eet,5,0,"div",0),S(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5"),R(5,"MODERN SLAVERY TRAINING"),M(),S(6,"p"),R(7,"provided to increase chances of staff identifying incidents and avoiding practices that increase chances of incidents occuring "),M()(),S(8,"div",4),Me(9,"div",5),M()(),S(10,"div",2)(11,"div",3)(12,"h5"),R(13,"GRIEVANCE MECHANISMS"),M(),S(14,"p"),R(15,"provided to increase likelihood of incidents being reported"),M()(),S(16,"div",4),Me(17,"div",6),M()()(),S(18,"div",7)(19,"div",2)(20,"div",3)(21,"h5"),R(22,"REMEDIATION STRATEGY"),M(),S(23,"p"),R(24,"deployed when specific incidents are identified"),M()(),S(25,"div",4),Me(26,"div",8),M()()()),2&n&&(U("ngIf",i.isLoading),$(1),U("ngClass",i.isLoading?"hide-element":"show-element"),$(17),U("ngClass",i.isLoading?"hide-element":"show-element"))},directives:[zn,Yi],styles:[""]}),e})();function net(e,t){1&e&&(S(0,"div",29)(1,"div",30)(2,"div",31)(3,"span",32),R(4,"Loading..."),M()()()())}let iet=(()=>{class e{constructor(n){this.dataProvider=n,this.year="",this.percentage_of_companies_identified_incidents=0,this.percentage_of_companies_report_policy_beyond_t1=0,this.percentage_of_companies_identified_risks=0,this.isLoading=!0}ngOnChanges(n){this.updateData()}ngOnInit(){}updateData(){let n=this.dataProvider.getCompanyGroup(this.sector);this.isLoading=!0,this.dataProvider.getAnswers(this.dataProvider.metrics.aus_msa_statement_assessed,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(i=>{this.dataProvider.getAnswers(this.dataProvider.metrics.uk_msa_statement_assessed,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(r=>{let s=[...new Set([...i,...r])];s=s.filter((o,a,l)=>a===l.findIndex(u=>u.company===o.company&&u.year===o.year)),this.dataProvider.getAnswers(1831964,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(o=>{o=o.filter(a=>s.some(l=>l.company==a.company&&l.year==a.year)),this.percentage_of_companies_identified_incidents=Math.round(100*o.length/s.length),this.dataProvider.getAnswers(6916242,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(a=>{a=a.filter(l=>s.some(u=>u.company==l.company&&u.year==l.year)),this.percentage_of_companies_identified_risks=Math.round(100*a.length/s.length),this.dataProvider.getAnswers(6915846,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(l=>{l=l.filter(u=>s.some(c=>c.company==u.company&&c.year==u.year)),this.percentage_of_companies_report_policy_beyond_t1=Math.round(100*l.length/s.length)})})},o=>{console.log(o)},()=>this.isLoading=!1)})})}}return e.\u0275fac=function(n){return new(n||e)(H(Fi))},e.\u0275cmp=Nt({type:e,selectors:[["further-findings"]],inputs:{sector:"sector"},features:[Ht],decls:88,vars:22,consts:[[1,"section","mt-5","bg-neutral-orange","p-4"],[1,"row"],[1,"col-md-8"],[1,"title"],[1,"col-md-4"],["aria-label","Minimum requirements year filter",1,"msa-form-select","ms-md-auto","bg-neutral-orange",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row","mt-3","mb-3",3,"ngClass"],[1,"col-md-4","pe-md-2"],[1,"msa-primary-info"],[1,"row","dive-deeper","mt-3",3,"ngClass"],[1,"col-md-4","mb-md-0","mb-3"],["id","approach_to_policies",1,"accordion"],[1,"accordion-item"],["id","approachToPoliciesTitle",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#approach-to-policies","aria-expanded","false","aria-controls","collapseThree",1,"accordion-button","collapsed"],["id","approach-to-policies","aria-labelledby","approachToPoliciesTitle","data-bs-parent","#approach_to_policies",1,"accordion-collapse","collapse"],[1,"accordion-body"],[3,"year","sector"],["id","approach_to_risks_accordion",1,"accordion"],["id","headingThree",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#collapseThree","aria-expanded","false","aria-controls","collapseThree",1,"accordion-button","collapsed"],["id","collapseThree","aria-labelledby","headingThree","data-bs-parent","#approach_to_risks_accordion",1,"accordion-collapse","collapse"],["id","approach_to_incidents",1,"accordion"],["id","headingApproachToIncidents",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#collapseApproachToIncidents","aria-expanded","false","aria-controls","collapseApproachToIncidents",1,"accordion-button","collapsed"],["id","collapseApproachToIncidents","aria-labelledby","headingApproachToIncidents","data-bs-parent","#approach_to_incidents",1,"accordion-collapse","collapse"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),R(4,"Further Findings"),M()(),S(5,"div",4)(6,"select",5),ke("ngModelChange",function(s){return i.year=s})("change",function(){return i.updateData()}),S(7,"option",6),R(8,"all years"),M(),S(9,"option",7),R(10,"latest"),M(),S(11,"option",7),R(12,"2021"),M(),S(13,"option",7),R(14,"2020"),M(),S(15,"option",7),R(16,"2019"),M(),S(17,"option",7),R(18,"2018"),M(),S(19,"option",7),R(20,"2017"),M(),S(21,"option",7),R(22,"2016"),M(),S(23,"option",7),R(24,"2015"),M()()()(),Ne(25,net,5,0,"div",8),S(26,"div",9)(27,"div",10)(28,"div",1)(29,"div",11),R(30),M()(),S(31,"div",1)(32,"p"),R(33,"of companies report having a modern slavery "),S(34,"b"),R(35,"policy that applies to stakeholders beyond the 1st tier"),M(),R(36," of their supply chain"),M()()(),S(37,"div",4)(38,"div",1)(39,"div",11),R(40),M()(),S(41,"div",1)(42,"p"),R(43,"of companies have "),S(44,"b"),R(45,"identified risks likely to occur"),M(),R(46," within operations"),M()()(),S(47,"div",10)(48,"div",1)(49,"div",11),R(50),M()(),S(51,"div",1)(52,"p"),R(53,"of companies have "),S(54,"b"),R(55,"identified a specific incident of modern slavery"),M(),R(56," in their own and/or supply chain operations"),M()()()(),S(57,"div",12)(58,"div",13)(59,"div",14)(60,"div",15)(61,"h2",16)(62,"button",17)(63,"h4"),R(64,"Policies"),M()()(),S(65,"div",18)(66,"div",19),Me(67,"approach-to-policies",20),M()()()()(),S(68,"div",13)(69,"div",21)(70,"div",15)(71,"h2",22)(72,"button",23)(73,"h4"),R(74,"Risks"),M()()(),S(75,"div",24)(76,"div",19),Me(77,"approach-to-risks",20),M()()()()(),S(78,"div",13)(79,"div",25)(80,"div",15)(81,"h2",26)(82,"button",27)(83,"h4"),R(84,"Incidents"),M()()(),S(85,"div",28)(86,"div",19),Me(87,"approach-to-incidents",20),M()()()()()()()),2&n&&($(6),U("ngModel",i.year),$(1),U("ngValue",""),$(2),U("ngValue","latest"),$(2),U("ngValue",2021),$(2),U("ngValue",2020),$(2),U("ngValue",2019),$(2),U("ngValue",2018),$(2),U("ngValue",2017),$(2),U("ngValue",2016),$(2),U("ngValue",2015),$(2),U("ngIf",i.isLoading),$(1),U("ngClass",i.isLoading?"hide-element":"show-element"),$(4),Pr("",i.percentage_of_companies_report_policy_beyond_t1,"%"),$(10),Pr("",i.percentage_of_companies_identified_risks,"%"),$(10),Pr("",i.percentage_of_companies_identified_incidents,"%"),$(7),U("ngClass",i.isLoading?"hide-element":"show-element"),$(10),U("year",i.year)("sector",i.sector),$(10),U("year",i.year)("sector",i.sector),$(10),U("year",i.year)("sector",i.sector))},directives:[Gs,ba,Io,wa,Da,zn,Yi,XZe,ZZe,tet],styles:[""]}),e})();function ret(e,t){1&e&&(S(0,"div",18)(1,"div",19)(2,"div",20)(3,"span",21),R(4,"Loading..."),M()()()())}let set=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartsService=i,this.year="",this.isLoading=!0,this.percentage_of_companies_report_policy_beyond_t1=0}ngOnInit(){}ngOnChanges(n){this.updateData()}updateData(){let n=this.dataProvider.getCompanyGroup(this.sector);this.isLoading=!0,this.dataProvider.getAnswers(this.dataProvider.metrics.aus_msa_statement_assessed,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(i=>{this.dataProvider.getAnswers(this.dataProvider.metrics.uk_msa_statement_assessed,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(r=>{let s=[...new Set([...i,...r])];s=s.filter((o,a,l)=>a===l.findIndex(u=>u.company===o.company&&u.year===o.year)),this.dataProvider.getAnswers(6915846,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(o=>{o=o.filter(a=>s.some(l=>l.company==a.company&&l.year==a.year)),this.percentage_of_companies_report_policy_beyond_t1=Math.round(100*o.length/s.length)})},r=>{console.log(r)},()=>{this.chartsService.drawBarChart("Modern Slavery Supply Chain Policies","div#modern-slavery-supply-chain-policies-alt-one",350,250,this.dataProvider.metrics.msa_statement_assessed,NB,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>this.isLoading=!1)})})}}return e.\u0275fac=function(n){return new(n||e)(H(Fi),H(ea))},e.\u0275cmp=Nt({type:e,selectors:[["approach-to-policies-alt-one"]],inputs:{sector:"sector"},features:[Ht],decls:52,vars:13,consts:[[1,"row"],[1,"col-md-8"],[1,"title"],[1,"col-md-4"],["aria-label","Minimum requirements year filter",1,"msa-form-select","ms-md-auto","bg-neutral-grey",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],[1,"deep-blue"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row",3,"ngClass"],[1,"col-md-6","pe-md-2","mb-md-0","mb-4"],[1,"row","justify-content-md-center"],[1,"col-md-10","highlight-box","p-5","bg-white"],[1,"msa-primary-info-lg"],[1,"highlight"],[1,"col-md-6"],[1,"row","text-center","pt-2"],["id","modern-slavery-supply-chain-policies-alt-one",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1),Me(2,"h3",2),M(),S(3,"div",3)(4,"select",4),ke("ngModelChange",function(s){return i.year=s})("change",function(){return i.updateData()}),S(5,"option",5),R(6,"all years"),M(),S(7,"option",6),R(8,"latest"),M(),S(9,"option",6),R(10,"2021"),M(),S(11,"option",6),R(12,"2020"),M(),S(13,"option",6),R(14,"2019"),M(),S(15,"option",6),R(16,"2018"),M(),S(17,"option",6),R(18,"2017"),M(),S(19,"option",6),R(20,"2016"),M(),S(21,"option",6),R(22,"2015"),M()()()(),Me(23,"hr",7),Ne(24,ret,5,0,"div",8),S(25,"div",9)(26,"div",10)(27,"div",11)(28,"div",12)(29,"div",0)(30,"div",13),R(31),M()(),S(32,"div",0)(33,"p",14),R(34,"of companies report having a modern slavery "),S(35,"b"),R(36,"policy that applies to stakeholders beyond the 1st tier"),M(),R(37," of their supply chain"),M()()()()(),S(38,"div",15)(39,"div",0)(40,"h5"),R(41,"MODERN SLAVERY SUPPLY CHAIN POLICIES"),M(),S(42,"p"),R(43,"Does the company's statement detail clear, organisational modern slavery policies that apply to their "),S(44,"b"),R(45,"direct"),M(),R(46," and/or "),S(47,"b"),R(48,"beyond tier 1"),M(),R(49," supply chain?"),M()(),S(50,"div",16),Me(51,"div",17),M()()()),2&n&&($(4),U("ngModel",i.year),$(1),U("ngValue",""),$(2),U("ngValue","latest"),$(2),U("ngValue",2021),$(2),U("ngValue",2020),$(2),U("ngValue",2019),$(2),U("ngValue",2018),$(2),U("ngValue",2017),$(2),U("ngValue",2016),$(2),U("ngValue",2015),$(3),U("ngIf",i.isLoading),$(1),U("ngClass",i.isLoading?"hide-element":"show-element"),$(6),Pr("",i.percentage_of_companies_report_policy_beyond_t1,"%"))},directives:[Gs,ba,Io,wa,Da,zn,Yi],styles:[""]}),e})();function oet(e,t){1&e&&(S(0,"div",21)(1,"div",22)(2,"div",23)(3,"span",24),R(4,"Loading..."),M()()()())}let aet=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartsService=i,this.isLoading=!0,this.year="",this.percentage_of_companies_identified_risks=0}ngOnChanges(n){this.updateData()}ngOnInit(){}updateData(){let n=this.dataProvider.getCompanyGroup(this.sector);this.isLoading=!0,this.dataProvider.getAnswers(this.dataProvider.metrics.aus_msa_statement_assessed,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(i=>{this.dataProvider.getAnswers(this.dataProvider.metrics.uk_msa_statement_assessed,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(r=>{let s=[...new Set([...i,...r])];s=s.filter((o,a,l)=>a===l.findIndex(u=>u.company===o.company&&u.year===o.year)),this.dataProvider.getAnswers(6916242,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(o=>{o=o.filter(a=>s.some(l=>l.company==a.company&&l.year==a.year)),this.percentage_of_companies_identified_risks=Math.round(100*o.length/s.length)},o=>{console.log(o)},()=>{this.chartsService.drawBarChart("Risk Assessment","div#risk-assessment-alt-one",350,200,this.dataProvider.metrics.msa_statement_assessed,kB,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.chartsService.drawBarChart("Risks identified by risk category","div#risk-identification-alt-one",350,250,this.dataProvider.metrics.msa_statement_assessed,IB,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>this.chartsService.drawSubgroupsBarChart("Risks Management","div#risk-management-alt-one",350,this.dataProvider.metrics.msa_statement_assessed,6948944,{name:"subgroups",values:[{key:"(self- reporting)",label:"Self reporting",color:0,seq:1},{key:"(independent)",label:"Independent",color:1,seq:2}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},{name:"groups",values:[{title:"Audits of suppliers",term:"Audits of suppliers",seq:1},{title:"On-site visits",term:"On-site visits",seq:2},{title:"Neither",term:"Neither",seq:3}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}})).finally(()=>this.isLoading=!1)})})})})}}return e.\u0275fac=function(n){return new(n||e)(H(Fi),H(ea))},e.\u0275cmp=Nt({type:e,selectors:[["approach-to-risks-alt-one"]],inputs:{sector:"sector"},features:[Ht],decls:63,vars:14,consts:[[1,"row"],[1,"col-md-8"],[1,"title"],[1,"col-md-4"],["aria-label","Minimum requirements year filter",1,"msa-form-select","ms-md-auto","bg-neutral-grey",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],[1,"deep-blue"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row",3,"ngClass"],[1,"col-md-6","pe-md-2","mb-md-0","mb-4"],[1,"row","justify-content-md-center"],[1,"col-md-10","highlight-box","p-5","bg-white"],[1,"msa-primary-info-lg"],[1,"highlight"],[1,"col-md-6"],[1,"row","text-center","pt-2"],["id","risk-assessment-alt-one",1,"chart-wrapper"],[1,"row","justify-content-md-center","mt-md-3",3,"ngClass"],["id","risk-identification-alt-one",1,"chart-wrapper"],["id","risk-management-alt-one",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1),Me(2,"h3",2),M(),S(3,"div",3)(4,"select",4),ke("ngModelChange",function(s){return i.year=s})("change",function(){return i.updateData()}),S(5,"option",5),R(6,"all years"),M(),S(7,"option",6),R(8,"latest"),M(),S(9,"option",6),R(10,"2021"),M(),S(11,"option",6),R(12,"2020"),M(),S(13,"option",6),R(14,"2019"),M(),S(15,"option",6),R(16,"2018"),M(),S(17,"option",6),R(18,"2017"),M(),S(19,"option",6),R(20,"2016"),M(),S(21,"option",6),R(22,"2015"),M()()()(),Me(23,"hr",7),Ne(24,oet,5,0,"div",8),S(25,"div",9)(26,"div",10)(27,"div",11)(28,"div",12)(29,"div",0)(30,"div",13),R(31),M()(),S(32,"div",0)(33,"p",14),R(34,"of companies have "),S(35,"b"),R(36,"identified risks likely to occur"),M(),R(37," within operations"),M()()()()(),S(38,"div",15)(39,"div",0)(40,"h5"),R(41,"RISK ASSESSMENT TOOLS"),M(),S(42,"p"),R(43,"used to identify high risk factors in operations"),M()(),S(44,"div",16),Me(45,"div",17),M()()(),S(46,"div",18)(47,"div",15)(48,"div",0)(49,"h5"),R(50,"TYPES OF RISKS IDENTIFIED"),M(),S(51,"p"),R(52,"as likely to occur within operations"),M()(),S(53,"div",16),Me(54,"div",19),M()(),S(55,"div",15)(56,"div",0)(57,"h5"),R(58,"RISK MANAGEMENT SYSTEM"),M(),S(59,"p"),R(60,"used to keep an eye on (high risk) operations"),M()(),S(61,"div",16),Me(62,"div",20),M()()()),2&n&&($(4),U("ngModel",i.year),$(1),U("ngValue",""),$(2),U("ngValue","latest"),$(2),U("ngValue",2021),$(2),U("ngValue",2020),$(2),U("ngValue",2019),$(2),U("ngValue",2018),$(2),U("ngValue",2017),$(2),U("ngValue",2016),$(2),U("ngValue",2015),$(3),U("ngIf",i.isLoading),$(1),U("ngClass",i.isLoading?"hide-element":"show-element"),$(6),Pr("",i.percentage_of_companies_identified_risks,"%"),$(15),U("ngClass",i.isLoading?"hide-element":"show-element"))},directives:[Gs,ba,Io,wa,Da,zn,Yi],styles:[""]}),e})();function uet(e,t){1&e&&(S(0,"div",21)(1,"div",22)(2,"div",23)(3,"span",24),R(4,"Loading..."),M()()()())}let cet=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartsService=i,this.year="",this.percentage_of_companies_identified_incidents=0,this.isLoading=!0}ngOnInit(){}ngOnChanges(n){this.updateData()}updateData(){let n=this.dataProvider.getCompanyGroup(this.sector);this.isLoading=!0,this.dataProvider.getAnswers(this.dataProvider.metrics.aus_msa_statement_assessed,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(i=>{this.dataProvider.getAnswers(this.dataProvider.metrics.uk_msa_statement_assessed,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(r=>{let s=[...new Set([...i,...r])];s=s.filter((o,a,l)=>a===l.findIndex(u=>u.company===o.company&&u.year===o.year)),this.dataProvider.getAnswers(1831964,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(o=>{o=o.filter(a=>s.some(l=>l.company==a.company&&l.year==a.year)),this.percentage_of_companies_identified_incidents=Math.round(100*o.length/s.length)},o=>{console.log(o)},()=>{this.chartsService.drawSubgroupsBarChart("Whistleblowing or Grievance Mechanisms","div#whistleblowing-mechanisms-alt-one",300,this.dataProvider.metrics.msa_statement_assessed,2722458,{name:"subgroups",values:[{key:"(direct employees)",label:"Direct employees",color:0,seq:1},{key:"(supply chain workers)",label:"Supply chain workers",color:1,seq:2},{key:"",label:"Direct employees",color:2,seq:3}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},{name:"groups",values:[{title:"Whistleblower protection",term:"Whistleblower protection",seq:1},{title:"Hotline, Email, Contact Form",term:"Hotline",seq:2},{title:"Focal Point",term:"Focal Point",seq:3},{title:"None of the Above",term:"No",seq:3}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.chartsService.drawBarChart("Incidents Remediation","div#incident-remediation-alt-one",350,250,this.dataProvider.metrics.msa_statement_assessed,RB,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.chartsService.drawBarChart("Modern Slavery Training","div#training-alt-one",350,350,this.dataProvider.metrics.msa_statement_assessed,FB,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.isLoading=!1})})})})})})}}return e.\u0275fac=function(n){return new(n||e)(H(Fi),H(ea))},e.\u0275cmp=Nt({type:e,selectors:[["approach-to-incidents-alt-one"]],inputs:{sector:"sector"},features:[Ht],decls:63,vars:14,consts:[[1,"row"],[1,"col-md-8"],[1,"title"],[1,"col-md-4"],["aria-label","Minimum requirements year filter",1,"msa-form-select","ms-md-auto","bg-neutral-grey",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],[1,"deep-blue"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row",3,"ngClass"],[1,"col-md-6","pe-md-2","mb-md-0","mb-4"],[1,"row","justify-content-md-center"],[1,"col-md-10","highlight-box","p-5","bg-white"],[1,"msa-primary-info-lg"],[1,"highlight"],[1,"col-md-6"],[1,"row","text-center","pt-2"],["id","training-alt-one",1,"chart-wrapper"],[1,"row","justify-content-md-center",3,"ngClass"],["id","whistleblowing-mechanisms-alt-one",1,"chart-wrapper"],["id","incident-remediation-alt-one",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1),Me(2,"h3",2),M(),S(3,"div",3)(4,"select",4),ke("ngModelChange",function(s){return i.year=s})("change",function(){return i.updateData()}),S(5,"option",5),R(6,"all years"),M(),S(7,"option",6),R(8,"latest"),M(),S(9,"option",6),R(10,"2021"),M(),S(11,"option",6),R(12,"2020"),M(),S(13,"option",6),R(14,"2019"),M(),S(15,"option",6),R(16,"2018"),M(),S(17,"option",6),R(18,"2017"),M(),S(19,"option",6),R(20,"2016"),M(),S(21,"option",6),R(22,"2015"),M()()()(),Me(23,"hr",7),Ne(24,uet,5,0,"div",8),S(25,"div",9)(26,"div",10)(27,"div",11)(28,"div",12)(29,"div",0)(30,"div",13),R(31),M()(),S(32,"div",0)(33,"p",14),R(34,"of companies have "),S(35,"b"),R(36,"identified a specific incident of modern slavery"),M(),R(37," in their own and/or supply chain operations"),M()()()()(),S(38,"div",15)(39,"div",0)(40,"h5"),R(41,"MODERN SLAVERY TRAINING"),M(),S(42,"p"),R(43,"provided to increase chances of staff identifying incidents and avoiding practices that increase chances of incidents occuring "),M()(),S(44,"div",16),Me(45,"div",17),M()()(),S(46,"div",18)(47,"div",15)(48,"div",0)(49,"h5"),R(50,"GRIEVANCE MECHANISMS"),M(),S(51,"p"),R(52,"provided to increase likelihood of incidents being reported"),M()(),S(53,"div",16),Me(54,"div",19),M()(),S(55,"div",15)(56,"div",0)(57,"h5"),R(58,"REMEDIATION STRATEGY"),M(),S(59,"p"),R(60,"deployed when specific incidents are identified"),M()(),S(61,"div",16),Me(62,"div",20),M()()()),2&n&&($(4),U("ngModel",i.year),$(1),U("ngValue",""),$(2),U("ngValue","latest"),$(2),U("ngValue",2021),$(2),U("ngValue",2020),$(2),U("ngValue",2019),$(2),U("ngValue",2018),$(2),U("ngValue",2017),$(2),U("ngValue",2016),$(2),U("ngValue",2015),$(3),U("ngIf",i.isLoading),$(1),U("ngClass",i.isLoading?"hide-element":"show-element"),$(6),Pr("",i.percentage_of_companies_identified_incidents,"%"),$(15),U("ngClass",i.isLoading?"hide-element":"show-element"))},directives:[Gs,ba,Io,wa,Da,zn,Yi],styles:[""]}),e})(),det=(()=>{class e{constructor(n){this.dataProvider=n}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)(H(Fi))},e.\u0275cmp=Nt({type:e,selectors:[["further-findings-alt-one"]],inputs:{sector:"sector"},decls:38,vars:3,consts:[[1,"section","mt-5","bg-neutral-orange","p-4"],[1,"row"],[1,"col-md-8"],[1,"title"],[1,"row","dive-deeper","mt-3"],[1,"col-md-12"],["id","approach_to_policies",1,"accordion"],[1,"accordion-item"],["id","approachToPoliciesTitle",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#approach-to-policies-alt-one","aria-expanded","false","aria-controls","collapseThree",1,"accordion-button","collapsed"],["id","approach-to-policies-alt-one","aria-labelledby","approachToPoliciesTitle","data-bs-parent","#approach_to_policies",1,"accordion-collapse","collapse"],[1,"accordion-body"],[3,"sector"],["id","approach_to_risks_accordion",1,"accordion"],["id","headingThree",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#ApproachToRisks","aria-expanded","false","aria-controls","collapseThree",1,"accordion-button","collapsed"],["id","ApproachToRisks","aria-labelledby","headingThree","data-bs-parent","#approach_to_risks_accordion",1,"accordion-collapse","collapse"],["id","approach_to_incidents",1,"accordion"],["id","headingApproachToIncidents",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#collapseApproachToIncidents-alt-one","aria-expanded","false","aria-controls","collapseApproachToIncidents",1,"accordion-button","collapsed"],["id","collapseApproachToIncidents-alt-one","aria-labelledby","headingApproachToIncidents","data-bs-parent","#approach_to_incidents",1,"accordion-collapse","collapse"]],template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),R(4,"Further Findings"),M()()(),S(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7)(9,"h2",8)(10,"button",9)(11,"h4"),R(12,"Policies"),M()()(),S(13,"div",10)(14,"div",11),Me(15,"approach-to-policies-alt-one",12),M()()()()()(),S(16,"div",4)(17,"div",5)(18,"div",13)(19,"div",7)(20,"h2",14)(21,"button",15)(22,"h4"),R(23,"Risks"),M()()(),S(24,"div",16)(25,"div",11),Me(26,"approach-to-risks-alt-one",12),M()()()()()(),S(27,"div",4)(28,"div",5)(29,"div",17)(30,"div",7)(31,"h2",18)(32,"button",19)(33,"h4"),R(34,"Incidents"),M()()(),S(35,"div",20)(36,"div",11),Me(37,"approach-to-incidents-alt-one",12),M()()()()()()()),2&n&&($(15),U("sector",i.sector),$(11),U("sector",i.sector),$(11),U("sector",i.sector))},directives:[set,aet,cet],styles:[""]}),e})();function fet(e,t){1&e&&(S(0,"div",9)(1,"div",10)(2,"div",11)(3,"span",12),R(4,"Loading..."),M()()()())}let het=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartsService=i,this.isLoading=!0}ngOnInit(){}ngOnChanges(n){this.updateData()}updateData(){let n=this.dataProvider.getCompanyGroup(this.sector);this.isLoading=!0,this.chartsService.drawBarChart("Modern Slavery Supply Chain Policies","div#modern-slavery-supply-chain-policies-alt-two",350,250,this.dataProvider.metrics.msa_statement_assessed,NB,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>this.isLoading=!1)}}return e.\u0275fac=function(n){return new(n||e)(H(Fi),H(ea))},e.\u0275cmp=Nt({type:e,selectors:[["approach-to-policies-alt-two"]],inputs:{year:"year",sector:"sector"},features:[Ht],decls:21,vars:2,consts:[[1,"row"],[1,"col-md-8"],[1,"title"],[1,"deep-blue"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row",3,"ngClass"],[1,"col-md-12"],[1,"row","text-center","pt-2"],["id","modern-slavery-supply-chain-policies-alt-two",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1)(2,"h3",2),R(3,"Policies"),M()()(),Me(4,"hr",3),Ne(5,fet,5,0,"div",4),S(6,"div",5)(7,"div",6)(8,"div",0)(9,"h5"),R(10,"MODERN SLAVERY SUPPLY CHAIN POLICIES"),M(),S(11,"p"),R(12,"Does the company's statement detail clear, organisational modern slavery policies that apply to their "),S(13,"b"),R(14,"direct"),M(),R(15," and/or "),S(16,"b"),R(17,"beyond tier 1"),M(),R(18," supply chain?"),M()(),S(19,"div",7),Me(20,"div",8),M()()()),2&n&&($(5),U("ngIf",i.isLoading),$(1),U("ngClass",i.isLoading?"hide-element":"show-element"))},directives:[zn,Yi],styles:[""]}),e})();function pet(e,t){1&e&&(S(0,"div",12)(1,"div",13)(2,"div",14)(3,"span",15),R(4,"Loading..."),M()()()())}let get=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartsService=i,this.isLoading=!0}ngOnChanges(n){this.updateData()}ngOnInit(){}updateData(){let n=this.dataProvider.getCompanyGroup(this.sector);this.isLoading=!0,this.chartsService.drawBarChart("Risk Assessment","div#risk-assessment-alt-two",350,200,this.dataProvider.metrics.msa_statement_assessed,kB,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.chartsService.drawBarChart("Risks identified by risk category","div#risk-identification-alt-two",350,250,this.dataProvider.metrics.msa_statement_assessed,IB,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>this.chartsService.drawSubgroupsBarChart("Risks Management","div#risk-management-alt-two",350,this.dataProvider.metrics.msa_statement_assessed,6948944,{name:"subgroups",values:[{key:"(self- reporting)",label:"Self reporting",color:0,seq:1},{key:"(independent)",label:"Independent",color:1,seq:2}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},{name:"groups",values:[{title:"Audits of suppliers",term:"Audits of suppliers",seq:1},{title:"On-site visits",term:"On-site visits",seq:2},{title:"Neither",term:"Neither",seq:3}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}})).finally(()=>this.isLoading=!1)})}}return e.\u0275fac=function(n){return new(n||e)(H(Fi),H(ea))},e.\u0275cmp=Nt({type:e,selectors:[["approach-to-risks-alt-two"]],inputs:{year:"year",sector:"sector"},features:[Ht],decls:32,vars:3,consts:[[1,"row"],[1,"col-md-8"],[1,"title"],[1,"deep-blue"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row",3,"ngClass"],[1,"col-md-12"],[1,"row","text-center","pt-2"],["id","risk-assessment-alt-two",1,"chart-wrapper"],[1,"row","justify-content-md-center","mt-md-3",3,"ngClass"],["id","risk-identification-alt-two",1,"chart-wrapper"],["id","risk-management-alt-two",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1)(2,"h3",2),R(3,"Risks"),M()()(),Me(4,"hr",3),Ne(5,pet,5,0,"div",4),S(6,"div",5)(7,"div",6)(8,"div",0)(9,"h5"),R(10,"RISK ASSESSMENT TOOLS"),M(),S(11,"p"),R(12,"used to identify high risk factors in operations"),M()(),S(13,"div",7),Me(14,"div",8),M()()(),S(15,"div",9)(16,"div",6)(17,"div",0)(18,"h5"),R(19,"TYPES OF RISKS IDENTIFIED"),M(),S(20,"p"),R(21,"as likely to occur within operations"),M()(),S(22,"div",7),Me(23,"div",10),M()(),S(24,"div",6)(25,"div",0)(26,"h5"),R(27,"RISK MANAGEMENT SYSTEM"),M(),S(28,"p"),R(29,"used to keep an eye on (high risk) operations"),M()(),S(30,"div",7),Me(31,"div",11),M()()()),2&n&&($(5),U("ngIf",i.isLoading),$(1),U("ngClass",i.isLoading?"hide-element":"show-element"),$(9),U("ngClass",i.isLoading?"hide-element":"show-element"))},directives:[zn,Yi],styles:[""]}),e})();function met(e,t){1&e&&(S(0,"div",12)(1,"div",13)(2,"div",14)(3,"span",15),R(4,"Loading..."),M()()()())}let _et=(()=>{class e{constructor(n,i){this.dataProvider=n,this.chartsService=i,this.isLoading=!0}ngOnInit(){}ngOnChanges(n){this.updateData()}updateData(){let n=this.dataProvider.getCompanyGroup(this.sector);this.isLoading=!0,this.chartsService.drawSubgroupsBarChart("Whistleblowing or Grievance Mechanisms","div#whistleblowing-mechanisms-alt-two",300,this.dataProvider.metrics.msa_statement_assessed,2722458,{name:"subgroups",values:[{key:"(direct employees)",label:"Direct employees",color:0,seq:1},{key:"(supply chain workers)",label:"Supply chain workers",color:1,seq:2},{key:"",label:"Direct employees",color:2,seq:3}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},{name:"groups",values:[{title:"Whistleblower protection",term:"Whistleblower protection",seq:1},{title:"Hotline, Email, Contact Form",term:"Hotline",seq:2},{title:"Focal Point",term:"Focal Point",seq:3},{title:"None of the Above",term:"No",seq:3}],transform:[{type:"window",ops:["row_number"],as:["seq"]}]},this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.chartsService.drawBarChart("Incidents Remediation","div#incident-remediation-alt-two",350,250,this.dataProvider.metrics.msa_statement_assessed,RB,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.chartsService.drawBarChart("Modern Slavery Training","div#training-alt-two",350,350,this.dataProvider.metrics.msa_statement_assessed,FB,this.year,n,{renderer:"svg",actions:{source:!1,editor:!0}}).finally(()=>{this.isLoading=!1})})})}}return e.\u0275fac=function(n){return new(n||e)(H(Fi),H(ea))},e.\u0275cmp=Nt({type:e,selectors:[["approach-to-incidents-alt-two"]],inputs:{year:"year",sector:"sector"},features:[Ht],decls:32,vars:3,consts:[[1,"row"],[1,"col-md-8"],[1,"title"],[1,"deep-blue"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row",3,"ngClass"],[1,"col-md-12"],[1,"row","text-center","pt-2"],["id","training-alt-two",1,"chart-wrapper"],[1,"row","justify-content-md-center",3,"ngClass"],["id","whistleblowing-mechanisms-alt-two",1,"chart-wrapper"],["id","incident-remediation-alt-two",1,"chart-wrapper"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1)(2,"h3",2),R(3,"Incidents"),M()()(),Me(4,"hr",3),Ne(5,met,5,0,"div",4),S(6,"div",5)(7,"div",6)(8,"div",0)(9,"h5"),R(10,"MODERN SLAVERY TRAINING"),M(),S(11,"p"),R(12,"provided to increase chances of staff identifying incidents and avoiding practices that increase chances of incidents occuring "),M()(),S(13,"div",7),Me(14,"div",8),M()()(),S(15,"div",9)(16,"div",6)(17,"div",0)(18,"h5"),R(19,"GRIEVANCE MECHANISMS"),M(),S(20,"p"),R(21,"provided to increase likelihood of incidents being reported"),M()(),S(22,"div",7),Me(23,"div",10),M()(),S(24,"div",6)(25,"div",0)(26,"h5"),R(27,"REMEDIATION STRATEGY"),M(),S(28,"p"),R(29,"deployed when specific incidents are identified"),M()(),S(30,"div",7),Me(31,"div",11),M()()()),2&n&&($(5),U("ngIf",i.isLoading),$(1),U("ngClass",i.isLoading?"hide-element":"show-element"),$(9),U("ngClass",i.isLoading?"hide-element":"show-element"))},directives:[zn,Yi],styles:[""]}),e})();function yet(e,t){1&e&&(S(0,"div",29)(1,"div",30)(2,"div",31)(3,"span",32),R(4,"Loading..."),M()()()())}let vet=(()=>{class e{constructor(n){this.dataProvider=n,this.year="",this.percentage_of_companies_identified_incidents=0,this.percentage_of_companies_report_policy_beyond_t1=0,this.percentage_of_companies_identified_risks=0,this.isLoading=!0}ngOnChanges(n){this.updateData()}ngOnInit(){}updateData(){let n=this.dataProvider.getCompanyGroup(this.sector);this.isLoading=!0,this.dataProvider.getAnswers(this.dataProvider.metrics.msa_statement_assessed,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(i=>{this.dataProvider.getAnswers(1831964,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(r=>{r=r.filter(s=>i.some(o=>o.company==s.company&&o.year==s.year)),this.percentage_of_companies_identified_incidents=Math.round(100*r.length/i.length),this.dataProvider.getAnswers(6916242,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(s=>{s=s.filter(o=>i.some(a=>a.company==o.company&&a.year==o.year)),this.percentage_of_companies_identified_risks=Math.round(100*s.length/i.length),this.dataProvider.getAnswers(6915846,[new J("year",this.year),new J("value","Yes"),new J("company_group",n)]).subscribe(o=>{o=o.filter(a=>i.some(l=>l.company==a.company&&l.year==a.year)),this.percentage_of_companies_report_policy_beyond_t1=Math.round(100*o.length/i.length)})})},r=>{console.log(r)},()=>this.isLoading=!1)})}}return e.\u0275fac=function(n){return new(n||e)(H(Fi))},e.\u0275cmp=Nt({type:e,selectors:[["further-findings-alt-two"]],inputs:{sector:"sector"},features:[Ht],decls:81,vars:21,consts:[[1,"section","mt-5","bg-neutral-orange","p-4"],[1,"row"],[1,"col-md-8"],[1,"title"],[1,"col-md-4"],["aria-label","Minimum requirements year filter",1,"msa-form-select","ms-md-auto","bg-neutral-orange",2,"max-width","120px","max-height","50px","font-size","0.8em",3,"ngModel","ngModelChange","change"],["selected","",3,"ngValue"],[3,"ngValue"],["class","row mt-3","style","height: 150px",4,"ngIf"],[1,"row","dive-deeper","mt-3",3,"ngClass"],[1,"col-lg-4","mb-lg-0","mb-3"],["id","approach_to_policies",1,"accordion"],[1,"accordion-item"],["id","approachToPoliciesTitle",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#approach-to-policies-alt-two","aria-expanded","false","aria-controls","collapseThree",1,"accordion-button-white","collapsed"],[1,"row","mt-3","mb-3"],[1,"msa-primary-info-lg"],[1,"highlight"],["id","approach-to-policies-alt-two","aria-labelledby","approachToPoliciesTitle","data-bs-parent","#approach_to_policies",1,"accordion-collapse","collapse"],[1,"accordion-body"],[3,"year","sector"],["id","approach_to_risks_accordion",1,"accordion"],["id","headingThree",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#ApproachToRisksAltTwo","aria-expanded","false","aria-controls","collapseThree",1,"accordion-button-white","collapsed"],["id","ApproachToRisksAltTwo","aria-labelledby","headingThree","data-bs-parent","#approach_to_risks_accordion",1,"accordion-collapse","collapse"],["id","approach_to_incidents",1,"accordion"],["id","headingApproachToIncidents",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#collapseApproachToIncidents-alt-two","aria-expanded","false","aria-controls","collapseApproachToIncidents",1,"accordion-button-white","collapsed"],["id","collapseApproachToIncidents-alt-two","aria-labelledby","headingApproachToIncidents","data-bs-parent","#approach_to_incidents",1,"accordion-collapse","collapse"],[1,"row","mt-3",2,"height","150px"],[1,"col-12","text-center","align-self-center"],["role","status",1,"spinner-grow","text-warning"],[1,"sr-only"]],template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),R(4,"Further Findings"),M()(),S(5,"div",4)(6,"select",5),ke("ngModelChange",function(s){return i.year=s})("change",function(){return i.updateData()}),S(7,"option",6),R(8,"all years"),M(),S(9,"option",7),R(10,"latest"),M(),S(11,"option",7),R(12,"2021"),M(),S(13,"option",7),R(14,"2020"),M(),S(15,"option",7),R(16,"2019"),M(),S(17,"option",7),R(18,"2018"),M(),S(19,"option",7),R(20,"2017"),M(),S(21,"option",7),R(22,"2016"),M(),S(23,"option",7),R(24,"2015"),M()()()(),Ne(25,yet,5,0,"div",8),S(26,"div",9)(27,"div",10)(28,"div",11)(29,"div",12)(30,"div",13)(31,"div",14)(32,"div",15)(33,"div",1)(34,"div",16),R(35),M()(),S(36,"div",1)(37,"p",17),R(38,"of companies report having a modern slavery "),S(39,"b"),R(40,"policy that applies to stakeholders beyond the 1st tier"),M(),R(41," of their supply chain"),M()()()()(),S(42,"div",18)(43,"div",19),Me(44,"approach-to-policies-alt-two",20),M()()()()(),S(45,"div",10)(46,"div",21)(47,"div",12)(48,"div",22)(49,"div",23)(50,"div",15)(51,"div",1)(52,"div",16),R(53),M()(),S(54,"div",1)(55,"p",17),R(56,"of companies have "),S(57,"b"),R(58,"identified risks likely to occur"),M(),R(59," within operations"),M()()()()(),S(60,"div",24)(61,"div",19),Me(62,"approach-to-risks-alt-two",20),M()()()()(),S(63,"div",10)(64,"div",25)(65,"div",12)(66,"div",26)(67,"div",27)(68,"div",15)(69,"div",1)(70,"div",16),R(71),M()(),S(72,"div",1)(73,"p",17),R(74,"of companies have "),S(75,"b"),R(76,"identified a specific incident of modern slavery"),M(),R(77," in their own and/or supply chain operations"),M()()()()(),S(78,"div",28)(79,"div",19),Me(80,"approach-to-incidents-alt-two",20),M()()()()()()()),2&n&&($(6),U("ngModel",i.year),$(1),U("ngValue",""),$(2),U("ngValue","latest"),$(2),U("ngValue",2021),$(2),U("ngValue",2020),$(2),U("ngValue",2019),$(2),U("ngValue",2018),$(2),U("ngValue",2017),$(2),U("ngValue",2016),$(2),U("ngValue",2015),$(2),U("ngIf",i.isLoading),$(1),U("ngClass",i.isLoading?"hide-element":"show-element"),$(9),Pr("",i.percentage_of_companies_report_policy_beyond_t1,"%"),$(9),U("year",i.year)("sector",i.sector),$(9),Pr("",i.percentage_of_companies_identified_risks,"%"),$(9),U("year",i.year)("sector",i.sector),$(9),Pr("",i.percentage_of_companies_identified_incidents,"%"),$(9),U("year",i.year)("sector",i.sector))},directives:[Gs,ba,Io,wa,Da,zn,Yi,het,get,_et],styles:[""]}),e})(),bet=(()=>{class e{constructor(n,i){this.route=n,this.sectorProvider=i,this.sector="all-sectors"}ngOnInit(){this.route.paramMap.subscribe(n=>{let i=n.get("sector");null!==i&&i!=this.sector&&(this.sector=i),this.sectorProvider.getSector().next(i)})}}return e.\u0275fac=function(n){return new(n||e)(H(Rf),H(gO))},e.\u0275cmp=Nt({type:e,selectors:[["dashboard"]],decls:10,vars:8,consts:[[1,"container"],[3,"sector"]],template:function(n,i){1&n&&(S(0,"div",0),Me(1,"introductory-section",1)(2,"key-findings-section",1)(3,"treemap",1)(4,"minimum-requirements-section",1)(5,"going-beyond-compliance",1)(6,"disclosure-rates")(7,"further-findings",1)(8,"further-findings-alt-one",1)(9,"further-findings-alt-two",1),M()),2&n&&($(1),U("sector",i.sector),$(1),U("sector",i.sector),$(1),U("sector",i.sector),$(1),U("sector",i.sector),$(1),U("sector",i.sector),$(2),U("sector",i.sector),$(1),U("sector",i.sector),$(1),U("sector",i.sector))},directives:[Owe,Jxe,BZe,UZe,WZe,KZe,iet,det,vet],styles:[""]}),e})();const wet=JSON.parse('[{"metric":"Modern Slavery Act statement","url":"https://wikirate.org/Business_Human_Rights_Resource_Centre+Modern_Slavery_Statement","description":"Did the company produce a statement in relation to any Modern Slavery Act or legislation?","requirements_guidance":"If in-scope of the legislation, update your modern slavery statement every year","requirements_guidance_color":"red","requirements_criterion":"If in-scope of the legislation, update your modern slavery statement every year (p.17)","requirements_criterion_color":"red"},{"metric":"Statement publication","url":"https://wikirate.org/Walk_Free+MSA_Statement_Publication","description":"Does the company either publish their statement on their homepage (UK Act) or provide the statement to the registry (Australian Act)?","requirements_guidance":"Publish your modern slavery statement on your UK website","requirements_guidance_color":"red","requirements_criterion":"Provide your statement to the Australian Border Force, to be published on the online central register. (pp. 64-65)","requirements_criterion_color":"red"},{"metric":"Board approval","url":"https://wikirate.org/Business_Human_Rights_Resource_Centre+MSA_Statement_Approval","description":"Was the company\'s Modern Slavery Act statement explicitly approved by the board of directors (or equivalent management body)?","requirements_guidance":"Get approval from the board of directors (or equivalent management body)","requirements_guidance_color":"red","requirements_criterion":"Get approval by principal governing body (p. 62)","requirements_criterion_color":"red"},{"metric":"Signature","url":"https://wikirate.org/Business_Human_Rights_Resource_Centre+MSA_statement_signed","description":"Was the company\u2019s Modern Slavery Act statement signed by an appropriate person?","requirements_guidance":"Get sign off from a director (or equivalent) or designated member (for LLPs)","requirements_guidance_color":"red","requirements_criterion":"Signed by a responsible member (p.62)","requirements_criterion_color":"red"},{"metric":"Organizational structure and operations","url":"https://wikirate.org/Walk_Free+MSA_Organizational_structure_and_operations","description":"Does the company disclose the ownership structure(s) and/or business model(s) of each of its brands, subsidiaries, and other businesses covered by their Modern Slavery statement?","requirements_guidance":"Organisation structure and supply chains (p. 27)","requirements_guidance_color":"yellow","requirements_criterion":"Identify the reporting entity and describe its structure, operations and supply chains (p. 32)","requirements_criterion_color":"red"},{"metric":"Supply chain disclosure","url":"https://wikirate.org/Walk_Free+MSA_supply_chain_disclosure","description":"Does the company\u2019s statement identify the suppliers in their supply chain and/or the geographic regions where their supply chain operates?","requirements_guidance":"Organisation structure and supply chains (p. 27)","requirements_guidance_color":"yellow","requirements_criterion":"Identify the reporting entity and describe its structure, operations and supply chains (p. 32)","requirements_criterion_color":"red"},{"metric":"Policy","url":"https://wikirate.org/Walk_Free+MSA_policy_revised","description":"Does the company\u2019s statement detail specific, organisational policies or actions to combat slavery in their direct (tier 1) and/or in-direct (beyond tier 1) supply chain?","requirements_guidance":"Policies in relation to slavery and human trafficking / Organisational policies (p. 29)","requirements_guidance_color":"yellow","requirements_criterion":"Pre-agreed processes or policies in place to guide actions (p.85)","requirements_criterion_color":"yellow"},{"metric":"Risk assessment","url":"https://wikirate.org/Walk_Free+MSA_risk_assessment","description":"How does the company assess the risks of modern slavery and trafficking in their supply chain?","requirements_guidance":"Due diligence processes (p. 33)","requirements_guidance_color":"yellow","requirements_criterion":"Describe the actions taken by the reporting entity and any entities that the reporting entity owns or controls to assess and address these risks, including due diligence and remediation processes (p. 46)","requirements_criterion_color":"red"},{"metric":"Risk management","url":"https://wikirate.org/Walk_Free+MSA_risk_management_revised","description":"Does the company continuously monitor suppliers to ensure that they comply with the company\u2019s policies and local laws?","requirements_guidance":"Due diligence processes (p. 33)","requirements_guidance_color":"yellow","requirements_criterion":"Describe the actions taken by the reporting entity and any entities that the reporting entity owns or controls to assess and address these risks, including due diligence and remediation processes (p. 46)","requirements_criterion_color":"red"},{"metric":"Incidents remediation","url":"https://wikirate.org/Walk_Free+MSA_incidents_remediation_revised","description":"Did the company explain the corrective steps it has taken (or would take) in response to modern slavery incidents in their own operations and/or supply chain?","requirements_guidance":"Due diligence processes (p. 33)","requirements_guidance_color":"yellow","requirements_criterion":"Describe the actions taken by the reporting entity and any entities that the reporting entity owns or controls to assess and address these risks, including due diligence and remediation processes (p. 46)","requirements_criterion_color":"red"},{"metric":"Whistleblowing mechanism","url":"https://wikirate.org/Walk_Free+MSA_whistleblowing_mechanism_revised","description":"Does the company have a grievance mechanism in place to facilitate whistle-blowing or the reporting of suspected incidents of slavery or trafficking?","requirements_guidance":"Due diligence processes (p. 33)","requirements_guidance_color":"yellow","requirements_criterion":"Describe the actions taken by the reporting entity and any entities that the reporting entity owns or controls to assess and address these risks, including due diligence and remediation processes (p. 46)","requirements_criterion_color":"red"},{"metric":"Identification of risks","url":"https://wikirate.org/Walk_Free+MSA_Identification_of_risks","description":"Does the company\u2019s statement identify specific geographic regions, industries, resources or types of workforce where the risk of modern slavery is the greatest?","requirements_guidance":"Risk assessment and management (p. 34)","requirements_guidance_color":"yellow","requirements_criterion":"Describe the risks of modern slavery practices in the operations and supply chains of the reporting entity and any entities the reporting entity owns or controls (p. 40)","requirements_criterion_color":"red"},{"metric":"Incidents identified","url":"https://wikirate.org/Walk_Free+MSA_incidents_identified","description":"Did the company identify any specific incidents related to modern slavery that require(d) remediation?","requirements_guidance":"","requirements_guidance_color":"white","requirements_criterion":"Describe the risks of modern slavery practices in the operations and supply chains of the reporting entity and any entities the reporting entity owns or controls  (p. 41)","requirements_criterion_color":"yellow"},{"metric":"Performance indicators","url":"https://wikirate.org/Walk_Free+MSA_Performance_Indicators","description":"Does the company define performance indicators that measure the effectiveness of their actions to combat slavery and trafficking?","requirements_guidance":"Key performance indicators to measure effectiveness of steps being taken (p. 36)","requirements_guidance_color":"yelow","requirements_criterion":"Describe how the reporting entity assesses the effectiveness of actions being taken to assess and address modern slavery risks (p. 54)","requirements_criterion_color":"red"},{"metric":"Business performance indicators","url":"https://wikirate.org/Walk_Free+MSA_Business_Performance_Indicators","description":"Has the company reviewed business KPIs to ensure they are not increasing risk of modern slavery?","requirements_guidance":"Key performance indicators to measure effectiveness of steps being taken (p. 36)","requirements_guidance_color":"yelow","requirements_criterion":"Describe how the reporting entity assesses the effectiveness of actions being taken to assess and address modern slavery risks (p. 54)","requirements_criterion_color":"red"},{"metric":"Training","url":"https://wikirate.org/Walk_Free+MSA_training_revised","description":"Does the statement describe training for staff that is specifically geared towards detecting signs of slavery or trafficking?","requirements_guidance":"Training on modern slavery and trafficking (p. 37)","requirements_guidance_color":"yellow","requirements_criterion":"Describe the actions taken by the reporting entity and any entities that the reporting entity owns or controls to assess and address these risks, including due diligence and remediation processes (p. 52)","requirements_criterion_color":"yellow"},{"metric":"Consultation process","url":"https://wikirate.org/Walk_Free+MSA_Consultation_Process","description":"Does the statement describe consulting with any entities that it owns or controls?","requirements_guidance":"","requirements_guidance_color":"white","requirements_criterion":"Describe the process of consultation with any entities the reporting entity owns or controls (p. 57)","requirements_criterion_color":"red"}]');function Det(e,t){if(1&e&&(S(0,"tr")(1,"td",19)(2,"a",20),R(3),M()(),S(4,"td",21),R(5),M(),S(6,"td",22),R(7),M(),S(8,"td",22),R(9),M()()),2&e){const n=t.$implicit;$(2),Z0("href",n.url,V0),$(1),ki(n.metric),$(2),ki(n.description),$(1),U("ngClass","red"===n.requirements_guidance_color?"td-bg-color-red":"td-bg-color-yellow"),$(1),ki(n.requirements_guidance),$(1),U("ngClass","red"===n.requirements_criterion_color?"td-bg-color-red":"td-bg-color-yellow"),$(1),ki(n.requirements_criterion)}}function Cet(e,t){1&e&&(S(0,"p"),R(1,"As the project progressed 3 more standardized metrics have been added. One resulting from the Australian Modern Slavery Act requirements assessing \u201cConsultation process\u201d (see table below) and two looking at best practices such as companies "),S(2,"a",23),R(3,"providing a historic record of previous statements"),M(),R(4," on their website, and making explicit "),S(5,"a",24),R(6,"how the legislation impacted company behavior."),M()())}const Eet=[{path:"dashboard/:sector",component:bet},{path:"about",component:(()=>{class e{constructor(){this.table=[]}ngOnInit(){this.table=JSON.parse(JSON.stringify(wet))}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Nt({type:e,selectors:[["about"]],decls:59,vars:2,consts:[[1,"container"],[1,"section"],[1,"title","mt-5"],[1,"subtitle","mt-3"],[1,"section","row"],[1,"col-md-7","bg-neutral-orange","p-3"],[1,"content"],[1,"col-md-5","no-padding"],[1,"col-md-12"],[1,"col-md-11","ms-md-auto","bg-neutral-grey","p-3","mt-3","mt-md-0"],[1,"col-md-12","bg-neutral-blue","p-3"],["placement","top","tooltipHtml","true",1,"tooltip-item",3,"ngbPopover"],[1,"table","table-responsive-md","table-bordered","table-dark"],["scope","col-3","colspan","2"],["scope","col-3"],["scope","col-2"],["scope","col-4"],[4,"ngFor","ngForOf"],["standardized_metrics_details",""],[1,"col-2"],["target","_blank",1,"link-info",3,"href"],[1,"col-4"],[1,"col-3",3,"ngClass"],["href","https://wikirate.org/Walk_Free+MSA_historic_record","target","_blank"],["href","https://wikirate.org/Walk_Free+MSA_Impact_on_Company_Behaviour","target","_blank"]],template:function(n,i){if(1&n&&(S(0,"div",0)(1,"div",1)(2,"h1",2),R(3," Beyond Compliance "),M(),S(4,"div",3),R(5," Assessing UK and Australian Modern Slavery Act statements produced by companies and investors. "),M()(),S(6,"div",4)(7,"div",5)(8,"h3"),R(9,"Modern Slavery Acts"),M(),S(10,"div",6)(11,"p"),R(12," Under Section 54 of the 2015 MSA, the UK government requires all companies with a turnover of over GB\xa336 million per annum to release an annual statement on the actions they are taking to tackle modern slavery in their direct operations and supply chains. The 2018 Australian MSA establishes a national Modern Slavery Reporting Requirement, which applies to businesses and other entities in the Australian market with an annual consolidated revenue of at least AU$100 million. These entities are required to identify and address their modern slavery risks and maintain responsible and transparent supply chains. "),M()()(),S(13,"div",7)(14,"div",8)(15,"div",8)(16,"div",9)(17,"h3"),R(18,"Coming Together"),M(),S(19,"div",6)(20,"p"),R(21," In 2016, when the first companies started publishing their UK Modern Slavery Act statements, Walk Free and WikiRate partnered to set up a research project that could assess their contents; were companies approaching it as another tick box exercise or were they going beyond compliance? "),M()()()()()()(),S(22,"div",4)(23,"div",10)(24,"h3"),R(25,"Methodology"),M(),S(26,"div",6)(27,"p"),R(28," Drawing on Walk Free's knowledge of modern slavery due diligence and the Home Office Guidance accompanying the UK Act, the partnership developed a "),S(29,"span",11),R(30,"set of 16"),S(31,"span"),R(32,"*"),M(),R(33," standardized metrics"),M(),R(34," to assess the content of the statements. "),M(),S(35,"p"),R(36,"The following overview shows how both the UK and Australian legislation guidance and requirements map to the projects' standardized metrics."),M(),S(37,"table",12)(38,"thead")(39,"tr")(40,"th",13),R(41,"Walk Free metrics on WikiRate platform"),M(),S(42,"th",14),R(43,"UK MSA Requirements & Guidance"),M(),S(44,"th",14),R(45,"Australia MSA Requirements"),M()(),S(46,"tr")(47,"th",15),R(48,"Metric"),M(),S(49,"th",16),R(50,"Description"),M(),S(51,"th",14),R(52,"Requirements & Guidance"),M(),S(53,"th",14),R(54,"Requirements & Criterion"),M()()(),S(55,"tbody"),Ne(56,Det,10,7,"tr",17),M()()()()()(),Ne(57,Cet,7,0,"ng-template",null,18,Ao)),2&n){const r=So(58);$(29),U("ngbPopover",r),$(27),U("ngForOf",i.table)}},directives:[Tq,Nf,Yi],styles:[""]}),e})()},{path:"**",redirectTo:"/dashboard/all-sectors",pathMatch:"full"}];let xet=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({imports:[[UH.forRoot(Eet)],UH]}),e})(),Aet=(()=>{class e{constructor(n){this.sectorProvider=n,this.selectedSector="All Sectors",this.selectedSection="dashboard"}ngOnInit(){this.sectorProvider.getSector().subscribe(n=>{"all-sectors"===n&&n!==this.selectedSector?this.selectedSector="All Sectors":"garment-sector"===n&&n!==this.selectedSector?this.selectedSector="Garment":"financial-sector"===n&&n!==this.selectedSector?this.selectedSector="Financial":"hospitality-sector"===n&&n!==this.selectedSector&&(this.selectedSector="Hospitality")})}onSelectSector(n){this.selectedSector=n}onSelectSection(n){this.selectedSection=n}}return e.\u0275fac=function(n){return new(n||e)(H(gO))},e.\u0275cmp=Nt({type:e,selectors:[["header-component"]],decls:45,vars:1,consts:[[1,"bg-deep-blue","sticky-top"],[1,"container"],[1,"nav","navbar"],["routerLink","/dashboard",1,"navbar-brand","navbar-expand",3,"click"],["src","assets/logos/walk_free_header_logo.svg",1,"logo","ms-1","mt-1","mb-1"],[1,"navbar","me-auto"],["routerLink","/about",1,"nav-item","nav-link",3,"click"],[1,"nav-item","dropdown","col"],["type","button","id","share","data-bs-toggle","dropdown","aria-expanded","false",1,"nav-item","nav-link"],[1,"bi","bi-share-fill","ms-2"],["aria-labelledby","share",1,"dropdown-menu"],["target","_blank","href","https://www.facebook.com/sharer/sharer.php?u=",1,"dropdown-item"],[1,"bi","bi-facebook","ms-2","me-2"],["target","_blank","href","https://twitter.com/intent/tweet?url=",1,"dropdown-item"],[1,"bi","bi-twitter","ms-2","me-2"],["target","_blank","href","https://www.linkedin.com/shareArticle?mini=true&url=",1,"dropdown-item"],[1,"bi","bi-linkedin","ms-2","me-2"],["target","_blank","href","mailto:info@example.com?&subject=&cc=&bcc=&body=",1,"dropdown-item"],[1,"bi","bi-envelope-fill","ms-2","me-2"],[1,"filter-dropdown","dropdown"],["type","button","id","sector-filter","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-secondary","dropdown-toggle"],["aria-labelledby","sector-filter","data-popper-placement","bottom-start",1,"dropdown-menu"],["routerLink","dashboard/all-sectors",1,"dropdown-item",3,"click"],["routerLink","dashboard/garment-sector",1,"dropdown-item",3,"click"],["routerLink","dashboard/financial-sector",1,"dropdown-item",3,"click"],["routerLink","dashboard/hospitality-sector",1,"dropdown-item",3,"click"]],template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1)(2,"nav",2)(3,"a",3),ke("click",function(){return i.onSelectSection("dashboard")}),Me(4,"img",4),M(),S(5,"div",5)(6,"a",6),ke("click",function(){return i.onSelectSection("about")}),R(7,"ABOUT"),M(),S(8,"div",7)(9,"a",8),R(10," SHARE "),Me(11,"i",9),M(),S(12,"ul",10)(13,"li")(14,"a",11),Me(15,"i",12),R(16,"facebook"),M()(),S(17,"li")(18,"a",13),Me(19,"i",14),R(20,"twitter"),M()(),S(21,"li")(22,"a",15),Me(23,"i",16),R(24,"linkedin"),M()(),S(25,"li")(26,"a",17),Me(27,"i",18),R(28,"mail"),M()()()()(),S(29,"div",19)(30,"a",20),R(31),M(),S(32,"ul",21)(33,"li")(34,"a",22),ke("click",function(){return i.onSelectSector("All Sectors")}),R(35," All Sectors "),M()(),S(36,"li")(37,"a",23),ke("click",function(){return i.onSelectSector("Garment")}),R(38," Garment "),M()(),S(39,"li")(40,"a",24),ke("click",function(){return i.onSelectSector("Financial")}),R(41," Financial "),M()(),S(42,"li")(43,"a",25),ke("click",function(){return i.onSelectSector("Hospitality")}),R(44," Hospitality "),M()()()()()()()),2&n&&($(31),ki(i.selectedSector))},directives:[dN,Tw],styles:[""]}),e})(),Met=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Nt({type:e,selectors:[["footer"]],decls:15,vars:0,consts:[[1,"bg-neutral-grey"],[1,"container","pt-5","pb-5"],[1,"row"],[1,"text-center"],[1,"row","justify-content-center"],[1,"col-3","text-center"],["href","https://walkfree.org/"],["src","assets/logos/walk_free_footer_logo.svg",1,"logo"],[1,"col-3","text-center","logo-center"],["href","https://wikirate.org"],["src","assets/logos/wikirate_logo.svg",1,"logo"],["href","https://www.business-humanrights.org/en/"],["src","assets/logos/bhrrc_logo.png",1,"logo","logo-right"]],template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1)(2,"div",2)(3,"p",3),R(4,"A collaboration between:"),M()(),S(5,"div",4)(6,"div",5)(7,"a",6),Me(8,"img",7),M()(),S(9,"div",8)(10,"a",9),Me(11,"img",10),M()(),S(12,"div",5)(13,"a",11),Me(14,"img",12),M()()()()())},styles:[""]}),e})(),Tet=(()=>{class e{constructor(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=Nt({type:e,selectors:[["app-root"]],decls:3,vars:0,template:function(n,i){1&n&&Me(0,"header-component")(1,"router-outlet")(2,"footer")},directives:[Aet,aO,Met],styles:[""]}),e})();class Due{}const wc="*";function Cue(e,t=null){return{type:2,steps:e,options:t}}function Eue(e){return{type:6,styles:e,offset:null}}function Sue(e){Promise.resolve(null).then(e)}class P1{constructor(t=0,n=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+n}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){Sue(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(i=>i()),n.length=0}}class xue{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let n=0,i=0,r=0;const s=this.players.length;0==s?Sue(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++n==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const n=t*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,n/i.totalTime):1;i.setPosition(r)})}getPosition(){const t=this.players.reduce((n,i)=>null===n||i.totalTime>n.totalTime?i:n,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(i=>i()),n.length=0}}const vt=!1;function Aue(e){return new xe(3e3,vt)}function ctt(){return"undefined"!=typeof window&&void 0!==window.document}function LB(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function pf(e){switch(e.length){case 0:return new P1;case 1:return e[0];default:return new xue(e)}}function Mue(e,t,n,i,r={},s={}){const o=[],a=[];let l=-1,u=null;if(i.forEach(c=>{const d=c.offset,f=d==l,h=f&&u||{};Object.keys(c).forEach(p=>{let g=p,m=c[p];if("offset"!==p)switch(g=t.normalizePropertyName(g,o),m){case"!":m=r[p];break;case wc:m=s[p];break;default:m=t.normalizeStyleValue(p,g,m,o)}h[g]=m}),f||a.push(h),u=h,l=d}),o.length)throw function Zet(e){return new xe(3502,vt)}();return a}function jB(e,t,n,i){switch(t){case"start":e.onStart(()=>i(n&&BB(n,"start",e)));break;case"done":e.onDone(()=>i(n&&BB(n,"done",e)));break;case"destroy":e.onDestroy(()=>i(n&&BB(n,"destroy",e)))}}function BB(e,t,n){const i=n.totalTime,s=$B(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null==i?e.totalTime:i,!!n.disabled),o=e._data;return null!=o&&(s._data=o),s}function $B(e,t,n,i,r="",s=0,o){return{element:e,triggerName:t,fromState:n,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function go(e,t,n){let i;return e instanceof Map?(i=e.get(t),i||e.set(t,i=n)):(i=e[t],i||(i=e[t]=n)),i}function Tue(e){const t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}let VB=(e,t)=>!1,Oue=(e,t,n)=>[],Nue=null;function HB(e){const t=e.parentNode||e.host;return t===Nue?null:t}(LB()||"undefined"!=typeof Element)&&(ctt()?(Nue=(()=>document.documentElement)(),VB=(e,t)=>{for(;t;){if(t===e)return!0;t=HB(t)}return!1}):VB=(e,t)=>e.contains(t),Oue=(e,t,n)=>{if(n)return Array.from(e.querySelectorAll(t));const i=e.querySelector(t);return i?[i]:[]});let mp=null,kue=!1;function Iue(e){mp||(mp=function ftt(){return"undefined"!=typeof document?document.body:null}()||{},kue=!!mp.style&&"WebkitAppearance"in mp.style);let t=!0;return mp.style&&!function dtt(e){return"ebkit"==e.substring(1,6)}(e)&&(t=e in mp.style,!t&&kue&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in mp.style)),t}const Rue=VB,Fue=Oue;let Pue=(()=>{class e{validateStyleProperty(n){return Iue(n)}matchesElement(n,i){return!1}containsElement(n,i){return Rue(n,i)}getParentElement(n){return HB(n)}query(n,i,r){return Fue(n,i,r)}computeStyle(n,i,r){return r||""}animate(n,i,r,s,o,a=[],l){return new P1(r,s)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})(),UB=(()=>{class e{}return e.NOOP=new Pue,e})();const zB="ng-enter",_A="ng-leave",yA="ng-trigger",vA=".ng-trigger",jue="ng-animating",qB=".ng-animating";function _p(e){if("number"==typeof e)return e;const t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:GB(parseFloat(t[1]),t[2])}function GB(e,t){return"s"===t?1e3*e:e}function bA(e,t,n){return e.hasOwnProperty("duration")?e:function gtt(e,t,n){let r,s=0,o="";if("string"==typeof e){const a=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return t.push(Aue()),{duration:0,delay:0,easing:""};r=GB(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(s=GB(parseFloat(l),a[4]));const u=a[5];u&&(o=u)}else r=e;if(!n){let a=!1,l=t.length;r<0&&(t.push(function Net(){return new xe(3100,vt)}()),a=!0),s<0&&(t.push(function ket(){return new xe(3101,vt)}()),a=!0),a&&t.splice(l,0,Aue())}return{duration:r,delay:s,easing:o}}(e,t,n)}function y0(e,t={}){return Object.keys(e).forEach(n=>{t[n]=e[n]}),t}function gf(e,t,n={}){if(t)for(let i in e)n[i]=e[i];else y0(e,n);return n}function $ue(e,t,n){return n?t+":"+n+";":""}function Vue(e){let t="";for(let n=0;n<e.style.length;n++){const i=e.style.item(n);t+=$ue(0,i,e.style.getPropertyValue(i))}for(const n in e.style)e.style.hasOwnProperty(n)&&!n.startsWith("_")&&(t+=$ue(0,ytt(n),e.style[n]));e.setAttribute("style",t)}function mu(e,t,n){e.style&&(Object.keys(t).forEach(i=>{const r=YB(i);n&&!n.hasOwnProperty(i)&&(n[i]=e.style[r]),e.style[r]=t[i]}),LB()&&Vue(e))}function yp(e,t){e.style&&(Object.keys(t).forEach(n=>{const i=YB(n);e.style[i]=""}),LB()&&Vue(e))}function L1(e){return Array.isArray(e)?1==e.length?e[0]:Cue(e):e}const WB=new RegExp("{{\\s*(.+?)\\s*}}","g");function Hue(e){let t=[];if("string"==typeof e){let n;for(;n=WB.exec(e);)t.push(n[1]);WB.lastIndex=0}return t}function wA(e,t,n){const i=e.toString(),r=i.replace(WB,(s,o)=>{let a=t[o];return t.hasOwnProperty(o)||(n.push(function Ret(e){return new xe(3003,vt)}()),a=""),a.toString()});return r==i?e:r}function DA(e){const t=[];let n=e.next();for(;!n.done;)t.push(n.value),n=e.next();return t}const _tt=/-+([a-z0-9])/g;function YB(e){return e.replace(_tt,(...t)=>t[1].toUpperCase())}function ytt(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function mo(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw function Fet(e){return new xe(3004,vt)}()}}function Uue(e,t){return window.getComputedStyle(e)[t]}function Ett(e,t){const n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(i=>function Stt(e,t,n){if(":"==e[0]){const l=function xtt(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(n,i)=>parseFloat(i)>parseFloat(n);case":decrement":return(n,i)=>parseFloat(i)<parseFloat(n);default:return t.push(function Ket(e){return new xe(3016,vt)}()),"* => *"}}(e,n);if("function"==typeof l)return void t.push(l);e=l}const i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push(function Yet(e){return new xe(3015,vt)}()),t;const r=i[1],s=i[2],o=i[3];t.push(zue(r,o));"<"==s[0]&&!("*"==r&&"*"==o)&&t.push(zue(o,r))}(i,n,t)):n.push(e),n}const xA=new Set(["true","1"]),AA=new Set(["false","0"]);function zue(e,t){const n=xA.has(e)||AA.has(e),i=xA.has(t)||AA.has(t);return(r,s)=>{let o="*"==e||e==r,a="*"==t||t==s;return!o&&n&&"boolean"==typeof r&&(o=r?xA.has(e):AA.has(e)),!a&&i&&"boolean"==typeof s&&(a=s?xA.has(t):AA.has(t)),o&&a}}const Att=new RegExp("s*:selfs*,?","g");function KB(e,t,n,i){return new Mtt(e).build(t,n,i)}class Mtt{constructor(t){this._driver=t}build(t,n,i){const r=new Ntt(n);this._resetContextStyleTimingState(r);const s=mo(this,L1(t),r);return r.unsupportedCSSPropertiesFound.size&&r.unsupportedCSSPropertiesFound.keys(),s}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles={},t.collectedStyles[""]={},t.currentTime=0}visitTrigger(t,n){let i=n.queryCount=0,r=n.depCount=0;const s=[],o=[];return"@"==t.name.charAt(0)&&n.errors.push(function Let(){return new xe(3006,vt)}()),t.definitions.forEach(a=>{if(this._resetContextStyleTimingState(n),0==a.type){const l=a,u=l.name;u.toString().split(/\s*,\s*/).forEach(c=>{l.name=c,s.push(this.visitState(l,n))}),l.name=u}else if(1==a.type){const l=this.visitTransition(a,n);i+=l.queryCount,r+=l.depCount,o.push(l)}else n.errors.push(function jet(){return new xe(3007,vt)}())}),{type:7,name:t.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(t,n){const i=this.visitStyle(t.styles,n),r=t.options&&t.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};i.styles.forEach(a=>{if(MA(a)){const l=a;Object.keys(l).forEach(u=>{Hue(l[u]).forEach(c=>{o.hasOwnProperty(c)||s.add(c)})})}}),s.size&&(DA(s.values()),n.errors.push(function Bet(e,t){return new xe(3008,vt)}()))}return{type:0,name:t.name,style:i,options:r?{params:r}:null}}visitTransition(t,n){n.queryCount=0,n.depCount=0;const i=mo(this,L1(t.animation),n);return{type:1,matchers:Ett(t.expr,n.errors),animation:i,queryCount:n.queryCount,depCount:n.depCount,options:vp(t.options)}}visitSequence(t,n){return{type:2,steps:t.steps.map(i=>mo(this,i,n)),options:vp(t.options)}}visitGroup(t,n){const i=n.currentTime;let r=0;const s=t.steps.map(o=>{n.currentTime=i;const a=mo(this,o,n);return r=Math.max(r,n.currentTime),a});return n.currentTime=r,{type:3,steps:s,options:vp(t.options)}}visitAnimate(t,n){const i=function Itt(e,t){if(e.hasOwnProperty("duration"))return e;if("number"==typeof e)return JB(bA(e,t).duration,0,"");const n=e;if(n.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=JB(0,0,"");return s.dynamic=!0,s.strValue=n,s}const r=bA(n,t);return JB(r.duration,r.delay,r.easing)}(t.timings,n.errors);n.currentAnimateTimings=i;let r,s=t.styles?t.styles:Eue({});if(5==s.type)r=this.visitKeyframes(s,n);else{let o=t.styles,a=!1;if(!o){a=!0;const u={};i.easing&&(u.easing=i.easing),o=Eue(u)}n.currentTime+=i.duration+i.delay;const l=this.visitStyle(o,n);l.isEmptyStep=a,r=l}return n.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(t,n){const i=this._makeStyleAst(t,n);return this._validateStyleAst(i,n),i}_makeStyleAst(t,n){const i=[];Array.isArray(t.styles)?t.styles.forEach(o=>{"string"==typeof o?o==wc?i.push(o):n.errors.push(function $et(e){return new xe(3002,vt)}()):i.push(o)}):i.push(t.styles);let r=!1,s=null;return i.forEach(o=>{if(MA(o)){const a=o,l=a.easing;if(l&&(s=l,delete a.easing),!r)for(let u in a)if(a[u].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:i,easing:s,offset:t.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(t,n){const i=n.currentAnimateTimings;let r=n.currentTime,s=n.currentTime;i&&s>0&&(s-=i.duration+i.delay),t.styles.forEach(o=>{"string"!=typeof o&&Object.keys(o).forEach(a=>{if(!this._driver.validateStyleProperty(a))return delete o[a],void n.unsupportedCSSPropertiesFound.add(a);const l=n.collectedStyles[n.currentQuerySelector],u=l[a];let c=!0;u&&(s!=r&&s>=u.startTime&&r<=u.endTime&&(n.errors.push(function Vet(e,t,n,i,r){return new xe(3010,vt)}()),c=!1),s=u.startTime),c&&(l[a]={startTime:s,endTime:r}),n.options&&function mtt(e,t,n){const i=t.params||{},r=Hue(e);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||n.push(function Iet(e){return new xe(3001,vt)}())})}(o[a],n.options,n.errors)})})}visitKeyframes(t,n){const i={type:5,styles:[],options:null};if(!n.currentAnimateTimings)return n.errors.push(function Het(){return new xe(3011,vt)}()),i;let s=0;const o=[];let a=!1,l=!1,u=0;const c=t.steps.map(_=>{const y=this._makeStyleAst(_,n);let v=null!=y.offset?y.offset:function ktt(e){if("string"==typeof e)return null;let t=null;if(Array.isArray(e))e.forEach(n=>{if(MA(n)&&n.hasOwnProperty("offset")){const i=n;t=parseFloat(i.offset),delete i.offset}});else if(MA(e)&&e.hasOwnProperty("offset")){const n=e;t=parseFloat(n.offset),delete n.offset}return t}(y.styles),b=0;return null!=v&&(s++,b=y.offset=v),l=l||b<0||b>1,a=a||b<u,u=b,o.push(b),y});l&&n.errors.push(function Uet(){return new xe(3012,vt)}()),a&&n.errors.push(function zet(){return new xe(3200,vt)}());const d=t.steps.length;let f=0;s>0&&s<d?n.errors.push(function qet(){return new xe(3202,vt)}()):0==s&&(f=1/(d-1));const h=d-1,p=n.currentTime,g=n.currentAnimateTimings,m=g.duration;return c.forEach((_,y)=>{const v=f>0?y==h?1:f*y:o[y],b=v*m;n.currentTime=p+g.delay+b,g.duration=b,this._validateStyleAst(_,n),_.offset=v,i.styles.push(_)}),i}visitReference(t,n){return{type:8,animation:mo(this,L1(t.animation),n),options:vp(t.options)}}visitAnimateChild(t,n){return n.depCount++,{type:9,options:vp(t.options)}}visitAnimateRef(t,n){return{type:10,animation:this.visitReference(t.animation,n),options:vp(t.options)}}visitQuery(t,n){const i=n.currentQuerySelector,r=t.options||{};n.queryCount++,n.currentQuery=t;const[s,o]=function Ttt(e){const t=!!e.split(/\s*,\s*/).find(n=>":self"==n);return t&&(e=e.replace(Att,"")),e=e.replace(/@\*/g,vA).replace(/@\w+/g,n=>vA+"-"+n.substr(1)).replace(/:animating/g,qB),[e,t]}(t.selector);n.currentQuerySelector=i.length?i+" "+s:s,go(n.collectedStyles,n.currentQuerySelector,{});const a=mo(this,L1(t.animation),n);return n.currentQuery=null,n.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:t.selector,options:vp(t.options)}}visitStagger(t,n){n.currentQuery||n.errors.push(function Get(){return new xe(3013,vt)}());const i="full"===t.timings?{duration:0,delay:0,easing:"full"}:bA(t.timings,n.errors,!0);return{type:12,animation:mo(this,L1(t.animation),n),timings:i,options:null}}}class Ntt{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function MA(e){return!Array.isArray(e)&&"object"==typeof e}function vp(e){return e?(e=y0(e)).params&&(e.params=function Ott(e){return e?y0(e):null}(e.params)):e={},e}function JB(e,t,n){return{duration:e,delay:t,easing:n}}function XB(e,t,n,i,r,s,o=null,a=!1){return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class TA{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,n){let i=this._map.get(t);i||this._map.set(t,i=[]),i.push(...n)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const Ptt=new RegExp(":enter","g"),jtt=new RegExp(":leave","g");function QB(e,t,n,i,r,s={},o={},a,l,u=[]){return(new Btt).buildKeyframes(e,t,n,i,r,s,o,a,l,u)}class Btt{buildKeyframes(t,n,i,r,s,o,a,l,u,c=[]){u=u||new TA;const d=new ZB(t,n,u,r,s,c,[]);d.options=l,d.currentTimeline.setStyles([o],null,d.errors,l),mo(this,i,d);const f=d.timelines.filter(h=>h.containsAnimation());if(Object.keys(a).length){let h;for(let p=f.length-1;p>=0;p--){const g=f[p];if(g.element===n){h=g;break}}h&&!h.allowOnlyTimelineStyles()&&h.setStyles([a],null,d.errors,l)}return f.length?f.map(h=>h.buildKeyframes()):[XB(n,[],[],[],0,0,"",!1)]}visitTrigger(t,n){}visitState(t,n){}visitTransition(t,n){}visitAnimateChild(t,n){const i=n.subInstructions.get(n.element);if(i){const r=n.createSubContext(t.options),s=n.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&n.transformIntoNewTimeline(o)}n.previousNode=t}visitAnimateRef(t,n){const i=n.createSubContext(t.options);i.transformIntoNewTimeline(),this.visitReference(t.animation,i),n.transformIntoNewTimeline(i.currentTimeline.currentTime),n.previousNode=t}_visitSubInstructions(t,n,i){let s=n.currentTimeline.currentTime;const o=null!=i.duration?_p(i.duration):null,a=null!=i.delay?_p(i.delay):null;return 0!==o&&t.forEach(l=>{const u=n.appendInstructionToTimeline(l,o,a);s=Math.max(s,u.duration+u.delay)}),s}visitReference(t,n){n.updateOptions(t.options,!0),mo(this,t.animation,n),n.previousNode=t}visitSequence(t,n){const i=n.subContextCount;let r=n;const s=t.options;if(s&&(s.params||s.delay)&&(r=n.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=OA);const o=_p(s.delay);r.delayNextStep(o)}t.steps.length&&(t.steps.forEach(o=>mo(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),n.previousNode=t}visitGroup(t,n){const i=[];let r=n.currentTimeline.currentTime;const s=t.options&&t.options.delay?_p(t.options.delay):0;t.steps.forEach(o=>{const a=n.createSubContext(t.options);s&&a.delayNextStep(s),mo(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(o=>n.currentTimeline.mergeTimelineCollectedStyles(o)),n.transformIntoNewTimeline(r),n.previousNode=t}_visitTiming(t,n){if(t.dynamic){const i=t.strValue;return bA(n.params?wA(i,n.params,n.errors):i,n.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,n){const i=n.currentAnimateTimings=this._visitTiming(t.timings,n),r=n.currentTimeline;i.delay&&(n.incrementTime(i.delay),r.snapshotCurrentStyles());const s=t.style;5==s.type?this.visitKeyframes(s,n):(n.incrementTime(i.duration),this.visitStyle(s,n),r.applyStylesToKeyframe()),n.currentAnimateTimings=null,n.previousNode=t}visitStyle(t,n){const i=n.currentTimeline,r=n.currentAnimateTimings;!r&&i.getCurrentStyleProperties().length&&i.forwardFrame();const s=r&&r.easing||t.easing;t.isEmptyStep?i.applyEmptyStep(s):i.setStyles(t.styles,s,n.errors,n.options),n.previousNode=t}visitKeyframes(t,n){const i=n.currentAnimateTimings,r=n.currentTimeline.duration,s=i.duration,a=n.createSubContext().currentTimeline;a.easing=i.easing,t.styles.forEach(l=>{a.forwardTime((l.offset||0)*s),a.setStyles(l.styles,l.easing,n.errors,n.options),a.applyStylesToKeyframe()}),n.currentTimeline.mergeTimelineCollectedStyles(a),n.transformIntoNewTimeline(r+s),n.previousNode=t}visitQuery(t,n){const i=n.currentTimeline.currentTime,r=t.options||{},s=r.delay?_p(r.delay):0;s&&(6===n.previousNode.type||0==i&&n.currentTimeline.getCurrentStyleProperties().length)&&(n.currentTimeline.snapshotCurrentStyles(),n.previousNode=OA);let o=i;const a=n.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,n.errors);n.currentQueryTotal=a.length;let l=null;a.forEach((u,c)=>{n.currentQueryIndex=c;const d=n.createSubContext(t.options,u);s&&d.delayNextStep(s),u===n.element&&(l=d.currentTimeline),mo(this,t.animation,d),d.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,d.currentTimeline.currentTime)}),n.currentQueryIndex=0,n.currentQueryTotal=0,n.transformIntoNewTimeline(o),l&&(n.currentTimeline.mergeTimelineCollectedStyles(l),n.currentTimeline.snapshotCurrentStyles()),n.previousNode=t}visitStagger(t,n){const i=n.parentContext,r=n.currentTimeline,s=t.timings,o=Math.abs(s.duration),a=o*(n.currentQueryTotal-1);let l=o*n.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=i.currentStaggerTime}const c=n.currentTimeline;l&&c.delayNextStep(l);const d=c.currentTime;mo(this,t.animation,n),n.previousNode=t,i.currentStaggerTime=r.currentTime-d+(r.startTime-i.currentTimeline.startTime)}}const OA={};class ZB{constructor(t,n,i,r,s,o,a,l){this._driver=t,this.element=n,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=OA,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new NA(this._driver,n,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,n){if(!t)return;const i=t;let r=this.options;null!=i.duration&&(r.duration=_p(i.duration)),null!=i.delay&&(r.delay=_p(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!n||!o.hasOwnProperty(a))&&(o[a]=wA(s[a],o,this.errors))})}}_copyOptions(){const t={};if(this.options){const n=this.options.params;if(n){const i=t.params={};Object.keys(n).forEach(r=>{i[r]=n[r]})}}return t}createSubContext(t=null,n,i){const r=n||this.element,s=new ZB(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(t),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(t){return this.previousNode=OA,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,n,i){const r={duration:null!=n?n:t.duration,delay:this.currentTimeline.currentTime+(null!=i?i:0)+t.delay,easing:""},s=new $tt(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,n,i,r,s,o){let a=[];if(r&&a.push(this.element),t.length>0){t=(t=t.replace(Ptt,"."+this._enterClassName)).replace(jtt,"."+this._leaveClassName);let u=this._driver.query(this.element,t,1!=i);0!==i&&(u=i<0?u.slice(u.length+i,u.length):u.slice(0,i)),a.push(...u)}return!s&&0==a.length&&o.push(function Wet(e){return new xe(3014,vt)}()),a}}class NA{constructor(t,n,i,r){this._driver=t,this.element=n,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const n=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||n?(this.forwardTime(this.currentTime+t),n&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,n){return this.applyStylesToKeyframe(),new NA(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,n){this._localTimelineStyles[t]=n,this._globalTimelineStyles[t]=n,this._styleSummary[t]={time:this.currentTime,value:n}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(n=>{this._backFill[n]=this._globalTimelineStyles[n]||wc,this._currentKeyframe[n]=wc}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,n,i,r){n&&(this._previousKeyframe.easing=n);const s=r&&r.params||{},o=function Vtt(e,t){const n={};let i;return e.forEach(r=>{"*"===r?(i=i||Object.keys(t),i.forEach(s=>{n[s]=wc})):gf(r,!1,n)}),n}(t,this._globalTimelineStyles);Object.keys(o).forEach(a=>{const l=wA(o[a],s,i);this._pendingStyles[a]=l,this._localTimelineStyles.hasOwnProperty(a)||(this._backFill[a]=this._globalTimelineStyles.hasOwnProperty(a)?this._globalTimelineStyles[a]:wc),this._updateStyle(a,l)})}applyStylesToKeyframe(){const t=this._pendingStyles,n=Object.keys(t);0!=n.length&&(this._pendingStyles={},n.forEach(i=>{this._currentKeyframe[i]=t[i]}),Object.keys(this._localTimelineStyles).forEach(i=>{this._currentKeyframe.hasOwnProperty(i)||(this._currentKeyframe[i]=this._localTimelineStyles[i])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const n=this._localTimelineStyles[t];this._pendingStyles[t]=n,this._updateStyle(t,n)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let n in this._currentKeyframe)t.push(n);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(n=>{const i=this._styleSummary[n],r=t._styleSummary[n];(!i||r.time>i.time)&&this._updateStyle(n,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,n=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const u=gf(a,!0);Object.keys(u).forEach(c=>{const d=u[c];"!"==d?t.add(c):d==wc&&n.add(c)}),i||(u.offset=l/this.duration),r.push(u)});const s=t.size?DA(t.values()):[],o=n.size?DA(n.values()):[];if(i){const a=r[0],l=y0(a);a.offset=0,l.offset=1,r=[a,l]}return XB(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class $tt extends NA{constructor(t,n,i,r,s,o,a=!1){super(t,n,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:n,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&n){const s=[],o=i+n,a=n/o,l=gf(t[0],!1);l.offset=0,s.push(l);const u=gf(t[0],!1);u.offset=Wue(a),s.push(u);const c=t.length-1;for(let d=1;d<=c;d++){let f=gf(t[d],!1);f.offset=Wue((n+f.offset*i)/o),s.push(f)}i=o,n=0,r="",t=s}return XB(this.element,t,this.preStyleProps,this.postStyleProps,i,n,r,!0)}}function Wue(e,t=3){const n=Math.pow(10,t-1);return Math.round(e*n)/n}class e4{}class Htt extends e4{normalizePropertyName(t,n){return YB(t)}normalizeStyleValue(t,n,i,r){let s="";const o=i.toString().trim();if(Utt[n]&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function Pet(e,t){return new xe(3005,vt)}())}return o+s}}const Utt=(()=>function ztt(e){const t={};return e.forEach(n=>t[n]=!0),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function Yue(e,t,n,i,r,s,o,a,l,u,c,d,f){return{type:0,element:e,triggerName:t,isRemovalTransition:r,fromState:n,fromStyles:s,toState:i,toStyles:o,timelines:a,queriedElements:l,preStyleProps:u,postStyleProps:c,totalTime:d,errors:f}}const t4={};class Kue{constructor(t,n,i){this._triggerName=t,this.ast=n,this._stateStyles=i}match(t,n,i,r){return function qtt(e,t,n,i,r){return e.some(s=>s(t,n,i,r))}(this.ast.matchers,t,n,i,r)}buildStyles(t,n,i){const r=this._stateStyles["*"],s=this._stateStyles[t],o=r?r.buildStyles(n,i):{};return s?s.buildStyles(n,i):o}build(t,n,i,r,s,o,a,l,u,c){const d=[],f=this.ast.options&&this.ast.options.params||t4,p=this.buildStyles(i,a&&a.params||t4,d),g=l&&l.params||t4,m=this.buildStyles(r,g,d),_=new Set,y=new Map,v=new Map,b="void"===r,D={params:Object.assign(Object.assign({},f),g)},C=c?[]:QB(t,n,this.ast.animation,s,o,p,m,D,u,d);let w=0;if(C.forEach(N=>{w=Math.max(N.duration+N.delay,w)}),d.length)return Yue(n,this._triggerName,i,r,b,p,m,[],[],y,v,w,d);C.forEach(N=>{const k=N.element,I=go(y,k,{});N.preStyleProps.forEach(B=>I[B]=!0);const L=go(v,k,{});N.postStyleProps.forEach(B=>L[B]=!0),k!==n&&_.add(k)});const E=DA(_.values());return Yue(n,this._triggerName,i,r,b,p,m,C,E,y,v,w)}}class Gtt{constructor(t,n,i){this.styles=t,this.defaultParams=n,this.normalizer=i}buildStyles(t,n){const i={},r=y0(this.defaultParams);return Object.keys(t).forEach(s=>{const o=t[s];null!=o&&(r[s]=o)}),this.styles.styles.forEach(s=>{if("string"!=typeof s){const o=s;Object.keys(o).forEach(a=>{let l=o[a];l.length>1&&(l=wA(l,r,n));const u=this.normalizer.normalizePropertyName(a,n);l=this.normalizer.normalizeStyleValue(a,u,l,n),i[u]=l})}}),i}}class Ytt{constructor(t,n,i){this.name=t,this.ast=n,this._normalizer=i,this.transitionFactories=[],this.states={},n.states.forEach(r=>{this.states[r.name]=new Gtt(r.style,r.options&&r.options.params||{},i)}),Jue(this.states,"true","1"),Jue(this.states,"false","0"),n.transitions.forEach(r=>{this.transitionFactories.push(new Kue(t,r,this.states))}),this.fallbackTransition=function Ktt(e,t,n){return new Kue(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,n,i,r){return this.transitionFactories.find(o=>o.match(t,n,i,r))||null}matchStyles(t,n,i){return this.fallbackTransition.buildStyles(t,n,i)}}function Jue(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}const Jtt=new TA;class Xtt{constructor(t,n,i){this.bodyNode=t,this._driver=n,this._normalizer=i,this._animations={},this._playersById={},this.players=[]}register(t,n){const i=[],s=KB(this._driver,n,i,[]);if(i.length)throw function ett(e){return new xe(3503,vt)}();this._animations[t]=s}_buildPlayer(t,n,i){const r=t.element,s=Mue(0,this._normalizer,0,t.keyframes,n,i);return this._driver.animate(r,s,t.duration,t.delay,t.easing,[],!0)}create(t,n,i={}){const r=[],s=this._animations[t];let o;const a=new Map;if(s?(o=QB(this._driver,n,s,zB,_A,{},{},i,Jtt,r),o.forEach(c=>{const d=go(a,c.element,{});c.postStyleProps.forEach(f=>d[f]=null)})):(r.push(function ttt(){return new xe(3300,vt)}()),o=[]),r.length)throw function ntt(e){return new xe(3504,vt)}();a.forEach((c,d)=>{Object.keys(c).forEach(f=>{c[f]=this._driver.computeStyle(d,f,wc)})});const u=pf(o.map(c=>{const d=a.get(c.element);return this._buildPlayer(c,{},d)}));return this._playersById[t]=u,u.onDestroy(()=>this.destroy(t)),this.players.push(u),u}destroy(t){const n=this._getPlayer(t);n.destroy(),delete this._playersById[t];const i=this.players.indexOf(n);i>=0&&this.players.splice(i,1)}_getPlayer(t){const n=this._playersById[t];if(!n)throw function itt(e){return new xe(3301,vt)}();return n}listen(t,n,i,r){const s=$B(n,"","","");return jB(this._getPlayer(t),i,s,r),()=>{}}command(t,n,i,r){if("register"==i)return void this.register(t,r[0]);if("create"==i)return void this.create(t,n,r[0]||{});const s=this._getPlayer(t);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const Xue="ng-animate-queued",n4="ng-animate-disabled",nnt=[],Que={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},int={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},ta="__ng_removed";class i4{constructor(t,n=""){this.namespaceId=n;const i=t&&t.hasOwnProperty("value");if(this.value=function ant(e){return null!=e?e:null}(i?t.value:t),i){const s=y0(t);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const n=t.params;if(n){const i=this.options.params;Object.keys(n).forEach(r=>{null==i[r]&&(i[r]=n[r])})}}}const j1="void",r4=new i4(j1);class rnt{constructor(t,n,i){this.id=t,this.hostElement=n,this._engine=i,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,na(n,this._hostClassName)}listen(t,n,i,r){if(!this._triggers.hasOwnProperty(n))throw function rtt(e,t){return new xe(3302,vt)}();if(null==i||0==i.length)throw function stt(e){return new xe(3303,vt)}();if(!function lnt(e){return"start"==e||"done"==e}(i))throw function ott(e,t){return new xe(3400,vt)}();const s=go(this._elementListeners,t,[]),o={name:n,phase:i,callback:r};s.push(o);const a=go(this._engine.statesByElement,t,{});return a.hasOwnProperty(n)||(na(t,yA),na(t,yA+"-"+n),a[n]=r4),()=>{this._engine.afterFlush(()=>{const l=s.indexOf(o);l>=0&&s.splice(l,1),this._triggers[n]||delete a[n]})}}register(t,n){return!this._triggers[t]&&(this._triggers[t]=n,!0)}_getTrigger(t){const n=this._triggers[t];if(!n)throw function att(e){return new xe(3401,vt)}();return n}trigger(t,n,i,r=!0){const s=this._getTrigger(n),o=new s4(this.id,n,t);let a=this._engine.statesByElement.get(t);a||(na(t,yA),na(t,yA+"-"+n),this._engine.statesByElement.set(t,a={}));let l=a[n];const u=new i4(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&l&&u.absorbOptions(l.options),a[n]=u,l||(l=r4),u.value!==j1&&l.value===u.value){if(!function dnt(e,t){const n=Object.keys(e),i=Object.keys(t);if(n.length!=i.length)return!1;for(let r=0;r<n.length;r++){const s=n[r];if(!t.hasOwnProperty(s)||e[s]!==t[s])return!1}return!0}(l.params,u.params)){const g=[],m=s.matchStyles(l.value,l.params,g),_=s.matchStyles(u.value,u.params,g);g.length?this._engine.reportError(g):this._engine.afterFlush(()=>{yp(t,m),mu(t,_)})}return}const f=go(this._engine.playersByElement,t,[]);f.forEach(g=>{g.namespaceId==this.id&&g.triggerName==n&&g.queued&&g.destroy()});let h=s.matchTransition(l.value,u.value,t,u.params),p=!1;if(!h){if(!r)return;h=s.fallbackTransition,p=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:n,transition:h,fromState:l,toState:u,player:o,isFallbackTransition:p}),p||(na(t,Xue),o.onStart(()=>{v0(t,Xue)})),o.onDone(()=>{let g=this.players.indexOf(o);g>=0&&this.players.splice(g,1);const m=this._engine.playersByElement.get(t);if(m){let _=m.indexOf(o);_>=0&&m.splice(_,1)}}),this.players.push(o),f.push(o),o}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((n,i)=>{delete n[t]}),this._elementListeners.forEach((n,i)=>{this._elementListeners.set(i,n.filter(r=>r.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const n=this._engine.playersByElement.get(t);n&&(n.forEach(i=>i.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,n){const i=this._engine.driver.query(t,vA,!0);i.forEach(r=>{if(r[ta])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,n,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(t,n,i,r){const s=this._engine.statesByElement.get(t),o=new Map;if(s){const a=[];if(Object.keys(s).forEach(l=>{if(o.set(l,s[l].value),this._triggers[l]){const u=this.trigger(t,l,j1,r);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,t,!0,n,o),i&&pf(a).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const n=this._elementListeners.get(t),i=this._engine.statesByElement.get(t);if(n&&i){const r=new Set;n.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const l=this._triggers[o].fallbackTransition,u=i[o]||r4,c=new i4(j1),d=new s4(this.id,o,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:o,transition:l,fromState:u,toState:c,player:d,isFallbackTransition:!0})})}}removeNode(t,n){const i=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,n),this.triggerLeaveAnimation(t,n,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(t):[];if(s&&s.length)r=!0;else{let o=t;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)i.markElementAsRemoved(this.id,t,!1,n);else{const s=t[ta];(!s||s===Que)&&(i.afterFlush(()=>this.clearElementCache(t)),i.destroyInnerAnimations(t),i._onRemovalComplete(t,n))}}insertNode(t,n){na(t,this._hostClassName)}drainQueuedTransitions(t){const n=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==i.triggerName){const l=$B(s,i.triggerName,i.fromState.value,i.toState.value);l._data=t,jB(i.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):n.push(i)}),this._queue=[],n.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(t){this.players.forEach(n=>n.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let n=!1;return this._elementListeners.has(t)&&(n=!0),n=!!this._queue.find(i=>i.element===t)||n,n}}class snt{constructor(t,n,i){this.bodyNode=t,this.driver=n,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}_onRemovalComplete(t,n){this.onRemovalComplete(t,n)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(n=>{n.players.forEach(i=>{i.queued&&t.push(i)})}),t}createNamespace(t,n){const i=new rnt(t,n,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,n)?this._balanceNamespaceList(i,n):(this.newHostElements.set(n,i),this.collectEnterElement(n)),this._namespaceLookup[t]=i}_balanceNamespaceList(t,n){const i=this._namespaceList,r=this.namespacesByHostElement,s=i.length-1;if(s>=0){let o=!1;if(void 0!==this.driver.getParentElement){let a=this.driver.getParentElement(n);for(;a;){const l=r.get(a);if(l){const u=i.indexOf(l);i.splice(u+1,0,t),o=!0;break}a=this.driver.getParentElement(a)}}else for(let a=s;a>=0;a--)if(this.driver.containsElement(i[a].hostElement,n)){i.splice(a+1,0,t),o=!0;break}o||i.unshift(t)}else i.push(t);return r.set(n,t),t}register(t,n){let i=this._namespaceLookup[t];return i||(i=this.createNamespace(t,n)),i}registerTrigger(t,n,i){let r=this._namespaceLookup[t];r&&r.register(n,i)&&this.totalAnimations++}destroy(t,n){if(!t)return;const i=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[t];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(n))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const n=new Set,i=this.statesByElement.get(t);if(i){const r=Object.keys(i);for(let s=0;s<r.length;s++){const o=i[r[s]].namespaceId;if(o){const a=this._fetchNamespace(o);a&&n.add(a)}}}return n}trigger(t,n,i,r){if(kA(n)){const s=this._fetchNamespace(t);if(s)return s.trigger(n,i,r),!0}return!1}insertNode(t,n,i,r){if(!kA(n))return;const s=n[ta];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(n);o>=0&&this.collectedLeaveElements.splice(o,1)}if(t){const o=this._fetchNamespace(t);o&&o.insertNode(n,i)}r&&this.collectEnterElement(n)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,n){n?this.disabledNodes.has(t)||(this.disabledNodes.add(t),na(t,n4)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),v0(t,n4))}removeNode(t,n,i,r){if(kA(n)){const s=t?this._fetchNamespace(t):null;if(s?s.removeNode(n,r):this.markElementAsRemoved(t,n,!1,r),i){const o=this.namespacesByHostElement.get(n);o&&o.id!==t&&o.removeNode(n,r)}}else this._onRemovalComplete(n,r)}markElementAsRemoved(t,n,i,r,s){this.collectedLeaveElements.push(n),n[ta]={namespaceId:t,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(t,n,i,r,s){return kA(n)?this._fetchNamespace(t).listen(n,i,r,s):()=>{}}_buildInstruction(t,n,i,r,s){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,i,r,t.fromState.options,t.toState.options,n,s)}destroyInnerAnimations(t){let n=this.driver.query(t,vA,!0);n.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(n=this.driver.query(t,qB,!0),n.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(t){const n=this.playersByElement.get(t);n&&n.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(t){const n=this.playersByQueriedElement.get(t);n&&n.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return pf(this.players).onDone(()=>t());t()})}processLeaveNode(t){var n;const i=t[ta];if(i&&i.setForRemoval){if(t[ta]=Que,i.namespaceId){this.destroyInnerAnimations(t);const r=this._fetchNamespace(i.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,i.setForRemoval)}(null===(n=t.classList)||void 0===n?void 0:n.contains(n4))&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(t=-1){let n=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)na(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{n=this._flushAnimations(i,t)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],n.length?pf(n).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(t){throw function ltt(e){return new xe(3402,vt)}()}_flushAnimations(t,n){const i=new TA,r=[],s=new Map,o=[],a=new Map,l=new Map,u=new Map,c=new Set;this.disabledNodes.forEach(x=>{c.add(x);const F=this.driver.query(x,".ng-animate-queued",!0);for(let O=0;O<F.length;O++)c.add(F[O])});const d=this.bodyNode,f=Array.from(this.statesByElement.keys()),h=tce(f,this.collectedEnterElements),p=new Map;let g=0;h.forEach((x,F)=>{const O=zB+g++;p.set(F,O),x.forEach(j=>na(j,O))});const m=[],_=new Set,y=new Set;for(let x=0;x<this.collectedLeaveElements.length;x++){const F=this.collectedLeaveElements[x],O=F[ta];O&&O.setForRemoval&&(m.push(F),_.add(F),O.hasAnimation?this.driver.query(F,".ng-star-inserted",!0).forEach(j=>_.add(j)):y.add(F))}const v=new Map,b=tce(f,Array.from(_));b.forEach((x,F)=>{const O=_A+g++;v.set(F,O),x.forEach(j=>na(j,O))}),t.push(()=>{h.forEach((x,F)=>{const O=p.get(F);x.forEach(j=>v0(j,O))}),b.forEach((x,F)=>{const O=v.get(F);x.forEach(j=>v0(j,O))}),m.forEach(x=>{this.processLeaveNode(x)})});const D=[],C=[];for(let x=this._namespaceList.length-1;x>=0;x--)this._namespaceList[x].drainQueuedTransitions(n).forEach(O=>{const j=O.player,P=O.element;if(D.push(j),this.collectedEnterElements.length){const X=P[ta];if(X&&X.setForMove){if(X.previousTriggersValues&&X.previousTriggersValues.has(O.triggerName)){const le=X.previousTriggersValues.get(O.triggerName),Y=this.statesByElement.get(O.element);Y&&Y[O.triggerName]&&(Y[O.triggerName].value=le)}return void j.destroy()}}const z=!d||!this.driver.containsElement(d,P),q=v.get(P),G=p.get(P),V=this._buildInstruction(O,i,G,q,z);if(V.errors&&V.errors.length)return void C.push(V);if(z)return j.onStart(()=>yp(P,V.fromStyles)),j.onDestroy(()=>mu(P,V.toStyles)),void r.push(j);if(O.isFallbackTransition)return j.onStart(()=>yp(P,V.fromStyles)),j.onDestroy(()=>mu(P,V.toStyles)),void r.push(j);const K=[];V.timelines.forEach(X=>{X.stretchStartingKeyframe=!0,this.disabledNodes.has(X.element)||K.push(X)}),V.timelines=K,i.append(P,V.timelines),o.push({instruction:V,player:j,element:P}),V.queriedElements.forEach(X=>go(a,X,[]).push(j)),V.preStyleProps.forEach((X,le)=>{const Y=Object.keys(X);if(Y.length){let Z=l.get(le);Z||l.set(le,Z=new Set),Y.forEach(ne=>Z.add(ne))}}),V.postStyleProps.forEach((X,le)=>{const Y=Object.keys(X);let Z=u.get(le);Z||u.set(le,Z=new Set),Y.forEach(ne=>Z.add(ne))})});if(C.length){const x=[];C.forEach(F=>{x.push(function utt(e,t){return new xe(3505,vt)}())}),D.forEach(F=>F.destroy()),this.reportError(x)}const w=new Map,E=new Map;o.forEach(x=>{const F=x.element;i.has(F)&&(E.set(F,F),this._beforeAnimationBuild(x.player.namespaceId,x.instruction,w))}),r.forEach(x=>{const F=x.element;this._getPreviousPlayers(F,!1,x.namespaceId,x.triggerName,null).forEach(j=>{go(w,F,[]).push(j),j.destroy()})});const N=m.filter(x=>ice(x,l,u)),k=new Map;ece(k,this.driver,y,u,wc).forEach(x=>{ice(x,l,u)&&N.push(x)});const L=new Map;h.forEach((x,F)=>{ece(L,this.driver,new Set(x),l,"!")}),N.forEach(x=>{const F=k.get(x),O=L.get(x);k.set(x,Object.assign(Object.assign({},F),O))});const B=[],T=[],A={};o.forEach(x=>{const{element:F,player:O,instruction:j}=x;if(i.has(F)){if(c.has(F))return O.onDestroy(()=>mu(F,j.toStyles)),O.disabled=!0,O.overrideTotalTime(j.totalTime),void r.push(O);let P=A;if(E.size>1){let q=F;const G=[];for(;q=q.parentNode;){const V=E.get(q);if(V){P=V;break}G.push(q)}G.forEach(V=>E.set(V,P))}const z=this._buildAnimation(O.namespaceId,j,w,s,L,k);if(O.setRealPlayer(z),P===A)B.push(O);else{const q=this.playersByElement.get(P);q&&q.length&&(O.parentPlayer=pf(q)),r.push(O)}}else yp(F,j.fromStyles),O.onDestroy(()=>mu(F,j.toStyles)),T.push(O),c.has(F)&&r.push(O)}),T.forEach(x=>{const F=s.get(x.element);if(F&&F.length){const O=pf(F);x.setRealPlayer(O)}}),r.forEach(x=>{x.parentPlayer?x.syncPlayerEvents(x.parentPlayer):x.destroy()});for(let x=0;x<m.length;x++){const F=m[x],O=F[ta];if(v0(F,_A),O&&O.hasAnimation)continue;let j=[];if(a.size){let z=a.get(F);z&&z.length&&j.push(...z);let q=this.driver.query(F,qB,!0);for(let G=0;G<q.length;G++){let V=a.get(q[G]);V&&V.length&&j.push(...V)}}const P=j.filter(z=>!z.destroyed);P.length?unt(this,F,P):this.processLeaveNode(F)}return m.length=0,B.forEach(x=>{this.players.push(x),x.onDone(()=>{x.destroy();const F=this.players.indexOf(x);this.players.splice(F,1)}),x.play()}),B}elementContainsData(t,n){let i=!1;const r=n[ta];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(n)&&(i=!0),this.playersByQueriedElement.has(n)&&(i=!0),this.statesByElement.has(n)&&(i=!0),this._fetchNamespace(t).elementContainsData(n)||i}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,n,i,r,s){let o=[];if(n){const a=this.playersByQueriedElement.get(t);a&&(o=a)}else{const a=this.playersByElement.get(t);if(a){const l=!s||s==j1;a.forEach(u=>{u.queued||!l&&u.triggerName!=r||o.push(u)})}}return(i||r)&&(o=o.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(t,n,i){const s=n.element,o=n.isRemovalTransition?void 0:t,a=n.isRemovalTransition?void 0:n.triggerName;for(const l of n.timelines){const u=l.element,c=u!==s,d=go(i,u,[]);this._getPreviousPlayers(u,c,o,a,n.toState).forEach(h=>{const p=h.getRealPlayer();p.beforeDestroy&&p.beforeDestroy(),h.destroy(),d.push(h)})}yp(s,n.fromStyles)}_buildAnimation(t,n,i,r,s,o){const a=n.triggerName,l=n.element,u=[],c=new Set,d=new Set,f=n.timelines.map(p=>{const g=p.element;c.add(g);const m=g[ta];if(m&&m.removedBeforeQueried)return new P1(p.duration,p.delay);const _=g!==l,y=function cnt(e){const t=[];return nce(e,t),t}((i.get(g)||nnt).map(w=>w.getRealPlayer())).filter(w=>!!w.element&&w.element===g),v=s.get(g),b=o.get(g),D=Mue(0,this._normalizer,0,p.keyframes,v,b),C=this._buildPlayer(p,D,y);if(p.subTimeline&&r&&d.add(g),_){const w=new s4(t,a,g);w.setRealPlayer(C),u.push(w)}return C});u.forEach(p=>{go(this.playersByQueriedElement,p.element,[]).push(p),p.onDone(()=>function ont(e,t,n){let i;if(e instanceof Map){if(i=e.get(t),i){if(i.length){const r=i.indexOf(n);i.splice(r,1)}0==i.length&&e.delete(t)}}else if(i=e[t],i){if(i.length){const r=i.indexOf(n);i.splice(r,1)}0==i.length&&delete e[t]}return i}(this.playersByQueriedElement,p.element,p))}),c.forEach(p=>na(p,jue));const h=pf(f);return h.onDestroy(()=>{c.forEach(p=>v0(p,jue)),mu(l,n.toStyles)}),d.forEach(p=>{go(r,p,[]).push(h)}),h}_buildPlayer(t,n,i){return n.length>0?this.driver.animate(t.element,n,t.duration,t.delay,t.easing,i):new P1(t.duration,t.delay)}}class s4{constructor(t,n,i){this.namespaceId=t,this.triggerName=n,this.element=i,this._player=new P1,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(n=>{this._queuedCallbacks[n].forEach(i=>jB(t,n,void 0,i))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const n=this._player;n.triggerCallback&&t.onStart(()=>n.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,n){go(this._queuedCallbacks,t,[]).push(n)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const n=this._player;n.triggerCallback&&n.triggerCallback(t)}}function kA(e){return e&&1===e.nodeType}function Zue(e,t){const n=e.style.display;return e.style.display=null!=t?t:"none",n}function ece(e,t,n,i,r){const s=[];n.forEach(l=>s.push(Zue(l)));const o=[];i.forEach((l,u)=>{const c={};l.forEach(d=>{const f=c[d]=t.computeStyle(u,d,r);(!f||0==f.length)&&(u[ta]=int,o.push(u))}),e.set(u,c)});let a=0;return n.forEach(l=>Zue(l,s[a++])),o}function tce(e,t){const n=new Map;if(e.forEach(a=>n.set(a,[])),0==t.length)return n;const r=new Set(t),s=new Map;function o(a){if(!a)return 1;let l=s.get(a);if(l)return l;const u=a.parentNode;return l=n.has(u)?u:r.has(u)?1:o(u),s.set(a,l),l}return t.forEach(a=>{const l=o(a);1!==l&&n.get(l).push(a)}),n}function na(e,t){var n;null===(n=e.classList)||void 0===n||n.add(t)}function v0(e,t){var n;null===(n=e.classList)||void 0===n||n.remove(t)}function unt(e,t,n){pf(n).onDone(()=>e.processLeaveNode(t))}function nce(e,t){for(let n=0;n<e.length;n++){const i=e[n];i instanceof xue?nce(i.players,t):t.push(i)}}function ice(e,t,n){const i=n.get(e);if(!i)return!1;let r=t.get(e);return r?i.forEach(s=>r.add(s)):t.set(e,i),n.delete(e),!0}class IA{constructor(t,n,i){this.bodyNode=t,this._driver=n,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new snt(t,n,i),this._timelineEngine=new Xtt(t,n,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(t,n,i,r,s){const o=t+"-"+r;let a=this._triggerCache[o];if(!a){const l=[],c=KB(this._driver,s,l,[]);if(l.length)throw function Qet(e,t){return new xe(3404,vt)}();a=function Wtt(e,t,n){return new Ytt(e,t,n)}(r,c,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(n,r,a)}register(t,n){this._transitionEngine.register(t,n)}destroy(t,n){this._transitionEngine.destroy(t,n)}onInsert(t,n,i,r){this._transitionEngine.insertNode(t,n,i,r)}onRemove(t,n,i,r){this._transitionEngine.removeNode(t,n,r||!1,i)}disableAnimations(t,n){this._transitionEngine.markElementAsDisabled(t,n)}process(t,n,i,r){if("@"==i.charAt(0)){const[s,o]=Tue(i);this._timelineEngine.command(s,n,o,r)}else this._transitionEngine.trigger(t,n,i,r)}listen(t,n,i,r,s){if("@"==i.charAt(0)){const[o,a]=Tue(i);return this._timelineEngine.listen(o,n,a,s)}return this._transitionEngine.listen(t,n,i,r,s)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let hnt=(()=>{class e{constructor(n,i,r){this._element=n,this._startStyles=i,this._endStyles=r,this._state=0;let s=e.initialStylesByElement.get(n);s||e.initialStylesByElement.set(n,s={}),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&mu(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(mu(this._element,this._initialStyles),this._endStyles&&(mu(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(yp(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(yp(this._element,this._endStyles),this._endStyles=null),mu(this._element,this._initialStyles),this._state=3)}}return e.initialStylesByElement=new WeakMap,e})();function o4(e){let t=null;const n=Object.keys(e);for(let i=0;i<n.length;i++){const r=n[i];pnt(r)&&(t=t||{},t[r]=e[r])}return t}function pnt(e){return"display"===e||"position"===e}class rce{constructor(t,n,i,r){this.element=t,this.keyframes=n,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,n,i){return t.animate(n,i)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};if(this.hasStarted()){const n=this._finalKeyframe;Object.keys(n).forEach(i=>{"offset"!=i&&(t[i]=this._finished?n[i]:Uue(this.element,i))})}this.currentSnapshot=t}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(i=>i()),n.length=0}}class gnt{validateStyleProperty(t){return Iue(t)}matchesElement(t,n){return!1}containsElement(t,n){return Rue(t,n)}getParentElement(t){return HB(t)}query(t,n,i){return Fue(t,n,i)}computeStyle(t,n,i){return window.getComputedStyle(t)[n]}animate(t,n,i,r,s,o=[]){const l={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(l.easing=s);const u={},c=o.filter(f=>f instanceof rce);(function vtt(e,t){return 0===e||0===t})(i,r)&&c.forEach(f=>{let h=f.currentSnapshot;Object.keys(h).forEach(p=>u[p]=h[p])}),n=function btt(e,t,n){const i=Object.keys(n);if(i.length&&t.length){let s=t[0],o=[];if(i.forEach(a=>{s.hasOwnProperty(a)||o.push(a),s[a]=n[a]}),o.length)for(var r=1;r<t.length;r++){let a=t[r];o.forEach(function(l){a[l]=Uue(e,l)})}}return t}(t,n=n.map(f=>gf(f,!1)),u);const d=function fnt(e,t){let n=null,i=null;return Array.isArray(t)&&t.length?(n=o4(t[0]),t.length>1&&(i=o4(t[t.length-1]))):t&&(n=o4(t)),n||i?new hnt(e,n,i):null}(t,n);return new rce(t,n,l,d)}}let mnt=(()=>{class e extends Due{constructor(n,i){super(),this._nextAnimationId=0,this._renderer=n.createRenderer(i.body,{id:"0",encapsulation:oa.None,styles:[],data:{animation:[]}})}build(n){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(n)?Cue(n):n;return sce(this._renderer,null,i,"register",[r]),new _nt(i,this._renderer)}}return e.\u0275fac=function(n){return new(n||e)(me(lg),me(ni))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();class _nt extends class Oet{}{constructor(t,n){super(),this._id=t,this._renderer=n}create(t,n){return new ynt(this._id,t,n||{},this._renderer)}}class ynt{constructor(t,n,i,r){this.id=t,this.element=n,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(t,n){return this._renderer.listen(this.element,`@@${this.id}:${t}`,n)}_command(t,...n){return sce(this._renderer,this.element,this.id,t,n)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){var t,n;return null!==(n=null===(t=this._renderer.engine.players[+this.id])||void 0===t?void 0:t.getPosition())&&void 0!==n?n:0}}function sce(e,t,n,i,r){return e.setProperty(t,`@@${n}:${i}`,r)}const oce="@.disabled";let vnt=(()=>{class e{constructor(n,i,r){this.delegate=n,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(s,o)=>{const a=null==o?void 0:o.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(n,i){const s=this.delegate.createRenderer(n,i);if(!(n&&i&&i.data&&i.data.animation)){let c=this._rendererCache.get(s);return c||(c=new ace("",s,this.engine),this._rendererCache.set(s,c)),c}const o=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,n);const l=c=>{Array.isArray(c)?c.forEach(l):this.engine.registerTrigger(o,a,n,c.name,c)};return i.data.animation.forEach(l),new bnt(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(n,i,r){n>=0&&n<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return e.\u0275fac=function(n){return new(n||e)(me(lg),me(IA),me(hn))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();class ace{constructor(t,n,i){this.namespaceId=t,this.delegate=n,this.engine=i,this.destroyNode=this.delegate.destroyNode?r=>n.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,n){return this.delegate.createElement(t,n)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,n){this.delegate.appendChild(t,n),this.engine.onInsert(this.namespaceId,n,t,!1)}insertBefore(t,n,i,r=!0){this.delegate.insertBefore(t,n,i),this.engine.onInsert(this.namespaceId,n,t,r)}removeChild(t,n,i){this.engine.onRemove(this.namespaceId,n,this.delegate,i)}selectRootElement(t,n){return this.delegate.selectRootElement(t,n)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,n,i,r){this.delegate.setAttribute(t,n,i,r)}removeAttribute(t,n,i){this.delegate.removeAttribute(t,n,i)}addClass(t,n){this.delegate.addClass(t,n)}removeClass(t,n){this.delegate.removeClass(t,n)}setStyle(t,n,i,r){this.delegate.setStyle(t,n,i,r)}removeStyle(t,n,i){this.delegate.removeStyle(t,n,i)}setProperty(t,n,i){"@"==n.charAt(0)&&n==oce?this.disableAnimations(t,!!i):this.delegate.setProperty(t,n,i)}setValue(t,n){this.delegate.setValue(t,n)}listen(t,n,i){return this.delegate.listen(t,n,i)}disableAnimations(t,n){this.engine.disableAnimations(t,n)}}class bnt extends ace{constructor(t,n,i,r){super(n,i,r),this.factory=t,this.namespaceId=n}setProperty(t,n,i){"@"==n.charAt(0)?"."==n.charAt(1)&&n==oce?this.disableAnimations(t,i=void 0===i||!!i):this.engine.process(this.namespaceId,t,n.substr(1),i):this.delegate.setProperty(t,n,i)}listen(t,n,i){if("@"==n.charAt(0)){const r=function wnt(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(t);let s=n.substr(1),o="";return"@"!=s.charAt(0)&&([s,o]=function Dnt(e){const t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(t,n,i)}}let Cnt=(()=>{class e extends IA{constructor(n,i,r){super(n.body,i,r)}ngOnDestroy(){this.flush()}}return e.\u0275fac=function(n){return new(n||e)(me(ni),me(UB),me(e4))},e.\u0275prov=Ie({token:e,factory:e.\u0275fac}),e})();const lce=new rt("AnimationModuleType"),uce=[{provide:Due,useClass:mnt},{provide:e4,useFactory:function Ent(){return new Htt}},{provide:IA,useClass:Cnt},{provide:lg,useFactory:function Snt(e,t,n){return new vnt(e,t,n)},deps:[dw,IA,hn]}],cce=[{provide:UB,useFactory:()=>new gnt},{provide:lce,useValue:"BrowserAnimations"},...uce],xnt=[{provide:UB,useClass:Pue},{provide:lce,useValue:"NoopAnimations"},...uce];let Ant=(()=>{class e{static withConfig(n){return{ngModule:e,providers:n.disableAnimations?xnt:cce}}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e}),e.\u0275inj=Rt({providers:cce,imports:[R9]}),e})(),Mnt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=Vt({type:e,bootstrap:[Tet]}),e.\u0275inj=Rt({providers:[gO,Fi,ea],imports:[[yz,zwe,R9,Ant,qxe,xet]]}),e})();(function H_e(){G7=!1})(),e1e().bootstrapModule(Mnt).catch(e=>console.error(e))},559:$n=>{"use strict";$n.exports=function Sn(de,$t){if(de===$t)return!0;if(de&&$t&&"object"==typeof de&&"object"==typeof $t){if(de.constructor!==$t.constructor)return!1;var Qt,Zt,an;if(Array.isArray(de)){if((Qt=de.length)!=$t.length)return!1;for(Zt=Qt;0!=Zt--;)if(!Sn(de[Zt],$t[Zt]))return!1;return!0}if(de.constructor===RegExp)return de.source===$t.source&&de.flags===$t.flags;if(de.valueOf!==Object.prototype.valueOf)return de.valueOf()===$t.valueOf();if(de.toString!==Object.prototype.toString)return de.toString()===$t.toString();if((Qt=(an=Object.keys(de)).length)!==Object.keys($t).length)return!1;for(Zt=Qt;0!=Zt--;)if(!Object.prototype.hasOwnProperty.call($t,an[Zt]))return!1;for(Zt=Qt;0!=Zt--;){var dt=an[Zt];if(!Sn(de[dt],$t[dt]))return!1}return!0}return de!=de&&$t!=$t}},245:$n=>{"use strict";$n.exports=function(Sn,de){de||(de={}),"function"==typeof de&&(de={cmp:de});var an,$t="boolean"==typeof de.cycles&&de.cycles,Qt=de.cmp&&(an=de.cmp,function(dt){return function(Kn,kt){return an({key:Kn,value:dt[Kn]},{key:kt,value:dt[kt]})}}),Zt=[];return function an(dt){if(dt&&dt.toJSON&&"function"==typeof dt.toJSON&&(dt=dt.toJSON()),void 0!==dt){if("number"==typeof dt)return isFinite(dt)?""+dt:"null";if("object"!=typeof dt)return JSON.stringify(dt);var Kn,kt;if(Array.isArray(dt)){for(kt="[",Kn=0;Kn<dt.length;Kn++)Kn&&(kt+=","),kt+=an(dt[Kn])||"null";return kt+"]"}if(null===dt)return"null";if(-1!==Zt.indexOf(dt)){if($t)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var Is=Zt.push(dt)-1,Rs=Object.keys(dt).sort(Qt&&Qt(dt));for(kt="",Kn=0;Kn<Rs.length;Kn++){var Tt=Rs[Kn],mt=an(dt[Tt]);!mt||(kt&&(kt+=","),kt+=JSON.stringify(Tt)+":"+mt)}return Zt.splice(Is,1),"{"+kt+"}"}}(Sn)}},478:$n=>{var Sn=function(){"use strict";function de(Tt,mt){return null!=mt&&Tt instanceof mt}var $t,Qt,Zt;try{$t=Map}catch(Tt){$t=function(){}}try{Qt=Set}catch(Tt){Qt=function(){}}try{Zt=Promise}catch(Tt){Zt=function(){}}function an(Tt,mt,Wi,yo,ia){"object"==typeof mt&&(Wi=mt.depth,yo=mt.prototype,ia=mt.includeNonEnumerable,mt=mt.circular);var ll=[],rr=[],ul="undefined"!=typeof Buffer;return void 0===mt&&(mt=!0),void 0===Wi&&(Wi=1/0),function Qe(Ye,Jn){if(null===Ye)return null;if(0===Jn)return Ye;var It,Xn;if("object"!=typeof Ye)return Ye;if(de(Ye,$t))It=new $t;else if(de(Ye,Qt))It=new Qt;else if(de(Ye,Zt))It=new Zt(function(_f,yf){Ye.then(function(bu){_f(Qe(bu,Jn-1))},function(bu){yf(Qe(bu,Jn-1))})});else if(an.__isArray(Ye))It=[];else if(an.__isRegExp(Ye))It=new RegExp(Ye.source,Rs(Ye)),Ye.lastIndex&&(It.lastIndex=Ye.lastIndex);else if(an.__isDate(Ye))It=new Date(Ye.getTime());else{if(ul&&Buffer.isBuffer(Ye))return It=Buffer.allocUnsafe?Buffer.allocUnsafe(Ye.length):new Buffer(Ye.length),Ye.copy(It),It;de(Ye,Error)?It=Object.create(Ye):void 0===yo?(Xn=Object.getPrototypeOf(Ye),It=Object.create(Xn)):(It=Object.create(yo),Xn=yo)}if(mt){var mf=ll.indexOf(Ye);if(-1!=mf)return rr[mf];ll.push(Ye),rr.push(It)}for(var as in de(Ye,$t)&&Ye.forEach(function(_f,yf){var bu=Qe(yf,Jn-1),wu=Qe(_f,Jn-1);It.set(bu,wu)}),de(Ye,Qt)&&Ye.forEach(function(_f){var yf=Qe(_f,Jn-1);It.add(yf)}),Ye){var bp;Xn&&(bp=Object.getOwnPropertyDescriptor(Xn,as)),(!bp||null!=bp.set)&&(It[as]=Qe(Ye[as],Jn-1))}if(Object.getOwnPropertySymbols){var cl=Object.getOwnPropertySymbols(Ye);for(as=0;as<cl.length;as++){var _u=cl[as];(yu=Object.getOwnPropertyDescriptor(Ye,_u))&&!yu.enumerable&&!ia||(It[_u]=Qe(Ye[_u],Jn-1),yu.enumerable||Object.defineProperty(It,_u,{enumerable:!1}))}}if(ia){var vu=Object.getOwnPropertyNames(Ye);for(as=0;as<vu.length;as++){var yu,wp=vu[as];(yu=Object.getOwnPropertyDescriptor(Ye,wp))&&yu.enumerable||(It[wp]=Qe(Ye[wp],Jn-1),Object.defineProperty(It,wp,{enumerable:!1}))}}return It}(Tt,Wi)}function dt(Tt){return Object.prototype.toString.call(Tt)}function Rs(Tt){var mt="";return Tt.global&&(mt+="g"),Tt.ignoreCase&&(mt+="i"),Tt.multiline&&(mt+="m"),mt}return an.clonePrototype=function(mt){if(null===mt)return null;var Wi=function(){};return Wi.prototype=mt,new Wi},an.__objToStr=dt,an.__isDate=function Kn(Tt){return"object"==typeof Tt&&"[object Date]"===dt(Tt)},an.__isArray=function kt(Tt){return"object"==typeof Tt&&"[object Array]"===dt(Tt)},an.__isRegExp=function Is(Tt){return"object"==typeof Tt&&"[object RegExp]"===dt(Tt)},an.__getRegExpFlags=Rs,an}();$n.exports&&($n.exports=Sn)},564:$n=>{"use strict";var Sn=/("(?:[^\\"]|\\.)*")|[:,]/g;$n.exports=function($t,Qt){var Zt,an,dt;return Qt=Qt||{},Zt=JSON.stringify([1],void 0,void 0===Qt.indent?2:Qt.indent).slice(2,-3),an=""===Zt?1/0:void 0===Qt.maxLength?80:Qt.maxLength,dt=Qt.replacer,function Kn(kt,Is,Rs){var Tt,mt,Wi,yo,ia,ll,rr,ul,Qe,Ye,Jn,It;if(kt&&"function"==typeof kt.toJSON&&(kt=kt.toJSON()),void 0===(Jn=JSON.stringify(kt,dt)))return Jn;if(Jn.length<=(rr=an-Is.length-Rs)&&(Qe=Jn.replace(Sn,function(Xn,mf){return mf||Xn+" "})).length<=rr)return Qe;if(null!=dt&&(kt=JSON.parse(Jn),dt=void 0),"object"==typeof kt&&null!==kt){if(ul=Is+Zt,Wi=[],mt=0,Array.isArray(kt))for(Ye="[",Tt="]",rr=kt.length;mt<rr;mt++)Wi.push(Kn(kt[mt],ul,mt===rr-1?0:1)||"null");else for(Ye="{",Tt="}",rr=(ll=Object.keys(kt)).length;mt<rr;mt++)yo=ll[mt],ia=JSON.stringify(yo)+": ",void 0!==(It=Kn(kt[yo],ul,ia.length+(mt===rr-1?0:1)))&&Wi.push(ia+It);if(Wi.length>0)return[Ye,Zt+Wi.join(",\n"+ul),Tt].join("\n"+Is)}return Jn}($t,"",0)}}},$n=>{$n($n.s=34)}]);